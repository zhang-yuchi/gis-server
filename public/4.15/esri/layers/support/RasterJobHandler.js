// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.15/esri/copyright.txt for details.
//>>built
define("require exports ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../core/tsSupport/assignHelper ../../core/Error ../../core/promiseUtils ../../core/workers ./PixelBlock".split(" "),function(p,q,f,g,l,h,m,n,k){return function(){function d(){this._workerThread=null;this._destroyed=!1}d.prototype.initialize=function(){return g(this,void 0,void 0,function(){var a;return f(this,function(e){switch(e.label){case 0:return[4,n.open("RasterWorker")];case 1:return a=e.sent(),
this._destroyed?a.close():this._workerThread=a,[2]}})})};d.prototype.destroy=function(){this._destroyed=!0;this._workerThread&&(this._workerThread.close(),this._workerThread=null)};d.prototype.decode=function(a,e){return g(this,void 0,void 0,function(){var b;return f(this,function(c){switch(c.label){case 0:if(!this._workerThread)throw new h("raster-jobhandler:no-connection","no available worker connection");return[4,this._workerThread.invoke("decode",a,e)];case 1:return b=c.sent(),[2,b?new k(b):null]}})})};
d.prototype.symbolize=function(a,e){return g(this,void 0,void 0,function(){var b;return f(this,function(c){switch(c.label){case 0:if(!this._workerThread)throw new h("raster-jobhandler:no-connection","no available worker connection");return[4,this._workerThread.invoke("symbolize",a.toJSON(),e)];case 1:return b=c.sent(),[2,b?new k(b):null]}})})};d.prototype.updateSymbolizer=function(a,e){return g(this,void 0,void 0,function(){var b;return f(this,function(c){switch(c.label){case 0:if(!this._workerThread)throw new h("raster-jobhandler:no-connection",
"no available worker connection");b=a&&a.renderer&&"raster-stretch"===a.renderer.type&&a.renderer.histograms;return[4,m.all(this._workerThread.broadcast("updateSymbolizer",{symbolizerJSON:a.toJSON(),histograms:b},e))];case 1:return c.sent(),[2]}})})};d.prototype.stretch=function(a,e){return g(this,void 0,void 0,function(){var b,c;return f(this,function(d){switch(d.label){case 0:if(!this._workerThread)throw new h("raster-jobhandler:no-connection","no available worker connection");if(!a||!a.pixelBlock)return[2,
null];b={srcPixelBlock:a.pixelBlock.toJSON(),stretchParams:a.stretchParams};return[4,this._workerThread.invoke("stretch",b,e)];case 1:return c=d.sent(),[2,c?new k(c):null]}})})};d.prototype.mosaicAndTransform=function(a,e){return g(this,void 0,void 0,function(){var b,c;return f(this,function(d){switch(d.label){case 0:if(!this._workerThread)throw new h("raster-jobhandler:no-connection","no available worker connection");if(!(a&&a.srcPixelBlocks&&0<a.srcPixelBlocks.length))return[2,null];b=l({},a,{srcPixelBlocks:a.srcPixelBlocks.map(function(a){return a?
a.toJSON():null})});return[4,this._workerThread.invoke("mosaicAndTransform",b,e)];case 1:return c=d.sent(),[2,c?new k(c):null]}})})};return d}()});