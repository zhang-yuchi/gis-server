// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.15/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/graphics/data/FeatureStore":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/Error ../../../core/Evented ../../../core/Logger ../../../core/maybe ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./BoundsStore ./executeTileQuery ./optimizedFeatureQueryEngineAdapter".split(" "),
function(A,a,t,m,b,c,g,k,u,x,C,q,D,E,G,F,y){Object.defineProperty(a,"__esModule",{value:!0});var p=u.getLogger("esri.layers.graphics.data.FeatureStore");A=function(){function a(a){this.geometryInfo=a;this._boundsStore=new G.BoundsStore;this._featuresById=new Map;this._markedIds=new Set;this.events=new k;this.featureAdapter=y.optimizedFeatureQueryEngineAdapter}Object.defineProperty(a.prototype,"geometryType",{get:function(){return this.geometryInfo.geometryType},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"hasM",{get:function(){return this.geometryInfo.hasM},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hasZ",{get:function(){return this.geometryInfo.hasZ},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"numFeatures",{get:function(){return this._featuresById.size},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fullBounds",{get:function(){var a=this;if(!this.numFeatures)return null;var h=q.create(q.NEGATIVE_INFINITY);this._featuresById.forEach(function(e){if(e=
a._boundsStore.get(e.objectId))h[0]=Math.min(e[0],h[0]),h[1]=Math.min(e[1],h[1]),h[2]=Math.max(e[2],h[2]),h[3]=Math.max(e[3],h[3])});return h},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"storeStatistics",{get:function(){var a=0;this._featuresById.forEach(function(h){h.geometry&&h.geometry.coords&&(a+=h.geometry.coords.length)});return{featureCount:this._featuresById.size,vertexCount:a/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}},enumerable:!0,configurable:!0});a.prototype.add=
function(a){this._add(a);this._emitChanged()};a.prototype.addMany=function(a){for(var h=0;h<a.length;h++)this._add(a[h]);this._emitChanged()};a.prototype.clear=function(){this._featuresById.clear();this._boundsStore.clear();this._emitChanged()};a.prototype.removeById=function(a){a=this._featuresById.get(a);if(!a)return null;this._remove(a);this._emitChanged();return a};a.prototype.removeManyById=function(a){this._boundsStore.invalidateIndex();for(var h=0;h<a.length;h++){var e=this._featuresById.get(a[h]);
e&&this._remove(e)}this._emitChanged()};a.prototype.forEachBounds=function(a,h,e){for(var b=0;b<a.length;b++){var c=this._boundsStore.get(a[b].objectId);c&&h(C.fromRect(e,c))}};a.prototype.getFeature=function(a){return this._featuresById.get(a)};a.prototype.has=function(a){return this._featuresById.has(a)};a.prototype.forEach=function(a){this._featuresById.forEach(function(h){return a(h)})};a.prototype.forEachInBounds=function(a,h){var e=this;this._boundsStore.forEachInBounds(a,function(a){h(e._featuresById.get(a))})};
a.prototype.startMarkingUsedFeatures=function(){this._boundsStore.invalidateIndex();this._markedIds.clear()};a.prototype.sweep=function(){var a=this,h=!1;this._featuresById.forEach(function(e,b){a._markedIds.has(b)||(h=!0,a._remove(e))});this._markedIds.clear();h&&this._emitChanged()};a.prototype.executeTileQuery=function(a,h,e){return m(this,void 0,void 0,function(){var b,c,n,v,g,p,k,B,L,J,y,E,G,u;return t(this,function(l){b=e.returnGeometry;c=e.returnCentroid;n=e.returnOutline;v=e.pixelBuffer;g=
new Set;p=[];k=v*a.resolution;B=q.pad(a.bounds,k,q.create());F.createTileFeatures(p,g,this.geometryInfo,this,B,b,c,n,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[a.bounds[0],a.bounds[3]]});if("esriGeometryPoint"===this.geometryType||c)if(L=D.getInfo(h))J=L.valid,y=J[0],E=J[1],B[0]<y&&(G=q.fromValues(E-k,B[1],E,B[3]),F.createTileFeatures(p,g,this.geometryInfo,this,G,b,c,n,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[E,a.bounds[3]]})),B[2]>E&&
(u=q.fromValues(y,B[1],y+k,B[3]),F.createTileFeatures(p,g,this.geometryInfo,this,u,b,c,n,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[y-E+a.bounds[0],a.bounds[3]]}));p.sort(function(a,B){return a.localId-B.localId});return[2,{features:p,objectIds:g}]})})};a.prototype._emitChanged=function(){this.events.emit("changed",void 0)};a.prototype._add=function(a){if(a){var b=a.objectId;if(null==b)p.error(new g("featurestore:invalid-feature","feature id is missing",{feature:a}));
else{var e=this._featuresById.get(b),c;this._markedIds.add(b);if(e)a.localId=e.localId,c=this._boundsStore.get(b),this._boundsStore.delete(b);else if(x.isSome(this.onFeatureAdd))this.onFeatureAdd(a);a.geometry&&a.geometry.coords&&a.geometry.coords.length?(c=E.getBoundsOptimizedGeometry(c||q.create(),a.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),this._boundsStore.set(b,c)):this._boundsStore.set(b,null);this._featuresById.set(b,a)}}};a.prototype._remove=function(a){if(x.isSome(this.onFeatureRemove))this.onFeatureRemove(a);
this._markedIds.delete(a.objectId);this._boundsStore.delete(a.objectId);this._featuresById.delete(a.objectId);return a};return a}();a.default=A})},"esri/layers/graphics/data/BoundsStore":function(){define(["require","exports","../../../core/has","../../../core/libs/rbush/rbush","@dojo/framework/shim/Promise"],function(A,a,t,m){Object.defineProperty(a,"__esModule",{value:!0});var b={minX:0,minY:0,maxX:0,maxY:0};A=function(){function a(){var a=this;this._indexInvalid=!1;this._boundsToLoad=[];this._boundsById=
new Map;this._idByBounds=new Map;this._index=m(9,t("csp-restrictions")?function(a){return{minX:a[0],minY:a[1],maxX:a[2],maxY:a[3]}}:["[0]","[1]","[2]","[3]"]);this._loadIndex=function(){if(a._indexInvalid){var b=Array(a._idByBounds.size),c=0;a._idByBounds.forEach(function(a,g){b[c++]=g});a._indexInvalid=!1;a._index.clear();a._index.load(b)}else a._boundsToLoad.length&&(a._index.load(a._boundsToLoad.filter(function(b){return a._idByBounds.has(b)})),a._boundsToLoad.length=0)}}a.prototype.clear=function(){this._indexInvalid=
!1;this._boundsToLoad.length=0;this._boundsById.clear();this._idByBounds.clear();this._index.clear()};a.prototype.delete=function(a){var b=this._boundsById.get(a);this._boundsById.delete(a);b&&(this._idByBounds.delete(b),this._indexInvalid||this._index.remove(b))};a.prototype.forEachInBounds=function(a,c){this._loadIndex();var g=0,k=this._index;b.minX=a[0];b.minY=a[1];b.maxX=a[2];b.maxY=a[3];for(a=k.search(b);g<a.length;g++)c(this._idByBounds.get(a[g]))};a.prototype.get=function(a){return this._boundsById.get(a)};
a.prototype.has=function(a){return this._boundsById.has(a)};a.prototype.invalidateIndex=function(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)};a.prototype.set=function(a,b){if(!this._indexInvalid){var c=this._boundsById.get(a);c&&(this._index.remove(c),this._idByBounds.delete(c))}this._boundsById.set(a,b);b&&(this._idByBounds.set(b,a),this._indexInvalid||(this._boundsToLoad.push(b),5E4<this._boundsToLoad.length&&this._loadIndex()))};return a}();a.BoundsStore=A})},"esri/core/libs/rbush/rbush":function(){define(["../quickselect/quickselect"],
function(A){function a(b,c){if(!(this instanceof a))return new a(b,c);this._maxEntries=Math.max(4,b||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));c&&("function"===typeof c?this.toBBox=c:this._initFormat(c));this.clear()}function t(a,b){m(a,0,a.children.length,b,a)}function m(a,c,g,k,p){p||(p=q(null));p.minX=Infinity;p.minY=Infinity;p.maxX=-Infinity;p.maxY=-Infinity;for(var n;c<g;c++)n=a.children[c],b(p,a.leaf?k(n):n);return p}function b(a,b){a.minX=Math.min(a.minX,b.minX);a.minY=
Math.min(a.minY,b.minY);a.maxX=Math.max(a.maxX,b.maxX);a.maxY=Math.max(a.maxY,b.maxY);return a}function c(a,b){return a.minX-b.minX}function g(a,b){return a.minY-b.minY}function k(a){return(a.maxX-a.minX)*(a.maxY-a.minY)}function u(a){return a.maxX-a.minX+(a.maxY-a.minY)}function x(a,b){return a.minX<=b.minX&&a.minY<=b.minY&&b.maxX<=a.maxX&&b.maxY<=a.maxY}function C(a,b){return b.minX<=a.maxX&&b.minY<=a.maxY&&b.maxX>=a.minX&&b.maxY>=a.minY}function q(a){return{children:a,height:1,leaf:!0,minX:Infinity,
minY:Infinity,maxX:-Infinity,maxY:-Infinity}}function D(a,b,c,g,p){for(var n=[b,c],v;n.length;)c=n.pop(),b=n.pop(),c-b<=g||(v=b+Math.ceil((c-b)/g/2)*g,A(a,v,b,c,p),n.push(b,v,v,c))}a.prototype={all:function(){return this._all(this.data,[])},search:function(a){var b=this.data,c=[],g=this.toBBox;if(!C(a,b))return c;for(var p=[],n,v,h,e;b;){n=0;for(v=b.children.length;n<v;n++)h=b.children[n],e=b.leaf?g(h):h,C(a,e)&&(b.leaf?c.push(h):x(a,e)?this._all(h,c):p.push(h));b=p.pop()}return c},collides:function(a){var b=
this.data,c=this.toBBox;if(!C(a,b))return!1;for(var g=[],p,n,v,h;b;){p=0;for(n=b.children.length;p<n;p++)if(v=b.children[p],h=b.leaf?c(v):v,C(a,h)){if(b.leaf||x(a,h))return!0;g.push(v)}b=g.pop()}return!1},load:function(a){if(!a||!a.length)return this;if(a.length<this._minEntries){for(var b=0,c=a.length;b<c;b++)this.insert(a[b]);return this}a=this._build(a.slice(),0,a.length-1,0);this.data.children.length?this.data.height===a.height?this._splitRoot(this.data,a):(this.data.height<a.height&&(b=this.data,
this.data=a,a=b),this._insert(a,this.data.height-a.height-1,!0)):this.data=a;return this},insert:function(a){a&&this._insert(a,this.data.height-1);return this},clear:function(){this.data=q([]);return this},remove:function(a,b){if(!a)return this;for(var c=this.data,g=this.toBBox(a),p=[],n=[],v,h,e,l;c||p.length;){c||(c=p.pop(),h=p[p.length-1],v=n.pop(),l=!0);if(c.leaf){a:{e=a;var r=c.children,k=b;if(k){for(var m=0;m<r.length;m++)if(k(e,r[m])){e=m;break a}e=-1}else e=r.indexOf(e)}if(-1!==e){c.children.splice(e,
1);p.push(c);this._condense(p);break}}l||c.leaf||!x(c,g)?h?(v++,c=h.children[v],l=!1):c=null:(p.push(c),n.push(v),v=0,h=c,c=c.children[0])}return this},toBBox:function(a){return a},compareMinX:c,compareMinY:g,toJSON:function(){return this.data},fromJSON:function(a){this.data=a;return this},_all:function(a,b){for(var c=[];a;)a.leaf?b.push.apply(b,a.children):c.push.apply(c,a.children),a=c.pop();return b},_build:function(a,b,c,g){var p=c-b+1,n=this._maxEntries,v;if(p<=n)return v=q(a.slice(b,c+1)),t(v,
this.toBBox),v;g||(g=Math.ceil(Math.log(p)/Math.log(n)),n=Math.ceil(p/Math.pow(n,g-1)));v=q([]);v.leaf=!1;v.height=g;var p=Math.ceil(p/n),n=p*Math.ceil(Math.sqrt(n)),h,e,l;for(D(a,b,c,n,this.compareMinX);b<=c;b+=n)for(e=Math.min(b+n-1,c),D(a,b,e,p,this.compareMinY),h=b;h<=e;h+=p)l=Math.min(h+p-1,e),v.children.push(this._build(a,h,l,g-1));t(v,this.toBBox);return v},_chooseSubtree:function(a,b,c,g){for(var p,n,v,h,e,l,r,y;;){g.push(b);if(b.leaf||g.length-1===c)break;r=y=Infinity;p=0;for(n=b.children.length;p<
n;p++)v=b.children[p],e=k(v),l=(Math.max(v.maxX,a.maxX)-Math.min(v.minX,a.minX))*(Math.max(v.maxY,a.maxY)-Math.min(v.minY,a.minY))-e,l<y?(y=l,r=e<r?e:r,h=v):l===y&&e<r&&(r=e,h=v);b=h||b.children[0]}return b},_insert:function(a,c,g){var k=this.toBBox;g=g?a:k(a);var k=[],p=this._chooseSubtree(g,this.data,c,k);p.children.push(a);for(b(p,g);0<=c;)if(k[c].children.length>this._maxEntries)this._split(k,c),c--;else break;this._adjustParentBBoxes(g,k,c)},_split:function(a,b){var c=a[b],g=c.children.length,
p=this._minEntries;this._chooseSplitAxis(c,p,g);g=this._chooseSplitIndex(c,p,g);g=q(c.children.splice(g,c.children.length-g));g.height=c.height;g.leaf=c.leaf;t(c,this.toBBox);t(g,this.toBBox);b?a[b-1].children.push(g):this._splitRoot(c,g)},_splitRoot:function(a,b){this.data=q([a,b]);this.data.height=a.height+1;this.data.leaf=!1;t(this.data,this.toBBox)},_chooseSplitIndex:function(a,b,c){var g,p,n,v,h,e,l;h=e=Infinity;for(g=b;g<=c-b;g++)p=m(a,0,g,this.toBBox),n=m(a,g,c,this.toBBox),v=Math.max(0,Math.min(p.maxX,
n.maxX)-Math.max(p.minX,n.minX))*Math.max(0,Math.min(p.maxY,n.maxY)-Math.max(p.minY,n.minY)),p=k(p)+k(n),v<h?(h=v,l=g,e=p<e?p:e):v===h&&p<e&&(e=p,l=g);return l},_chooseSplitAxis:function(a,b,k){var y=a.leaf?this.compareMinX:c,p=a.leaf?this.compareMinY:g,n=this._allDistMargin(a,b,k,y);b=this._allDistMargin(a,b,k,p);n<b&&a.children.sort(y)},_allDistMargin:function(a,c,g,k){a.children.sort(k);k=this.toBBox;var p=m(a,0,c,k),n=m(a,g-c,g,k),v=u(p)+u(n),h,e;for(h=c;h<g-c;h++)e=a.children[h],b(p,a.leaf?k(e):
e),v+=u(p);for(h=g-c-1;h>=c;h--)e=a.children[h],b(n,a.leaf?k(e):e),v+=u(n);return v},_adjustParentBBoxes:function(a,c,g){for(;0<=g;g--)b(c[g],a)},_condense:function(a){for(var b=a.length-1,c;0<=b;b--)0===a[b].children.length?0<b?(c=a[b-1].children,c.splice(c.indexOf(a[b]),1)):this.clear():t(a[b],this.toBBox)},_initFormat:function(a){var b=["return a"," - b",";"];this.compareMinX=new Function("a","b",b.join(a[0]));this.compareMinY=new Function("a","b",b.join(a[1]));this.toBBox=new Function("a","return {minX: a"+
a[0]+", minY: a"+a[1]+", maxX: a"+a[2]+", maxY: a"+a[3]+"};")}};return a})},"esri/core/libs/quickselect/quickselect":function(){define([],function(){function A(m,b,c,g,k){for(;g>c;){if(600<g-c){var u=g-c+1,x=b-c+1,C=Math.log(u),q=.5*Math.exp(2*C/3),C=.5*Math.sqrt(C*q*(u-q)/u)*(0>x-u/2?-1:1);A(m,b,Math.max(c,Math.floor(b-x*q/u+C)),Math.min(g,Math.floor(b+(u-x)*q/u+C)),k)}u=m[b];x=c;q=g;a(m,c,b);for(0<k(m[g],u)&&a(m,c,g);x<q;){a(m,x,q);x++;for(q--;0>k(m[x],u);)x++;for(;0<k(m[q],u);)q--}0===k(m[c],u)?
a(m,c,q):(q++,a(m,q,g));q<=b&&(c=q+1);b<=q&&(g=q-1)}}function a(a,b,c){var g=a[b];a[b]=a[c];a[c]=g}function t(a,b){return a<b?-1:a>b?1:0}return function(a,b,c,g,k){A(a,b,c||0,g||a.length-1,k||t)}})},"esri/layers/graphics/data/executeTileQuery":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../geometry/support/aaBoundingRect ../featureConversionUtils ../OptimizedGeometry ./QueryEngine ./utils".split(" "),
function(A,a,t,m,b,c,g,k,u,x){function C(a,b,c,p,n,k){a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);if(!b||!b.coords.length)return null;var h=b.coords;b=b.lengths;if(!b.length)return a.coords[0]=g.quantizeX(k,h[0]),a.coords[1]=g.quantizeY(k,h[1]),a.coords.length=c,a;for(var e,l,r,v,y=0,u,m=0,V=0;V<b.length;V++){var B=b[V];if(!(B<p)){u=m;r=e=g.quantizeX(k,h[y]);v=l=g.quantizeY(k,h[y+1]);a.coords[u]=r;a.coords[u+1]=v;y+=c;r=g.quantizeX(k,h[y]);v=g.quantizeY(k,h[y+1]);var L=
r-e,J=v-l,K=J/L;u+=2;a.coords[u]=L;a.coords[u+1]=J;e=r;l=v;for(var y=y+c,fa=2;fa<B;fa++){r=g.quantizeX(k,h[y]);v=g.quantizeY(k,h[y+1]);if(r!==e||v!==l){e=r-e;l=v-l;var x=l/e,K=K===x||!isFinite(K)&&!isFinite(x),q=(0<=J&&0<=l||0>=J&&0>=l)&&(0<=L&&0<=e||0>=L&&0>=e);K&&(n||q)?(L+=e,J+=l):(L=e,J=l,u+=2);a.coords[u]=L;a.coords[u+1]=J;K=x;e=r;l=v}y+=c}r=(u+2-m)/2;r>=p&&(a.lengths.push(r),m=u+2)}}a.coords.length>m&&(a.coords.length=m);return a.coords.length?a:null}Object.defineProperty(a,"__esModule",{value:!0});
var q=new k.default,D={esriGeometryPoint:g.convertToPoint,esriGeometryPolyline:g.convertToPolyline,esriGeometryPolygon:g.convertToPolygon,esriGeometryMultipoint:g.convertToMultipoint};a.executeTileQueryForIds=function(a,b,g){b=c.pad(b.bounds,g.pixelBuffer*b.resolution,c.create());var k=[];a.featureStore.forEachInBounds(b,function(b){return k.push(a.featureAdapter.getObjectId(b))});return k};a.createTileFeatures=function(a,b,c,g,n,k,h,e,l){var r=D[c.geometryType],p=E[c.geometryType],v="esriGeometryPolygon"===
c.geometryType&&!e,y=c.hasZ?c.hasM?4:3:c.hasM?3:2;h&&!k?g.forEachInBounds(n,function(e){if(!b.has(e.objectId)){var h=x.getCentroid(c,e,l),B=e.attributes;h&&(b.add(e.objectId),a.push(new u.Feature(B,e.localId,null,h)))}}):k&&!h?g.forEachInBounds(n,function(c){if(!b.has(c.objectId)){var e=c.attributes,B=r(C(q,c.geometry,y,p,v,l),!1,!1);B&&(b.add(c.objectId),a.push(new u.Feature(e,c.localId,B,null)))}}):g.forEachInBounds(n,function(e){if(!b.has(e.objectId)){var h=x.getCentroid(c,e,l),B=e.attributes,
g=r(C(q,e.geometry,y,p,v,l),!1,!1);g&&h&&(b.add(e.objectId),a.push(new u.Feature(B,e.localId,g,h)))}})};var E={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0};a.quantizeOptimizedGeometryForDisplay=C})},"esri/layers/graphics/data/QueryEngine":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/Error ../../../core/lang ../../../core/MemCache ../../../core/promiseUtils ../../../core/SetUtils ../../../core/unitUtils ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ./attributeSupport ./projectionSupport ./QueryEngineCapabilities ./QueryEngineResult ./spatialQuerySupport ./timeSupport ./utils ../../support/FieldsIndex ../../support/PromiseQueue".split(" "),
function(A,a,t,m,b,c,g,k,u,x,C,q,D,E,G,F,y,p,n,v,h,e,l,r,U){Object.defineProperty(a,"__esModule",{value:!0});A=function(){return function(a,b,c,B,e){void 0===b&&(b=null);this.attributes=a;this.geometry=c;this.centroid=B;this.filterFlags=e;this.groupId=-1;this.localId=b}}();a.Feature=A;var W=new Set,wa=new k.MemCacheStorage(2E6),sa=0;A=function(){function a(a){var b=this;this.capabilities={query:n.queryCapabilities};this.geometryType=a.geometryType;this.hasM=a.hasM;this.hasZ=a.hasZ;this.objectIdField=
a.objectIdField;this.spatialReference=a.spatialReference;this.definitionExpression=a.definitionExpression;this.featureStore=a.featureStore;this._changeHandle=this.featureStore.events.on("changed",function(){return b.clearCache()});this.timeInfo=a.timeInfo;a.cacheSpatialQueries&&(this._geometryQueryCache=new k.MemCache(sa++ +"$$",wa));this.fieldsIndex=new r(a.fields);a.scheduler&&a.task&&(this._frameQueue=new U.default,this._frameTask=a.scheduler.registerTask(a.task,function(a){return b._update(a)},
function(){return 0<b._frameQueue.length}))}a.prototype.destroy=function(){this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._frameQueue.cancelAll(),this._frameQueue=null);this.clearCache();this._geometryQueryCache&&this._geometryQueryCache.destroy();this._changeHandle&&(this._changeHandle.remove(),this._changeHandle=null);this.fieldsIndex.destroy()};Object.defineProperty(a.prototype,"featureAdapter",{get:function(){return this.featureStore.featureAdapter},enumerable:!0,configurable:!0});
Object.defineProperty(a.prototype,"fullExtent",{get:function(){var a=this.featureStore.fullBounds;return a?{xmin:a[0],ymin:a[1],xmax:a[2],ymax:a[3],spatialReference:l.cleanFromGeometryEngine(this.spatialReference)}:null},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"timeExtent",{get:function(){return this.timeInfo?this._timeExtent?this._timeExtent:this._timeExtent=e.getTimeExtent(this.timeInfo,this.featureStore):null},enumerable:!0,configurable:!0});a.prototype.clearCache=function(){this._geometryQueryCache&&
this._geometryQueryCache.clear();this._timeExtent=this._allItems=null};a.prototype.executeQuery=function(a,c){void 0===a&&(a={});return b(this,void 0,void 0,function(){var b,c,B,e=this;return m(this,function(h){switch(h.label){case 0:b=g.clone(a),h.label=1;case 1:return h.trys.push([1,8,,9]),[4,this._schedule(function(){return l.normalizeQuery(b,e.definitionExpression,e.spatialReference)})];case 2:return b=h.sent(),[4,this._reschedule(function(){return e._checkQuerySupport(b)})];case 3:return b=h.sent(),
[4,this._reschedule(function(){return e._executeGeometryQuery(b)})];case 4:return c=h.sent(),[4,this._reschedule(function(){return c.executeObjectIdsQuery(b)})];case 5:return c=h.sent(),[4,this._reschedule(function(){return c.executeTimeQuery(b)})];case 6:return c=h.sent(),[4,this._reschedule(function(){return c.executeAttributesQuery(b)})];case 7:return c=h.sent(),[3,9];case 8:B=h.sent();if(B!==l.QUERY_ENGINE_EMPTY_RESULT)throw B;c=new v.default([],null,this);return[3,9];case 9:return[2,c.createQueryResponse(b)]}})})};
a.prototype.executeQueryForCount=function(a,c){void 0===a&&(a={});return b(this,void 0,void 0,function(){var b,c,B,e=this;return m(this,function(h){switch(h.label){case 0:b=g.clone(a),b.returnGeometry=!1,b.returnCentroid=!1,b.outSR=null,h.label=1;case 1:return h.trys.push([1,8,,9]),[4,this._schedule(function(){return l.normalizeQuery(b,e.definitionExpression,e.spatialReference)})];case 2:return b=h.sent(),[4,this._reschedule(function(){return e._checkQuerySupport(b)})];case 3:return b=h.sent(),[4,
this._reschedule(function(){return e._executeGeometryQuery(b)})];case 4:return c=h.sent(),[4,this._reschedule(function(){return c.executeObjectIdsQuery(b)})];case 5:return c=h.sent(),[4,this._reschedule(function(){return c.executeTimeQuery(b)})];case 6:return c=h.sent(),[4,this._reschedule(function(){return c.executeAttributesQuery(b)})];case 7:return c=h.sent(),[2,c.size];case 8:B=h.sent();if(B!==l.QUERY_ENGINE_EMPTY_RESULT)throw B;return[2,0];case 9:return[2]}})})};a.prototype.executeQueryForExtent=
function(a,c){void 0===a&&(a={});return b(this,void 0,void 0,function(){var b,c,e,h,n,k,r,L,v=this;return m(this,function(J){switch(J.label){case 0:b=g.clone(a),e=b.outSR,J.label=1;case 1:return J.trys.push([1,8,,9]),[4,this._schedule(function(){return l.normalizeQuery(b,v.definitionExpression,v.spatialReference)})];case 2:return b=J.sent(),[4,this._reschedule(function(){return v._checkQuerySupport(b)})];case 3:return b=J.sent(),b.returnGeometry=!0,b.returnCentroid=!1,b.outSR=null,[4,this._reschedule(function(){return v._executeGeometryQuery(b)})];
case 4:return c=J.sent(),[4,this._reschedule(function(){return c.executeObjectIdsQuery(b)})];case 5:return c=J.sent(),[4,this._reschedule(function(){return c.executeTimeQuery(b)})];case 6:return c=J.sent(),[4,this._reschedule(function(){return c.executeAttributesQuery(b)})];case 7:c=J.sent();h=c.size;if(!h)return[2,{count:h,extent:null}];q.set(B,q.NEGATIVE_INFINITY);this.featureStore.forEachBounds(c.items,function(a){return q.expand(B,a)},V);n={xmin:B[0],ymin:B[1],xmax:B[3],ymax:B[4],spatialReference:l.cleanFromGeometryEngine(this.spatialReference)};
this.hasZ&&isFinite(B[2])&&isFinite(B[5])&&(n.zmin=B[2],n.zmax=B[5]);k=p.project(n,c.spatialReference,e);k.spatialReference=l.cleanFromGeometryEngine(e||this.spatialReference);0===k.xmax-k.xmin&&(r=C.getMetersPerUnitForSR(k.spatialReference),k.xmin-=r,k.xmax+=r);0===k.ymax-k.ymin&&(r=C.getMetersPerUnitForSR(k.spatialReference),k.ymin-=r,k.ymax+=r);this.hasZ&&null!=k.zmin&&null!=k.zmax&&0===k.zmax-k.zmin&&(r=C.getMetersPerUnitForSR(k.spatialReference),k.zmin-=r,k.zmax+=r);return[2,{count:h,extent:k}];
case 8:L=J.sent();if(L===l.QUERY_ENGINE_EMPTY_RESULT)return[2,{count:0,extent:null}];throw L;case 9:return[2]}})})};a.prototype.executeQueryForIds=function(a,c){void 0===a&&(a={});return b(this,void 0,void 0,function(){return m(this,function(b){return[2,this.executeQueryForIdSet(a,c).then(function(a){return x.valuesOfSet(a)})]})})};a.prototype.executeQueryForIdSet=function(a,c){void 0===a&&(a={});return b(this,void 0,void 0,function(){var b,c,B,e,h,k=this;return m(this,function(n){switch(n.label){case 0:b=
g.clone(a),b.returnGeometry=!1,b.returnCentroid=!1,b.outSR=null,n.label=1;case 1:return n.trys.push([1,9,,10]),[4,this._schedule(function(){return l.normalizeQuery(b,k.definitionExpression,k.spatialReference)})];case 2:return b=n.sent(),[4,this._reschedule(function(){return k._checkQuerySupport(b)})];case 3:return b=n.sent(),[4,this._reschedule(function(){return k._executeGeometryQuery(b)})];case 4:return c=n.sent(),[4,this._reschedule(function(){return c.executeObjectIdsQuery(b)})];case 5:return c=
n.sent(),[4,this._reschedule(function(){return c.executeTimeQuery(b)})];case 6:return c=n.sent(),[4,this._reschedule(function(){return c.executeAttributesQuery(b)})];case 7:return c=n.sent(),B=c.items,e=new Set,[4,this._reschedule(function(){for(var a=0,b=B;a<b.length;a++)e.add(c.featureAdapter.getObjectId(b[a]))})];case 8:return n.sent(),[2,e];case 9:h=n.sent();if(h===l.QUERY_ENGINE_EMPTY_RESULT)return[2,new Set];throw h;case 10:return[2]}})})};a.prototype.executeQueryForLatestObservations=function(a,
B){void 0===a&&(a={});return b(this,void 0,void 0,function(){var b,B,e,h=this;return m(this,function(n){switch(n.label){case 0:if(!this.timeInfo||!this.timeInfo.trackIdField)throw new c("feature-store:unsupported-query","Missing timeInfo or timeInfo.trackIdField",{query:a,timeInfo:this.timeInfo});b=g.clone(a);n.label=1;case 1:return n.trys.push([1,9,,10]),[4,this._schedule(function(){return l.normalizeQuery(b,h.definitionExpression,h.spatialReference)})];case 2:return b=n.sent(),[4,this._reschedule(function(){return h._checkQuerySupport(b)})];
case 3:return b=n.sent(),[4,this._reschedule(function(){return h._executeGeometryQuery(b)})];case 4:return B=n.sent(),[4,this._reschedule(function(){return B.executeObjectIdsQuery(b)})];case 5:return B=n.sent(),[4,this._reschedule(function(){return B.executeTimeQuery(b)})];case 6:return B=n.sent(),[4,this._reschedule(function(){return B.executeAttributesQuery(b)})];case 7:return B=n.sent(),[4,this._reschedule(function(){return B.filterLatest()})];case 8:return B=n.sent(),[3,10];case 9:e=n.sent();
if(e!==l.QUERY_ENGINE_EMPTY_RESULT)throw e;B=new v.default([],null,this);return[3,10];case 10:return[2,B.createQueryResponse(b)]}})})};a.prototype._schedule=function(a){return b(this,void 0,void 0,function(){return m(this,function(b){return this._frameQueue?[2,this._frameQueue.push(a)]:[2,a()]})})};a.prototype._reschedule=function(a){return b(this,void 0,void 0,function(){return m(this,function(b){return this._frameQueue?[2,this._frameQueue.unshift(a)]:[2,a()]})})};a.prototype._update=function(a){for(this._budget=
a;!a.done&&this._frameQueue&&this._frameQueue.process();)a.madeProgress();this._budget=null};a.prototype._getAll=function(){if(!this._allItems){var a=[];this.featureStore.forEach(function(b){return a.push(b)});this._allItems=new v.default(a,null,this)}return this._allItems};a.prototype._executeGeometryQuery=function(a){return b(this,void 0,void 0,function(){var c,B,e,n,g,k,l,r,p,L,J,y,u,V,U,x,q,W,D,sa,C=this;return m(this,function(K){switch(K.label){case 0:c=a.geometry;B=a.outSR;e=a.spatialRel;n=
F.isValid(B)&&!F.equals(this.spatialReference,B);if(g=this._geometryQueryCache?n?JSON.stringify({geometry:c,spatialRelationship:e,outSpatialReference:B}):JSON.stringify({geometry:c,spatialRelationship:e}):null)if(k=this._geometryQueryCache.get(g),void 0!==k)return[2,k];l=function(c){return b(C,void 0,void 0,function(){var b;return m(this,function(e){switch(e.label){case 0:return n&&(a.returnGeometry||a.returnCentroid)?[4,c.project(B)]:[3,2];case 1:return b=e.sent(),g&&this._geometryQueryCache.put(g,
b,b.size||1),[2,b];case 2:return g&&this._geometryQueryCache.put(g,c,c.size||1),[2,c]}})})};if(!c)return[2,l(this._getAll())];r=this.featureAdapter;if("esriSpatialRelDisjoint"!==e)return[3,3];p=this._searchFeatures(this._getQueryBBoxes(c));if(!p.length)return[2,l(this._getAll())];y=new Set;u=0;for(V=p;u<V.length;u++)U=V[u],y.add(r.getObjectId(U));return[4,this._reschedule(function(){var a=0;L=Array(y.size);C.featureStore.forEach(function(b){return L[a++]=b});J=y})];case 1:return K.sent(),[4,this._reschedule(function(){return b(C,
void 0,void 0,function(){var a,b,B;return m(this,function(n){switch(n.label){case 0:return[4,h.getSpatialQueryOperator(e,c,this)];case 1:return a=n.sent(),b=function(b){return!J.has(r.getObjectId(b))||a(r.getGeometry(b))},B=v.default.bind,[4,this._runSpatialFilter(L,b)];case 2:return[2,new (B.apply(v.default,[void 0,n.sent(),c,this]))]}})})})];case 2:return x=K.sent(),[2,l(x)];case 3:return q=this._searchFeatures(this._getQueryBBoxes(c)),q.length?(W=this._canExecuteSoloPass(c,a))?[2,l(new v.default(q,
c,this))]:[4,h.getSpatialQueryOperator(e,c,this)]:(x=new v.default([],c,this),g&&this._geometryQueryCache.put(g,x,x.size||1),[2,x]);case 4:return D=K.sent(),[4,this._runSpatialFilter(q,function(a){return D(r.getGeometry(a))})];case 5:return sa=K.sent(),[2,l(new v.default(sa,c,this))]}})})};a.prototype._runSpatialFilter=function(a,c){return b(this,void 0,void 0,function(){var B,e,h,n=this;return m(this,function(g){if(!c)return[2,a];if(!this._budget)return[2,a.filter(function(a){return c(a)})];B=0;
e=[];h=function(){return b(n,void 0,void 0,function(){var b;return m(this,function(n){switch(n.label){case 0:if(!(B<a.length))return[3,3];b=a[B];c(b)&&e.push(b);return this._budget.done?[4,this._reschedule(function(){return h()})]:[3,2];case 1:n.sent(),n.label=2;case 2:return++B,[3,0];case 3:return[2]}})})};return[2,this._reschedule(function(){return h()}).then(function(){return e})]})})};a.prototype._canExecuteSoloPass=function(a,b){var c=this.geometryType;b=b.spatialRel;return h.canQueryWithRBush(a)&&
("esriSpatialRelEnvelopeIntersects"===b||"esriGeometryPoint"===c&&("esriSpatialRelIntersects"===b||"esriSpatialRelContains"===b||"esriSpatialRelWithin"===b))};a.prototype._getQueryBBoxes=function(a){if(h.canQueryWithRBush(a)){if(G.isExtent(a))return[D.fromValues(a.xmin,a.ymin,a.xmax,a.ymax)];if(G.isPolygon(a))return a.rings.map(function(a){return D.fromValues(Math.min(a[0][0],a[2][0]),Math.min(a[0][1],a[2][1]),Math.max(a[0][0],a[2][0]),Math.max(a[0][1],a[2][1]))})}return[E.getBoundsXY(D.create(),
a)]};a.prototype._searchFeatures=function(a){for(var b=0;b<a.length;b++)this.featureStore.forEachInBounds(a[b],function(a){W.add(a)});var c=Array(W.size),B=0;W.forEach(function(a){return c[B++]=a});W.clear();return c};a.prototype._checkQuerySupport=function(a){return b(this,void 0,void 0,function(){return m(this,function(b){if(0>a.distance||null!=a.geometryPrecision||a.multipatchOption||a.pixelSize||a.relationParam||a.text)throw new c("feature-store:unsupported-query","Unsupported query options",
{query:a});return[2,u.all([this._checkAttributesQuerySupport(a),this._checkStatisticsQuerySupport(a),h.checkSpatialQuerySupport(a,this.geometryType,this.spatialReference),p.checkProjectionSupport(this.spatialReference,a.outSR)]).then(function(){return a})]})})};a.prototype._checkAttributesQuerySupport=function(a){var b=a.outFields,B=a.orderByFields,e=a.returnDistinctValues;B&&0<B.length&&(B=B.map(function(a){var b=a.toLowerCase();return-1<b.indexOf(" asc")?b.split(" asc")[0]:-1<b.indexOf(" desc")?
b.split(" desc")[0]:a}),y.validateFields(this.fieldsIndex,B,"orderByFields contains missing fields"));if(b&&0<b.length)y.validateFields(this.fieldsIndex,b,"outFields contains missing fields");else if(e)throw new c("feature-store:unsupported-query","outFields should be specified for returnDistinctValues",{query:a});y.validateWhere(this.fieldsIndex,a.where)};a.prototype._checkStatisticsQuerySupport=function(a){return b(this,void 0,void 0,function(){var b,B,e,h,n,g,l,k,r,p,L,v;return m(this,function(u){b=
a.outStatistics;B=a.groupByFieldsForStatistics;e=a.having;h=B&&B.length;n=b&&b.length;if(e){if(!h||!n)throw new c("feature-store:unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:a});y.validateHaving(this.fieldsIndex,e,b)}if(n){if(g=b.some(function(a){return"exceedslimit"===a.statisticType}))return[2];l=b.map(function(a){return a.onStatisticField});y.validateFields(this.fieldsIndex,l,"onStatisticFields contains missing fields");h&&y.validateFields(this.fieldsIndex,
B,"groupByFieldsForStatistics contains missing fields");k=0;for(r=b;k<r.length;k++)if(p=r[k],L=p.onStatisticField,v=p.statisticType,(!h||"count"!==v)&&L&&y.hasInvalidFieldType(L,this.fieldsIndex))throw new c("feature-store:unsupported-query","outStatistics contains non-numeric fields",{definition:p,query:a});}return[2]})})};return a}();a.default=A;var V=q.create(),B=q.create()})},"esri/layers/graphics/data/attributeSupport":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/Error ../../../core/SetUtils ../../../core/sql/WhereClauseCache".split(" "),
function(A,a,t,m,b,c){function g(a,b){return a?x.get(a,b):null}function k(a,b,c,x){void 0===x&&(x=!0);for(var q=[],y=0;y<b.length;y++){var p=b[y];if("*"!==p&&!a.has(p))if(x){var n=u(p);try{var v=g(n,a);if(!v)throw new m("feature-store:unsupported-query","invalid SQL expression",{where:n});if(!v.isStandardized)throw new m("feature-store:unsupported-query","expression is not standard",{clause:v});k(a,v.fieldNames,"expression contains missing fields")}catch(h){if((n=h&&h.details)&&(n.clause||n.where))throw h;
n&&n.missingFields?q.push.apply(q,n.missingFields):q.push(p)}}else q.push(p)}if(q.length)throw new m("feature-store:unsupported-query",c,{missingFields:q});}function u(a){return a.split(" as ")[0]}Object.defineProperty(a,"__esModule",{value:!0});var x=new c.WhereClauseCache(50,500),C=b.createSetFromValues("esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong esriFieldTypeDate".split(" "));a.validateWhere=function(a,b){if(!b)return!0;
var c=x.get(b,a);if(!c)throw new m("feature-store:unsupported-query","invalid SQL expression",{where:b});if(!c.isStandardized)throw new m("feature-store:unsupported-query","where clause is not standard",{where:b});k(a,c.fieldNames,"where clause contains missing fields");return!0};a.validateHaving=function(a,b,c){if(!b)return!0;var g=x.get(b,a);if(!g)throw new m("feature-store:unsupported-query","invalid SQL expression",{having:b});if(!g.isAggregate)throw new m("feature-store:unsupported-query","having does not contain a valid aggregate function",
{having:b});k(a,g.fieldNames,"having contains missing fields");if(!g.getExpressions().every(function(b){var g=b.aggregateType;b=b.field;var k=a.has(b)&&a.get(b).name;return c.some(function(b){var c=b.onStatisticField;b=b.statisticType;return(a.has(c)&&a.get(c).name)===k&&b.toLowerCase().trim()===g})}))throw new m("feature-store:unsupported-query","expressions in having should also exist in outStatistics",{having:b});return!0};a.getWhereClause=g;a.validateFields=k;a.getExpressionFromFieldName=u;a.getAliasFromFieldName=
function(a){return a.split(" as ")[1]};a.hasInvalidFieldType=function(a,b){return(a=b.get(a))?!C.has(a.type):!1}})},"esri/core/sql/WhereClauseCache":function(){define(["require","exports","../ItemCache","./WhereClause"],function(A,a,t,m){Object.defineProperty(a,"__esModule",{value:!0});A=function(){function a(a,b){this._cache=new t(a);this._invalidCache=new t(b)}a.prototype.get=function(a,b){var c=b.uid+":"+a,g=this._cache.get(c);if(g)return g;if(void 0!==this._invalidCache.get(c))return null;try{var x=
m.WhereClause.create(a,b);this._cache.put(c,x);return x}catch(C){return this._invalidCache.put(c,null),null}};return a}();a.WhereClauseCache=A})},"esri/core/ItemCache":function(){define(["require","exports","./MemCache"],function(A,a,t){return function(){function a(a,c){this._storage=new t.MemCacheStorage;this._storage.maxSize=a;c&&this._storage.registerRemoveFunc("",c)}a.prototype.put=function(a,c){this._storage.put(a,c,1,1)};a.prototype.pop=function(a){return this._storage.pop(a)};a.prototype.get=
function(a){return this._storage.get(a)};a.prototype.clear=function(){this._storage.clearAll()};a.prototype.destroy=function(){this._storage.clearAll()};return a}()})},"esri/core/sql/WhereClause":function(){define("require exports ../has ../MapUtils ./AggregateFunctions ./StandardizedFunctions ./WhereGrammar".split(" "),function(A,a,t,m,b,c,g){function k(a,b){a+="";return a.length>=b?a:Array(b-a.length+1).join("0")+a}function u(a,b,c,e,h,n,g,l,r){void 0===c&&(c="0");void 0===e&&(e="0");void 0===h&&
(h="0");void 0===n&&(n="0");void 0===g&&(g="");void 0===l&&(l="0");void 0===r&&(r="0");return"+"===g||"-"===g?(a=k(parseInt(a,10),4)+"-"+k(parseInt(b,10),2)+"-"+k(parseInt(c,10),2),b="",10>parseFloat(n)&&(b="0"),e=k(parseInt(e,10),2)+":"+k(parseInt(h,10),2)+":"+(b+parseFloat(n).toString()),g=""+g+k(parseInt(l,10),2)+":"+k(parseInt(r,10),2),new Date(a+"T"+e+g)):new Date(parseInt(a,10),parseInt(b,10)-1,parseInt(c,10),parseInt(e,10),parseInt(h,10),parseFloat(n))}function x(a){var b=r.exec(a);if(null!==
b){a=b[1];var c=b[2],e=b[3],h=b[4],n=b[5],g=b[6];return u(a,c,e,h,n,g)}b=U.exec(a);if(null!==b){a=b[1];var c=b[2],e=b[3],h=b[4],n=b[5],g=b[6],k=b[7],p=b[8],b=b[9];return u(a,c,e,h,n,g,k,p,b)}b=W.exec(a);if(null!==b)return a=b[1],c=b[2],e=b[3],h=b[4],n=b[5],k=b[6],p=b[7],b=b[8],u(a,c,e,h,n,"0",k,p,b);b=wa.exec(a);if(null!==b)return a=b[1],c=b[2],e=b[3],h=b[4],n=b[5],u(a,c,e,h,n);b=l.exec(a);if(null!==b)return a=b[1],c=b[2],e=b[3],u(a,c,e);throw Error("SQL Invalid Timestamp");}function C(a){a=l.exec(a);
if(null===a)throw Error("SQL Invalid Date");var b=a[2],c=a[3];return new Date(parseInt(a[1],10),parseInt(b,10)-1,parseInt(c,10))}function q(a){return Array.isArray(a)?a:[a]}function D(a){return null!==a?!0!==a:null}function E(a,b){return null!=a&&null!=b?!0===a&&!0===b:!1===a||!1===b?!1:null}function G(a,b){return null!=a&&null!=b?!0===a||!0===b:!0===a||!0===b?!0:null}function F(a,b){if(null==a)return null;for(var c=!1,e=0;e<b.length;e++){var h=b[e];if(null==h)c=null;else if(a===h){c=!0;break}}return c}
function y(a,b,c){if(null==a)return null;for(var e="",h=0,B=0;B<b.length;B++){var n=b.charAt(B);switch(h){case 0:n===c?h=1:e=0<="-[]/{}()*+?.\\^$|".indexOf(n)?e+("\\"+n):"%"===n?e+".*":"_"===n?e+".":e+n;break;case 1:e=0<="-[]/{}()*+?.\\^$|".indexOf(n)?e+("\\"+n):e+n,h=0}}return(new RegExp("^"+e+"$")).test(a)}function p(a){return a instanceof Date?a.valueOf():a}function n(a,b,c){if(null==b||null==c)return null;b=p(b);c=p(c);switch(a){case "\x3c\x3e":return b!==c;case "\x3d":return b===c;case "\x3e":return b>
c;case "\x3c":return b<c;case "\x3e\x3d":return b>=c;case "\x3c\x3d":return b<=c}}function v(a){for(var b=[],c={},e=0;e<a.length;e++){var h=a[e],n=h.toLowerCase();void 0===c[n]&&(b.push(h),c[n]=1)}return b}function h(a,b,e){if(b instanceof c.SqlInterval)if(e instanceof Date)switch(a){case "+":return new Date(b.valueInMilliseconds()+e.getTime());case "-":return b.valueInMilliseconds()-e.getTime();case "*":return b.valueInMilliseconds()*e.getTime();case "/":return b.valueInMilliseconds()/e.getTime()}else if(e instanceof
c.SqlInterval)switch(a){case "+":return c.SqlInterval.createFromMilliseconds(b.valueInMilliseconds()+e.valueInMilliseconds());case "-":return c.SqlInterval.createFromMilliseconds(b.valueInMilliseconds()-e.valueInMilliseconds());case "*":return b.valueInMilliseconds()*e.valueInMilliseconds();case "/":return b.valueInMilliseconds()/e.valueInMilliseconds()}else b=b.valueInMilliseconds();else if(e instanceof c.SqlInterval)if(b instanceof Date)switch(a){case "+":return new Date(e.valueInMilliseconds()+
b.getTime());case "-":return new Date(b.getTime()-e.valueInMilliseconds());case "*":return b.getTime()*e.valueInMilliseconds();case "/":return b.getTime()/e.valueInMilliseconds()}else e=e.valueInMilliseconds();else if(b instanceof Date&&"number"===typeof e)switch(e*=864E5,b=b.getTime(),a){case "+":return new Date(b+e);case "-":return new Date(b-e);case "*":return new Date(b*e);case "/":return new Date(b/e)}else if(e instanceof Date&&"number"===typeof b)switch(b*=864E5,e=e.getTime(),a){case "+":return new Date(b+
e);case "-":return new Date(b-e);case "*":return new Date(b*e);case "/":return new Date(b/e)}switch(a){case "+":return b+e;case "-":return b-e;case "*":return b*e;case "/":return b/e}}function e(a,b,c,e){a=e.getAttribute(a,b);return null!=a&&1===c[b]?new Date(a):a}Object.defineProperty(a,"__esModule",{value:!0});var l=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,r=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)$/,U=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)(\+|\-)(\d{1,2}):(\d{1,2})$/,
W=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})(\+|\-)(\d{1,2}):(\d{1,2})$/,wa=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/,sa=function(){function a(){}a.makeBool=function(a){return!0===a};a.featureValue=function(a,b,c,h){return e(a,b,c,h)};a.equalsNull=function(a){return null===a};a.applyLike=function(a,b,c){return y(a,b,c)};a.ensureArray=function(a){return q(a)};a.applyIn=function(a,b){return F(a,b)};a.currentDate=function(){var a=new Date;a.setHours(0,0,0,0);return a};a.makeSqlInterval=
function(a,b,e){return c.SqlInterval.createFromValueAndQualifer(a,b,e)};a.convertInterval=function(a){return a instanceof c.SqlInterval?a.valueInMilliseconds():a};a.currentTimestamp=function(){return new Date};a.compare=function(a,b,c){return n(a,b,c)};a.calculate=function(a,b,c){return h(a,b,c)};a.makeComparable=function(a){return p(a)};a.evaluateFunction=function(a,b){return c.evaluateFunction(a,b)};a.lookup=function(a,b){a=b[a];return void 0===a?null:a};a.between=function(a,b){return null==a||
null==b[0]||null==b[1]?null:a>=b[0]&&a<=b[1]};a.notbetween=function(a,b){return null==a||null==b[0]||null==b[1]?null:a<b[0]||a>b[1]};a.ternaryNot=function(a){return D(a)};a.ternaryAnd=function(a,b){return E(a,b)};a.ternaryOr=function(a,b){return G(a,b)};return a}();A=function(){function l(a,b){this.fieldsIndex=b;this.datefields={};this.parameters={};this.parseTree=g.WhereGrammar.parse(a);a=this.extractExpressionInfo(b);b=a.isStandardized;var c=a.isAggregate;this.referencedFieldNames=a.referencedFieldNames;
this.isStandardized=b;this.isAggregate=c}l.create=function(a,b){return new l(a,b)};Object.defineProperty(l.prototype,"fieldNames",{get:function(){return this.referencedFieldNames},enumerable:!0,configurable:!0});l.prototype.testSet=function(b,c){void 0===c&&(c=a.defaultAttributeAdapter);for(var e={},h=function(a){e[a]=b.map(function(b){return c.getAttribute(b,a)})},n=0,g=this.fieldNames;n<g.length;n++)h(g[n]);return!!this.evaluateNode(this.parseTree,{attributes:e},a.defaultAttributeAdapter)};l.prototype.calculateValue=
function(b,e){void 0===e&&(e=a.defaultAttributeAdapter);b=this.evaluateNode(this.parseTree,b,e);return b instanceof c.SqlInterval?b.valueInMilliseconds()/864E5:b};l.prototype.calculateValueCompiled=function(b,c){void 0===c&&(c=a.defaultAttributeAdapter);if(null!=this.parseTree._compiledVersion)return this.parseTree._compiledVersion(b,this.parameters,c,this.datefields);if(t("csp-restrictions"))return this.calculateValue(b,c);this.compileMe();return this.parseTree._compiledVersion(b,this.parameters,
c,this.datefields)};l.prototype.testFeature=function(b,c){void 0===c&&(c=a.defaultAttributeAdapter);return!!this.evaluateNode(this.parseTree,b,c)};l.prototype.testFeatureCompiled=function(b,c){void 0===c&&(c=a.defaultAttributeAdapter);if(null!=this.parseTree._compiledVersion)return!!this.parseTree._compiledVersion(b,this.parameters,c,this.datefields);if(t("csp-restrictions"))return this.testFeature(b,c);this.compileMe();return!!this.parseTree._compiledVersion(b,this.parameters,c,this.datefields)};
l.prototype.getFunctions=function(){var a=[];this.visitAll(this.parseTree,function(b){"function"===b.type&&a.push(b.name.toLowerCase())});return v(a)};l.prototype.getExpressions=function(){var a=new Map;this.visitAll(this.parseTree,function(b){if("function"===b.type){var c=b.name.toLowerCase();b=b.args.value[0];if("column_ref"===b.type){b=b.column;var e=c+"-"+b;a.has(e)||a.set(e,{aggregateType:c,field:b})}}});return m.valuesOfMap(a)};l.prototype.getVariables=function(){var a=[];this.visitAll(this.parseTree,
function(b){"param"===b.type&&a.push(b.value.toLowerCase())});return v(a)};l.prototype.compileMe=function(){var a="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=(new Function("feature","lookups","attributeAdapter","datefields",a)).bind(sa)};l.prototype.extractExpressionInfo=function(a){var e=this,h=[],n=!0,g=!0;this.visitAll(this.parseTree,function(l){switch(l.type){case "column_ref":var k=a.get(l.column),r=k&&k.name;!k||"date"!==k.type&&
"esriFieldTypeDate"!==k.type||(e.datefields[k.name]=1);void 0!==r?(h.push(r),l.column=r):h.push(l.column);break;case "function":k=l.name,l=l.args.value.length,n&&(n=c.isStandardized(k,l)),g&&(g=b.isAggregate(k,l))}});return{referencedFieldNames:v(h),isStandardized:n,isAggregate:g}};l.prototype.visitAll=function(a,b){if(null!=a)switch(b(a),a.type){case "when_clause":this.visitAll(a.operand,b);this.visitAll(a.value,b);break;case "case_expression":for(var c=0,e=a.clauses;c<e.length;c++){var h=e[c];this.visitAll(h,
b)}"simple"===a.format&&this.visitAll(a.operand,b);null!==a.else&&this.visitAll(a.else,b);break;case "expr_list":c=0;for(a=a.value;c<a.length;c++)h=a[c],this.visitAll(h,b);break;case "unary_expr":this.visitAll(a.expr,b);break;case "binary_expr":this.visitAll(a.left,b);this.visitAll(a.right,b);break;case "function":this.visitAll(a.args,b)}};l.prototype.evaluateNodeToJavaScript=function(a){switch(a.type){case "interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(a.value)+", "+JSON.stringify(a.qualifier)+
","+JSON.stringify(a.op)+")";case "case_expression":var b="";if("simple"===a.format)for(var c="this.makeComparable("+this.evaluateNodeToJavaScript(a.operand)+")",b="( ",e=0;e<a.clauses.length;e++)b+=" ("+c+" \x3d\x3d\x3d this.makeComparable("+this.evaluateNodeToJavaScript(a.clauses[e].operand)+")) ? ("+this.evaluateNodeToJavaScript(a.clauses[e].value)+") : ";else for(b="( ",e=0;e<a.clauses.length;e++)b+=" this.makeBool("+this.evaluateNodeToJavaScript(a.clauses[e].operand)+")\x3d\x3d\x3dtrue ? ("+
this.evaluateNodeToJavaScript(a.clauses[e].value)+") : ";b=null!==a.else?b+this.evaluateNodeToJavaScript(a.else):b+"null";return b+" )";case "param":return"this.lookup("+JSON.stringify(a.value.toLowerCase())+",lookups)";case "expr_list":b="[";c=0;for(a=a.value;c<a.length;c++)e=a[c],"["!==b&&(b+=","),b+=this.evaluateNodeToJavaScript(e);return b+"]";case "unary_expr":return"this.ternaryNot("+this.evaluateNodeToJavaScript(a.expr)+")";case "binary_expr":switch(a.operator){case "AND":return"this.ternaryAnd("+
this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+" )";case "OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+" )";case "IS":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return"this.equalsNull("+this.evaluateNodeToJavaScript(a.left)+")";case "ISNOT":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(a.left)+")))";case "IN":return"this.applyIn("+
this.evaluateNodeToJavaScript(a.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(a.right)+"))";case "NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(a.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(a.right)+")))";case "BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")";case "NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+
")";case "LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+","+JSON.stringify(a.escape)+")";case "NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+","+JSON.stringify(a.escape)+"))";case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return"this.compare("+JSON.stringify(a.operator)+","+this.evaluateNodeToJavaScript(a.left)+","+
this.evaluateNodeToJavaScript(a.right)+")";case "*":case "-":case "+":case "/":return"this.calculate("+JSON.stringify(a.operator)+","+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")"}throw Error("Not Supported Operator "+a.operator);case "null":case "bool":case "string":case "number":return JSON.stringify(a.value);case "date":return"(new Date("+C(a.value).getTime().toString()+"))";case "timestamp":return"(new Date("+x(a.value).getTime().toString()+"))";case "current_time":return"date"===
a.mode?"this.currentDate()":"this.currentTimestamp()";case "column_ref":return"this.featureValue(feature,"+JSON.stringify(a.column)+",datefields,attributeAdapter)";case "function":return"this.evaluateFunction("+JSON.stringify(a.name)+","+this.evaluateNodeToJavaScript(a.args)+")"}throw Error("Unsupported sql syntax "+a.type);};l.prototype.evaluateNode=function(a,g,l){switch(a.type){case "interval":return g=this.evaluateNode(a.value,g,l),c.SqlInterval.createFromValueAndQualifer(g,a.qualifier,a.op);
case "case_expression":if("simple"===a.format)for(var k=p(this.evaluateNode(a.operand,g,l)),r=0;r<a.clauses.length;r++){if(k===p(this.evaluateNode(a.clauses[r].operand,g,l)))return this.evaluateNode(a.clauses[r].value,g,l)}else for(r=0;r<a.clauses.length;r++)if(!0===this.evaluateNode(a.clauses[r].operand,g,l))return this.evaluateNode(a.clauses[r].value,g,l);return null!==a.else?this.evaluateNode(a.else,g,l):null;case "param":return this.parameters[a.value.toLowerCase()];case "expr_list":k=[];r=0;
for(a=a.value;r<a.length;r++)k.push(this.evaluateNode(a[r],g,l));return k;case "unary_expr":return D(this.evaluateNode(a.expr,g,l));case "binary_expr":switch(a.operator){case "AND":return E(this.evaluateNode(a.left,g,l),this.evaluateNode(a.right,g,l));case "OR":return G(this.evaluateNode(a.left,g,l),this.evaluateNode(a.right,g,l));case "IS":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return null===this.evaluateNode(a.left,g,l);case "ISNOT":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");
return null!==this.evaluateNode(a.left,g,l);case "IN":return k=q(this.evaluateNode(a.right,g,l)),F(this.evaluateNode(a.left,g,l),k);case "NOT IN":return k=q(this.evaluateNode(a.right,g,l)),D(F(this.evaluateNode(a.left,g,l),k));case "BETWEEN":return k=this.evaluateNode(a.left,g,l),a=this.evaluateNode(a.right,g,l),null==k||null==a[0]||null==a[1]?null:k>=p(a[0])&&k<=p(a[1]);case "NOTBETWEEN":return k=this.evaluateNode(a.left,g,l),a=this.evaluateNode(a.right,g,l),null==k||null==a[0]||null==a[1]?null:
k<p(a[0])||k>p(a[1]);case "LIKE":return y(this.evaluateNode(a.left,g,l),this.evaluateNode(a.right,g,l),a.escape);case "NOT LIKE":return D(y(this.evaluateNode(a.left,g,l),this.evaluateNode(a.right,g,l),a.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return n(a.operator,this.evaluateNode(a.left,g,l),this.evaluateNode(a.right,g,l));case "-":case "+":case "*":case "/":return h(a.operator,this.evaluateNode(a.left,g,l),this.evaluateNode(a.right,g,l))}throw Error("Not Supported Operator "+
a.operator);case "null":case "bool":case "string":case "number":return a.value;case "date":return C(a.value);case "timestamp":return x(a.value);case "current_time":return g=new Date,"date"===a.mode&&g.setHours(0,0,0,0),g;case "column_ref":return e(g,a.column,this.datefields,l);case "function":return g=this.evaluateNode(a.args,g,l),this.isAggregate?b.aggregateFunction(a.name,g):c.evaluateFunction(a.name,g)}throw Error("Unsupported sql syntax "+a.type);};return l}();a.WhereClause=A;a.defaultAttributeAdapter=
{getAttribute:function(a,b){return(a&&"object"===typeof a.attributes?a.attributes:a)[b]}}})},"esri/core/sql/AggregateFunctions":function(){define(["require","exports"],function(A,a){function t(a){for(var b=0,c=0;c<a.length;c++)b+=a[c];return b/a.length}function m(a){for(var b=t(a),c=a.length,u=0,m=0;m<a.length;m++)u+=Math.pow(a[m]-b,2);return 1<c?u/(c-1):0}Object.defineProperty(a,"__esModule",{value:!0});a.aggregateFunction=function(a,g){var c=b[a.toLowerCase()];if(null==c)throw Error("Function Not Recognised");
if(g.length<c.minParams||g.length>c.maxParams)throw Error("Invalid Parameter count for call to "+a.toUpperCase());return c.evaluate(g)};a.isAggregate=function(a,g){a=b[a.toLowerCase()];return null!=a&&g>=a.minParams&&g<=a.maxParams};var b={min:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.min.apply(Math,a[0])}},max:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.max.apply(Math,a[0])}},avg:{minParams:1,maxParams:1,evaluate:function(a){return null==
a[0]?null:t(a[0])}},sum:{minParams:1,maxParams:1,evaluate:function(a){if(null==a[0])a=null;else{a=a[0];for(var b=0,c=0;c<a.length;c++)b+=a[c];a=b}return a}},stddev:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.sqrt(m(a[0]))}},count:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].length}},var:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:m(a[0])}}}})},"esri/core/sql/StandardizedFunctions":function(){define(["require","exports",
"../string"],function(A,a,t){Object.defineProperty(a,"__esModule",{value:!0});A=function(){function a(){this.op="+";this.minute=this.year=this.month=this.hour=this.second=this.day=0}a.fixDefaults=function(a){if(null!==a.precision||null!==a.secondary)throw Error("Primary and Secondary SqlInterval qualifiers not supported");};a.createFromMilliseconds=function(b){var c=new a;c.second=b/1E3;return c};a.createFromValueAndQualifer=function(b,g,k){var c=null,m=new a;m.op="-"===k?"-":"+";if("interval-period"===
g.type){a.fixDefaults(g);if("year"===g.period||"month"===g.period)throw Error("Year-Month Intervals not supported");if(/^[0-9]{1,}$/.test(b))m[g.period]=parseFloat(b);else throw Error("Illegal Interval");}else{a.fixDefaults(g.start);a.fixDefaults(g.end);if("year"===g.start.period||"month"===g.start.period)throw Error("Year-Month Intervals not supported");if("year"===g.end.period||"month"===g.end.period)throw Error("Year-Month Intervals not supported");switch(g.start.period){case "day":switch(g.end.period){case "hour":c=
/^[0-9]{1,} [0-9]{1,}$/;if(c.test(b))m[g.start.period]=parseFloat(b.split(" ")[0]),m[g.end.period]=parseFloat(b.split(" ")[1]);else throw Error("Illegal Interval");break;case "minute":c=/^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$/;if(c.test(b))m[g.start.period]=parseFloat(b.split(" ")[0]),b=b.split(" ")[1].split(":"),m.hour=parseFloat(b[0]),m.minute=parseFloat(b[1]);else throw Error("Illegal Interval");break;case "second":c=/^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(c.test(b))m[g.start.period]=
parseFloat(b.split(" ")[0]),b=b.split(" ")[1].split(":"),m.hour=parseFloat(b[0]),m.minute=parseFloat(b[1]),m.second=parseFloat(b[2]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;case "hour":switch(g.end.period){case "minute":c=/^[0-9]{1,}:[0-9]{1,}$/;if(c.test(b))m.hour=parseFloat(b.split(":")[0]),m.minute=parseFloat(b.split(":")[1]);else throw Error("Illegal Interval");break;case "second":c=/^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(c.test(b))b=
b.split(":"),m.hour=parseFloat(b[0]),m.minute=parseFloat(b[1]),m.second=parseFloat(b[2]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;case "minute":switch(g.end.period){case "second":c=/^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(c.test(b))b=b.split(":"),m.minute=parseFloat(b[0]),m.second=parseFloat(b[1]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;default:throw"Invalid Interval.";}}return m};a.prototype.valueInMilliseconds=
function(){return("-"===this.op?-1:1)*(1E3*this.second+6E4*this.minute+36E5*this.hour+864E5*this.day+365/12*this.month*864E5+31536E6*this.year)};return a}();a.SqlInterval=A;a.evaluateFunction=function(a,c){var b=m[a.toLowerCase()];if(null==b)throw Error("Function Not Recognised");if(c.length<b.minParams||c.length>b.maxParams)throw Error("Invalid Parameter count for call to "+a.toUpperCase());return b.evaluate(c)};a.isStandardized=function(a,c){a=m[a.toLowerCase()];return null!=a&&c>=a.minParams&&
c<=a.maxParams};var m={extract:{minParams:2,maxParams:2,evaluate:function(a){var b=a[0];a=a[1];if(null==a)return null;if(a instanceof Date)switch(b.toUpperCase()){case "SECOND":return a.getSeconds();case "MINUTE":return a.getMinutes();case "HOUR":return a.getHours();case "DAY":return a.getDate();case "MONTH":return a.getMonth()+1;case "YEAR":return a.getFullYear()}throw Error("Invalid Parameter for call to EXTRACT");}},substring:{minParams:2,maxParams:3,evaluate:function(a){if(2===a.length){var b=
a[0],g=a[1];return null==b||null==g?null:b.toString().substring(g-1)}if(3===a.length)return b=a[0],g=a[1],a=a[2],null==b||null==g||null==a?null:0>=a?"":b.toString().substring(g-1,g+a-1)}},position:{minParams:2,maxParams:2,evaluate:function(a){var b=a[0];a=a[1];return null==b||null==a?null:a.indexOf(b)+1}},trim:{minParams:2,maxParams:3,evaluate:function(a){var b=3===a.length,g=b?a[1]:" ",b=b?a[2]:a[1];if(null==g||null==b)return null;g="("+t.escapeRegExpString(g)+")";switch(a[0]){case "BOTH":return b.replace(new RegExp("^"+
g+"*|"+g+"*$","g"),"");case "LEADING":return b.replace(new RegExp("^"+g+"*","g"),"");case "TRAILING":return b.replace(new RegExp(g+"*$","g"),"")}throw Error("Invalid Parameter for call to TRIM");}},abs:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.abs(a[0])}},ceiling:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.ceil(a[0])}},floor:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.floor(a[0])}},log:{minParams:1,maxParams:1,
evaluate:function(a){return null==a[0]?null:Math.log(a[0])}},log10:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.log(a[0])*Math.LOG10E}},sin:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.sin(a[0])}},cos:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.cos(a[0])}},tan:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.tan(a[0])}},asin:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?
null:Math.asin(a[0])}},acos:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.acos(a[0])}},atan:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.atan(a[0])}},sign:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:0<a[0]?1:0>a[1]?-1:0}},power:{minParams:2,maxParams:2,evaluate:function(a){return null==a[0]||null==a[1]?null:Math.pow(a[0],a[1])}},mod:{minParams:2,maxParams:2,evaluate:function(a){return null==a[0]||null==a[1]?null:a[0]%
a[1]}},round:{minParams:1,maxParams:2,evaluate:function(a){var b=a[0];a=2===a.length?Math.pow(10,a[1]):1;return null==b?null:Math.round(b*a)/a}},truncate:{minParams:1,maxParams:2,evaluate:function(a){return null==a[0]?null:1===a.length?parseInt(a[0].toFixed(0),10):parseFloat(a[0].toFixed(a[1]))}},char_length:{minParams:1,maxParams:1,evaluate:function(a){return"string"===typeof a[0]||a[0]instanceof String?a[0].length:0}},concat:{minParams:1,maxParams:Infinity,evaluate:function(a){for(var b="",g=0;g<
a.length;g++){if(null==a[g])return null;b+=a[g].toString()}return b}},lower:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].toString().toLowerCase()}},upper:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].toString().toUpperCase()}}}})},"esri/core/sql/WhereGrammar":function(){define(["require","exports","./sql92grammar"],function(A,a,t){Object.defineProperty(a,"__esModule",{value:!0});A=function(){function a(){}a.parse=function(a){return t.parse(a)};
return a}();a.WhereGrammar=A})},"esri/core/sql/sql92grammar":function(){define([],function(){function A(a,t,m,b){this.message=a;this.expected=t;this.found=m;this.location=b;this.name="SyntaxError";"function"===typeof Error.captureStackTrace&&Error.captureStackTrace(this,A)}(function(a,t){function m(){this.constructor=a}m.prototype=t.prototype;a.prototype=new m})(A,Error);A.buildMessage=function(a,t){function m(a){return a.charCodeAt(0).toString(16).toUpperCase()}function b(a){return a.replace(/\\/g,
"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+m(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+m(a)})}function c(a){return a.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+m(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,
function(a){return"\\x"+m(a)})}var g={literal:function(a){return'"'+b(a.text)+'"'},"class":function(a){var b="",g;for(g=0;g<a.parts.length;g++)b+=a.parts[g]instanceof Array?c(a.parts[g][0])+"-"+c(a.parts[g][1]):c(a.parts[g]);return"["+(a.inverted?"^":"")+b+"]"},any:function(a){return"any character"},end:function(a){return"end of input"},other:function(a){return a.description}};return"Expected "+function(a){var b=Array(a.length),c;for(c=0;c<a.length;c++){var k=c,m;m=a[c];m=g[m.type](m);b[k]=m}b.sort();
if(0<b.length){for(a=c=1;c<b.length;c++)b[c-1]!==b[c]&&(b[a]=b[c],a++);b.length=a}switch(b.length){case 1:return b[0];case 2:return b[0]+" or "+b[1];default:return b.slice(0,-1).join(", ")+", or "+b[b.length-1]}}(a)+" but "+(t?'"'+b(t)+'"':"end of input")+" found."};return{SyntaxError:A,parse:function(a,t){function m(a,d){return{type:"literal",text:a,ignoreCase:d}}function b(a,d,b){return{type:"class",parts:a,inverted:d,ignoreCase:b}}function c(d){var b=ya[d],f;if(!b){for(f=d-1;!ya[f];)f--;b=ya[f];
for(b={line:b.line,column:b.column};f<d;)10===a.charCodeAt(f)?(b.line++,b.column=1):b.column++,f++;ya[d]=b}return b}function g(a,d){var b=c(a),f=c(d);return{start:{offset:a,line:b.line,column:b.column},end:{offset:d,line:f.line,column:f.column}}}function k(a){f<ba||(f>ba&&(ba=f,Qa=[]),Qa.push(a))}function u(){var a,b,c;a=f;b=z();b!==d?(b=C(),b!==d?(c=z(),c!==d?a=b:(f=a,a=d)):(f=a,a=d)):(f=a,a=d);return a}function x(){var a,b,c,e,h,g,l,n;a=f;b=C();if(b!==d){c=[];e=f;h=z();h!==d?(g=Ha(),g!==d?(l=z(),
l!==d?(n=C(),n!==d?e=h=[h,g,l,n]:(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d);for(;e!==d;)c.push(e),e=f,h=z(),h!==d?(g=Ha(),g!==d?(l=z(),l!==d?(n=C(),n!==d?e=h=[h,g,l,n]:(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d);if(c!==d){a={type:"expr_list"};b=[b];for(e=0;e<c.length;e++)b.push(c[e][3]);a.value=b}else f=a,a=d}else f=a,a=d;return a}function C(){var a,b,c,e,h,g,l,n;a=f;b=q();if(b!==d){c=[];e=f;h=z();h!==d?(g=ha(),g!==d?(l=z(),l!==d?(n=q(),n!==d?e=h=[h,g,l,n]:(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d);
for(;e!==d;)c.push(e),e=f,h=z(),h!==d?(g=ha(),g!==d?(l=z(),l!==d?(n=q(),n!==d?e=h=[h,g,l,n]:(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d);c!==d?a=b=za(b,c):(f=a,a=d)}else f=a,a=d;return a}function q(){var a,b,c,e,h,g,l,n;a=f;b=D();if(b!==d){c=[];e=f;h=z();h!==d?(g=aa(),g!==d?(l=z(),l!==d?(n=D(),n!==d?e=h=[h,g,l,n]:(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d);for(;e!==d;)c.push(e),e=f,h=z(),h!==d?(g=aa(),g!==d?(l=z(),l!==d?(n=D(),n!==d?e=h=[h,g,l,n]:(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d);c!==d?a=b=
za(b,c):(f=a,a=d)}else f=a,a=d;return a}function D(){var b,e,c,h,g;b=f;e=ga();e===d&&(e=f,33===a.charCodeAt(f)?(c=ad,f++):(c=d,0===w&&k(bd)),c!==d?(h=f,w++,61===a.charCodeAt(f)?(g=$a,f++):(g=d,0===w&&k(ab)),w--,g===d?h=void 0:(f=h,h=d),h!==d?e=c=[c,h]:(f=e,e=d)):(f=e,e=d));e!==d?(c=z(),c!==d?(h=D(),h!==d?b=e={type:"unary_expr",operator:"NOT",expr:h}:(f=b,b=d)):(f=b,b=d)):(f=b,b=d);if(b===d)if(b=f,e=y(),e!==d)if(c=z(),c!==d){var l,n,p;c=[];h=f;g=z();g!==d?(l=E(),l!==d?(n=z(),n!==d?(p=y(),p!==d?h=g=
[g,l,n,p]:(f=h,h=d)):(f=h,h=d)):(f=h,h=d)):(f=h,h=d);if(h!==d)for(;h!==d;)c.push(h),h=f,g=z(),g!==d?(l=E(),l!==d?(n=z(),n!==d?(p=y(),p!==d?h=g=[g,l,n,p]:(f=h,h=d)):(f=h,h=d)):(f=h,h=d)):(f=h,h=d);else c=d;c!==d&&(c={type:"arithmetic",tail:c});c===d&&(c=f,h=F(),h!==d?(g=z(),g!==d?(g=ca(),g!==d?(g=z(),g!==d?(g=x(),g!==d?(l=z(),l!==d?(l=da(),l!==d?c=h={op:h,right:g}:(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d),c===d&&(c=f,h=F(),h!==d?(g=z(),g!==d?(g=ca(),g!==d?(g=z(),g!==
d?(g=da(),g!==d?c=h={op:h,right:{type:"expr_list",value:[]}}:(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d),c===d&&(c=f,h=F(),h!==d?(g=z(),g!==d?(g=W(),g!==d?c=h={op:h,right:g}:(f=c,c=d)):(f=c,c=d)):(f=c,c=d))),c===d&&(c=f,g=ga(),g!==d?(h=z(),h!==d?(h=ia(),h!==d?(l=z(),l!==d?(l=y(),l!==d?(n=z(),n!==d?(n=aa(),n!==d?(g=z(),g!==d?(g=y(),g!==d?c=g={op:"NOT"+h,right:{type:"expr_list",value:[l,g]}}:(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d),
c===d&&(c=f,g=ia(),g!==d?(h=z(),h!==d?(h=y(),h!==d?(l=z(),l!==d?(l=aa(),l!==d?(n=z(),n!==d?(n=y(),n!==d?c=g={op:g,right:{type:"expr_list",value:[h,n]}}:(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)),c===d&&(c=f,h=T(),h!==d?(g=z(),g!==d?(g=ga(),g!==d?(g=z(),g!==d?(g=y(),g!==d?c=h={op:h+"NOT",right:g}:(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d),c===d&&(c=f,h=T(),h!==d?(g=z(),g!==d?(g=y(),g!==d?c=h={op:h,right:g}:(f=c,c=d)):(f=c,c=d)):(f=c,c=d)),c===d&&(c=f,h=
G(),h!==d?(g=z(),g!==d?(g=J(),g!==d?(l=z(),l!==d?(l=f,a.substr(f,6).toLowerCase()===cd?(n=a.substr(f,6),f+=6):(n=d,0===w&&k(dd)),n!==d?(n=f,w++,p=r(),w--,p===d?n=void 0:(f=n,n=d),n!==d?l="ESCAPE":(f=l,l=d)):(f=l,l=d),l!==d?(l=z(),l!==d?(l=K(),l!==d?c=h={op:h,right:g,escape:l.value}:(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d),c===d&&(c=f,h=G(),h!==d?(g=z(),g!==d?(g=J(),g!==d?c=h={op:h,right:g,escape:""}:(f=c,c=d)):(f=c,c=d)):(f=c,c=d))))));c===d&&(c=null);c!==d?(b=e,
e=c,""==e||void 0==e||null==e?e=b:(c=null,e=c="arithmetic"==e.type?za(b,e.tail):bb(e.op,b,e.right,e.escape)),b=e):(f=b,b=d)}else f=b,b=d;else f=b,b=d;return b}function E(){var b;a.substr(f,2)===cb?(b=cb,f+=2):(b=d,0===w&&k(ed));b===d&&(62===a.charCodeAt(f)?(b=fd,f++):(b=d,0===w&&k(gd)),b===d&&(a.substr(f,2)===db?(b=db,f+=2):(b=d,0===w&&k(hd)),b===d&&(a.substr(f,2)===eb?(b=eb,f+=2):(b=d,0===w&&k(id)),b===d&&(60===a.charCodeAt(f)?(b=jd,f++):(b=d,0===w&&k(kd)),b===d&&(61===a.charCodeAt(f)?(b=$a,f++):
(b=d,0===w&&k(ab)),b===d&&(a.substr(f,2)===fb?(b=fb,f+=2):(b=d,0===w&&k(ld))))))));return b}function G(){var a,b,c,e;a=a=f;b=ga();b!==d?(c=z(),c!==d?(e=Y(),e!==d?a=b=[b,c,e]:(f=a,a=d)):(f=a,a=d)):(f=a,a=d);a!==d&&(a=a[0]+" "+a[2]);a===d&&(a=Y());return a}function F(){var a,b,c,e;a=a=f;b=ga();b!==d?(c=z(),c!==d?(e=oa(),e!==d?a=b=[b,c,e]:(f=a,a=d)):(f=a,a=d)):(f=a,a=d);a!==d&&(a=a[0]+" "+a[2]);a===d&&(a=oa());return a}function y(){var a,b,c,e,h,g,l,r;a=f;b=n();if(b!==d){c=[];e=f;h=z();h!==d?(g=p(),
g!==d?(l=z(),l!==d?(r=n(),r!==d?e=h=[h,g,l,r]:(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d);for(;e!==d;)c.push(e),e=f,h=z(),h!==d?(g=p(),g!==d?(l=z(),l!==d?(r=n(),r!==d?e=h=[h,g,l,r]:(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d);c!==d?a=b=za(b,c):(f=a,a=d)}else f=a,a=d;return a}function p(){var b;43===a.charCodeAt(f)?(b=bc,f++):(b=d,0===w&&k(cc));b===d&&(45===a.charCodeAt(f)?(b=dc,f++):(b=d,0===w&&k(ec)));return b}function n(){var a,b,c,e,g,l,n,r;a=f;b=h();if(b!==d){c=[];e=f;g=z();g!==d?(l=v(),l!==d?(n=
z(),n!==d?(r=h(),r!==d?e=g=[g,l,n,r]:(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d);for(;e!==d;)c.push(e),e=f,g=z(),g!==d?(l=v(),l!==d?(n=z(),n!==d?(r=h(),r!==d?e=g=[g,l,n,r]:(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d);c!==d?a=b=za(b,c):(f=a,a=d)}else f=a,a=d;return a}function v(){var b;42===a.charCodeAt(f)?(b=md,f++):(b=d,0===w&&k(nd));b===d&&(47===a.charCodeAt(f)?(b=od,f++):(b=d,0===w&&k(pd)));return b}function h(){var b,c,h,g,n,p,v;v=K();if(v===d){var m,y,u,B;m=f;var q,D,E,V;q=f;D=xa();D!==d?(E=M(),
E!==d?(V=pa(),V!==d?q=D=parseFloat(D+E+V):(f=q,q=d)):(f=q,q=d)):(f=q,q=d);q===d&&(q=f,D=xa(),D!==d?(E=M(),E!==d?q=D=parseFloat(D+E):(f=q,q=d)):(f=q,q=d),q===d&&(q=f,D=xa(),D!==d?(E=pa(),E!==d?q=D=parseFloat(D+E):(f=q,q=d)):(f=q,q=d),q===d&&(q=f,D=xa(),D!==d&&(D=parseFloat(D)),q=D)));y=q;y!==d?(u=f,w++,B=l(),w--,B===d?u=void 0:(f=u,u=d),u!==d?m=y={type:"number",value:y}:(f=m,m=d)):(f=m,m=d);v=m;if(v===d){var t,L;t=f;var A,G,F,S;A=f;a.substr(f,4).toLowerCase()===qd?(G=a.substr(f,4),f+=4):(G=d,0===w&&
k(rd));G!==d?(F=f,w++,S=r(),w--,S===d?F=void 0:(f=F,F=d),F!==d?A=G=[G,F]:(f=A,A=d)):(f=A,A=d);L=A;L!==d&&(L={type:"bool",value:!0});t=L;if(t===d){t=f;var T,X,Y,ga;T=f;a.substr(f,5).toLowerCase()===sd?(X=a.substr(f,5),f+=5):(X=d,0===w&&k(td));X!==d?(Y=f,w++,ga=r(),w--,ga===d?Y=void 0:(f=Y,Y=d),Y!==d?T=X=[X,Y]:(f=T,T=d)):(f=T,T=d);L=T;L!==d&&(L={type:"bool",value:!1});t=L}v=t;if(v===d){var ba,aa,ia,ha,za;aa=f;a.substr(f,4).toLowerCase()===ud?(ia=a.substr(f,4),f+=4):(ia=d,0===w&&k(vd));ia!==d?(ha=f,
w++,za=r(),w--,za===d?ha=void 0:(f=ha,ha=d),ha!==d?aa=ia=[ia,ha]:(f=aa,aa=d)):(f=aa,aa=d);ba=aa;ba!==d&&(ba={type:"null",value:null});v=ba;if(v===d){var ta,ya,Ha,Ca;ta=f;var Ia,va,gb,Qa;Ia=f;a.substr(f,4).toLowerCase()===wd?(va=a.substr(f,4),f+=4):(va=d,0===w&&k(xd));va!==d?(gb=f,w++,Qa=r(),w--,Qa===d?gb=void 0:(f=gb,gb=d),gb!==d?Ia=va="DATE":(f=Ia,Ia=d)):(f=Ia,Ia=d);ya=Ia;ya!==d?(Ha=z(),Ha!==d?(Ca=J(),Ca!==d?ta=ya={type:"date",value:Ca.value}:(f=ta,ta=d)):(f=ta,ta=d)):(f=ta,ta=d);v=ta;if(v===d){var ua,
fc,$a,gc;ua=f;var Ja,Gb,hb,ab;Ja=f;a.substr(f,9).toLowerCase()===yd?(Gb=a.substr(f,9),f+=9):(Gb=d,0===w&&k(zd));Gb!==d?(hb=f,w++,ab=r(),w--,ab===d?hb=void 0:(f=hb,hb=d),hb!==d?Ja=Gb="TIMESTAMP":(f=Ja,Ja=d)):(f=Ja,Ja=d);fc=Ja;fc!==d?($a=z(),$a!==d?(gc=J(),gc!==d?ua=fc={type:"timestamp",value:gc.value}:(f=ua,ua=d)):(f=ua,ua=d)):(f=ua,ua=d);v=ua;if(v===d){var N,Ra,Hb,qa,Ib,Sa,bb,hc;N=f;Ra=vc();Ra!==d?(Hb=z(),Hb!==d?(45===a.charCodeAt(f)?(qa=dc,f++):(qa=d,0===w&&k(ec)),qa===d&&(43===a.charCodeAt(f)?(qa=
bc,f++):(qa=d,0===w&&k(cc))),qa!==d?(Ib=z(),Ib!==d?(Sa=J(),Sa!==d?(bb=z(),bb!==d?(hc=sa(),hc!==d?N=Ra={type:"interval",value:Sa,qualifier:hc,op:qa}:(f=N,N=d)):(f=N,N=d)):(f=N,N=d)):(f=N,N=d)):(f=N,N=d)):(f=N,N=d)):(f=N,N=d);N===d&&(N=f,Ra=vc(),Ra!==d?(Hb=z(),Hb!==d?(qa=J(),qa!==d?(Ib=z(),Ib!==d?(Sa=sa(),Sa!==d?N=Ra={type:"interval",value:qa,qualifier:Sa,op:""}:(f=N,N=d)):(f=N,N=d)):(f=N,N=d)):(f=N,N=d)):(f=N,N=d));v=N}}}}}}b=v;if(b===d){var Q,ic,cb,db,eb,jc,fb,rb,sb,kc,tb,ub;Q=f;var Ka,Jb,ib,vb;Ka=
f;a.substr(f,7).toLowerCase()===Ad?(Jb=a.substr(f,7),f+=7):(Jb=d,0===w&&k(Bd));Jb!==d?(ib=f,w++,vb=r(),w--,vb===d?ib=void 0:(f=ib,ib=d),ib!==d?Ka=Jb="EXTRACT":(f=Ka,Ka=d)):(f=Ka,Ka=d);ic=Ka;if(ic!==d)if(cb=z(),cb!==d)if(db=ca(),db!==d)if(eb=z(),eb!==d){var ja;ja=wc();ja===d&&(ja=xc(),ja===d&&(ja=yc(),ja===d&&(ja=zc(),ja===d&&(ja=Ac(),ja===d&&(ja=Ga())))));jc=ja;jc!==d?(fb=z(),fb!==d?(rb=Ea(),rb!==d?(sb=z(),sb!==d?(kc=C(),kc!==d?(tb=z(),tb!==d?(ub=da(),ub!==d?Q=ic={type:"function",name:"extract",args:{type:"expr_list",
value:[{type:"string",value:jc},kc]}}:(f=Q,Q=d)):(f=Q,Q=d)):(f=Q,Q=d)):(f=Q,Q=d)):(f=Q,Q=d)):(f=Q,Q=d)):(f=Q,Q=d)}else f=Q,Q=d;else f=Q,Q=d;else f=Q,Q=d;else f=Q,Q=d;b=Q;if(b===d){var P,lc,wb,xb,yb,Kb,zb,Ab,Bb,Lb,Cb,ea,Ta,mc,nc,oc;P=f;var La,Mb,jb,Db;La=f;a.substr(f,9).toLowerCase()===Cd?(Mb=a.substr(f,9),f+=9):(Mb=d,0===w&&k(Dd));Mb!==d?(jb=f,w++,Db=r(),w--,Db===d?jb=void 0:(f=jb,jb=d),jb!==d?La=Mb="SUBSTRING":(f=La,La=d)):(f=La,La=d);lc=La;if(lc!==d)if(wb=z(),wb!==d)if(xb=ca(),xb!==d)if(yb=z(),
yb!==d)if(Kb=C(),Kb!==d)if(zb=z(),zb!==d)if(Ab=Ea(),Ab!==d)if(Bb=z(),Bb!==d)if(Lb=C(),Lb!==d)if(Cb=z(),Cb!==d){ea=f;var Ma,Nb,kb,Bc;Ma=f;a.substr(f,3).toLowerCase()===Ed?(Nb=a.substr(f,3),f+=3):(Nb=d,0===w&&k(Fd));Nb!==d?(kb=f,w++,Bc=r(),w--,Bc===d?kb=void 0:(f=kb,kb=d),kb!==d?Ma=Nb="FOR":(f=Ma,Ma=d)):(f=Ma,Ma=d);Ta=Ma;Ta!==d?(mc=z(),mc!==d?(nc=C(),nc!==d?(oc=z(),oc!==d?ea=Ta=[Ta,mc,nc,oc]:(f=ea,ea=d)):(f=ea,ea=d)):(f=ea,ea=d)):(f=ea,ea=d);ea===d&&(ea=null);ea!==d?(Ta=da(),Ta!==d?P=lc={type:"function",
name:"substring",args:{type:"expr_list",value:ea?[Kb,Lb,ea[2]]:[Kb,Lb]}}:(f=P,P=d)):(f=P,P=d)}else f=P,P=d;else f=P,P=d;else f=P,P=d;else f=P,P=d;else f=P,P=d;else f=P,P=d;else f=P,P=d;else f=P,P=d;else f=P,P=d;else f=P,P=d;b=P;if(b===d){var H,Ua,Ob,Pb,Qb,ka,Rb,Va,Sb,Tb,Cc,pc,Dc,Ec;H=f;Ua=Fa();Ua!==d?(Ob=z(),Ob!==d?(Pb=ca(),Pb!==d?(Qb=z(),Qb!==d?(ka=wa(),ka===d&&(ka=null),ka!==d?(Rb=z(),Rb!==d?(Va=C(),Va!==d?(Sb=z(),Sb!==d?(Tb=Ea(),Tb!==d?(Cc=z(),Cc!==d?(pc=C(),pc!==d?(Dc=z(),Dc!==d?(Ec=da(),Ec!==
d?H=Ua={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==ka?"BOTH":ka},Va,pc]}}:(f=H,H=d)):(f=H,H=d)):(f=H,H=d)):(f=H,H=d)):(f=H,H=d)):(f=H,H=d)):(f=H,H=d)):(f=H,H=d)):(f=H,H=d)):(f=H,H=d)):(f=H,H=d)):(f=H,H=d)):(f=H,H=d);H===d&&(H=f,Ua=Fa(),Ua!==d?(Ob=z(),Ob!==d?(Pb=ca(),Pb!==d?(Qb=z(),Qb!==d?(ka=wa(),ka===d&&(ka=null),ka!==d?(Rb=z(),Rb!==d?(Va=C(),Va!==d?(Sb=z(),Sb!==d?(Tb=da(),Tb!==d?H=Ua={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",
value:null==ka?"BOTH":ka},Va]}}:(f=H,H=d)):(f=H,H=d)):(f=H,H=d)):(f=H,H=d)):(f=H,H=d)):(f=H,H=d)):(f=H,H=d)):(f=H,H=d)):(f=H,H=d));b=H;if(b===d){var R,qc,Fc,Gc,Hc,rc,Ic,Jc,Kc,sc,Lc,Mc;R=f;var Na,Ub,lb,Nc;Na=f;a.substr(f,8).toLowerCase()===Gd?(Ub=a.substr(f,8),f+=8):(Ub=d,0===w&&k(Hd));Ub!==d?(lb=f,w++,Nc=r(),w--,Nc===d?lb=void 0:(f=lb,lb=d),lb!==d?Na=Ub="POSITION":(f=Na,Na=d)):(f=Na,Na=d);qc=Na;qc!==d?(Fc=z(),Fc!==d?(Gc=ca(),Gc!==d?(Hc=z(),Hc!==d?(rc=C(),rc!==d?(Ic=z(),Ic!==d?(Jc=oa(),Jc!==d?(Kc=
z(),Kc!==d?(sc=C(),sc!==d?(Lc=z(),Lc!==d?(Mc=da(),Mc!==d?R=qc={type:"function",name:"position",args:{type:"expr_list",value:[rc,sc]}}:(f=R,R=d)):(f=R,R=d)):(f=R,R=d)):(f=R,R=d)):(f=R,R=d)):(f=R,R=d)):(f=R,R=d)):(f=R,R=d)):(f=R,R=d)):(f=R,R=d)):(f=R,R=d);b=R;if(b===d){var Z,Vb,Oc,Pc,Qc,Wa,Rc,Sc;Z=f;var la,mb,nb,ra;la=f;la=mb=e();if(la===d)if(la=f,96===a.charCodeAt(f)?(mb=Tc,f++):(mb=d,0===w&&k(Uc)),mb!==d){nb=[];Vc.test(a.charAt(f))?(ra=a.charAt(f),f++):(ra=d,0===w&&k(Wc));if(ra!==d)for(;ra!==d;)nb.push(ra),
Vc.test(a.charAt(f))?(ra=a.charAt(f),f++):(ra=d,0===w&&k(Wc));else nb=d;nb!==d?(96===a.charCodeAt(f)?(ra=Tc,f++):(ra=d,0===w&&k(Uc)),ra!==d?la=mb=nb.join(""):(f=la,la=d)):(f=la,la=d)}else f=la,la=d;Vb=la;Vb!==d?(Oc=z(),Oc!==d?(Pc=ca(),Pc!==d?(Qc=z(),Qc!==d?(Wa=x(),Wa===d&&(Wa=null),Wa!==d?(Rc=z(),Rc!==d?(Sc=da(),Sc!==d?Z=Vb={type:"function",name:Vb,args:Wa?Wa:{type:"expr_list",value:[]}}:(f=Z,Z=d)):(f=Z,Z=d)):(f=Z,Z=d)):(f=Z,Z=d)):(f=Z,Z=d)):(f=Z,Z=d)):(f=Z,Z=d);b=Z;if(b===d){var Wb,I,Xa,Xb,Ya,Yb,
Aa,ma,ob,Xc,Yc;I=f;Xa=Eb();if(Xa!==d)if(Xb=z(),Xb!==d)if(Ya=C(),Ya!==d)if(Yb=z(),Yb!==d){Aa=[];for(ma=Pa();ma!==d;)Aa.push(ma),ma=Pa();Aa!==d?(ma=z(),ma!==d?(ob=Fb(),ob!==d?I=Xa={type:"case_expression",format:"simple",operand:Ya,clauses:Aa,else:null}:(f=I,I=d)):(f=I,I=d)):(f=I,I=d)}else f=I,I=d;else f=I,I=d;else f=I,I=d;else f=I,I=d;if(I===d)if(I=f,Xa=Eb(),Xa!==d)if(Xb=z(),Xb!==d)if(Ya=C(),Ya!==d)if(Yb=z(),Yb!==d){Aa=[];for(ma=Pa();ma!==d;)Aa.push(ma),ma=Pa();Aa!==d?(ma=z(),ma!==d?(ob=Da(),ob!==d?
(Xc=z(),Xc!==d?(Yc=Fb(),Yc!==d?I=Xa={type:"case_expression",format:"simple",operand:Ya,clauses:Aa,else:ob.value}:(f=I,I=d)):(f=I,I=d)):(f=I,I=d)):(f=I,I=d)):(f=I,I=d)}else f=I,I=d;else f=I,I=d;else f=I,I=d;else f=I,I=d;Wb=I;if(Wb===d){var O,Za,Zb,Ba,na,pb,Zc,$c;O=f;Za=Eb();if(Za!==d)if(Zb=z(),Zb!==d){Ba=[];for(na=fa();na!==d;)Ba.push(na),na=fa();Ba!==d?(na=z(),na!==d?(pb=Fb(),pb!==d?O=Za={type:"case_expression",format:"searched",clauses:Ba,else:null}:(f=O,O=d)):(f=O,O=d)):(f=O,O=d)}else f=O,O=d;else f=
O,O=d;if(O===d)if(O=f,Za=Eb(),Za!==d)if(Zb=z(),Zb!==d){Ba=[];for(na=fa();na!==d;)Ba.push(na),na=fa();Ba!==d?(na=z(),na!==d?(pb=Da(),pb!==d?(Zc=z(),Zc!==d?($c=Fb(),$c!==d?O=Za={type:"case_expression",format:"searched",clauses:Ba,else:pb.value}:(f=O,O=d)):(f=O,O=d)):(f=O,O=d)):(f=O,O=d)):(f=O,O=d)}else f=O,O=d;else f=O,O=d;Wb=O}b=Wb;if(b===d){var qb,Oa,tc,$b,ac;Oa=f;tc=l();if(tc!==d){$b=[];for(ac=U();ac!==d;)$b.push(ac),ac=U();$b!==d?Oa=tc+=$b.join(""):(f=Oa,Oa=d)}else f=Oa,Oa=d;qb=Oa;if(qb!==d){var uc=
qb;qb=/^CURRENT_DATE$/i.test(uc)?{type:"current_time",mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(uc)?{type:"current_time",mode:"timestamp"}:{type:"column_ref",table:"",column:uc}}b=qb;b===d&&(b=W(),b===d&&(b=f,c=ca(),c!==d?(h=z(),h!==d?(g=C(),g!==d?(n=z(),n!==d?(p=da(),p!==d?(g.paren=!0,b=c=g):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)))}}}}}}}return b}function e(){var a,b,c,e;a=f;b=l();if(b!==d){c=[];for(e=r();e!==d;)c.push(e),e=r();c!==d?a=b+=c.join(""):(f=a,a=d)}else f=a,a=d;return a}
function l(){var b;Id.test(a.charAt(f))?(b=a.charAt(f),f++):(b=d,0===w&&k(Jd));return b}function r(){var b;Kd.test(a.charAt(f))?(b=a.charAt(f),f++):(b=d,0===w&&k(Ld));return b}function U(){var b;Md.test(a.charAt(f))?(b=a.charAt(f),f++):(b=d,0===w&&k(Nd));return b}function W(){var b,c,h;b=f;64===a.charCodeAt(f)?(c=Od,f++):(c=d,0===w&&k(Pd));c!==d?(h=e(),h!==d?b=c=[c,h]:(f=b,b=d)):(f=b,b=d);b!==d&&(b={type:"param",value:b[1]});return b}function wa(){var b,c,e;b=f;a.substr(f,7).toLowerCase()===Qd?(c=
a.substr(f,7),f+=7):(c=d,0===w&&k(Rd));c!==d?(c=f,w++,e=r(),w--,e===d?c=void 0:(f=c,c=d),c!==d?b="LEADING":(f=b,b=d)):(f=b,b=d);b===d&&(b=f,a.substr(f,8).toLowerCase()===Sd?(c=a.substr(f,8),f+=8):(c=d,0===w&&k(Td)),c!==d?(c=f,w++,e=r(),w--,e===d?c=void 0:(f=c,c=d),c!==d?b="TRAILING":(f=b,b=d)):(f=b,b=d),b===d&&(b=f,a.substr(f,4).toLowerCase()===Ud?(c=a.substr(f,4),f+=4):(c=d,0===w&&k(Vd)),c!==d?(c=f,w++,e=r(),w--,e===d?c=void 0:(f=c,c=d),c!==d?b="BOTH":(f=b,b=d)):(f=b,b=d)));return b}function sa(){var b,
c,e;b=f;var h,g;c=f;e=V();e!==d?(h=z(),h!==d?(h=ca(),h!==d?(h=z(),h!==d?(h=L(),h!==d?(g=z(),g!==d?(g=da(),g!==d?c=e={type:"interval-period",period:e.value,precision:h,secondary:null}:(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d);c===d&&(c=f,e=V(),e!==d&&(e=rb(e)),c=e);if(c!==d)if(e=z(),e!==d)if(e=f,a.substr(f,2).toLowerCase()===Wd?(h=a.substr(f,2),f+=2):(h=d,0===w&&k(Xd)),h!==d?(h=f,w++,g=r(),w--,g===d?h=void 0:(f=h,h=d),h!==d?e="TO":(f=e,e=d)):(f=e,e=d),e!==d)if(e=z(),
e!==d){var l;e=f;h=V();h!==d&&(h={type:"interval-period",period:h.value,precision:null,secondary:null});e=h;e===d&&(e=f,h=Ga(),h!==d?(h=z(),h!==d?(h=ca(),h!==d?(h=z(),h!==d?(h=L(),h!==d?(g=z(),g!==d?(g=Ha(),g!==d?(g=z(),g!==d?(g=B(),g!==d?(l=z(),l!==d?(l=da(),l!==d?e=h=sb(h,g):(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d),e===d&&(e=f,h=Ga(),h!==d?(h=z(),h!==d?(h=ca(),h!==d?(h=z(),h!==d?(h=L(),h!==d?(g=z(),g!==d?(g=da(),g!==
d?e=h={type:"interval-period",period:"second",precision:h,secondary:null}:(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d),e===d&&(e=f,h=Ga(),h!==d&&(h={type:"interval-period",period:"second",precision:null,secondary:null}),e=h)));e!==d?b=c={type:"interval-qualifier",start:c,end:e}:(f=b,b=d)}else f=b,b=d;else f=b,b=d;else f=b,b=d;else f=b,b=d;b===d&&(b=f,e=V(),e!==d?(c=z(),c!==d?(c=ca(),c!==d?(c=z(),c!==d?(c=B(),c!==d?(h=z(),h!==d?(h=da(),h!==d?b=e={type:"interval-period",
period:e.value,precision:c,secondary:null}:(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d),b===d&&(b=f,e=V(),e!==d&&(e=rb(e)),b=e,b===d&&(b=f,e=Ga(),e!==d?(c=z(),c!==d?(c=ca(),c!==d?(c=z(),c!==d?(c=L(),c!==d?(h=z(),h!==d?(h=Ha(),h!==d?(e=z(),e!==d?(e=B(),e!==d?(h=z(),h!==d?(h=da(),h!==d?b=e=sb(c,e):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d),b===d&&(b=f,e=Ga(),e!==d?(c=z(),c!==d?(c=ca(),c!==d?(c=
z(),c!==d?(c=B(),c!==d?(h=z(),h!==d?(h=da(),h!==d?b=e={type:"interval-period",period:"second",precision:c,secondary:null}:(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d),b===d&&(b=f,e=Ga(),e!==d&&(e={type:"interval-period",period:"second",precision:null,secondary:null}),b=e)))));return b}function V(){var a;a=f;a=yc();a!==d&&(a={type:"string",value:"day"});a===d&&(a=f,a=zc(),a!==d&&(a={type:"string",value:"hour"}),a===d&&(a=f,a=Ac(),a!==d&&(a={type:"string",value:"minute"}),
a===d&&(a=f,a=xc(),a!==d&&(a={type:"string",value:"month"}),a===d&&(a=f,a=wc(),a!==d&&(a={type:"string",value:"year"})))));return a}function B(){var a;a=S();a!==d&&(a=parseFloat(a));return a}function L(){var a;a=S();a!==d&&(a=parseFloat(a));return a}function J(){var a;a=K();a===d&&(a=W());return a}function K(){var b,c,e;b=f;39===a.charCodeAt(f)?(c=tb,f++):(c=d,0===w&&k(ub));c===d&&(a.substr(f,2)===vb?(c=vb,f+=2):(c=d,0===w&&k(Yd)));if(c!==d){c=[];e=f;a.substr(f,2)===Ca?(e=Ca,f+=2):(e=d,0===w&&k(wb));
e!==d&&(e="'");e===d&&(xb.test(a.charAt(f))?(e=a.charAt(f),f++):(e=d,0===w&&k(yb)));for(;e!==d;)c.push(e),e=f,a.substr(f,2)===Ca?(e=Ca,f+=2):(e=d,0===w&&k(wb)),e!==d&&(e="'"),e===d&&(xb.test(a.charAt(f))?(e=a.charAt(f),f++):(e=d,0===w&&k(yb)));c!==d?(39===a.charCodeAt(f)?(e=tb,f++):(e=d,0===w&&k(ub)),e!==d?b=c={type:"string",value:c.join("")}:(f=b,b=d)):(f=b,b=d)}else f=b,b=d;return b}function fa(){var a,b,c;a=f;b=zb();b!==d?(b=z(),b!==d?(b=C(),b!==d?(c=z(),c!==d?(c=Ab(),c!==d?(c=z(),c!==d?(c=C(),
c!==d?a=b={type:"when_clause",operand:b,value:c}:(f=a,a=d)):(f=a,a=d)):(f=a,a=d)):(f=a,a=d)):(f=a,a=d)):(f=a,a=d)):(f=a,a=d);return a}function Pa(){var a,b,c;a=f;b=zb();b!==d?(b=z(),b!==d?(b=C(),b!==d?(c=z(),c!==d?(c=Ab(),c!==d?(c=z(),c!==d?(c=C(),c!==d?a=b={type:"when_clause",operand:b,value:c}:(f=a,a=d)):(f=a,a=d)):(f=a,a=d)):(f=a,a=d)):(f=a,a=d)):(f=a,a=d)):(f=a,a=d);return a}function Da(){var b,c;b=f;var e,h;c=f;a.substr(f,4).toLowerCase()===Zd?(e=a.substr(f,4),f+=4):(e=d,0===w&&k($d));e!==d?
(e=f,w++,h=r(),w--,h===d?e=void 0:(f=e,e=d),e!==d?c="ELSE":(f=c,c=d)):(f=c,c=d);c!==d?(c=z(),c!==d?(c=C(),c!==d?b={type:"else_clause",value:c}:(f=b,b=d)):(f=b,b=d)):(f=b,b=d);return b}function xa(){var b,c,e;b=S();b===d&&(b=f,45===a.charCodeAt(f)?(c=dc,f++):(c=d,0===w&&k(ec)),c===d&&(43===a.charCodeAt(f)?(c=bc,f++):(c=d,0===w&&k(cc))),c!==d?(e=S(),e!==d?b=c=c[0]+e:(f=b,b=d)):(f=b,b=d));return b}function M(){var b,c;b=f;46===a.charCodeAt(f)?(c=ae,f++):(c=d,0===w&&k(be));c!==d?(c=S(),c===d&&(c=null),
c!==d?b="."+(null!=c?c:""):(f=b,b=d)):(f=b,b=d);return b}function pa(){var b,c,e;c=b=f;ce.test(a.charAt(f))?(e=a.charAt(f),f++):(e=d,0===w&&k(de));e!==d?(ee.test(a.charAt(f))?(e=a.charAt(f),f++):(e=d,0===w&&k(fe)),e===d&&(e=null),e!==d?c="e"+(null===e?"":e):(f=c,c=d)):(f=c,c=d);c!==d?(e=S(),e!==d?b=c+e:(f=b,b=d)):(f=b,b=d);return b}function S(){var a,b;a=[];b=X();if(b!==d)for(;b!==d;)a.push(b),b=X();else a=d;a!==d&&(a=a.join(""));return a}function X(){var b;ge.test(a.charAt(f))?(b=a.charAt(f),f++):
(b=d,0===w&&k(he));return b}function oa(){var b,c,e;b=f;a.substr(f,2).toLowerCase()===ie?(c=a.substr(f,2),f+=2):(c=d,0===w&&k(je));c!==d?(c=f,w++,e=r(),w--,e===d?c=void 0:(f=c,c=d),c!==d?b="IN":(f=b,b=d)):(f=b,b=d);return b}function T(){var b,c,e;b=f;a.substr(f,2).toLowerCase()===ke?(c=a.substr(f,2),f+=2):(c=d,0===w&&k(le));c!==d?(c=f,w++,e=r(),w--,e===d?c=void 0:(f=c,c=d),c!==d?b="IS":(f=b,b=d)):(f=b,b=d);return b}function Y(){var b,c,e;b=f;a.substr(f,4).toLowerCase()===me?(c=a.substr(f,4),f+=4):
(c=d,0===w&&k(ne));c!==d?(c=f,w++,e=r(),w--,e===d?c=void 0:(f=c,c=d),c!==d?b="LIKE":(f=b,b=d)):(f=b,b=d);return b}function ga(){var b,c,e;b=f;a.substr(f,3).toLowerCase()===oe?(c=a.substr(f,3),f+=3):(c=d,0===w&&k(pe));c!==d?(c=f,w++,e=r(),w--,e===d?c=void 0:(f=c,c=d),c!==d?b="NOT":(f=b,b=d)):(f=b,b=d);return b}function aa(){var b,c,e;b=f;a.substr(f,3).toLowerCase()===qe?(c=a.substr(f,3),f+=3):(c=d,0===w&&k(re));c!==d?(c=f,w++,e=r(),w--,e===d?c=void 0:(f=c,c=d),c!==d?b="AND":(f=b,b=d)):(f=b,b=d);return b}
function ha(){var b,c,e;b=f;a.substr(f,2).toLowerCase()===se?(c=a.substr(f,2),f+=2):(c=d,0===w&&k(te));c!==d?(c=f,w++,e=r(),w--,e===d?c=void 0:(f=c,c=d),c!==d?b="OR":(f=b,b=d)):(f=b,b=d);return b}function ia(){var b,c,e;b=f;a.substr(f,7).toLowerCase()===ue?(c=a.substr(f,7),f+=7):(c=d,0===w&&k(ve));c!==d?(c=f,w++,e=r(),w--,e===d?c=void 0:(f=c,c=d),c!==d?b="BETWEEN":(f=b,b=d)):(f=b,b=d);return b}function Ea(){var b,c,e;b=f;a.substr(f,4).toLowerCase()===we?(c=a.substr(f,4),f+=4):(c=d,0===w&&k(xe));c!==
d?(c=f,w++,e=r(),w--,e===d?c=void 0:(f=c,c=d),c!==d?b="FROM":(f=b,b=d)):(f=b,b=d);return b}function Fa(){var b,c,e;b=f;a.substr(f,4).toLowerCase()===ye?(c=a.substr(f,4),f+=4):(c=d,0===w&&k(ze));c!==d?(c=f,w++,e=r(),w--,e===d?c=void 0:(f=c,c=d),c!==d?b="TRIM":(f=b,b=d)):(f=b,b=d);return b}function vc(){var b,c,e;b=f;a.substr(f,8).toLowerCase()===Ae?(c=a.substr(f,8),f+=8):(c=d,0===w&&k(Be));c!==d?(c=f,w++,e=r(),w--,e===d?c=void 0:(f=c,c=d),c!==d?b="INTERVAL":(f=b,b=d)):(f=b,b=d);return b}function wc(){var b,
c,e;b=f;a.substr(f,4).toLowerCase()===Ce?(c=a.substr(f,4),f+=4):(c=d,0===w&&k(De));c!==d?(c=f,w++,e=r(),w--,e===d?c=void 0:(f=c,c=d),c!==d?b="YEAR":(f=b,b=d)):(f=b,b=d);return b}function xc(){var b,c,e;b=f;a.substr(f,5).toLowerCase()===Ee?(c=a.substr(f,5),f+=5):(c=d,0===w&&k(Fe));c!==d?(c=f,w++,e=r(),w--,e===d?c=void 0:(f=c,c=d),c!==d?b="MONTH":(f=b,b=d)):(f=b,b=d);return b}function yc(){var b,c,e;b=f;a.substr(f,3).toLowerCase()===Ge?(c=a.substr(f,3),f+=3):(c=d,0===w&&k(He));c!==d?(c=f,w++,e=r(),
w--,e===d?c=void 0:(f=c,c=d),c!==d?b="DAY":(f=b,b=d)):(f=b,b=d);return b}function zc(){var b,c,e;b=f;a.substr(f,4).toLowerCase()===Ie?(c=a.substr(f,4),f+=4):(c=d,0===w&&k(Je));c!==d?(c=f,w++,e=r(),w--,e===d?c=void 0:(f=c,c=d),c!==d?b="HOUR":(f=b,b=d)):(f=b,b=d);return b}function Ac(){var b,c,e;b=f;a.substr(f,6).toLowerCase()===Ke?(c=a.substr(f,6),f+=6):(c=d,0===w&&k(Le));c!==d?(c=f,w++,e=r(),w--,e===d?c=void 0:(f=c,c=d),c!==d?b="MINUTE":(f=b,b=d)):(f=b,b=d);return b}function Ga(){var b,c,e;b=f;a.substr(f,
6).toLowerCase()===Me?(c=a.substr(f,6),f+=6):(c=d,0===w&&k(Ne));c!==d?(c=f,w++,e=r(),w--,e===d?c=void 0:(f=c,c=d),c!==d?b="SECOND":(f=b,b=d)):(f=b,b=d);return b}function Eb(){var b,c,e;b=f;a.substr(f,4).toLowerCase()===Oe?(c=a.substr(f,4),f+=4):(c=d,0===w&&k(Pe));c!==d?(c=f,w++,e=r(),w--,e===d?c=void 0:(f=c,c=d),c!==d?b="CASE":(f=b,b=d)):(f=b,b=d);return b}function Fb(){var b,c,e;b=f;a.substr(f,3).toLowerCase()===Qe?(c=a.substr(f,3),f+=3):(c=d,0===w&&k(Re));c!==d?(c=f,w++,e=r(),w--,e===d?c=void 0:
(f=c,c=d),c!==d?b="END":(f=b,b=d)):(f=b,b=d);return b}function zb(){var b,c,e;b=f;a.substr(f,4).toLowerCase()===Se?(c=a.substr(f,4),f+=4):(c=d,0===w&&k(Te));c!==d?(c=f,w++,e=r(),w--,e===d?c=void 0:(f=c,c=d),c!==d?b="WHEN":(f=b,b=d)):(f=b,b=d);return b}function Ab(){var b,c,e;b=f;a.substr(f,4).toLowerCase()===Ue?(c=a.substr(f,4),f+=4):(c=d,0===w&&k(Ve));c!==d?(c=f,w++,e=r(),w--,e===d?c=void 0:(f=c,c=d),c!==d?b="THEN":(f=b,b=d)):(f=b,b=d);return b}function Ha(){var b;44===a.charCodeAt(f)?(b=We,f++):
(b=d,0===w&&k(Xe));return b}function ca(){var b;40===a.charCodeAt(f)?(b=Ye,f++):(b=d,0===w&&k(Ze));return b}function da(){var b;41===a.charCodeAt(f)?(b=$e,f++):(b=d,0===w&&k(af));return b}function z(){var a,b;a=[];for(b=Bb();b!==d;)a.push(b),b=Bb();return a}function Bb(){var b;bf.test(a.charAt(f))?(b=a.charAt(f),f++):(b=d,0===w&&k(cf));return b}function bb(a,b,c,d){a={type:"binary_expr",operator:a,left:b,right:c};void 0!==d&&(a.escape=d);return a}function za(a,b){for(var c=0;c<b.length;c++)a=bb(b[c][1],
a,b[c][3]);return a}t=void 0!==t?t:{};var d={},Cb={start:u},Db=u,ad="!",bd=m("!",!1),$a="\x3d",ab=m("\x3d",!1),cb="\x3e\x3d",ed=m("\x3e\x3d",!1),fd="\x3e",gd=m("\x3e",!1),db="\x3c\x3d",hd=m("\x3c\x3d",!1),eb="\x3c\x3e",id=m("\x3c\x3e",!1),jd="\x3c",kd=m("\x3c",!1),fb="!\x3d",ld=m("!\x3d",!1),bc="+",cc=m("+",!1),dc="-",ec=m("-",!1),md="*",nd=m("*",!1),od="/",pd=m("/",!1),Id=/^[A-Za-z_\x80-\uFFFF]/,Jd=b([["A","Z"],["a","z"],"_",["\u0080","\uffff"]],!1,!1),Kd=/^[A-Za-z0-9_]/,Ld=b([["A","Z"],["a","z"],
["0","9"],"_"],!1,!1),Md=/^[A-Za-z0-9_.\x80-\uFFFF]/,Nd=b([["A","Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],!1,!1),Od="@",Pd=m("@",!1),rb=function(a){return{type:"interval-period",period:a.value,precision:null,secondary:null}},sb=function(a,b){return{type:"interval-period",period:"second",precision:a,secondary:b}},tb="'",ub=m("'",!1),vb="N'",Yd=m("N'",!1),Ca="''",wb=m("''",!1),xb=/^[^']/,yb=b(["'"],!0,!1),ae=".",be=m(".",!1),ge=/^[0-9]/,he=b([["0","9"]],!1,!1),ce=/^[eE]/,de=b(["e","E"],
!1,!1),ee=/^[+\-]/,fe=b(["+","-"],!1,!1),ud="null",vd=m("NULL",!0),qd="true",rd=m("TRUE",!0),sd="false",td=m("FALSE",!0),ie="in",je=m("IN",!0),ke="is",le=m("IS",!0),me="like",ne=m("LIKE",!0),cd="escape",dd=m("ESCAPE",!0),oe="not",pe=m("NOT",!0),qe="and",re=m("AND",!0),se="or",te=m("OR",!0),ue="between",ve=m("BETWEEN",!0),we="from",xe=m("FROM",!0),Ed="for",Fd=m("FOR",!0),Cd="substring",Dd=m("SUBSTRING",!0),Ad="extract",Bd=m("EXTRACT",!0),ye="trim",ze=m("TRIM",!0),Gd="position",Hd=m("POSITION",!0),
yd="timestamp",zd=m("TIMESTAMP",!0),wd="date",xd=m("DATE",!0),Qd="leading",Rd=m("LEADING",!0),Sd="trailing",Td=m("TRAILING",!0),Ud="both",Vd=m("BOTH",!0),Wd="to",Xd=m("TO",!0),Ae="interval",Be=m("INTERVAL",!0),Ce="year",De=m("YEAR",!0),Ee="month",Fe=m("MONTH",!0),Ge="day",He=m("DAY",!0),Ie="hour",Je=m("HOUR",!0),Ke="minute",Le=m("MINUTE",!0),Me="second",Ne=m("SECOND",!0),Oe="case",Pe=m("CASE",!0),Qe="end",Re=m("END",!0),Se="when",Te=m("WHEN",!0),Ue="then",Ve=m("THEN",!0),Zd="else",$d=m("ELSE",!0),
We=",",Xe=m(",",!1),Ye="(",Ze=m("(",!1),$e=")",af=m(")",!1),bf=/^[ \t\n\r]/,cf=b([" ","\t","\n","\r"],!1,!1),Tc="`",Uc=m("`",!1),Vc=/^[^`]/,Wc=b(["`"],!0,!1),f=0,ya=[{line:1,column:1}],ba=0,Qa=[],w=0,va;if("startRule"in t){if(!(t.startRule in Cb))throw Error("Can't start parsing from rule \""+t.startRule+'".');Db=Cb[t.startRule]}va=Db();if(va!==d&&f===a.length)return va;va!==d&&f<a.length&&k({type:"end"});throw function(a,b,c){return new A(A.buildMessage(a,b),a,b,c)}(Qa,ba<a.length?a.charAt(ba):null,
ba<a.length?g(ba,ba+1):g(ba,ba));}}})},"esri/layers/graphics/data/projectionSupport":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/Error ../../../core/promiseUtils ../../../geometry/projection ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),function(A,a,t,m,b,c,g,k,u){function x(a,b){var c;if(!b)return null;if("x"in b){var h={x:0,y:0};a=a(b.x,b.y,E);h.x=a[0];h.y=
a[1];null!=b.z&&(h.z=b.z);null!=b.m&&(h.m=b.m);return h}if("xmin"in b)return h={xmin:0,ymin:0,xmax:0,ymax:0},c=a(b.xmin,b.ymin,E),h.xmin=c[0],h.ymin=c[1],a=a(b.xmax,b.ymax,E),h.xmax=a[0],h.ymax=a[1],b.hasZ&&(h.zmin=b.zmin,h.zmax=b.zmax,h.hasZ=!0),b.hasM&&(h.mmin=b.mmin,h.mmax=b.mmax,h.hasM=!0),h;if("rings"in b)return{rings:C(b.rings,a),hasM:b.hasM,hasZ:b.hasZ};if("paths"in b)return{paths:C(b.paths,a),hasM:b.hasM,hasZ:b.hasZ};if("points"in b)return{points:q(b.points,a),hasM:b.hasM,hasZ:b.hasZ}}function C(a,
b){for(var c=[],h=0;h<a.length;h++)c.push(q(a[h],b));return c}function q(a,b){for(var c=[],h=0;h<a.length;h++){var e=a[h],g=b(e[0],e[1],[0,0]);c.push(g);2<e.length&&g.push(e[2]);3<e.length&&g.push(e[3])}return c}function D(a,b){return!k.isValid(a)||!k.isValid(b)||k.equals(a,b)||u.canProject(a,b)?!1:!0}Object.defineProperty(a,"__esModule",{value:!0});var E=[0,0];a.doesBrowserSupportProjection=function(a,b){return D(a,b)?g.isSupported():!0};a.checkProjectionSupport=function(a,c){return m(this,void 0,
void 0,function(){var n,h,e;return t(this,function(l){if(!c)return[2];if(Array.isArray(a)){n=0;for(h=a;n<h.length;n++)if(e=h[n],D(e.geometry&&e.geometry.spatialReference,c)){if(g.isSupported())return[2,g.load()];throw new b("feature-store:unsupported-query","projection not supported",{inSpatialReference:a,outSpatialReference:c});}return[2]}if(!D(a,c))return[2];if(g.isSupported())return[2,g.load()];throw new b("feature-store:unsupported-query","projection not supported",{inSpatialReference:a,outSpatialReference:c});
})})};var G=x.bind(null,u.lngLatToXY),F=x.bind(null,u.xyToLngLat);a.project=function(a,b,c){if(!a)return a;c||(c=b,b=a.spatialReference);return k.isValid(b)&&k.isValid(c)&&!k.equals(b,c)?u.canProject(b,c)?k.isWebMercator(c)?G(a):F(a):g.projectMany([a],b,c,null,!0)[0]:a};var y=new (function(){function a(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}a.prototype.push=function(a,b,h){return m(this,void 0,void 0,function(){var e,g=this;return t(this,function(l){a&&a.length&&b&&
h&&!k.equals(b,h)||c.resolve(a);e={geometries:a,inSpatialReference:b,outSpatialReference:h,resolve:null};this._jobs.push(e);return[2,c.create(function(a){e.resolve=a;null===g._timer&&(g._timer=setTimeout(g._process,10))})]})})};a.prototype._process=function(){this._timer=null;var a=this._jobs.shift();if(a){var b=a.geometries,c=a.inSpatialReference,e=a.outSpatialReference,a=a.resolve;u.canProject(c,e)?k.isWebMercator(e)?a(b.map(G)):a(b.map(F)):a(g.projectMany(b,c,e,null,!0));0<this._jobs.length&&(this._timer=
setTimeout(this._process,10))}};return a}());a.projectMany=function(a,b,c){return m(this,void 0,void 0,function(){return t(this,function(h){return[2,y.push(a,b,c)]})})}})},"esri/geometry/projection":function(){define("require exports ../core/promiseUtils ./pe ./SpatialReference ./support/GeographicTransformation".split(" "),function(A,a,t,m,b,c){function g(a,g,m,x,t){void 0===x&&(x=null);void 0===t&&(t=!1);if(null===x){var y=c.cacheKey(g,m);void 0!==C[y]?x=C[y]:(x=k(g,m,null),null===x&&(x=new c),
C[y]=x)}return u._project(a,g,m instanceof b||!1===t?m:new b(m),x,t)}function k(a,b,g){void 0===g&&(g=null);a=u._getTransformation(a,b,g);return null!==a?c.fromGE(a):null}Object.defineProperty(a,"__esModule",{value:!0});var u=null;a.isLoaded=function(){return!!u&&m.isLoaded()};a.isSupported=function(){return m.isSupported()};var x=null;a.load=function(){return x?x:x=t.create(function(a,b){var c=m.load();A(["./geometryEngine"],function(g){u=g;c.then(function(){u._enableProjection(m);a()},function(a){b(a)})})})};
a.project=function(a,b,c){void 0===c&&(c=null);return a instanceof Array?0===a.length?[]:g(a,a[0].spatialReference,b,c):g([a],a.spatialReference,b,c)[0]};var C={};a.projectMany=g;a.getTransformation=k;a.getTransformations=function(a,b,g){void 0===g&&(g=null);a=u._getTransformationBySuitability(a,b,g);if(null!==a){b=[];for(g=0;g<a.length;g++)b.push(c.fromGE(a[g]));return b}return[]}})},"esri/geometry/pe":function(){define(["require","exports","../core/tsSupport/extendsHelper","../core/has","../core/promiseUtils"],
function(A,a,t,m,b){function c(b){function c(a,b,c){a[b]=c(a[b])}a._pe=b;q.init();D.init();E.init();G.init();F.init();a.PeGCSExtent=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}t(c,b);c.prototype.destroy=function(){a._pe.destroy(this)};return c}(a._pe.PeGCSExtent);for(var g=0,k=[a._pe.PeDatum,a._pe.PeGeogcs,a._pe.PeGeogtran,a._pe.PeObject,a._pe.PeParameter,a._pe.PePrimem,a._pe.PeProjcs,a._pe.PeSpheroid,a._pe.PeUnit];g<k.length;g++)b=k[g],c(b.prototype,"getName",function(a){return function(){return a.call(this,
Array(q.PE_NAME_MAX))}});g=0;for(k=[a._pe.PeGeogtran,a._pe.PeProjcs];g<k.length;g++)b=k[g],c(b.prototype,"getParameters",function(b){return function(){for(var c=Array(q.PE_PARM_MAX),e=b.call(this),h=0;h<c.length;h++){var g=a._pe.getValue(e,"*");c[h]=g?a._pe.wrapPointer(g,a._pe.PeParameter):null;e+=Int32Array.BYTES_PER_ELEMENT}return c}});c(a._pe.PeHorizon.prototype,"getCoord",function(a){return function(){var b=this.getSize();if(!b)return null;var c=[],e=a.call(this);x(c,b,e);return c}});c(a._pe.PeGTlistExtendedEntry.prototype,
"getEntries",function(b){var c=a._pe._pe_getPeGTlistExtendedGTsSize();return function(){var e=null,h=b.call(this);if(!a._pe.compare(h,a._pe.NULL)){var e=[h],g=this.getSteps();if(1<g)for(var h=a._pe.getPointer(h),l=1;l<g;l++)e.push(a._pe.wrapPointer(h+c*l,a._pe.PeGTlistExtendedGTs))}return e}});var h=a._pe._pe_getPeHorizonSize();b=function(b){return function(){var c=this._cache;c||(this._cache=c=new Map);if(c.has(b))return c.get(b);var e=null,g=b.call(this);if(!a._pe.compare(g,a._pe.NULL)){var e=[g],
n=g.getNump();if(1<n)for(var g=a._pe.getPointer(g),k=1;k<n;k++)e.push(a._pe.wrapPointer(g+h*k,a._pe.PeHorizon))}c.set(b,e);return e}};c(a._pe.PeProjcs.prototype,"horizonGcsGenerate",b);c(a._pe.PeProjcs.prototype,"horizonPcsGenerate",b);a._pe.PeObject.prototype.toString=function(b){void 0===b&&(b=q.PE_STR_OPTS_NONE);a._pe.ensureCache.prepare();var c=a._pe.getPointer(this),e=a._pe.ensureInt8(Array(q.PE_BUFFER_MAX));return a._pe.UTF8ToString(a._pe._pe_object_to_string_ext(c,b,e))}}function g(b){if(b){var c=
a._pe.getClass(b);c&&(c=a._pe.getCache(c))&&(b=a._pe.getPointer(b))&&delete c[b]}}function k(b,c){var g=[];c=Array(c);for(var k=0;k<b;k++)g.push(a._pe.ensureInt8(c));return g}function u(a){var b;Array.isArray(a[0])?(b=[],a.forEach(function(a){b.push(a[0],a[1])})):b=a;return b}function x(b,c,g,k){void 0===k&&(k=!1);if(k)for(k=0;k<2*c;k++)b[k]=a._pe.getValue(g+k*Float64Array.BYTES_PER_ELEMENT,"double");else{var h=0===b.length;for(k=0;k<c;k++)h&&(b[k]=Array(2)),b[k][0]=a._pe.getValue(g,"double"),b[k][1]=
a._pe.getValue(g+Float64Array.BYTES_PER_ELEMENT,"double"),g+=2*Float64Array.BYTES_PER_ELEMENT}}Object.defineProperty(a,"__esModule",{value:!0});var C;a._pe=null;a.isLoaded=function(){return!!a._pe};a.isSupported=function(){return!!m("esri-wasm")};a.load=function(){return C?C:C=b.create(function(a,b){A(["./support/pe-wasm"],function(g){g({locateFile:function(a){return A.toUrl("./support/"+a)},onAbort:function(a){b(Error(a))}}).then(function(b){c(b);a()})})})};(function(b){function c(b,c,g){a._pe.ensureCache.prepare();
var e=u(g),h=g===e,e=a._pe.ensureFloat64(e);(b=a._pe._pe_geog_to_proj(a._pe.getPointer(b),c,e))&&x(g,c,e,h);return b}function g(a,b,c){return k(a,b,c,0)}function k(b,c,g,n){a._pe.ensureCache.prepare();var e=u(g),h=g===e,e=a._pe.ensureFloat64(e);(b=a._pe._pe_proj_to_geog_center(a._pe.getPointer(b),c,e,n))&&x(g,c,e,h);return b}b.geogToProj=c;b.projGeog=function(a,b,l,n){switch(n){case q.PE_TRANSFORM_P_TO_G:return g(a,b,l);case q.PE_TRANSFORM_G_TO_P:return c(a,b,l)}return 0};b.projToGeog=g;b.projToGeogCenter=
k})(a.PeCSTransformations||(a.PeCSTransformations={}));var q;(function(b){b.init=function(){b.PE_BUFFER_MAX=a._pe.PeDefs.prototype.PE_BUFFER_MAX;b.PE_NAME_MAX=a._pe.PeDefs.prototype.PE_NAME_MAX;b.PE_MGRS_MAX=a._pe.PeDefs.prototype.PE_MGRS_MAX;b.PE_USNG_MAX=a._pe.PeDefs.prototype.PE_USNG_MAX;b.PE_DD_MAX=a._pe.PeDefs.prototype.PE_DD_MAX;b.PE_DDM_MAX=a._pe.PeDefs.prototype.PE_DDM_MAX;b.PE_DMS_MAX=a._pe.PeDefs.prototype.PE_DMS_MAX;b.PE_UTM_MAX=a._pe.PeDefs.prototype.PE_UTM_MAX;b.PE_PARM_MAX=a._pe.PeDefs.prototype.PE_PARM_MAX;
b.PE_TYPE_NONE=a._pe.PeDefs.prototype.PE_TYPE_NONE;b.PE_TYPE_GEOGCS=a._pe.PeDefs.prototype.PE_TYPE_GEOGCS;b.PE_TYPE_PROJCS=a._pe.PeDefs.prototype.PE_TYPE_PROJCS;b.PE_TYPE_GEOGTRAN=a._pe.PeDefs.prototype.PE_TYPE_GEOGTRAN;b.PE_TYPE_COORDSYS=a._pe.PeDefs.prototype.PE_TYPE_COORDSYS;b.PE_TYPE_UNIT=a._pe.PeDefs.prototype.PE_TYPE_UNIT;b.PE_STR_OPTS_NONE=a._pe.PeDefs.prototype.PE_STR_OPTS_NONE;b.PE_STR_AUTH_NONE=a._pe.PeDefs.prototype.PE_STR_AUTH_NONE;b.PE_STR_AUTH_TOP=a._pe.PeDefs.prototype.PE_STR_AUTH_TOP;
b.PE_STR_NAME_CANON=a._pe.PeDefs.prototype.PE_STR_NAME_CANON;b.PE_PARM_X0=a._pe.PeDefs.prototype.PE_PARM_X0;b.PE_PARM_ND=a._pe.PeDefs.prototype.PE_PARM_ND;b.PE_TRANSFORM_1_TO_2=a._pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2;b.PE_TRANSFORM_2_TO_1=a._pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1;b.PE_TRANSFORM_P_TO_G=a._pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G;b.PE_TRANSFORM_G_TO_P=a._pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P;b.PE_HORIZON_RECT=a._pe.PeDefs.prototype.PE_HORIZON_RECT;b.PE_HORIZON_POLY=a._pe.PeDefs.prototype.PE_HORIZON_POLY;
b.PE_HORIZON_LINE=a._pe.PeDefs.prototype.PE_HORIZON_LINE;b.PE_HORIZON_DELTA=a._pe.PeDefs.prototype.PE_HORIZON_DELTA}})(q=a.PeDefs||(a.PeDefs={}));(function(b){function c(b,c){var e=null,h=k[b];h||(h={},k[b]=h);h.hasOwnProperty(String(c))?e=h[c]:(b=a._pe.PeFactory.prototype.factoryByType(b,c),a._pe.compare(b,a._pe.NULL)||(e=b,h[c]=e));return e=g(e)}function g(b){if(b){var c=b.getType();switch(c){case q.PE_TYPE_GEOGCS:b=a._pe.castObject(b,a._pe.PeGeogcs);break;case q.PE_TYPE_PROJCS:b=a._pe.castObject(b,
a._pe.PeProjcs);break;case q.PE_TYPE_GEOGTRAN:b=a._pe.castObject(b,a._pe.PeGeogtran);break;default:c&q.PE_TYPE_UNIT&&(b=a._pe.castObject(b,a._pe.PeUnit))}}return b}var k={},h={};b.initialize=function(){a._pe.PeFactory.prototype.initialize(null)};b.coordsys=function(a){return c(q.PE_TYPE_COORDSYS,a)};b.factoryByType=c;b.fromString=function(b,c){var e=null,l=h[b];l||(l={},h[b]=l);l.hasOwnProperty(c)?e=l[c]:(b=a._pe.PeFactory.prototype.fromString(b,c),a._pe.compare(b,a._pe.NULL)||(e=b,l[c]=e));return e=
g(e)};b.geogcs=function(a){return c(q.PE_TYPE_GEOGCS,a)};b.geogtran=function(a){return c(q.PE_TYPE_GEOGTRAN,a)};b.getCode=function(b){return a._pe.PeFactory.prototype.getCode(b)};b.projcs=function(a){return c(q.PE_TYPE_PROJCS,a)};b.unit=function(a){return c(q.PE_TYPE_UNIT,a)}})(a.PeFactory||(a.PeFactory={}));a.PeGCSExtent=null;var D;(function(b){var c;b.init=function(){b.PE_GTLIST_OPTS_COMMON=a._pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON;c=a._pe._pe_getPeGTlistExtendedEntrySize()};b.getGTlist=
function(b,g,h,e,l,k){var n=null,r=new a._pe.PeInteger(k);try{var v=a._pe.PeGTlistExtended.prototype.getGTlist(b,g,h,e,l,r);if(k=r.val)if(n=[v],1<k){var m=a._pe.getPointer(v);for(b=1;b<k;b++)n.push(a._pe.wrapPointer(m+c*b,a._pe.PeGTlistExtendedEntry))}}finally{a._pe.destroy(r)}return n}})(D=a.PeGTlistExtended||(a.PeGTlistExtended={}));(function(b){b.destroy=function(b){if(b&&b.length){for(var c=0;c<b.length;c++){var k=b[c];g(k);k.getEntries().forEach(function(a){g(a);a=a.getGeogtran();g(a);a.getParameters().forEach(g);
[a.getGeogcs1(),a.getGeogcs2()].forEach(function(a){g(a);var b=a.getDatum();g(b);g(b.getSpheroid());g(a.getPrimem());g(a.getUnit())})})}a._pe.PeGTlistExtendedEntry.prototype.Delete(b[0])}}})(a.PeGTlistExtendedEntry||(a.PeGTlistExtendedEntry={}));(function(b){b.geogToGeog=function(b,c,g,h,e){a._pe.ensureCache.prepare();var l=u(g),k=g===l,l=a._pe.ensureFloat64(l),n=0;h&&(n=a._pe.ensureFloat64(h));(b=a._pe._pe_geog_to_geog(a._pe.getPointer(b),c,l,n,e))&&x(g,c,l,k);return b}})(a.PeGTTransformations||
(a.PeGTTransformations={}));(function(b){function c(b,c,e,g,n,m){a._pe.ensureCache.prepare();var h,l;switch(b){case "dd":h=a._pe._pe_geog_to_dd;l=q.PE_DD_MAX;break;case "ddm":h=a._pe._pe_geog_to_ddm;l=q.PE_DDM_MAX;break;case "dms":h=a._pe._pe_geog_to_dms,l=q.PE_DMS_MAX}b=0;c&&(b=a._pe.getPointer(c));c=u(g);c=a._pe.ensureFloat64(c);l=k(e,l);g=a._pe.ensureInt32(l);if(n=h(b,e,c,n,g))for(h=0;h<e;h++)m[h]=a._pe.UTF8ToString(l[h]);return n}function g(b,c,e,g,k){a._pe.ensureCache.prepare();var h;switch(b){case "dd":h=
a._pe._pe_dd_to_geog;break;case "ddm":h=a._pe._pe_ddm_to_geog;break;case "dms":h=a._pe._pe_dms_to_geog}b=0;c&&(b=a._pe.getPointer(c));c=g.map(function(b){return a._pe.ensureString(b)});g=a._pe.ensureInt32(c);c=a._pe.ensureFloat64(Array(2*e));(h=h(b,e,g,c))&&x(k,e,c);return h}b.geog_to_dms=function(a,b,e,g,k){return c("dms",a,b,e,g,k)};b.dms_to_geog=function(a,b,c,l){return g("dms",a,b,c,l)};b.geog_to_ddm=function(a,b,e,g,k){return c("ddm",a,b,e,g,k)};b.ddm_to_geog=function(a,b,c,l){return g("ddm",
a,b,c,l)};b.geog_to_dd=function(a,b,e,g,k){return c("dd",a,b,e,g,k)};b.dd_to_geog=function(a,b,c,l){return g("dd",a,b,c,l)}})(a.PeNotationDms||(a.PeNotationDms={}));var E;(function(b){b.init=function(){b.PE_MGRS_STYLE_NEW=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW;b.PE_MGRS_STYLE_OLD=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD;b.PE_MGRS_STYLE_AUTO=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO;b.PE_MGRS_180_ZONE_1_PLUS=a._pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS;b.PE_MGRS_ADD_SPACES=
a._pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES};b.geog_to_mgrs_extended=function(b,c,g,h,e,l,r){a._pe.ensureCache.prepare();var n=0;b&&(n=a._pe.getPointer(b));b=u(g);g=a._pe.ensureFloat64(b);b=k(c,q.PE_MGRS_MAX);var m=a._pe.ensureInt32(b);if(h=a._pe._pe_geog_to_mgrs_extended(n,c,g,h,e,l,m))for(e=0;e<c;e++)r[e]=a._pe.UTF8ToString(b[e]);return h};b.mgrs_to_geog_extended=function(b,c,g,h,e){a._pe.ensureCache.prepare();var l=0;b&&(l=a._pe.getPointer(b));b=g.map(function(b){return a._pe.ensureString(b)});
g=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*c));(h=a._pe._pe_mgrs_to_geog_extended(l,c,g,h,b))&&x(e,c,b);return h}})(E=a.PeNotationMgrs||(a.PeNotationMgrs={}));(function(b){b.geog_to_usng=function(b,c,g,h,e,l,r){a._pe.ensureCache.prepare();var n=0;b&&(n=a._pe.getPointer(b));b=u(g);g=a._pe.ensureFloat64(b);b=k(c,q.PE_MGRS_MAX);var m=a._pe.ensureInt32(b);if(h=a._pe._pe_geog_to_usng(n,c,g,h,e,l,m))for(e=0;e<c;e++)r[e]=a._pe.UTF8ToString(b[e]);return h};b.usng_to_geog=function(b,c,g,h){a._pe.ensureCache.prepare();
var e=0;b&&(e=a._pe.getPointer(b));b=g.map(function(b){return a._pe.ensureString(b)});g=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*c));(e=a._pe._pe_usng_to_geog(e,c,g,b))&&x(h,c,b);return e}})(a.PeNotationUsng||(a.PeNotationUsng={}));var G;(function(b){b.init=function(){b.PE_UTM_OPTS_NONE=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE;b.PE_UTM_OPTS_ADD_SPACES=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES;b.PE_UTM_OPTS_NS=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS};b.geog_to_utm=function(b,
c,g,h,e){a._pe.ensureCache.prepare();var l=0;b&&(l=a._pe.getPointer(b));b=u(g);g=a._pe.ensureFloat64(b);b=k(c,q.PE_UTM_MAX);var n=a._pe.ensureInt32(b);if(h=a._pe._pe_geog_to_utm(l,c,g,h,n))for(l=0;l<c;l++)e[l]=a._pe.UTF8ToString(b[l]);return h};b.utm_to_geog=function(b,c,g,h,e){a._pe.ensureCache.prepare();var l=0;b&&(l=a._pe.getPointer(b));b=g.map(function(b){return a._pe.ensureString(b)});g=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*c));(h=a._pe._pe_utm_to_geog(l,c,g,h,b))&&x(e,c,b);return h}})(G=
a.PeNotationUtm||(a.PeNotationUtm={}));var F;(function(b){var c=new Map;b.init=function(){b.PE_PCSINFO_OPTION_NONE=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE;b.PE_PCSINFO_OPTION_DOMAIN=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN;b.PE_POLE_OUTSIDE_BOUNDARY=a._pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY;b.PE_POLE_POINT=a._pe.PePCSInfo.prototype.PE_POLE_POINT};b.generate=function(g,k){void 0===k&&(k=b.PE_PCSINFO_OPTION_DOMAIN);var h,e;c.has(g)&&(e=c.get(g),e[k]&&(h=e[k]));h||(h=a._pe.PePCSInfo.prototype.generate(g,
k),e||(e=[],c.set(g,e)),e[k]=h);return h}})(F=a.PePCSInfo||(a.PePCSInfo={}));(function(b){b.version_string=function(){return a._pe.PeVersion.prototype.version_string()}})(a.PeVersion||(a.PeVersion={}));a._init=c})},"esri/geometry/support/GeographicTransformation":function(){define(["require","exports","./GeographicTransformationStep"],function(A,a,t){return function(){function a(a){this.steps=[];this._cached_projection={};this._chain="";this._gtlistentry=null;if(a&&a.steps){var b=0;for(a=a.steps;b<
a.length;b++){var g=a[b];g instanceof t?this.steps.push(g):this.steps.push(new t({wkid:g.wkid,wkt:g.wkt,isInverse:g.isInverse}))}}}a.cacheKey=function(a,c){return[void 0!==a.wkid&&null!==a.wkid?a.wkid.toString():"-1",void 0!==a.wkt&&null!==a.wkt?a.wkt.toString():"",void 0!==c.wkid&&null!==c.wkid?c.wkid.toString():"-1",void 0!==c.wkt&&null!==c.wkt?c.wkt.toString():""].join()};a.fromGE=function(b){var c=new a,g="",k=0;for(b=b.steps;k<b.length;k++){var m=t.fromGE(b[k]);c.steps.push(m);g+=m.uid.toString()+
","}c._cached_projection={};c._gtlistentry=null;c._chain=g;return c};a.prototype.getInverse=function(){var b=new a;b.steps=[];for(var c=this.steps.length-1;0<=c;c--)b.steps.push(this.steps[c].getInverse());return b};a.prototype.getGTListEntry=function(){for(var a="",c=0,g=this.steps;c<g.length;c++)a+=g[c].uid.toString()+",";a!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=a);return this._gtlistentry};a.prototype.assignCachedGe=function(b,c,g){this._cached_projection[a.cacheKey(b,
c)]=g};a.prototype.getCachedGeTransformation=function(b,c){for(var g="",k=0,m=this.steps;k<m.length;k++)g+=m[k].uid.toString()+",";g!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=g);b=this._cached_projection[a.cacheKey(b,c)];return void 0===b?null:b};return a}()})},"esri/geometry/support/GeographicTransformationStep":function(){define(["require","exports"],function(A,a){var t=0;return function(){function a(a){void 0===a&&(a=null);this.uid=t++;a?(this._wkt=void 0!==
a.wkt?a.wkt:null,this._wkid=void 0!==a.wkid?a.wkid:-1,this._isInverse=void 0!==a.isInverse?!0===a.isInverse:!1):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}a.fromGE=function(b){var c=new a;c._wkt=b.wkt;c._wkid=b.wkid;c._isInverse=b.isInverse;return c};Object.defineProperty(a.prototype,"wkt",{get:function(){return this._wkt},set:function(a){this._wkt=a;this.uid=t++},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"wkid",{get:function(){return this._wkid},set:function(a){this._wkid=
a;this.uid=t++},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"isInverse",{get:function(){return this._isInverse},set:function(a){this._isInverse=a;this.uid=t++},enumerable:!0,configurable:!0});a.prototype.getInverse=function(){var b=new a;b._wkt=this.wkt;b._wkid=this._wkid;b._isInverse=!this.isInverse;return b};return a}()})},"esri/layers/graphics/data/QueryEngineCapabilities":function(){define(["require","exports"],function(A,a){Object.defineProperty(a,"__esModule",{value:!0});
a.queryCapabilities={supportsStatistics:!0,supportsPercentileStatistics:!1,supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,
supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}})},"esri/layers/graphics/data/QueryEngineResult":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/MapUtils ../../../core/maybe ../../../core/promiseUtils ../../../core/SetUtils ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./AttributesBuilder ./attributeSupport ./projectionSupport ./timeSupport ./utils".split(" "),
function(A,a,t,m,b,c,g,k,u,x,C,q,D,E,G,F,y){Object.defineProperty(a,"__esModule",{value:!0});A=function(){function a(a,b,c){this.items=a;this.queryGeometry=b;this.definitionExpression=c.definitionExpression;this.geometryType=c.geometryType;this.hasM=c.hasM;this.hasZ=c.hasZ;this.objectIdField=c.objectIdField;this.spatialReference=c.spatialReference;this.fieldsIndex=c.fieldsIndex;this.timeInfo=c.timeInfo;this.featureAdapter=c.featureAdapter}Object.defineProperty(a.prototype,"size",{get:function(){return this.items.length},
enumerable:!0,configurable:!0});a.prototype.createQueryResponse=function(a){var b;b=a.outStatistics?a.outStatistics.some(function(a){return"exceedslimit"===a.statisticType})?this._createExceedsLimitQueryResponse(a):this._createStatisticsQueryResponse(a):this._createFeatureQueryResponse(a);a.returnQueryGeometry&&(C.isValid(a.outSR)&&!C.equals(this.queryGeometry.spatialReference,a.outSR)?b.queryGeometry=y.cleanFromGeometryEngine(t({spatialReference:a.outSR},G.project(this.queryGeometry,this.queryGeometry.spatialReference,
a.outSR))):b.queryGeometry=y.cleanFromGeometryEngine(t({spatialReference:a.outSR},this.queryGeometry)));return b};a.prototype.executeAttributesQuery=function(b){var c=E.getWhereClause(b.where,this.fieldsIndex);if(!c)return k.resolve(this);if(c.isStandardized){for(var g=0,e=[],l=0,n=this.items;l<n.length;l++){var m=n[l];c.testFeature(m,this.featureAdapter)&&(e[g++]=m)}c=new a(e,this.queryGeometry,this);c.definitionExpression=b.where;return k.resolve(c)}return k.reject(new TypeError("Where clause is not standardized"))};
a.prototype.executeObjectIdsQuery=function(b){if(!b.objectIds||!b.objectIds.length)return k.resolve(this);var c=u.createSetFromValues(b.objectIds),g=this.featureAdapter.getObjectId;return k.resolve(new a(this.items.filter(function(a){return c.has(g(a))}),this.queryGeometry,this))};a.prototype.executeTimeQuery=function(b){b=F.getTimeOperator(this.timeInfo,b.timeExtent,this.featureAdapter);if(!g.isSome(b))return k.resolve(this);b=this.items.filter(b);return k.resolve(new a(b,this.queryGeometry,this))};
a.prototype.filterLatest=function(){for(var b=this.timeInfo,g=b.trackIdField,h=b.startTimeField,b=b.endTimeField||h,h=new Map,e=this.featureAdapter.getAttribute,l=0,r=this.items;l<r.length;l++){var m=r[l],u=e(m,g),q=e(m,b),p=h.get(u);(!p||q>e(p,b))&&h.set(u,m)}g=c.valuesOfMap(h);return k.resolve(new a(g,this.queryGeometry,this))};a.prototype.project=function(c){return b(this,void 0,void 0,function(){var b,g,e,l=this;return m(this,function(h){switch(h.label){case 0:if(!c||C.equals(this.spatialReference,
c))return[2,this];b=this.featureAdapter;return[4,G.projectMany(this.items.map(function(a){return y.getGeometry(l,b.getGeometry(a))}),this.spatialReference,c)];case 1:return g=h.sent(),e=g.map(function(a,c){return b.cloneWithGeometry(l.items[c],q.convertFromGeometry(a,l.hasZ,l.hasM))}),[2,new a(e,this.queryGeometry,{definitionExpression:this.definitionExpression,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:c,fieldsIndex:this.fieldsIndex,
timeInfo:this.timeInfo,featureAdapter:this.featureAdapter})]}})})};a.prototype._createFeatureQueryResponse=function(a){var b=this,c=this.items,e=this.geometryType,g=this.hasM,k=this.hasZ,n=this.objectIdField,m=this.spatialReference,u=a.outFields,q=a.outSR,p=a.quantizationParameters,B=a.resultRecordCount,D=a.resultOffset,C=a.returnZ,t=a.returnM,E=!1;null!=B&&null!=D&&(B=D+B,E=c.length>B,c=c.slice(D,Math.min(c.length,B)));u=u&&(-1<u.indexOf("*")?this.fieldsIndex.fields.slice():u.map(function(a){return b.fieldsIndex.get(a)}));
return{exceededTransferLimit:E,features:this._createFeatures(a,c),fields:u,geometryType:e,hasM:g&&t,hasZ:k&&C,objectIdFieldName:n,spatialReference:y.cleanFromGeometryEngine(q?q:m),transform:p&&x.toQuantizationTransform(p)||null}};a.prototype._createFeatures=function(a,b){var c=new D.default(a,this.featureAdapter,this.fieldsIndex),e=a.orderByFields,g=a.quantizationParameters,k=a.returnGeometry,n=a.returnCentroid,m=a.maxAllowableOffset,u=a.returnZ;a=a.returnM;var q=this.hasZ&&(void 0===u?!1:u),p=this.hasM&&
(void 0===a?!1:a),u=[];a=0;if(b.length&&e&&e.length){var e=e[0].split(" "),B=e[0],v=this.fieldsIndex.get(B),C=e[1]&&"desc"===e[1].toLowerCase();b.sort(function(a,b){a=c.getFieldValue(a,B,v);b=c.getFieldValue(b,B,v);if("number"===typeof a&&"number"===typeof b)return C?b-a:a-b;if("string"===typeof a&&"string"===typeof b)return a=a.toUpperCase(),b=b.toUpperCase(),(C?a>b:a<b)?-1:(C?a<b:a>b)?1:0})}if(k||n)if(g=x.toQuantizationTransform(g),k&&!n)for(n=0;n<b.length;n++)k=b[n],u[a++]={attributes:c.getAttributes(k),
geometry:y.getGeometry(this,this.featureAdapter.getGeometry(k),m,g,q,p)};else if(!k&&n)for(m=0;m<b.length;m++)k=b[m],u[a++]={attributes:c.getAttributes(k),centroid:y.transformCentroid(this,this.featureAdapter.getCentroid(k,this),g)};else for(n=0;n<b.length;n++)k=b[n],u[a++]={attributes:c.getAttributes(k),centroid:y.transformCentroid(this,this.featureAdapter.getCentroid(k,this),g),geometry:y.getGeometry(this,this.featureAdapter.getGeometry(k),m,g,q,p)};else for(m=0;m<b.length;m++)k=b[m],(q=c.getAttributes(k))&&
(u[a++]={attributes:q});return u};a.prototype._createExceedsLimitQueryResponse=function(a){var b=!1,c=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,b=Number.POSITIVE_INFINITY,g=0;for(a=a.outStatistics;g<a.length;g++){var k=a[g];if("exceedslimit"===k.statisticType){c=null!=k.maxPointCount?k.maxPointCount:Number.POSITIVE_INFINITY;e=null!=k.maxRecordCount?k.maxRecordCount:Number.POSITIVE_INFINITY;b=null!=k.maxVertexCount?k.maxVertexCount:Number.POSITIVE_INFINITY;break}}if("esriGeometryPoint"===
this.geometryType)b=this.items.length>c;else if(this.items.length>e)b=!0;else var c=this.hasZ?this.hasM?4:3:this.hasM?3:2,n=this.featureAdapter,b=this.items.reduce(function(a,b){b=n.getGeometry(b);return a+(b&&b.coords.length||0)},0)/c>b;return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(b)}}]}};a.prototype._createStatisticsQueryResponse=function(a){var b=new D.default(a,
this.featureAdapter,this.fieldsIndex),c=a.outStatistics,e=[],g=[],k=a.groupByFieldsForStatistics;a=a.having;for(var n=k&&k.length,k=n&&k[0],m=this.fieldsIndex.get(k),u=!m,q={},p={},B={},x={attributes:{}},C=0;C<c.length;C++){var t=c[C],y=t.outStatisticFieldName,E=t.statisticType,t="exceedslimit"!==E?t.onStatisticField:void 0,A=this.fieldsIndex.get(t),G=n&&(t===k||u)&&"count"===E;if(n){q[t]||(q[t]=this._calculateUniqueValues(b,k,m));var F=q[t],pa;for(pa in F){var S=F[pa],X=S.count,oa=S.data,T=S.items;
if(!a||b.validateItems(T,a)){var S=p[oa]||{attributes:{}},Y=null;G?Y=X:(X=this._calculateStatistics(T,b,t,A),T="var"===E?"variance":E,Y=X[T]);S.attributes[y]=Y;S.attributes[u?"EXPR_1":k]=oa;p[oa]=S}}}else B[t]||(B[t]=this._calculateStatistics(this.items,b,t,A)),X=B[t],T="var"===E?"variance":E,x.attributes[y]=X[T];g.push({name:y,alias:y,type:"esriFieldTypeDouble"})}if(n)for(var ga in p)e.push(p[ga]);else e.push(x);return{fields:g,features:e}};a.prototype._calculateStatistics=function(a,b,c,e){for(var g=
Number.POSITIVE_INFINITY,h=Number.NEGATIVE_INFINITY,k=null,n=null,m=null,u=null,q=[],p=0,x=0;x<a.length;x++){var v=b.getFieldValue(a[x],c,e);"string"===typeof v?p++:null==v||isNaN(v)||(k+=v,g=Math.min(g,v),h=Math.max(h,v),q.push(v),p++)}if(p){n=k/p;for(b=a=0;b<q.length;b++)v=q[b],a+=Math.pow(v-n,2);u=1<p?a/(p-1):0;m=Math.sqrt(u)}else h=g=null;return{avg:n,count:p,max:h,min:g,stddev:m,sum:k,variance:u}};a.prototype._calculateUniqueValues=function(a,b,c){for(var e={},g=0,h=this.items;g<h.length;g++){var k=
h[g],n=a.getFieldValue(k,b,c);if(null==n||"string"===typeof n&&""===n.trim())n=null;null==e[n]?e[n]={count:1,data:n,items:[k]}:(e[n].count++,e[n].items.push(k))}return e};return a}();a.default=A})},"esri/layers/graphics/data/AttributesBuilder":function(){define(["require","exports","../../../core/maybe","./attributeSupport"],function(A,a,t,m){Object.defineProperty(a,"__esModule",{value:!0});A=function(){function a(a,b,k){this._fieldDataCache=new Map;this._returnDistinctMap=new Map;this.returnDistinctValues=
a.returnDistinctValues;this.fieldsIndex=k;this.featureAdapter=b;if((a=a.outFields)&&-1===a.indexOf("*")){this.outFields=a;for(var c=b=0;c<a.length;c++){var g=a[c],t=m.getExpressionFromFieldName(g),q=this.fieldsIndex.get(t),t=q?null:m.getWhereClause(t,k),q=q?q.name:m.getAliasFromFieldName(g)||"FIELD_EXP_"+b++;this._fieldDataCache.set(g,{alias:q,clause:t})}}}a.prototype.getAttributes=function(a){a=this._processAttributesForOutFields(a);return this._processAttributesForDistinctValues(a)};a.prototype.getFieldValue=
function(a,b,k){var c=k?k.name:b,g=null;this._fieldDataCache.has(c)?g=this._fieldDataCache.get(c).clause:k||(g=m.getWhereClause(b,this.fieldsIndex),this._fieldDataCache.set(c,{alias:c,clause:g}));return k?this.featureAdapter.getAttribute(a,c):g.calculateValue(a,this.featureAdapter)};a.prototype.validateItem=function(a,b){this._fieldDataCache.has(b)||this._fieldDataCache.set(b,{alias:b,clause:m.getWhereClause(b,this.fieldsIndex)});return this._fieldDataCache.get(b).clause.testFeature(a,this.featureAdapter)};
a.prototype.validateItems=function(a,b){this._fieldDataCache.has(b)||this._fieldDataCache.set(b,{alias:b,clause:m.getWhereClause(b,this.fieldsIndex)});return this._fieldDataCache.get(b).clause.testSet(a,this.featureAdapter)};a.prototype._processAttributesForOutFields=function(a){var b=this.outFields;if(!b||!b.length)return this.featureAdapter.getAttributes(a);for(var c={},m=0;m<b.length;m++){var x=this._fieldDataCache.get(b[m]),t=x.alias,x=x.clause;c[t]=x?x.calculateValue(a,this.featureAdapter):this.featureAdapter.getAttribute(a,
t)}return c};a.prototype._processAttributesForDistinctValues=function(a){if(t.isNone(a)||!this.returnDistinctValues)return a;var b=this.outFields,c=[];if(b)for(var m=0;m<b.length;m++){var x=this._fieldDataCache.get(b[m]).alias;c.push(a[x])}else for(x in a)c.push(a[x]);b=(b||["*"]).join(",")+"\x3d"+c.join(",");c=this._returnDistinctMap.get(b)||0;this._returnDistinctMap.set(b,++c);return 1<c?null:a};return a}();a.default=A})},"esri/layers/graphics/data/timeSupport":function(){define(["require","exports"],
function(A,a){function t(a,c,g,k,m){if(null!=k&&null!=m&&k===m)return function(b){return k>=a.getAttribute(b,c)&&k<=a.getAttribute(b,g)};if(null!=k&&null!=m)return function(b){var u=a.getAttribute(b,c);b=a.getAttribute(b,g);return!(u>m||b<k)};if(null!=k)return function(b){return!(a.getAttribute(b,g)<k)};if(null!=m)return function(b){return!(a.getAttribute(b,c)>m)}}function m(a,c,g,k){if(null!=g&&null!=k&&g===k)return function(b){return a.getAttribute(b,c)===g};if(null!=g&&null!=k)return function(b){return a.getAttribute(b,
c)>=g&&a.getAttribute(b,c)<=k};if(null!=g)return function(b){return a.getAttribute(b,c)>=g};if(null!=k)return function(b){return a.getAttribute(b,c)<=k}}Object.defineProperty(a,"__esModule",{value:!0});a.getTimeExtent=function(a,c){if(!a)return null;var b=c.featureAdapter,k=a.startTimeField,m=a.endTimeField,x=Number.POSITIVE_INFINITY,t=Number.NEGATIVE_INFINITY;if(k&&m)c.forEach(function(a){var c=b.getAttribute(a,k);a=b.getAttribute(a,m);null==c||isNaN(c)||(x=Math.min(x,c));null==a||isNaN(a)||(t=Math.max(t,
a))});else{var q=k||m;c.forEach(function(a){a=b.getAttribute(a,q);null==a||isNaN(a)||(x=Math.min(x,a),t=Math.max(t,a))})}return{start:x,end:t}};a.getTimeOperator=function(a,c,g){if(!c||!a)return null;var b=a.startTimeField;a=a.endTimeField;if(!b&&!a)return null;var u=c.start;c=c.end;return null==u&&null==c?null:b&&a?t(g,b,a,u,c):m(g,b||a,u,c)}})},"esri/layers/graphics/data/utils":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/jsonMap ../../../core/maybe ../../../core/promiseUtils ../../../core/unitUtils ../../../geometry/support/extentUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../centroid ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./spatialQuerySupport".split(" "),
function(A,a,t,m,b,c,g,k,u,x,C,q,D,E,G,F,y){function p(a,b,c,e,g){void 0===e&&(e=a.hasZ);void 0===g&&(g=a.hasM);var h=a.hasZ&&e,k=a.hasM&&g;return c?(a=E.quantizeOptimizedGeometry(r,b,a.hasZ,a.hasM,"esriGeometryPoint",c,e,g),E.convertToPoint(a,h,k)):E.convertToPoint(b,h,k)}function n(b,e,g){return m(this,void 0,void 0,function(){var h,k,l,n,m,r;return t(this,function(p){switch(p.label){case 0:if(!b)return[2,null];h=b.where;b.where=h=h&&h.trim();if(!h||/^1 *= *1$/.test(h)||e&&e===h)b.where=null;return b.geometry?
[4,v(b)]:[2,b];case 1:return k=p.sent(),b.distance=0,b.units=null,"esriSpatialRelEnvelopeIntersects"===b.spatialRel&&(l=b.geometry.spatialReference,k=u.getGeometryExtent(k),k.spatialReference=l),b.geometry=k,[4,F.checkProjectionSupport(k.spatialReference,g)];case 2:return p.sent(),[4,C.normalizeCentralMeridian(x.fromJSON(k))];case 3:n=p.sent()[0];if(c.isNone(n))throw a.QUERY_ENGINE_EMPTY_RESULT;m=n.toJSON();return[4,F.project(m,m.spatialReference,g)];case 4:r=p.sent();if(!r)throw a.QUERY_ENGINE_EMPTY_RESULT;
r.spatialReference=g;b.geometry=r;return[2,b]}})})}function v(a){return m(this,void 0,void 0,function(){var b,c,e,l,n,m,r,p,u,v;return t(this,function(B){switch(B.label){case 0:b=a.geometry;c=a.distance;e=a.units;if(null==c)return[2,g.resolve(b)];l=b.spatialReference;n=e&&h.fromJSON(e)||k.getUnitString(l);m=l&&(q.isGeographic(l)||q.isWebMercator(l));if(!m)return[3,1];p=b;return[3,3];case 1:return[4,F.checkProjectionSupport(l,q.WGS84).then(function(){return F.project(b,q.WGS84)})];case 2:p=B.sent(),
B.label=3;case 3:return r=p,[4,y.getGeodesicBufferOperator()];case 4:return u=B.sent(),v=u(r,c,n),[2,v?v.toJSON():null]}})})}Object.defineProperty(a,"__esModule",{value:!0});var h=new b.default({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});a.QUERY_ENGINE_EMPTY_RESULT=Object.freeze({});var e=new G.default,l=new G.default,r=new G.default,U={esriGeometryPoint:E.convertToPoint,
esriGeometryPolyline:E.convertToPolyline,esriGeometryPolygon:E.convertToPolygon,esriGeometryMultipoint:E.convertToMultipoint};a.transformCentroid=p;a.getCentroid=function(a,b,c){if("esriGeometryPolygon"!==a.geometryType||!b||!b.centroid&&!b.geometry)return null;b.centroid||(b.centroid=D.getCentroidOptimizedGeometry(new G.default,b.geometry,a.hasZ,a.hasM));return p(a,b.centroid,c)};a.getGeometry=function(a,b,c,g,h,k){void 0===h&&(h=a.hasZ);void 0===k&&(k=a.hasM);var n=a.hasZ&&h,m=a.hasM&&k;b=b?"coords"in
b?b:b.geometry:null;if(!b)return null;if(c)return c=E.generalizeOptimizedGeometry(l,b,a.hasZ,a.hasM,a.geometryType,c,h,k),g&&(c=E.quantizeOptimizedGeometry(r,c,n,m,a.geometryType,g)),U[a.geometryType](c,n,m);if(g)return c=E.quantizeOptimizedGeometry(r,b,a.hasZ,a.hasM,a.geometryType,g,h,k),U[a.geometryType](c,n,m);E.removeZMValues(e,b,a.hasZ,a.hasM,h,k);return U[a.geometryType](e,n,m)};a.normalizeQuery=function(a,b,c){return m(this,void 0,void 0,function(){var e,g,h,k,l;return t(this,function(m){e=
a.outFields;g=a.orderByFields;h=a.groupByFieldsForStatistics;k=a.outStatistics;if(e)for(l=0;l<e.length;l++)e[l]=e[l].trim();if(g)for(l=0;l<g.length;l++)g[l]=g[l].trim();if(h)for(l=0;l<h.length;l++)h[l]=h[l].trim();if(k)for(l=0;l<k.length;l++)k[l].onStatisticField&&(k[l].onStatisticField=k[l].onStatisticField.trim());a.geometry&&!a.outSR&&(a.outSR=a.geometry.spatialReference);return[2,n(a,b,c)]})})};a.normalizeFilter=function(a,b,c){return m(this,void 0,void 0,function(){return t(this,function(e){return[2,
n(a,b,c)]})})};a.normalizeQueryLike=n;a.cleanFromGeometryEngine=function(a){return a&&W in a?JSON.parse(JSON.stringify(a,wa)):a};var W="_geVersion",wa=function(a,b){return a!==W?b:void 0}})},"esri/layers/graphics/centroid":function(){define(["require","exports"],function(A,a){function t(a,c,g,k,m,t){t=m?t?4:3:t?3:2;var b=g,q=g+t,u=0,x=0,A=g=0,F=0,y=0;for(--k;y<k;y++,b+=t,q+=t){var p=c[b],n=c[b+1],v=c[b+2],h=c[q],e=c[q+1],l=c[q+2],r=p*e-h*n,A=A+r,u=u+(p+h)*r,x=x+(n+e)*r;m&&(r=p*l-h*v,g+=(v+l)*r,F+=
r);p<a[0]&&(a[0]=p);p>a[1]&&(a[1]=p);n<a[2]&&(a[2]=n);n>a[3]&&(a[3]=n);m&&(v<a[4]&&(a[4]=v),v>a[5]&&(a[5]=v))}0<A&&(A*=-1);0<F&&(F*=-1);if(!A)return null;a=[u,x,.5*A];m&&(a[3]=g,a[4]=.5*F);return a}function m(a,c,g,k,m){m=k?m?4:3:m?3:2;for(var b=c,u=c+m,q=0,t=0,E=0,A=0,F=0,y=g-1;F<y;F++,b+=m,u+=m){var p=a[b],n=a[b+1],v=a[b+2],h=a[u],e=a[u+1],l=a[u+2],r;if(k){r=h-p;var U=e-n,W=l-v;r=Math.sqrt(r*r+U*U+W*W)}else r=h-p,U=e-n,r=Math.sqrt(r*r+U*U);r&&(q+=r,k?(p=[p+.5*(h-p),n+.5*(e-n),v+.5*(l-v)],t+=r*p[0],
E+=r*p[1],A+=r*p[2]):(p=[p+.5*(h-p),n+.5*(e-n)],t+=r*p[0],E+=r*p[1]))}return 0<q?k?[t/q,E/q,A/q]:[t/q,E/q]:0<g?k?[a[c],a[c+1],a[c+2]]:[a[c],a[c+1]]:null}Object.defineProperty(a,"__esModule",{value:!0});a.getCentroidOptimizedGeometry=function(a,c,g,k){if(!c||!c.lengths.length)return null;a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);for(var b=a.coords,x=[],C=g?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,
Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],q=c.lengths,D=c.coords,A=g?k?4:3:k?3:2,G=0,F=0;F<q.length;F++){var y=q[F],p=t(C,D,G,y,g,k);p&&x.push(p);G+=y*A}x.sort(function(a,b){var c=a[2]-b[2];0===c&&g&&(c=a[4]-b[4]);return c});x.length&&(A=6*x[0][2],b[0]=x[0][0]/A,b[1]=x[0][1]/A,g&&(A=6*x[0][4],b[2]=0!==A?x[0][3]/A:0),b[0]<C[0]||b[0]>C[1]||b[1]<C[2]||b[1]>C[3]||g&&(b[2]<C[4]||b[2]>C[5]))&&(b.length=0);if(!b.length)if(c=
c.lengths[0]?m(D,0,q[0],g,k):null)b[0]=c[0],b[1]=c[1],g&&2<c.length&&(b[2]=c[2]);else return null;return a};a.lineCentroid=m})},"esri/layers/graphics/data/spatialQuerySupport":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/Error ../../../core/promiseUtils ../../../geometry/support/contains ../../../geometry/support/intersects ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ../contains ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./utils".split(" "),
function(A,a,t,m,b,c,g,k,u,x,C,q,D,E,G){function F(){return c.create(function(a){return A(["../../../geometry/geometryEngine"],a)})}Object.defineProperty(a,"__esModule",{value:!0});var y={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",
esriSpatialRelRelation:null},p={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},n={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},v={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,
esriGeometryPolygon:!0,esriGeometryEnvelope:!1};a.importGeometryEngine=F;a.getGeodesicBufferOperator=function(){return F().then(function(a){return a.geodesicBuffer})};a.getSpatialQueryOperator=function(a,b,l){if(u.isPolygon(b)&&"esriGeometryPoint"===l.geometryType&&("esriSpatialRelIntersects"===a||"esriSpatialRelContains"===a)){var e=q.convertFromPolygon(new D.default,b,!1,!1);return c.resolve(function(a){return C.polygonContainsPoint(e,!1,!1,a)})}if(u.isPolygon(b)&&"esriGeometryMultipoint"===l.geometryType){var h=
q.convertFromPolygon(new D.default,b,!1,!1);if("esriSpatialRelContains"===a)return c.resolve(function(a){return C.polygonContainsMultipoint(h,!1,!1,a,l.hasZ,l.hasM)})}if(u.isExtent(b)&&"esriGeometryPoint"===l.geometryType&&("esriSpatialRelIntersects"===a||"esriSpatialRelContains"===a))return c.resolve(function(a){return g.extentContainsPoint(b,G.getGeometry(l,a))});if(u.isExtent(b)&&"esriGeometryMultipoint"===l.geometryType&&"esriSpatialRelContains"===a)return c.resolve(function(a){return g.extentContainsMultipoint(b,
G.getGeometry(l,a))});if(u.isExtent(b)&&"esriSpatialRelIntersects"===a){var n=k.getExtentIntersector(l.geometryType);return c.resolve(function(a){return n(b,G.getGeometry(l,a))})}return F().then(function(c){var e=c[y[a]].bind(null,b);return function(a){return e(G.getGeometry(l,a))}})};a.checkSpatialQuerySupport=function(a,c,g){return m(this,void 0,void 0,function(){var e,h;return t(this,function(k){e=a.spatialRel;h=a.geometry;if(!h)return[2];if(!0!==p[e])throw new b("feature-store:unsupported-query",
"Unsupported query spatial relationship",{query:a});if(!x.isValid(h.spatialReference)||!x.isValid(g))return[2];if(!0!==n[u.getJsonType(h)])throw new b("feature-store:unsupported-query","Unsupported query geometry type",{query:a});if(!0!==v[c])throw new b("feature-store:unsupported-query","Unsupported layer geometry type",{query:a});return a.outSR?[2,E.checkProjectionSupport(a.geometry&&a.geometry.spatialReference,a.outSR)]:[2]})})};a.canQueryWithRBush=function(a){if(u.isExtent(a))return!0;if(u.isPolygon(a)){var b=
0;for(a=a.rings;b<a.length;b++){var c=a[b];if(5!==c.length||c[0][0]!==c[1][0]||c[0][0]!==c[4][0]||c[2][0]!==c[3][0]||c[0][1]!==c[3][1]||c[0][1]!==c[4][1]||c[1][1]!==c[2][1])return!1}return!0}return!1}})},"esri/layers/graphics/contains":function(){define(["require","exports"],function(A,a){function t(a,b,c,g,k){if(!a)return!1;b=b?c?4:3:c?3:2;c=a.coords;var m=!1,t=0,C=0;for(a=a.lengths;C<a.length;C++){for(var q=a[C],D=t,A=t,G=t+q*b;A<G;A+=b){D=A+b;D===G&&(D=t);var F=c[A],y=c[A+1],p=c[D],D=c[D+1];(y<
k&&D>=k||D<k&&y>=k)&&F+(k-y)/(D-y)*(p-F)<g&&(m=!m)}t+=q*b}return m}Object.defineProperty(a,"__esModule",{value:!0});a.polygonContainsPoint=function(a,b,c,g){return t(a,b,c,g.coords[0],g.coords[1])};a.polygonContainsMultipoint=function(a,b,c,g,k,u){k=k?u?4:3:u?3:2;u=g.coords;g=g.lengths;if(!g)return!1;for(var m=0,A=0;m<g.length;m++,A+=k)if(!t(a,b,c,u[A],u[A+1]))return!1;return!0};a.polygonContainsCoords=t})},"esri/layers/support/PromiseQueue":function(){define(["require","exports","../../core/promiseUtils"],
function(A,a,t){Object.defineProperty(a,"__esModule",{value:!0});A=function(){function a(){this._tasks=[]}Object.defineProperty(a.prototype,"length",{get:function(){return this._tasks.length},enumerable:!0,configurable:!0});a.prototype.push=function(a){var b=this;return t.create(function(c,g){return b._tasks.push(new m(c,g,a))})};a.prototype.unshift=function(a){var b=this;return t.create(function(c,g){return b._tasks.unshift(new m(c,g,a))})};a.prototype.process=function(){if(0===this._tasks.length)return!1;
var a=this._tasks.shift();try{var b=a.callback();b&&"then"in b&&"function"===typeof b.then?b.then(a.resolve,a.reject):a.resolve(b)}catch(k){a.reject(k)}return!0};a.prototype.cancelAll=function(){for(var a=t.createAbortError(),b=0,k=this._tasks;b<k.length;b++)k[b].reject(a);this._tasks.length=0};return a}();a.default=A;var m=function(){return function(a,c,g){this.resolve=a;this.reject=c;this.callback=g}}()})},"esri/layers/graphics/data/optimizedFeatureQueryEngineAdapter":function(){define(["require",
"exports","../centroid","../OptimizedFeature","../OptimizedGeometry"],function(A,a,t,m,b){Object.defineProperty(a,"__esModule",{value:!0});a.optimizedFeatureQueryEngineAdapter={getObjectId:function(a){return a.objectId},getAttributes:function(a){return a.attributes},getAttribute:function(a,b){return a.attributes[b]},cloneWithGeometry:function(a,b){return new m.default(b,a.attributes,null,a.objectId)},getGeometry:function(a){return a.geometry},getCentroid:function(a,g){a.centroid||(a.centroid=t.getCentroidOptimizedGeometry(new b.default,
a.geometry,g.hasZ,g.hasM));return a.centroid}};a.default=a.optimizedFeatureQueryEngineAdapter})},"esri/layers/graphics/sources/geojson/geojson":function(){define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/tsSupport/valuesHelper ../../../../core/Error ../../OptimizedFeature ../../OptimizedGeometry".split(" "),function(A,a,t,m,b,c,g,k){function u(a){var b=[];a.forEach(function(a){return b.push(a)});return b}function x(a){var b,
c,g,h;return t(this,function(e){switch(e.label){case 0:b=a.type;switch(b){case "Feature":return[3,1];case "FeatureCollection":return[3,3]}return[3,7];case 1:return[4,a];case 2:return e.sent(),[3,7];case 3:c=0,g=a.features,e.label=4;case 4:return c<g.length?(h=g[c])?[4,h]:[3,6]:[3,7];case 5:e.sent(),e.label=6;case 6:return c++,[3,4];case 7:return[2]}})}function C(a){var c,g,h,k,n,m,p,q,u,v;return t(this,function(e){switch(e.label){case 0:if(!a)return[2,null];c=a.type;switch(c){case "Point":return[3,
1];case "LineString":return[3,3];case "MultiPoint":return[3,3];case "MultiLineString":return[3,5];case "Polygon":return[3,5];case "MultiPolygon":return[3,10]}return[3,17];case 1:return[4,a.coordinates];case 2:return e.sent(),[3,17];case 3:return[5,b(a.coordinates)];case 4:return e.sent(),[3,17];case 5:g=0,h=a.coordinates,e.label=6;case 6:if(!(g<h.length))return[3,9];k=h[g];return[5,b(k)];case 7:e.sent(),e.label=8;case 8:return g++,[3,6];case 9:return[3,17];case 10:n=0,m=a.coordinates,e.label=11;case 11:if(!(n<
m.length))return[3,16];p=m[n];q=0;u=p;e.label=12;case 12:if(!(q<u.length))return[3,15];v=u[q];return[5,b(v)];case 13:e.sent(),e.label=14;case 14:return q++,[3,12];case 15:return n++,[3,11];case 16:return[3,17];case 17:return[2]}})}function q(a,b){var c,e,h,n,m,p,q,u,x,y;void 0===b&&(b={});return t(this,function(l){switch(l.label){case 0:c=b.geometryType,e=b.objectIdFieldName,l.label=1;case 1:h=a.next();n=h.value;if(m=h.done)return[2];p=n.geometry;q=n.properties;u=n.id;if(p&&v[p.type]!==c)return[3,
1];x=q||{};e&&null!=u&&(x[e]=u);y=new g.default(p?F(new k.default,p,b):null,x);return[4,y];case 2:return l.sent(),[3,1];case 3:return[2]}})}function D(a){for(;;){var b=a.next();if(b.done)return!1;if(2<b.value.length)return!0}}function E(a){for(var b=0,c=0;c<a.length;c++)var g=a[c],h=a[(c+1)%a.length],b=b+(g[0]*h[1]-h[0]*g[1]);return 0>=b}function G(a){var b=a[0],c=a[a.length-1];b[0]===c[0]&&b[1]===c[1]&&b[2]===c[2]||a.push(b);return a}function F(a,b,c){switch(b.type){case "LineString":return y(a,
b.coordinates,c),a;case "MultiLineString":var e=0;for(b=b.coordinates;e<b.length;e++)y(a,b[e],c);return a;case "MultiPoint":return y(a,b.coordinates,c),a;case "MultiPolygon":e=0;for(b=b.coordinates;e<b.length;e++){var g=b[e],h=a,k=c,l=G(g[0]);E(l)?y(h,l,k):p(h,l,k);for(h=1;h<g.length;h++){var k=a,l=c,m=G(g[h]);E(m)?p(k,m,l):y(k,m,l)}}return a;case "Point":return n(a,b.coordinates,c),a;case "Polygon":e=b.coordinates;b=G(e[0]);E(b)?y(a,b,c):p(a,b,c);for(b=1;b<e.length;b++)g=a,h=c,k=G(e[b]),E(k)?p(g,
k,h):y(g,k,h);return a}}function y(a,b,c){for(var e=0;e<b.length;e++)n(a,b[e],c);a.lengths.push(b.length)}function p(a,b,c){for(var e=b.length-1;0<=e;e--)n(a,b[e],c);a.lengths.push(b.length)}function n(a,b,c){var e=b[2];a.coords.push(b[0],b[1]);c.hasZ&&a.coords.push(e||0)}Object.defineProperty(a,"__esModule",{value:!0});var v={LineString:"esriGeometryPolyline",MultiLineString:"esriGeometryPolyline",MultiPoint:"esriGeometryMultipoint",Point:"esriGeometryPoint",Polygon:"esriGeometryPolygon",MultiPolygon:"esriGeometryPolygon"};
a.validateGeoJSON=function(a){if(!a)throw new c("geojson-layer:empty","GeoJSON data is empty");if("Feature"!==a.type&&"FeatureCollection"!==a.type)throw new c("geojson-layer:unsupported-geojson-object","missing or not supported GeoJSON object type",{data:a});if(a.crs){var b=a.crs;if("link"===b.type||!["crs84","4326"].some(function(a){return-1!==b.properties.name.toLowerCase().indexOf(a)}))throw new c("geojson-layer:unsupported-crs","unsupported GeoJSON 'crs' member",{crs:b});}};a.inferLayerProperties=
function(a,b){void 0===b&&(b={});var c=x(a),e=[],g=new Set,h=new Set,k=!1,n=Number.NEGATIVE_INFINITY,m=null,p=!1,q=void 0;a=b.geometryType;var t=void 0===a?null:a,y=!1;for(a=function(){var a=c.next(),b=a.value;if(a.done){var l=m&&1===m.length&&m[0]||null;if(l)for(b=0;b<e.length;b++)a=e[b],a.name===l&&(a.type="esriFieldTypeOID");return{value:{fields:e,geometryType:t,hasZ:k,maxObjectId:Math.max(0,n),objectIdFieldName:l,objectIdFieldType:q,unknownFields:u(h)}}}var a=b.geometry,r=b.properties,x=b.id;
if(a&&(t||(t=v[a.type]),v[a.type]!==t))return"continue";k||(b=C(a),k=D(b));!p&&(p=null!=x)&&(q=typeof x,"number"===q&&(m=Object.keys(r).filter(function(a){return r[a]===x})));p&&"number"===q&&null!=x&&(n=Math.max(n,x),1<m.length?m=m.filter(function(a){return r[a]===x}):1===m.length&&(m=r[m[0]]===x?m:[]));if(!y&&r){b=!0;for(l in r)if(!g.has(l))if(a=r[l],null==a)b=!1,h.add(l);else{a:switch(typeof a){case "string":a="esriFieldTypeString";break a;case "number":a="esriFieldTypeDouble";break a;default:a=
"unknown"}"unknown"===a?h.add(l):(h.delete(l),g.add(l),e.push({name:l,alias:l,type:a}))}y=b}};;)if(b=a(),"object"===typeof b)return b.value};a.createOptimizedFeatures=function(a,b){a:for(a=q(x(a),b),b=[];;){var c=a.next(),e=c.value;if(c.done)break a;b.push(e)}return b}})},"esri/core/tsSupport/valuesHelper":function(){define([],function(){return function(A){var a="function"===typeof Symbol&&A[Symbol.iterator],t=0;return a?a.call(A):{next:function(){A&&t>=A.length&&(A=void 0);return{value:A&&A[t++],
done:!A}}}}})},"esri/layers/graphics/sources/support/clientSideDefaults":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/has ../../../../core/lang ../../../../symbols/support/defaultsJSON".split(" "),function(A,a,t,m,b,c){Object.defineProperty(a,"__esModule",{value:!0});a.createDrawingInfo=function(a){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===a||"esriGeometryMultipoint"===a?c.defaultPointSymbolJSON:"esriGeometryPolyline"===a?c.defaultPolylineSymbolJSON:
c.defaultPolygonSymbolJSON}}};a.createDefaultAttributesFunction=function(a,b){if(m("csp-restrictions"))return function(){var c;return t((c={},c[b]=null,c),a)};try{var c="this."+b+" \x3d null;",g;for(g in a)c+="this."+g+" \x3d "+JSON.stringify(a[g])+";";var k=new Function(c);return function(){return new k}}catch(q){return function(){var c;return t((c={},c[b]=null,c),a)}}};a.createDefaultTemplate=function(a){void 0===a&&(a={});return[{name:"New Feature",description:"",prototype:{attributes:b.clone(a)}}]}})},
"esri/layers/graphics/sources/support/sourceUtils":function(){define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../support/fieldUtils @dojo/framework/shim/Promise".split(" "),function(A,a,t,m,b){function c(a){return new u(a)}function g(){return m(this,void 0,void 0,function(){return t(this,function(a){switch(a.label){case 0:return q?[2,q]:[4,new Promise(function(a,b){A(["../../../../geometry/geometryEngine"],a,b)})];case 1:return q=a.sent(),
[2,q]}})})}Object.defineProperty(a,"__esModule",{value:!0});var k=function(){return function(){this.description=this.code=null}}(),u=function(){return function(a){this.error=new k;this.objectId=this.globalId=null;this.success=!1;this.uniqueId=null;this.error.description=a}}();a.createFeatureEditErrorResult=c;var x=function(){return function(a){this.globalId=null;this.success=!0;this.objectId=this.uniqueId=a}}();a.createFeatureEditSuccessResult=function(a){return new x(a)};var C=new Set;a.mixAttributes=
function(a,g,k,m,q,p){void 0===q&&(q=!1);C.clear();for(var n in m){var t=a.get(n);if(t){var h=m[n],e;e=t;var l=h,r=l;"string"===typeof l&&b.isNumericField(e)?r=parseFloat(l):null!=l&&b.isStringField(e)&&"string"!==typeof l&&(r=String(l));e=b.sanitizeNullFieldValue(r);e!==h&&p&&p.push({name:"invalid-value-type",message:"attribute value was converted to match the field type",details:{field:t,originalValue:h,sanitizedValue:e}});C.add(t.name);if(t&&(q||t.editable)){if(h=b.validateFieldValue(t,e))return c(b.validationErrorToString(h,
t,e));k[t.name]=e}}}for(a=0;a<g.length;a++)if(k=g[a],!C.has(k.name))return c('missing required field "'+k.name+'"');return null};var q;a.simplify=function(a,b){if(!a)return a;if("rings"in a||"paths"in a){if(!q)throw new TypeError("geometry engine not loaded");a.spatialReference||(a.spatialReference=b);return(a=q.simplify(a))?a.toJSON():null}return a};a.loadGeometryEngine=g;a.loadGeometryEngineForSimplify=function(a){return m(this,void 0,void 0,function(){return t(this,function(b){switch(b.label){case 0:return"esriGeometryPolygon"!==
a&&"esriGeometryPolyline"!==a?[3,2]:[4,g()];case 1:b.sent(),b.label=2;case 2:return[2]}})})}})},"*noref":1}});
define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/assignHelper ../../../../core/tsSupport/awaiterHelper ../../../../request ../../../../core/Error ../../../../core/promiseUtils ../../../../geometry/support/jsonUtils ../../../../geometry/support/spatialReferenceUtils ../../featureConversionUtils ../../data/FeatureStore ../../data/projectionSupport ../../data/QueryEngine ./geojson ../support/clientSideDefaults ../support/sourceUtils ../../../support/FieldsIndex ../../../support/fieldType ../../../support/fieldUtils".split(" "),function(A,
a,t,m,b,c,g,k,u,x,C,q,D,E,G,F,y,p,n,v){Object.defineProperty(a,"__esModule",{value:!0});var h={hasAttachments:!1,capabilities:"query, editing, create, delete, update",useStandardizedQueries:!0,supportsCoordinatesQuantization:!0,supportsReturningQueryGeometry:!0,advancedQueryCapabilities:{supportsQueryAttachments:!1,supportsStatistics:!0,supportsReturningGeometryCentroid:!0,supportsQueryWithDistance:!0,supportsDistinct:!0,supportsReturningQueryExtent:!0,supportsReturningGeometryProperties:!1,supportsHavingClause:!0,
supportsOrderBy:!0,supportsPagination:!0,supportsQueryWithResultType:!1,supportsSqlExpression:!0,supportsDisjointSpatialRel:!0}};A=function(){function a(){this._queryEngine=null}a.prototype.destroy=function(){this._queryEngine&&this._queryEngine&&this._queryEngine.destroy();this._queryEngine=this._requiredFields=this._fieldsIndex=this._createDefaultAttributes=null};a.prototype.load=function(a){return b(this,void 0,void 0,function(){var b,e,k,l,u,y,B,A,J,K,fa,Pa,Da,xa,M,pa,S,X,oa,T,Y,ga,aa,ha,ia,Ea,
Fa;return t(this,function(r){switch(r.label){case 0:return b=[],[4,this._checkProjection(a.spatialReference)];case 1:return r.sent(),e=null,a.url?[4,c(a.url,{responseType:"json"})]:[3,4];case 2:return k=r.sent(),e=k.data,[4,G.validateGeoJSON(e)];case 3:r.sent(),r.label=4;case 4:l=G.inferLayerProperties(e,{geometryType:a.geometryType});u=a.fields||l.fields||[];y=null!=a.hasZ?a.hasZ:l.hasZ;B=l.geometryType;A=a.objectIdField||("number"===l.objectIdFieldType?l.objectIdFieldName:"OBJECTID")||"OBJECTID";
J=a.spatialReference||x.WGS84;K=a.timeInfo;if(!B)throw new g("geojson-layer:missing-property","geometryType not set and couldn't be inferred from the provided features");"string"===l.objectIdFieldType&&b.push({name:"geojson-layer:unsupported-id-type",message:"Feature ids are of type string and can't be honored."});u===l.fields&&0<l.unknownFields.length&&b.push({name:"geojson-layer:unknown-field-types",message:"Some fields types couldn't be inferred from the features and were dropped",details:{unknownFields:l.unknownFields}});
A&&(fa=null,(Pa=u.some(function(a){return a.name===A?(fa=a,!0):!1}))?(fa.type="esriFieldTypeOID",fa.editable=!1,fa.nullable=!1):u.unshift({alias:A,name:A,type:"esriFieldTypeOID",editable:!1,nullable:!1}));Da=0;for(xa=u;Da<xa.length;Da++){M=xa[Da];null==M.name&&(M.name=M.alias);null==M.alias&&(M.alias=M.name);if(!M.name)throw new g("geojson-layer:invalid-field-name","field name is missing",{field:M});M.name===A&&(M.type="esriFieldTypeOID");if(-1===n.kebabDict.jsonValues.indexOf(M.type))throw new g("geojson-layer:invalid-field-type",
'invalid type for field "'+M.name+'"',{field:M});}pa={};this._requiredFields=[];S=0;for(X=u;S<X.length;S++)M=X[S],"esriFieldTypeOID"!==M.type&&"esriFieldTypeGlobalID"!==M.type&&(M.editable=null==M.editable?!0:!!M.editable,M.nullable=null==M.nullable?!0:!!M.nullable,oa=v.getFieldDefaultValue(M),M.nullable||void 0!==oa?pa[M.name]=oa:this._requiredFields.push(M));this._fieldsIndex=new p(u);K&&(K.startTimeField&&((T=this._fieldsIndex.get(K.startTimeField))?(K.startTimeField=T.name,T.type="esriFieldTypeDate"):
K.startTimeField=null),K.endTimeField&&((Y=this._fieldsIndex.get(K.endTimeField))?(K.endTimeField=Y.name,Y.type="esriFieldTypeDate"):K.endTimeField=null),K.trackIdField&&((ga=this._fieldsIndex.get(K.trackIdField))?K.trackIdField=ga.name:(K.trackIdField=null,b.push({name:"geojson-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:K}}))),K.startTimeField||K.endTimeField||(b.push({name:"geojson-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing",
details:{timeInfo:K}}),K=null));aa={warnings:b,featureErrors:[],layerDefinition:m({},h,{drawingInfo:F.createDrawingInfo(B),templates:F.createDefaultTemplate(pa),extent:null,geometryType:B,objectIdField:A,fields:u,hasZ:!!y,timeInfo:K})};this._queryEngine=new E.default({fields:u,geometryType:B,hasM:!1,hasZ:y,objectIdField:A,spatialReference:J,timeInfo:K,featureStore:new q.default({geometryType:B,hasM:!1,hasZ:y})});this._createDefaultAttributes=F.createDefaultAttributesFunction(pa,A);this._nextObjectId=
l.maxObjectId+1;ha=G.createOptimizedFeatures(e,{geometryType:B,hasZ:y,objectIdFieldName:"number"===l.objectIdFieldType?A:null});if(!x.equals(J,x.WGS84))for(ia=0,Ea=ha;ia<Ea.length;ia++)Fa=Ea[ia],Fa.geometry&&(Fa.geometry=C.convertFromGeometry(D.project(C.convertToGeometry(Fa.geometry,B,y,!1),x.WGS84,J)));this._loadInitialFeatures(aa,ha);return[2,aa]}})})};a.prototype.applyEdits=function(a){return b(this,void 0,void 0,function(){var b,c,e;return t(this,function(g){switch(g.label){case 0:return b=this._queryEngine,
c=b.spatialReference,e=b.geometryType,[4,k.all([y.loadGeometryEngineForSimplify(e),D.checkProjectionSupport(a.adds,c),D.checkProjectionSupport(a.updates,c)])];case 1:return g.sent(),[2,this._applyEdits(a)]}})})};a.prototype.queryFeatures=function(a,c){void 0===a&&(a={});void 0===c&&(c={});return b(this,void 0,void 0,function(){return t(this,function(b){return[2,this._queryEngine.executeQuery(a,c.signal)]})})};a.prototype.queryFeatureCount=function(a,c){void 0===a&&(a={});void 0===c&&(c={});return b(this,
void 0,void 0,function(){return t(this,function(b){return[2,this._queryEngine.executeQueryForCount(a,c.signal)]})})};a.prototype.queryObjectIds=function(a,c){void 0===a&&(a={});void 0===c&&(c={});return b(this,void 0,void 0,function(){return t(this,function(b){return[2,this._queryEngine.executeQueryForIds(a,c.signal)]})})};a.prototype.queryExtent=function(a,c){void 0===a&&(a={});void 0===c&&(c={});return b(this,void 0,void 0,function(){return t(this,function(b){return[2,this._queryEngine.executeQueryForExtent(a,
c.signal)]})})};a.prototype._loadInitialFeatures=function(a,b){for(var c=this._queryEngine,e=c.featureStore,c=c.objectIdField,g=[],h=0;h<b.length;h++){var k=b[h],l=this._createDefaultAttributes(),m=y.mixAttributes(this._fieldsIndex,this._requiredFields,l,k.attributes,!0,a.warnings);m?a.featureErrors.push(m):(this._assignObjectId(l,k.attributes,!0),k.attributes=l,k.objectId=l[c],g.push(k))}e.addMany(g);a.layerDefinition.extent=this._queryEngine.fullExtent;a.layerDefinition.timeInfo&&(b=this._queryEngine.timeExtent,
a.layerDefinition.timeInfo.timeExtent=[b.start,b.end]);return a};a.prototype._applyEdits=function(a){var b=a.adds,c=a.updates;a=a.deletes;var e={addResults:[],deleteResults:[],updateResults:[],uidToObjectId:{}};b&&b.length&&this._applyAddEdits(e,b);c&&c.length&&this._applyUpdateEdits(e,c);if(a&&a.length){for(b=0;b<a.length;b++)e.deleteResults.push(y.createFeatureEditSuccessResult(a[b]));this._queryEngine.featureStore.removeManyById(a)}return{fullExtent:this._queryEngine.fullExtent,timeExtent:this._queryEngine.timeExtent,
featureEditResults:e}};a.prototype._applyAddEdits=function(a,b){for(var c=a.addResults,e=this._queryEngine,g=e.geometryType,h=e.hasM,k=e.hasZ,l=e.objectIdField,m=e.spatialReference,e=e.featureStore,n=[],p=0;p<b.length;p++){var q=b[p];if(q.geometry&&g!==u.getJsonType(q.geometry))c.push(y.createFeatureEditErrorResult("Incorrect geometry type."));else{var r=this._createDefaultAttributes(),t=y.mixAttributes(this._fieldsIndex,this._requiredFields,r,q.attributes);t?c.push(t):(this._assignObjectId(r,q.attributes),
q.attributes=r,null!=q.uid&&(a.uidToObjectId[q.uid]=q.attributes[l]),q.geometry&&(q.geometry=D.project(y.simplify(q.geometry,m),q.geometry.spatialReference,m)),n.push(q),c.push(y.createFeatureEditSuccessResult(q.attributes[l])))}}e.addMany(C.convertFromFeatures([],n,g,k,h,l))};a.prototype._applyUpdateEdits=function(a,b){a=a.updateResults;for(var c=this._queryEngine,e=c.geometryType,g=c.hasM,h=c.hasZ,k=c.objectIdField,l=c.spatialReference,c=c.featureStore,m=0;m<b.length;m++){var n=b[m],p=n.attributes,
q=n.geometry,n=p&&p[k];if(null==n)a.push(y.createFeatureEditErrorResult("Identifier field "+k+" missing"));else if(c.has(n)){var r=C.convertToFeature(c.getFeature(n),e,h,g);if(q){if(e!==u.getJsonType(q)){a.push(y.createFeatureEditErrorResult("Incorrect geometry type."));continue}r.geometry=D.project(y.simplify(q,l),q.spatialReference,l)}if(p&&(p=y.mixAttributes(this._fieldsIndex,this._requiredFields,r.attributes,p))){a.push(p);continue}c.add(C.convertFromFeature(r,e,h,g,k));a.push(y.createFeatureEditSuccessResult(n))}else a.push(y.createFeatureEditErrorResult("Feature with object id "+
n+" missing"))}};a.prototype._assignObjectId=function(a,b,c){void 0===c&&(c=!1);var e=this._queryEngine.objectIdField;c?isFinite(b[e])?a[e]=b[e]:a[e]=this._nextObjectId++:a[e]=this._nextObjectId++};a.prototype._checkProjection=function(a){return b(this,void 0,void 0,function(){return t(this,function(b){switch(b.label){case 0:return b.trys.push([0,2,,3]),[4,D.checkProjectionSupport(x.WGS84,a)];case 1:return b.sent(),[3,3];case 2:throw b.sent(),new g("geojson-layer","Projection not supported");case 3:return[2]}})})};
return a}();a.default=A});