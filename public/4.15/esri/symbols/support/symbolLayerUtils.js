// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.15/esri/copyright.txt for details.
//>>built
define("require exports ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../request ../../core/Error ../../core/ItemCache ../../core/maybe ../../core/promiseUtils ../../geometry/support/aaBoundingBox ../../views/3d/layers/graphics/Graphics3DIconSymbolLayer ../../views/3d/layers/graphics/graphicUtils ../../views/3d/layers/graphics/objectResourceUtils ../../views/3d/layers/graphics/primitiveObjectSymbolUtils".split(" "),function(B,c,l,m,r,e,n,p,f,q,t,u,v,w){function g(a,b){return m(this,
void 0,void 0,function(){return l(this,function(C){if(a.resource.href)return[2,x(a.resource.href).then(function(a){return[a.width,a.height]})];if(a.resource.primitive)return p.isSome(b)?[2,[b,b]]:[2,t.default.PRIMITIVE_SIZE];throw new e("symbol3d:invalid-symbol-layer","symbol layers of type Icon must have either an href or a primitive resource");})})}function y(a,b){return g(a,b).then(function(b){if(null==a.size)return b;b=b[0]/b[1];return 1<b?[a.size,a.size/b]:[a.size*b,a.size]})}function x(a){return r(a,
{responseType:"image"}).then(function(a){return a.data})}function h(a,b){return z(a,b).then(function(a){return q.size(a)})}function A(a,b){return h(a,b).then(function(b){return u.computeSizeWithResourceSize(b,a)})}function z(a,b){if(!a.isPrimitive){var c=a.resource.href;b=k.get(c);return void 0!==b?f.resolve(b):v.fetch(c,{disableTextures:!0}).then(function(a){k.put(c,a.referenceBoundingBox);return a.referenceBoundingBox})}var d=null;if(a.resource&&a.resource.primitive&&(d=q.create(w.primitiveBoundingBox(a.resource.primitive)),
p.isSome(b)))for(a=0;a<d.length;a++)d[a]*=b;return d?f.resolve(d):f.reject(new e("symbol:invalid-resource","The symbol does not have a valid resource"))}Object.defineProperty(c,"__esModule",{value:!0});var k=new n(50);c.clearBoundingBoxCache=function(){k=new n(50)};c.computeLayerResourceSize=function(a,b){if("icon"===a.type)return g(a,b);if("object"===a.type)return h(a,b);throw new e("symbol3d:unsupported-symbol-layer","computeLayerSize only works with symbol layers of type Icon and Object");};c.computeLayerSize=
function(a,b){return m(this,void 0,void 0,function(){return l(this,function(c){if("icon"===a.type)return[2,y(a,b)];if("object"===a.type)return[2,A(a,b)];throw new e("symbol3d:unsupported-symbol-layer","computeLayerSize only works with symbol layers of type Icon and Object");})})};c.computeIconLayerResourceSize=g;c.computeObjectLayerResourceSize=h});