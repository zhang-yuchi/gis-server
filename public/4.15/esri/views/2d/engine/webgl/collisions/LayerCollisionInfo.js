// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.15/esri/copyright.txt for details.
//>>built
define("require exports ../../../../../core/Logger ../../../../../core/mathUtils ../../../../../core/screenUtils ./visualVariableSimpleUtils".split(" "),function(m,d,p,n,q,r){function t(b){return function(a){return q.pt2px(r.getSizeForValueSimple(a,b))}}function l(b){if(!b)return null;for(var a=0;a<b.length;a++){var c=b[a];if("size"===c.type)return t(c)}return null}Object.defineProperty(d,"__esModule",{value:!0});var u=function(b,a){return b.order-a.order},v=function(b,a){return b.index-a.index},
w=p.getLogger("esri/views/2d/engine/webgl/collisions/CollisionEngine");d.createLabelVVEvaluator=l;m=function(){function b(a,b,f,k){var c=this;this._vvHandle=null;var e=a.layer,h=e.geometryType,g=e.labelingInfo,d=e.renderer;e.renderer&&(this.vvEval=l("visualVariables"in d&&d.visualVariables));this._vvHandle=e.watch("renderer",function(a){e.renderer&&(c.vvEval=l("visualVariables"in a&&a.visualVariables))});g=g.map(function(a){var b=!!a.maxScale,c=!!a.minScale&&k.scaleToZoom(a.minScale)||0;a=b&&k.scaleToZoom(a.maxScale)||
255;return{minZoom:n.clamp(Math.floor(10*c),0,255),maxZoom:n.clamp(Math.floor(10*a),0,255)}});this.layerView=a;this.geometryType=h;this.index=b;this.order=f;this.zoomRanges=g;this.layerView=a}b.prototype.hasVV=function(){return!!this.vvEval};b.prototype.allOrNothing=function(){return"polyline"!==this.geometryType};b.prototype.destroy=function(){this._vvHandle.remove()};b.create=function(a,c,f,k){f=f.sort(u);for(var d=!1,e=-1,h=0;h<f.length;h++){var g=f[h];!d&&g.order>c&&(e=g.index,d=!0);d&&g.index++}d||
(e=f.length);return new b(a,e,c,k)};b.delete=function(a,b){for(var f=b.sort(v),c=a+1;c<f.length;c++)b[c].index--;b[a].destroy();b.splice(a,1)};b.find=function(a,b){for(var c=0;c<b.length;c++){var d=b[c];if(d.index===a)return d}w.error("Tried to get a LayerCollisionInfo for an index that doesn't exist!");return null};return b}();d.default=m});