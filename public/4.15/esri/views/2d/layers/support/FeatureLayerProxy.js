// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.15/esri/copyright.txt for details.
//>>built
define("require exports ../../../../core/tsSupport/declareExtendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/tsSupport/assignHelper ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/Promise ../../../../core/promiseUtils ../../../../core/workers ../../../../core/accessorSupport/decorators".split(" "),function(f,n,p,k,t,e,d,q,m,r,g){Object.defineProperty(n,"__esModule",{value:!0});f=function(f){function a(b){b=f.call(this,b)||
this;b._startupResolver=m.createResolver();b.isReady=!1;return b}p(a,f);a.prototype.initialize=function(){this._controller=m.createAbortController();this.addResolvingPromise(this._startWorker(this._controller.signal))};a.prototype.destroy=function(){this._controller.abort();this._connection&&this._connection.close()};Object.defineProperty(a.prototype,"tileRenderer",{set:function(b){this.client.tileRenderer=b},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"closed",{get:function(){return this._connection.closed},
enumerable:!0,configurable:!0});a.prototype.startup=function(b,c,a,l){return d(this,void 0,void 0,function(){var h,d,f,g;return e(this,function(e){switch(e.label){case 0:return[4,this.when()];case 1:return e.sent(),h=this._controller.signal,d=Array.isArray(a.source)?{transferList:a.source,signal:h}:void 0,f=b.tileInfo.toJSON(),g={service:a,config:c,tileInfo:f,options:l},[4,this._connection.invoke("startup",g,d)];case 2:return e.sent(),this._startupResolver.resolve(),this._set("isReady",!0),[2]}})})};
a.prototype.update=function(b,c){return d(this,void 0,void 0,function(){var a;return e(this,function(h){switch(h.label){case 0:return a={config:b,options:c},[4,this._startupResolver.promise];case 1:return h.sent(),[2,this._connection.invoke("update",a)]}})})};a.prototype.setHighlight=function(b){return d(this,void 0,void 0,function(){return e(this,function(c){switch(c.label){case 0:return[4,this._startupResolver.promise];case 1:return c.sent(),[2,this._connection.invoke("controller.setHighlight",
b)]}})})};a.prototype.refresh=function(){return d(this,void 0,void 0,function(){return e(this,function(b){switch(b.label){case 0:return[4,this._startupResolver.promise];case 1:return b.sent(),[2,this._connection.invoke("controller.refresh")]}})})};a.prototype.setViewState=function(b){return d(this,void 0,void 0,function(){return e(this,function(c){switch(c.label){case 0:return[4,this._startupResolver.promise];case 1:return c.sent(),[2,this._connection.invoke("setViewState",b.toJSON())]}})})};a.prototype.queryFeatures=
function(b,c){return d(this,void 0,void 0,function(){return e(this,function(a){switch(a.label){case 0:return[4,this._startupResolver.promise];case 1:return a.sent(),[2,this._connection.invoke("controller.queryFeatures",b.toJSON(),c)]}})})};a.prototype.queryObjectIds=function(b,c){return d(this,void 0,void 0,function(){return e(this,function(a){switch(a.label){case 0:return[4,this._startupResolver.promise];case 1:return a.sent(),[2,this._connection.invoke("controller.queryObjectIds",b.toJSON(),c)]}})})};
a.prototype.queryFeatureCount=function(b,a){return d(this,void 0,void 0,function(){return e(this,function(c){switch(c.label){case 0:return[4,this._startupResolver.promise];case 1:return c.sent(),[2,this._connection.invoke("controller.queryFeatureCount",b.toJSON(),a)]}})})};a.prototype.queryExtent=function(b,a){return d(this,void 0,void 0,function(){return e(this,function(c){return[2,this._connection.invoke("controller.queryExtent",b.toJSON(),a)]})})};a.prototype.queryLatestObservations=function(b,
a){return d(this,void 0,void 0,function(){return e(this,function(c){switch(c.label){case 0:return[4,this._startupResolver.promise];case 1:return c.sent(),[2,this._connection.invoke("controller.queryLatestObservations",b.toJSON(),a)]}})})};a.prototype.queryStatistics=function(b){return d(this,void 0,void 0,function(){return e(this,function(a){switch(a.label){case 0:return[4,this._startupResolver.promise];case 1:return a.sent(),[2,this._connection.invoke("controller.queryStatistics",b)]}})})};a.prototype.getObjectId=
function(a){return d(this,void 0,void 0,function(){return e(this,function(b){switch(b.label){case 0:return[4,this._startupResolver.promise];case 1:return b.sent(),[2,this._connection.invoke("controller.getObjectId",a)]}})})};a.prototype.getLocalId=function(a){return d(this,void 0,void 0,function(){return e(this,function(b){switch(b.label){case 0:return[4,this._startupResolver.promise];case 1:return b.sent(),[2,this._connection.invoke("controller.getLocalId",a)]}})})};a.prototype.getAggregate=function(a){return d(this,
void 0,void 0,function(){return e(this,function(b){switch(b.label){case 0:return[4,this._startupResolver.promise];case 1:return b.sent(),[2,this._connection.invoke("controller.getAggregate",a)]}})})};a.prototype.getAggregateValueRanges=function(){return d(this,void 0,void 0,function(){return e(this,function(a){switch(a.label){case 0:return[4,this._startupResolver.promise];case 1:return a.sent(),[2,this._connection.invoke("controller.getAggregateValueRanges")]}})})};a.prototype.mapValidLocalIds=function(a){return d(this,
void 0,void 0,function(){return e(this,function(b){switch(b.label){case 0:return[4,this._startupResolver.promise];case 1:return b.sent(),[2,this._connection.invoke("controller.mapValidLocalIds",a)]}})})};a.prototype.onEdits=function(a){return d(this,void 0,void 0,function(){var b,d,l;return e(this,function(c){switch(c.label){case 0:return[4,this._startupResolver.promise];case 1:return c.sent(),b=a.addedFeatures,d=a.deletedFeatures,l=a.updatedFeatures,[2,this._connection.invoke("controller.onEdits",
{addedFeatures:b,deletedFeatures:d,updatedFeatures:l})]}})})};a.prototype.enableEvent=function(a,c){return d(this,void 0,void 0,function(){return e(this,function(b){switch(b.label){case 0:return[4,this._startupResolver.promise];case 1:return b.sent(),[2,this._connection.invoke("controller.enableEvent",{name:a,value:c})]}})})};a.prototype._startWorker=function(a){return d(this,void 0,void 0,function(){var b,d;return e(this,function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),b=this,[4,r.open("Pipeline",
{client:this.client,strategy:"dedicated",signal:a})];case 1:return b._connection=c.sent(),[3,3];case 2:return d=c.sent(),m.throwIfNotAbortError(d),[3,3];case 3:return[2]}})})};k([g.property()],a.prototype,"isReady",void 0);k([g.property()],a.prototype,"client",void 0);k([g.property()],a.prototype,"tileRenderer",null);return a=k([g.subclass("esri.views.2d.layers.support.FeatureLayerProxy")],a)}(g.declared(q.EsriPromise));n.default=f});