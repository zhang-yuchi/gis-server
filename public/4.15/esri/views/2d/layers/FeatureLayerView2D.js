// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.15/esri/copyright.txt for details.
//>>built
require({cache:{"esri/AggregateGraphic":function(){define("require exports ./core/tsSupport/decorateHelper ./core/tsSupport/declareExtendsHelper ./core/tsSupport/assignHelper ./Graphic ./core/accessorSupport/decorators".split(" "),function(A,a,t,m,q,r,l){return function(a){function c(){return null!==a&&a.apply(this,arguments)||this}m(c,a);k=c;c.prototype.getEffectivePopupTemplate=function(a){void 0===a&&(a=!1);return this.popupTemplate?this.popupTemplate:(a=this.sourceLayer&&this.sourceLayer.featureReduction)&&
"popupTemplate"in a?a.popupTemplate:null};c.prototype.getObjectId=function(){return this.objectId};c.prototype.clone=function(){return new k(q({objectId:this.objectId},this.cloneProperties()))};var k;t([l.property({type:Number,json:{read:!0}})],c.prototype,"objectId",void 0);return c=k=t([l.subclass("esri.AggregateGraphic")],c)}(l.declared(r))})},"esri/layers/graphics/data/projectionSupport":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/Error ../../../core/promiseUtils ../../../geometry/projection ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),
function(A,a,t,m,q,r,l,c,d){function k(a,c){var b;if(!c)return null;if("x"in c){var d={x:0,y:0};a=a(c.x,c.y,h);d.x=a[0];d.y=a[1];null!=c.z&&(d.z=c.z);null!=c.m&&(d.m=c.m);return d}if("xmin"in c)return d={xmin:0,ymin:0,xmax:0,ymax:0},b=a(c.xmin,c.ymin,h),d.xmin=b[0],d.ymin=b[1],a=a(c.xmax,c.ymax,h),d.xmax=a[0],d.ymax=a[1],c.hasZ&&(d.zmin=c.zmin,d.zmax=c.zmax,d.hasZ=!0),c.hasM&&(d.mmin=c.mmin,d.mmax=c.mmax,d.hasM=!0),d;if("rings"in c)return{rings:g(c.rings,a),hasM:c.hasM,hasZ:c.hasZ};if("paths"in c)return{paths:g(c.paths,
a),hasM:c.hasM,hasZ:c.hasZ};if("points"in c)return{points:e(c.points,a),hasM:c.hasM,hasZ:c.hasZ}}function g(a,c){for(var b=[],d=0;d<a.length;d++)b.push(e(a[d],c));return b}function e(a,c){for(var b=[],d=0;d<a.length;d++){var e=a[d],v=c(e[0],e[1],[0,0]);b.push(v);2<e.length&&v.push(e[2]);3<e.length&&v.push(e[3])}return b}function p(a,e){return!c.isValid(a)||!c.isValid(e)||c.equals(a,e)||d.canProject(a,e)?!1:!0}Object.defineProperty(a,"__esModule",{value:!0});var h=[0,0];a.doesBrowserSupportProjection=
function(a,c){return p(a,c)?l.isSupported():!0};a.checkProjectionSupport=function(a,c){return m(this,void 0,void 0,function(){var b,d,e;return t(this,function(v){if(!c)return[2];if(Array.isArray(a)){b=0;for(d=a;b<d.length;b++)if(e=d[b],p(e.geometry&&e.geometry.spatialReference,c)){if(l.isSupported())return[2,l.load()];throw new q("feature-store:unsupported-query","projection not supported",{inSpatialReference:a,outSpatialReference:c});}return[2]}if(!p(a,c))return[2];if(l.isSupported())return[2,l.load()];
throw new q("feature-store:unsupported-query","projection not supported",{inSpatialReference:a,outSpatialReference:c});})})};var C=k.bind(null,d.lngLatToXY),w=k.bind(null,d.xyToLngLat);a.project=function(a,e,b){if(!a)return a;b||(b=e,e=a.spatialReference);return c.isValid(e)&&c.isValid(b)&&!c.equals(e,b)?d.canProject(e,b)?c.isWebMercator(b)?C(a):w(a):l.projectMany([a],e,b,null,!0)[0]:a};var J=new (function(){function a(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}a.prototype.push=
function(a,b,d){return m(this,void 0,void 0,function(){var e,h=this;return t(this,function(J){a&&a.length&&b&&d&&!c.equals(b,d)||r.resolve(a);e={geometries:a,inSpatialReference:b,outSpatialReference:d,resolve:null};this._jobs.push(e);return[2,r.create(function(b){e.resolve=b;null===h._timer&&(h._timer=setTimeout(h._process,10))})]})})};a.prototype._process=function(){this._timer=null;var a=this._jobs.shift();if(a){var b=a.geometries,e=a.inSpatialReference,h=a.outSpatialReference,a=a.resolve;d.canProject(e,
h)?c.isWebMercator(h)?a(b.map(C)):a(b.map(w)):a(l.projectMany(b,e,h,null,!0));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}};return a}());a.projectMany=function(a,c,b){return m(this,void 0,void 0,function(){return t(this,function(d){return[2,J.push(a,c,b)]})})}})},"esri/geometry/projection":function(){define("require exports ../core/promiseUtils ./pe ./SpatialReference ./support/GeographicTransformation".split(" "),function(A,a,t,m,q,r){function l(a,k,h,l,w){void 0===l&&(l=null);
void 0===w&&(w=!1);if(null===l){var e=r.cacheKey(k,h);void 0!==g[e]?l=g[e]:(l=c(k,h,null),null===l&&(l=new r),g[e]=l)}return d._project(a,k,h instanceof q||!1===w?h:new q(h),l,w)}function c(a,c,h){void 0===h&&(h=null);a=d._getTransformation(a,c,h);return null!==a?r.fromGE(a):null}Object.defineProperty(a,"__esModule",{value:!0});var d=null;a.isLoaded=function(){return!!d&&m.isLoaded()};a.isSupported=function(){return m.isSupported()};var k=null;a.load=function(){return k?k:k=t.create(function(a,c){var e=
m.load();A(["./geometryEngine"],function(h){d=h;e.then(function(){d._enableProjection(m);a()},function(a){c(a)})})})};a.project=function(a,c,d){void 0===d&&(d=null);return a instanceof Array?0===a.length?[]:l(a,a[0].spatialReference,c,d):l([a],a.spatialReference,c,d)[0]};var g={};a.projectMany=l;a.getTransformation=c;a.getTransformations=function(a,c,h){void 0===h&&(h=null);a=d._getTransformationBySuitability(a,c,h);if(null!==a){c=[];for(h=0;h<a.length;h++)c.push(r.fromGE(a[h]));return c}return[]}})},
"esri/geometry/pe":function(){define(["require","exports","../core/tsSupport/extendsHelper","../core/has","../core/promiseUtils"],function(A,a,t,m,q){function r(c){function d(b,a,c){b[a]=c(b[a])}a._pe=c;e.init();p.init();h.init();C.init();w.init();a.PeGCSExtent=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}t(c,b);c.prototype.destroy=function(){a._pe.destroy(this)};return c}(a._pe.PeGCSExtent);for(var g=0,b=[a._pe.PeDatum,a._pe.PeGeogcs,a._pe.PeGeogtran,a._pe.PeObject,a._pe.PeParameter,
a._pe.PePrimem,a._pe.PeProjcs,a._pe.PeSpheroid,a._pe.PeUnit];g<b.length;g++)c=b[g],d(c.prototype,"getName",function(b){return function(){return b.call(this,Array(e.PE_NAME_MAX))}});g=0;for(b=[a._pe.PeGeogtran,a._pe.PeProjcs];g<b.length;g++)c=b[g],d(c.prototype,"getParameters",function(b){return function(){for(var c=Array(e.PE_PARM_MAX),d=b.call(this),h=0;h<c.length;h++){var g=a._pe.getValue(d,"*");c[h]=g?a._pe.wrapPointer(g,a._pe.PeParameter):null;d+=Int32Array.BYTES_PER_ELEMENT}return c}});d(a._pe.PeHorizon.prototype,
"getCoord",function(b){return function(){var a=this.getSize();if(!a)return null;var c=[],d=b.call(this);k(c,a,d);return c}});d(a._pe.PeGTlistExtendedEntry.prototype,"getEntries",function(b){var c=a._pe._pe_getPeGTlistExtendedGTsSize();return function(){var d=null,e=b.call(this);if(!a._pe.compare(e,a._pe.NULL)){var d=[e],h=this.getSteps();if(1<h)for(var e=a._pe.getPointer(e),g=1;g<h;g++)d.push(a._pe.wrapPointer(e+c*g,a._pe.PeGTlistExtendedGTs))}return d}});var J=a._pe._pe_getPeHorizonSize();c=function(b){return function(){var c=
this._cache;c||(this._cache=c=new Map);if(c.has(b))return c.get(b);var d=null,e=b.call(this);if(!a._pe.compare(e,a._pe.NULL)){var d=[e],h=e.getNump();if(1<h)for(var e=a._pe.getPointer(e),g=1;g<h;g++)d.push(a._pe.wrapPointer(e+J*g,a._pe.PeHorizon))}c.set(b,d);return d}};d(a._pe.PeProjcs.prototype,"horizonGcsGenerate",c);d(a._pe.PeProjcs.prototype,"horizonPcsGenerate",c);a._pe.PeObject.prototype.toString=function(b){void 0===b&&(b=e.PE_STR_OPTS_NONE);a._pe.ensureCache.prepare();var c=a._pe.getPointer(this),
d=a._pe.ensureInt8(Array(e.PE_BUFFER_MAX));return a._pe.UTF8ToString(a._pe._pe_object_to_string_ext(c,b,d))}}function l(c){if(c){var d=a._pe.getClass(c);d&&(d=a._pe.getCache(d))&&(c=a._pe.getPointer(c))&&delete d[c]}}function c(c,d){var e=[];d=Array(d);for(var b=0;b<c;b++)e.push(a._pe.ensureInt8(d));return e}function d(a){var c;Array.isArray(a[0])?(c=[],a.forEach(function(a){c.push(a[0],a[1])})):c=a;return c}function k(c,d,e,b){void 0===b&&(b=!1);if(b)for(b=0;b<2*d;b++)c[b]=a._pe.getValue(e+b*Float64Array.BYTES_PER_ELEMENT,
"double");else{var h=0===c.length;for(b=0;b<d;b++)h&&(c[b]=Array(2)),c[b][0]=a._pe.getValue(e,"double"),c[b][1]=a._pe.getValue(e+Float64Array.BYTES_PER_ELEMENT,"double"),e+=2*Float64Array.BYTES_PER_ELEMENT}}Object.defineProperty(a,"__esModule",{value:!0});var g;a._pe=null;a.isLoaded=function(){return!!a._pe};a.isSupported=function(){return!!m("esri-wasm")};a.load=function(){return g?g:g=q.create(function(a,c){A(["./support/pe-wasm"],function(d){d({locateFile:function(b){return A.toUrl("./support/"+
b)},onAbort:function(b){c(Error(b))}}).then(function(b){r(b);a()})})})};(function(c){function h(b,c,e){a._pe.ensureCache.prepare();var h=d(e),g=e===h,h=a._pe.ensureFloat64(h);(b=a._pe._pe_geog_to_proj(a._pe.getPointer(b),c,h))&&k(e,c,h,g);return b}function g(a,c,d){return b(a,c,d,0)}function b(b,c,e,h){a._pe.ensureCache.prepare();var g=d(e),w=e===g,g=a._pe.ensureFloat64(g);(b=a._pe._pe_proj_to_geog_center(a._pe.getPointer(b),c,g,h))&&k(e,c,g,w);return b}c.geogToProj=h;c.projGeog=function(b,a,c,d){switch(d){case e.PE_TRANSFORM_P_TO_G:return g(b,
a,c);case e.PE_TRANSFORM_G_TO_P:return h(b,a,c)}return 0};c.projToGeog=g;c.projToGeogCenter=b})(a.PeCSTransformations||(a.PeCSTransformations={}));var e;(function(c){c.init=function(){c.PE_BUFFER_MAX=a._pe.PeDefs.prototype.PE_BUFFER_MAX;c.PE_NAME_MAX=a._pe.PeDefs.prototype.PE_NAME_MAX;c.PE_MGRS_MAX=a._pe.PeDefs.prototype.PE_MGRS_MAX;c.PE_USNG_MAX=a._pe.PeDefs.prototype.PE_USNG_MAX;c.PE_DD_MAX=a._pe.PeDefs.prototype.PE_DD_MAX;c.PE_DDM_MAX=a._pe.PeDefs.prototype.PE_DDM_MAX;c.PE_DMS_MAX=a._pe.PeDefs.prototype.PE_DMS_MAX;
c.PE_UTM_MAX=a._pe.PeDefs.prototype.PE_UTM_MAX;c.PE_PARM_MAX=a._pe.PeDefs.prototype.PE_PARM_MAX;c.PE_TYPE_NONE=a._pe.PeDefs.prototype.PE_TYPE_NONE;c.PE_TYPE_GEOGCS=a._pe.PeDefs.prototype.PE_TYPE_GEOGCS;c.PE_TYPE_PROJCS=a._pe.PeDefs.prototype.PE_TYPE_PROJCS;c.PE_TYPE_GEOGTRAN=a._pe.PeDefs.prototype.PE_TYPE_GEOGTRAN;c.PE_TYPE_COORDSYS=a._pe.PeDefs.prototype.PE_TYPE_COORDSYS;c.PE_TYPE_UNIT=a._pe.PeDefs.prototype.PE_TYPE_UNIT;c.PE_STR_OPTS_NONE=a._pe.PeDefs.prototype.PE_STR_OPTS_NONE;c.PE_STR_AUTH_NONE=
a._pe.PeDefs.prototype.PE_STR_AUTH_NONE;c.PE_STR_AUTH_TOP=a._pe.PeDefs.prototype.PE_STR_AUTH_TOP;c.PE_STR_NAME_CANON=a._pe.PeDefs.prototype.PE_STR_NAME_CANON;c.PE_PARM_X0=a._pe.PeDefs.prototype.PE_PARM_X0;c.PE_PARM_ND=a._pe.PeDefs.prototype.PE_PARM_ND;c.PE_TRANSFORM_1_TO_2=a._pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2;c.PE_TRANSFORM_2_TO_1=a._pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1;c.PE_TRANSFORM_P_TO_G=a._pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G;c.PE_TRANSFORM_G_TO_P=a._pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P;
c.PE_HORIZON_RECT=a._pe.PeDefs.prototype.PE_HORIZON_RECT;c.PE_HORIZON_POLY=a._pe.PeDefs.prototype.PE_HORIZON_POLY;c.PE_HORIZON_LINE=a._pe.PeDefs.prototype.PE_HORIZON_LINE;c.PE_HORIZON_DELTA=a._pe.PeDefs.prototype.PE_HORIZON_DELTA}})(e=a.PeDefs||(a.PeDefs={}));(function(c){function d(c,d){var e=null,g=b[c];g||(g={},b[c]=g);g.hasOwnProperty(String(d))?e=g[d]:(c=a._pe.PeFactory.prototype.factoryByType(c,d),a._pe.compare(c,a._pe.NULL)||(e=c,g[d]=e));return e=h(e)}function h(b){if(b){var c=b.getType();
switch(c){case e.PE_TYPE_GEOGCS:b=a._pe.castObject(b,a._pe.PeGeogcs);break;case e.PE_TYPE_PROJCS:b=a._pe.castObject(b,a._pe.PeProjcs);break;case e.PE_TYPE_GEOGTRAN:b=a._pe.castObject(b,a._pe.PeGeogtran);break;default:c&e.PE_TYPE_UNIT&&(b=a._pe.castObject(b,a._pe.PeUnit))}}return b}var b={},g={};c.initialize=function(){a._pe.PeFactory.prototype.initialize(null)};c.coordsys=function(b){return d(e.PE_TYPE_COORDSYS,b)};c.factoryByType=d;c.fromString=function(b,c){var d=null,e=g[b];e||(e={},g[b]=e);e.hasOwnProperty(c)?
d=e[c]:(b=a._pe.PeFactory.prototype.fromString(b,c),a._pe.compare(b,a._pe.NULL)||(d=b,e[c]=d));return d=h(d)};c.geogcs=function(b){return d(e.PE_TYPE_GEOGCS,b)};c.geogtran=function(b){return d(e.PE_TYPE_GEOGTRAN,b)};c.getCode=function(b){return a._pe.PeFactory.prototype.getCode(b)};c.projcs=function(b){return d(e.PE_TYPE_PROJCS,b)};c.unit=function(b){return d(e.PE_TYPE_UNIT,b)}})(a.PeFactory||(a.PeFactory={}));a.PeGCSExtent=null;var p;(function(c){var d;c.init=function(){c.PE_GTLIST_OPTS_COMMON=a._pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON;
d=a._pe._pe_getPeGTlistExtendedEntrySize()};c.getGTlist=function(c,b,e,h,g,k){var w=null,l=new a._pe.PeInteger(k);try{var p=a._pe.PeGTlistExtended.prototype.getGTlist(c,b,e,h,g,l);if(k=l.val)if(w=[p],1<k){var r=a._pe.getPointer(p);for(c=1;c<k;c++)w.push(a._pe.wrapPointer(r+d*c,a._pe.PeGTlistExtendedEntry))}}finally{a._pe.destroy(l)}return w}})(p=a.PeGTlistExtended||(a.PeGTlistExtended={}));(function(c){c.destroy=function(c){if(c&&c.length){for(var d=0;d<c.length;d++){var b=c[d];l(b);b.getEntries().forEach(function(b){l(b);
b=b.getGeogtran();l(b);b.getParameters().forEach(l);[b.getGeogcs1(),b.getGeogcs2()].forEach(function(b){l(b);var c=b.getDatum();l(c);l(c.getSpheroid());l(b.getPrimem());l(b.getUnit())})})}a._pe.PeGTlistExtendedEntry.prototype.Delete(c[0])}}})(a.PeGTlistExtendedEntry||(a.PeGTlistExtendedEntry={}));(function(c){c.geogToGeog=function(c,e,b,h,g){a._pe.ensureCache.prepare();var w=d(b),l=b===w,w=a._pe.ensureFloat64(w),p=0;h&&(p=a._pe.ensureFloat64(h));(c=a._pe._pe_geog_to_geog(a._pe.getPointer(c),e,w,p,
g))&&k(b,e,w,l);return c}})(a.PeGTTransformations||(a.PeGTTransformations={}));(function(h){function g(b,h,g,k,w,l){a._pe.ensureCache.prepare();var p,r;switch(b){case "dd":p=a._pe._pe_geog_to_dd;r=e.PE_DD_MAX;break;case "ddm":p=a._pe._pe_geog_to_ddm;r=e.PE_DDM_MAX;break;case "dms":p=a._pe._pe_geog_to_dms,r=e.PE_DMS_MAX}b=0;h&&(b=a._pe.getPointer(h));h=d(k);h=a._pe.ensureFloat64(h);r=c(g,r);k=a._pe.ensureInt32(r);if(w=p(b,g,h,w,k))for(p=0;p<g;p++)l[p]=a._pe.UTF8ToString(r[p]);return w}function w(b,
c,d,e,h){a._pe.ensureCache.prepare();var g;switch(b){case "dd":g=a._pe._pe_dd_to_geog;break;case "ddm":g=a._pe._pe_ddm_to_geog;break;case "dms":g=a._pe._pe_dms_to_geog}b=0;c&&(b=a._pe.getPointer(c));c=e.map(function(b){return a._pe.ensureString(b)});e=a._pe.ensureInt32(c);c=a._pe.ensureFloat64(Array(2*d));(g=g(b,d,e,c))&&k(h,d,c);return g}h.geog_to_dms=function(b,c,a,d,e){return g("dms",b,c,a,d,e)};h.dms_to_geog=function(b,c,a,d){return w("dms",b,c,a,d)};h.geog_to_ddm=function(b,c,a,d,e){return g("ddm",
b,c,a,d,e)};h.ddm_to_geog=function(b,c,a,d){return w("ddm",b,c,a,d)};h.geog_to_dd=function(b,c,a,d,e){return g("dd",b,c,a,d,e)};h.dd_to_geog=function(b,c,a,d){return w("dd",b,c,a,d)}})(a.PeNotationDms||(a.PeNotationDms={}));var h;(function(h){h.init=function(){h.PE_MGRS_STYLE_NEW=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW;h.PE_MGRS_STYLE_OLD=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD;h.PE_MGRS_STYLE_AUTO=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO;h.PE_MGRS_180_ZONE_1_PLUS=a._pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS;
h.PE_MGRS_ADD_SPACES=a._pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES};h.geog_to_mgrs_extended=function(h,g,b,k,w,p,l){a._pe.ensureCache.prepare();var r=0;h&&(r=a._pe.getPointer(h));h=d(b);b=a._pe.ensureFloat64(h);h=c(g,e.PE_MGRS_MAX);var m=a._pe.ensureInt32(h);if(k=a._pe._pe_geog_to_mgrs_extended(r,g,b,k,w,p,m))for(w=0;w<g;w++)l[w]=a._pe.UTF8ToString(h[w]);return k};h.mgrs_to_geog_extended=function(c,d,b,e,h){a._pe.ensureCache.prepare();var g=0;c&&(g=a._pe.getPointer(c));c=b.map(function(b){return a._pe.ensureString(b)});
b=a._pe.ensureInt32(c);c=a._pe.ensureFloat64(Array(2*d));(e=a._pe._pe_mgrs_to_geog_extended(g,d,b,e,c))&&k(h,d,c);return e}})(h=a.PeNotationMgrs||(a.PeNotationMgrs={}));(function(h){h.geog_to_usng=function(h,g,b,w,k,p,l){a._pe.ensureCache.prepare();var r=0;h&&(r=a._pe.getPointer(h));h=d(b);b=a._pe.ensureFloat64(h);h=c(g,e.PE_MGRS_MAX);var m=a._pe.ensureInt32(h);if(w=a._pe._pe_geog_to_usng(r,g,b,w,k,p,m))for(k=0;k<g;k++)l[k]=a._pe.UTF8ToString(h[k]);return w};h.usng_to_geog=function(c,d,b,e){a._pe.ensureCache.prepare();
var h=0;c&&(h=a._pe.getPointer(c));c=b.map(function(b){return a._pe.ensureString(b)});b=a._pe.ensureInt32(c);c=a._pe.ensureFloat64(Array(2*d));(h=a._pe._pe_usng_to_geog(h,d,b,c))&&k(e,d,c);return h}})(a.PeNotationUsng||(a.PeNotationUsng={}));var C;(function(h){h.init=function(){h.PE_UTM_OPTS_NONE=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE;h.PE_UTM_OPTS_ADD_SPACES=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES;h.PE_UTM_OPTS_NS=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS};h.geog_to_utm=function(h,
g,b,k,w){a._pe.ensureCache.prepare();var p=0;h&&(p=a._pe.getPointer(h));h=d(b);b=a._pe.ensureFloat64(h);h=c(g,e.PE_UTM_MAX);var l=a._pe.ensureInt32(h);if(k=a._pe._pe_geog_to_utm(p,g,b,k,l))for(p=0;p<g;p++)w[p]=a._pe.UTF8ToString(h[p]);return k};h.utm_to_geog=function(c,d,b,e,h){a._pe.ensureCache.prepare();var g=0;c&&(g=a._pe.getPointer(c));c=b.map(function(b){return a._pe.ensureString(b)});b=a._pe.ensureInt32(c);c=a._pe.ensureFloat64(Array(2*d));(e=a._pe._pe_utm_to_geog(g,d,b,e,c))&&k(h,d,c);return e}})(C=
a.PeNotationUtm||(a.PeNotationUtm={}));var w;(function(c){var d=new Map;c.init=function(){c.PE_PCSINFO_OPTION_NONE=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE;c.PE_PCSINFO_OPTION_DOMAIN=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN;c.PE_POLE_OUTSIDE_BOUNDARY=a._pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY;c.PE_POLE_POINT=a._pe.PePCSInfo.prototype.PE_POLE_POINT};c.generate=function(e,b){void 0===b&&(b=c.PE_PCSINFO_OPTION_DOMAIN);var h,g;d.has(e)&&(g=d.get(e),g[b]&&(h=g[b]));h||(h=a._pe.PePCSInfo.prototype.generate(e,
b),g||(g=[],d.set(e,g)),g[b]=h);return h}})(w=a.PePCSInfo||(a.PePCSInfo={}));(function(c){c.version_string=function(){return a._pe.PeVersion.prototype.version_string()}})(a.PeVersion||(a.PeVersion={}));a._init=r})},"esri/geometry/support/GeographicTransformation":function(){define(["require","exports","./GeographicTransformationStep"],function(A,a,t){return function(){function a(a){this.steps=[];this._cached_projection={};this._chain="";this._gtlistentry=null;if(a&&a.steps){var r=0;for(a=a.steps;r<
a.length;r++){var l=a[r];l instanceof t?this.steps.push(l):this.steps.push(new t({wkid:l.wkid,wkt:l.wkt,isInverse:l.isInverse}))}}}a.cacheKey=function(a,r){return[void 0!==a.wkid&&null!==a.wkid?a.wkid.toString():"-1",void 0!==a.wkt&&null!==a.wkt?a.wkt.toString():"",void 0!==r.wkid&&null!==r.wkid?r.wkid.toString():"-1",void 0!==r.wkt&&null!==r.wkt?r.wkt.toString():""].join()};a.fromGE=function(m){var r=new a,l="",c=0;for(m=m.steps;c<m.length;c++){var d=t.fromGE(m[c]);r.steps.push(d);l+=d.uid.toString()+
","}r._cached_projection={};r._gtlistentry=null;r._chain=l;return r};a.prototype.getInverse=function(){var m=new a;m.steps=[];for(var r=this.steps.length-1;0<=r;r--)m.steps.push(this.steps[r].getInverse());return m};a.prototype.getGTListEntry=function(){for(var a="",r=0,l=this.steps;r<l.length;r++)a+=l[r].uid.toString()+",";a!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=a);return this._gtlistentry};a.prototype.assignCachedGe=function(m,r,l){this._cached_projection[a.cacheKey(m,
r)]=l};a.prototype.getCachedGeTransformation=function(m,r){for(var l="",c=0,d=this.steps;c<d.length;c++)l+=d[c].uid.toString()+",";l!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=l);m=this._cached_projection[a.cacheKey(m,r)];return void 0===m?null:m};return a}()})},"esri/geometry/support/GeographicTransformationStep":function(){define(["require","exports"],function(A,a){var t=0;return function(){function a(a){void 0===a&&(a=null);this.uid=t++;a?(this._wkt=void 0!==
a.wkt?a.wkt:null,this._wkid=void 0!==a.wkid?a.wkid:-1,this._isInverse=void 0!==a.isInverse?!0===a.isInverse:!1):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}a.fromGE=function(m){var r=new a;r._wkt=m.wkt;r._wkid=m.wkid;r._isInverse=m.isInverse;return r};Object.defineProperty(a.prototype,"wkt",{get:function(){return this._wkt},set:function(a){this._wkt=a;this.uid=t++},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"wkid",{get:function(){return this._wkid},set:function(a){this._wkid=
a;this.uid=t++},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"isInverse",{get:function(){return this._isInverse},set:function(a){this._isInverse=a;this.uid=t++},enumerable:!0,configurable:!0});a.prototype.getInverse=function(){var m=new a;m._wkt=this.wkt;m._wkid=this._wkid;m._isInverse=!this.isInverse;return m};return a}()})},"esri/renderers/support/clickToleranceUtils":function(){define(["require","exports"],function(A,a){function t(a,l){return l?"xoffset"in l&&l.xoffset?Math.max(a,
Math.abs(l.xoffset)):"yoffset"in l&&l.yoffset?Math.max(a,Math.abs(l.yoffset||0)):a:a}function m(a,l){if("number"===typeof a)return a;if(a&&a.stops&&a.stops.length){a=a.stops;for(var c=l=0,d=0;d<a.length;d++){var k=a[d].size;"number"===typeof k&&(l+=k,c++)}return l/c}return l}function q(a,l){if(!l)return a;l=l.filter(function(a){return"size"===a.type}).map(function(c){var d=c.minSize;return(m(c.maxSize,a)+m(d,a))/2});var c=0,d=l.length;if(0===d)return a;for(var k=0;k<d;k++)c+=l[k];return Math.max(Math.floor(c/
d),a)}Object.defineProperty(a,"__esModule",{value:!0});a.calculateTolerance=function(a){var l=a&&a.renderer;a="touch"===(a&&a.event&&a.event.pointerType)?9:6;if(!l)return a;a="visualVariables"in l?q(a,l.visualVariables):a;if("simple"===l.type)return t(a,l.symbol);if("unique-value"===l.type){var c=a;l.uniqueValueInfos.forEach(function(a){c=t(c,a.symbol)});return c}if("class-breaks"===l.type){var d=a;l.classBreakInfos.forEach(function(a){d=t(d,a.symbol)});return d}return a}})},"esri/views/2d/layers/LayerView2D":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/Collection ../../../core/collectionUtils ../../../core/watchUtils ../../../core/accessorSupport/decorators ../../layers/support/ClipArea ../../layers/support/ClipRect ../../layers/support/Geometry ../../layers/support/Path".split(" "),
function(A,a,t,m,q,r,l,c,d,k,g,e){Object.defineProperty(a,"__esModule",{value:!0});var p=q.ofType({key:"type",base:d,typeMap:{rect:k,path:e,geometry:g}});a.LayerView2D=function(a){return function(a){function d(){var c=null!==a&&a.apply(this,arguments)||this;c.clips=new p;c.moving=!1;c.attached=!1;c.lastUpdateId=-1;c.updateRequested=!1;return c}t(d,a);d.prototype.initialize=function(){var a=this;this.when(function(){a.requestUpdate()},function(){});var c=function(){return a.notifyChange("rendering")};
this.handles.add([l.init(this,"suspended",function(c){a.container&&(a.container.visible=!c);a.view&&!c&&a.updateRequested&&a.view.requestLayerViewUpdate(a)},!0),l.init(this,["fullOpacity","container"],function(){a.container&&(a.container.opacity=a.fullOpacity)},!0),l.on(this,"container","post-render",c),l.on(this,"container","will-render",c)])};d.prototype.destroy=function(){this.attached&&(this.attached=!1,this.detach());this.handles.remove("initialize");this.updateRequested=!1;this.view=this.layer=
null};Object.defineProperty(d.prototype,"rendering",{get:function(){return this.attached&&!this.suspended&&(this.moving||this.container.renderRequested||this.isRendering())},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"updating",{get:function(){return!this.suspended&&(!this.attached||this.updateRequested||this.isUpdating())},enumerable:!0,configurable:!0});d.prototype.isVisibleAtScale=function(a){var c=!0,d=this.layer,b=d.minScale,d=d.maxScale;if(null!=b&&null!=d){var c=!b,e=
!d;!c&&a<=b&&(c=!0);!e&&a>=d&&(e=!0);c=c&&e}return c};d.prototype.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.suspended||this.view.requestLayerViewUpdate(this))};d.prototype.processUpdate=function(a){this.isFulfilled()&&!this.isResolved()?this.updateRequested=!1:(this._set("updateParameters",a),this.updateRequested&&!this.suspended&&(this.updateRequested=!1,this.update(a)))};d.prototype.isUpdating=function(){return!1};d.prototype.isRendering=function(){return!1};d.prototype.canResume=
function(){var a=this.inherited(arguments);a&&(a=this.isVisibleAtScale(this.view.scale));return a};m([c.property({type:p,set:function(a){a=r.referenceSetter(a,this._get("clips"),p);this._set("clips",a)}})],d.prototype,"clips",void 0);m([c.property()],d.prototype,"moving",void 0);m([c.property({dependsOn:["attached","suspended","moving"]})],d.prototype,"rendering",null);m([c.property()],d.prototype,"attached",void 0);m([c.property()],d.prototype,"container",void 0);m([c.property({dependsOn:["view.scale",
"layer.minScale","layer.maxScale"]})],d.prototype,"suspended",void 0);m([c.property({readOnly:!0})],d.prototype,"updateParameters",void 0);m([c.property()],d.prototype,"updateRequested",void 0);m([c.property({dependsOn:["updateRequested","attached","suspended"]})],d.prototype,"updating",null);m([c.property()],d.prototype,"view",void 0);return d=m([c.subclass("esri.views.2d.layers.LayerView2D")],d)}(c.declared(a))}})},"esri/views/layers/support/ClipArea":function(){define("require exports ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/JSONSupport ../../../core/accessorSupport/decorators".split(" "),
function(A,a,t,m,q,r){return function(a){function c(){return null!==a&&a.apply(this,arguments)||this}m(c,a);return c=t([r.subclass("esri.views.layers.support.ClipArea")],c)}(r.declared(q.JSONSupport))})},"esri/views/layers/support/ClipRect":function(){define("require exports ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/accessorSupport/decorators ./ClipArea".split(" "),function(A,a,t,m,q,r){return function(a){function c(){var c=null!==a&&a.apply(this,
arguments)||this;c.type="rect";c.left=null;c.right=null;c.top=null;c.bottom=null;return c}m(c,a);d=c;c.prototype.clone=function(){return new d({left:this.left,right:this.right,top:this.top,bottom:this.bottom})};Object.defineProperty(c.prototype,"version",{get:function(){return(this._get("version")||0)+1},enumerable:!0,configurable:!0});var d;t([q.property({type:[Number,String],json:{write:!0}})],c.prototype,"left",void 0);t([q.property({type:[Number,String],json:{write:!0}})],c.prototype,"right",
void 0);t([q.property({type:[Number,String],json:{write:!0}})],c.prototype,"top",void 0);t([q.property({type:[Number,String],json:{write:!0}})],c.prototype,"bottom",void 0);t([q.property({readOnly:!0,dependsOn:["left","right","top","bottom"]})],c.prototype,"version",null);return c=d=t([q.subclass("esri.views.layers.support.ClipRect")],c)}(q.declared(r))})},"esri/views/layers/support/Geometry":function(){define("require exports ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/declareExtendsHelper ../../../geometry ../../../core/accessorSupport/decorators ../../../geometry/Geometry ../../../geometry/support/jsonUtils ./ClipArea".split(" "),
function(A,a,t,m,q,r,l,c,d){var k={base:l,key:"type",typeMap:{extent:q.Extent,polygon:q.Polygon}};return function(a){function d(){var c=null!==a&&a.apply(this,arguments)||this;c.type="geometry";c.geometry=null;return c}m(d,a);g=d;Object.defineProperty(d.prototype,"version",{get:function(){return(this._get("version")||0)+1},enumerable:!0,configurable:!0});d.prototype.clone=function(){return new g({geometry:this.geometry.clone()})};var g;t([r.property({types:k,json:{read:c.fromJSON,write:!0}})],d.prototype,
"geometry",void 0);t([r.property({readOnly:!0,dependsOn:["geometry"]})],d.prototype,"version",null);return d=g=t([r.subclass("esri.views.layers.support.Geometry")],d)}(r.declared(d))})},"esri/views/layers/support/Path":function(){define("require exports ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/accessorSupport/decorators ./ClipArea".split(" "),function(A,a,t,m,q,r){return function(a){function c(){var c=null!==a&&a.apply(this,arguments)||this;
c.type="path";c.path=[];return c}m(c,a);Object.defineProperty(c.prototype,"version",{get:function(){return(this._get("version")||0)+1},enumerable:!0,configurable:!0});t([q.property({type:[[[Number]]],json:{write:!0}})],c.prototype,"path",void 0);t([q.property({readOnly:!0,dependsOn:["path"]})],c.prototype,"version",null);return c=t([q.subclass("esri.views.layers.support.Path")],c)}(q.declared(r))})},"esri/views/2d/layers/features/tileRenderers":function(){define(["require","exports","../../../../core/nextTick",
"../../../../core/promiseUtils"],function(A,a,t,m){Object.defineProperty(a,"__esModule",{value:!0});a.createOrReuseTileRenderer=function(a,r){if(!a)return m.resolve(null);switch(a.type){case "class-breaks":case "simple":case "unique-value":case "dot-density":case "dictionary":return m.create(function(a){t(function(){return A(["./tileRenderers/SymbolTileRenderer"],a)})}).then(function(a){return a.default}).then(function(a){return new a(r)});case "heatmap":return m.create(function(a){t(function(){return A(["./tileRenderers/HeatmapTileRenderer"],
a)})}).then(function(a){return a.default}).then(function(a){return new a(r)})}return m.resolve(null)}})},"esri/views/2d/layers/features/support/rendererUtils":function(){define(["require","exports","../../../../../core/Logger","../../../../../core/screenUtils","../../../engine"],function(A,a,t,m,q){Object.defineProperty(a,"__esModule",{value:!0});var r=q.definitions.WEBGL_MAX_INNER_STOPS,l=q.definitions.WEBGL_MAX_STOPS,c=t.getLogger("esri.renderers.visualVariables.support.utils");a.simplifyVVRenderer=
function(a){if(!("visualVariables"in a&&a.visualVariables&&a.visualVariables.length))return a;a=a.clone();var d=a.visualVariables.map(function(a){if(("size"===a.type||"color"===a.type||"opacity"===a.type)&&null!=a.stops){var d;var g=a.type;d=a.stops;if(!(d.length<=l))if(c.warn("Found "+d.length+" Visual Variable stops, but MapView only supports "+l+". Displayed stops will be simplified."),d.length>2*l){for(var h=d[0],k=d.slice(1),w=k.pop(),t=k[0].value,x=k[k.length-1].value,v=(x-t)/r,b=[];t<x;t+=
v){for(var y=0;t>=k[y].value;)y++;var q=k[y],L=d[y-1],B=t-L.value,q=q.value===L.value?1:B/(q.value-L.value);"color"===g?(L=k[y],y=d[y-1],B=L.color.clone(),B.r=(1-q)*y.color.r+q*B.r,B.g=(1-q)*y.color.g+q*B.g,B.b=(1-q)*y.color.b+q*B.b,B.a=(1-q)*y.color.a+q*B.a,b.push({value:t,color:B,label:L.label})):"size"===g?(L=k[y],B=d[y-1],y=m.toPt(L.size),B=m.toPt(B.size),b.push({value:t,size:(1-q)*B+q*y,label:L.label})):(L=k[y],b.push({value:t,opacity:(1-q)*d[y-1].opacity+q*L.opacity,label:L.label}))}d=[h].concat(b,
[w])}else{g=d[0];d=d.slice(1);for(h=d.pop();d.length>r;){w=k=0;for(x=1;x<d.length;x++)v=Math.abs(d[x].value-d[x-1].value),v>w&&(w=v,k=x);d.splice(k,1)}d=[g].concat(d,[h])}a.stops=d}return a});a.visualVariables=d;return a}})},"esri/views/2d/layers/support/clusterUtils":function(){define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/tsSupport/assignHelper ../../../../core/Error ../../../../core/has ../../../../core/Logger ../../../../core/maybe ../../../../core/MD5 ../../../../renderers/visualVariables/SizeVariable ../../../../renderers/visualVariables/support/SizeStop ../../engine".split(" "),
function(A,a,t,m,q,r,l,c,d,k,g,e,p){function h(b,a,c){switch(b){case "avg":case "avg_angle":return"cluster_avg_"+a;case "mode":return"cluster_type_"+a;case "norm":return b=a.toLowerCase()+",norm:field,"+c.toLowerCase(),"cluster_avg_"+k.createMD5Hash(b)}}function C(b,a,c){var d=k.createMD5Hash(a),h="mode"===c?"cluster_type_"+d:"cluster_avg_"+d;b.some(function(b){return b.name===h})||b.push({name:h,outStatistic:{onStatisticField:d,onStatisticValueExpression:a,statisticType:c}});return h}function w(b,
a,c,d){var e=h(c,a,d);b.some(function(b){return b.name===e})||("norm"===c?b.push({name:e,outStatistic:{onStatisticField:a,onStatisticNormalizationField:d,statisticType:c}}):b.push({name:e,outStatistic:{onStatisticField:a,statisticType:c}}));return e}var J=this;Object.defineProperty(a,"__esModule",{value:!0});var x=c.getLogger("esri.views.2d.layers.support.clusterUtils");l.add("esri-cluster-arcade-enabled",1);var v=l("esri-cluster-arcade-enabled");a.createClusterRenderer=function(b,c,h,e,g){return m(J,
void 0,void 0,function(){var c,k,p;return t(this,function(l){c=h.clone();if(!a.isClusterCompatibleRenderer(c))return[2,c];k="visualVariables"in c&&c.visualVariables||[];p=a.findSizeVV(k);k.forEach(function(a){"rotation"===a.type?a.field?a.field=w(b,a.field,"avg_angle"):a.valueExpression&&(a.field=C(b,a.valueExpression,"avg_angle"),a.valueExpression=null):a.normalizationField?(a.field=w(b,a.field,"norm",a.normalizationField),a.normalizationField=null):a.field?a.field=w(b,a.field,"avg"):(a.field=C(b,
a.valueExpression,"avg"),a.valueExpression=null)});d.isNone(p)&&k.push(a.createClusterCountSizeVariable(e,g));switch(c.type){case "unique-value":c.field?c.field=w(b,c.field,"mode"):c.valueExpression&&(c.field=C(b,c.valueExpression,"mode"),c.valueExpression=null);break;case "class-breaks":c.normalizationField?(c.field=w(b,c.field,"norm",c.normalizationField),c.normalizationField=null):c.field?c.field=w(b,c.field,"avg"):(c.field=C(b,c.valueExpression,"avg"),c.valueExpression=null)}c.visualVariables=
k;return[2,c]})})};a.findSizeVV=function(b){for(var a=0;a<b.length;a++){var c=b[a];if("size"===c.type)return c}return null};a.getActiveSizeStops=function(b,a){b=b.featuresTilingScheme.getClosestInfoForScale(b.scale).level;return a.levels?a.levels[b]:null};a.createClusterCountSizeVariable=function(b,a){var c=[new e({value:0,size:0}),new e({value:1})];if(d.isNone(a))return new g({field:"cluster_count",stops:c.concat([new e({value:2,size:0})])});b=Object.keys(a).reduce(function(b,d){var h;return q({},
b,(h={},h[d]=c.concat([new e({value:Math.max(2,a[d].minValue),size:"12px"}),new e({value:Math.max(3,a[d].maxValue),size:"50px"})]),h))},{});return new p.LevelDependentSizeVariable({field:"cluster_count",levels:b})};a.isClusterCompatibleRenderer=function(b){var a=function(a){return x.error(new r("Unsupported-renderer",a,{renderer:b}))};if("unique-value"===b.type){if(b.field2||b.field3)return a("FeatureReductionCluster does not support multi-field UniqueValueRenderers"),!1}else if("class-breaks"===
b.type){if(b.normalizationField){var c=b.normalizationType;if("field"!==c)return a("FeatureReductionCluster does not support a normalizationType of "+c),!1}}else if("simple"!==b.type)return a("FeatureReductionCluster does not support renderers of type "+b.type),!1;if(!v){if("valueExpression"in b&&b.valueExpression)return a("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"),!1;if(("visualVariables"in b&&b.visualVariables||[]).some(function(b){return!!("valueExpression"in
b&&b.valueExpression)}))return a("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"),!1}return!0}})},"esri/core/MD5":function(){define(["require","exports"],function(A,a){function t(a,d){var c=(a&65535)+(d&65535);return(a>>16)+(d>>16)+(c>>16)<<16|c&65535}function m(a,d,k,g,e,p){a=t(t(d,a),t(g,p));return t(a<<e|a>>>32-e,k)}function q(a,d,k,g,e,p,h){return m(d&k|~d&g,a,d,e,p,h)}function r(a,d,k,g,e,p,h){return m(d&g|
k&~g,a,d,e,p,h)}function l(a,d,k,g,e,p,h){return m(k^(d|~g),a,d,e,p,h)}Object.defineProperty(a,"__esModule",{value:!0});a.outputTypes={Base64:0,Hex:1,String:2,Raw:3};a.createMD5Hash=function(c,d){void 0===d&&(d=a.outputTypes.Hex);d=d||a.outputTypes.Base64;for(var k=[],g=0,e=8*c.length;g<e;g+=8)k[g>>5]|=(c.charCodeAt(g/8)&255)<<g%32;c=8*c.length;k[c>>5]|=128<<c%32;k[(c+64>>>9<<4)+14]=c;c=1732584193;for(var g=-271733879,e=-1732584194,p=271733878,h=0;h<k.length;h+=16){var C=c,w=g,J=e,x=p;c=q(c,g,e,p,
k[h+0],7,-680876936);p=q(p,c,g,e,k[h+1],12,-389564586);e=q(e,p,c,g,k[h+2],17,606105819);g=q(g,e,p,c,k[h+3],22,-1044525330);c=q(c,g,e,p,k[h+4],7,-176418897);p=q(p,c,g,e,k[h+5],12,1200080426);e=q(e,p,c,g,k[h+6],17,-1473231341);g=q(g,e,p,c,k[h+7],22,-45705983);c=q(c,g,e,p,k[h+8],7,1770035416);p=q(p,c,g,e,k[h+9],12,-1958414417);e=q(e,p,c,g,k[h+10],17,-42063);g=q(g,e,p,c,k[h+11],22,-1990404162);c=q(c,g,e,p,k[h+12],7,1804603682);p=q(p,c,g,e,k[h+13],12,-40341101);e=q(e,p,c,g,k[h+14],17,-1502002290);g=q(g,
e,p,c,k[h+15],22,1236535329);c=r(c,g,e,p,k[h+1],5,-165796510);p=r(p,c,g,e,k[h+6],9,-1069501632);e=r(e,p,c,g,k[h+11],14,643717713);g=r(g,e,p,c,k[h+0],20,-373897302);c=r(c,g,e,p,k[h+5],5,-701558691);p=r(p,c,g,e,k[h+10],9,38016083);e=r(e,p,c,g,k[h+15],14,-660478335);g=r(g,e,p,c,k[h+4],20,-405537848);c=r(c,g,e,p,k[h+9],5,568446438);p=r(p,c,g,e,k[h+14],9,-1019803690);e=r(e,p,c,g,k[h+3],14,-187363961);g=r(g,e,p,c,k[h+8],20,1163531501);c=r(c,g,e,p,k[h+13],5,-1444681467);p=r(p,c,g,e,k[h+2],9,-51403784);e=
r(e,p,c,g,k[h+7],14,1735328473);g=r(g,e,p,c,k[h+12],20,-1926607734);c=m(g^e^p,c,g,k[h+5],4,-378558);p=m(c^g^e,p,c,k[h+8],11,-2022574463);e=m(p^c^g,e,p,k[h+11],16,1839030562);g=m(e^p^c,g,e,k[h+14],23,-35309556);c=m(g^e^p,c,g,k[h+1],4,-1530992060);p=m(c^g^e,p,c,k[h+4],11,1272893353);e=m(p^c^g,e,p,k[h+7],16,-155497632);g=m(e^p^c,g,e,k[h+10],23,-1094730640);c=m(g^e^p,c,g,k[h+13],4,681279174);p=m(c^g^e,p,c,k[h+0],11,-358537222);e=m(p^c^g,e,p,k[h+3],16,-722521979);g=m(e^p^c,g,e,k[h+6],23,76029189);c=m(g^
e^p,c,g,k[h+9],4,-640364487);p=m(c^g^e,p,c,k[h+12],11,-421815835);e=m(p^c^g,e,p,k[h+15],16,530742520);g=m(e^p^c,g,e,k[h+2],23,-995338651);c=l(c,g,e,p,k[h+0],6,-198630844);p=l(p,c,g,e,k[h+7],10,1126891415);e=l(e,p,c,g,k[h+14],15,-1416354905);g=l(g,e,p,c,k[h+5],21,-57434055);c=l(c,g,e,p,k[h+12],6,1700485571);p=l(p,c,g,e,k[h+3],10,-1894986606);e=l(e,p,c,g,k[h+10],15,-1051523);g=l(g,e,p,c,k[h+1],21,-2054922799);c=l(c,g,e,p,k[h+8],6,1873313359);p=l(p,c,g,e,k[h+15],10,-30611744);e=l(e,p,c,g,k[h+6],15,-1560198380);
g=l(g,e,p,c,k[h+13],21,1309151649);c=l(c,g,e,p,k[h+4],6,-145523070);p=l(p,c,g,e,k[h+11],10,-1120210379);e=l(e,p,c,g,k[h+2],15,718787259);g=l(g,e,p,c,k[h+9],21,-343485551);c=t(c,C);g=t(g,w);e=t(e,J);p=t(p,x)}k=[c,g,e,p];switch(d){case a.outputTypes.Raw:return k;case a.outputTypes.Hex:d=[];c=0;for(g=4*k.length;c<g;c++)d.push("0123456789abcdef".charAt(k[c>>2]>>c%4*8+4&15)+"0123456789abcdef".charAt(k[c>>2]>>c%4*8&15));return d.join("");case a.outputTypes.String:d=[];c=0;for(g=32*k.length;c<g;c+=8)d.push(String.fromCharCode(k[c>>
5]>>>c%32&255));return d.join("");case a.outputTypes.Base64:d=[];c=0;for(g=4*k.length;c<g;c+=3)for(e=(k[c>>2]>>c%4*8&255)<<16|(k[c+1>>2]>>(c+1)%4*8&255)<<8|k[c+2>>2]>>(c+2)%4*8&255,p=0;4>p;p++)8*c+6*p>32*k.length?d.push("\x3d"):d.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>6*(3-p)&63));return d.join("")}}})},"esri/views/2d/layers/support/FeatureLayerProxy":function(){define("require exports ../../../../core/tsSupport/declareExtendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/tsSupport/assignHelper ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/Promise ../../../../core/promiseUtils ../../../../core/workers ../../../../core/accessorSupport/decorators".split(" "),
function(A,a,t,m,q,r,l,c,d,k,g){Object.defineProperty(a,"__esModule",{value:!0});A=function(a){function c(c){c=a.call(this,c)||this;c._startupResolver=d.createResolver();c.isReady=!1;return c}t(c,a);c.prototype.initialize=function(){this._controller=d.createAbortController();this.addResolvingPromise(this._startWorker(this._controller.signal))};c.prototype.destroy=function(){this._controller.abort();this._connection&&this._connection.close()};Object.defineProperty(c.prototype,"tileRenderer",{set:function(a){this.client.tileRenderer=
a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"closed",{get:function(){return this._connection.closed},enumerable:!0,configurable:!0});c.prototype.startup=function(a,c,d,e){return l(this,void 0,void 0,function(){var h,g,b,k;return r(this,function(w){switch(w.label){case 0:return[4,this.when()];case 1:return w.sent(),h=this._controller.signal,g=Array.isArray(d.source)?{transferList:d.source,signal:h}:void 0,b=a.tileInfo.toJSON(),k={service:d,config:c,tileInfo:b,options:e},[4,
this._connection.invoke("startup",k,g)];case 2:return w.sent(),this._startupResolver.resolve(),this._set("isReady",!0),[2]}})})};c.prototype.update=function(a,c){return l(this,void 0,void 0,function(){var d;return r(this,function(h){switch(h.label){case 0:return d={config:a,options:c},[4,this._startupResolver.promise];case 1:return h.sent(),[2,this._connection.invoke("update",d)]}})})};c.prototype.setHighlight=function(a){return l(this,void 0,void 0,function(){return r(this,function(c){switch(c.label){case 0:return[4,
this._startupResolver.promise];case 1:return c.sent(),[2,this._connection.invoke("controller.setHighlight",a)]}})})};c.prototype.refresh=function(){return l(this,void 0,void 0,function(){return r(this,function(a){switch(a.label){case 0:return[4,this._startupResolver.promise];case 1:return a.sent(),[2,this._connection.invoke("controller.refresh")]}})})};c.prototype.setViewState=function(a){return l(this,void 0,void 0,function(){return r(this,function(c){switch(c.label){case 0:return[4,this._startupResolver.promise];
case 1:return c.sent(),[2,this._connection.invoke("setViewState",a.toJSON())]}})})};c.prototype.queryFeatures=function(a,c){return l(this,void 0,void 0,function(){return r(this,function(d){switch(d.label){case 0:return[4,this._startupResolver.promise];case 1:return d.sent(),[2,this._connection.invoke("controller.queryFeatures",a.toJSON(),c)]}})})};c.prototype.queryObjectIds=function(a,c){return l(this,void 0,void 0,function(){return r(this,function(d){switch(d.label){case 0:return[4,this._startupResolver.promise];
case 1:return d.sent(),[2,this._connection.invoke("controller.queryObjectIds",a.toJSON(),c)]}})})};c.prototype.queryFeatureCount=function(a,c){return l(this,void 0,void 0,function(){return r(this,function(d){switch(d.label){case 0:return[4,this._startupResolver.promise];case 1:return d.sent(),[2,this._connection.invoke("controller.queryFeatureCount",a.toJSON(),c)]}})})};c.prototype.queryExtent=function(a,c){return l(this,void 0,void 0,function(){return r(this,function(d){return[2,this._connection.invoke("controller.queryExtent",
a.toJSON(),c)]})})};c.prototype.queryLatestObservations=function(a,c){return l(this,void 0,void 0,function(){return r(this,function(d){switch(d.label){case 0:return[4,this._startupResolver.promise];case 1:return d.sent(),[2,this._connection.invoke("controller.queryLatestObservations",a.toJSON(),c)]}})})};c.prototype.queryStatistics=function(a){return l(this,void 0,void 0,function(){return r(this,function(c){switch(c.label){case 0:return[4,this._startupResolver.promise];case 1:return c.sent(),[2,this._connection.invoke("controller.queryStatistics",
a)]}})})};c.prototype.getObjectId=function(a){return l(this,void 0,void 0,function(){return r(this,function(c){switch(c.label){case 0:return[4,this._startupResolver.promise];case 1:return c.sent(),[2,this._connection.invoke("controller.getObjectId",a)]}})})};c.prototype.getLocalId=function(a){return l(this,void 0,void 0,function(){return r(this,function(c){switch(c.label){case 0:return[4,this._startupResolver.promise];case 1:return c.sent(),[2,this._connection.invoke("controller.getLocalId",a)]}})})};
c.prototype.getAggregate=function(a){return l(this,void 0,void 0,function(){return r(this,function(c){switch(c.label){case 0:return[4,this._startupResolver.promise];case 1:return c.sent(),[2,this._connection.invoke("controller.getAggregate",a)]}})})};c.prototype.getAggregateValueRanges=function(){return l(this,void 0,void 0,function(){return r(this,function(a){switch(a.label){case 0:return[4,this._startupResolver.promise];case 1:return a.sent(),[2,this._connection.invoke("controller.getAggregateValueRanges")]}})})};
c.prototype.mapValidLocalIds=function(a){return l(this,void 0,void 0,function(){return r(this,function(c){switch(c.label){case 0:return[4,this._startupResolver.promise];case 1:return c.sent(),[2,this._connection.invoke("controller.mapValidLocalIds",a)]}})})};c.prototype.onEdits=function(a){return l(this,void 0,void 0,function(){var c,d,e;return r(this,function(h){switch(h.label){case 0:return[4,this._startupResolver.promise];case 1:return h.sent(),c=a.addedFeatures,d=a.deletedFeatures,e=a.updatedFeatures,
[2,this._connection.invoke("controller.onEdits",{addedFeatures:c,deletedFeatures:d,updatedFeatures:e})]}})})};c.prototype.enableEvent=function(a,c){return l(this,void 0,void 0,function(){return r(this,function(d){switch(d.label){case 0:return[4,this._startupResolver.promise];case 1:return d.sent(),[2,this._connection.invoke("controller.enableEvent",{name:a,value:c})]}})})};c.prototype._startWorker=function(a){return l(this,void 0,void 0,function(){var c,e;return r(this,function(h){switch(h.label){case 0:return h.trys.push([0,
2,,3]),c=this,[4,k.open("Pipeline",{client:this.client,strategy:"dedicated",signal:a})];case 1:return c._connection=h.sent(),[3,3];case 2:return e=h.sent(),d.throwIfNotAbortError(e),[3,3];case 3:return[2]}})})};m([g.property()],c.prototype,"isReady",void 0);m([g.property()],c.prototype,"client",void 0);m([g.property()],c.prototype,"tileRenderer",null);return c=m([g.subclass("esri.views.2d.layers.support.FeatureLayerProxy")],c)}(g.declared(c.EsriPromise));a.default=A})},"esri/views/2d/layers/support/util":function(){define(["require",
"exports","../../../../core/jsonMap"],function(A,a,t){Object.defineProperty(a,"__esModule",{value:!0});var m=new t.default({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"});a.toJSONGeometryType=function(a){return m.toJSON(a)};a.analyzeRings=function(a,m,l){for(var c=[],d=[],k=0,g=0,e=0;e<a.length;e++){var p=a[e],h=g,r=p[0][0],w=p[0][1];c[g++]=r;c[g++]=w;for(var t=0,q=1;q<p.length;++q){var v=
r,b=w,r=p[q][0],w=p[q][1],t=t+(w*v-r*b);c[g++]=r;c[g++]=w}m(t/2);0<t?(0<h-k&&(l(k,h,c,d),k=h),d.length=0):0>t?0<h-k?d.push(.5*(h-k)):g=h:g=h}0<g-k&&l(k,g,c,d)}})},"esri/views/layers/FeatureLayerView":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/assignHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../core/Error ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/SetUtils ../../core/watchUtils ../../core/accessorSupport/decorators ../../layers/support/fieldUtils ../../layers/support/timeUtils ../../support/arcadeOnDemand ../../tasks/support/Query ./support/FeatureEffect ./support/FeatureFilter ./support/popupUtils".split(" "),
function(A,a,t,m,q,r,l,c,d,k,g,e,p,h,C,w,J,x,v,b,y){Object.defineProperty(a,"__esModule",{value:!0});var ga=d.getLogger("esri.views.layers.FeatureLayerView");a.FeatureLayerView=function(a){return function(a){function d(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];b=a.apply(this,b)||this;b._updatingRequiredFieldsPromise=null;b.effect=null;b.filter=null;b.layer=null;b.requiredFields=null;b.view=null;return b}t(d,a);d.prototype.initialize=function(){var b=this;p.init(this,"layer.renderer layer.labelingInfo layer.elevationInfo.featureExpressionInfo layer.displayField filter effect layer.timeInfo timeExtent".split(" "),
function(){return b._handleRequiredFieldsChange()},!0)};Object.defineProperty(d.prototype,"availableFields",{get:function(){var b=this.layer,a=this.layer.fields,c=this.requiredFields;return"outFields"in b&&b.outFields?C.fixFields(a,C.unpackFieldNames(a,b.outFields).concat(c)):C.fixFields(a,c)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"maximumNumberOfFeatures",{get:function(){return 0},set:function(b){ga.error("#maximumNumberOfFeatures\x3d","Setting maximum number of features is not supported")},
enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"maximumNumberOfFeaturesExceeded",{get:function(){return!1},enumerable:!0,configurable:!0});d.prototype.highlight=function(b,a){void 0===a&&(a={});return this.inherited(arguments,[b,a])};d.prototype.createQuery=function(){var b={outFields:["*"],returnGeometry:!0,outSpatialReference:this.view.spatialReference},b=k.isSome(this.filter)?this.filter.createQuery(b):new x(b);this.timeExtent&&(b.timeExtent=b.timeExtent?b.timeExtent.intersection(this.timeExtent):
this.timeExtent.clone());return b};d.prototype.queryFeatures=function(b,a){return this.inherited(arguments,[b,a])};d.prototype.queryObjectIds=function(b,a){return this.inherited(arguments,[b,a])};d.prototype.queryFeatureCount=function(b,a){return this.inherited(arguments,[b,a])};d.prototype.queryExtent=function(b,a){return this.inherited(arguments,[b,a])};d.prototype._loadArcadeModules=function(b){if(b.get("expressionInfos.length"))return J.loadArcade()};d.prototype._handleRequiredFieldsChange=function(){var b=
this,a=this._updateRequiredFields();this._set("_updatingRequiredFieldsPromise",a);a.then(function(){b._updatingRequiredFieldsPromise===a&&b._set("_updatingRequiredFieldsPromise",null)})};d.prototype._updateRequiredFields=function(){return l(this,void 0,void 0,function(){var b,a,c,d,h,l,p,w,m,t,v,q,x,y;return r(this,function(r){switch(r.label){case 0:if(!this.layer||!this.view)return[2];b="3d"===this.view.type;a=this;d=c=a.layer;h=d.fields;l=d.objectIdField;p=d.renderer;w=d.displayField;m=new Set;
return[4,g.eachAlways([p?p.collectRequiredFields(m,h):null,C.collectLabelingFields(m,c),b?C.collectElevationFields(m,c):null,k.isSome(this.filter)?C.collectFilterFields(m,c,this.filter):null,this.effect?C.collectFilterFields(m,c,this.effect.filter):null])];case 1:t=r.sent();c.timeInfo&&this.timeExtent&&C.collectFields(m,c.fields,[c.timeInfo.startField,c.timeInfo.endField]);v=0;for(q=t;v<q.length;v++)x=q[v],x.error&&ga.error(x.error);C.collectField(m,h,l);b&&w&&C.collectField(m,h,w);y=e.valuesOfSet(m).sort();
this._set("requiredFields",y);return[2]}})})};d.prototype.validateFetchPopupFeatures=function(b){var a=this.layer;if(!this.layer.popupEnabled)return new c("featurelayerview:fetchPopupFeatures","Popups are disabled",{layer:a});if(!y.getFetchPopupTemplate(this.layer,b))return new c("featurelayerview:fetchPopupFeatures","Layer does not define a popup template",{layer:a})};d.prototype.fetchClientPopupFeatures=function(b){return l(this,void 0,void 0,function(){var a,c,d,e,h,l,m,p,w,v,t,q;return r(this,
function(r){switch(r.label){case 0:a=k.isSome(b)?b.clientGraphics:null;if(!a||0===a.length)return[2,g.resolve([])];c=[];d=[];e=this.layer;h=y.getFetchPopupTemplate(e,b);return k.isSome(h)?[4,this._loadArcadeModules(h)]:[2,g.resolve([])];case 1:return m=(l=r.sent())&&l.arcadeUtils.hasGeometryOperations(h),[4,this.createPopupQuery(b)];case 2:p=r.sent();w=C.unpackFieldNames(e.fields,p.outFields);v=0;for(t=a;v<t.length;v++)q=t[v],m||!C.featureHasFields(w,q)?d.push(q):c.push(q);if("stream"===e.type||0===
d.length)return[2,g.resolve(c)];p.objectIds=d.map(function(b){return b.attributes[e.objectIdField]});return[2,e.queryFeatures(p).then(function(b){return c.concat(b.features)}).catch(function(){return d})]}})})};d.prototype.createPopupQuery=function(b){return l(this,void 0,void 0,function(){var a,c,d;return r(this,function(e){switch(e.label){case 0:return a=this.layer,c=a.createQuery(),c.returnGeometry=!0,c.returnZ=!0,c.returnM=!0,d=c,[4,y.getRequiredFields(this.layer,y.getFetchPopupTemplate(this.layer,
b))];case 1:return d.outFields=e.sent(),c.outSpatialReference=this.view.spatialReference,[2,c]}})})};m([h.property()],d.prototype,"_updatingRequiredFieldsPromise",void 0);m([h.property({readOnly:!0,dependsOn:["layer.outFields?","requiredFields"]})],d.prototype,"availableFields",null);m([h.property({type:v})],d.prototype,"effect",void 0);m([h.property({type:b})],d.prototype,"filter",void 0);m([h.property(w.combinedViewLayerTimeExtentProperty)],d.prototype,"timeExtent",void 0);m([h.property()],d.prototype,
"layer",void 0);m([h.property({type:Number})],d.prototype,"maximumNumberOfFeatures",null);m([h.property({readOnly:!0,type:Boolean})],d.prototype,"maximumNumberOfFeaturesExceeded",null);m([h.property({readOnly:!0})],d.prototype,"requiredFields",void 0);m([h.property()],d.prototype,"view",void 0);return d=m([h.subclass("esri.views.layers.FeatureLayerView")],d)}(h.declared(a))}})},"esri/views/layers/support/FeatureEffect":function(){define("require exports ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/JSONSupport ../../../core/Logger ../../../core/maybe ../../../core/accessorSupport/decorators ./FeatureFilter ./ParsedFeatureEffect ./Transition".split(" "),
function(A,a,t,m,q,r,l,c,d,k,g){var e=r.getLogger("esri.views.layers.support.FeatureEffect");return function(a){function h(){var c=null!==a&&a.apply(this,arguments)||this;c.filter=null;c.includedEffect=null;c.excludedEffect=null;c.excludedLabelsVisible=!1;return c}m(h,a);p=h;Object.defineProperty(h.prototype,"insideEffect",{get:function(){e.warn("insideEffect is a temporary interface that will be removed. Use includedEffect instead");return this.includedEffect},set:function(a){e.warn("insideEffect is a temporary interface that will be removed. Use includedEffect instead");
this.includedEffect=a},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"outsideEffect",{get:function(){e.warn("outsideEffect is a temporary interface that will be removed. Use excludedEffect instead");return this.excludedEffect},set:function(a){e.warn("outsideEffect is a temporary interface that will be removed. Use excludedEffect instead");this.excludedEffect=a},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"parsedIncludedEffect",{get:function(){return l.isSome(this.includedEffect)?
"string"===typeof this.includedEffect?k.fromString(this.includedEffect):new g({from:k.fromString(this.includedEffect.from),to:k.fromString(this.includedEffect.to),duration:this.includedEffect.duration}):null},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"parsedExcludedEffect",{get:function(){return l.isSome(this.excludedEffect)?"string"===typeof this.excludedEffect?k.fromString(this.excludedEffect):new g({from:k.fromString(this.excludedEffect.from),to:k.fromString(this.excludedEffect.to),
duration:this.excludedEffect.duration}):null},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"renderingHash",{get:function(){return this.excludedLabelsVisible+"-"+this.includedEffect+"-"+this.excludedEffect},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"done",{get:function(){return(!l.isSome(this.parsedIncludedEffect)||this.parsedIncludedEffect.done)&&(!l.isSome(this.parsedExcludedEffect)||this.parsedExcludedEffect.done)},enumerable:!0,configurable:!0});h.prototype.clone=
function(){return new p({filter:this.filter&&this.filter.clone(),includedEffect:this.includedEffect,excludedEffect:this.excludedEffect,excludedLabelsVisible:this.excludedLabelsVisible})};var p;t([c.property({type:d,json:{write:!0}})],h.prototype,"filter",void 0);t([c.property({type:String,json:{write:!0}})],h.prototype,"includedEffect",void 0);t([c.property({type:String,json:{write:!0}})],h.prototype,"excludedEffect",void 0);t([c.property({type:Boolean,json:{write:!0}})],h.prototype,"excludedLabelsVisible",
void 0);t([c.property({dependsOn:["includedEffect"]})],h.prototype,"parsedIncludedEffect",null);t([c.property({dependsOn:["excludedEffect"]})],h.prototype,"parsedExcludedEffect",null);t([c.property({dependsOn:["includedEffect","excludedEffect"]})],h.prototype,"renderingHash",null);return h=p=t([c.subclass("esri.views.layers.support.FeatureEffect")],h)}(c.declared(q.JSONSupport))})},"esri/views/layers/support/FeatureFilter":function(){define("require exports ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/assignHelper ../../../geometry ../../../TimeExtent ../../../core/jsonMap ../../../core/JSONSupport ../../../core/lang ../../../core/SetUtils ../../../core/accessorSupport/decorators ../../../geometry/support/jsonUtils ../../../tasks/support/Query".split(" "),
function(A,a,t,m,q,r,l,c,d,k,g,e,p,h){var C=new c.default({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),w=new c.default({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",
esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});return function(a){function c(b){b=a.call(this,b)||this;b.where=null;b.geometry=null;b.spatialRelationship="intersects";b.hiddenIds=new Set;b.distance=void 0;b.objectIds=null;b.units=null;b.timeExtent=null;b.enabled=!1;return b}m(c,a);d=c;c.prototype.writeWhere=function(b,a){a.where=b||"1\x3d1"};c.prototype.enable=function(){this._set("enabled",!0)};c.prototype.createQuery=
function(b){void 0===b&&(b={});var a=this.where,c=this.spatialRelationship,d=this.timeExtent,e=this.objectIds,g=this.units,l=this.distance;return new h(q({geometry:k.clone(this.geometry),objectIds:k.clone(e),spatialRelationship:c,timeExtent:k.clone(d),where:a,units:g,distance:l},b))};c.prototype.clone=function(){var b=this.where,a=this.geometry,c=this.spatialRelationship,e=this.hiddenIds,h=this.timeExtent,g=this.objectIds,l=this.units,p=this.distance,m=new Set;e.forEach(function(b){return m.add(b)});
return new d({geometry:k.clone(a),hiddenIds:m,objectIds:k.clone(g),spatialRelationship:c,timeExtent:k.clone(h),where:b,units:l,distance:p})};var d;t([e.property({type:String})],c.prototype,"where",void 0);t([e.writer("where")],c.prototype,"writeWhere",null);t([e.property({types:r.geometryTypes,json:{read:p.fromJSON,write:!0}})],c.prototype,"geometry",void 0);t([e.property({type:String,json:{read:{source:"spatialRel",reader:C.read},write:{target:"spatialRel",writer:C.write}}})],c.prototype,"spatialRelationship",
void 0);t([e.property({json:{write:function(b,a,c){return a[c]=g.valuesOfSet(b)},read:function(b){return g.createSetFromValues(b)}}})],c.prototype,"hiddenIds",void 0);t([e.property({type:Number,json:{write:{overridePolicy:function(b){return{enabled:0<b}}}}})],c.prototype,"distance",void 0);t([e.property({type:[Number],json:{write:!0}})],c.prototype,"objectIds",void 0);t([e.property({type:String,json:{read:w.read,write:{writer:w.write,overridePolicy:function(b){return{enabled:b&&0<this.distance}}}}})],
c.prototype,"units",void 0);t([e.property({type:l,json:{write:!0}})],c.prototype,"timeExtent",void 0);t([e.property({readOnly:!0})],c.prototype,"enabled",void 0);return c=d=t([e.subclass("esri.views.layers.support.FeatureFilter")],c)}(e.declared(d.JSONSupport))})},"esri/views/layers/support/ParsedFeatureEffect":function(){define("require exports ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/assignHelper ../../../core/Error ../../../core/JSONSupport ../../../core/Logger ../../../core/maybe ../../../core/accessorSupport/decorators ../../../core/libs/gl-matrix-2/mat4 ../../../core/libs/gl-matrix-2/mat4f32 ./cssFilterParser".split(" "),
function(A,a,t,m,q,r,l,c,d,k,g,e,p){var h=c.getLogger("esri.views.layers.support.ParsedFeatureEffect"),C={grayscale:function(a){a=1-a.amount;a=e.mat4f32.fromValues(.2126+.7874*a,.7152-.7152*a,.0722-.0722*a,0,.2126-.2126*a,.7152+.2848*a,.0722-.0722*a,0,.2126-.2126*a,.7152-.7152*a,.0722+.9278*a,0,0,0,0,1);return g.mat4.transpose(a,a)},sepia:function(a){a=1-a.amount;a=e.mat4f32.fromValues(.393+.607*a,.769-.769*a,.189-.189*a,0,.349-.349*a,.686+.314*a,.168-.168*a,0,.272-.272*a,.534-.534*a,.131+.869*a,
0,0,0,0,1);return g.mat4.transpose(a,a)},saturate:function(a){a=a.amount;a=e.mat4f32.fromValues(.213+.787*a,.715-.715*a,.072-.072*a,0,.213-.213*a,.715+.285*a,.072-.072*a,0,.213-.213*a,.715-.715*a,.072+.928*a,0,0,0,0,1);return g.mat4.transpose(a,a)},"hue-rotate":function(a){var c=Math.sin(a.angle*Math.PI/180);a=Math.cos(a.angle*Math.PI/180);c=e.mat4f32.fromValues(.213+.787*a-.213*c,.715-.715*a-.715*c,.072-.072*a+.928*c,0,.213-.213*a+.143*c,.715+.285*a+.14*c,.072-.072*a-.283*c,0,.213-.213*a-.787*c,
.715-.715*a+.715*c,.072+.928*a+.072*c,0,0,0,0,1);return g.mat4.transpose(c,c)},invert:function(a){var c=1-2*a.amount;a=a.amount;c=e.mat4f32.fromValues(c,0,0,a,0,c,0,a,0,0,c,a,0,0,0,1);return g.mat4.transpose(c,c)},brightness:function(a){a=a.amount;a=e.mat4f32.fromValues(a,0,0,0,0,a,0,0,0,0,a,0,0,0,0,1);return g.mat4.transpose(a,a)},contrast:function(a){a=a.amount;a=e.mat4f32.fromValues(a,0,0,.5-.5*a,0,a,0,.5-.5*a,0,0,a,.5-.5*a,0,0,0,1);return g.mat4.transpose(a,a)}};return function(a){function c(){var c=
null!==a&&a.apply(this,arguments)||this;c.customTransforms=null;c.done=!0;return c}m(c,a);l=c;c.fromString=function(a){var b=[],c=null;try{for(var d=0,e=p.parse(a);d<e.length;d++){var g=e[d];"opacity"===g.type?c=g:b.push(g)}}catch(ia){h.error(new r("invalid-type","Encountered an error when parsing css",ia))}return new l({transforms:b,opacity:c})};c.prototype.getOpacity=function(){return d.isSome(this.opacity)?this.opacity.amount:1};c.prototype.getColorMatrix=function(){var a=this;return(this.transforms||
[]).map(function(a){return q({},a)}).reverse().reduce(function(b,c){return g.mat4.multiply(b,b,a._getFactory(c)(c))},e.mat4f32.create())};c.prototype.clone=function(){return new l({transforms:this.transforms&&this.transforms.map(function(a){return q({},a)}),customTransforms:this.customTransforms&&this.customTransforms.map(function(a){return q({},a)})})};c.prototype._getFactory=function(a){var b=C[a.type];if(b)return b;if(this.customTransforms)for(var b=function(b){if(b.type===a.type){b=e.mat4f32.fromValues.apply(e.mat4f32,
b.matrix);var c=g.mat4.transpose(b,b);return{value:function(){return c}}}},c=0,d=this.customTransforms;c<d.length;c++){var k=b(d[c]);if("object"===typeof k)return k.value}h.error("invalid-type","No effect "+a.type+" exists");return function(){return e.mat4f32.create()}};var l;t([k.property()],c.prototype,"opacity",void 0);t([k.property()],c.prototype,"transforms",void 0);t([k.property()],c.prototype,"customTransforms",void 0);return c=l=t([k.subclass("esri.views.layers.support.ParsedFeatureEffect")],
c)}(k.declared(l.JSONSupport))})},"esri/views/layers/support/cssFilterParser":function(){define([],function(){function A(a,t,m,q){this.message=a;this.expected=t;this.found=m;this.location=q;this.name="SyntaxError";"function"===typeof Error.captureStackTrace&&Error.captureStackTrace(this,A)}(function(a,t){function m(){this.constructor=a}m.prototype=t.prototype;a.prototype=new m})(A,Error);A.buildMessage=function(a,t){function m(a){return a.charCodeAt(0).toString(16).toUpperCase()}function q(a){return a.replace(/\\/g,
"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+m(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+m(a)})}function r(a){return a.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+m(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,
function(a){return"\\x"+m(a)})}var l={literal:function(a){return'"'+q(a.text)+'"'},"class":function(a){var c="",k;for(k=0;k<a.parts.length;k++)c+=a.parts[k]instanceof Array?r(a.parts[k][0])+"-"+r(a.parts[k][1]):r(a.parts[k]);return"["+(a.inverted?"^":"")+c+"]"},any:function(a){return"any character"},end:function(a){return"end of input"},other:function(a){return a.description}};return"Expected "+function(a){var c=Array(a.length),k;for(k=0;k<a.length;k++){var g=k,e;e=a[k];e=l[e.type](e);c[g]=e}c.sort();
if(0<c.length){for(a=k=1;k<c.length;k++)c[k-1]!==c[k]&&(c[a]=c[k],a++);c.length=a}switch(c.length){case 1:return c[0];case 2:return c[0]+" or "+c[1];default:return c.slice(0,-1).join(", ")+", or "+c[c.length-1]}}(a)+" but "+(t?'"'+q(t)+'"':"end of input")+" found."};return{SyntaxError:A,parse:function(a,t){function m(a,b){return{type:"literal",text:a,ignoreCase:b}}function q(a,b,c){return{type:"class",parts:a,inverted:b,ignoreCase:c}}function r(a){return{type:"other",description:a}}function l(b){var c=
la[b],d;if(!c){for(d=b-1;!la[d];)d--;c=la[d];for(c={line:c.line,column:c.column};d<b;)10===a.charCodeAt(d)?(c.line++,c.column=1):c.column++,d++;la[b]=c}return c}function c(a,b){var c=l(a),d=l(b);return{start:{offset:a,line:c.line,column:c.column},end:{offset:b,line:d.line,column:d.column}}}function d(a){f<Z||(f>Z&&(Z=f,pa=[]),pa.push(a))}function k(){var c,e;u++;c=f;e=v();e!==b?(a.substr(f,4)===B?(e=B,f+=4):(e=b,0===u&&d(ia)),e!==b?(e=v(),e!==b?(z=c,c=null):(f=c,c=b)):(f=c,c=b)):(f=c,c=b);u--;c===
b&&(e=b,0===u&&d(L));if(c===b)if(c=[],e=g(),e!==b)for(;e!==b;)c.push(e),e=g();else c=b;return c}function g(){var g,k,l,m,r,t,q,y,L;u++;k=f;l=v();l!==b?(a.substr(f,5)===Pa?(m=Pa,f+=5):(m=b,0===u&&d(gb)),m!==b?(r=v(),r!==b?(t=w(),t!==b?(q=v(),q!==b?(41===a.charCodeAt(f)?(y=T,f++):(y=b,0===u&&d(K)),y!==b?(L=v(),L!==b?(z=k,k=l={type:"blur",radius:t}):(f=k,k=b)):(f=k,k=b)):(f=k,k=b)):(f=k,k=b)):(f=k,k=b)):(f=k,k=b)):(f=k,k=b);u--;k===b&&(l=b,0===u&&d(xa));g=k;if(g===b){var B,J,Ea,ga,Z,ka,ha,db;u++;B=f;
J=v();J!==b?(a.substr(f,11)===Qa?(Ea=Qa,f+=11):(Ea=b,0===u&&d(ib)),Ea!==b?(ga=v(),ga!==b?(Z=e(),Z!==b?(ka=v(),ka!==b?(41===a.charCodeAt(f)?(ha=T,f++):(ha=b,0===u&&d(K)),ha!==b?(db=v(),db!==b?(z=B,B=J={type:"brightness",amount:Z}):(f=B,B=b)):(f=B,B=b)):(f=B,B=b)):(f=B,B=b)):(f=B,B=b)):(f=B,B=b)):(f=B,B=b);u--;B===b&&(J=b,0===u&&d(hb));g=B;if(g===b){var M,wa,Da,ia,la,ua,pa,Fa;u++;M=f;wa=v();wa!==b?(a.substr(f,9)===Ra?(Da=Ra,f+=9):(Da=b,0===u&&d(kb)),Da!==b?(ia=v(),ia!==b?(la=e(),la!==b?(ua=v(),ua!==
b?(41===a.charCodeAt(f)?(pa=T,f++):(pa=b,0===u&&d(K)),pa!==b?(Fa=v(),Fa!==b?(z=M,M=wa={type:"contrast",amount:la}):(f=M,M=b)):(f=M,M=b)):(f=M,M=b)):(f=M,M=b)):(f=M,M=b)):(f=M,M=b)):(f=M,M=b);u--;M===b&&(wa=b,0===u&&d(jb));g=M;if(g===b){var F,Ua,nb,Ga,ob,Ha,pb,Ia,ya,Ja,za,Ka,qb,La;u++;F=f;Ua=v();if(Ua!==b)if(a.substr(f,12)===Ta?(nb=Ta,f+=12):(nb=b,0===u&&d(lb)),nb!==b)if(Ga=v(),Ga!==b)if(ob=w(),ob!==b)if(Ha=v(),Ha!==b)if(pb=w(),pb!==b)if(Ia=v(),Ia!==b)if(ya=w(),ya===b&&(ya=null),ya!==b)if(Ja=v(),Ja!==
b){var n,E,I,D,G,H,Y,U,ea,V,fa,W,aa,ba,Aa,va,Ma,rb;n=f;35===a.charCodeAt(f)?(E=Mb,f++):(E=b,0===u&&d(Nb));if(E!==b)if(I=f,D=x(),D!==b?(G=x(),G!==b?I=D=[D,G]:(f=I,I=b)):(f=I,I=b),I!==b)if(D=f,G=x(),G!==b?(H=x(),H!==b?D=G=[G,H]:(f=D,D=b)):(f=D,D=b),D!==b)if(G=f,H=x(),H!==b?(Y=x(),Y!==b?G=H=[H,Y]:(f=G,G=b)):(f=G,G=b),G!==b){z=n;var eb=D,fb=G;n=E=[parseInt(I.join(""),16),parseInt(eb.join(""),16),parseInt(fb.join(""),16)]}else f=n,n=b;else f=n,n=b;else f=n,n=b;else f=n,n=b;if(n===b){n=f;35===a.charCodeAt(f)?
(E=Mb,f++):(E=b,0===u&&d(Nb));if(E!==b)if(I=x(),I!==b)if(D=x(),D!==b)if(G=x(),G!==b){z=n;var Na=D,Oa=G;n=E=[parseInt([I,I].join(""),16),parseInt([Na,Na].join(""),16),parseInt([Oa,Oa].join(""),16)]}else f=n,n=b;else f=n,n=b;else f=n,n=b;else f=n,n=b;if(n===b&&(n=f,a.substr(f,5)===ma?(E=ma,f+=5):(E=b,0===u&&d(Va)),E!==b?(I=v(),I!==b?(D=h(),D!==b?(G=v(),G!==b?(44===a.charCodeAt(f)?(H=ca,f++):(H=b,0===u&&d(da)),H!==b?(Y=v(),Y!==b?(U=h(),U!==b?(ea=v(),ea!==b?(44===a.charCodeAt(f)?(V=ca,f++):(V=b,0===u&&
d(da)),V!==b?(fa=v(),fa!==b?(W=h(),W!==b?(aa=v(),aa!==b?(44===a.charCodeAt(f)?(ba=ca,f++):(ba=b,0===u&&d(da)),ba!==b?(Aa=v(),Aa!==b?(va=e(),va!==b?(Ma=v(),Ma!==b?(41===a.charCodeAt(f)?(rb=T,f++):(rb=b,0===u&&d(K)),rb!==b?(z=n,n=E=[255*D,255*U,255*W,va]):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b),n===b&&(n=f,a.substr(f,5)===ma?(E=ma,f+=5):(E=b,0===u&&d(Va)),
E!==b?(I=v(),I!==b?(D=p(),D!==b?(G=v(),G!==b?(44===a.charCodeAt(f)?(H=ca,f++):(H=b,0===u&&d(da)),H!==b?(Y=v(),Y!==b?(U=p(),U!==b?(ea=v(),ea!==b?(44===a.charCodeAt(f)?(V=ca,f++):(V=b,0===u&&d(da)),V!==b?(fa=v(),fa!==b?(W=p(),W!==b?(44===a.charCodeAt(f)?(aa=ca,f++):(aa=b,0===u&&d(da)),aa!==b?(ba=v(),ba!==b?(Aa=e(),Aa!==b?(41===a.charCodeAt(f)?(va=T,f++):(va=b,0===u&&d(K)),va!==b?(z=n,n=E=[D,U,W,Aa]):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=
n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b),n===b&&(n=f,a.substr(f,5)===ma?(E=ma,f+=5):(E=b,0===u&&d(Va)),E!==b?(I=v(),I!==b?(D=h(),D!==b?(G=v(),G!==b?(44===a.charCodeAt(f)?(H=ca,f++):(H=b,0===u&&d(da)),H!==b?(Y=v(),Y!==b?(U=h(),U!==b?(ea=v(),ea!==b?(44===a.charCodeAt(f)?(V=ca,f++):(V=b,0===u&&d(da)),V!==b?(fa=v(),fa!==b?(W=h(),W!==b?(aa=v(),aa!==b?(41===a.charCodeAt(f)?(ba=T,f++):(ba=b,0===u&&d(K)),ba!==b?(z=n,n=E=[255*D,255*U,255*W,1]):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):
(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b),n===b&&(n=f,a.substr(f,5)===ma?(E=ma,f+=5):(E=b,0===u&&d(Va)),E!==b?(I=v(),I!==b?(D=p(),D!==b?(G=v(),G!==b?(44===a.charCodeAt(f)?(H=ca,f++):(H=b,0===u&&d(da)),H!==b?(Y=v(),Y!==b?(U=p(),U!==b?(ea=v(),ea!==b?(44===a.charCodeAt(f)?(V=ca,f++):(V=b,0===u&&d(da)),V!==b?(fa=v(),fa!==b?(W=p(),W!==b?(41===a.charCodeAt(f)?(aa=T,f++):(aa=b,0===u&&d(K)),aa!==b?(z=n,n=E=[D,U,W,1]):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):
(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b),n===b&&(n=f,a.substr(f,4)===Wa?(E=Wa,f+=4):(E=b,0===u&&d(Ob)),E!==b?(I=v(),I!==b?(D=h(),D!==b?(G=v(),G!==b?(44===a.charCodeAt(f)?(H=ca,f++):(H=b,0===u&&d(da)),H!==b?(Y=v(),Y!==b?(U=h(),U!==b?(ea=v(),ea!==b?(44===a.charCodeAt(f)?(V=ca,f++):(V=b,0===u&&d(da)),V!==b?(fa=v(),fa!==b?(W=h(),W!==b?(aa=v(),aa!==b?(41===a.charCodeAt(f)?(ba=T,f++):(ba=b,0===u&&d(K)),ba!==b?(z=n,n=E=[255*D,255*U,255*W,1]):(f=n,
n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b),n===b&&(n=f,a.substr(f,4)===Wa?(E=Wa,f+=4):(E=b,0===u&&d(Ob)),E!==b?(I=v(),I!==b?(D=p(),D!==b?(G=v(),G!==b?(44===a.charCodeAt(f)?(H=ca,f++):(H=b,0===u&&d(da)),H!==b?(Y=v(),Y!==b?(U=p(),U!==b?(ea=v(),ea!==b?(44===a.charCodeAt(f)?(V=ca,f++):(V=b,0===u&&d(da)),V!==b?(fa=v(),fa!==b?(W=p(),W!==b?(aa=v(),aa!==b?(41===a.charCodeAt(f)?(ba=T,f++):(ba=b,0===u&&d(K)),ba!==
b?(z=n,n=E=[D,U,W,1]):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b),n===b))))))){var Ba,qa,ra;u++;Ba=f;qa=[];Pb.test(a.charAt(f))?(ra=a.charAt(f),f++):(ra=b,0===u&&d(Qb));if(ra!==b)for(;ra!==b;)qa.push(ra),Pb.test(a.charAt(f))?(ra=a.charAt(f),f++):(ra=b,0===u&&d(Qb));else qa=b;if(qa!==b){z=Ba;var sb=a.substring(z,f);if(!qc.has(sb)){var Lb='unknown color "'+sb+'"',Xa=void 0,Xa=void 0!==Xa?Xa:c(z,f);throw new A(Lb,
null,null,Xa);}qa=Rb[sb].concat(1)}Ba=qa;u--;Ba===b&&(qa=b,0===u&&d(rc));n=Ba}}za=n;za===b&&(za=null);za!==b?(Ka=v(),Ka!==b?(41===a.charCodeAt(f)?(qb=T,f++):(qb=b,0===u&&d(K)),qb!==b?(La=v(),La!==b?(z=F,F=Ua={type:"drop-shadow",offsetX:ob,offsetY:pb,blurRadius:ya,color:za}):(f=F,F=b)):(f=F,F=b)):(f=F,F=b)):(f=F,F=b)}else f=F,F=b;else f=F,F=b;else f=F,F=b;else f=F,F=b;else f=F,F=b;else f=F,F=b;else f=F,F=b;else f=F,F=b;else f=F,F=b;u--;F===b&&(Ua=b,0===u&&d(Sa));g=F;if(g===b){var N,Ya,tb,Sb,ub,Tb,
vb,Ub;u++;N=f;Ya=v();Ya!==b?(a.substr(f,10)===na?(tb=na,f+=10):(tb=b,0===u&&d(sc)),tb!==b?(Sb=v(),Sb!==b?(ub=e(),ub!==b?(Tb=v(),Tb!==b?(41===a.charCodeAt(f)?(vb=T,f++):(vb=b,0===u&&d(K)),vb!==b?(Ub=v(),Ub!==b?(z=N,N=Ya={type:"grayscale",amount:ub}):(f=N,N=b)):(f=N,N=b)):(f=N,N=b)):(f=N,N=b)):(f=N,N=b)):(f=N,N=b)):(f=N,N=b);u--;N===b&&(Ya=b,0===u&&d(mb));g=N;if(g===b){var O,Za,wb,Vb,xb,Wb,yb,Xb;u++;O=f;Za=v();if(Za!==b)if(a.substr(f,11)===Ca?(wb=Ca,f+=11):(wb=b,0===u&&d(tc)),wb!==b)if(Vb=v(),Vb!==
b){var X,oa,sa;u++;X=f;var ja,ta,Yb;u++;ja=f;uc.test(a.charAt(f))?(ta=a.charAt(f),f++):(ta=b,0===u&&d(vc));ta===b&&(ta=null);ta!==b?(Yb=p(),Yb!==b?(z=ja,ja=ta=parseFloat(a.substring(z,f))):(f=ja,ja=b)):(f=ja,ja=b);u--;ja===b&&(ta=b,0===u&&d(wc));oa=ja;oa!==b?(sa=C(),sa!==b?(z=X,X=oa*=sa):(f=X,X=b)):(f=X,X=b);X===b&&(X=f,48===a.charCodeAt(f)?(oa=Zb,f++):(oa=b,0===u&&d($b)),oa!==b?(sa=C(),sa===b&&(sa=null),sa!==b?(z=X,X=oa=0):(f=X,X=b)):(f=X,X=b));u--;X===b&&(oa=b,0===u&&d(xc));xb=X;xb!==b?(Wb=v(),
Wb!==b?(41===a.charCodeAt(f)?(yb=T,f++):(yb=b,0===u&&d(K)),yb!==b?(Xb=v(),Xb!==b?(z=O,O=Za={type:"hue-rotate",angle:xb}):(f=O,O=b)):(f=O,O=b)):(f=O,O=b)):(f=O,O=b)}else f=O,O=b;else f=O,O=b;else f=O,O=b;u--;O===b&&(Za=b,0===u&&d(yc));g=O;if(g===b){var P,$a,zb,ac,Ab,bc,Bb,cc;u++;P=f;$a=v();$a!==b?(a.substr(f,7)===dc?(zb=dc,f+=7):(zb=b,0===u&&d(zc)),zb!==b?(ac=v(),ac!==b?(Ab=e(),Ab!==b?(bc=v(),bc!==b?(41===a.charCodeAt(f)?(Bb=T,f++):(Bb=b,0===u&&d(K)),Bb!==b?(cc=v(),cc!==b?(z=P,P=$a={type:"invert",
amount:Ab}):(f=P,P=b)):(f=P,P=b)):(f=P,P=b)):(f=P,P=b)):(f=P,P=b)):(f=P,P=b)):(f=P,P=b);u--;P===b&&($a=b,0===u&&d(Ac));g=P;if(g===b){var Q,ab,Cb,ec,Db,fc,Eb,gc;u++;Q=f;ab=v();ab!==b?(a.substr(f,8)===hc?(Cb=hc,f+=8):(Cb=b,0===u&&d(Bc)),Cb!==b?(ec=v(),ec!==b?(Db=e(),Db!==b?(fc=v(),fc!==b?(41===a.charCodeAt(f)?(Eb=T,f++):(Eb=b,0===u&&d(K)),Eb!==b?(gc=v(),gc!==b?(z=Q,Q=ab={type:"opacity",amount:Db}):(f=Q,Q=b)):(f=Q,Q=b)):(f=Q,Q=b)):(f=Q,Q=b)):(f=Q,Q=b)):(f=Q,Q=b)):(f=Q,Q=b);u--;Q===b&&(ab=b,0===u&&d(Cc));
g=Q;if(g===b){var R,bb,Fb,ic,Gb,jc,Hb,kc;u++;R=f;bb=v();bb!==b?(a.substr(f,9)===lc?(Fb=lc,f+=9):(Fb=b,0===u&&d(Dc)),Fb!==b?(ic=v(),ic!==b?(Gb=e(),Gb!==b?(jc=v(),jc!==b?(41===a.charCodeAt(f)?(Hb=T,f++):(Hb=b,0===u&&d(K)),Hb!==b?(kc=v(),kc!==b?(z=R,R=bb={type:"saturate",amount:Gb}):(f=R,R=b)):(f=R,R=b)):(f=R,R=b)):(f=R,R=b)):(f=R,R=b)):(f=R,R=b)):(f=R,R=b);u--;R===b&&(bb=b,0===u&&d(Ec));g=R;if(g===b){var S,cb,Ib,mc,Jb,nc,Kb,oc;u++;S=f;cb=v();cb!==b?(a.substr(f,6)===pc?(Ib=pc,f+=6):(Ib=b,0===u&&d(Fc)),
Ib!==b?(mc=v(),mc!==b?(Jb=e(),Jb!==b?(nc=v(),nc!==b?(41===a.charCodeAt(f)?(Kb=T,f++):(Kb=b,0===u&&d(K)),Kb!==b?(oc=v(),oc!==b?(z=S,S=cb={type:"sepia",amount:Jb}):(f=S,S=b)):(f=S,S=b)):(f=S,S=b)):(f=S,S=b)):(f=S,S=b)):(f=S,S=b)):(f=S,S=b);u--;S===b&&(cb=b,0===u&&d(Gc));g=S}}}}}}}}}return g}function e(){var a;u++;a=h();a===b&&(a=p());u--;a===b&&0===u&&d(wa);return a}function p(){var c,e,g;u++;c=f;e=[];ka.test(a.charAt(f))?(g=a.charAt(f),f++):(g=b,0===u&&d(ha));if(g!==b)for(;g!==b;)e.push(g),ka.test(a.charAt(f))?
(g=a.charAt(f),f++):(g=b,0===u&&d(ha));else e=b;if(e!==b)if(46===a.charCodeAt(f)?(g=db,f++):(g=b,0===u&&d(Lb)),g!==b){e=[];ka.test(a.charAt(f))?(g=a.charAt(f),f++):(g=b,0===u&&d(ha));if(g!==b)for(;g!==b;)e.push(g),ka.test(a.charAt(f))?(g=a.charAt(f),f++):(g=b,0===u&&d(ha));else e=b;e!==b?(z=c,c=e=parseFloat(a.substring(z,f))):(f=c,c=b)}else f=c,c=b;else f=c,c=b;if(c===b){u++;c=f;e=[];ka.test(a.charAt(f))?(g=a.charAt(f),f++):(g=b,0===u&&d(ha));if(g!==b)for(;g!==b;)e.push(g),ka.test(a.charAt(f))?(g=
a.charAt(f),f++):(g=b,0===u&&d(ha));else e=b;e!==b&&(z=c,e=parseInt(a.substring(z,f),10));c=e;u--;c===b&&(e=b,0===u&&d(Da))}u--;c===b&&(e=b,0===u&&d(Ea));return c}function h(){var c,e,g;c=f;e=p();e!==b?(37===a.charCodeAt(f)?(g=Hc,f++):(g=b,0===u&&d(Ic)),g!==b?(z=c,c=e/100):(f=c,c=b)):(f=c,c=b);return c}function C(){var c,e;u++;c=f;a.substr(f,3)===Fa?(e=Fa,f+=3):(e=b,0===u&&d(Jc));e!==b&&(z=c,e=1);c=e;c===b&&(c=f,a.substr(f,4)===Ga?(e=Ga,f+=4):(e=b,0===u&&d(Kc)),e!==b&&(z=c,e=.9),c=e,c===b&&(c=f,a.substr(f,
3)===Ha?(e=Ha,f+=3):(e=b,0===u&&d(Lc)),e!==b&&(z=c,e=180/Math.PI),c=e,c===b&&(c=f,a.substr(f,4)===Ia?(e=Ia,f+=4):(e=b,0===u&&d(Mc)),e!==b&&(z=c,e=1/360),c=e)));u--;c===b&&(e=b,0===u&&d(Nc));return c}function w(){var c,e,g;u++;c=f;e=p();e!==b?(g=J(),g!==b?(z=c,c=e*g):(f=c,c=b)):(f=c,c=b);c===b&&(c=f,48===a.charCodeAt(f)?(e=Zb,f++):(e=b,0===u&&d($b)),e!==b?(g=J(),g===b&&(g=null),g!==b?(z=c,c=0):(f=c,c=b)):(f=c,c=b));u--;c===b&&(e=b,0===u&&d(Oc));return c}function J(){var c,e;c=f;a.substr(f,2)===Ja?
(e=Ja,f+=2):(e=b,0===u&&d(Pc));e!==b&&(z=c,e=1);c=e;c===b&&(c=f,a.substr(f,2)===Ka?(e=Ka,f+=2):(e=b,0===u&&d(Qc)),e!==b&&(z=c,e=96/2.54),c=e,c===b&&(c=f,a.substr(f,2)===La?(e=La,f+=2):(e=b,0===u&&d(Rc)),e!==b&&(z=c,e=96/2.54/10),c=e,c===b&&(c=f,81===a.charCodeAt(f)?(e=Sc,f++):(e=b,0===u&&d(Tc)),e!==b&&(z=c,e=96/2.54/40),c=e,c===b&&(c=f,a.substr(f,2)===Ma?(e=Ma,f+=2):(e=b,0===u&&d(Uc)),e!==b&&(z=c,e=96),c=e,c===b&&(c=f,a.substr(f,2)===eb?(e=eb,f+=2):(e=b,0===u&&d(Vc)),e!==b&&(z=c,e=16),c=e,c===b&&
(c=f,a.substr(f,2)===fb?(e=fb,f+=2):(e=b,0===u&&d(Wc)),e!==b&&(z=c,e=96/73),c=e))))));return c}function x(){var c;Xc.test(a.charAt(f))?(c=a.charAt(f),f++):(c=b,0===u&&d(Yc));return c}function v(){var c,e;u++;c=[];Na.test(a.charAt(f))?(e=a.charAt(f),f++):(e=b,0===u&&d(Oa));for(;e!==b;)c.push(e),Na.test(a.charAt(f))?(e=a.charAt(f),f++):(e=b,0===u&&d(Oa));u--;c===b&&(e=b,0===u&&d(Zc));return c}t=void 0!==t?t:{};var b={},y={start:k},ga=k,L=r("none"),B="none",ia=m("none",!1),xa=r("blur()"),Pa="blur(",
gb=m("blur(",!1),T=")",K=m(")",!1),hb=r("brightness()"),Qa="brightness(",ib=m("brightness(",!1),jb=r("contrast()"),Ra="contrast(",kb=m("contrast(",!1),Sa=r("drop-shadow()"),Ta="drop-shadow(",lb=m("drop-shadow(",!1),mb=r("grayscale()"),na="grayscale(",sc=m("grayscale(",!1),yc=r("hue-rotate()"),Ca="hue-rotate(",tc=m("hue-rotate(",!1),Ac=r("invert()"),dc="invert(",zc=m("invert(",!1),Cc=r("opacity()"),hc="opacity(",Bc=m("opacity(",!1),Ec=r("saturate()"),lc="saturate(",Dc=m("saturate(",!1),Gc=r("sepia()"),
pc="sepia(",Fc=m("sepia(",!1),wa=r("\x3cnumber-percentage\x3e"),Da=r("\x3cinteger\x3e"),ka=/^[0-9]/,ha=q([["0","9"]],!1,!1),Ea=r("\x3cnumber\x3e"),db=".",Lb=m(".",!1),wc=r("\x3csignedNumber\x3e"),uc=/^[+\-]/,vc=q(["+","-"],!1,!1),Hc="%",Ic=m("%",!1),xc=r("\x3cangle\x3e"),Zb="0",$b=m("0",!1),Nc=r("\x3cunit\x3e"),Fa="deg",Jc=m("deg",!1),Ga="grad",Kc=m("grad",!1),Ha="rad",Lc=m("rad",!1),Ia="turn",Mc=m("turn",!1),Oc=r("\x3clength\x3e"),Ja="px",Pc=m("px",!1),Ka="cm",Qc=m("cm",!1),La="mm",Rc=m("mm",!1),
Sc="Q",Tc=m("Q",!1),Ma="in",Uc=m("in",!1),eb="pc",Vc=m("pc",!1),fb="pt",Wc=m("pt",!1),Mb="#",Nb=m("#",!1),ma="rgba(",Va=m("rgba(",!1),ca=",",da=m(",",!1),Wa="rgb(",Ob=m("rgb(",!1),Xc=/^[0-9a-fA-F]/,Yc=q([["0","9"],["a","f"],["A","F"]],!1,!1),Zc=r("whitespace"),Na=/^[ \t\n\r]/,Oa=q([" ","\t","\n","\r"],!1,!1),rc=r("\x3cnamed-color\x3e"),Pb=/^[a-z]/,Qb=q([["a","z"]],!1,!1),f=0,z=0,la=[{line:1,column:1}],Z=0,pa=[],u=0,ua;if("startRule"in t){if(!(t.startRule in y))throw Error("Can't start parsing from rule \""+
t.startRule+'".');ga=y[t.startRule]}var Rb={transparent:[0,0,0,0],black:[0,0,0],silver:[192,192,192],gray:[128,128,128],white:[255,255,255],maroon:[128,0,0],red:[255,0,0],purple:[128,0,128],fuchsia:[255,0,255],green:[0,128,0],lime:[0,255,0],olive:[128,128,0],yellow:[255,255,0],navy:[0,0,128],blue:[0,0,255],teal:[0,128,128],aqua:[0,255,255],aliceblue:[240,248,255],antiquewhite:[250,235,215],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],blanchedalmond:[255,235,
205],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],
darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],greenyellow:[173,255,47],grey:[128,
128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,
206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,
225],moccasin:[255,228,181],navajowhite:[255,222,173],oldlace:[253,245,230],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],rebeccapurple:[102,51,153],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,
128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],whitesmoke:[245,245,245],yellowgreen:[154,205,50]},qc=new Set(Object.keys(Rb));ua=ga();if(ua!==b&&f===a.length)return ua;ua!==
b&&f<a.length&&d({type:"end"});throw function(a,b,c){return new A(A.buildMessage(a,b),a,b,c)}(pa,Z<a.length?a.charAt(Z):null,Z<a.length?c(Z,Z+1):c(Z,Z));}}})},"esri/views/layers/support/Transition":function(){define("require exports ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/Accessor ../../../core/accessorSupport/decorators ../../../core/libs/gl-matrix-2/mat4".split(" "),function(A,a,t,m,q,r,l){return function(a){function c(){var c=null!==a&&
a.apply(this,arguments)||this;c.from=null;c.to=null;c.duration=4E3;c.repeat=!0;c.done=!1;return c}m(c,a);k=c;c.prototype.getColorMatrix=function(){this.done=!1;if(null==this._lastTime)this._currentStep=0,this._lastTime=Date.now();else{var a=this._lastTime,c=Date.now();this._currentStep+=c-a;2147483647<=this._currentStep&&(this._currentStep=0);this._lastTime=c}var a=this._currentStep%this.duration/(this.duration/2),a=1>=a?a:2-a,c=this.from.getColorMatrix(),d=this.to.getColorMatrix();l.mat4.multiplyScalar(c,
c,1-a);l.mat4.multiplyScalar(d,d,a);!this.repeat&&this._currentStep>=this.duration&&(this.done=!0);return l.mat4.add(c,c,d)};c.prototype.getOpacity=function(){throw Error("No getOpacity definition for Transition");};c.prototype.clone=function(){var a=new k({from:this.from.clone(),to:this.to.clone(),duration:this.duration});a._lastTime=this._lastTime;a._currentStep=this._currentStep;return a};var k;t([r.property()],c.prototype,"from",void 0);t([r.property()],c.prototype,"to",void 0);t([r.property({type:Number})],
c.prototype,"duration",void 0);t([r.property({type:Boolean})],c.prototype,"repeat",void 0);return c=k=t([r.subclass("esri.views.layers.support.Transition")],c)}(r.declared(q))})},"esri/views/layers/support/popupUtils":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper @dojo/framework/shim/array ../../../core/maybe ../../../layers/support/fieldUtils".split(" "),function(A,a,t,m,q,r,l){Object.defineProperty(a,"__esModule",{value:!0});a.getRequiredFields=
function(a,d){void 0===d&&(d=a.popupTemplate);return m(this,void 0,void 0,function(){var c,g,e,m,h,C,w,A,x,v,b,y;return t(this,function(k){switch(k.label){case 0:return r.isSome(d)?[4,d.getRequiredFields(a.fields)]:[2,[]];case 1:c=k.sent();g=d.lastEditInfoEnabled;e=a.objectIdField;m=a.typeIdField;h=a.globalIdField;C=a.relationships;if(q.includes(c,"*"))return[2,["*"]];A=l.fixFields;x=[a.fields];b=(v=c).concat;return(y=g)?[4,l.getFeatureEditFields(a)]:[3,3];case 2:y=k.sent(),k.label=3;case 3:return w=
A.apply(void 0,x.concat([b.apply(v,[y||null])])),m&&w.push(m),w&&e&&l.hasField(a.fields,e)&&-1===w.indexOf(e)&&w.push(e),w&&h&&l.hasField(a.fields,h)&&-1===w.indexOf(h)&&w.push(h),C&&C.forEach(function(c){c=c.keyField;w&&c&&l.hasField(a.fields,c)&&-1===w.indexOf(c)&&w.push(c)}),[2,w]}})})};a.getFetchPopupTemplate=function(a,d){return a.popupTemplate?a.popupTemplate:r.isSome(d)&&d.defaultPopupTemplateEnabled&&r.isSome(a.defaultPopupTemplate)?a.defaultPopupTemplate:null}})},"esri/views/support/drapedUtils":function(){define("require exports ../../geometry ../../core/maybe ../../core/unitUtils ../../renderers/support/clickToleranceUtils".split(" "),
function(A,a,t,m,q,r){function l(a,c,g,e){void 0===e&&(e=new t.Extent);var d;if("2d"===g.type)d=c*g.resolution;else if("3d"===g.type){var h=g.basemapTerrain,k=h.overlayManager,k=k?k.overlayPixelSizeInMapUnits(a):1;d=h&&!h.spatialReference.equals(g.spatialReference)?q.getMetersPerUnitForSR(h.spatialReference)/q.getMetersPerUnitForSR(g.spatialReference):c*k}c=a.x-d;h=a.y-d;k=a.x+d;a=a.y+d;g=g.spatialReference;e.xmin=Math.min(c,k);e.ymin=Math.min(h,a);e.xmax=Math.max(c,k);e.ymax=Math.max(h,a);e.spatialReference=
g;return e}Object.defineProperty(a,"__esModule",{value:!0});a.createQueryGeometry=l;a.intersectsDrapedGeometry=function(a,k,g){a=g.toMap(a);if(m.isNone(a))return null;var d=r.calculateTolerance();return l(a,d,g,c).intersects(k)?a:null};var c=new t.Extent})},"*noref":1}});
define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/paramHelper ../../../core/tsSupport/assignHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../AggregateGraphic ../../../geometry ../../../Graphic ../../../core/arrayUtils ../../../core/Collection ../../../core/Error ../../../core/has ../../../core/Logger ../../../core/MapUtils ../../../core/maybe ../../../core/promiseUtils ../../../core/watchUtils ../../../core/accessorSupport/decorators ../../../layers/graphics/data/projectionSupport ../../../renderers/support/clickToleranceUtils ../../../tasks/support/FeatureSet ../../../tasks/support/Query ../engine ./LayerView2D ./features/tileRenderers ./features/support/rendererUtils ./support/clusterUtils ./support/FeatureLayerProxy ./support/util ../tiling/TileStrategy ../../layers/FeatureLayerView ../../layers/LayerView ../../layers/RefreshableLayerView ../../../views/layers/support/FeatureFilter ../../layers/support/FeatureEffect ../../support/drapedUtils".split(" "),function(A,
a,t,m,q,r,l,c,d,k,g,e,p,h,C,w,J,x,v,b,y,ga,L,B,ia,xa,Pa,gb,T,K,hb,Qa,ib,jb,Ra,kb,Sa,Ta,lb){function mb(a){return a&&"openPorts"in a}var na=w.getLogger("esri.views.2d.layers.FeatureLayerView2D");return function(a){function q(){var b=null!==a&&a.apply(this,arguments)||this;b._pipelineIsUpdating=!0;b._updatingPipelineConfig=!1;b._viewStateId=-1;b._visibilityOverrides=new Set;b._effect=null;b._highlightIds=new Map;b._onGoingEdits=0;b.container=new xa.Container;b.filter=null;b.doRefresh=v.debounce(function(){b._onGoingEdits=
0;return b._proxy.refresh().catch(function(a){v.isAbortError(a)||na.error(a)})});b._onRenderingConfigChange=v.debounce(function(){return c(b,void 0,void 0,function(){var a,b,c,d,e,g,h,k,m,q,p,r,Ca,t,v,w,y;return l(this,function(l){switch(l.label){case 0:if(!this._hasRequiredSupport(this.layer))return[2];this._set("_updatingPipelineConfig",!0);return[4,this._effectiveRendererPromise];case 1:return a=l.sent(),b=a.renderer,c=a.aggregateFields,d=a.featureReduction,[4,this._updateRequiredFields()];case 2:return l.sent(),
e=this.availableFields.join("."),g=this._createLayerFilterHash(),h=this._createTileRendererHash(b),k=this._createFeatureDataHash(b),m=this._createMeshHash(b),q=e!==this._clientDataHash,p=g!==this._layerFilterHash,Ca=(r=k!==this._featureDataHash||q)&&!!this.layer.featureReduction,t=m!==this._meshHash||Ca,v={invalidateFeatureData:r,invalidateMesh:t,layerFilterChanged:p},w=this._createConfiguration(b,c,d),h===this._tileRendererHash?[3,9]:[4,this._initTileRenderer(b)];case 3:return l.sent(),[4,this._createServiceOptions()];
case 4:return y=l.sent(),this.effects.forEach(function(a){return x.isSome(a)&&x.isSome(a.filter)&&a.filter.enable()}),this.tileRenderer.onConfigUpdate(b),[4,this._proxy.startup(this.view.featuresTilingScheme,w,y,v)];case 5:return l.sent(),this.hasHighlight()?[4,this._proxy.setHighlight(J.keysOfMap(this._highlightIds))]:[3,7];case 6:l.sent(),l.label=7;case 7:return[4,this._onceTilesUpdated()];case 8:return l.sent(),this.tileRenderer.onConfigUpdate(b),[3,14];case 9:return this._lockAttributeTextureUpload(),
q||p||r||t?[4,this._proxy.update(w,v)]:[3,11];case 10:l.sent(),l.label=11;case 11:return p?[4,this._onceTilesUpdated()]:[3,13];case 12:l.sent(),l.label=13;case 13:this._unlockAttributeTextureUpload(),this.effects.forEach(function(a){return x.isSome(a)&&x.isSome(a.filter)&&a.filter.enable()}),this.tileRenderer.onConfigUpdate(b),this._forceAttributeTextureUpload(),l.label=14;case 14:return this._clientDataHash=e,this._layerFilterHash=g,this._tileRendererHash=h,this._meshHash=m,this._featureDataHash=
k,this.tileRenderer.invalidateLabels(),this.requestUpdate(),[2]}})})});b._updateHighlight=v.debounce(function(){return c(b,void 0,void 0,function(){return l(this,function(a){return[2,this._proxy.setHighlight(J.keysOfMap(this._highlightIds))]})})});return b}t(q,a);q.prototype.destroy=function(){this._proxy.destroy();x.andThen(this._updateClusterSizeTask,function(a){return a.remove()})};q.prototype.initialize=function(){var a=this;this.addResolvingPromise(this._initProxy());this.handles.add([this.clips.on("change",
function(){return a.tileRenderer&&a.tileRenderer.onConfigUpdate(a._effectiveRenderer)}),this.on("valueRangesChanged",function(b){a._set("_aggregateValueRanges",b.valueRanges)})])};q.prototype._initProxy=function(){return c(this,void 0,void 0,function(){var a,b,c;return l(this,function(d){if("stream"!==this.layer.type&&this.layer.isTable)throw new h("featurelayerview:table-not-supported","table feature layer can't be displayed",{layer:this.layer});a=this.layer.spatialReference;b=k.SpatialReference.WGS84;
if(this.layer.featureReduction&&!ga.doesBrowserSupportProjection(a,b))throw new h("featurelayerview:featureReduction-not-supported","cannot project feature layer to WGS84",{inSpatialReference:a,outSpatialReference:b});this._proxy&&this._proxy.destroy();c=this._createClientOptions();this._set("_proxy",new hb.default({client:c}));return[2,this._proxy.when()]})})};Object.defineProperty(q.prototype,"_effectiveRendererPromise",{get:function(){var a=this,b=this._getEffectiveRenderer();b.then(function(b){return a._set("_effectiveRenderer",
b.renderer)});return b},enumerable:!0,configurable:!0});Object.defineProperty(q.prototype,"labelsVisible",{get:function(){return!this.suspended&&this.layer.labelingInfo&&this.layer.labelsVisible},enumerable:!0,configurable:!0});Object.defineProperty(q.prototype,"effect",{get:function(){return x.unwrapOr(this._effect,null)},set:function(a){var b=this._effect;x.isSome(b)&&x.isSome(b.filter)&&b.filter.enabled&&x.isSome(a)&&x.isSome(a.filter)&&a.filter.enable();this._effect=a;this.notifyChange("effect")},
enumerable:!0,configurable:!0});Object.defineProperty(q.prototype,"effects",{get:function(){return this.effect&&[this.effect]||[]},enumerable:!0,configurable:!0});Object.defineProperty(q.prototype,"numFeatures",{get:function(){var a=0;this.attached&&this._tileStrategy.tiles.forEach(function(b){a+=b.iconDisplayRecords?b.iconDisplayRecords.length:0});return a},enumerable:!0,configurable:!0});Object.defineProperty(q.prototype,"renderingConfigHash",{get:function(){if(!this.layer)return null;var a=this.availableFields,
b=this.layer,c=b.definitionExpression,d=b.renderer,e=b.labelingInfo,g="feature"===b.type?b.gdbVersion:void 0,h="feature"===b.type&&b.historicMoment?b.historicMoment.getTime():void 0,k=this.timeExtent,l="stream"===b.type?""+JSON.stringify(b.geometryDefinition)+b.definitionExpression:null,m=JSON.stringify(this.clips),b=b.featureReduction&&b.featureReduction.toJSON();return JSON.stringify({filterHash:x.isSome(this.filter)&&this.filter.toJSON(),effectHash:x.isSome(this.effect)&&this.effect.toJSON(),streamFilter:l,
gdbVersion:g,definitionExpression:c,historicMoment:h,availableFields:a,renderer:d,labelingInfo:e,timeExtent:k,clipsHash:m,featureReduction:b})},enumerable:!0,configurable:!0});q.prototype.highlight=function(a){var b=this,c;a instanceof g?c=[a.getObjectId()]:"number"===typeof a?c=[a]:p.isCollection(a)?c=a.map(function(a){return a&&a.getAttribute(b.layer.objectIdField)}).toArray():Array.isArray(a)&&0<a.length&&(c="number"===typeof a[0]?a:a.map(function(a){return a&&a.getAttribute(b.layer.objectIdField)}));
if(!c||!c.length)return{remove:function(){},pause:function(){},resume:function(){}};c=c.filter(function(a){return null!=a});this._addHighlight(c);return{remove:function(){return b._removeHighlight(c)},pause:function(){return b._removeHighlight(c)},resume:function(){return b._addHighlight(c)}}};q.prototype.hasHighlight=function(){return!!this._highlightIds.size};q.prototype.hitTest=function(a,b){return this._hitTest(a,b)};q.prototype.queryStatistics=function(){return this._proxy.queryStatistics()};
q.prototype.queryFeatures=function(a,b){var c=this;return this.queryFeaturesJSON(a,b).then(function(a){a=B.fromJSON(a);a.features.forEach(function(a){a.layer=c.layer;a.sourceLayer=c.layer});return a})};q.prototype.queryFeaturesJSON=function(a,b){return this._proxy.queryFeatures(this._cleanUpQuery(a),b)};q.prototype.queryObjectIds=function(a,b){return this._proxy.queryObjectIds(this._cleanUpQuery(a),b)};q.prototype.queryFeatureCount=function(a,b){return this._proxy.queryFeatureCount(this._cleanUpQuery(a),
b)};q.prototype.queryExtent=function(a,b){return this._proxy.queryExtent(this._cleanUpQuery(a),b).then(function(a){return{count:a.count,extent:k.Extent.fromJSON(a.extent)}})};q.prototype.setVisibility=function(a,b){b?this._visibilityOverrides.delete(a):this._visibilityOverrides.add(a);this._renderingConfigHashChanged()};q.prototype.update=function(a){this.attached&&this._tileStrategy&&this.tileRenderer&&(this._tileStrategy.update(a)||this.requestUpdate(),a=a.state,this._viewStateId!==a.id&&(this._proxy.setViewState(a),
this._viewStateId=a.id),this.notifyChange("numFeatures"),this.notifyChange("updating"))};q.prototype.attach=function(){var a=this;this.view.timeline.record(this.layer.title+" (FeatureLayer) Attach");this._tileStrategy=new ib({cachePolicy:"purge",acquireTile:function(b){return a._acquireTile(b)},releaseTile:function(b){return a._releaseTile(b)},tileInfoView:this.view.featuresTilingScheme,buffer:0});this.handles.add(b.init(this,"renderingConfigHash",function(){return a._renderingConfigHashChanged()},
!0),"attach");"stream"!==this.layer.type&&this.handles.add(this.layer.on("edits",function(b){return c(a,void 0,void 0,function(){return l(this,function(a){switch(a.label){case 0:return this._onGoingEdits++,[4,this._proxy.onEdits(b)];case 1:return a.sent(),this._onGoingEdits=Math.max(0,this._onGoingEdits-1),[2]}})})}),"attach")};q.prototype.detach=function(){this.container.removeAllChildren();this.handles.remove("attach");this._updatingPipelineConfig=!1;this.tileRenderer&&(this.tileRenderer.uninstall(this.container),
this.tileRenderer=null);this._tileStrategy&&(this._tileStrategy.destroy(),this._tileStrategy=null)};q.prototype.moveStart=function(){this.requestUpdate()};q.prototype.viewChange=function(){this.requestUpdate()};q.prototype.moveEnd=function(){this.requestUpdate()};q.prototype.fetchPopupFeatures=function(a,b){return c(this,void 0,void 0,function(){var c,g,h,k;return l(this,function(l){if(x.isSome(b)&&b.clientGraphics.length&&(c=b.clientGraphics[0],c instanceof d))return[2,[c]];if(g=this.validateFetchPopupFeatures(b))return[2,
v.reject(g)];if(x.isSome(b)&&0===b.clientGraphics.length)return[2,v.resolve([])];h=this.fetchClientPopupFeatures(b);if(!a)return[2,h];k=this._fetchServicePopupFeatures(a,b);return[2,v.eachAlwaysValues([h,k]).then(e.flatten)]})})};q.prototype._fetchServicePopupFeatures=function(a,b){return c(this,void 0,void 0,function(){var c,d,e,g,h,k,m,q,p,r,t;return l(this,function(l){switch(l.label){case 0:return"stream"===this.layer.type?[2,[]]:[4,this.createPopupQuery(b)];case 1:c=l.sent();d=this.layer;e=d.renderer;
g=x.isSome(b)?b.event:null;h=L.calculateTolerance({renderer:e,event:g});c.geometry=this.createFetchPopupFeaturesQueryGeometry(a,h);k=new Set;m=d.objectIdField;if(q=x.isSome(b)?b.clientGraphics:null)for(p=0,r=q;p<r.length;p++)t=r[p],k.add(t.attributes[m]);return[2,d.queryFeatures(c).then(function(a){return a.features.filter(function(a){return!k.has(a.attributes[m])})})]}})})};q.prototype.createFetchPopupFeaturesQueryGeometry=function(a,b){return lb.createQueryGeometry(a,b,this.view)};q.prototype.isUpdating=
function(){return null!=this.layer.renderer&&(null!=this._updatingRequiredFieldsPromise||null==this.tileRenderer||!this._proxy||!this._proxy.isReady||this._pipelineIsUpdating||this._updatingPipelineConfig||this.tileRenderer.updating||0<this._onGoingEdits)};q.prototype._createClientOptions=function(){var a=this;return{setUpdating:function(b){a._set("_pipelineIsUpdating",b)},emitEvent:function(b){a.emit(b.name,b.event)}}};q.prototype._createServiceOptions=function(){return c(this,void 0,void 0,function(){var a,
b,c,d,e,g,h,k,m,p;return l(this,function(l){switch(l.label){case 0:a=this.layer;if("stream"===a.type)return[2,null];b=a.capabilities;c=a.objectIdField;d=a.fields.map(function(a){return a.toJSON()});e=a.fullExtent&&a.fullExtent.toJSON();g=Qa.toJSONGeometryType(a.geometryType);h=a.timeInfo&&a.timeInfo.toJSON()||null;k=a.spatialReference?a.spatialReference.toJSON():null;return mb(a.source)?[4,a.source.openPorts()]:[3,2];case 1:return p=l.sent(),[3,3];case 2:p="dynamicDataSource"in a?a.dynamicDataSource?
a.parsedUrl:a.url+"/"+a.layerId:a.parsedUrl,l.label=3;case 3:return m=p,[2,{type:"on-demand",maxRecordCount:b.query.maxRecordCount,tileMaxRecordCount:b.query.tileMaxRecordCount,capabilities:b,fields:d,fullExtent:e,geometryType:g,objectIdField:c,source:m,timeInfo:h,spatialReference:k}]}})})};q.prototype._createMemoryServiceOptions=function(a){return c(this,void 0,void 0,function(){var b;return l(this,function(c){switch(c.label){case 0:return[4,a.openPorts()];case 1:return b=c.sent(),[2,r({},this._createServiceOptions(),
{type:"memory",source:b})]}})})};q.prototype._cleanUpQuery=function(a){a=ia.from(a)||this.createQuery();a.outSpatialReference||(a.outSpatialReference=this.view.spatialReference);return a};q.prototype._createUpdateClusterSizeTask=function(a,b){var d=this;return this.watch("_aggregateValueRanges",function(e){return c(d,void 0,void 0,function(){return l(this,function(c){this._updateClusterEffectiveRendererSizeVariable(a,b,e);if(!this._updatingPipelineConfig)this.tileRenderer.onConfigUpdate(this._effectiveRenderer);
return[2]})})})};q.prototype._updateClusterEffectiveRendererSizeVariable=function(a,b,d){return c(this,void 0,void 0,function(){var c,e;return l(this,function(g){"visualVariables"in a&&a.visualVariables&&(c=K.findSizeVV(a.visualVariables),x.isSome(c)&&"cluster_count"===c.field&&(e=a.visualVariables.indexOf(c),a.visualVariables[e]=K.createClusterCountSizeVariable(b,d),this._set("_effectiveRenderer",a.clone())));return[2]})})};q.prototype._getEffectiveRenderer=function(){return c(this,void 0,void 0,
function(){var a,b,c,d,e;return l(this,function(g){switch(g.label){case 0:a=this.layer.renderer;b=this.layer.featureReduction;x.isSome(this._updateClusterSizeTask)&&(this._updateClusterSizeTask.remove(),this._updateClusterSizeTask=null);if(!b||"cluster"!==b.type||!K.isClusterCompatibleRenderer(a))return[3,2];c=b;d=[];return[4,K.createClusterRenderer(d,this.layer.fields,a,c,this._aggregateValueRanges)];case 1:return e=g.sent(),x.andThen(this._updateClusterSizeTask,function(a){return a.remove()}),this._updateClusterSizeTask=
this._createUpdateClusterSizeTask(e,c),[2,{renderer:e,aggregateFields:d,featureReduction:b}];case 2:return[2,{renderer:a,aggregateFields:[],featureReduction:null}]}})})};q.prototype._acquireTile=function(a){var b=this;a=this.tileRenderer.acquireTile(a);a.once("attach",function(){b.requestUpdate()});return a};q.prototype._releaseTile=function(a){this.tileRenderer.releaseTile(a)};q.prototype._initTileRenderer=function(a){return c(this,void 0,void 0,function(){var b;return l(this,function(c){switch(c.label){case 0:return[4,
gb.createOrReuseTileRenderer(a,{layerView:this,tileInfoView:this.view.featuresTilingScheme,layer:this.layer})];case 1:return b=c.sent(),this.tileRenderer&&(this._tileStrategy.clear(),this.tileRenderer.uninstall(this.container),this.tileRenderer.destroy(),this.tileRenderer=null),this._proxy.tileRenderer=b,this._set("tileRenderer",b),this.tileRenderer.install(this.container),this.tileRenderer.onConfigUpdate(a),this.requestUpdate(),[2,this.tileRenderer]}})})};q.prototype._createLayerFilterHash=function(){var a=
this.layer.definitionExpression,b="feature"===this.layer.type&&this.layer.historicMoment?this.layer.historicMoment.getTime():void 0;return a+"."+b+"."+("feature"===this.layer.type?this.layer.gdbVersion:void 0)};q.prototype._createTileRendererHash=function(a){return("heatmap"===a.type?"heatmap":"symbol")+"."+("dot-density"===a.type)};q.prototype._createFeatureDataHash=function(a){a=a.getAttributeHash();var b=JSON.stringify(this.filter),c=x.isSome(this.effect)&&JSON.stringify(this.effect.filter),d=
JSON.stringify(this.timeExtent),e="";this._visibilityOverrides.forEach(function(a){return e+=a});return a+"."+b+"."+c+"."+d+"."+e};q.prototype._createMeshHash=function(a){var b=xa.getVVFlags("visualVariables"in a&&a.visualVariables||[]),c=this.layer.labelingInfo&&this.layer.labelingInfo.map(function(a){return JSON.stringify(a)}).join("/"),d=JSON.stringify(this.layer.featureReduction);return a.getMeshHash()+"."+b+"."+c+"."+d};q.prototype._injectOverrides=function(a){var b=this.filter&&this.filter.timeExtent,
b=this.timeExtent&&b?this.timeExtent.intersection(b):this.timeExtent||b;if(!this._visibilityOverrides.size&&!b)return a;a=x.isSome(this.filter)&&this.filter.clone()||new Sa;a.hiddenIds=this._visibilityOverrides;a.timeExtent=b;return a};q.prototype._createConfiguration=function(a,b,c){a=T.simplifyVVRenderer(a);var d=this.layer.labelingInfo,e="feature"===this.layer.type&&this.layer.historicMoment?this.layer.historicMoment.getTime():void 0,g="feature"===this.layer.type?this.layer.gdbVersion:void 0,h=
Array(xa.definitions.MAX_FILTERS),k=this._injectOverrides(this.filter);h[0]=x.isSome(k)&&k.toJSON()||null;h[1]=x.isSome(this.effect)&&this.effect.filter&&this.effect.filter.toJSON()||null;return{featureReduction:x.andThen(c,function(a){return a.toJSON()}),definitionExpression:this.layer.definitionExpression,availableFields:this.availableFields,labelingInfo:d&&d.map(function(a){return a.toJSON()}),renderer:a.toJSON(),gdbVersion:g,historicMoment:e,devicePixelRatio:window.devicePixelRatio||1,filters:h,
aggregateFields:b}};q.prototype._hasRequiredSupport=function(a){return"dot-density"!==a.renderer.type||C("esri-webgl-texture-float")?!0:(na.error(new h("webgl-missing-extension","Missing WebGL extension OES_Texture_Float which is required for DotDensity")),!1)};q.prototype._onceTilesUpdated=function(){this.requestUpdate();return b.whenFalseOnce(this,"_pipelineIsUpdating",!0)};q.prototype._lockAttributeTextureUpload=function(){this.tileRenderer&&this.tileRenderer.lockAttributeTextureUpload()};q.prototype._unlockAttributeTextureUpload=
function(){this.tileRenderer&&this.tileRenderer.unlockAttributeTextureUpload()};q.prototype._forceAttributeTextureUpload=function(){this.tileRenderer&&this.tileRenderer.forceAttributeTextureUpload()};q.prototype._renderingConfigHashChanged=function(){var a=this;this.view.timeline.begin(this.layer.title+" (FeatureLayer) Initial Pipeline Config");var b=this._onRenderingConfigChange();this._updatingPromise=b;var c=function(){b===a._updatingPromise&&a._set("_updatingPipelineConfig",!1);a.view&&a.view.timeline.end(a.layer.title+
" (FeatureLayer) Initial Pipeline Config")};b.then(c).catch(function(a){v.isAbortError(a)||na.error(a);c()})};q.prototype._addHighlight=function(a){for(var b=0;b<a.length;b++){var c=a[b];if(this._highlightIds.has(c)){var d=this._highlightIds.get(c);this._highlightIds.set(c,d+1)}else this._highlightIds.set(c,1)}this._updateHighlight().catch(function(a){v.isAbortError(a)||na.error(a)})};q.prototype._removeHighlight=function(a){for(var b=0;b<a.length;b++){var c=a[b];if(this._highlightIds.has(c)){var d=
this._highlightIds.get(c)-1;0===d?this._highlightIds.delete(c):this._highlightIds.set(c,d)}}this._updateHighlight().catch(function(a){v.isAbortError(a)||na.error(a)})};q.prototype._createHittestResult=function(a){a.layer=this.layer;a.sourceLayer=this.layer;x.isSome(a.geometry)&&(a.geometry.spatialReference=this.view.spatialReference);return a};q.prototype._queryFeature=function(a){return c(this,void 0,void 0,function(){var b,c,d;return l(this,function(e){switch(e.label){case 0:return[4,this._proxy.getObjectId(a)];
case 1:return b=e.sent(),[4,this._proxy.queryFeatures(new ia({objectIds:[b],outSpatialReference:this.view.spatialReference,returnGeometry:!0}))];case 2:return c=e.sent(),(d=c.features[0])?[2,d]:[2,null]}})})};q.prototype._hitTest=function(a,b){return c(this,void 0,void 0,function(){var c,e,h,k,m=this;return l(this,function(l){switch(l.label){case 0:return this.suspended||!this.tileRenderer?[2,null]:[4,this.tileRenderer.hitTest(a,b)];case 1:return c=l.sent(),0!==c.length?[3,3]:[4,v.after(1)];case 2:return l.sent(),
[2,null];case 3:return e=c[0],1===(e&2147483648)>>>31?[3,5]:[4,this._queryFeature(e)];case 4:return h=l.sent(),[2,x.andThen(h,function(a){return m._createHittestResult(g.fromJSON(a))})];case 5:return[4,this._proxy.getAggregate(e)];case 6:return k=l.sent(),x.isNone(k)?[2,null]:x.isSome(k.referenceId)?[4,this._queryFeature(k.referenceId)]:[3,8];case 7:return h=l.sent(),[2,x.andThen(h,function(a){return m._createHittestResult(g.fromJSON(a))})];case 8:return[2,this._createHittestResult(d.fromJSON(k))]}})})};
m([y.property()],q.prototype,"_proxy",void 0);m([y.property()],q.prototype,"_pipelineIsUpdating",void 0);m([y.property()],q.prototype,"_updatingPipelineConfig",void 0);m([y.property()],q.prototype,"_effectiveRenderer",void 0);m([y.property()],q.prototype,"_aggregateValueRanges",void 0);m([y.property()],q.prototype,"_onGoingEdits",void 0);m([y.property({dependsOn:["layer.renderer","layer.featureReduction"]})],q.prototype,"_effectiveRendererPromise",null);m([y.property({dependsOn:["suspended","layer.labelingInfo",
"layer.labelsVisible"]})],q.prototype,"labelsVisible",null);m([y.property({type:Sa})],q.prototype,"filter",void 0);m([y.property({type:Ta})],q.prototype,"effect",null);m([y.property({readOnly:!0,dependsOn:["effect"]})],q.prototype,"effects",null);m([y.property()],q.prototype,"numFeatures",null);m([y.property({dependsOn:"layer.renderer availableFields layer.definitionExpression layer.gdbVersion? layer.geometryDefinition? layer.historicMoment? layer.labelingInfo layer.featureReduction filter effect timeExtent clips".split(" ")})],
q.prototype,"renderingConfigHash",null);m([y.property()],q.prototype,"tileRenderer",void 0);m([y.property({dependsOn:"layer.renderer tileRenderer.updating _updatingPipelineConfig _pipelineIsUpdating _updatingRequiredFieldsPromise _proxy _proxy.isReady? _onGoingEdits".split(" ")})],q.prototype,"updating",void 0);return q=m([y.subclass("esri.views.2d.layers.FeatureLayerView2D")],q)}(y.declared(jb.FeatureLayerView(kb.RefreshableLayerView(Pa.LayerView2D(Ra)))))});