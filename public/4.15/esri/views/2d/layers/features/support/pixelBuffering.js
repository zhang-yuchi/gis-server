// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.15/esri/copyright.txt for details.
//>>built
define("require exports ../../../../../core/tsSupport/generatorHelper ../../../../../core/tsSupport/awaiterHelper ../../../../../core/tsSupport/assignHelper ../../../../../core/promiseUtils ../../../../../core/screenUtils ../../../../../symbols/cim/Rect ../../../engine ../../../engine/webgl/definitions ../../graphics/graphicsUtils".split(" "),function(K,h,d,e,A,B,C,D,E,F,G){function H(a){if(!("visualVariables"in a&&a.hasVisualVariables("size")))return 0;a=a.getVisualVariablesForType("size");if(!a[0])return 0;
a=a[0];if("stops"===a.transformationType)return a.stops.map(function(a){return a.size}).reduce(m,0);if("clamped-linear"===a.transformationType)return"number"===typeof a.maxSize?a.maxSize:a.maxSize.stops.map(function(a){return a.size}).reduce(m,0);if("real-world-size"===a.transformationType)return 30}function c(a,b){return null==a?b:a}function u(a,b){return e(this,void 0,void 0,function(){var v,f,g,k,l,r,w,x,e,m,n,h;return d(this,function(q){switch(q.label){case 0:if("simple-marker"===a.type)return v=
Math.max(c(a.size,12),b),[2,y(a)+.707*v];if("picture-marker"===a.type)return f=Math.max(c(a.height,12),b),g=c(a.width,12)*(f/c(a.height,12)),k=g/2,l=f/2,[2,y(a)+Math.sqrt(k*k+l*l)];if("text"===a.type){if(q=a.text&&a.text.length){for(var d=[],t=0;t<q;t++)d.push(A({},z,{code:a.text.charCodeAt(t)}));r={glyphMosaicItems:d}}else r={glyphMosaicItems:[z]};G.getTextSymbolSize(p,a,r);w=Math.abs(p[0]);x=Math.abs(p[1]);e=p[2];m=p[3];return[2,Math.max(w,x)+Math.max(e,m)]}if("simple-line"===a.type)return[2,Math.max(c(a.width,
.75),b)/2];if("simple-fill"===a.type||"picture-fill"===a.type)return[2,Math.max(null==a.outline?0:c(a.outline.width,0),b)/2];if("cim"===a.type)return(n=E.CIMSymbolHelper.getEnvelope(a.data))?[2,Math.sqrt(n.width*n.width+n.height*n.height)]:[2,0];if("web-style"!==a.type)return[3,2];h=u;return[4,a.fetchCIMSymbol()];case 1:return[2,h.apply(void 0,[q.sent(),b])];case 2:return[2,0]}})})}function I(a,b){return e(this,void 0,void 0,function(){var c,f;return d(this,function(g){switch(g.label){case 0:if(!(a.type in
J))return[2,0];f=(c=Math).min;return[4,u(a,b)];case 1:return[2,f.apply(c,[g.sent(),75])]}})})}function y(a){var b=c(a.xoffset,0);a=c(a.yoffset,0);return Math.sqrt(b*b+a*a)}function m(a,b){return Math.max(a,b)}Object.defineProperty(h,"__esModule",{value:!0});var J={"simple-marker":1,"picture-marker":1,text:1,"simple-line":1,"simple-fill":1,"picture-fill":1,cim:1,"web-style":1};h.computePxBuffer=function(a,b){return e(this,void 0,void 0,function(){var c,f,g,k,l,e,h;return d(this,function(d){switch(d.label){case 0:if("heatmap"===
a.type)return[2,Math.round(3*a.blurRadius)];if("dot-density"===a.type)return[2,0];if("dictionary"===a.type)return"esriGeometryPoint"===b||"esriGeometryMultipoint"===b?[2,100]:[2,50];c=a.getSymbols();f=H(a);g=[];k=0;for(l=c;k<l.length;k++)e=l[k],g.push(I(e,f));return[4,B.all(g)];case 1:return h=d.sent(),[2,C.pt2px(h.reduce(m,0))]}})})};var p=[0,0,0,0],z={sdf:!0,code:99,metrics:F.AVERAGE_GLYPH_MOSAIC_ITEM.metrics,rect:new D.default(0,0,24,24),page:0,textureBinding:2}});