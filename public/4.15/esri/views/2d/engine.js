// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.15/esri/copyright.txt for details.
//>>built
/*

 Copyright 2000, Silicon Graphics, Inc. All Rights Reserved.
 Copyright 2015, Google Inc. All Rights Reserved.

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to
 deal in the Software without restriction, including without limitation the
 rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 sell copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice including the dates of first publication and
 either this permission notice or a reference to http://oss.sgi.com/projects/FreeB/
 shall be included in all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL
 SILICON GRAPHICS, INC. BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR
 IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

 Original Code. The Original Code is: OpenGL Sample Implementation,
 Version 1.2.1, released January 26, 2000, developed by Silicon Graphics,
 Inc. The Original Code is Copyright (c) 1991-2000 Silicon Graphics, Inc.
 Copyright in any portions created by third parties is as indicated
 elsewhere herein. All Rights Reserved.
*/
require({cache:{"esri/views/2d/engine/Bitmap":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/libs/gl-matrix-2/mat3 ../../../core/libs/gl-matrix-2/mat3f32 ../../../core/libs/gl-matrix-2/vec2f32 ../../webgl ./DisplayObject ./ImageryBitmapSource".split(" "),function(b,c,e,g,f,a,n,k,d){function l(d){var a=document.createElement("canvas");a.width=d.width;a.height=d.height;d.render(a.getContext("2d"));return a}function t(d,a,b){var c={target:3553,pixelFormat:6408,
internalFormat:6408,dataType:5121,wrapMode:33071};a&&b&&(c.width=a,c.height=b);return new n.Texture(d,c)}function x(d){m.has(d)&&(w.splice(w.indexOf(d),1),m.delete(d))}Object.defineProperty(c,"__esModule",{value:!0});var w=[],m=new Set;b=function(b){function c(d,a){void 0===d&&(d=null);void 0===a&&(a=function(){return null});var c=b.call(this)||this;c.stencilRef=0;c.coordScale=[1,1];c._height=void 0;c.pixelRatio=1;c.resolution=0;c.rotation=0;c._source=null;c._width=void 0;c.x=0;c.y=0;c.transforms=
{dvs:f.mat3f32.create()};c.source=d;c.requestRender=a;return c}e(c,b);Object.defineProperty(c.prototype,"isSourceScaled",{get:function(){return this.width!==this.sourceWidth||this.height!==this.sourceHeight},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"height",{get:function(){return void 0!==this._height?this._height:this.sourceHeight},set:function(d){this._height=d},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"source",{get:function(){return this._source},
set:function(d){this._source=d;this.invalidateTexture()},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"sourceHeight",{get:function(){return this._source instanceof HTMLImageElement?this._source.naturalHeight:this._source.height},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"sourceWidth",{get:function(){return this._source instanceof HTMLImageElement?this._source.naturalWidth:this._source.width},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,
"width",{get:function(){return void 0!==this._width?this._width:this.sourceWidth},set:function(d){this._width=d},enumerable:!0,configurable:!0});c.prototype.attach=function(){this.updateTexture();return!0};c.prototype.detach=function(){this._texture.dispose();this._texture=null;x(this)};c.prototype.invalidateTexture=function(){this.attached?this.updateTexture():x(this)};c.prototype.setTransform=function(d){var b=g.mat3.identity(this.transforms.dvs),c=d.toScreenNoRotation([0,0],this.x,this.y),h=this.resolution/
this.pixelRatio/d.resolution,e=h*this.width,h=h*this.height,l=Math.PI*this.rotation/180;g.mat3.translate(b,b,a.vec2f32.fromValues(c[0],c[1]));g.mat3.translate(b,b,a.vec2f32.fromValues(e/2,h/2));g.mat3.rotate(b,b,-l);g.mat3.translate(b,b,a.vec2f32.fromValues(-e/2,-h/2));g.mat3.scaleByVec2(b,b,a.vec2f32.fromValues(e,h));g.mat3.multiply(this.transforms.dvs,d.displayViewMat3,b)};c.prototype.updateTexture=function(){this._texture||(this._texture=this.source?t(this.stage.context,this.sourceWidth,this.sourceHeight):
t(this.stage.context));var a=this.source;a?(this._texture.resize(this.sourceWidth,this.sourceHeight),a&&"render"in a?a instanceof d.default?(a=a.getRenderedRasterPixels(),this._texture.setData(a.renderedRasterPixels)):this._texture.setData(l(a)):!a||"render"in a||this._texture.setData(a),this.ready(),this.requestRender()):this._texture.setData(null)};c.prototype.setSamplingProfile=function(d){this._texture&&(d.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(d.samplingMode))};
c.prototype.bind=function(d){this._texture&&this.stage.context.bindTexture(this._texture,d)};return c}(k.DisplayObject);c.Bitmap=b})},"esri/views/2d/engine/DisplayObject":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","../../../core/Evented"],function(b,c,e,g){Object.defineProperty(c,"__esModule",{value:!0});b=function(b){function a(){var a=null!==b&&b.apply(this,arguments)||this;a._renderRequestedCalled=!1;a._attached=!1;a._isReady=!1;a._opacity=1;a.renderRequested=
!1;a._visible=!0;return a}e(a,b);Object.defineProperty(a.prototype,"attached",{get:function(){return this._attached},set:function(a){this._attached!==a&&((this._attached=a)?this.hasEventListener("attach")&&this.emit("attach"):this.hasEventListener("detach")&&this.emit("detach"))},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"isReady",{get:function(){return this._attached&&this._isReady},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"opacity",{get:function(){return this._opacity},
set:function(a){this._opacity!==a&&(this._opacity=a,this.requestRender())},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"visible",{get:function(){return this._visible},set:function(a){this._visible!==a&&(this._visible=a,this.requestRender())},enumerable:!0,configurable:!0});a.prototype.attach=function(){this.ready();return!0};a.prototype.setTransform=function(a){};a.prototype.detach=function(){};a.prototype.processRender=function(a){this.visible&&this.attached&&(this._renderRequestedCalled=
!1,this.doRender(a),this._renderRequestedCalled||(this.renderRequested=!1),this.hasEventListener("post-render")&&this.emit("post-render"))};a.prototype.requestRender=function(){var a=this.renderRequested;this.renderRequested=this._renderRequestedCalled=!0;this.parent&&this.parent.requestRender();a!==this.renderRequested&&this.hasEventListener("will-render")&&this.emit("will-render")};a.prototype.dispose=function(){};a.prototype.doRender=function(a){};a.prototype.ready=function(){this._isReady=!0;
this.emit("isReady")};return a}(g);c.DisplayObject=b})},"esri/views/2d/engine/ImageryBitmapSource":function(){define(["require","exports"],function(b,c){Object.defineProperty(c,"__esModule",{value:!0});b=function(){function b(b,c,a){this.pixelBlock=b;this.extent=c;this.originalPixelBlock=a}Object.defineProperty(b.prototype,"width",{get:function(){return this.pixelBlock?this.pixelBlock.width:0},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"height",{get:function(){return this.pixelBlock?
this.pixelBlock.height:0},enumerable:!0,configurable:!0});b.prototype.render=function(b){var c=this.pixelBlock;if(c){var a=this.filter({pixelBlock:c}),c=a.pixelBlock.getAsRGBA(),a=b.createImageData(a.pixelBlock.width,a.pixelBlock.height);a.data.set(c);b.putImageData(a,0,0)}};b.prototype.getRenderedRasterPixels=function(){var b=this.filter({pixelBlock:this.pixelBlock});return{width:b.pixelBlock.width,height:b.pixelBlock.height,renderedRasterPixels:new Uint8Array(b.pixelBlock.getAsRGBA().buffer)}};
return b}();c.default=b})},"esri/views/2d/engine/BitmapContainer":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../engine ./webgl/WGLContainer".split(" "),function(b,c,e,g,f,a){Object.defineProperty(c,"__esModule",{value:!0});b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}e(b,a);b.prototype.prepareRenderPasses=function(d){var b=this,c=d.registerRenderPass({name:"bitmap",brushes:[f.brushes.Bitmap],target:function(){return b.children}});
return a.prototype.prepareRenderPasses.call(this,d).concat([c])};return b}(a.default);c.BitmapContainer=b})},"esri/views/2d/engine/webgl/WGLContainer":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/assignHelper ../../../../core/maybe ../../engine ../Container ./ClippingInfo ./enums".split(" "),function(b,c,e,g,f,a,n,k,d){Object.defineProperty(c,"__esModule",{value:!0});b=function(b){function c(d){var a=b.call(this)||this;a.name=a.constructor.name;
a._lastTime=null;a.setClips(d);return a}e(c,b);c.prototype.setClips=function(d){var a=this;f.isSome(this._clippingInfos)&&(this._clippingInfos.forEach(function(d){return d.destroy()}),this._clippingInfos=null);f.isSome(d)&&d.length&&(this._clippingInfos=d.items.map(function(d){return k.default.fromClipArea(a,d)}));this.requestRender()};c.prototype.doRender=function(a){this.attachChildren();this.detachChildren();var b=this.createRenderParams(a),c=b.context,e=b.painter,l=b.globalOpacity,f=b.profiler,
l=b.drawPhase===d.WGLDrawPhase.LABEL?1:l*this.opacity;f.recordContainerStart(this.name);e.beforeRenderLayer(c,this._clippingInfos?255:0,l);this.updateTransforms(a.state);this.renderChildren(b);e.compositeLayer(c,l);f.recordContainerEnd()};c.prototype.renderChildren=function(d){f.isNone(this._renderPasses)&&(this._renderPasses=this.prepareRenderPasses(this.stage.painter));for(var a=0,b=this._renderPasses;a<b.length;a++)b[a].render(d)};c.prototype.createRenderParams=function(d){var a=Date.now(),b=(f.isSome(this._lastTime)?
a-this._lastTime:0)/1E3;this._lastTime=a;return g({},d,{context:this.stage.context,painter:this.stage.painter,profiler:this.stage.profiler,renderingOptions:this.stage.renderingOptions,driverTestResult:this.stage.driverTestResult,timeDelta:b,timeline:this.stage.timeline})};c.prototype.prepareRenderPasses=function(b){var c=this;return[b.registerRenderPass({name:"clip",brushes:[a.brushes.Clip],target:function(){return c._clippingInfos},drawPhase:d.WGLDrawPhase.MAP|d.WGLDrawPhase.LABEL|d.WGLDrawPhase.LABEL_ALPHA|
d.WGLDrawPhase.DEBUG})]};c.prototype.updateTransforms=function(d){for(var a=0,b=this.children;a<b.length;a++)b[a].setTransform(d)};return c}(n.Container);c.default=b})},"esri/views/2d/engine/Container":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","./DisplayObject"],function(b,c,e,g){Object.defineProperty(c,"__esModule",{value:!0});b=function(b){function a(){var a=null!==b&&b.apply(this,arguments)||this;a._childrenSet=new Set;a._childrenToAttach=[];a._childrenToDetach=
[];a.children=[];return a}e(a,b);Object.defineProperty(a.prototype,"numChildren",{get:function(){return this.children.length},enumerable:!0,configurable:!0});a.prototype.detach=function(){for(var a=0,b=this.children.concat(this._childrenToDetach);a<b.length;a++){var d=b[a];d.attached&&(this.detachChild(d),d.attached=!1,d.parent=null)}};a.prototype.doRender=function(a){var b=a.globalOpacity;a.globalOpacity*=this.opacity;this.attachChildren();this.detachChildren();this.renderChildren(a);a.globalOpacity=
b};a.prototype.addChild=function(a){return this.addChildAt(a,this.children.length)};a.prototype.addChildAt=function(a,b){void 0===b&&(b=this.numChildren);if(!a||this.contains(a))return a;var d=a.parent;d&&d!==this&&d.removeChild(a);b>=this.numChildren?this.children.push(a):this.children.splice(b,0,a);this._childrenSet.add(a);b=this._childrenToDetach.indexOf(a);-1<b&&this._childrenToDetach.splice(b,1);this._childrenToAttach.push(a);this.requestRender();return a};a.prototype.contains=function(a){return this._childrenSet.has(a)};
a.prototype.getChildIndex=function(a){return this.children.indexOf(a)};a.prototype.getChildAt=function(a){return 0>a||a>this.children.length?null:this.children[a]};a.prototype.removeAllChildren=function(){for(var a=this.numChildren;a--;)this.removeChildAt(0)};a.prototype.removeChild=function(a){return this.contains(a)?this.removeChildAt(this.getChildIndex(a)):a};a.prototype.removeChildAt=function(a){if(0>a||a>=this.children.length)return null;a=this.children.splice(a,1)[0];this._childrenSet["delete"](a);
if(a.attached)this._childrenToDetach.push(a);else{var b=this._childrenToAttach.indexOf(a);-1<b&&this._childrenToAttach.splice(b,1)}return a};a.prototype.setChildIndex=function(a,b){var d=this.getChildIndex(a);-1<d&&(this.children.splice(d,1),this.children.splice(b,0,a))};a.prototype.sortChildren=function(a){return this.children.sort(a)};a.prototype.attachChildren=function(){var a=this._childrenToAttach;if(0!==a.length)for(var b=0,d=!1;!d;)d=a[b],d.parent=this,d.stage=this.stage,this.attachChild(d)?
(d.attached=!0,a.splice(b,1)):++b,d=a.length===b};a.prototype.detachChildren=function(){for(var a=this._childrenToDetach;0<a.length;){var b=a.shift();this.detachChild(b);b.attached=!1;b.parent=null;b.stage=null}};a.prototype.renderChildren=function(a){for(var b=this.children,d=b.length,c=0;c<d;c++)b[c].processRender(a)};a.prototype.attachChild=function(a){return a.attach()};a.prototype.detachChild=function(a){a.detach()};return a}(g.DisplayObject);c.Container=b})},"esri/views/2d/engine/webgl/ClippingInfo":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../DisplayObject ./Mesh2D ../../../webgl/VertexArrayObject".split(" "),
function(b,c,e,g,f,a,n,k,d){Object.defineProperty(c,"__esModule",{value:!0});var l=f.getLogger("esri.views.2d.engine.webgl.ClippingInfo");b=function(b){function c(a,d){var c=b.call(this)||this;c._cache={};c.parent=a;c._handle=d.watch("version",function(){return c._invalidate()});c._clip=d;c.attach();c.attached=!0;return c}e(c,b);c.fromClipArea=function(a,d){return new c(a,d)};c.prototype._destroyGL=function(){a.isSome(this._cache.mesh)&&(this._cache.mesh.destroy(),this._cache.mesh=null);a.isSome(this._cache.vao)&&
(this._cache.vao.dispose(),this._cache.vao=null)};c.prototype.destroy=function(){this._destroyGL();this._handle.remove()};c.prototype.doRender=function(){};c.prototype.getVAO=function(b,c,e,l){var f=c.size,p=f[0],f=f[1];if("geometry"===this._clip.type||this._lastWidth!==p||this._lastHeight!==f)this._lastWidth=p,this._lastHeight=f,this._destroyGL();a.isNone(this._cache.vao)&&(c=this._createMesh(c,this._clip),p=c.getIndexBuffer(b),f=c.getVertexBuffers(b),this._cache.mesh=c,this._cache.vao=new d(b,e,
l,f,p));return this._cache.vao};c.prototype._invalidate=function(){this._destroyGL();this.requestRender()};c.prototype._createScreenRect=function(a,d){var b=a.size;a=b[0];var b=b[1],c="string"===typeof d.left?parseFloat(d.left)/100*a:d.left,e="string"===typeof d.right?parseFloat(d.right)/100*a:d.right,l="string"===typeof d.top?parseFloat(d.top)/100*b:d.top;d="string"===typeof d.bottom?parseFloat(d.bottom)/100*b:d.bottom;return{x:c,y:l,width:Math.max(a-e-c,0),height:Math.max(b-d-l,0)}};c.prototype._createMesh=
function(a,d){switch(d.type){case "rect":return k.default.fromRect(this._createScreenRect(a,d));case "path":return k.default.fromPath(d);case "geometry":return k.default.fromGeometry(a,d);default:return l.error(new g("mapview-bad-type","Unable to create ClippingInfo mesh from clip of type: ${clip.type}")),k.default.fromRect({x:0,y:0,width:1,height:1})}};return c}(n.DisplayObject);c.default=b})},"esri/views/2d/engine/webgl/Mesh2D":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/libs/earcut/earcut ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f64 ../../../../layers/graphics/featureConversionUtils ../../../../layers/graphics/OptimizedGeometry ./number ../../../webgl/BufferObject".split(" "),
function(b,c,e,g,f,a,n,k,d,l,t,x,w){Object.defineProperty(c,"__esModule",{value:!0});var m=f.getLogger("esri.views.2d.engine.webgl.Mesh2D"),z=function(a,d){var b=a.coords;a=a.lengths;for(var c=[],h=0,e=0;h<a.length;e+=a[h],h+=1){for(var l=e,f=[];h<a.length-1;h+=1,e+=a[h]){for(var q=e+a[h],k=0,m=1;m<a[h+1];m++)k+=(b[2*(q+m)]-b[2*(q+m-1)])*(b[2*(q+m)+1]+b[2*(q+m-1)+1]);if(!(d?0<k:0>k))break;f.push(e+a[h]-l)}k=b.slice(2*l,2*(e+a[h]));q=0;for(f=n.earcut(k,f,2);q<f.length;q++)c.push(f[q]+l)}return c};
b=function(){function b(a,d,b,c){void 0===c&&(c=!1);this._cache={};this.vertices=a;this.indices=d;this.primitiveType=b;this.isMapSpace=c}b.fromRect=function(a){var d=a.x,c=a.y;return b.fromScreenExtent({xmin:d,ymin:c,xmax:d+a.width,ymax:c+a.height})};b.fromPath=function(a){var d=l.convertFromNestedArray(new t.default,a.path,!1,!1);a=d.coords;for(var d=new Uint32Array(z(d,!0)),c=new Uint32Array(a.length/2),h=0;h<c.length;h++)c[h]=x.i1616to32(Math.floor(a[2*h]),Math.floor(a[2*h+1]));return new b({geometry:c},
d,4)};b.fromGeometry=function(a,d){var c=d.geometry.type;switch(c){case "polygon":return b.fromPolygon(a,d.geometry);case "extent":return b.fromMapExtent(a,d.geometry);default:return m.error(new g("mapview-bad-type","Unable to create a mesh from type "+c,d)),b.fromRect({x:0,y:0,width:1,height:1})}};b.fromPolygon=function(a,c){var e=l.convertFromPolygon(new t.default,c,!1,!1);c=e.coords;for(var e=new Uint32Array(z(e,!1)),h=new Uint32Array(c.length/2),f=d.vec2f64.create(),u=d.vec2f64.create(),p=0;p<
h.length;p++)k.vec2.set(f,c[2*p],c[2*p+1]),a.toScreen(u,f),h[p]=x.i1616to32(Math.floor(u[0]),Math.floor(u[1]));return new b({geometry:h},e,4,!0)};b.fromScreenExtent=function(a){var d=a.xmin,c=a.xmax,e=a.ymin;a=a.ymax;d={geometry:new Uint32Array([x.i1616to32(d,e),x.i1616to32(c,e),x.i1616to32(d,a),x.i1616to32(d,a),x.i1616to32(c,e),x.i1616to32(c,a)])};c=new Uint32Array([0,1,2,3,4,5]);return new b(d,c,4)};b.fromMapExtent=function(a,d){var c=a.toScreen([0,0],[d.xmin,d.ymin]),e=c[0],c=c[1];d=a.toScreen([0,
0],[d.xmax,d.ymax]);a=d[0];d=d[1];e={geometry:new Uint32Array([x.i1616to32(e,c),x.i1616to32(a,c),x.i1616to32(e,d),x.i1616to32(e,d),x.i1616to32(a,c),x.i1616to32(a,d)])};c=new Uint32Array([0,1,2,3,4,5]);return new b(e,c,4)};b.prototype.destroy=function(){a.isSome(this._cache.indexBuffer)&&this._cache.indexBuffer.dispose();for(var d in this._cache.vertexBuffers)a.isSome(this._cache.vertexBuffers[d])&&this._cache.vertexBuffers[d].dispose()};Object.defineProperty(b.prototype,"elementType",{get:function(){var a;
a:switch(this.indices.BYTES_PER_ELEMENT){case 1:a=5121;break a;case 2:a=5123;break a;case 4:a=5125;break a;default:throw new g("Cannot get DataType of array");}return a},enumerable:!0,configurable:!0});b.prototype.getIndexBuffer=function(a,d){void 0===d&&(d=35044);this._cache.indexBuffer||(this._cache.indexBuffer=w.createIndex(a,d,this.indices));return this._cache.indexBuffer};b.prototype.getVertexBuffers=function(a,d){var b=this;void 0===d&&(d=35044);this._cache.vertexBuffers||(this._cache.vertexBuffers=
Object.keys(this.vertices).reduce(function(c,l){var h;return e({},c,(h={},h[l]=w.createVertex(a,d,b.vertices[l]),h))},{}));return this._cache.vertexBuffers};return b}();c.default=b})},"esri/core/libs/earcut/earcut":function(){define(["require","exports"],function(b,c){function e(a,d,b,c,e){var h;if(e===0<m(a,d,b,c))for(e=d;e<b;e+=c)h=n(e,a[e],a[e+1],h);else for(e=b-c;e>=d;e-=c)h=n(e,a[e],a[e+1],h);h&&p(h,h.next)&&(k(h),h=h.next);return h}function g(a,d){void 0===d&&(d=a);if(!a)return a;var b;do if(b=
!1,a.steiner||!p(a,a.next)&&0!==x(a.prev,a,a.next))a=a.next;else{k(a);a=d=a.prev;if(a===a.next)break;b=!0}while(b||a!==d);return d}function f(d,b,c,e,l,m,r){void 0===r&&(r=0);if(d){!r&&m&&(d=t(d,e,l,m));for(var u=d;d.prev!==d.next;){var v=d.prev,n=d.next,y;if(m)y=a(d,e,l,m);else a:{y=d;var C=y.prev,B=y,D=y.next;if(0<=x(C,B,D))y=!1;else{for(var A=y.next.next,I=A,E=0;A!==y.prev&&(0===E||A!==I);){E++;if(z(C.x,C.y,B.x,B.y,D.x,D.y,A.x,A.y)&&0<=x(A.prev,A,A.next)){y=!1;break a}A=A.next}y=!0}}if(y)b.push(v.index/
c),b.push(d.index/c),b.push(n.index/c),k(d),u=d=n.next;else if(d=n,d===u){if(!r)f(g(d),b,c,e,l,m,1);else if(1===r){r=b;u=c;v=d;do n=v.prev,y=v.next.next,!p(n,y)&&w(n,v,v.next,y)&&q(n,y)&&q(y,n)&&(r.push(n.index/u),r.push(v.index/u),r.push(y.index/u),k(v),k(v.next),v=d=y),v=v.next;while(v!==d);d=v;f(d,b,c,e,l,m,2)}else if(2===r)a:{r=d;do{for(u=r.next.next;u!==r.prev;){if(v=r.index!==u.index){v=r;n=u;y=void 0;if(y=v.next.index!==n.index&&v.prev.index!==n.index){y=void 0;b:{y=v;do{if(y.index!==v.index&&
y.next.index!==v.index&&y.index!==n.index&&y.next.index!==n.index&&w(y,y.next,v,n)){y=!0;break b}y=y.next}while(y!==v);y=!1}y=!y}C=void 0;if(C=y&&q(v,n)&&q(n,v)){y=v;C=!1;B=(v.x+n.x)/2;n=(v.y+n.y)/2;do y.y>n!==y.next.y>n&&y.next.y!==y.y&&B<(y.next.x-y.x)*(n-y.y)/(y.next.y-y.y)+y.x&&(C=!C),y=y.next;while(y!==v)}v=C}if(v){d=h(r,u);r=g(r,r.next);d=g(d,d.next);f(r,b,c,e,l,m);f(d,b,c,e,l,m);break a}u=u.next}r=r.next}while(r!==d)}break}}}}function a(a,d,b,c){var e=a.prev,h=a.next;if(0<=x(e,a,h))return!1;
var l=e.x>a.x?e.x>h.x?e.x:h.x:a.x>h.x?a.x:h.x,f=e.y>a.y?e.y>h.y?e.y:h.y:a.y>h.y?a.y:h.y,p=v(e.x<a.x?e.x<h.x?e.x:h.x:a.x<h.x?a.x:h.x,e.y<a.y?e.y<h.y?e.y:h.y:a.y<h.y?a.y:h.y,d,b,c);d=v(l,f,d,b,c);b=a.prevZ;for(c=a.nextZ;b&&b.z>=p&&c&&c.z<=d;){if(b!==a.prev&&b!==a.next&&z(e.x,e.y,a.x,a.y,h.x,h.y,b.x,b.y)&&0<=x(b.prev,b,b.next))return!1;b=b.prevZ;if(c!==a.prev&&c!==a.next&&z(e.x,e.y,a.x,a.y,h.x,h.y,c.x,c.y)&&0<=x(c.prev,c,c.next))return!1;c=c.nextZ}for(;b&&b.z>=p;){if(b!==a.prev&&b!==a.next&&z(e.x,e.y,
a.x,a.y,h.x,h.y,b.x,b.y)&&0<=x(b.prev,b,b.next))return!1;b=b.prevZ}for(;c&&c.z<=d;){if(c!==a.prev&&c!==a.next&&z(e.x,e.y,a.x,a.y,h.x,h.y,c.x,c.y)&&0<=x(c.prev,c,c.next))return!1;c=c.nextZ}return!0}function n(a,d,b,c){a=new y(a,d,b);c?(a.next=c.next,a.prev=c,c.next.prev=a,c.next=a):(a.prev=a,a.next=a);return a}function k(a){a.next.prev=a.prev;a.prev.next=a.next;a.prevZ&&(a.prevZ.nextZ=a.nextZ);a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function d(a){var d=a,b=a;do{if(d.x<b.x||d.x===b.x&&d.y<b.y)b=d;d=d.next}while(d!==
a);return b}function l(a,d){var b=d,c=a.x,e=a.y,h=-Infinity,l;do{if(e<=b.y&&e>=b.next.y&&b.next.y!==b.y){var f=b.x+(e-b.y)*(b.next.x-b.x)/(b.next.y-b.y);if(f<=c&&f>h){h=f;if(f===c){if(e===b.y)return b;if(e===b.next.y)return b.next}l=b.x<b.next.x?b:b.next}}b=b.next}while(b!==d);if(!l)return null;if(c===h)return l.prev;d=l;for(var f=l.x,p=l.y,m=Infinity,k,b=l.next;b!==d;)c>=b.x&&b.x>=f&&c!==b.x&&z(e<p?c:h,e,f,p,e<p?h:c,e,b.x,b.y)&&(k=Math.abs(e-b.y)/(c-b.x),(k<m||k===m&&b.x>l.x)&&q(b,a)&&(l=b,m=k)),
b=b.next;return l}function t(a,d,b,c){for(var e=void 0;e!==a;e=e.next){e=e||a;null===e.z&&(e.z=v(e.x,e.y,d,b,c));if(e.prev.next!==e||e.next.prev!==e)return e.prev.next=e,e.next.prev=e,t(a,d,b,c);e.prevZ=e.prev;e.nextZ=e.next}a.prevZ.nextZ=null;a.prevZ=null;a:for(b=1;;){c=a;e=void 0;d=a=null;for(var h=0;c;){h++;for(var e=c,l=0;l<b&&e;l++)e=e.nextZ;for(var f=b;0<l||0<f&&e;){var p=void 0;0===l?(p=e,e=e.nextZ,f--):0!==f&&e?c.z<=e.z?(p=c,c=c.nextZ,l--):(p=e,e=e.nextZ,f--):(p=c,c=c.nextZ,l--);d?d.nextZ=
p:a=p;p.prevZ=d;d=p}c=e}d.nextZ=null;b*=2;if(2>h)break a}return a}function x(a,d,b){return(d.y-a.y)*(b.x-d.x)-(d.x-a.x)*(b.y-d.y)}function w(a,d,b,c){return p(a,d)&&p(b,c)||p(a,c)&&p(b,d)?!0:0<x(a,d,b)!==0<x(a,d,c)&&0<x(b,c,a)!==0<x(b,c,d)}function m(a,d,b,c){for(var e=0,h=b-c;d<b;d+=c)e+=(a[h]-a[d])*(a[d+1]+a[h+1]),h=d;return e}function z(a,d,b,c,e,h,l,f){return 0<=(e-l)*(d-f)-(a-l)*(h-f)&&0<=(a-l)*(c-f)-(b-l)*(d-f)&&0<=(b-l)*(h-f)-(e-l)*(c-f)}function q(a,d){return 0>x(a.prev,a,a.next)?0<=x(a,d,
a.next)&&0<=x(a,a.prev,d):0>x(a,d,a.prev)||0>x(a,a.next,d)}function v(a,d,b,c,e){a=32767*(a-b)*e;d=32767*(d-c)*e;a=(a|a<<8)&16711935;a=(a|a<<4)&252645135;a=(a|a<<2)&858993459;d=(d|d<<8)&16711935;d=(d|d<<4)&252645135;d=(d|d<<2)&858993459;return(a|a<<1)&1431655765|((d|d<<1)&1431655765)<<1}function p(a,d){return a.x===d.x&&a.y===d.y}function r(a,d){return a.x-d.x}function h(a,d){var b=new y(a.index,a.x,a.y),c=new y(d.index,d.x,d.y),e=a.next,h=d.prev;a.next=d;d.prev=a;b.next=e;e.prev=b;c.next=b;b.prev=
c;h.next=c;c.prev=h;return c}Object.defineProperty(c,"__esModule",{value:!0});c.earcut=function(a,b,c){var p=b&&b.length,q=p?b[0]*c:a.length,m=e(a,0,q,c,!0),k=[];if(!m||m.next===m.prev)return k;var t,x,w;if(p){for(var p=[],v=0,u=b.length;v<u;v++){var n=e(a,b[v]*c,v<u-1?b[v+1]*c:a.length,c,!1);n===n.next&&(n.steiner=!0);p.push(d(n))}p.sort(r);for(b=0;b<p.length;b++){v=p[b];u=m;if(u=l(v,u))v=h(u,v),g(v,v.next);m=g(m,m.next)}}if(a.length>80*c){t=w=a[0];x=p=a[1];for(b=c;b<q;b+=c)v=a[b],u=a[b+1],t=Math.min(t,
v),x=Math.min(x,u),w=Math.max(w,v),p=Math.max(p,u);w=Math.max(w-t,p-x);w=0!==w?1/w:0}f(m,k,c,t,x,w);return k};c.deviation=function(a,d,b,c){var e=d&&d.length,h=Math.abs(m(a,0,e?d[0]*b:a.length,b));if(e)for(var e=0,l=d.length;e<l;e++)h-=Math.abs(m(a,d[e]*b,e<l-1?d[e+1]*b:a.length,b));for(e=d=0;e<c.length;e+=3){var l=c[e]*b,f=c[e+1]*b,p=c[e+2]*b;d+=Math.abs((a[l]-a[p])*(a[f+1]-a[l+1])-(a[l]-a[f])*(a[p+1]-a[l+1]))}return 0===h&&0===d?0:Math.abs((d-h)/h)};var y=function(){return function(a,d,b){this.index=
a;this.x=d;this.y=b;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}}()})},"esri/views/2d/engine/webgl/number":function(){define(["require","exports"],function(b,c){function e(a,b,c){return Math.round(Math.max(Math.min(a,c),b))}Object.defineProperty(c,"__esModule",{value:!0});var g=new Float32Array(1),f=new Uint32Array(g.buffer);c.i8=function(a){return e(a,-128,127)};c.i16=function(a){return e(a,-32768,32767)};c.i32=function(a){return e(a,-2147483648,2147483647)};c.u8=function(a){return e(a,
0,255)};c.u16=function(a){return e(a,0,65535)};c.u32=function(a){return e(a,0,4294967295)};c.toUint32=function(a){g[0]=a;return f[0]};c.toFloat32=function(a){f[0]=a;return g[0]};c.u32to4Xu8=function(a){return[a&255,(a&65280)>>>8,(a&16711680)>>>16,(a&4278190080)>>>24]};c.i1616to32=function(a,b){return 65535&a|b<<16};c.i8888to32=function(a,b,c,d){return a&255|(b&255)<<8|(c&255)<<16|d<<24};c.i8816to32=function(a,b,c){return a&255|(b&255)<<8|c<<16};c.numTo32=function(a){return a|0}})},"esri/views/2d/engine/webgl/enums":function(){define(["require",
"exports"],function(b,c){Object.defineProperty(c,"__esModule",{value:!0});(function(b){b[b.FILL=0]="FILL";b[b.LINE=1]="LINE";b[b.MARKER=2]="MARKER";b[b.TEXT=3]="TEXT";b[b.LABEL=4]="LABEL"})(c.WGLGeometryType||(c.WGLGeometryType={}));(function(b){b[b.SUCCEEDED=0]="SUCCEEDED";b[b.FAILED_OUT_OF_MEMORY=1]="FAILED_OUT_OF_MEMORY"})(c.WGLGeometryTransactionStatus||(c.WGLGeometryTransactionStatus={}));(function(b){b[b.NONE=0]="NONE";b[b.MAP=1]="MAP";b[b.LABEL=2]="LABEL";b[b.LABEL_ALPHA=4]="LABEL_ALPHA";b[b.HITTEST=
8]="HITTEST";b[b.HIGHLIGHT=16]="HIGHLIGHT";b[b.CLIP=32]="CLIP";b[b.DEBUG=64]="DEBUG";b[b.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"})(c.WGLDrawPhase||(c.WGLDrawPhase={}));(function(b){b[b.SIZE=0]="SIZE";b[b.COLOR=1]="COLOR";b[b.OPACITY=2]="OPACITY";b[b.ROTATION=3]="ROTATION"})(c.VVType||(c.VVType={}));(function(b){b[b.NONE=0]="NONE";b[b.OPACITY=1]="OPACITY";b[b.COLOR=2]="COLOR";b[b.ROTATION=4]="ROTATION";b[b.SIZE_MINMAX_VALUE=8]="SIZE_MINMAX_VALUE";b[b.SIZE_SCALE_STOPS=16]="SIZE_SCALE_STOPS";b[b.SIZE_FIELD_STOPS=
32]="SIZE_FIELD_STOPS";b[b.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"})(c.WGLVVFlag||(c.WGLVVFlag={}));(function(b){b[b.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE";b[b.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE";b[b.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE";b[b.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"})(c.WGLVVTarget||(c.WGLVVTarget={}));(function(b){b[b.SPRITE=0]="SPRITE";b[b.GLYPH=1]="GLYPH"})(c.MosaicType||(c.MosaicType={}))})},"esri/views/2d/engine/BitmapTile":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ./Bitmap ./webgl/TiledDisplayObject".split(" "),
function(b,c,e,g,f,a){Object.defineProperty(c,"__esModule",{value:!0});b=function(a){function b(d,b,c,e){void 0===e&&(e=null);var l=a.call(this,d,b,c,c)||this;d=l.requestRender.bind(l);l.bitmap=new f.Bitmap(e,d);l.bitmap.coordScale=c;l.bitmap.once("isReady",function(){return l.ready()});return l}e(b,a);Object.defineProperty(b.prototype,"stencilRef",{get:function(){return this.bitmap.stencilRef},set:function(a){this.bitmap.stencilRef=a},enumerable:!0,configurable:!0});b.prototype.setTransform=function(d,
b){a.prototype.setTransform.call(this,d,b);this.bitmap.transforms.dvs=this.transforms.dvs};b.prototype.attach=function(){this.bitmap.stage=this.stage;var a=this.bitmap.attach();a&&(this.bitmap.attached=!0);return a};b.prototype.detach=function(){this.bitmap.detach()};return b}(a.TiledDisplayObject);c.BitmapTile=b})},"esri/views/2d/engine/webgl/TiledDisplayObject":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/has ../../../../core/libs/gl-matrix-2/mat3 ../../../../core/libs/gl-matrix-2/mat3f32 ../DisplayObject ../../tiling/TileKey".split(" "),
function(b,c,e,g,f,a,n,k){Object.defineProperty(c,"__esModule",{value:!0});b=function(d){function b(b,c,e,l){void 0===l&&(l=e);var f=d.call(this)||this;f.transforms={dvs:a.mat3f32.create(),tileMat3:a.mat3f32.create()};f.triangleCount=0;f.key=k.pool.acquire(b);f.bounds=c;f.size=e;f.coordRange=l;return f}e(b,d);b.prototype.destroy=function(){k.pool.release(this.key);this.key=null;this.texture&&(this.texture.dispose(),this.texture=null)};Object.defineProperty(b.prototype,"coords",{get:function(){return this._coords},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"bounds",{get:function(){return this._bounds},set:function(a){this._coords=[a[0],a[3]];this._bounds=a},enumerable:!0,configurable:!0});b.prototype.setTransform=function(a,d){d/=a.resolution*a.pixelRatio;var b=this.transforms.tileMat3,c=a.toScreenNoRotation([0,0],this.coords);f.mat3.set(b,this.size[0]/this.coordRange[0]*d,0,0,0,this.size[1]/this.coordRange[1]*d,0,c[0],c[1],1);f.mat3.multiply(this.transforms.dvs,a.displayViewMat3,b)};
return b}(n.DisplayObject);c.TiledDisplayObject=b})},"esri/views/2d/engine/webgl/TileContainer":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/assignHelper ./enums ./WGLContainer ./brushes/WGLBrushInfo ./brushes/WGLBrushStencil".split(" "),function(b,c,e,g,f,a,n,k){Object.defineProperty(c,"__esModule",{value:!0});c.sortByLevel=function(a,b){return 0!==a.key.level-b.key.level?a.key.level-b.key.level:0!==a.key.row-b.key.row?a.key.row-b.key.row:
a.key.col-b.key.col};b=function(a){function d(d,b){b=a.call(this,b)||this;b._tileInfoView=d;return b}e(d,a);d.prototype.renderChildren=function(d){this.sortChildren(c.sortByLevel);this.setStencilReference();a.prototype.renderChildren.call(this,d)};d.prototype.createRenderParams=function(d){var b=d.state;return g({},a.prototype.createRenderParams.call(this,d),{requiredLevel:this._tileInfoView.getClosestInfoForScale(b.scale).level,displayLevel:this._tileInfoView.tileInfo.scaleToZoom(b.scale)})};d.prototype.prepareRenderPasses=
function(d){var b=this,c=d.registerRenderPass({name:"stencil",brushes:[k.default],drawPhase:f.WGLDrawPhase.DEBUG|f.WGLDrawPhase.MAP,target:function(){return b.children}}),e=d.registerRenderPass({name:"tileInfo",brushes:[n.default],drawPhase:f.WGLDrawPhase.DEBUG,target:function(){return b.children},has:"esri-tiles-debug"});return a.prototype.prepareRenderPasses.call(this,d).concat([c,e])};d.prototype.updateTransforms=function(a){for(var d=0,b=this.children;d<b.length;d++){var c=b[d],e=this._tileInfoView.getTileResolution(c.key);
c.setTransform(a,e)}};d.prototype.setStencilReference=function(){for(var a=1,d=0,b=this.children;d<b.length;d++)b[d].stencilRef=a++};return d}(a.default);c.default=b})},"esri/views/2d/engine/webgl/brushes/WGLBrushInfo":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ./WGLBrush ../shaders/BackgroundPrograms ../shaders/TileInfoPrograms".split(" "),function(b,c,e,g,f,a,n,k){Object.defineProperty(c,"__esModule",
{value:!0});b=function(a){function d(){var d=null!==a&&a.apply(this,arguments)||this;d._color=g.vec4f32.fromValues(1,0,0,1);return d}e(d,a);d.prototype.dispose=function(){this._outlineProgram&&(this._outlineProgram.dispose(),this._outlineProgram=null);this._tileInfoProgram&&(this._tileInfoProgram.dispose(),this._tileInfoProgram=null);this._outlineVertexArrayObject&&(this._outlineVertexArrayObject.dispose(),this._outlineVertexArrayObject=null);this._tileInfoVertexArrayObject&&(this._tileInfoVertexArrayObject.dispose(),
this._tileInfoVertexArrayObject=null);this._canvas=null};d.prototype.prepareState=function(a){a=a.context;a.setBlendingEnabled(!0);a.setBlendFunctionSeparate(1,771,1,771);a.setColorMask(!0,!0,!0,!0);a.setStencilWriteMask(0);a.setStencilTestEnabled(!1)};d.prototype.draw=function(a,d){a=a.context;if(d.isReady){this._loadWGLResources(a);a.bindVAO(this._outlineVertexArrayObject);a.bindProgram(this._outlineProgram);this._outlineProgram.setUniformMatrix3fv("u_dvsMat3",d.transforms.dvs);this._outlineProgram.setUniform2f("u_coord_range",
d.coordRange[0],d.coordRange[1]);this._outlineProgram.setUniform1f("u_depth",0);this._outlineProgram.setUniform4fv("u_color",this._color);a.drawArrays(3,0,4);a.bindVAO();var b=this._getTexture(a,d);b&&(a.bindVAO(this._tileInfoVertexArrayObject),a.bindProgram(this._tileInfoProgram),a.bindTexture(b,0),this._tileInfoProgram.setUniformMatrix3fv("u_dvsMat3",d.transforms.dvs),this._tileInfoProgram.setUniform1f("u_depth",0),this._tileInfoProgram.setUniform2f("u_coord_ratio",d.coordRange[0]/d.size[0],d.coordRange[1]/
d.size[1]),this._tileInfoProgram.setUniform2f("u_delta",8,8),this._tileInfoProgram.setUniform2f("u_dimensions",b.descriptor.width,b.descriptor.height),a.drawArrays(5,0,4),a.bindVAO())}};d.prototype._loadWGLResources=function(a){if(!this._outlineProgram||!this._tileInfoProgram){var d=f.createProgram(a,n.background),b=f.createProgram(a,k.tileInfo),c={geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},e=new Int8Array([0,0,1,0,1,1,0,1]),e=f.BufferObject.createVertex(a,
35044,e),e=new f.VertexArrayObject(a,n.background.attributes,c,{geometry:e}),l=new Int8Array([0,0,1,0,0,1,1,1]),l=f.BufferObject.createVertex(a,35044,l);a=new f.VertexArrayObject(a,k.tileInfo.attributes,c,{geometry:l});this._outlineProgram=d;this._tileInfoProgram=b;this._outlineVertexArrayObject=e;this._tileInfoVertexArrayObject=a}};d.prototype._getTexture=function(a,d){if(d.texture)return d.texture;this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("id","canvas2d"),
this._canvas.setAttribute("width","300"),this._canvas.setAttribute("height","32"),this._canvas.setAttribute("style","display:none"));var b=d.triangleCount,c=d.key.id;0<d.triangleCount&&(c+=", "+b);var e=this._canvas,l=e.getContext("2d");l.font="24px sans-serif";l.textAlign="left";l.textBaseline="top";l.clearRect(0,0,300,32);1E5<b?(l.fillStyle="red",l.fillRect(0,0,300,32),l.fillStyle="black"):(l.clearRect(0,0,300,32),l.fillStyle="blue");l.fillText(c,0,0);d.texture=new f.Texture(a,{target:3553,pixelFormat:6408,
dataType:5121,samplingMode:9728,wrapMode:33071},e);return d.texture};return d}(a.default);c.default=b})},"esri/views/2d/engine/webgl/brushes/WGLBrush":function(){define(["require","exports"],function(b,c){Object.defineProperty(c,"__esModule",{value:!0});b=function(){function b(){this.name=this.constructor.name||"UnnamedBrush"}b.prototype.prepareState=function(b,c,a){};b.prototype.draw=function(b,c,a){};b.prototype.drawMany=function(b,c,a){for(var e=0;e<c.length;e++)this.draw(b,c[e],a)};return b}();
c.default=b})},"esri/views/2d/engine/webgl/shaders/BackgroundPrograms":function(){define(["require","exports","./sources/resolver"],function(b,c,e){Object.defineProperty(c,"__esModule",{value:!0});c.background={name:"background",shaders:{vertexShader:e.resolveIncludes("background/background.vert"),fragmentShader:e.resolveIncludes("background/background.frag")},attributes:{a_pos:0}}})},"esri/views/2d/engine/webgl/shaders/sources/resolver":function(){define(["require","exports","../../../../../webgl",
"./shaderRepository"],function(b,c,e,g){Object.defineProperty(c,"__esModule",{value:!0});var f=new e.ShaderCompiler(function(a){var b=g;a.split("/").forEach(function(a){b&&(b=b[a])});return b});c.resolveIncludes=function(a){return f.resolveIncludes(a)}})},"esri/views/2d/engine/webgl/shaders/sources/shaderRepository":function(){define(["require","exports"],function(b,c){return{background:{"background.frag":"uniform lowp vec4 u_color;\nvoid main() {\n  gl_FragColor \x3d u_color;\n}","background.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump vec2 u_coord_range;\nuniform mediump float u_depth;\nvoid main() {\n  vec3 v_pos \x3d u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0);\n  gl_Position \x3d vec4(v_pos.xy, 0.0, 1.0);\n}"},
bitBlit:{"bitBlit.frag":"uniform lowp sampler2D u_tex;\nuniform lowp float u_opacity;\nvarying mediump vec2 v_uv;\nvoid main() {\n  lowp vec4 color \x3d texture2D(u_tex, v_uv);\n  gl_FragColor \x3d color *  u_opacity;\n}","bitBlit.vert":"attribute vec2 a_pos;\nattribute vec2 a_tex;\nvarying mediump vec2 v_uv;\nvoid main(void) {\n  gl_Position \x3d vec4(a_pos, 0.0, 1.0);\n  v_uv \x3d a_tex;\n}"},filtering:{"bicubic.glsl":"vec4 computeWeights(float v) {\n  float b \x3d 1.0 / 6.0;\n  float v2 \x3d v * v;\n  float v3 \x3d v2 * v;\n  float w0 \x3d b * (-v3 + 3.0 * v2 - 3.0 * v + 1.0);\n  float w1 \x3d b * (3.0 * v3  - 6.0 * v2 + 4.0);\n  float w2 \x3d b * (-3.0 * v3 + 3.0 * v2 + 3.0 * v + 1.0);\n  float w3 \x3d b * v3;\n  return vec4(w0, w1, w2, w3);\n}\nvec4 bicubicOffsetsAndWeights(float v) {\n  vec4 w \x3d computeWeights(v);\n  float g0 \x3d w.x + w.y;\n  float g1 \x3d w.z + w.w;\n  float h0 \x3d 1.0 - (w.y / g0) + v;\n  float h1 \x3d 1.0 + (w.w / g1) - v;\n  return vec4(h0, h1, g0, g1);\n}\nvec4 sampleBicubicBSpline(sampler2D sampler, vec2 coords, vec2 texSize) {\n  vec2 eX \x3d vec2(1.0 / texSize.x, 0.0);\n  vec2 eY \x3d vec2(0.0, 1.0 / texSize.y);\n  vec2 texel \x3d coords * texSize - 0.5;\n  vec3 hgX \x3d bicubicOffsetsAndWeights(fract(texel).x).xyz;\n  vec3 hgY \x3d bicubicOffsetsAndWeights(fract(texel).y).xyz;\n  vec2 coords10 \x3d coords + hgX.x * eX;\n  vec2 coords00 \x3d coords - hgX.y * eX;\n  vec2 coords11 \x3d coords10 + hgY.x * eY;\n  vec2 coords01 \x3d coords00 + hgY.x * eY;\n  coords10 \x3d coords10 - hgY.y * eY;\n  coords00 \x3d coords00 - hgY.y * eY;\n  vec4 color00 \x3d texture2D(sampler, coords00);\n  vec4 color10 \x3d texture2D(sampler, coords10);\n  vec4 color01 \x3d texture2D(sampler, coords01);\n  vec4 color11 \x3d texture2D(sampler, coords11);\n  color00 \x3d mix(color00, color01, hgY.z);\n  color10 \x3d mix(color10, color11, hgY.z);\n  color00 \x3d mix(color00, color10, hgX.z);\n  return color00;\n}",
"bilinear.glsl":"vec4 sampleBilinear(sampler2D sampler, vec2 coords, vec2 texSize) {\n  vec2 texelStart \x3d floor(coords * texSize);\n  vec2 coord0 \x3d texelStart / texSize;\n  vec2 coord1 \x3d (texelStart +  vec2(1.0, 0.0)) / texSize;\n  vec2 coord2 \x3d (texelStart +  vec2(0.0, 1.0)) / texSize;\n  vec2 coord3 \x3d (texelStart +  vec2(1.0, 1.0)) / texSize;\n  vec4 color0 \x3d texture2D(sampler, coord0);\n  vec4 color1 \x3d texture2D(sampler, coord1);\n  vec4 color2 \x3d texture2D(sampler, coord2);\n  vec4 color3 \x3d texture2D(sampler, coord3);\n  vec2 blend \x3d fract(coords * texSize);\n  vec4 color01 \x3d mix(color0, color1, blend.x);\n  vec4 color23 \x3d mix(color2, color3, blend.x);\n  return mix(color01, color23, blend.y);\n}",
"epx.glsl":"vec4 sampleEPX(sampler2D sampler, float size, vec2 coords, vec2 texSize) {\n  vec2 invSize \x3d 1.0 / texSize;\n  vec2 texel \x3d coords * texSize;\n  vec2 texel_i \x3d floor(texel);\n  vec2 texel_frac \x3d fract(texel);\n  vec4 colorP \x3d texture2D(sampler, texel_i * invSize);\n  vec4 colorP1 \x3d vec4(colorP);\n  vec4 colorP2 \x3d vec4(colorP);\n  vec4 colorP3 \x3d vec4(colorP);\n  vec4 colorP4 \x3d vec4(colorP);\n  vec4 colorA \x3d texture2D(sampler, (texel_i - vec2(0.0, 1.0)) * invSize);\n  vec4 colorB \x3d texture2D(sampler, (texel_i + vec2(1.0, 0.0)) * invSize);\n  vec4 colorC \x3d texture2D(sampler, (texel_i - vec2(1.0, 0.0)) * invSize);\n  vec4 colorD \x3d texture2D(sampler, (texel_i + vec2(0.0, 1.0)) * invSize);\n  if (colorC \x3d\x3d colorA \x26\x26 colorC !\x3d colorD \x26\x26 colorA !\x3d colorB) {\n    colorP1 \x3d colorA;\n  }\n  if (colorA \x3d\x3d colorB \x26\x26 colorA !\x3d colorC \x26\x26 colorB !\x3d colorD) {\n    colorP2 \x3d colorB;\n  }\n  if (colorD \x3d\x3d colorC \x26\x26 colorD !\x3d colorB \x26\x26 colorC !\x3d colorA) {\n    colorP3 \x3d colorC;\n  }\n  if (colorB \x3d\x3d colorD \x26\x26 colorB !\x3d colorA \x26\x26 colorD !\x3d colorC) {\n    colorP4 \x3d colorD;\n  }\n  vec4 colorP12 \x3d mix(colorP1, colorP2, texel_frac.x);\n  vec4 colorP34 \x3d mix(colorP1, colorP2, texel_frac.x);\n  return mix(colorP12, colorP34, texel_frac.y);\n}"},
fx:{integrate:{"integrate.frag":"precision mediump float;\nuniform lowp sampler2D u_sourceTexture;\nuniform lowp sampler2D u_maskTexture;\nuniform mediump float u_zoomLevel;\nuniform highp float u_timeDelta;\nuniform highp float u_animationTime;\nvarying highp vec2 v_texcoord;\n#include \x3cmaterials/utils.glsl\x3e\nvoid main()\n{\n#ifdef DELTA\n  vec4 texel \x3d texture2D(u_sourceTexture, v_texcoord);\n  vec4 data0 \x3d texture2D(u_maskTexture, v_texcoord);\n  float flags \x3d data0.r * 255.0;\n  float groupMinZoom \x3d data0.g * 255.0;\n  float isVisible \x3d getFilterBit(flags, 0);\n  float wouldClip \x3d step(groupMinZoom, u_zoomLevel);\n  float direction \x3d wouldClip * 1.0 + (1.0 - wouldClip) * -1.0;\n  float dt \x3d u_timeDelta / max(u_animationTime, 0.0001);\n  vec4 nextState \x3d vec4(texel + direction * dt);\n  gl_FragColor \x3d  vec4(nextState);\n#elif defined(UPDATE)\n  vec4 texel \x3d texture2D(u_sourceTexture, v_texcoord);\n  gl_FragColor \x3d texel;\n#endif\n}",
"integrate.vert":"precision mediump float;\nattribute vec2 a_pos;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos;\n  gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n}"}},highlight:{"blur.frag":"varying mediump vec2 v_texcoord;\nuniform mediump vec4 u_direction;\nuniform mediump mat4 u_channelSelector;\nuniform mediump vec4 u_sigmas;\nuniform sampler2D u_texture;\nmediump vec4 gauss4(mediump vec2 dir) {\n  return exp(-dot(dir, dir) / (2.0 * u_sigmas * u_sigmas));\n}\nmediump float gauss1(mediump vec2 dir) {\n  return exp(-dot(dir, dir) / (2.0 * u_sigmas[3] * u_sigmas[3]));\n}\nmediump vec4 selectChannel(mediump vec4 sample) {\n  return u_channelSelector * sample;\n}\nvoid accumGauss4(mediump float i, inout mediump vec4 tot, inout mediump vec4 weight) {\n  mediump vec4 w \x3d gauss4(i * u_direction.xy);\n  tot +\x3d selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw)) * w;\n  weight +\x3d w;\n}\nvoid accumGauss1(mediump float i, inout mediump float tot, inout mediump float weight) {\n  mediump float w \x3d gauss1(i * u_direction.xy);\n  tot +\x3d selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw))[3] * w;\n  weight +\x3d w;\n}\nvoid main(void) {\n  mediump float tot \x3d 0.0;\n  mediump float weight \x3d 0.0;\n  accumGauss1(-4.0, tot, weight);\n  accumGauss1(-3.0, tot, weight);\n  accumGauss1(-2.0, tot, weight);\n  accumGauss1(-1.0, tot, weight);\n  accumGauss1(0.0, tot, weight);\n  accumGauss1(1.0, tot, weight);\n  accumGauss1(2.0, tot, weight);\n  accumGauss1(3.0, tot, weight);\n  accumGauss1(4.0, tot, weight);\n  gl_FragColor \x3d vec4(0.0, 0.0, 0.0, tot / weight);\n}",
"highlight.frag":"varying mediump vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform mediump vec4 u_sigmas;\nuniform sampler2D u_shade;\nuniform mediump vec2 u_minMaxDistance;\nmediump float estimateDistance() {\n  mediump float sigma \x3d u_sigmas[3];\n  mediump float y \x3d texture2D(u_texture, v_texcoord)[3];\n  const mediump float y0 \x3d 0.5;\n  mediump float m0 \x3d 1.0 / (sqrt(2.0 * 3.1415) * sigma);\n  mediump float d \x3d (y - y0) / m0;\n  return d;\n}\nmediump vec4 shade(mediump float d) {\n  mediump float mappedDistance \x3d (d - u_minMaxDistance.x) / (u_minMaxDistance.y - u_minMaxDistance.x);\n  mappedDistance \x3d clamp(mappedDistance, 0.0, 1.0);\n  return texture2D(u_shade, vec2(mappedDistance, 0.5));\n}\nvoid main(void) {\n  mediump float d \x3d estimateDistance();\n  gl_FragColor \x3d shade(d);\n}",
"textured.vert":"attribute mediump vec2 a_position;\nattribute mediump vec2 a_texcoord;\nvarying mediump vec2 v_texcoord;\nvoid main(void) {\n  gl_Position \x3d vec4(a_position, 0.0, 1.0);\n  v_texcoord \x3d a_texcoord;\n}"},magnifier:{"magnifier.frag":"uniform lowp vec4 u_background;\nuniform mediump sampler2D u_readbackTexture;\nuniform mediump sampler2D u_maskTexture;\nuniform mediump sampler2D u_overlyTexture;\nvarying mediump vec2 v_texCoord;\nvoid main(void)\n{\n  lowp vec4 color \x3d texture2D(u_readbackTexture, v_texCoord);\n  color \x3d color + (1.0 - color.a) * u_background;\n  lowp vec4 mask_color \x3d texture2D(u_maskTexture, v_texCoord);\n  lowp float gray \x3d 1.0 - dot(mask_color, vec4(0.3, 0.59, 0.11, 0));\n  color *\x3d gray;\n  lowp vec4 overley_color \x3d texture2D(u_overlyTexture, v_texCoord);\n  overley_color.rgb *\x3d overley_color.a;\n  gl_FragColor \x3d overley_color + (1.0 - overley_color.a) * color;\n}",
"magnifier.vert":"precision mediump float;\nattribute mediump vec2 a_pos;\nuniform mediump vec2 u_drawPos;\nuniform mediump float u_width;\nuniform mediump float u_height;\nvarying mediump vec2 v_texCoord;\nvoid main(void)\n{\n  v_texCoord \x3d a_pos;\n  vec2 coord \x3d u_drawPos + vec2(a_pos - 0.5) * vec2(u_width, u_height);\n  gl_Position \x3d vec4(coord, 0.0, 1.0);\n}"},materials:{"attributeData.glsl":"uniform highp sampler2D u_attributeData0;\nuniform highp sampler2D u_attributeData1;\nuniform highp sampler2D u_attributeData2;\nuniform highp sampler2D u_attributeData3;\nuniform highp int u_attributeTextureSize;\nhighp vec2 getAttributeDataCoords(in highp vec4 id) {\n  highp vec4 texel \x3d unpackLocalIdTexel(id);\n  highp float size \x3d float(u_attributeTextureSize);\n  highp float u32 \x3d float(int(texel.r) + int(texel.g) * 256 + int(texel.b) * 256 * 256 + int(texel.a) * 256 * 256 * 256);\n  highp float col \x3d mod(u32, size);\n  highp float row \x3d (u32 - col) / size;\n  highp float u \x3d col / size;\n  highp float v \x3d row / size;\n  return vec2(u, v);\n}\nhighp vec4 getAttributeData0(in highp vec4 id) {\n  vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData0, coords);\n}\nhighp vec4 getAttributeData1(in highp vec4 id) {\n  highp vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData1, coords);\n}\nhighp vec4 getAttributeData2(in highp vec4 id) {\n  highp vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData2, coords);\n}\nhighp vec4 getAttributeData3(in highp vec4 id) {\n  highp vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData3, coords);\n}\nfloat u88VVToFloat(in vec2 v) {\n  bool isMagic \x3d v.x \x3d\x3d 255.0 \x26\x26 v.y \x3d\x3d 255.0;\n  if (isMagic) {\n    return NAN_MAGIC_NUMBER;\n  }\n  return (v.x + v.y * float(0x100)) - 32768.0;\n}",
"constants.glsl":"const float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\nconst float SIGNED_BYTE_TO_UNSIGNED \x3d 128.0;\nconst float SOFT_EDGE_RATIO \x3d 1.0;\nconst float THIN_LINE_WIDTH_FACTOR \x3d 1.1;\nconst float THIN_LINE_HALF_WIDTH \x3d 1.0;\nconst float EXTRUDE_SCALE_PLACEMENT_PADDING \x3d 1.0 / 4.0;\nconst float OFFSET_PRECISION \x3d 1.0 / 8.0;\nconst float OUTLINE_SCALE \x3d 1.0 / 5.0;\nconst float SDF_FONT_SIZE \x3d 24.0;\nconst float MAX_SDF_DISTANCE \x3d 8.0;\nconst float PLACEMENT_PADDING \x3d 8.0;\nconst float EPSILON \x3d 0.0000001;\nconst int MAX_FILTER_COUNT \x3d 2;\nconst int ATTR_VV_SIZE \x3d 0;\nconst int ATTR_VV_COLOR \x3d 1;\nconst int ATTR_VV_OPACITY \x3d 2;\nconst int ATTR_VV_ROTATION \x3d 3;\nconst highp float NAN_MAGIC_NUMBER \x3d 1e-30;",
"effects.glsl":"uniform highp mat4 u_insideEffectMat4[ MAX_FILTER_COUNT ];\nuniform highp mat4 u_outsideEffectMat4[ MAX_FILTER_COUNT ];\nuniform highp float u_insideOpacities[ MAX_FILTER_COUNT ];\nuniform highp float u_outsideOpacities[ MAX_FILTER_COUNT ];\nvec4 getEffectColor(in vec4 color, in float filterFlags) {\n  vec4 rgbw \x3d vec4(color.a \x3e 0.0 ? color.rgb / color.a : vec3(0.0), 1.0);\n  float a \x3d color.a;\n  for (int i \x3d 1; i \x3c EFFECT_COUNT + 1; i++) {\n    float bit \x3d getFilterBit(filterFlags, i);\n    rgbw \x3d u_insideEffectMat4[ i ] * (bit  * rgbw) + u_outsideEffectMat4[ i ] * ((1.0 - bit) * rgbw);\n    a    \x3d u_insideOpacities[ i ]  * (bit  * a)    + u_outsideOpacities[ i ]  * ((1.0 - bit) * a);\n  }\n  return vec4(rgbw.rgb * a, a);\n}\nvec3 applyFilter(inout vec4 color, inout vec3 pos, in float filterFlags) {\n  vec4 rgbw \x3d vec4(color.a \x3e 0.0 ? color.rgb / color.a : vec3(0.0), 1.0);\n  float a \x3d color.a;\n  for (int i \x3d 0; i \x3c EFFECT_COUNT + 1; i++) {\n    float bit \x3d getFilterBit(filterFlags, i);\n    rgbw \x3d u_insideEffectMat4[ i ] * (bit  * rgbw) + u_outsideEffectMat4[ i ] * ((1.0 - bit) * rgbw);\n    a    \x3d u_insideOpacities[ i ]  * (bit  * a)    + u_outsideOpacities[ i ]  * ((1.0 - bit) * a);\n  }\n  color.rgb \x3d rgbw.rgb * a;\n  color.a \x3d a;\n  pos.z +\x3d 2.0 * (1.0 - getFilterBit(filterFlags, 0));\n#ifdef HIGHLIGHT\n  pos.z +\x3d 2.0 * (1.0 - getHighlightBit(filterFlags));\n#endif\n  return pos;\n}\nvec3 applyFilterLabels(inout vec4 color, inout vec3 pos, in float filterFlags) {\n  float bit \x3d getFilterBit(filterFlags, 0);\n  pos.z +\x3d 2.0 * (1.0 - bit);\n#ifndef OUTSIDE_LABELS_VISIBLE\n  for (int i \x3d 1; i \x3c EFFECT_COUNT + 1; i++) {\n    float bit \x3d getFilterBit(filterFlags, i);\n    pos.z +\x3d 2.0 * (1.0 - bit);\n  }\n#endif\n  return pos;\n}",
fill:{"common.glsl":"#ifdef PATTERN\nuniform mediump vec2 u_mosaicSize;\n#endif\n#ifdef DOT_DENSITY\nuniform lowp vec4 u_isActive[ 2 ];\nuniform highp float u_dotValue;\nuniform highp float u_tileDotsOverArea;\nuniform highp float u_dotTextureDotCount;\nuniform mediump float u_tileZoomFactor;\n#endif\nvarying vec3 v_pos;\nvarying lowp float v_opacity;\nvarying lowp vec4 v_color;\nvarying highp vec4 v_id;\nvarying highp float v_flags;\n#ifdef PATTERN\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef DOT_DENSITY\nvarying highp vec2 v_dotTextureCoords;\nvarying highp vec4 v_dotThresholds[ 2 ];\n#endif",
"fill.frag":"precision highp float;\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/fill/common.glsl\x3e\n#ifdef DOT_DENSITY\n#include \x3cmaterials/effects.glsl\x3e\n#endif\n#ifdef PATTERN\nuniform lowp sampler2D u_texture;\n#endif\n#ifdef DOT_DENSITY\nuniform mediump mat4 u_dotColors[ 2 ];\nuniform sampler2D u_dotTextures[ 2 ];\nuniform vec4 u_dotBackgroundColor;\n#endif\nvoid main() {\n#ifdef ID\n  gl_FragColor \x3d v_id;\n#elif defined(PATTERN)\n  mediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\n  mediump vec2 samplePos \x3d mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\n  lowp vec4 color \x3d texture2D(u_texture, samplePos);\n  gl_FragColor \x3d v_opacity * v_color * color;\n#elif defined(DOT_DENSITY) \x26\x26 !defined(HIGHLIGHT)\n  vec4 textureThresholds0 \x3d texture2D(u_dotTextures[0], v_dotTextureCoords);\n  vec4 textureThresholds1 \x3d texture2D(u_dotTextures[1], v_dotTextureCoords);\n  vec4 difference0 \x3d v_dotThresholds[0] - textureThresholds0;\n  vec4 difference1 \x3d v_dotThresholds[1] - textureThresholds1;\n#ifdef DD_DOT_BLENDING\n  vec4 isPositive0 \x3d step(0.0, difference0);\n  vec4 isPositive1 \x3d step(0.0, difference1);\n  float weightSum \x3d dot(isPositive0, difference0) + dot(isPositive1, difference1);\n  float lessThanEqZero \x3d step(weightSum, 0.0);\n  float greaterThanZero \x3d 1.0 - lessThanEqZero ;\n  float divisor \x3d (weightSum + lessThanEqZero);\n  vec4 weights0 \x3d difference0 * isPositive0 / divisor;\n  vec4 weights1 \x3d difference1 * isPositive1 / divisor;\n  vec4 dotColor \x3d u_dotColors[0] * weights0 + u_dotColors[1] * weights1;\n  vec4 preEffectColor \x3d greaterThanZero * dotColor + lessThanEqZero * u_dotBackgroundColor;\n#else\n  float diffMax \x3d max(max4(difference0), max4(difference1));\n  float lessThanZero \x3d step(diffMax, 0.0);\n  float greaterOrEqZero \x3d 1.0 - lessThanZero;\n  vec4 isMax0 \x3d step(diffMax, difference0);\n  vec4 isMax1 \x3d step(diffMax, difference1);\n  vec4 dotColor \x3d u_dotColors[0] * isMax0 + u_dotColors[1] * isMax1;\n  vec4 preEffectColor \x3d greaterOrEqZero * dotColor + lessThanZero * u_dotBackgroundColor;\n#endif\n  gl_FragColor \x3d getEffectColor(preEffectColor, v_flags);\n#else\n  gl_FragColor \x3d v_opacity * v_color;\n#endif\n#ifdef HIGHLIGHT\n  gl_FragColor.a \x3d 1.0;\n#endif\n}",
"fill.vert":"precision highp float;\n#ifdef DOT_DENSITY\nattribute float a_inverseArea;\nvec4 a_color \x3d vec4(0.0, 0.0, 0.0, 1.0);\nvec4 a_aux3 \x3d vec4(0.0);\n#else\nattribute vec4 a_color;\nattribute vec4 a_tlbr;\nattribute vec4 a_aux1;\nattribute vec2 a_aux2;\nattribute vec4 a_aux3;\n#endif\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/fill/common.glsl\x3e\n#ifdef DOT_DENSITY\nvec4 dotThreshold(vec4 featureAttrOverFeatureArea, float dotValue, float tileDotsOverArea) {\n  return featureAttrOverFeatureArea * (1.0 / dotValue)  * (1.0 / tileDotsOverArea);\n}\n#endif\n#ifdef PATTERN\nmat3 getPatternMatrix() {\n  mat3 patternMatrix \x3d mat3(1.0);\n  vec2 aux2 \x3d (1.0 / SIGNED_BYTE_TO_UNSIGNED) * a_aux2;\n  patternMatrix[0][0] \x3d 1.0 / (u_zoomFactor * a_aux1.x * aux2.x);\n  patternMatrix[1][1] \x3d 1.0 / (u_zoomFactor * a_aux1.y * aux2.y);\n  return patternMatrix;\n}\n#endif\nvoid main()\n{\n  INIT;\n  float a_bitSet \x3d a_aux3.a;\n  v_color     \x3d getColor(a_color, a_bitSet, 0);\n  v_opacity   \x3d getOpacity(a_bitSet, 1);\n  v_id        \x3d norm(a_id);\n  v_pos       \x3d u_dvsMat3 * vec3(a_pos, 1.);\n  v_flags     \x3d getFilterFlags();\n#ifdef PATTERN\n  vec2 symbolOffset \x3d u_zoomFactor * (a_aux1.zw - SIGNED_BYTE_TO_UNSIGNED);\n  v_tileTextureCoord \x3d (getPatternMatrix() * vec3(a_pos + symbolOffset, 1.0)).xy;\n  v_tlbr \x3d a_tlbr / u_mosaicSize.xyxy;\n#elif defined(DOT_DENSITY)\n  vec4 ddAttributeData0 \x3d getAttributeData2(a_id) * u_isActive[0] * a_inverseArea;\n  vec4 ddAttributeData1 \x3d getAttributeData3(a_id) * u_isActive[1] * a_inverseArea;\n  float size \x3d u_tileZoomFactor * 512.0 * 1.0 / u_pixelRatio;\n  v_dotThresholds[0] \x3d dotThreshold(ddAttributeData0, u_dotValue, u_tileDotsOverArea);\n  v_dotThresholds[1] \x3d dotThreshold(ddAttributeData1, u_dotValue, u_tileDotsOverArea);\n  v_dotTextureCoords \x3d (a_pos + 0.5) / size;\n#endif\n  gl_Position \x3d vec4(applyFilter(v_color, v_pos, v_flags), 1.0);\n}"},
icon:{"common.glsl":"uniform lowp vec2 u_mosaicSize;\nvarying lowp vec4 v_color;\nvarying highp vec4 v_id;\nvarying highp vec4 v_sizeTex;\nvarying mediump vec3 v_pos;\nvarying highp float v_filters;\nvarying lowp float v_opacity;\n#ifdef SDF\nvarying lowp vec4 v_outlineColor;\nvarying mediump float v_outlineWidth;\nvarying mediump float v_distRatio;\nvarying mediump float v_overridingOutlineColor;\nvarying mediump float v_isThin;\n#endif","icon.frag":"precision mediump float;\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cutil/encoding.glsl\x3e\n#include \x3cmaterials/effects.glsl\x3e\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\nuniform lowp sampler2D u_texture;\nvoid main()\n{\n  vec2 v_size \x3d v_sizeTex.xy;\n  vec2 v_tex  \x3d v_sizeTex.zw;\n#ifdef SDF\n  lowp vec4 fillPixelColor \x3d v_color;\n  float d \x3d 0.5 - rgba2float(texture2D(u_texture, v_tex));\n  float size \x3d max(v_size.x, v_size.y);\n  float dist \x3d d * size * SOFT_EDGE_RATIO * v_distRatio;\n  fillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\n  float outlineWidth \x3d v_outlineWidth;\n  #ifdef HIGHLIGHT\n    outlineWidth \x3d max(outlineWidth, 4.0 * v_isThin);\n  #endif\n  if (outlineWidth \x3e 0.25) {\n    lowp vec4 outlinePixelColor \x3d v_overridingOutlineColor * v_color + (1.0 - v_overridingOutlineColor) * v_outlineColor;\n    float clampedOutlineSize \x3d min(outlineWidth, size);\n    outlinePixelColor *\x3d clamp(0.5 - abs(dist) + clampedOutlineSize * 0.5, 0.0, 1.0);\n    gl_FragColor \x3d v_opacity * ((1.0 - outlinePixelColor.a) * fillPixelColor + outlinePixelColor);\n  }\n  else {\n    gl_FragColor \x3d v_opacity * fillPixelColor;\n  }\n#else\n   lowp vec4 texColor \x3d texture2D(u_texture, v_tex);\n   gl_FragColor \x3d v_opacity * getEffectColor(texColor, v_filters);\n#endif\n#ifdef HIGHLIGHT\n  gl_FragColor.a \x3d step(1.0 / 255.0, gl_FragColor.a);\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"icon.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_outlineColor;\nattribute vec4 a_sizeAndOutlineWidth;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nattribute vec4 a_bitSetAndDistRatio;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\nvec2 getMarkerSize(inout vec2 offset, inout vec2 baseSize, inout float outlineSize, in float referenceSize, in float bitSet) {\n#ifdef VV_SIZE\n  float r \x3d getSize(baseSize.y) / referenceSize;\n  baseSize.xy *\x3d r;\n  offset.xy *\x3d r;\n  float scaleSymbolProportionally \x3d getBit(bitSet, 3);\n  outlineSize *\x3d scaleSymbolProportionally * (r - 1.0) + 1.0;\n#endif\n  return baseSize;\n}\nvec3 getOffset(in vec2 in_offset, float a_bitSet) {\n  float isMapAligned \x3d getBit(a_bitSet, 0);\n  vec3  offset       \x3d getRotation() * vec3(in_offset, 0.0);\n  return getMatrix(isMapAligned) * offset;\n}\nvoid main()\n{\n  INIT;\n  vec2  a_size   \x3d a_sizeAndOutlineWidth.xy * a_sizeAndOutlineWidth.xy / 256.0;\n  vec2  a_offset \x3d a_vertexOffset / 16.0;\n  float a_outlineSize \x3d a_sizeAndOutlineWidth.z * a_sizeAndOutlineWidth.z / 256.0;\n  float a_bitSet \x3d a_bitSetAndDistRatio.z;\n  vec2 v_size \x3d getMarkerSize(a_offset, a_size, a_outlineSize, a_sizeAndOutlineWidth.w * a_sizeAndOutlineWidth.w / 256.0, a_bitSet);\n  vec2 v_tex      \x3d a_texCoords / u_mosaicSize;\n  v_color    \x3d getColor(a_color, a_bitSet, 1);\n  v_opacity  \x3d getOpacity(a_bitSet, 1);\n  v_id       \x3d norm(a_id);\n  v_filters  \x3d getFilterFlags();\n  v_pos      \x3d u_dvsMat3 * vec3(a_pos, 1.0) + getOffset(a_offset, a_bitSet);\n  v_sizeTex  \x3d vec4(v_size.xy, v_tex.xy);\n#ifdef SDF\n  v_isThin   \x3d getBit(a_bitSet, 2);\n  #ifdef VV_COLOR\n    v_overridingOutlineColor \x3d v_isThin;\n  #else\n    v_overridingOutlineColor \x3d 0.0;\n  #endif\n  v_outlineWidth \x3d min(a_outlineSize, max(max(v_size.x, v_size.y) - 0.99, 0.0));\n  v_outlineColor \x3d getEffectColor(a_outlineColor, v_filters);\n  v_distRatio \x3d a_bitSetAndDistRatio.w / 126.0;\n#endif\n  gl_Position \x3d vec4(applyFilter(v_color, v_pos, v_filters), 1.0);\n}"},
label:{"common.glsl":"uniform mediump float u_zoomLevel;\nuniform mediump float u_mapRotation;\nuniform mediump float u_mapAligned;\nuniform mediump vec2 u_mosaicSize;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying mediump vec2 v_tex;\nvarying mediump vec4 v_color;\nvarying lowp vec4 v_animation;","label.frag":"#include \x3cmaterials/text/text.frag\x3e","label.vert":"precision highp float;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/text/common.glsl\x3e\nattribute vec4 a_color;\nattribute vec4 a_haloColor;\nattribute vec4 a_texAndSize;\nattribute vec4 a_refSymbolAndPlacementOffset;\nattribute vec4 a_glyphData;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nuniform float u_isHalo;\nuniform float u_zoomLevel;\nuniform float u_mapRotation;\nuniform float u_mapAligned;\nfloat getZ(in float minZoom, in float maxZoom, in float angle) {\n  float glyphAngle \x3d angle * 360.0 / 254.0;\n  float mapAngle \x3d u_mapRotation * 360.0 / 254.0;\n  float diffAngle \x3d min(360.0 - abs(mapAngle - glyphAngle), abs(mapAngle - glyphAngle));\n  float z \x3d 0.0;\n  z +\x3d u_mapAligned * (2.0 * (1.0 - step(minZoom, u_zoomLevel)));\n  z +\x3d u_mapAligned * 2.0 * step(90.0, diffAngle);\n  z +\x3d 2.0 * (1.0 - step(u_zoomLevel, maxZoom));\n  return z;\n}\nvoid main()\n{\n  INIT;\n  float groupMinZoom    \x3d getMinZoom();\n  float glyphMinZoom    \x3d a_glyphData.x;\n  float glyphMaxZoom    \x3d a_glyphData.y;\n  float glyphAngle      \x3d a_glyphData.z;\n  float a_minZoom          \x3d max(groupMinZoom, glyphMinZoom);\n  float a_placementPadding \x3d a_refSymbolAndPlacementOffset.x * EXTRUDE_SCALE_PLACEMENT_PADDING;\n  vec2  a_placementDir     \x3d unpack_u8_nf32(a_refSymbolAndPlacementOffset.zw);\n  float a_refSymbolSize    \x3d a_refSymbolAndPlacementOffset.y;\n  float fontSize           \x3d a_texAndSize.z;\n  float haloSize           \x3d a_texAndSize.w * OUTLINE_SCALE;\n  vec2  vertexOffset \x3d a_vertexOffset * OFFSET_PRECISION;\n  vec3  pos          \x3d vec3(floor(a_pos * 0.5) * OFFSET_PRECISION, 1.0);\n  float z            \x3d getZ(a_minZoom, glyphMaxZoom, glyphAngle);\n  float fontScale    \x3d fontSize / SDF_FONT_SIZE;\n  float halfSize     \x3d getSize(a_refSymbolSize) / 2.0;\n  float animation    \x3d pow(getAnimationState(), vec4(2.0)).r;\n  v_color     \x3d animation * ((1.0 - u_isHalo) * a_color + (u_isHalo * a_haloColor));\n  v_opacity   \x3d 1.0;\n  v_tex       \x3d a_texCoords / u_mosaicSize;\n  v_edgeDistanceOffset \x3d u_isHalo * haloSize / fontScale / MAX_SDF_DISTANCE;\n  v_antialiasingWidth  \x3d 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\n  vec2 placementOffset \x3d a_placementDir * (halfSize + a_placementPadding);\n  vec3 glyphOffset     \x3d u_displayMat3 * vec3(vertexOffset + placementOffset, 0.0);\n  vec3 v_pos           \x3d vec3((u_dvsMat3 * pos + glyphOffset).xy, z);\n  gl_Position \x3d vec4(applyFilterLabels(v_color, v_pos, getFilterFlags()), 1.0);\n#ifdef DEBUG\n  v_color \x3d vec4(a_color.rgb, z \x3d\x3d 0.0 ? 1.0 : 0.645);\n#endif\n}"},
line:{"common.glsl":"varying lowp vec4 v_color;\nvarying highp vec4 v_id;\nvarying mediump vec2 v_normal;\nvarying mediump float v_lineHalfWidth;\nvarying lowp float v_opacity;\nvarying highp vec3 v_pos;\n#ifdef PATTERN\nuniform mediump vec2 u_mosaicSize;\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\n#endif\n#if defined(PATTERN) || defined(SDF)\nvarying highp float v_accumulatedDistance;\n#endif","line.frag":"precision lowp float;\n#include \x3cutil/encoding.glsl\x3e\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/line/common.glsl\x3e\nuniform lowp float u_blur;\nuniform mediump float u_zoomFactor;\n#if defined(PATTERN) || defined(SDF)\nuniform sampler2D u_texture;\n#endif\n#ifdef SDF\nconst float sdfPatternHalfWidth \x3d 15.5;\nconst float widthFactor \x3d 2.0;\n#endif\nvoid main()\n{\n  mediump float thinLineFactor \x3d max(THIN_LINE_WIDTH_FACTOR * step(v_lineHalfWidth, THIN_LINE_HALF_WIDTH), 1.0);\n  mediump float fragDist \x3d length(v_normal) * v_lineHalfWidth;\n  lowp float alpha \x3d clamp(thinLineFactor * (v_lineHalfWidth - fragDist) / (u_blur + thinLineFactor - 1.0), 0.0, 1.0);\n#if defined(SDF) \x26\x26 !defined(HIGHLIGHT)\n  mediump float lineHalfWidth \x3d widthFactor * v_lineHalfWidth;\n  mediump float lineWidthRatio \x3d lineHalfWidth / sdfPatternHalfWidth;\n  mediump float relativeTexX \x3d mod((u_zoomFactor * v_accumulatedDistance + v_normal.x * lineHalfWidth) / (lineWidthRatio * v_patternSize.x), 1.0);\n  mediump float relativeTexY \x3d 0.5 + 0.5 * v_normal.y;\n  mediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\n  mediump float d \x3d rgba2float(texture2D(u_texture, texCoord)) - 0.5;\n  float dist \x3d d * lineHalfWidth;\n  lowp vec4 fillPixelColor \x3d v_opacity * alpha * clamp(0.5 - dist, 0.0, 1.0) * v_color;\n  gl_FragColor \x3d fillPixelColor;\n#elif defined(PATTERN) \x26\x26 !defined(HIGHLIGHT)\n  mediump float relativeTexX \x3d mod((u_zoomFactor * v_accumulatedDistance + v_normal.x * v_lineHalfWidth) / v_patternSize.x, 1.0);\n  mediump float relativeTexY \x3d 0.5 + (v_normal.y * v_lineHalfWidth / v_patternSize.y);\n  mediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\n  lowp vec4 color \x3d texture2D(u_texture, texCoord);\n  gl_FragColor \x3d v_opacity * alpha * v_color * color;\n#else\n  gl_FragColor \x3d v_opacity * alpha * v_color;\n#endif\n#ifdef HIGHLIGHT\n  gl_FragColor.a \x3d step(1.0 / 255.0, gl_FragColor.a);\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"line.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_offsetAndNormal;\nattribute vec2 a_accumulatedDistanceAndHalfWidth;\nattribute vec4 a_tlbr;\nattribute vec4 a_segmentDirection;\nattribute vec2 a_aux;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/line/common.glsl\x3e\nconst float SCALE \x3d 1.0 / 31.0;\nconst float WIDTH_SCALE \x3d 1.0 / 1024.0;\nfloat getBaseLineHalfWidth(in float in_lineHalfWidth) {\n#ifdef VV_SIZE\n  float referenceHalfWidth \x3d a_aux.x * WIDTH_SCALE;\n  float lineWidth \x3d 2.0 * in_lineHalfWidth;\n  return 0.5 * (in_lineHalfWidth / referenceHalfWidth) * getSize(lineWidth);\n#else\n  return in_lineHalfWidth;\n#endif\n}\nfloat getLineHalfWidth(in float baseWidth, in float aa) {\n  float halfWidth \x3d max(baseWidth + aa, 0.45) + 0.1 * aa;\n#ifdef HIGHLIGHT\n  halfWidth \x3d max(halfWidth, 2.0);\n#endif\n  return halfWidth;\n}\nvec2 getDist(in vec2 offset, in float halfWidth) {\n  float thinLineFactor \x3d max(THIN_LINE_WIDTH_FACTOR * step(halfWidth, THIN_LINE_HALF_WIDTH), 1.0);\n#if defined(SDF) \x26\x26 !defined(HIGHLIGHT)\n  thinLineFactor *\x3d 2.0;\n#endif\n  return thinLineFactor * halfWidth * offset * SCALE;\n}\nvoid main()\n{\n  INIT;\n  float a_bitSet          \x3d a_segmentDirection.w;\n  float a_accumulatedDist \x3d a_accumulatedDistanceAndHalfWidth.x;\n  float a_lineHalfWidth   \x3d a_accumulatedDistanceAndHalfWidth.y * WIDTH_SCALE;\n  float aa                \x3d 0.5 * u_antialiasing;\n  vec2  a_offset          \x3d a_offsetAndNormal.xy;\n  float baseWidth \x3d getBaseLineHalfWidth(a_lineHalfWidth);\n  float halfWidth \x3d getLineHalfWidth(baseWidth, aa);\n  float z         \x3d 2.0 * step(baseWidth, 0.0);\n  vec2  dist      \x3d getDist(a_offset, halfWidth);\n  vec3  offset    \x3d u_displayViewMat3 * vec3(dist, 0.0);\n  vec3  pos       \x3d u_dvsMat3 * vec3(a_pos.xy, 1.0) + offset;\n  v_color         \x3d getColor(a_color, a_bitSet, 0);\n  v_opacity       \x3d getOpacity(a_bitSet, 0);\n  v_lineHalfWidth \x3d halfWidth;\n  v_id            \x3d norm(a_id);\n  v_normal        \x3d a_offsetAndNormal.zw * SCALE;\n  v_pos           \x3d vec3(pos.xy, z);\n#ifdef PATTERN\n  v_tlbr          \x3d a_tlbr / u_mosaicSize.xyxy;\n  v_patternSize   \x3d vec2(a_tlbr.z - a_tlbr.x, a_tlbr.w - a_tlbr.y);\n#endif\n#if defined(PATTERN) || defined(SDF)\n  v_accumulatedDistance \x3d a_accumulatedDist + dot(SCALE * a_segmentDirection.xy, dist / u_zoomFactor);\n#endif\n  gl_Position \x3d vec4(applyFilter(v_color, v_pos, getFilterFlags()), 1.0);\n}"},
text:{"common.glsl":"uniform highp vec2 u_mosaicSize;\nvarying highp vec4 v_id;\nvarying mediump vec3 v_pos;\nvarying lowp float v_opacity;\nvarying lowp vec4 v_color;\nvarying highp vec2 v_tex;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying lowp float v_transparency;","text.frag":"precision mediump float;\n#include \x3cmaterials/text/common.glsl\x3e\nuniform lowp sampler2D u_texture;\nvoid main()\n{\n  float SDF_CUTOFF \x3d (2.0 / 8.0);\n  float SDF_BASE_EDGE_DIST \x3d 1.0 - SDF_CUTOFF;\n  lowp float dist \x3d texture2D(u_texture, v_tex).a;\n  mediump float edge \x3d SDF_BASE_EDGE_DIST - v_edgeDistanceOffset;\n#ifdef HIGHLIGHT\n  edge /\x3d 2.0;\n#endif\n  lowp float aa \x3d v_antialiasingWidth;\n  lowp float alpha \x3d smoothstep(edge - aa, edge + aa, dist);\n  gl_FragColor \x3d alpha * v_color * v_opacity;\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"text.vert":"precision highp float;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/text/common.glsl\x3e\nattribute vec4 a_color;\nattribute vec4 a_haloColor;\nattribute vec4 a_texFontSize;\nattribute vec4 a_aux;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nuniform float u_isHalo;\nfloat getTextSize(inout vec2 offset, in float baseSize, in float referenceSize) {\n#ifdef VV_SIZE\n   float ratio \x3d baseSize / referenceSize;\n   baseSize \x3d ratio * getSize(baseSize);\n#endif\n  return baseSize;\n}\nvoid main()\n{\n  INIT;\n  float a_bitSet    \x3d a_aux.w;\n  float a_fontSize  \x3d a_texFontSize.z;\n  vec2  a_offset    \x3d a_vertexOffset * OFFSET_PRECISION;\n  vec3  in_pos      \x3d vec3(floor(a_pos * 0.5), 1.0);\n  float fontSize    \x3d getTextSize(a_offset, a_fontSize, a_aux.z * a_aux.z / 256.0);\n  float scaleFactor \x3d fontSize / a_fontSize;\n  float fontScale   \x3d fontSize / SDF_FONT_SIZE;\n  vec3  offset      \x3d getRotation() * vec3(scaleFactor * a_offset, 0.0);\n  v_color   \x3d u_isHalo * a_haloColor + (1.0 - u_isHalo) * getColor(a_color, a_bitSet, 0);\n  v_opacity \x3d getOpacity(a_bitSet, 0);\n  v_id      \x3d norm(a_id);\n  v_tex     \x3d a_texCoords / u_mosaicSize;\n  v_pos     \x3d u_dvsMat3 * in_pos + u_displayMat3 * offset;\n  v_edgeDistanceOffset \x3d u_isHalo * OUTLINE_SCALE * a_texFontSize.w / fontScale / MAX_SDF_DISTANCE;\n  v_antialiasingWidth  \x3d 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\n  gl_Position \x3d  vec4(applyFilter(v_color, v_pos, getFilterFlags()), 1.0);\n}"},
"utils.glsl":"float rshift(in float u32, in int amount) {\n  return floor(u32 / pow(2.0, float(amount)));\n}\nfloat getBit(in float bitset, in int bitIndex) {\n  float offset \x3d pow(2.0, float(bitIndex));\n  return mod(floor(bitset / offset), 2.0);\n}\nfloat getFilterBit(in float bitset, in int bitIndex) {\n  return getBit(bitset, bitIndex + 1);\n}\nfloat getHighlightBit(in float bitset) {\n  return getBit(bitset, 0);\n}\nhighp vec4 unpackLocalIdTexel(in highp vec4 bitset) {\n  float isAggregate \x3d getBit(bitset.a, 7);\n  return (1.0 - isAggregate) * bitset + isAggregate * (vec4(bitset.rgba) - vec4(0.0, 0.0, 0.0, float(0x80)));\n}\nvec4 unpack(in float u32) {\n  float r \x3d mod(rshift(u32, 0), 255.0);\n  float g \x3d mod(rshift(u32, 8), 255.0);\n  float b \x3d mod(rshift(u32, 16), 255.0);\n  float a \x3d mod(rshift(u32, 24), 255.0);\n  return vec4(r, g, b, a);\n}\nvec4 norm(in vec4 v) {\n  return v /\x3d 255.0;\n}\nfloat max4(vec4 target) {\n  return max(max(max(target.x, target.y), target.z), target.w);\n}\nvec2 unpack_u8_nf32(vec2 bytes) {\n  return (bytes - 127.0) / 127.0;\n}",
"vcommon.glsl":"#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/attributeData.glsl\x3e\n#include \x3cmaterials/vv.glsl\x3e\n#include \x3cmaterials/effects.glsl\x3e\nattribute vec2 a_pos;\nattribute highp vec4 a_id;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform highp float u_pixelRatio;\nuniform mediump float u_zoomFactor;\nuniform mediump float u_antialiasing;\nvec4 VV_ADATA \x3d vec4(0.0);\nvoid loadVisualVariableData(inout vec4 target) {\n#ifdef OES_TEXTURE_FLOAT\n  target.rgba \x3d getAttributeData2(a_id);\n#else\n  vec4 data0 \x3d getAttributeData2(a_id);\n  vec4 data1 \x3d getAttributeData3(a_id);\n  target.r \x3d u88VVToFloat(data0.rg * 255.0);\n  target.g \x3d u88VVToFloat(data0.ba * 255.0);\n  target.b \x3d u88VVToFloat(data1.rg * 255.0);\n  target.a \x3d u88VVToFloat(data1.ba * 255.0);\n#endif\n}\n#ifdef VV\n  #define INIT loadVisualVariableData(VV_ADATA)\n#else\n  #define INIT\n#endif\nvec4 getColor(in vec4 a_color, in float a_bitSet, int index) {\n#ifdef VV_COLOR\n  float isColorLocked   \x3d getBit(a_bitSet, index);\n  return getVVColor(VV_ADATA[ATTR_VV_COLOR], a_color, isColorLocked);\n#else\n  return a_color;\n#endif\n}\nfloat getOpacity(in float a_bitSet, in int index) {\n#ifdef VV_OPACITY\n  float isOpacityLocked \x3d getBit(a_bitSet, index);\n  return getVVOpacity(VV_ADATA[ATTR_VV_OPACITY], isOpacityLocked);\n#else\n  return 1.0;\n#endif\n}\nfloat getSize(in float in_size) {\n#ifdef VV_SIZE\n  return getVVSize(in_size, VV_ADATA[ATTR_VV_SIZE]);\n#else\n  return in_size;\n#endif\n}\nmat3 getRotation() {\n#ifdef VV_ROTATION\n  return getVVRotationMat3(mod(VV_ADATA[ATTR_VV_ROTATION], 360.0));\n#else\n  return mat3(1.0);\n#endif\n}\nfloat getFilterFlags() {\n#ifdef IGNORES_SAMPLER_PRECISION\n  return ceil(getAttributeData0(a_id).x * 255.0);\n#else\n  return getAttributeData0(a_id).x * 255.0;\n#endif\n}\nvec4 getAnimationState() {\n  return getAttributeData1(a_id);\n}\nfloat getMinZoom() {\n  vec4 data0 \x3d getAttributeData0(a_id) * 255.0;\n  return data0.g;\n}\nmat3 getMatrix(float isMapAligned) {\n  return isMapAligned * u_displayViewMat3 + (1.0 - isMapAligned) * u_displayMat3;\n}",
"vv.glsl":"#if defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n  #define VV_SIZE\n#endif\n#if defined(VV_COLOR) || defined(VV_SIZE) || defined(VV_OPACITY) || defined(VV_ROTATION)\n  #define VV\n#endif\n#ifdef VV_COLOR\nuniform highp float u_vvColorValues[8];\nuniform vec4 u_vvColors[8];\n#endif\n#ifdef VV_SIZE_MIN_MAX_VALUE\nuniform highp vec4 u_vvSizeMinMaxValue;\n#endif\n#ifdef VV_SIZE_SCALE_STOPS\nuniform highp float u_vvSizeScaleStopsValue;\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nuniform highp float u_vvSizeFieldStopsValues[6];\nuniform float u_vvSizeFieldStopsSizes[6];\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nuniform highp float u_vvSizeUnitValueWorldToPixelsRatio;\n#endif\n#ifdef VV_OPACITY\nuniform highp float u_vvOpacityValues[8];\nuniform float u_vvOpacities[8];\n#endif\n#ifdef VV_ROTATION\nuniform lowp float u_vvRotationType;\n#endif\nbool isNan(float val) {\n  return (val \x3d\x3d NAN_MAGIC_NUMBER);\n}\n#ifdef VV_SIZE_MIN_MAX_VALUE\nfloat getVVMinMaxSize(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n  float interpolationRatio \x3d (sizeValue  - u_vvSizeMinMaxValue.x) / (u_vvSizeMinMaxValue.y - u_vvSizeMinMaxValue.x);\n  interpolationRatio \x3d clamp(interpolationRatio, 0.0, 1.0);\n  return u_vvSizeMinMaxValue.z + interpolationRatio * (u_vvSizeMinMaxValue.w - u_vvSizeMinMaxValue.z);\n}\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nconst int VV_SIZE_N \x3d 6;\nfloat getVVStopsSize(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n  if (sizeValue \x3c\x3d u_vvSizeFieldStopsValues[0]) {\n    return u_vvSizeFieldStopsSizes[0];\n  }\n  for (int i \x3d 1; i \x3c VV_SIZE_N; ++i) {\n    if (u_vvSizeFieldStopsValues[i] \x3e\x3d sizeValue) {\n      float f \x3d (sizeValue - u_vvSizeFieldStopsValues[i-1]) / (u_vvSizeFieldStopsValues[i] - u_vvSizeFieldStopsValues[i-1]);\n      return mix(u_vvSizeFieldStopsSizes[i-1], u_vvSizeFieldStopsSizes[i], f);\n    }\n  }\n  return u_vvSizeFieldStopsSizes[VV_SIZE_N - 1];\n}\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nfloat getVVUnitValue(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n  return u_vvSizeUnitValueWorldToPixelsRatio * sizeValue;\n}\n#endif\n#ifdef VV_OPACITY\nconst int VV_OPACITY_N \x3d 8;\nfloat getVVOpacity(float opacityValue, float isOpacityLocked) {\n  if (isNan(opacityValue) || isOpacityLocked \x3d\x3d 1.0) {\n    return 1.0;\n  }\n  if (opacityValue \x3c\x3d u_vvOpacityValues[0]) {\n    return u_vvOpacities[0];\n  }\n  for (int i \x3d 1; i \x3c VV_OPACITY_N; ++i) {\n    if (u_vvOpacityValues[i] \x3e\x3d opacityValue) {\n      float f \x3d (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\n      return mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\n    }\n  }\n  return u_vvOpacities[VV_OPACITY_N - 1];\n}\n#endif\n#ifdef VV_ROTATION\nmat4 getVVRotation(float rotationValue) {\n  if (isNan(rotationValue)) {\n    return mat4(1, 0, 0, 0,\n                0, 1, 0, 0,\n                0, 0, 1, 0,\n                0, 0, 0, 1);\n  }\n  float rotation \x3d rotationValue;\n  if (u_vvRotationType \x3d\x3d 1.0) {\n    rotation \x3d 90.0 - rotation;\n  }\n  float angle \x3d C_DEG_TO_RAD * rotation;\n  float sinA \x3d sin(angle);\n  float cosA \x3d cos(angle);\n  return mat4(cosA, sinA, 0, 0,\n              -sinA,  cosA, 0, 0,\n              0,     0, 1, 0,\n              0,     0, 0, 1);\n}\nmat3 getVVRotationMat3(float rotationValue) {\n  if (isNan(rotationValue)) {\n    return mat3(1, 0, 0,\n                0, 1, 0,\n                0, 0, 1);\n  }\n  float rotation \x3d rotationValue;\n  if (u_vvRotationType \x3d\x3d 1.0) {\n    rotation \x3d 90.0 - rotation;\n  }\n  float angle \x3d C_DEG_TO_RAD * -rotation;\n  float sinA \x3d sin(angle);\n  float cosA \x3d cos(angle);\n  return mat3(cosA, -sinA, 0,\n             sinA, cosA, 0,\n              0,    0,    1);\n}\n#endif\n#ifdef VV_COLOR\nconst int VV_COLOR_N \x3d 8;\nvec4 getVVColor(float colorValue, vec4 fallback, float isColorLocked) {\n  if (isNan(colorValue) || isColorLocked \x3d\x3d 1.0) {\n    return fallback;\n  }\n  if (colorValue \x3c\x3d u_vvColorValues[0]) {\n    return u_vvColors[0];\n  }\n  for (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\n    if (u_vvColorValues[i] \x3e\x3d colorValue) {\n      float f \x3d (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\n      return mix(u_vvColors[i-1], u_vvColors[i], f);\n    }\n  }\n  return u_vvColors[VV_COLOR_N - 1];\n}\n#endif\nfloat getVVSize(in float size, in float vvSize)  {\n#ifdef VV_SIZE_MIN_MAX_VALUE\n  return getVVMinMaxSize(vvSize, size);\n#elif defined(VV_SIZE_SCALE_STOPS)\n  return u_vvSizeScaleStopsValue;\n#elif defined(VV_SIZE_FIELD_STOPS)\n  float outSize \x3d getVVStopsSize(vvSize, size);\n  return isNan(outSize) ? size : outSize;\n#elif defined(VV_SIZE_UNIT_VALUE)\n  return getVVUnitValue(vvSize, size);\n#else\n  return size;\n#endif\n}"},
raster:{bitmap:{"bitmap.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform highp vec2 u_coordScale;\n#include \x3cfiltering/bicubic.glsl\x3e\nvoid main() {\n#ifdef BICUBIC\n  vec4 color \x3d sampleBicubicBSpline(u_texture, v_texcoord, u_coordScale);\n#else\n  vec4 color \x3d texture2D(u_texture, v_texcoord);\n#endif\n  gl_FragColor \x3d vec4(color.rgb * color.a, color.a);\n}","bitmap.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos;\n  gl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},
common:{"common.glsl":"uniform sampler2D u_image;\nuniform int u_bandCount;\nuniform bool u_isFloatTexture;\nuniform bool u_flipY;\nuniform bool u_applyTransform;\nuniform float u_opacity;\nuniform int u_resampling;\n#include \x3craster/common/projection.glsl\x3e\nvec2 getPixelLocation(vec2 coords) {\n  vec2 targetLocation \x3d u_flipY ? vec2(coords.s, 1.0 - coords.t) : coords;\n  if (!u_applyTransform) {\n    return targetLocation;\n  }\n  return projectPixelLocation(targetLocation);\n}\nbool isOutside(vec2 coords){\n   if (coords.t\x3e1.00001 ||coords.t\x3c-0.00001 || coords.s\x3e1.00001 ||coords.s\x3c-0.00001) {\n     return true;\n   } else {\n     return false;\n   }\n}\nvec4 getPixel(vec2 pixelLocation) {\n  return texture2D(u_image, pixelLocation);\n}",
"contrastBrightness.glsl":"uniform float u_contrastOffset;\nuniform float u_brightnessOffset;\nvec4 adjustContrastBrightness(vec4 currentPixel, bool isFloat) {\n  vec4 pixelValue \x3d isFloat ? currentPixel * 255.0 : currentPixel;\n  float maxI \x3d 255.0;\n  float mid \x3d 128.0;\n  float c \x3d u_contrastOffset;\n  float b \x3d u_brightnessOffset;\n  vec4 v;\n  if (c \x3e 0.0 \x26\x26 c \x3c 100.0) {\n    v \x3d (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) / (2.0 * (100.0 - c)) + mid;\n  } else if (c \x3c\x3d 0.0 \x26\x26 c \x3e -100.0) {\n    v \x3d (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) * (100.0 + c) / 20000.0 + mid;\n  } else if (c \x3d\x3d 100.0) {\n    v \x3d (200.0 * pixelValue - 100.0 * maxI + (maxI + 1.0) * (100.0 - c) + 2.0 * maxI * b);\n    v \x3d (sign(v) + 1.0) / 2.0;\n  } else if (c \x3d\x3d -100.0) {\n    v \x3d vec4(mid, mid, mid, currentPixel.a);\n  }\n  return vec4(v.r / 255.0, v.g / 255.0, v.b / 255.0, currentPixel.a);\n}",
"projection.glsl":"uniform sampler2D u_transformGrid;\nuniform vec2 u_transformSpacing;\nuniform vec2 u_transformGridSize;\nuniform vec2 u_targetImageSize;\nuniform vec2 u_srcImageSize;\nvec2 projectPixelLocation(vec2 coords) {\n  vec2 index_image \x3d floor(coords * u_targetImageSize);\n  vec2 oneTransformPixel \x3d vec2(0.25 / u_transformGridSize.s, 1.0 / u_transformGridSize.t);\n  vec2 index_transform \x3d floor(index_image / u_transformSpacing) / u_transformGridSize;\n  vec2 pos \x3d fract((index_image + vec2(0.5, 0.5)) / u_transformSpacing);\n  vec2 srcLocation;\n  vec2 transform_location \x3d index_transform + oneTransformPixel * 0.5;\n  if (pos.s \x3c\x3d pos.t) {\n    vec4 ll_abc \x3d texture2D(u_transformGrid, vec2(transform_location.s, transform_location.t));\n    vec4 ll_def \x3d texture2D(u_transformGrid, vec2(transform_location.s + oneTransformPixel.s, transform_location.t));\n    srcLocation.s \x3d dot(ll_abc.rgb, vec3(pos, 1.0));\n    srcLocation.t \x3d dot(ll_def.rgb, vec3(pos, 1.0));\n  } else {\n    vec4 ur_abc \x3d texture2D(u_transformGrid, vec2(transform_location.s + 2.0 * oneTransformPixel.s, transform_location.t));\n    vec4 ur_def \x3d texture2D(u_transformGrid, vec2(transform_location.s + 3.0 * oneTransformPixel.s, transform_location.t));\n    srcLocation.s \x3d dot(ur_abc.rgb, vec3(pos, 1.0));\n    srcLocation.t \x3d dot(ur_def.rgb, vec3(pos, 1.0));\n  }\n  return srcLocation;\n}"},
lut:{"colorize.glsl":"uniform sampler2D u_colormap;\nuniform float u_colormapOffset;\nuniform float u_colormapMaxIndex;\nvec4 colorize(vec4 currentPixel, bool isFloat) {\n  float clrIndex \x3d isFloat ? currentPixel.r - u_colormapOffset : currentPixel.r * 255.0 - u_colormapOffset;\n  vec4 result;\n  if (currentPixel.a \x3d\x3d 0.0 || clrIndex \x3e u_colormapMaxIndex) {\n    result \x3d vec4(0.0, 0.0, 0.0, 0.0);\n  } else {\n    vec2 clrPosition \x3d vec2((clrIndex + 0.5) / (u_colormapMaxIndex + 1.0), 0.0);\n    vec4 color \x3d texture2D(u_colormap, clrPosition);\n    result \x3d vec4(color.rgb, color.a * u_opacity);\n  }\n  return result;\n}",
"lut.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\n#include \x3craster/lut/colorize.glsl\x3e\nvoid main() {\n  vec2 pixelLocation \x3d getPixelLocation(v_texcoord);\n  if (isOutside(pixelLocation)) {\n     gl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\n     return;\n  }\n  vec4 currentPixel \x3d getPixel(pixelLocation);\n  gl_FragColor \x3d colorize(currentPixel, true);\n}","lut.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos;\n  gl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},
stretch:{"stretch.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\nuniform float u_minCutOff[3];\nuniform float u_maxCutOff[3];\nuniform float u_minOutput;\nuniform float u_maxOutput;\nuniform float u_factor[3];\nuniform bool u_useGamma;\nuniform float u_gamma[3];\nuniform float u_gammaCorrection[3];\nuniform bool u_applyColormap;\n#include \x3craster/lut/colorize.glsl\x3e\nfloat stretchOneValue(float val, float minCutOff, float maxCutOff, float minOutput, float maxOutput, float factor, bool useGamma, float gamma, float gammaCorrection) {\n  if (val \x3e\x3d maxCutOff) {\n    return maxOutput;\n  } else if (val \x3c\x3d minCutOff) {\n    return minOutput;\n  }\n  float stretchedVal;\n  if (useGamma) {\n  \tfloat tempf \x3d 1.0;\n\t  float outRange \x3d maxOutput - minOutput;\n\t  float relativeVal \x3d (val - minCutOff) / (maxCutOff - minCutOff);\n\t  if (gamma \x3e 1.0) {\n      tempf -\x3d pow(1.0 / outRange, relativeVal * gammaCorrection);\n    }\n    stretchedVal \x3d floor(tempf * outRange * pow(relativeVal, 1.0 / gamma)) + minOutput;\n  } else {\n    stretchedVal \x3d minOutput + (val - minCutOff) * factor;\n  }\n  return stretchedVal;\n}\nvoid main() {\n  vec2 pixelLocation \x3d getPixelLocation(v_texcoord);\n  if (isOutside(pixelLocation)) {\n     gl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\n     return;\n  }\n  vec4 currentPixel \x3d getPixel(pixelLocation);\n  if (currentPixel.a \x3d\x3d 0.0) {\n    gl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\n    return;\n  }\n  if (u_bandCount \x3d\x3d 1) {\n    float grayVal \x3d stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\n    if (u_applyColormap) {\n      gl_FragColor \x3d colorize(vec4(grayVal, grayVal, grayVal, currentPixel.a), true);\n    } else {\n      gl_FragColor \x3d vec4(grayVal, grayVal, grayVal, currentPixel.a);\n    }\n  } else {\n    float redVal \x3d stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\n    float greenVal \x3d stretchOneValue(currentPixel.g, u_minCutOff[1], u_maxCutOff[1], u_minOutput, u_maxOutput, u_factor[1], u_useGamma, u_gamma[1], u_gammaCorrection[1]);\n    float blueVal \x3d stretchOneValue(currentPixel.b, u_minCutOff[2], u_maxCutOff[2], u_minOutput, u_maxOutput, u_factor[2], u_useGamma, u_gamma[2], u_gammaCorrection[2]);\n    gl_FragColor \x3d vec4(redVal, greenVal, blueVal, currentPixel.a);\n  }\n}",
"stretch.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos;\n  gl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"}},stencil:{"stencil.frag":"void main() {\n  gl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\n}","stencil.vert":"attribute vec2 a_pos;\nvoid main() {\n  gl_Position \x3d vec4(a_pos, 0.0, 1.0);\n}"},tileInfo:{"tileInfo.frag":"uniform mediump sampler2D u_texture;\nvarying mediump vec2 v_tex;\nvoid main(void) {\n  lowp vec4 color \x3d texture2D(u_texture, v_tex);\n  gl_FragColor \x3d 0.75 * color;\n}",
"tileInfo.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_coord_ratio;\nuniform mediump vec2 u_delta;\nuniform mediump vec2 u_dimensions;\nvarying mediump vec2 v_tex;\nvoid main() {\n  mediump vec2 offset \x3d u_coord_ratio * vec2(u_delta + a_pos * u_dimensions);\n  vec3 v_pos \x3d u_dvsMat3 * vec3(offset, 1.0);\n  gl_Position \x3d vec4(v_pos.xy, 0.0, 1.0);\n  v_tex \x3d a_pos;\n}"},util:{"encoding.glsl":"const vec4 rgba2float_factors \x3d vec4(\n    255.0 / (256.0),\n    255.0 / (256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n  );\nfloat rgba2float(vec4 rgba) {\n  return dot(rgba, rgba2float_factors);\n}"}}})},
"esri/views/2d/engine/webgl/shaders/TileInfoPrograms":function(){define(["require","exports","./sources/resolver"],function(b,c,e){Object.defineProperty(c,"__esModule",{value:!0});c.tileInfo={name:"tileInfo",shaders:{vertexShader:e.resolveIncludes("tileInfo/tileInfo.vert"),fragmentShader:e.resolveIncludes("tileInfo/tileInfo.frag")},attributes:{a_pos:0}}})},"esri/views/2d/engine/webgl/brushes/WGLBrushStencil":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ./WGLBrush ../shaders/BackgroundPrograms".split(" "),
function(b,c,e,g,f,a,n){Object.defineProperty(c,"__esModule",{value:!0});b=function(a){function d(){var d=null!==a&&a.apply(this,arguments)||this;d._color=g.vec4f32.fromValues(1,0,0,1);d._initialized=!1;return d}e(d,a);d.prototype.dispose=function(){this._solidProgram&&(this._solidProgram.dispose(),this._solidProgram=null);this._solidVertexArrayObject&&(this._solidVertexArrayObject.dispose(),this._solidVertexArrayObject=null)};d.prototype.prepareState=function(a,d){a=a.context;a.setDepthWriteEnabled(!1);
a.setDepthTestEnabled(!1);a.setStencilTestEnabled(!0);a.setBlendingEnabled(!1);a.setColorMask(!1,!1,!1,!1);a.setStencilOp(7680,7680,7681);a.setStencilWriteMask(255);a.setStencilFunctionSeparate(1032,516,d.stencilRef,255)};d.prototype.draw=function(a,d){a=a.context;this._initialized||this._initialize(a);a.bindVAO(this._solidVertexArrayObject);a.bindProgram(this._solidProgram);this._solidProgram.setUniformMatrix3fv("u_dvsMat3",d.transforms.dvs);this._solidProgram.setUniform2fv("u_coord_range",d.coordRange);
this._solidProgram.setUniform1f("u_depth",0);this._solidProgram.setUniform4fv("u_color",this._color);a.drawArrays(5,0,4);a.bindVAO()};d.prototype._initialize=function(a){if(this._initialized)return!0;var d=f.createProgram(a,n.background);if(!d)return!1;var b=new Int8Array([0,0,1,0,0,1,1,1]),b=f.BufferObject.createVertex(a,35044,b);a=new f.VertexArrayObject(a,n.background.attributes,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},{geometry:b});this._solidProgram=
d;this._solidVertexArrayObject=a;return this._initialized=!0};return d}(a.default);c.default=b})},"esri/views/2d/engine/RasterTile":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ./RasterBitmap ./webgl/TiledDisplayObject".split(" "),function(b,c,e,g,f,a){Object.defineProperty(c,"__esModule",{value:!0});b=function(a){function b(d,b,c,e){void 0===e&&(e=null);var l=a.call(this,d,b,c)||this;d=l.requestRender.bind(l);l.bitmap=new f.RasterBitmap(e,
null,null,d);l.bitmap.coordScale=c;l.bitmap.once("isReady",function(){return l.ready()});return l}e(b,a);Object.defineProperty(b.prototype,"stencilRef",{get:function(){return this.bitmap.stencilRef},set:function(a){this.bitmap.stencilRef=a},enumerable:!0,configurable:!0});b.prototype.setTransform=function(d,b){a.prototype.setTransform.call(this,d,b);this.bitmap.transforms.dvs=this.transforms.dvs};b.prototype.attach=function(){this.bitmap.stage=this.stage;var a=this.bitmap.attach();a&&(this.bitmap.attached=
!0);return a};b.prototype.detach=function(){this.bitmap.detach()};return b}(a.TiledDisplayObject);c.RasterTile=b})},"esri/views/2d/engine/RasterBitmap":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/assignHelper ../../../core/libs/gl-matrix-2/mat3 ../../../core/libs/gl-matrix-2/mat3f32 ../../../core/libs/gl-matrix-2/vec2f32 ../../../layers/support/rasterFunctions/pixelUtils ./DisplayObject ./webgl/WGLRasterUtils".split(" "),function(b,c,e,g,f,a,n,
k,d,l){function t(a){w.has(a)&&(x.splice(x.indexOf(a),1),w.delete(a))}Object.defineProperty(c,"__esModule",{value:!0});var x=[],w=new Set,m={bandCount:3,outMin:0,outMax:1,minCutOff:[0,0,0],maxCutOff:[255,255,255],factor:[1/255,1/255,1/255],useGamma:!1,gamma:[1,1,1],gammaCorrection:[1,1,1],colormap:null,colormapOffset:null,type:"stretch"};b=function(d){function b(b,c,e,h){void 0===b&&(b=null);void 0===c&&(c=null);void 0===e&&(e=null);void 0===h&&(h=function(){return null});var l=d.call(this)||this;
l.stencilRef=0;l.coordScale=[1,1];l._symbolizerParameters=null;l.height=null;l.pixelRatio=1;l.resolution=0;l.rotation=0;l._source=null;l.rawPixelBlock=null;l._suspended=!1;l._bandIds=null;l._interpolation=null;l._transformGrid=null;l.width=null;l.x=0;l.y=0;l.transforms={dvs:a.mat3f32.create()};l.source=b;l.transformGrid=c;l.interpolation=e;l.requestRender=h;return l}e(b,d);Object.defineProperty(b.prototype,"symbolizerParameters",{get:function(){return this._symbolizerParameters||m},set:function(a){this._symbolizerParameters=
a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"source",{get:function(){return this._source},set:function(a){this._source=a;this._rasterTexture&&(this._rasterTexture.dispose(),this._rasterTexture=null)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"suspended",{get:function(){return this._suspended},set:function(a){this._suspended&&!a&&this.attached&&(this.ready(),this.requestRender());this._suspended=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"bandIds",{get:function(){return this._bandIds},set:function(a){this.attached&&this._updateRasterTexture(a);this._bandIds=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"interpolation",{get:function(){return this._interpolation},set:function(a){this._interpolation=a;this._rasterTexture&&this._rasterTexture.setSamplingMode("bilinear"===a?9729:9728)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"transformGrid",{get:function(){return this._transformGrid},set:function(a){this._transformGrid=
a;this._transformGridTexture&&(this._transformGridTexture.dispose(),this._transformGridTexture=null)},enumerable:!0,configurable:!0});b.prototype.attach=function(){this.updateTexture();return!0};b.prototype.detach=function(){this._rasterTexture&&(this._rasterTexture.dispose(),this._rasterTexture=null);this._transformGridTexture&&(this._transformGridTexture.dispose(),this._transformGridTexture=null);this._colormapTexture&&(this._colormapTexture.dispose(),this._colormapTexture=null);t(this)};b.prototype.invalidateTexture=
function(){this.attached?this.updateTexture():t(this)};b.prototype.setTransform=function(a){var d=f.mat3.identity(this.transforms.dvs),b=a.toScreenNoRotation([0,0],this.x,this.y),c=this.resolution/this.pixelRatio/a.resolution,e=c*this.width,c=c*this.height,l=Math.PI*this.rotation/180;f.mat3.translate(d,d,n.vec2f32.fromValues(b[0],b[1]));f.mat3.translate(d,d,n.vec2f32.fromValues(e/2,c/2));f.mat3.rotate(d,d,-l);f.mat3.translate(d,d,n.vec2f32.fromValues(-e/2,-c/2));f.mat3.scaleByVec2(d,d,n.vec2f32.fromValues(e,
c));f.mat3.multiply(this.transforms.dvs,a.displayViewMat3,d)};b.prototype.updateTexture=function(){var a=this.stage.context,d=this.source,d=d&&d.pixels&&0<d.pixels.length;!this._rasterTexture&&d&&this._updateRasterTexture(this.bandIds);this._rasterTexture&&d&&(this._updateColormapTexture(),this.transformGrid&&!this._transformGridTexture&&(this._transformGridTexture=l.createTransformTexture(a,this.transformGrid)));this._rasterTexture&&!d&&this._rasterTexture.setData(null);this.suspended||(this.ready(),
this.requestRender())};b.prototype.getUniforms=function(){var a=this.source,d=this.transformGrid,b;switch(this.symbolizerParameters.type){case "lut":b=this._getColormapUniforms();break;case "stretch":b=this._getStretchUniforms()}a=g({},b,{u_srcImageSize:[a.width,a.height],u_resampling:"nearest",u_flipY:!0,u_applyTransform:d?!0:!1,u_dvsMat3:this.transforms.dvs});this.transformGrid&&(a.u_transformSpacing=d.spacing,a.u_transformGridSize=d.size,a.u_targetImageSize=new Float32Array([this.width,this.height]));
return a};b.prototype.getTextures=function(){if(!this._rasterTexture)return null;var a=[],d=[];this._transformGridTexture&&(d.push(this._transformGridTexture),a.push("u_transformGrid"));this._rasterTexture&&(d.push(this._rasterTexture),a.push("u_image"));this._colormapTexture&&(d.push(this._colormapTexture),a.push("u_colormap"));return{names:a,textures:d}};b.prototype._getColormapUniforms=function(){var a=this.symbolizerParameters;return{u_colormapOffset:a.colormapOffset||0,u_colormapMaxIndex:a.colormap.length/
4-1,u_isFloatTexture:!1}};b.prototype._getStretchUniforms=function(){var a=this.symbolizerParameters,d={u_bandCount:a.bandCount,u_minOutput:a.outMin,u_maxOutput:a.outMax,u_minCutOff:a.minCutOff,u_maxCutOff:a.maxCutOff,u_factor:a.factor,u_useGamma:a.useGamma,u_gamma:a.gamma,u_gammaCorrection:a.gammaCorrection,u_contrast:a.contrast,u_brightness:a.brightness};a.colormap&&(d.u_colormapOffset=a.colormapOffset||0,d.u_colormapMaxIndex=a.colormap.length/4-1,d.u_isFloatTexture=!1,d.u_applyColormap=!0);return d};
b.prototype._updateRasterTexture=function(a){var d=this.source?k.extractBands(this.source,a):null;if(d&&d.pixels&&0<d.pixels.length){a=null==a&&null==this.bandIds||a&&this.bandIds&&a.join("")===this.bandIds.join("");if(this._rasterTexture){if(a)return;this._rasterTexture.dispose();this._rasterTexture=null}this._rasterTexture=l.createRasterTexture(this.stage.context,d,this.interpolation||"nearest")}else this._rasterTexture&&(this._rasterTexture.dispose(),this._rasterTexture=null)};b.prototype._updateColormapTexture=
function(){var a=this._colormap,d=this.symbolizerParameters.colormap;if(d){var b=this.stage.context;if(!a)this._colormapTexture=l.createColormapTexture(b,d),this._colormap=d;else if(d.length!==a.length||d.some(function(d,b){return d!==a[b]}))this._colormapTexture&&(this._colormapTexture.dispose(),this._colormapTexture=null),this._colormapTexture=l.createColormapTexture(b,d),this._colormap=d}else this._colormapTexture&&(this._colormapTexture.dispose(),this._colormapTexture=null),this._colormap=null};
return b}(d.DisplayObject);c.RasterBitmap=b})},"esri/layers/support/rasterFunctions/pixelUtils":function(){define(["require","exports","../PixelBlock"],function(b,c,e){function g(a,d){a=Math.min(Math.max(a,-100),100);d=Math.min(Math.max(d,-100),100);var b,c,e=new Uint8Array(256);for(b=0;256>b;b++)0<a&&100>a?c=(200*b-25500+510*d)/(2*(100-a))+128:0>=a&&-100<a?c=(200*b-25500+510*d)*(100+a)/2E4+128:100===a?(c=200*b-25500+256*(100-a)+510*d,c=0<c?255:0):-100===a&&(c=128),e[b]=255<c?255:0>c?0:c;return e}
function f(a,d,b,c,e,f,m,g){return{xmin:e<=b*a?0:e<b*a+a?e-b*a:a,ymin:f<=c*d?0:f<c*d+d?f-c*d:d,xmax:e+m<=b*a?0:e+m<b*a+a?e+m-b*a:a,ymax:f+g<=c*d?0:f+g<c*d+d?f+g-c*d:d}}function a(a,d,b,c){var l=a.filter(function(a){return n(a)})[0];if(null==l)return null;var k=c?c.width:d.width;c=c?c.height:d.height;var m=l.width,g=l.height,q=d.width/m;d=d.height/g;var t=b?b.x:0;b=b?b.y:0;var p=l.pixelType,r=e.getPixelArrayConstructor(p),h=l.pixels.length,l=[],y,u,D,B,C,A,I,E,H,F;for(C=0;C<h;C++){u=new r(k*c);for(A=
0;A<d;A++)for(I=0;I<q;I++)if(D=a[A*q+I])for(y=D.pixels[C],F=f(m,g,I,A,t,b,k,c),E=F.ymin;E<F.ymax;E++)for(D=(A*g+E-b)*k+(I*m-t),B=E*m,H=F.xmin;H<F.xmax;H++)u[D+H]=y[B+H];l.push(u)}var L;if(a.some(function(a){return null==a||a.mask&&0<a.mask.length}))for(L=new Uint8Array(k*c),A=0;A<d;A++)for(I=0;I<q;I++)if(r=(D=a[A*q+I])?D.mask:null,F=f(m,g,I,A,t,b,k,c),r)for(E=F.ymin;E<F.ymax;E++)for(D=(A*g+E-b)*k+(I*m-t),B=E*m,H=F.xmin;H<F.xmax;H++)L[D+H]=r[B+H];else if(D)for(E=F.ymin;E<F.ymax;E++)for(D=(A*g+E-b)*
k+(I*m-t),B=E*m,H=F.xmin;H<F.xmax;H++)L[D+H]=1;else for(E=F.ymin;E<F.ymax;E++)for(D=(A*g+E-b)*k+(I*m-t),B=E*m,H=F.xmin;H<F.xmax;H++)L[D+H]=0;a=new e({width:k,height:c,pixels:l,pixelType:p,mask:L});a.updateStatistics();return a}Object.defineProperty(c,"__esModule",{value:!0});var n=function(a){return a&&"esri.layers.support.PixelBlock"===a.declaredClass&&a.pixels&&0<a.pixels.length};c.extractBands=function(a,d){if(!d||!n(a))return a;var b=a.pixels.length;return d&&d.some(function(a){return a>=b})||
1===b&&1===d.length&&0===d[0]||b===d.length&&!d.some(function(a,d){return a!==d})?a:new e({pixelType:a.pixelType,width:a.width,height:a.height,mask:a.mask,validPixelCount:a.validPixelCount,maskIsAlpha:a.maskIsAlpha,pixels:d.map(function(d){return a.pixels[d]}),statistics:a.statistics&&d.map(function(d){return a.statistics[d]})})};c.createColormapLUT=function(a){if(a){var d=a.colormap;if(d&&0!==d.length){var d=d.sort(function(a,d){return a[0]-d[0]}),b=0;0>d[0][0]&&(b=d[0][0]);var c=Math.max(256,d[d.length-
1][0]-b+1),e=new Uint8Array(4*c),f=[],m=0,k=0,q=5===d[0].length;if(65536<c)return d.forEach(function(a){f[a[0]-b]=q?a.slice(1):a.slice(1).concat([255])}),{indexed2DColormap:f,offset:b,alphaSpecified:q};if(a.fillUnspecified)for(a=d[k],m=a[0]-b;m<c;m++)e[4*m]=a[1],e[4*m+1]=a[2],e[4*m+2]=a[3],e[4*m+3]=q?a[4]:255,m===a[0]-b&&(a=k===d.length-1?a:d[++k]);else for(m=0;m<d.length;m++)a=d[m],k=4*(a[0]-b),e[k]=a[1],e[k+1]=a[2],e[k+2]=a[3],e[k+3]=q?a[4]:255;return{indexedColormap:e,offset:b,alphaSpecified:q}}}};
c.colorize=function(a,d){if(!n(a)||!d&&(d.indexedColormap||d.indexed2DColormap))return a;var b=a.clone(),c=b.pixels,e=b.mask,f=b.width*b.height;if(1!==c.length)return a;var m=d.indexedColormap;a=d.indexed2DColormap;var k=d.offset;d=d.alphaSpecified;var q=m.length-1,g=0,c=c[0],p=new Uint8Array(c.length),r=new Uint8Array(c.length),h=new Uint8Array(c.length),y=0;if(m)if(e)for(g=0;g<f;g++)e[g]&&(y=4*(c[g]-k),y<k||y>q?e[g]=0:(p[g]=m[y],r[g]=m[y+1],h[g]=m[y+2],e[g]=m[y+3]));else{e=new Uint8Array(f);for(g=
0;g<f;g++)y=4*(c[g]-k),y<k||y>q?e[g]=0:(p[g]=m[y],r[g]=m[y+1],h[g]=m[y+2],e[g]=m[y+3]);b.mask=e}else if(e)for(g=0;g<f;g++)e[g]&&(m=a[c[g]],p[g]=m[0],r[g]=m[1],h[g]=m[2],e[g]=m[3]);else{e=new Uint8Array(f);for(g=0;g<f;g++)m=a[c[g]],p[g]=m[0],r[g]=m[1],h[g]=m[2],e[g]=m[3];b.mask=e}b.pixels=[p,r,h];b.statistics=null;b.pixelType="u8";b.maskIsAlpha=d;return b};c.estimateStatisticsHistograms=function(a){if(!n(a))return null;a.statistics||a.updateStatistics();var d=a.pixels,b=a.mask,c=a.pixelType,e=a.statistics;
a=a.width*a.height;var f=d.length,m,g,q,k,p,r=[],h=[],y,u,D;for(k=0;k<f;k++){y=new Uint32Array(256);D=d[k];if("u8"===c)if(m=-.5,g=255.5,b)for(p=0;p<a;p++)b[p]&&y[D[p]]++;else for(p=0;p<a;p++)y[D[p]]++;else{m=e[k].minValue;g=e[k].maxValue;q=(g-m)/256;u=new Uint32Array(257);if(b)for(p=0;p<a;p++)b[p]&&u[Math.floor((D[p]-m)/q)]++;else for(p=0;p<a;p++)u[Math.floor((D[p]-m)/q)]++;for(p=0;255>p;p++)y[p]=u[p];y[255]=u[255]+u[256]}r.push({min:m,max:g,size:256,counts:y});for(p=D=u=q=0;256>p;p++)q+=y[p],u+=
p*y[p];u/=q;for(p=0;256>p;p++)D+=y[p]*Math.pow(p-u,2);y=Math.sqrt(D/(q-1));q=(g-m)/256;p=(u+.5)*q+m;y*=q;h.push({min:m,max:g,avg:p,stddev:y})}return{statistics:h,histograms:r}};c.createStretchLUT=function(a){var d=a.minCutOff,b=a.maxCutOff,c=a.gamma,e=a.pixelType,f=a.outMin||0,m=a.outMax||255;if(-1===["u8","u16","s8","s16"].indexOf(e))return null;var k=d.length,q,n=0;"s8"===e?n=-127:"s16"===e&&(n=-32767);var p=256;-1<["u16","s16"].indexOf(e)&&(p=65536);for(var r=[],h=m-f,e=0;e<k;e++)r[e]=b[e]-d[e];
q=c&&c.length>=k;var y=[];if(q)for(e=0;e<k;e++)y[e]=1<c[e]?2<c[e]?6.5+Math.pow(c[e]-2,2.5):6.5+100*Math.pow(2-c[e],4):1;var u,D=[],B,C,A;if(q)for(e=0;e<k;e++){A=[];for(q=0;q<p;q++)B=q+n,u=(B-d[e])/r[e],C=1,1<c[e]&&(C-=Math.pow(1/h,u*y[e])),A[q]=B<b[e]&&B>d[e]?Math.floor(C*h*Math.pow(u,1/c[e]))+f:B>=b[e]?m:f;D[e]=A}else for(e=0;e<k;e++){A=[];for(q=0;q<p;q++)B=q+n,A[q]=B<=d[e]?f:B>=b[e]?m:Math.floor((B-d[e])/r[e]*h)+f;D[e]=A}if(null!=a.contrastOffset)for(a=g(a.contrastOffset,a.brightnessOffset),e=0;e<
k;e++)for(A=D[e],q=0;q<p;q++)A[q]=a[A[q]];return{lut:D,offset:n}};c.createContrastBrightnessLUT=g;c.stretch=function(a,d){if(!n(a))return null;a=a.clone();var b=a.pixels,c=a.mask,e=d.minCutOff,f=d.maxCutOff,m=d.gamma,g=d.outMin||0;d=d.outMax||255;var q=a.width*a.height,k=b.length,p,r,h,y,u,D=d-g,B=[];for(p=0;p<k;p++)B[p]=f[p]-e[p];r=m&&m.length>=k;var C=[];if(r)for(p=0;p<k;p++)C[p]=1<m[p]?2<m[p]?6.5+Math.pow(m[p]-2,2.5):6.5+100*Math.pow(2-m[p],4):1;if(r)if(null!=c)for(r=0;r<q;r++){if(c[r])for(p=0;p<
k;p++)h=b[p][r],u=(h-e[p])/B[p],y=1,1<m[p]&&(y-=Math.pow(1/D,u*C[p])),b[p][r]=h<f[p]&&h>e[p]?Math.floor(y*D*Math.pow(u,1/m[p]))+g:h>=f[p]?d:g}else for(r=0;r<q;r++)for(p=0;p<k;p++)h=b[p][r],u=(h-e[p])/B[p],y=1,1<m[p]&&(y-=Math.pow(1/D,u*C[p])),b[p][r]=h<f[p]&&h>e[p]?Math.floor(y*D*Math.pow(u,1/m[p]))+g:h>=f[p]?d:g;else if(null!=c)for(r=0;r<q;r++){if(c[r])for(p=0;p<k;p++)h=b[p][r],b[p][r]=h<f[p]&&h>e[p]?Math.floor((h-e[p])/B[p]*D)+g:h>=f[p]?d:g}else for(r=0;r<q;r++)for(p=0;p<k;p++)h=b[p][r],b[p][r]=
h<f[p]&&h>e[p]?Math.floor((h-e[p])/B[p]*D)+g:h>=f[p]?d:g;a.pixelType="u8";a.updateStatistics();return a};c.lookupPixels=function(a,d){if(!n(a))return null;var b=a.pixels,c=a.mask,f=a.width*a.height,g=b.length,m=d.lut;d=d.offset;var k,q;m&&1===m[0].length&&(m=b.map(function(){return m}));var v=[],p,r,h;if(d)if(null==c)for(k=0;k<g;k++){p=b[k];r=m[k];h=new Uint8Array(f);for(q=0;q<f;q++)h[q]=r[p[q]-d];v.push(h)}else for(k=0;k<g;k++){p=b[k];r=m[k];h=new Uint8Array(f);for(q=0;q<f;q++)c[q]&&(h[q]=r[p[q]-
d]);v.push(h)}else if(null==c)for(k=0;k<g;k++){p=b[k];r=m[k];h=new Uint8Array(f);for(q=0;q<f;q++)h[q]=r[p[q]];v.push(h)}else for(k=0;k<g;k++){p=b[k];r=m[k];h=new Uint8Array(f);for(q=0;q<f;q++)c[q]&&(h[q]=r[p[q]]);v.push(h)}a=new e({width:a.width,height:a.height,pixels:v,mask:c,pixelType:"u8"});a.updateStatistics();return a};c.remapColor=function(a,d){if(!n(a))return null;a=a.clone();var b=a.width*a.height,c=d.length,e=Math.floor(c/2),f=d[Math.floor(e)],m=a.pixels[0],g,q,k,p,r,h,y=!1,u=new Uint8Array(b),
D=new Uint8Array(b),B=new Uint8Array(b),C=a.mask,A=4===d[0].mappedColor.length;C||(C=new Uint8Array(b),C.fill(A?255:1),a.mask=C);for(r=0;r<b;r++)if(C[r]){g=m[r];y=!1;h=e;q=f;k=0;for(p=c-1;1<p-k;){if(g===q.value){y=!0;break}g>q.value?k=h:p=h;h=Math.floor((k+p)/2);q=d[Math.floor(h)]}y||(g===d[k].value?(q=d[k],y=!0):g===d[p].value?(q=d[p],y=!0):g<d[k].value?(y=!1,q=null):g>d[k].value&&(g<d[p].value?(q=d[k],y=!0):p===c-1?(y=!1,q=null):(q=d[p],y=!0)));y?(u[r]=q.mappedColor[0],D[r]=q.mappedColor[1],B[r]=
q.mappedColor[2],C[r]=q.mappedColor[3]):u[r]=D[r]=B[r]=C[r]=0}a.pixels=[u,D,B];a.mask=C;a.pixelType="u8";a.maskIsAlpha=A;return a};c.getClipBounds=f;c.mosaicPixelData=function(b,d){if(!b||0===b.length)return null;var c=b.filter(function(a){return a.pixelBlock})[0];if(!c)return null;var e=(c.extent.xmax-c.extent.xmin)/c.pixelBlock.width,f=(c.extent.ymax-c.extent.ymin)/c.pixelBlock.height,g=.01*Math.min(e,f),m=b.sort(function(a,d){return Math.abs(a.extent.ymax-d.extent.ymax)>g?d.extent.ymax-a.extent.ymax:
Math.abs(a.extent.xmin-d.extent.xmin)>g?a.extent.xmin-d.extent.xmin:0}),k=Math.min.apply(null,m.map(function(a){return a.extent.xmin})),q=Math.min.apply(null,m.map(function(a){return a.extent.ymin})),n=Math.max.apply(null,m.map(function(a){return a.extent.xmax})),p=Math.max.apply(null,m.map(function(a){return a.extent.ymax}));b={x:Math.round((d.xmin-k)/e),y:Math.round((p-d.ymax)/f)};k={width:Math.round((n-k)/e),height:Math.round((p-q)/f)};e={width:Math.round((d.xmax-d.xmin)/e),height:Math.round((d.ymax-
d.ymin)/f)};if(Math.round(k.width/c.pixelBlock.width)*Math.round(k.height/c.pixelBlock.height)!==m.length||0>b.x||0>b.y||k.width<e.width||k.height<e.height)return null;c=m.map(function(a){return a.pixelBlock});c=a(c,k,b,e);return{extent:d,pixelBlock:c}};c.mosaic=a;c.setValidBoundary=function(a,d,b){if(!n(a))return null;var c=a.width,e=a.height,f=d.x;d=d.y;var l=b.width+f;b=b.height+d;if(0>f||0>d||l>c||b>e||0===f&&0===d&&l===c&&b===e)return a;a.mask||(a.mask=new Uint8Array(c*e));for(var g=a.mask,q=
0;q<e;q++)for(var k=q*c,p=0;p<c;p++)g[k+p]=q<d||q>=b||p<f||p>=l?0:1;a.updateStatistics();return a};c.clip=function(a,d,b){if(!n(a))return null;var c=d.x,f=d.y,l=d.x+b.width;d=d.x+b.height;if(d===a.height&&l===a.width)return a;for(var m=a.pixels,g=a.mask,q=a.width,k=q*a.height,p=m.length,r=[],h=0;h<p;h++){for(var y=m[h],u=e.createEmptyBand(a.pixelType,k),D=0,B=f;B<=d;B++)for(var C=B*q,A=c;A<=l;A++)u[D++]=y[C+A];r.push(u)}var I;if(g)for(I=new Uint8Array(b.width*b.height),D=0,B=f;B<=d;B++)for(C=B*q,
A=c;A<=l;A++)I[D++]=g[C+A];a=new e({width:b.width,height:b.height,pixels:r,mask:I});a.updateStatistics();return a};c.approximateTransform=function(a,d,b,c){if(!n(a))return null;var f=a.pixels,l=a.mask,m=a.pixelType,g=a.width,q=a.height;a=e.getPixelArrayConstructor(m);var k=f.length,p=d.width,r=d.height;d=c.cols;var h=c.rows,t=Math.ceil(p/d),u=Math.ceil(r/h),D=!1;for(c=0;c<b.length;c+=3)-1===b[c]&&-1===b[c+1]&&-1===b[c+2]&&(D=!0);var B,C,A,I,E,H,F,L=new Float32Array(p*r),J=new Float32Array(p*r),G=
0,N,M;for(c=0;c<u;c++)for(var K=0;K<t;K++){B=12*(c*t+K);C=b[B];A=b[B+1];I=b[B+2];E=b[B+3];H=b[B+4];F=b[B+5];for(var O=0;O<h;O++){G=(c*h+O)*p+K*d;M=(O+.5)/h;for(var Q=0;Q<O;Q++)N=(Q+.5)/d,L[G+Q]=Math.round((C*N+A*M+I)*g-.5),J[G+Q]=Math.round((E*N+H*M+F)*q-.5)}B+=6;C=b[B];A=b[B+1];I=b[B+2];E=b[B+3];H=b[B+4];F=b[B+5];for(O=0;O<h;O++)for(G=(c*h+O)*p+K*d,M=(O+.5)/h,Q=O;Q<d;Q++)N=(Q+.5)/d,L[G+Q]=Math.round((C*N+A*M+I)*g-.5),J[G+Q]=Math.round((E*N+H*M+F)*q-.5)}b=function(a,d){for(var b=0;b<r;b++){B=b*p;
for(var c=0;c<p;c++)a[B]=D&&(0>L[B]||0>J[B])?0:d[L[B]+J[B]*g],B++}};q=[];for(c=0;c<k;c++)d=new a(p*r),b(d,f[c]),q.push(d);f=new e({width:p,height:r,pixelType:m,pixels:q});if(l)f.mask=new Uint8Array(p*r),b(f.mask,l);else if(D)for(f.mask=new Uint8Array(p*r),c=0;c<p*r;c++)f.mask[c]=0>L[c]||0>J[c]?0:1;f.updateStatistics();return f}})},"esri/layers/support/PixelBlock":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/compilerUtils ../../core/Error ../../core/JSONSupport ../../core/lang ../../core/Logger ../../core/accessorSupport/decorators".split(" "),
function(b,c,e,g,f,a,n,k,d,l){var t=d.getLogger("esri.layers.support.PixelBlock");return function(d){function b(a){a=d.call(this,a)||this;a.width=null;a.height=null;a.pixelType="f32";a.validPixelCount=null;a.mask=null;a.maskIsAlpha=!1;a.pixels=null;a.statistics=null;return a}e(b,d);c=b;b.createEmptyBand=function(a,d){return new (c.getPixelArrayConstructor(a))(d)};b.getPixelArrayConstructor=function(a){var d;switch(a){case "u1":case "u2":case "u4":case "u8":d=Uint8Array;break;case "u16":d=Uint16Array;
break;case "u32":d=Uint32Array;break;case "s8":d=Int8Array;break;case "s16":d=Int16Array;break;case "s32":d=Int32Array;break;case "u32":d=Uint32Array;break;case "f32":d=Float32Array;break;case "f64":d=Float64Array;break;case "c64":case "c128":case "unknown":d=Float32Array;break;default:f.neverReached(a)}return d};b.prototype.castPixelType=function(a){if(!a)return"f32";a=a.toLowerCase();-1<["u1","u2","u4"].indexOf(a)?a="u8":-1==="unknown u8 s8 u16 s16 u32 s32 f32 f64".split(" ").indexOf(a)&&(a="f32");
return a};b.prototype.getPlaneCount=function(){return this.pixels&&this.pixels.length};b.prototype.addData=function(d){if(!d.pixels||d.pixels.length!==this.width*this.height)throw new a("pixelblock:invalid-or-missing-pixels","add data requires valid pixels array that has same length defined by pixel block width * height");this.pixels||(this.pixels=[]);this.statistics||(this.statistics=[]);this.pixels.push(d.pixels);this.statistics.push(d.statistics||{minValue:null,maxValue:null})};b.prototype.getAsRGBA=
function(){var a=new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case "s8":case "s16":case "u16":case "s32":case "u32":case "f32":case "f64":this._fillFromNon8Bit(a);break;default:this._fillFrom8Bit(a)}return new Uint8ClampedArray(a)};b.prototype.getAsRGBAFloat=function(){var a=new Float32Array(this.width*this.height*4);this._fillFrom32Bit(a);return a};b.prototype.updateStatistics=function(){var a=this;this.statistics=this.pixels.map(function(d){return a._calculateBandStatistics(d,
a.mask)});var d=this.mask,b=0;if(d)for(var c=0;c<d.length;c++)d[c]&&b++;else b=this.width*this.height;this.validPixelCount=b};b.prototype.clamp=function(a){if(a&&"f64"!==a&&"f32"!==a){var d;switch(a){case "u8":d=[0,255];break;case "u16":d=[0,65535];break;case "u32":d=[0,4294967295];break;case "s8":d=[-128,127];break;case "s16":d=[-32768,32767];break;case "s32":d=[-2147483648,2147483647];break;default:d=[-3.4*1E39,3.4*1E39]}var b=d[0];d=d[1];for(var e=this.pixels,f=this.width*this.height,h=e.length,
l,m,g,k=[],n=0;n<h;n++){g=c.createEmptyBand(a,f);l=e[n];for(var w=0;w<f;w++)m=l[w],g[w]=m>d?d:m<b?b:m;k.push(g)}this.pixels=k;this.pixelType=a}};b.prototype.clone=function(){var a=new c({width:this.width,height:this.height,pixelType:this.pixelType,maskIsAlpha:this.maskIsAlpha,validPixelCount:this.validPixelCount});this.mask&&(a.mask=this.mask instanceof Uint8Array?new Uint8Array(this.mask):this.mask.slice(0));var d,b=c.getPixelArrayConstructor(this.pixelType);if(this.pixels&&0<this.pixels.length){a.pixels=
[];var e=this.pixels[0].slice;for(d=0;d<this.pixels.length;d++)a.pixels[d]=e?this.pixels[d].slice(0,this.pixels[d].length):new b(this.pixels[d])}if(this.statistics)for(a.statistics=[],d=0;d<this.statistics.length;d++)a.statistics[d]=k.clone(this.statistics[d]);return a};b.prototype._fillFrom8Bit=function(a){var d=this.mask,b=this.maskIsAlpha,c=this.pixels;if(a&&c&&c.length){var e,h,f;e=h=f=c[0];3<=c.length?(h=c[1],f=c[2]):2===c.length&&(h=c[1]);a=new Uint32Array(a);c=this.width*this.height;if(e.length!==
c)t.error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");else if(d&&d.length===c)if(b)for(b=0;b<c;b++)d[b]&&(a[b]=d[b]<<24|f[b]<<16|h[b]<<8|e[b]);else for(b=0;b<c;b++)d[b]&&(a[b]=-16777216|f[b]<<16|h[b]<<8|e[b]);else for(b=0;b<c;b++)a[b]=-16777216|f[b]<<16|h[b]<<8|e[b]}else t.error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")};b.prototype._fillFromNon8Bit=function(a){var d=this.pixels,b=this.mask,c=this.statistics;if(a&&d&&d.length){var e=this.pixelType,
h=1,f=0,h=1;c&&0<c.length?(f=c.map(function(a){return a.minValue}).reduce(function(a,d){return Math.min(a,d)}),h=c.map(function(a){return a.maxValue-a.minValue}).reduce(function(a,d){return Math.max(a,d)}),h=255/h):(h=255,"s8"===e?(f=-128,h=127):"u16"===e?h=65535:"s16"===e?(f=-32768,h=32767):"u32"===e?h=4294967295:"s32"===e?(f=-2147483648,h=2147483647):"f32"===e?(f=-3.4*1E39,h=3.4*1E39):"f64"===e&&(f=-Number.MAX_VALUE,h=Number.MAX_VALUE),h=255/(h-f));a=new Uint32Array(a);var e=this.width*this.height,
l,m,c=l=m=d[0];if(c.length!==e)return t.error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");if(2<=d.length)if(l=d[1],3<=d.length&&(m=d[2]),b&&b.length===e)for(d=0;d<e;d++)b[d]&&(a[d]=-16777216|(m[d]-f)*h<<16|(l[d]-f)*h<<8|(c[d]-f)*h);else for(d=0;d<e;d++)a[d]=-16777216|(m[d]-f)*h<<16|(l[d]-f)*h<<8|(c[d]-f)*h;else if(b&&b.length===e)for(d=0;d<e;d++)l=(c[d]-f)*h,b[d]&&(a[d]=-16777216|l<<16|l<<8|l);else for(d=0;d<e;d++)l=(c[d]-f)*h,a[d]=-16777216|l<<16|l<<8|l}else t.error("getAsRGBA()",
"Unable to convert to RGBA. The input pixel block is empty.")};b.prototype._fillFrom32Bit=function(a){var d=this.pixels,b=this.mask;if(!a||!d||!d.length)return t.error("getAsRGBAFloat()","Unable to convert to RGBA. The input pixel block is empty.");var c,e,h;c=e=h=d[0];3<=d.length?(e=d[1],h=d[2]):2===d.length&&(e=d[1]);var f=this.width*this.height;if(c.length!==f)return t.error("getAsRGBAFloat()","Unable to convert to RGBA. The pixelblock is invalid.");var l=0;if(b&&b.length===f)for(d=0;d<f;d++)a[l++]=
c[d],a[l++]=e[d],a[l++]=h[d],a[l++]=b[d]&1;else for(d=0;d<f;d++)a[l++]=c[d],a[l++]=e[d],a[l++]=h[d],a[l++]=1};b.prototype._calculateBandStatistics=function(a,d){var b=Infinity,c=-Infinity,e=a.length,h,f=0;if(d)for(h=0;h<e;h++)d[h]&&(f=a[h],b=f<b?f:b,c=f>c?f:c);else for(h=0;h<e;h++)f=a[h],b=f<b?f:b,c=f>c?f:c;return{minValue:b,maxValue:c}};var c;g([l.property({json:{write:!0}})],b.prototype,"width",void 0);g([l.property({json:{write:!0}})],b.prototype,"height",void 0);g([l.property({json:{write:!0}})],
b.prototype,"pixelType",void 0);g([l.cast("pixelType")],b.prototype,"castPixelType",null);g([l.property({json:{write:!0}})],b.prototype,"validPixelCount",void 0);g([l.property({json:{write:!0}})],b.prototype,"mask",void 0);g([l.property({json:{write:!0}})],b.prototype,"maskIsAlpha",void 0);g([l.property({json:{write:!0}})],b.prototype,"pixels",void 0);g([l.property({json:{write:!0}})],b.prototype,"statistics",void 0);return b=c=g([l.subclass("esri.layers.support.PixelBlock")],b)}(l.declared(n.JSONSupport))})},
"esri/views/2d/engine/webgl/WGLRasterUtils":function(){define(["require","exports","../../../webgl"],function(b,c,e){Object.defineProperty(c,"__esModule",{value:!0});c.createRasterTexture=function(b,c,a,n){void 0===a&&(a="nearest");void 0===n&&(n=!1);var f=!(n&&"u8"===c.pixelType);n=f?5126:5121;f=null==c.pixels||0===c.pixels.length?null:f?c.getAsRGBAFloat():c.getAsRGBA();return new e.Texture(b,{width:c.width,height:c.height,target:3553,pixelFormat:6408,internalFormat:6408,samplingMode:"bilinear"===
a?9729:9728,dataType:n,wrapMode:33071,flipped:!1},f)};c.createFrameBuffer=function(b,c,a,n){n=new e.Texture(b,{width:c,height:a,target:3553,pixelFormat:6408,internalFormat:6408,samplingMode:9728,dataType:n?5121:5126,wrapMode:33071,flipped:!1});return new e.FramebufferObject(b,{colorTarget:0,depthStencilTarget:3,width:c,height:a},n)};c.createTransformTexture=function(b,c){for(var a=4*c.size[0],f=c.size[1],g={width:a,height:f,target:3553,pixelFormat:6408,internalFormat:6408,dataType:5126,samplingMode:9728,
wrapMode:33071,flipped:!1},a=new Float32Array(a*f*4),d=f=0;d<c.coefficients.length;d++)a[f++]=c.coefficients[d],2===d%3&&(a[f++]=1);return new e.Texture(b,g,a)};c.createColormapTexture=function(b,c){return new e.Texture(b,{width:c.length/4,height:1,target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,flipped:!1},c)};c.getUniformInfos=function(b,c){b=b.gl;c=c.glName;for(var a=b.getProgramParameter(c,b.ACTIVE_UNIFORMS),e=new Map,f,d=0;d<a;d++)(f=b.getActiveUniform(c,
d))&&e.set(f.name,{location:b.getUniformLocation(c,f.name),info:f});return e};c.setUniforms=function(b,c,a,e){Object.keys(e).forEach(function(f){var d=a.get(f)||a.get(f+"[0]");if(d){var l=e[f];if(null!==d&&null!=l){var g=b.gl,d=d.info;switch(d.type){case g.FLOAT:1<d.size?c.setUniform1fv(f,l):c.setUniform1f(f,l);break;case g.FLOAT_VEC2:c.setUniform2fv(f,l);break;case g.FLOAT_VEC3:c.setUniform3fv(f,l);break;case g.FLOAT_VEC4:c.setUniform4fv(f,l);break;case g.FLOAT_MAT3:c.setUniformMatrix3fv(f,l);break;
case g.FLOAT_MAT4:c.setUniformMatrix4fv(f,l);break;case g.INT:case g.BOOL:1<d.size?c.setUniform1iv(f,l):c.setUniform1i(f,l);break;case g.INT_VEC2:case g.BOOL_VEC2:c.setUniform2iv(f,l);break;case g.INT_VEC3:case g.BOOL_VEC3:c.setUniform3iv(f,l);break;case g.INT_VEC4:case g.BOOL_VEC4:c.setUniform4iv(f,l)}}}})};c.setTextures=function(b,c,a,e){a.length===e.length&&(e.some(function(a){return null==a})||a.some(function(a){return null==a})||a.forEach(function(a,d){c.setUniform1i(a,d);b.bindTexture(e[d],
d)}))}})},"esri/views/2d/engine/RasterTileContainer":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../../../geometry/support/aaBoundingRect ../engine ./RasterTile ./webgl/enums ./webgl/TileContainer".split(" "),function(b,c,e,g,f,a,n,k,d){Object.defineProperty(c,"__esModule",{value:!0});b=function(d){function b(){return null!==d&&d.apply(this,arguments)||this}e(b,d);b.prototype.createTile=function(a){var d=this._tileInfoView.getTileBounds(f.create(),
a);return new n.RasterTile(a,d,this._tileInfoView.tileInfo.size)};b.prototype.destroyTile=function(){};b.prototype.prepareRenderPasses=function(b){var c=this,e=b.registerRenderPass({name:"bitmap (tile)",brushes:[a.brushes.Raster],target:function(){return c.children.map(function(a){return a.bitmap})},drawPhase:k.WGLDrawPhase.MAP});return d.prototype.prepareRenderPasses.call(this,b).concat([e])};b.prototype.doRender=function(a){this.visible&&a.drawPhase===k.WGLDrawPhase.MAP&&d.prototype.doRender.call(this,
a)};return b}(d.default);c.RasterTileContainer=b})},"esri/views/2d/engine/Stage":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/assignHelper ../../../core/Error ../../../core/events ../../../core/has ../../../core/promiseUtils ../../../core/scheduling ../../../core/watchUtils ../../../core/libs/gl-matrix-2/common ../../../core/libs/gl-matrix-2/mat2d ../../../core/libs/gl-matrix-2/mat2df64 ../../../core/libs/gl-matrix-2/vec2 ../../../core/libs/gl-matrix-2/vec2f64 ../../webgl ./Container ./webgl/BitBlitRenderer ./webgl/definitions ./webgl/enums ./webgl/Painter ./webgl/Profiler ./webgl/WebGLDriverTest ./webgl/shaders/StencilPrograms ../support/Timeline ../../support/screenshotUtils".split(" "),
function(b,c,e,g,f,a,n,k,d,l,t,x,w,m,z,q,v,p,r,h,y,u,D,B,C,A){Object.defineProperty(c,"__esModule",{value:!0});b=function(b){function c(c,e){var h=b.call(this)||this;h._renderParameters={drawPhase:0,state:h.state,pixelRatio:window.devicePixelRatio,stationary:!1,globalOpacity:1};h._clipData=new Float32Array(8);h._upperLeft=z.vec2f64.create();h._upperRight=z.vec2f64.create();h._lowerLeft=z.vec2f64.create();h._lowerRight=z.vec2f64.create();h._mat2=w.mat2df64.create();h._clipRendererInitialized=!1;h._supersampleScreenshots=
!0;h.dataUploadCounter=0;h.stage=h;h._stationary=!0;h.attached=!0;var l=e.canvas,l=void 0===l?document.createElement("canvas"):l,m=e.alpha,g=e.stencil,p=e.renderContext,r=e.supersampleScreenshots,r=void 0===r?!0:r,k=e.contextOptions,k=void 0===k?{}:k;h._canvas=l;m=q.createContextOrErrorHTML(l,{alpha:void 0===m?!0:m,antialias:!1,depth:!0,stencil:void 0===g?!0:g},void 0===p?"webgl":p);h.context=new q.RenderingContext(m,k);h.painter=new y.default(h.context,h);h._taskHandle=d.addFrameTask({render:function(){return h.renderFrame()}});
h._taskHandle.pause();h._supersampleScreenshots=r;h._lostWebGLContextHandle=a.on(l,"webglcontextlost",function(){h.emit("webgl-error",{error:new f("webgl-context-lost")})});n("esri-2d-profiler")&&(h._debugOutput=document.createElement("div"),h._debugOutput.setAttribute("style","margin: 24px 64px; position: absolute; color: red;"),c.appendChild(h._debugOutput));l.setAttribute("style","width: 100%; height:100%; display:block;");h.profiler=new u.Profiler(h.context,h._debugOutput);h.renderingOptions=
e.renderingOptions;h.timeline=e.timeline||new C.Timeline;h.driverTestResult=D.testWebGLDriver(h.context);c.appendChild(l);return h}e(c,b);c.prototype.destroy=function(){this.removeAllChildren();this.renderFrame();this._taskHandle.remove();this._boundFBO=this._taskHandle=null;this._clipFBO&&(this._clipFBO.dispose(),this._clipFBO=null);this._blitRenderer&&(this._blitRenderer.dispose(),this._blitRenderer=null);this._clipVAO&&(this._clipVAO.dispose(),this._clipVBO=this._clipVAO=null);this._clipStencilProgram&&
(this._clipStencilProgram.dispose(),this._clipStencilProgram=null);this._lostWebGLContextHandle&&(this._lostWebGLContextHandle.remove(),this._lostWebGLContextHandle=null);this._canvas.parentNode&&this._canvas.parentNode.removeChild(this._canvas);this._debugOutput&&this._debugOutput.parentNode&&this._debugOutput.parentNode.removeChild(this._debugOutput);this.painter.dispose();this.context.dispose();this._canvas=null};Object.defineProperty(c.prototype,"background",{get:function(){return this._background},
set:function(a){this._background=a;this.requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"highlightOptions",{get:function(){return this._highlightOptions},set:function(a){var d=this;this._highlightOptionsHandle&&(this._highlightOptionsHandle.remove(),this._highlightOptionsHandle=null);if(this._highlightOptions=a)this._highlightOptionsHandle=l.init(this._highlightOptions,"version",function(){d.painter.setHighlightOptions(a);d.requestRender()})},enumerable:!0,configurable:!0});
Object.defineProperty(c.prototype,"renderingOptions",{get:function(){return this._renderingOptions},set:function(a){this._renderingOptions=a;this.requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"state",{get:function(){return this._state},set:function(a){this._state=a;this.requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"stationary",{get:function(){return this._stationary},set:function(a){this._stationary!==a&&(this._stationary=
a,this.requestRender())},enumerable:!0,configurable:!0});c.prototype.requestRender=function(){this._lastRenderRequestTime=Date.now();this._taskHandle&&this._taskHandle.resume()};c.prototype.renderFrame=function(){Date.now()-this._lastRenderRequestTime>=r.MAX_ANIMATION_TIME_MS&&this._taskHandle.pause();this._renderParameters.state=this._state;this._renderParameters.stationary=this.stationary;this._renderParameters.pixelRatio=window.devicePixelRatio;this._renderParameters.globalOpacity=1;this.processRender(this._renderParameters)};
c.prototype.renderChildren=function(a){var d=this.context,b=this.children,b=a.children?a.children:b;this.profiler.recordStart("drawLayers");this.dataUploadCounter=0;this.beforeRenderChildren(a);a.drawPhase=h.WGLDrawPhase.MAP;this.painter.beforeRenderLayers(d);for(var c=0;c<b.length;c++){var e=b[c];e.attached&&e.processRender(a)}this.painter.renderLayers(d);a.drawPhase=h.WGLDrawPhase.LABEL;this.painter.beforeRenderLayers(d);for(c=0;c<b.length;c++)e=b[c],e.attached&&e.processRender(a);this.painter.renderLayers(d);
if(n("esri-tiles-debug")){a.drawPhase=h.WGLDrawPhase.DEBUG;this.painter.beforeRenderLayers(d);for(c=0;c<b.length;c++)e=b[c],e.attached&&e.processRender(a);this.painter.renderLayers(d)}this.profiler.recordEnd("drawLayers");this.afterRenderChildren()};c.prototype.beforeRenderChildren=function(a){var d=this.context,b=a.state,c=a.pixelRatio;if(this.painter){d.enforceState();var e=b.size;a=b.rotation;var h=Math.round(e[0]*c),e=Math.round(e[1]*c);this._boundFBO=d.getBoundFramebufferObject();if(b.spatialReference&&
(b.spatialReference._isWrappable?b.spatialReference._isWrappable():b.spatialReference.isWrappable)){var f=t.common.toRadian(a),l=Math.abs(Math.cos(f)),g=Math.abs(Math.sin(f)),p=Math.round(b.worldScreenWidth);if(Math.round(h*l+e*g)<=p)this._clipFrame=!1;else{this._clipFBO&&this._clipFBO.width===h&&this._clipFBO.height===e||(this._clipFBO=new q.FramebufferObject(d,{colorTarget:0,depthStencilTarget:3,width:h,height:e}));var r=(this.state.padding.left-this.state.padding.right)/2,u=(this.state.padding.bottom-
this.state.padding.top)/2,k=.5*h,n=.5*e,b=1/h,w=1/e,c=.5*p*c,v=.5*(h*g+e*l),h=this._upperLeft,l=this._upperRight,g=this._lowerLeft,p=this._lowerRight;m.vec2.set(h,-c,-v);m.vec2.set(l,c,-v);m.vec2.set(g,-c,v);m.vec2.set(p,c,v);x.mat2d.identity(this._mat2);x.mat2d.translate(this._mat2,this._mat2,[k+r,n+u]);0!==a&&x.mat2d.rotate(this._mat2,this._mat2,f);m.vec2.transformMat2d(h,h,this._mat2);m.vec2.transformMat2d(l,l,this._mat2);m.vec2.transformMat2d(g,g,this._mat2);m.vec2.transformMat2d(p,p,this._mat2);
a=this._clipData;a.set([2*g[0]*b-1,2*(e-g[1])*w-1,2*p[0]*b-1,2*(e-p[1])*w-1,2*h[0]*b-1,2*(e-h[1])*w-1,2*l[0]*b-1,2*(e-l[1])*w-1]);this._clipRendererInitialized||this._initializeClipRenderer(d);this._clipVBO.setData(a);this._boundFBO=d.getBoundFramebufferObject();d.bindFramebuffer(this._clipFBO);d.setDepthWriteEnabled(!0);d.setStencilWriteMask(255);d.setClearColor(0,0,0,0);d.setClearDepth(1);d.setClearStencil(0);d.clear(d.gl.COLOR_BUFFER_BIT|d.gl.DEPTH_BUFFER_BIT|d.gl.STENCIL_BUFFER_BIT);d.setDepthWriteEnabled(!1);
this._clipFrame=!0}}else this._clipFrame=!1}};c.prototype.afterRenderChildren=function(){var a=this.context;a.logIno();this._clipFrame&&this._clipRendererInitialized&&(a.bindFramebuffer(this._boundFBO),this._boundFBO=null,a.bindVAO(this._clipVAO),a.bindProgram(this._clipStencilProgram),a.setDepthWriteEnabled(!1),a.setDepthTestEnabled(!1),a.setStencilTestEnabled(!0),a.setBlendingEnabled(!1),a.setColorMask(!1,!1,!1,!1),a.setStencilOp(7680,7680,7681),a.setStencilWriteMask(255),a.setStencilFunction(519,
1,255),a.drawElements(4,6,5123,0),a.bindVAO(),a.setColorMask(!0,!0,!0,!0),a.setBlendingEnabled(!0),a.setStencilFunction(514,1,255),this._blitRenderer.render(a,this._clipFBO.colorTexture,9728,1),a.setStencilTestEnabled(!1))};c.prototype.doRender=function(a){var d=this.context,c=a.state,e=a.pixelRatio;this._resizeCanvas(a);this.context.enforceState();d.setViewport(0,0,e*c.size[0],e*c.size[1]);d.setDepthWriteEnabled(!0);d.setStencilWriteMask(255);this.background&&this.background.color?(c=this.background.color,
d.setClearColor(c.r/255,c.g/255,c.b/255,c.a)):d.setClearColor(0,0,0,0);d.setClearDepth(1);d.setClearStencil(0);d.clear(d.gl.COLOR_BUFFER_BIT|d.gl.DEPTH_BUFFER_BIT|d.gl.STENCIL_BUFFER_BIT);d.setDepthWriteEnabled(!1);b.prototype.doRender.call(this,a)};c.prototype.takeScreenshot=function(a,d){var b=A.screenshotSuperSampleSettings(a,this._supersampleScreenshots,this._state.padding),c=b.framebufferWidth,e=b.framebufferHeight,h=this.context,f=a.layers,l={drawPhase:null,globalOpacity:1,stationary:!0,state:this._renderParameters.state.clone(),
pixelRatio:b.pixelRatio};if(null!=a.rotation){var m=l.state.viewpoint;m.rotation=a.rotation;l.state.viewpoint=m}0<f.length&&(l.children=[],f.forEach(function(a){var b=d.find(function(d){return d.layer.id===a.id});b&&"container"in b&&b.container&&b.attached&&l.children.push(b.container)}));var g=new q.FramebufferObject(h,{colorTarget:0,depthStencilTarget:3,width:c,height:e}),f=h.getBoundFramebufferObject(),m=h.getViewport();h.bindFramebuffer(g);h.setViewport(0,0,c,e);c=h.gl;!a.ignoreBackground&&this.background&&
this.background.color?(e=this.background.color,h.setClearColor(e.r/255,e.g/255,e.b/255,e.a)):h.setClearColor(0,0,0,0);h.setClearDepth(1);h.setClearStencil(0);h.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT|c.STENCIL_BUFFER_BIT);this.renderChildren(l);b=this._readbackScreenshot(b);h.bindFramebuffer(f);h.setViewport(m.x,m.y,m.width,m.height);this.requestRender();h=this._ensureScreenshotEncodeCanvas();a=A.encodeResult(b,a,h,{flipY:!0,premultipliedAlpha:!0});return k.resolve(a)};c.prototype._ensureScreenshotEncodeCanvas=
function(){this._screenshotEncodeCanvas||(this._screenshotEncodeCanvas=document.createElement("canvas"));return this._screenshotEncodeCanvas};c.prototype._readbackScreenshot=function(a){var d=a.framebufferWidth,b=a.framebufferHeight,c=a.region;a=a.resample;var e=this.context.gl;if(a){var h=A.createEmptyImageData(d,b,this._ensureScreenshotEncodeCanvas());e.readPixels(0,0,d,b,6408,5121,new Uint8Array(h.data.buffer));d=A.createEmptyImageData(c.width,c.height,this._ensureScreenshotEncodeCanvas());return A.resampleHermite(h,
d,!0,a.region.x,b-(a.region.y+a.region.height),a.region.width,a.region.height)}h=A.createEmptyImageData(c.width,c.height,this._ensureScreenshotEncodeCanvas());e.readPixels(c.x,b-(c.y+c.height),c.width,c.height,6408,5121,new Uint8Array(h.data.buffer));return h};c.prototype._resizeCanvas=function(a){var d=this._canvas,b=d.style,c=a.state.size,e=a.pixelRatio;a=c[0];var c=c[1],h=Math.round(a*e),e=Math.round(c*e);if(d.width!==h||d.height!==e)d.width=h,d.height=e;b.width=a+"px";b.height=c+"px"};c.prototype._initializeClipRenderer=
function(a){if(this._clipRendererInitialized)return!0;this._blitRenderer=new p.BitBlitRenderer;var d=B.stencil.attributes,b=q.createProgram(a,B.stencil);if(!b)return!1;var c=q.BufferObject.createVertex(a,35040,32),e=new Uint16Array([0,1,2,2,1,3]),e=q.BufferObject.createIndex(a,35044,e);a=new q.VertexArrayObject(a,d,{geometry:[{name:"a_pos",count:2,type:5126,offset:0,stride:8,normalized:!1,divisor:0}]},{geometry:c},e);this._clipStencilProgram=b;this._clipVBO=c;this._clipVAO=a;return this._clipRendererInitialized=
!0};return c}(v.Container);c.Stage=b})},"esri/views/2d/engine/webgl/BitBlitRenderer":function(){define(["require","exports","../../../webgl","./shaders/BitBlitPrograms"],function(b,c,e,g){Object.defineProperty(c,"__esModule",{value:!0});b=function(){function b(){this._initialized=!1}b.prototype.dispose=function(){this._program&&(this._program.dispose(),this._program=null);this._vertexArrayObject&&(this._vertexArrayObject.dispose(),this._vertexArrayObject=null)};b.prototype.render=function(a,b,c,d){a&&
(this._initialized||this._initialize(a),a.setBlendFunctionSeparate(1,771,1,771),a.bindVAO(this._vertexArrayObject),a.bindProgram(this._program),b.setSamplingMode(c),a.bindTexture(b,0),this._program.setUniform1i("u_tex",0),this._program.setUniform1f("u_opacity",d),a.drawArrays(5,0,4),a.bindTexture(null,0),a.bindVAO())};b.prototype._initialize=function(a){if(this._initialized)return!0;var b=g.bitBlit.attributes,c=e.createProgram(a,g.bitBlit);if(!c)return!1;var d=new Int8Array(16);d[0]=-1;d[1]=-1;d[2]=
0;d[3]=0;d[4]=1;d[5]=-1;d[6]=1;d[7]=0;d[8]=-1;d[9]=1;d[10]=0;d[11]=1;d[12]=1;d[13]=1;d[14]=1;d[15]=1;a=new e.VertexArrayObject(a,b,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:4,normalized:!1,divisor:0},{name:"a_tex",count:2,type:5120,offset:2,stride:4,normalized:!1,divisor:0}]},{geometry:e.BufferObject.createVertex(a,35044,d)});this._program=c;this._vertexArrayObject=a;return this._initialized=!0};return b}();c.BitBlitRenderer=b})},"esri/views/2d/engine/webgl/shaders/BitBlitPrograms":function(){define(["require",
"exports","./sources/resolver"],function(b,c,e){Object.defineProperty(c,"__esModule",{value:!0});c.bitBlit={name:"bitBlit",shaders:{vertexShader:e.resolveIncludes("bitBlit/bitBlit.vert"),fragmentShader:e.resolveIncludes("bitBlit/bitBlit.frag")},attributes:{a_pos:0,a_tex:1}}})},"esri/views/2d/engine/webgl/definitions":function(){define(["require","exports"],function(b,c){Object.defineProperty(c,"__esModule",{value:!0});c.WEBGL_MAX_STOPS=8;c.WEBGL_MAX_INNER_STOPS=c.WEBGL_MAX_STOPS-2;c.NAN_MAGIC_NUMBER=
1E-30;c.EXTRUDE_SCALE=64;c.PICTURE_FILL_COLOR=4294967295;c.TILE_SIZE=512;c.RASTER_TILE_SIZE=256;c.ANGLE_FACTOR_256=256/360;c.DEBUG_LABELS=!1;c.COLLISION_BUCKET_SIZE=128;c.DOT_DENSITY_MAX_FIELDS=8;c.MAGIC_LABEL_LINE_HEIGHT=29;c.COLLISION_MAX_ZOOM_DELTA=1;c.COLLISION_EARLY_REJECT_BUCKET_SIZE=16;c.COLLISION_BOX_PADDING=16;c.COLLISION_TILE_BOX_SIZE=c.TILE_SIZE/c.COLLISION_BUCKET_SIZE;c.COLLISION_PLACEMENT_PADDING=8;c.HEURISTIC_GLYPHS_PER_LINE=50;c.HEURISTIC_GLYPHS_PER_FEATURE=10;c.GLYPH_SIZE=24;c.TEXT_PLACEMENT_PADDING=
8;c.AVERAGE_GLYPH_MOSAIC_ITEM={metrics:{width:15,height:17,left:0,top:-7,advance:14}};c.ATTRIBUTE_STORE_TEXTURE_SIZE=1024;c.TEXTURE_BINDING_SPRITE_ATLAS=0;c.TEXTURE_BINDING_GLYPH_ATLAS=0;c.TEXTURE_BINDING_BITMAP=0;c.TEXTURE_BINDING_ATTRIBUTE_DATA_0=1;c.TEXTURE_BINDING_ATTRIBUTE_DATA_1=2;c.TEXTURE_BINDING_ATTRIBUTE_DATA_2=3;c.TEXTURE_BINDING_ATTRIBUTE_DATA_3=4;c.TEXTURE_BINDING_HIGHLIGHT_0=5;c.TEXTURE_BINDING_HIGHLIGHT_1=6;c.TEXTURE_BINDING_RENDERER_0=5;c.TEXTURE_BINDING_RENDERER_1=6;c.ATTRIBUTE_DATA_FILTER_FLAGS=
0;c.ATTRIBUTE_DATA_ANIMATION=1;c.ATTRIBUTE_DATA_VV=2;c.ATTRIBUTE_DATA_DD0=3;c.ATTRIBUTE_DATA_DD1=3;c.MAX_FILTERS=2;c.HIGHLIGHT_FLAG=1;c.FILTER_FLAG_0=2;c.EFFECT_FLAG_0=4;c.THIN_LINE_THRESHOLD=2.5;c.HITTEST_SEARCH_SIZE=24;c.MAX_ANIMATION_TIME_MS=2E3;c.VTL_TEXTURE_BINDING_UNIT_SPRITES=5;c.VTL_TEXTURE_BINDING_UNIT_GLYPHS=6;c.VTL_HIGH_RES_CUTOFF=1.15;c.MAX_GPU_UPLOADS_PER_FRAME=2})},"esri/views/2d/engine/webgl/Painter":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../webgl ../../engine ../vectorTiles/shaders/ProgramCache ./BitBlitRenderer ./enums ./MaterialManager ./TextureManager ./effects/AnimationEffect ./effects/HighlightEffect ./effects/HittestEffect ./painter/RenderPass".split(" "),
function(b,c,e,g,f,a,n,k,d,l,t,x,w,m){Object.defineProperty(c,"__esModule",{value:!0});b=function(){return function(){}}();c.PainterOptions=b;b=function(){function b(b,c){this.context=b;this._blitRenderer=new n.BitBlitRenderer;this._brushCache=new Map;this._vtlProgramCache=null;this.brushNameToCtor={marker:f.brushes.Marker,line:f.brushes.Line,fill:f.brushes.Fill,text:f.brushes.Text,label:f.brushes.Label,clip:f.brushes.Clip,stencil:f.brushes.Stencil,bitmap:f.brushes.Bitmap,tileInfo:f.brushes.TileInfo,
vtlBackground:f.brushes.VTLBackground,vtlFill:f.brushes.VTLFill,vtlLine:f.brushes.VTLLine,vtlCircle:f.brushes.VTLCircle,vtlSymbol:f.brushes.VTLSymbol};this.effects={highlight:new x.default,hittest:new w.HittestEffect,integrate:new t.AnimationEffect};this.materialManager=new d(b);this._vtlProgramCache=new a.default(b);this.textureManager=new l(c)}b.prototype.getFbos=function(a,d){if(a!==this._lastWidth||d!==this._lastHeight){this._lastWidth=a;this._lastHeight=d;if(this._fbos)for(var b in this._fbos)this._fbos[b].dispose();
b={target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:a,height:d};var c={colorTarget:0,depthStencilTarget:3};a=new g.Renderbuffer(this.context,{width:a,height:d,internalFormat:34041});this._fbos={output:new g.FramebufferObject(this.context,c,b,a),alpha:new g.FramebufferObject(this.context,c,b,a),effect0:new g.FramebufferObject(this.context,c,b,a)}}return this._fbos};b.prototype.beforeRenderLayers=function(a){var d=a.getViewport(),d=this.getFbos(d.width,d.height);this._prevFBO=
a.getBoundFramebufferObject();a.bindFramebuffer(d.output);a.setDepthWriteEnabled(!0);a.setClearColor(0,0,0,0);a.setClearDepth(1);a.clear(a.gl.COLOR_BUFFER_BIT|a.gl.DEPTH_BUFFER_BIT);a.setDepthWriteEnabled(!1)};b.prototype.beforeRenderLayer=function(a,d,b){1!==b?(a.bindFramebuffer(this._fbos.alpha),a.setColorMask(!0,!0,!0,!0),a.setClearColor(0,0,0,0),a.clear(a.gl.COLOR_BUFFER_BIT)):a.bindFramebuffer(this._fbos.output);a.setDepthWriteEnabled(!1);a.setDepthTestEnabled(!1);a.setStencilTestEnabled(!0);
a.setClearStencil(d);a.setStencilWriteMask(255);a.clear(a.gl.STENCIL_BUFFER_BIT)};b.prototype.compositeLayer=function(a,d){1!==d&&(a.bindFramebuffer(this._fbos.output),a.setStencilTestEnabled(!1),a.setStencilWriteMask(0),a.setBlendingEnabled(!0),a.setBlendFunctionSeparate(1,771,1,771),a.setColorMask(!0,!0,!0,!0),this._blitRenderer.render(a,this._fbos.alpha.colorTexture,9728,d))};b.prototype.renderLayers=function(a){a.bindFramebuffer(this._prevFBO);this._fbos&&(a.setStencilTestEnabled(!1),a.setStencilWriteMask(0),
a.setBlendingEnabled(!0),a.setBlendFunctionSeparate(1,771,1,771),a.setColorMask(!0,!0,!0,!0),this._blitRenderer.render(a,this._fbos.output.colorTexture,9728,1))};b.prototype.dispose=function(){this.materialManager.dispose();this.textureManager.dispose();this._blitRenderer&&(this._blitRenderer.dispose(),this._blitRenderer=null);this._vtlProgramCache&&(this._vtlProgramCache.dispose(),this._vtlProgramCache=null);this._brushCache&&(this._brushCache.forEach(function(a){return a.dispose()}),this._brushCache.clear(),
this._brushCache=null);if(this._fbos)for(var a in this._fbos)this._fbos[a]&&this._fbos[a].dispose();if(this.effects)for(var d in this.effects)this.effects[d]&&this.effects[d].dispose();this._prevFBO=null};b.prototype.getGeometryBrush=function(a){var d;a=(d={},d[k.WGLGeometryType.FILL]=f.brushes.Fill,d[k.WGLGeometryType.LINE]=f.brushes.Line,d[k.WGLGeometryType.MARKER]=f.brushes.Marker,d[k.WGLGeometryType.TEXT]=f.brushes.Text,d)[a];d=this._brushCache.get(a);void 0===d&&(d=new a,this._brushCache.set(a,
d));return this._brushCache.get(a)};b.prototype.renderObject=function(a,d,b,c){b=this.brushNameToCtor[b];if(!b)return null;var e=this._brushCache.get(b);void 0===e&&(e=new b,this._brushCache.set(b,e));e.prepareState(a,d,c);e.draw(a,d,c)};b.prototype.renderObjects=function(a,d,b,c){b=this.brushNameToCtor[b];if(!b)return null;var e=this._brushCache.get(b);void 0===e&&(e=new b,this._brushCache.set(b,e));e.drawMany(a,d,c)};b.prototype.getVectorTileProgramCach=function(){return this._vtlProgramCache};
b.prototype.registerRenderPass=function(a){var d=this,b=a.brushes.map(function(a){d._brushCache.has(a)||d._brushCache.set(a,new a);return d._brushCache.get(a)});return new m.default(b,a)};b.prototype.setHighlightOptions=function(a){this.effects.highlight.setHighlightOptions(a)};return b}();c.default=b})},"esri/views/2d/engine/vectorTiles/shaders/ProgramCache":function(){define(["require","exports","../../../../webgl","./Programs"],function(b,c,e,g){Object.defineProperty(c,"__esModule",{value:!0});
b=function(){function b(a){this._cache=Array(8);for(var b=0;8>b;b++)this._cache[b]={};this._programRepo=new e.ProgramCache(a)}b.prototype.dispose=function(){this._programRepo&&(this._programRepo.dispose(),this._programRepo=null)};b.prototype.getProgram=function(a,b,c){var d=this._cache[a];d[b]||(a=this._programRepo.getProgram(this._getProgramTemplate(a),c),d[b]=a);return d[b]};b.prototype.getProgramAttributes=function(a){switch(a){case 0:return g.background.attributes;case 5:return g.circle.attributes;
case 1:return g.fill.attributes;case 4:return g.icon.attributes;case 3:return g.line.attributes;case 2:return g.outline.attributes;case 6:return g.text.attributes;default:return null}};b.prototype._getProgramTemplate=function(a){switch(a){case 0:return g.background;case 5:return g.circle;case 1:return g.fill;case 4:return g.icon;case 3:return g.line;case 2:return g.outline;case 6:return g.text;default:return null}};return b}();c.default=b})},"esri/views/2d/engine/vectorTiles/shaders/Programs":function(){define(["require",
"exports","../../../../webgl","./sources/resolver"],function(b,c,e,g){Object.defineProperty(c,"__esModule",{value:!0});c.background={name:"background",shaders:function(a){return{vertexShader:e.glslifyDefineMap({ID:a.id,PATTERN:a.pattern})+g.resolveIncludes("background/background.vert"),fragmentShader:e.glslifyDefineMap({ID:a.id,PATTERN:a.pattern})+g.resolveIncludes("background/background.frag")}},attributes:{a_pos:0}};c.circle={name:"circle",shaders:function(a){return{vertexShader:e.glslifyDefineMap({ID:a.id})+
g.resolveIncludes("circle/circle.vert"),fragmentShader:e.glslifyDefineMap({ID:a.id})+g.resolveIncludes("circle/circle.frag")}},attributes:{a_pos:0,a_color:1,a_stroke_color:2,a_data:3}};var f=function(a){return e.glslifyDefineMap({ID:a.id,DD:a.dd,PATTERN:a.pattern})};c.fill={name:"fill",shaders:function(a){return{vertexShader:f(a)+g.resolveIncludes("fill/fill.vert"),fragmentShader:f(a)+g.resolveIncludes("fill/fill.frag")}},attributes:{a_pos:0,a_color:1}};c.outline={name:"outline",shaders:function(a){return{vertexShader:e.glslifyDefineMap({ID:a.id,
DD:a.dd})+g.resolveIncludes("outline/outline.vert"),fragmentShader:e.glslifyDefineMap({ID:a.id,DD:a.dd})+g.resolveIncludes("outline/outline.frag")}},attributes:{a_pos:0,a_offset:1,a_xnormal:2,a_color:3}};c.icon={name:"icon",shaders:function(a){return{vertexShader:e.glslifyDefineMap({ID:a.id,DD:a.dd,SDF:a.sdf})+g.resolveIncludes("icon/icon.vert"),fragmentShader:e.glslifyDefineMap({ID:a.id,DD:a.dd,SDF:a.sdf})+g.resolveIncludes("icon/icon.frag")}},attributes:{a_pos:0,a_vertexOffset:1,a_tex:2,a_levelInfo:3,
a_color:4,a_size:5}};var a=function(a){return e.glslifyDefineMap({ID:a.id,DD:a.dd,PATTERN:a.pattern})};c.line={name:"line",shaders:function(b){return{vertexShader:a(b)+g.resolveIncludes("line/line.vert"),fragmentShader:a(b)+g.resolveIncludes("line/line.frag")}},attributes:{a_pos:0,a_offsetAndNormal:1,a_accumulatedDistance:2,a_color:3,a_width:4}};c.text={name:"text",shaders:function(a){return{vertexShader:e.glslifyDefineMap({ID:a.id,DD:a.dd})+g.resolveIncludes("text/text.vert"),fragmentShader:e.glslifyDefineMap({ID:a.id,
DD:a.dd})+g.resolveIncludes("text/text.frag")}},attributes:{a_pos:0,a_vertexOffset:1,a_tex:2,a_levelInfo:3,a_color:4,a_size:5}}})},"esri/views/2d/engine/vectorTiles/shaders/sources/resolver":function(){define(["require","exports","../../../../../webgl","./shaderRepository"],function(b,c,e,g){Object.defineProperty(c,"__esModule",{value:!0});var f=new e.ShaderCompiler(function(a){var b=g;a.split("/").forEach(function(a){b&&(b=b[a])});return b});c.resolveIncludes=function(a){return f.resolveIncludes(a)}})},
"esri/views/2d/engine/vectorTiles/shaders/sources/shaderRepository":function(){define(["require","exports"],function(b,c){return{background:{"background.frag":"#ifdef PATTERN\nuniform lowp float u_opacity;\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform sampler2D u_texture;\nvarying mediump vec2 v_tileTextureCoord;\n#else\nuniform lowp vec4 u_color;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main() {\n#ifdef PATTERN\n  mediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\n  mediump vec2 samplePos \x3d mix(u_pattern_tl, u_pattern_br, normalizedTextureCoord);\n  lowp vec4 color \x3d texture2D(u_texture, samplePos);\n  gl_FragColor \x3d u_opacity * color;\n#else\n  gl_FragColor \x3d u_color;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"background.vert":"precision mediump float;\nattribute vec2 a_pos;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_coord_range;\nuniform mediump float u_depth;\n#ifdef PATTERN\nuniform mediump mat3 u_pattern_matrix;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\nvoid main() {\n  gl_Position \x3d vec4((u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0)).xy, u_depth, 1.0);\n#ifdef PATTERN\n  v_tileTextureCoord \x3d (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n}"},
circle:{"circle.frag":"precision lowp float;\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  mediump float dist \x3d length(v_offset);\n  mediump float alpha \x3d smoothstep(0.0, -v_blur, dist - 1.0);\n  lowp float color_mix_ratio \x3d v_stroke_width \x3c 0.01 ? 0.0 : smoothstep(-v_blur, 0.0, dist - v_radius / (v_radius + v_stroke_width));\n  gl_FragColor \x3d alpha * mix(v_color, v_stroke_color, color_mix_ratio);\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"circle.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec4 a_color;\nattribute vec4 a_stroke_color;\nattribute vec4 a_data;\nconst float sizePrecision \x3d 0.25;\nconst float blurPrecision \x3d 0.03125;\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_circleTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_radius;\nuniform lowp vec4 u_color;\nuniform mediump float u_blur;\nuniform mediump float u_stroke_width;\nuniform lowp vec4 u_stroke_color;\nuniform mediump float u_antialiasingWidth;\nvoid main()\n{\n  v_color \x3d a_color * u_color;\n  v_stroke_color \x3d a_stroke_color * u_stroke_color;\n  v_stroke_width \x3d a_data[1] * sizePrecision * u_stroke_width;\n  v_radius \x3d a_data[2] * u_radius;\n  v_blur \x3d max(a_data[0] * blurPrecision + u_blur, u_antialiasingWidth / (v_radius + v_stroke_width));\n  mediump vec2 offset \x3d vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\n  v_offset \x3d offset;\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos * 0.5, 1.0) + u_displayMat3 * vec3((v_radius + v_stroke_width) * offset + u_circleTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
fill:{"fill.frag":"precision lowp float;\n#ifdef PATTERN\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform lowp sampler2D u_texture;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvec4 mixColors(vec4 color1, vec4 color2) {\n  float compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\n  vec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\n  return vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef PATTERN\n  mediump vec2 normalizedTextureCoord \x3d fract(v_tileTextureCoord);\n  mediump vec2 samplePos \x3d mix(u_pattern_tl, u_pattern_br, normalizedTextureCoord);\n  lowp vec4 color \x3d texture2D(u_texture, samplePos);\n  gl_FragColor \x3d v_color[3] * color;\n#else\n  gl_FragColor \x3d v_color;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"fill.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_fillTranslation;\n#ifdef PATTERN\nuniform mediump mat3 u_pattern_matrix;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\n#ifdef DD\nattribute vec4 a_color;\n#endif\nuniform lowp vec4 u_color;\nvarying lowp vec4 v_color;\nvoid main()\n{\n#ifdef DD\n  v_color \x3d a_color * u_color;\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n#ifdef PATTERN\n  v_tileTextureCoord \x3d (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\n#endif\n  vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(u_fillTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
icon:{"icon.frag":"precision mediump float;\nuniform lowp sampler2D u_texture;\n#ifdef SDF\nuniform lowp vec4 u_color;\nuniform lowp vec4 u_outlineColor;\nuniform mediump float u_outlineSize;\n#endif\nvarying mediump vec2 v_tex;\nvarying lowp float v_transparency;\nvarying mediump vec2 v_size;\nvarying lowp vec4 v_color;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\n#include \x3cutil/encoding.glsl\x3e\nvec4 mixColors(vec4 color1, vec4 color2) {\n  float compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\n  vec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\n  return vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef SDF\n  lowp vec4 fillPixelColor \x3d v_color;\n  float d \x3d rgba2float(texture2D(u_texture, v_tex)) - 0.5;\n  const float sofetEdgeRatio \x3d 0.248062016;\n  float size \x3d max(v_size.x, v_size.y);\n  float dist \x3d d * sofetEdgeRatio * size;\n  fillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\n  if (u_outlineSize \x3e 0.25) {\n    lowp vec4 outlinePixelColor \x3d u_outlineColor;\n    const float outlineLimitRatio \x3d (16.0 / 86.0);\n    float clampedOutlineSize \x3d sofetEdgeRatio * min(u_outlineSize, outlineLimitRatio * max(v_size.x, v_size.y));\n    outlinePixelColor *\x3d clamp(0.5 - (abs(dist) - clampedOutlineSize), 0.0, 1.0);\n    gl_FragColor \x3d v_transparency * mixColors(fillPixelColor, outlinePixelColor);\n  }\n  else {\n    gl_FragColor \x3d v_transparency * fillPixelColor;\n  }\n#else\n  lowp vec4 texColor \x3d texture2D(u_texture, v_tex);\n  gl_FragColor \x3d v_transparency * texColor;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"icon.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_tex;\nattribute vec4 a_levelInfo;\n#ifdef DD\nattribute vec4 a_color;\nattribute mediump float a_size;\n#endif\nuniform lowp vec4 u_color;\nuniform mediump float u_size;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_iconTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_fadeSpeed;\nuniform mediump float u_minfadeLevel;\nuniform mediump float u_maxfadeLevel;\nuniform mediump float u_fadeChange;\nuniform mediump float u_opacity;\nvarying mediump vec2 v_tex;\nvarying lowp float v_transparency;\nvarying mediump vec2 v_size;\nconst float C_OFFSET_PRECISION \x3d 1.0 / 8.0;\nconst float C_256_TO_RAD \x3d 3.14159265359 / 128.0;\nconst float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\nconst float tileCoordRatio \x3d 1.0 / 8.0;\nvoid main()\n{\n  mediump float a_labelMinLevel \x3d a_levelInfo[0];\n  mediump float a_angle         \x3d a_levelInfo[1];\n  mediump float a_minLevel      \x3d a_levelInfo[2];\n  mediump float a_maxLevel      \x3d a_levelInfo[3];\n  mediump float delta_z \x3d 0.0;\n  mediump float rotated \x3d mod(a_angle + u_mapRotation, 256.0);\n  delta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * step(64.0, rotated) * (1.0 - step(192.0, rotated));\n  delta_z +\x3d 1.0 - step(a_minLevel, u_level);\n  delta_z +\x3d step(a_maxLevel, u_level);\n  mediump float alpha \x3d u_fadeSpeed !\x3d 0.0 ? clamp((u_fadeChange - a_labelMinLevel) / u_fadeSpeed, 0.0, 1.0) : 1.0;\n  v_transparency \x3d (u_fadeSpeed \x3e\x3d 0.0 ? alpha : 1.0 - alpha);\n  if (u_maxfadeLevel \x3c a_labelMinLevel)\n  {\n    v_transparency \x3d 0.0;\n  }\n  if (u_minfadeLevel \x3e\x3d a_labelMinLevel)\n  {\n    v_transparency \x3d 1.0;\n  }\n  delta_z +\x3d step(v_transparency, 0.0);\n  vec2 offset \x3d C_OFFSET_PRECISION * a_vertexOffset;\n  v_size \x3d abs(offset);\n#ifdef SDF\n  offset \x3d (120.0 / 86.0) * offset;\n#endif\n#ifdef DD\n  mediump float icon_size \x3d a_size * u_size;\n#else\n  mediump float icon_size \x3d u_size;\n#endif\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayViewMat3 * vec3(icon_size * offset, 0.0) + u_displayMat3 * vec3(u_iconTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth + delta_z, 1.0);\n#ifdef DD\n  v_color \x3d a_color * u_color;\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  v_tex \x3d a_tex.xy / u_mosaicSize;\n  v_transparency *\x3d v_color.w;\n}"},
line:{"line.frag":"varying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nvarying mediump float v_lineHalfWidth;\nvarying lowp vec4 v_color;\nvarying mediump float v_blur;\n#ifdef PATTERN\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform mediump vec2 u_spriteSize;\nuniform sampler2D u_texture;\nconst mediump float tileCoordRatio \x3d 8.0;\n#else\nvarying mediump vec2 v_dasharray;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  mediump float fragDist \x3d length(v_normal) * v_lineHalfWidth;\n  lowp float alpha \x3d clamp((v_lineHalfWidth - fragDist) / v_blur, 0.0, 1.0);\n#ifdef PATTERN\n  mediump float relativeTexX \x3d mod((v_accumulatedDistance + v_normal.x * v_lineHalfWidth * tileCoordRatio) / u_spriteSize.x, 1.0);\n  mediump float relativeTexY \x3d 0.5 + (v_normal.y * v_lineHalfWidth / u_spriteSize.y);\n  mediump vec2 texCoord \x3d mix(u_pattern_tl, u_pattern_br, vec2(relativeTexX, relativeTexY));\n  lowp vec4 color \x3d texture2D(u_texture, texCoord);\n  gl_FragColor \x3d alpha * v_color[3] * color;\n#else\n  lowp float dashPos \x3d  mod(v_accumulatedDistance, v_dasharray.x + v_dasharray.y);\n  lowp float dashAlpha \x3d clamp(min(dashPos, v_dasharray.x - dashPos) + 0.5, 0.0, 1.0);\n  dashAlpha \x3d max(sign(-v_dasharray.y), dashAlpha);\n  alpha *\x3d dashAlpha;\n  gl_FragColor \x3d alpha * v_color;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"line.vert":"attribute vec2 a_pos;\nattribute vec4 a_offsetAndNormal;\nattribute vec2 a_accumulatedDistance;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_lineTranslation;\nuniform mediump float u_blur;\nuniform mediump float u_antialiasing;\nuniform mediump float u_depth;\nvarying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nconst float scale \x3d 1.0 / 31.0;\n#ifdef DD\nattribute vec4 a_color;\nattribute mediump float a_width;\n#endif\nuniform lowp vec4 u_color;\nuniform mediump float u_width;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvarying mediump float v_lineHalfWidth;\nvarying mediump float v_blur;\n#ifndef PATTERN\nuniform mediump vec2 u_dasharray;\nvarying mediump vec2 v_dasharray;\n#endif\nvoid main()\n{\n  v_normal \x3d a_offsetAndNormal.zw * scale;\n#ifdef DD\n  v_lineHalfWidth \x3d a_width * u_width;\n#else\n  v_lineHalfWidth \x3d u_width;\n#endif\n  v_lineHalfWidth +\x3d u_antialiasing;\n  v_lineHalfWidth *\x3d 0.5;\n#ifndef PATTERN\n#ifdef DD\n  v_dasharray \x3d u_dasharray * a_width;\n#else\n  v_dasharray \x3d u_dasharray * u_width;\n#endif\n#endif\n  mediump vec2 dist \x3d v_lineHalfWidth * scale * a_offsetAndNormal.xy;\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) +  u_displayViewMat3 * vec3(dist, 0.0) + u_displayMat3 * vec3(u_lineTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n  v_accumulatedDistance \x3d a_accumulatedDistance.x;\n  v_blur \x3d u_blur + u_antialiasing;\n  #ifdef DD\n    v_color \x3d a_color * u_color;\n  #else\n    v_color \x3d u_color;\n  #endif\n  #ifdef ID\n    v_id \x3d u_id / 255.0;\n  #endif\n}"},
outline:{"outline.frag":"varying lowp vec4 v_color;\nvarying mediump vec2 v_normal;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  lowp float dist \x3d abs(v_normal.y);\n  lowp float alpha \x3d smoothstep(1.0, 0.0, dist);\n  gl_FragColor \x3d alpha * v_color;\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}","outline.vert":"attribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_xnormal;\n#ifdef DD\nattribute vec4 a_color;\n#endif\nuniform lowp vec4 u_color;\nvarying lowp vec4 v_color;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_fillTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_outline_width;\nvarying lowp vec2 v_normal;\nconst float scale \x3d 1.0 / 15.0;\nvoid main()\n{\n#ifdef DD\n  v_color \x3d a_color * u_color;\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  v_normal \x3d a_xnormal;\n  mediump vec2 dist \x3d u_outline_width * scale * a_offset;\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(dist + u_fillTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
text:{"text.frag":"uniform lowp sampler2D u_texture;\nuniform mediump float u_edgeDistance;\nvarying lowp vec2 v_tex;\nvarying lowp float v_transparency;\nvarying lowp vec4 v_color;\nvarying mediump float v_edgeWidth;\nvarying mediump float v_edgeDistance;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  lowp float dist \x3d texture2D(u_texture, v_tex).a;\n  mediump float alpha \x3d smoothstep(v_edgeDistance - v_edgeWidth, v_edgeDistance + v_edgeWidth, dist) * v_transparency;\n  gl_FragColor \x3d alpha * v_color;\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"text.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_tex;\nattribute vec4 a_levelInfo;\nuniform lowp vec4 u_color;\n#ifdef DD\nattribute vec4 a_color;\n#endif\nvarying lowp vec4 v_color;\nuniform mediump float u_size;\n#ifdef DD\nattribute mediump float a_size;\n#endif\nvarying mediump float v_size;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_textTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_fadeSpeed;\nuniform mediump float u_minfadeLevel;\nuniform mediump float u_maxfadeLevel;\nuniform mediump float u_fadeChange;\nuniform mediump float u_opacity;\nvarying lowp vec2 v_tex;\nvarying lowp float v_transparency;\nconst float offsetPrecision \x3d 1.0 / 8.0;\nconst mediump float edgePos \x3d 0.75;\nuniform mediump float u_edgeDistance;\nuniform mediump float u_edgeBlur;\nuniform mediump float u_antialiasingWidth;\nvarying mediump float v_edgeDistance;\nvarying mediump float v_edgeWidth;\nuniform lowp float u_halo;\nconst float sdfFontScale \x3d 1.0 / 24.0;\nvoid main()\n{\n  mediump float a_labelMinLevel \x3d a_levelInfo[0];\n  mediump float a_angle        \x3d a_levelInfo[1];\n  mediump float a_minLevel    \x3d a_levelInfo[2];\n  mediump float a_maxLevel    \x3d a_levelInfo[3];\n  mediump float delta_z \x3d 0.0;\n  mediump float rotated \x3d mod(a_angle + u_mapRotation, 256.0);\n  delta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * step(64.0, rotated) * (1.0 - step(192.0, rotated));\n  delta_z +\x3d 1.0 - step(a_minLevel, u_level);\n  delta_z +\x3d step(a_maxLevel, u_level);\n  mediump float alpha \x3d u_fadeSpeed !\x3d 0.0 ? clamp((u_fadeChange - a_labelMinLevel) / u_fadeSpeed, 0.0, 1.0) : 1.0;\n  v_transparency \x3d (u_fadeSpeed \x3e\x3d 0.0 ? alpha : 1.0 - alpha);\n  if (u_maxfadeLevel \x3c a_labelMinLevel)\n  {\n    v_transparency \x3d 0.0;\n  }\n  if (u_minfadeLevel \x3e\x3d a_labelMinLevel)\n  {\n    v_transparency \x3d 1.0;\n  }\n  delta_z +\x3d step(v_transparency, 0.0);\n  v_tex \x3d a_tex.xy / u_mosaicSize;\n#ifdef DD\n  if (u_halo \x3e 0.5)\n  {\n    v_color \x3d u_color;\n  }\n  else\n  {\n    v_color \x3d a_color * u_color;\n  }\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef DD\n  v_size \x3d a_size * u_size;\n#else\n  v_size \x3d u_size;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  v_edgeDistance \x3d edgePos - u_edgeDistance / v_size;\n  v_edgeWidth \x3d (u_antialiasingWidth + u_edgeBlur) / v_size;\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + sdfFontScale * u_displayViewMat3 * vec3(offsetPrecision * v_size * a_vertexOffset, 0.0) + u_displayMat3 * vec3(u_textTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth + delta_z, 1.0);\n}"},
util:{"encoding.glsl":"const vec4 rgba2float_factors \x3d vec4(\n    255.0 / (256.0),\n    255.0 / (256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n  );\nfloat rgba2float(vec4 rgba) {\n  return dot(rgba, rgba2float_factors);\n}"}}})},"esri/views/2d/engine/webgl/MaterialManager":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/maybe ../../../webgl ./enums ./shaders/MaterialPrograms".split(" "),function(b,
c,e,g,f,a,n){var k=function(d){return d===a.WGLDrawPhase.HITTEST||d===a.WGLDrawPhase.LABEL_ALPHA},d=function(d,b,c,f){f=f.reduce(function(a,b){var c;return e({},a,(c={},c[b]=d.driverTestResult[b],c))},{});b=e({},b.getVariation(),d.rendererInfo.getVariation(),{highlight:d.drawPhase===a.WGLDrawPhase.HIGHLIGHT,id:k(d.drawPhase)},f);if(g.isSome(c))for(f=0;f<c.length;f++)b[c[f]]=!0;return b};return function(){function b(a){this._programByKey=new Map;this._programCache=new f.ProgramCache(a)}b.prototype.dispose=
function(){this._programCache&&this._programCache.dispose()};b.prototype.getProgram=function(a,d,b,c){void 0===b&&(b=[]);void 0===c&&(c=[]);var f=d.path+b.join(".")+c.join(".");if(this._programByKey.has(f))return this._programByKey.get(f);c=c.reduce(function(d,b){var c;return e({},d,(c={},c[b]=a.driverTestResult[b],c))},{});b=e({},b.reduce(function(a,d){var b;return e({},a,(b={},b[d]=!0,b))},{}),c);d=this._programCache.getProgram(n.createProgramTemplate(d.path,d.attributes),b);if(!d)throw Error("Unable to get program for key: ${key}");
this._programByKey.set(f,d);return d};b.prototype.getMaterialProgram=function(b,c,e,f,l,q){void 0===q&&(q=["ignoresSamplerPrecision"]);var m,p=q;m=b.rendererInfo;var r=b.drawPhase,p=c.getVariationHash()+"-"+p.join(".")+"-",r=(k(r)?1:0)|(r===a.WGLDrawPhase.HIGHLIGHT?2:0);m=p+r+"-"+m.getVariationHash()+"-"+(g.isSome(l)&&l.join("."));if(this._programByKey.has(m))return this._programByKey.get(m);b=d(b,c,l,q);e=this._programCache.getProgram(n.createProgramTemplate(e,f),b);if(!e)throw Error("Unable to get program for key: ${key}");
this._programByKey.set(m,e);return e};return b}()})},"esri/views/2d/engine/webgl/shaders/MaterialPrograms":function(){define(["require","exports","../../../../webgl","./sources/resolver"],function(b,c,e,g){Object.defineProperty(c,"__esModule",{value:!0});var f=function(a){var b={},c;for(c in a){for(var d=c,f=void 0,f=""+d[0].toUpperCase(),g=1;g<d.length;g++){var x=d[g];x===x.toUpperCase()?(f+="_",f+=x):f+=x.toUpperCase()}b[f]=a[c]}return e.glslifyDefineMap(b)};c.createProgramTemplate=function(a,b){var c=
a+a.substring(a.lastIndexOf("/"));return{name:name,attributes:b,shaders:function(a){return{vertexShader:f(a)+g.resolveIncludes(c+".vert"),fragmentShader:f(a)+g.resolveIncludes(c+".frag")}}}}})},"esri/views/2d/engine/webgl/TextureManager":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/tsSupport/generatorHelper ../../../../config ../../../../request ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/screenUtils ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f32 ../../../../symbols/cim/Rasterizer ./definitions ./enums ./fontUtils ./GlyphMosaic ./GlyphSource ./SDFConverter ./SpriteMosaic ./animatedFormats/apng ./animatedFormats/gif ./util/BidiText ./util/Result ./util/symbolUtils".split(" "),
function(b,c,e,g,f,a,n,k,d,l,t,x,w,m,z,q,v,p,r,h,y,u,D,B,C,A,I){function E(a){switch(a.type){case "CIMSolidStroke":case "CIMSolidFill":return!0;case "esriSFS":return"esriSFSSolid"===a.style||"esriSFSNull"===a.style;case "esriSLS":return"esriSLSSolid"===a.style||"esriSLSNull"===a.style;default:return!1}}function H(a){switch(a.type){case "esriSMS":case "esriPMS":case "CIMPointSymbol":case "CIMVectorMarker":case "CIMPictureMarker":case "CIMCharacterMarker":return!1;default:return!0}}function F(a){return g(this,
void 0,void 0,function(){var d,b;return f(this,function(c){switch(c.label){case 0:d=window.URL.createObjectURL(a),c.label=1;case 1:return c.trys.push([1,3,,4]),[4,n(d,{responseType:"image"})];case 2:return b=c.sent().data,window.URL.revokeObjectURL(d),[2,b];case 3:return c.sent(),window.URL.revokeObjectURL(d),[2,new k("mapview-invalid-resource","Could not fetch requested resource at "+d)];case 4:return[2]}})})}function L(a,d){return g(this,void 0,void 0,function(){var b,c,h,l,m,g,p,u,r;return f(this,
function(f){switch(f.label){case 0:b=a.imageData?"data:"+a.contentType+";base64,"+a.imageData:a.url;if(-1===b.indexOf(";base64,"))return[3,1];h=b.indexOf(";base64,")+8;l=b.substring(h);m=atob(l);g=new Uint8Array(m.length);for(p=0;p<m.length;p++)g[p]=m.charCodeAt(p);c=g.buffer;return[3,4];case 1:return f.trys.push([1,3,,4]),[4,n(b,e({responseType:"array-buffer"},d))];case 2:return c=u=f.sent().data,[3,4];case 3:return r=f.sent(),t.isAbortError(r)?[3,4]:[2,new k("mapview-invalid-resource","Could not fetch requested resource at "+
b)];case 4:return[2,c]}})})}var J=m.vec2f32.create(),G=d.getLogger("esri.views.2d.engine.webgl.TextureManager"),N=function(){function a(a,d,b){this.mosaicType=a;this.page=d;this.sdf=b}a.fromMosaic=function(d,b){return new a(d,b.page,b.sdf)};return a}();return function(){function d(d){this._invalidFontsMap=new Map;this._sdfConverter=new y.default(126);this._bindingInfos=[];this._hashToBindingIndex=new Map;this._rasterizer=new z.default;this._spriteMosaic=new u(d,2048,2048,500);this._glyphSource=new h(a.fontsUrl+
"/{fontstack}/{range}.pbf");this._glyphMosaic=new r(1024,1024,this._glyphSource)}d.prototype.dispose=function(){this._spriteMosaic.dispose();this._glyphMosaic.dispose();this._rasterizer.dispose();this._rasterizer=this._glyphMosaic=this._spriteMosaic=null};Object.defineProperty(d.prototype,"sprites",{get:function(){return this._spriteMosaic},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"glyphs",{get:function(){return this._glyphMosaic},enumerable:!0,configurable:!0});d.prototype.rasterizeItem=
function(a,d,b){return g(this,void 0,void 0,function(){var c,e,h,m=this;return f(this,function(f){switch(f.label){case 0:if(l.isNone(a))return G.error(new k("mapview-null-resource","Unable to rasterize null resource",void 0)),[2,null];c=a.type;switch(c){case "CIMTextSymbol":return[3,1];case "esriTS":return[3,1]}return[3,3];case 1:return[4,this._rasterizeText(a,d,b)];case 2:return e=f.sent(),e.forEach(function(a){return m._setTextureBinding(v.MosaicType.GLYPH,a)}),[2,{glyphMosaicItems:e}];case 3:return a.type&&
-1!==a.type.toLowerCase().indexOf("3d")?(G.error(new k("mapview-invalid-type","MapView does not support symbol type: "+a.type,a)),[2,null]):[4,this._rasterizeSpriteSymbol(a,b)];case 4:return h=f.sent(),A.ok(h)&&h&&this._setTextureBinding(v.MosaicType.SPRITE,h),[2,{spriteMosaicItem:h}]}})})};d.prototype.bindTextures=function(a,d,b){if(0!==b.textureBinding){var c=this._bindingInfos[b.textureBinding-1];b=c.page;switch(c.mosaicType){case v.MosaicType.SPRITE:var c=this.sprites.getWidth(b),e=this.sprites.getHeight(b),
c=w.vec2.set(J,c,e);this._spriteMosaic.bind(a,9729,b,q.TEXTURE_BINDING_SPRITE_ATLAS);d.setUniform1i("u_texture",q.TEXTURE_BINDING_SPRITE_ATLAS);d.setUniform2fv("u_mosaicSize",c);break;case v.MosaicType.GLYPH:c=this.glyphs.width;e=this.glyphs.height;c=w.vec2.set(J,c,e);this._glyphMosaic.bind(a,9729,b,q.TEXTURE_BINDING_GLYPH_ATLAS);d.setUniform1i("u_texture",q.TEXTURE_BINDING_GLYPH_ATLAS);d.setUniform2fv("u_mosaicSize",c);break;default:G.error("mapview-texture-manager","Cannot handle unknown type "+
c.mosaicType)}}};d.prototype._hashMosaic=function(a,d){return 1|a<<1|(d.sdf?1:0)<<2|d.page<<3};d.prototype._setTextureBinding=function(a,d){var b=this._hashMosaic(a,d);this._hashToBindingIndex.has(b)||(a=N.fromMosaic(a,d),this._hashToBindingIndex.set(b,this._bindingInfos.length+1),this._bindingInfos.push(a));d.textureBinding=this._hashToBindingIndex.get(b)};d.prototype._rasterizeText=function(a,d,b){return g(this,void 0,void 0,function(){var c,e,h;return f(this,function(f){switch(f.label){case 0:c=
p.getFullyQualifiedFontName(a.font);e=this._invalidFontsMap.has(c);var l;if(d)l=d;else{l=C.bidiText(a.text)[0];for(var m=[],g=0;g<l.length;g++)m.push(l.charCodeAt(g));l=m}h=l;f.label=1;case 1:return f.trys.push([1,3,,4]),[4,this._glyphMosaic.getGlyphItems(e?"arial-unicode-ms-regular":c,h,b)];case 2:return[2,f.sent()];case 3:return f.sent(),G.error(new k("mapview-invalid-resource","Couldn't find font "+c+". Falling back to Arial Unicode MS Regular",void 0)),this._invalidFontsMap.set(c,!0),[2,this._glyphMosaic.getGlyphItems("arial-unicode-ms-regular",
h,b)];case 4:return[2]}})})};d.prototype._rasterizeSpriteSymbol=function(a,d){return g(this,void 0,void 0,function(){var b,c,e,h,l,m;return f(this,function(f){if(E(a))return[2,null];b=I.keyFromSymbol(a);return this._spriteMosaic.has(b)?[2,this._spriteMosaic.getSpriteItem(b)]:"esriSMS"===a.type&&a.path?[2,this._handleSVG(a,b,d)]:a.url||a.imageData?[2,this._handleImage(a,b,d)]:(c=this._rasterizer.rasterizeJSONResource(a))?(e=c.size,h=c.image,l=c.sdf,m=c.simplePattern,[2,this._addItemToMosaic(b,e,{type:"static",
data:h},H(a),l,m)]):[2,new k("TextureManager","unrecognized or null rasterized image")]})})};d.prototype._handleSVG=function(a,d,b){return g(this,void 0,void 0,function(){var c,e;return f(this,function(h){switch(h.label){case 0:return c=[126,126],[4,this._sdfConverter.draw(a.path,b)];case 1:return e=h.sent(),[2,this._addItemToMosaic(d,c,{type:"static",data:new Uint32Array(e.buffer)},!1,!0,!0)]}})})};d.prototype._handleGIFOrPNG=function(a,d,b){return g(this,void 0,void 0,function(){var c,e,h,l,m,g,
p,u,r,w,q,n;return f(this,function(f){switch(f.label){case 0:return[4,L(a,b)];case 1:c=f.sent();if(!A.ok(c))return[3,10];e=B.isGIF(c);h=D.isPNG(c);if(!e&&!h)return[2,new k("mapview-invalid-resource","Image data is neither GIF nor PNG!")];l=void 0;f.label=2;case 2:return f.trys.push([2,7,,8]),e&&B.isAnimatedGIF(c)?[4,B.default.create(c,b)]:[3,4];case 3:return l=f.sent(),[3,6];case 4:return h&&D.isAnimatedPNG(c)?[4,D.default.create(c,b)]:[3,6];case 5:l=f.sent(),f.label=6;case 6:return[3,8];case 7:return m=
f.sent(),t.isAbortError(m)?[3,8]:[2,new k("mapview-invalid-resource","Could not fetch requested resource!")];case 8:if(l&&A.ok(l))return[2,this._addItemToMosaic(d,[l.width,l.height],{type:"animated",data:l},H(a),!1,!1)];g=e?"image/gif":"image/png";p=new Blob([c],{type:g});return[4,F(p)];case 9:if((u=f.sent())&&u instanceof HTMLImageElement)return r=this._rasterizer.rasterizeImageResource(u,a.colorSubstitutions),w=r.size,q=r.sdf,n=r.image,[2,this._addItemToMosaic(d,w,{type:"static",data:n},H(a),q,
!1)];f.label=10;case 10:return[2,new k("mapview-invalid-resource","Could not handle resource!")]}})})};d.prototype._handleImage=function(a,d,b){return g(this,void 0,void 0,function(){var c,h,l,m,g,p,u;return f(this,function(f){switch(f.label){case 0:var r;(r=a.url&&-1!==a.url.indexOf(".gif")||a.contentType&&"image/gif"===a.contentType||a.imageData&&-1!==a.imageData.indexOf("data:image/gif"))||(r=a.url&&-1!==a.url.indexOf(".png")||a.contentType&&"image/png"===a.contentType||a.imageData&&-1!==a.imageData.indexOf("data:image/png"));
if(r)return[2,this._handleGIFOrPNG(a,d,b)];c=a.imageData?"data:"+a.contentType+";base64,"+a.imageData:a.url;f.label=1;case 1:return f.trys.push([1,3,,4]),[4,n(c,e({responseType:"image"},b))];case 2:return h=f.sent().data,-1!==c.indexOf("data:image/svg+xml")&&(h.width=x.pt2px(a.width),h.height=x.pt2px(a.height)),l=this._rasterizer.rasterizeImageResource(h,a.colorSubstitutions),m=l.size,g=l.sdf,p=l.image,[2,this._addItemToMosaic(d,m,{type:"static",data:p},H(a),g,!1)];case 3:return u=f.sent(),t.isAbortError(u)?
[3,4]:[2,new k("mapview-invalid-resource","Could not fetch requested resource at "+c)];case 4:return[2,void 0]}})})};d.prototype._addItemToMosaic=function(a,d,b,c,e,h){return this._spriteMosaic.addSpriteItem(a,d,b,c,e,h)};return d}()})},"esri/symbols/cim/Rasterizer":function(){define(["require","exports","./CIMSymbolHelper","./SDFHelper","./utils"],function(b,c,e,g,f){Object.defineProperty(c,"__esModule",{value:!0});b=function(){function a(){}a.prototype.dispose=function(){this._rasterizationCanvas=
null};a.prototype.rasterizeJSONResource=function(a,b){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));if("simple-fill"===a.type||"esriSFS"===a.type)return b=e.SymbolHelper.rasterizeSimpleFill(this._rasterizationCanvas,a.style),{size:[b[1],b[2]],image:new Uint32Array(b[0].buffer),sdf:!1,simplePattern:!0,anchorX:0,anchorY:0};if("simple-line"===a.type||"esriSLS"===a.type)return b=e.SymbolHelper.rasterizeSimpleLine(a.style,a.cap),{size:[b[1],b[2]],image:new Uint32Array(b[0].buffer),
sdf:!0,simplePattern:!0,anchorX:0,anchorY:0};var d;a="simple-marker"===a.type||"esriSMS"===a.type?e.CIMSymbolHelper.fromSimpleMarker(a):a;if((d=g.getSDFInfo(a))&&!b)return b=g.buildSDF(d),(a=b[0])?{size:[b[1],b[2]],image:new Uint32Array(a.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}:null;b=e.CIMSymbolHelper.rasterize(this._rasterizationCanvas,a,!b);a=b[0];d=b[3];var c=b[4];return a?{size:[b[1],b[2]],image:new Uint32Array(a.buffer),sdf:!1,simplePattern:!1,anchorX:d,anchorY:c}:null};a.prototype.rasterizeImageResource=
function(a,b){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));this._rasterizationCanvas.width=a.width;this._rasterizationCanvas.height=a.height;var d=this._rasterizationCanvas.getContext("2d");a instanceof ImageData?d.putImageData(a,0,0):(a.setAttribute("width",a.width.toString()),a.setAttribute("height",a.height.toString()),d.drawImage(a,0,0,a.width,a.height));d=d.getImageData(0,0,a.width,a.height);d=new Uint8Array(d.data);if(b)for(var c=0;c<b.length;c++){var e=
b[c];if(e&&e.oldColor&&4===e.oldColor.length&&e.newColor&&4===e.newColor.length){var g=e.oldColor,k=g[0],m=g[1],n=g[2],g=g[3],q=e.newColor,e=q[0],v=q[1],p=q[2],r=q[3];if(k!==e||m!==v||n!==p||g!==r)for(q=0;q<d.length;q+=4)k===d[q]&&m===d[q+1]&&n===d[q+2]&&g===d[q+3]&&(d[q]=e,d[q+1]=v,d[q+2]=p,d[q+3]=r)}}for(q=0;q<d.length;q+=4)b=d[q+3]/255,d[q]*=b,d[q+1]*=b,d[q+2]*=b;b=a.width;c=a.height;k=d;if(512<=b||512<=c)k=a.width/a.height,1<k?(b=512,c=Math.round(512/k)):(c=512,b=Math.round(512*k)),k=new Uint8Array(4*
b*c),f.resampleHermite(d,a.width,a.height,new Uint8ClampedArray(k.buffer),b,c,!1);return{size:[b,c],image:new Uint32Array(k.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}};return a}();c.default=b})},"esri/symbols/cim/utils":function(){define(["require","exports"],function(b,c){Object.defineProperty(c,"__esModule",{value:!0});c.evaluateValueOrFunction=function(b,c,f,a){return"function"===typeof b?b(c,f,a):b};c.colorToArray=function(b){return[b.r,b.g,b.b,b.a]};c.resampleHermite=function(b,c,f,
a,n,k,d){void 0===d&&(d=!0);var e=c/n;f/=k;for(var g=Math.ceil(e/2),x=Math.ceil(f/2),w=0;w<k;w++)for(var m=0;m<n;m++){for(var z=4*(m+(d?k-w-1:w)*n),q=0,v=0,p=0,r=0,h=0,y=0,u=0,D=(w+.5)*f,B=Math.floor(w*f);B<(w+1)*f;B++)for(var C=Math.abs(D-(B+.5))/x,A=(m+.5)*e,C=C*C,I=Math.floor(m*e);I<(m+1)*e;I++){var E=Math.abs(A-(I+.5))/g,q=Math.sqrt(C+E*E);-1<=q&&1>=q&&(q=2*q*q*q-3*q*q+1,0<q&&(E=4*(I+B*c),u+=q*b[E+3],p+=q,255>b[E+3]&&(q=q*b[E+3]/250),r+=q*b[E],h+=q*b[E+1],y+=q*b[E+2],v+=q))}a[z]=r/v;a[z+1]=h/
v;a[z+2]=y/v;a[z+3]=u/p}}})},"esri/views/2d/engine/webgl/fontUtils":function(){define(["require","exports"],function(b,c){function e(b){b=b.toLowerCase().split(" ").join("-");switch(b){case "serif":return"noto-serif";case "sans-serif":return"arial-unicode-ms";case "monospace":return"ubuntu-mono";case "fantasy":return"cabin-sketch";case "cursive":return"redressed";default:return b}}Object.defineProperty(c,"__esModule",{value:!0});c.getFullyQualifiedFontName=function(b){var c;a:{if(b.weight)switch(b.weight.toLowerCase()){case "bold":case "bolder":c=
"-bold";break a}c=""}var a;a:{if(b.style)switch(b.style.toLowerCase()){case "italic":case "oblic":a="-italic";break a}a=""}c+=a;return e(b.family)+(0<c.length?c:"-regular")};c.getFontDecorationTop=function(b){switch(b){case "underline":return-26;case "line-through":return-18}return NaN}})},"esri/views/2d/engine/webgl/GlyphMosaic":function(){define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/has ../../../../core/promiseUtils ../../../webgl ./Rect ./RectangleBinPack".split(" "),
function(b,c,e,g,f,a,n,k,d){function l(a){for(var b=new Set,d=0;d<a.length;d++)b.add(Math.floor(a[d]/256));return b}function t(b,d,c){b.has(d)||b.set(d,c().then(function(){b.delete(d)}).catch(function(c){b.delete(d);a.throwIfNotAbortError(c)}));return b.get(d)}return function(){function b(a,b,c){this.height=this.width=0;this._dirties=[];this._glyphData=[];this._currentPage=0;this._glyphCache={};this._textures=[];this._rangePromises=new Map;this.width=a;this.height=b;this._glyphSource=c;this._binPack=
new d(a-4,b-4);this._glyphData.push(new Uint8Array(a*b));this._dirties.push(!0);this._textures.push(null);this._initDecorationGlyph()}b.prototype.dispose=function(){this._binPack=null;for(var a=0,b=this._textures;a<b.length;a++){var d=b[a];d&&d.dispose()}this._textures.length=0;this._glyphData.length=0};b.prototype._initDecorationGlyph=function(){for(var a=[117,149,181,207,207,181,149,117],b=[],d=0;d<a.length;d++)for(var c=a[d],e=0;11>e;e++)b.push(c);a={metrics:{width:5,height:2,left:0,top:0,advance:0},
bitmap:new Uint8Array(b)};this._recordGlyph(a)};b.prototype.getGlyphItems=function(a,b,d){return g(this,void 0,void 0,function(){var c,f=this;return e(this,function(e){switch(e.label){case 0:return c=this._getGlyphCache(a),[4,this._fetchRanges(a,b,d)];case 1:return e.sent(),[2,b.map(function(b){return f._getMosaicItem(c,a,b)})]}})})};b.prototype.bind=function(a,b,d,c){var e=this._getTexture(a,d);e.setSamplingMode(b);this._dirties[d]&&(e.setData(this._glyphData[d]),this._dirties[d]=!1);a.bindTexture(e,
c)};b.prototype._getGlyphCache=function(a){this._glyphCache[a]||(this._glyphCache[a]={});return this._glyphCache[a]};b.prototype._getTexture=function(a,b){this._textures[b]||(this._textures[b]=new n.Texture(a,{pixelFormat:6406,dataType:5121,width:this.width,height:this.height},new Uint8Array(this.width*this.height)));return this._textures[b]};b.prototype._invalidate=function(){this._dirties[this._currentPage]=!0};b.prototype._fetchRanges=function(b,d,c){return g(this,void 0,void 0,function(){var f,
g,m=this;return e(this,function(e){switch(e.label){case 0:return f=l(d),g=[],f.forEach(function(a){g.push(m._fetchRange(b,a,c))}),[4,a.all(g)];case 1:return e.sent(),[2]}})})};b.prototype._fetchRange=function(a,b,d){return g(this,void 0,void 0,function(){var c,f=this;return e(this,function(e){if(256<b)return[2,null];c=a+b;return[2,t(this._rangePromises,c,function(){return f._glyphSource.getRange(a,b,d)})]})})};b.prototype._getMosaicItem=function(a,b,d){if(!a[d]){b=this._glyphSource.getGlyph(b,d);
if(!b||!b.metrics)return{rect:new k.default(0,0,0,0),page:0,metrics:{left:0,width:0,height:0,advance:0,top:0},code:d,sdf:!0};var c=this._recordGlyph(b);a[d]={rect:c,page:this._currentPage,metrics:b.metrics,code:d,sdf:!0};this._invalidate()}return a[d]};b.prototype._getMosaicItemsStable=function(a,b,d){var c=this,e=[],f=d.map(function(a){return a});d.map(function(a){return a}).sort().map(function(d){return c._getMosaicItem(a,b,d)}).forEach(function(a){var b=f.indexOf(a.code);e[b]=a;f[b]=null});return e};
b.prototype._recordGlyph=function(a){var b=a.metrics;if(0===b.width)b=new k.default(0,0,0,0);else{var c=b.width+6,e=b.height+6,b=this._binPack.allocate(c,e);b.isEmpty&&(this._dirties[this._currentPage]||(this._glyphData[this._currentPage]=null),this._currentPage=this._glyphData.length,this._glyphData.push(new Uint8Array(this.width*this.height)),this._dirties.push(!0),this._textures.push(null),this._initDecorationGlyph(),this._binPack=new d(this.width-4,this.height-4),b=this._binPack.allocate(c,e));
var l=this._glyphData[this._currentPage];a=a.bitmap;var g=void 0,r=void 0;if(a)for(var h=0;h<e;h++)for(var g=c*h,r=this.width*(b.y+h)+b.x,t=0;t<c;t++)l[r+t]=a[g+t];f("esri-glyph-debug")&&this._showDebugPage(l)}return b};b.prototype._showDebugPage=function(a){var b=document.createElement("canvas"),d=b.getContext("2d"),c=new ImageData(this.width,this.height),e=c.data;b.width=this.width;b.height=this.height;b.style.border="1px solid black";for(var f=0;f<a.length;++f)e[4*f+0]=a[f],e[4*f+1]=0,e[4*f+2]=
0,e[4*f+3]=255;d.putImageData(c,0,0);document.body.appendChild(b)};return b}()})},"esri/views/2d/engine/webgl/Rect":function(){define(["require","exports"],function(b,c){Object.defineProperty(c,"__esModule",{value:!0});b=function(){function b(b,c,a,e){void 0===b&&(b=0);void 0===c&&(c=0);void 0===a&&(a=0);void 0===e&&(e=0);this.x=b;this.y=c;this.width=a;this.height=e}Object.defineProperty(b.prototype,"isEmpty",{get:function(){return 0>=this.width||0>=this.height},enumerable:!0,configurable:!0});b.prototype.union=
function(b){this.x=Math.min(this.x,b.x);this.y=Math.min(this.y,b.y);this.width=Math.max(this.width,b.width);this.height=Math.max(this.height,b.height)};return b}();c.default=b})},"esri/views/2d/engine/webgl/RectangleBinPack":function(){define(["require","exports","./Rect"],function(b,c,e){return function(){function b(b,a){this._height=this._width=0;this._free=[];this._width=b;this._height=a;this._free.push(new e.default(0,0,b,a))}Object.defineProperty(b.prototype,"width",{get:function(){return this._width},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0});b.prototype.allocate=function(b,a){if(b>this._width||a>this._height)return new e.default;for(var c=null,f=-1,d=0;d<this._free.length;++d){var l=this._free[d];b<=l.width&&a<=l.height&&(null===c||l.y<=c.y&&l.x<=c.x)&&(c=l,f=d)}if(null===c)return new e.default;this._free.splice(f,1);c.width<c.height?(c.width>b&&this._free.push(new e.default(c.x+b,c.y,c.width-
b,a)),c.height>a&&this._free.push(new e.default(c.x,c.y+a,c.width,c.height-a))):(c.width>b&&this._free.push(new e.default(c.x+b,c.y,c.width-b,c.height)),c.height>a&&this._free.push(new e.default(c.x,c.y+a,b,c.height-a)));return new e.default(c.x,c.y,b,a)};b.prototype.release=function(b){for(var a=0;a<this._free.length;++a){var c=this._free[a];if(c.y===b.y&&c.height===b.height&&c.x+c.width===b.x)c.width+=b.width;else if(c.x===b.x&&c.width===b.width&&c.y+c.height===b.y)c.height+=b.height;else if(b.y===
c.y&&b.height===c.height&&b.x+b.width===c.x)c.x=b.x,c.width+=b.width;else if(b.x===c.x&&b.width===c.width&&b.y+b.height===c.y)c.y=b.y,c.height+=b.height;else continue;this._free.splice(a,1);this.release(b)}this._free.push(b)};return b}()})},"esri/views/2d/engine/webgl/GlyphSource":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../request ../../../../core/pbf ../../../../core/promiseUtils".split(" "),function(b,c,e,g,f,a){var n=function(){function a(a){this._metrics=
[];for(this._bitmaps=[];a.next();)switch(a.tag()){case 1:for(var b=a.getMessage();b.next();)switch(b.tag()){case 3:for(var d=b.getMessage(),c=void 0,e=void 0,f=void 0,l=void 0,g=void 0,p=void 0,r=void 0;d.next();)switch(d.tag()){case 1:c=d.getUInt32();break;case 2:e=d.getBytes();break;case 3:f=d.getUInt32();break;case 4:l=d.getUInt32();break;case 5:g=d.getSInt32();break;case 6:p=d.getSInt32();break;case 7:r=d.getUInt32();break;default:d.skip()}d.release();c&&(this._metrics[c]={width:f,height:l,left:g,
top:p,advance:r},this._bitmaps[c]=e);break;default:b.skip()}b.release();break;default:a.skip()}}a.prototype.getMetrics=function(a){return this._metrics[a]};a.prototype.getBitmap=function(a){return this._bitmaps[a]};return a}(),k=function(){function a(){this._ranges=[]}a.prototype.getRange=function(a){return this._ranges[a]};a.prototype.addRange=function(a,b){this._ranges[a]=b};return a}();return function(){function b(a){this._glyphInfo={};this._baseURL=a}b.prototype.getRange=function(b,d,c){var l=
this._getFontStack(b);if(l.getRange(d))return a.resolve();var m=256*d,k=m+255;b=this._baseURL.replace("{fontstack}",b).replace("{range}",m+"-"+k);return g(b,e({responseType:"array-buffer"},c)).then(function(a){l.addRange(d,new n(new f(new Uint8Array(a.data),new DataView(a.data))))})};b.prototype.getGlyph=function(a,b){if(a=this._getFontStack(a)){var d=Math.floor(b/256);if(!(256<d)&&(a=a.getRange(d)))return{metrics:a.getMetrics(b),bitmap:a.getBitmap(b)}}};b.prototype._getFontStack=function(a){var b=
this._glyphInfo[a];b||(b=this._glyphInfo[a]=new k);return b};return b}()})},"esri/views/2d/engine/webgl/SDFConverter":function(){define(["require","exports","../../../../core/promiseUtils","../../../../core/promiseUtils","./packingUtils"],function(b,c,e,g,f){Object.defineProperty(c,"__esModule",{value:!0});b=function(){function a(a){this.size=a;this.canvas=document.createElement("canvas");this.canvas.width=this.canvas.height=a;this.context=this.canvas.getContext("2d");this._gridOuter=new Float64Array(a*
a);this._gridInner=new Float64Array(a*a);this._f=new Float64Array(a);this._d=new Float64Array(a);this._z=new Float64Array(a+1);this._v=new Int16Array(a)}a.prototype.draw=function(a,b,d){var c=this;void 0===d&&(d=31);this._initSVG();var k=this._createSVGString(a);return e.create(function(a,e){var l=new Image;l.src="data:image/svg+xml; charset\x3dutf8, "+encodeURIComponent(k);l.onload=function(){c.context.clearRect(0,0,c.size,c.size);c.context.drawImage(l,0,0,c.size,c.size);for(var b=c.context.getImageData(0,
0,c.size,c.size),e=new Uint8Array(c.size*c.size*4),g=0;g<c.size*c.size;g++){var m=b.data[4*g+3]/255;c._gridOuter[g]=1===m?0:0===m?1E20:Math.pow(Math.max(0,.5-m),2);c._gridInner[g]=1===m?1E20:0===m?0:Math.pow(Math.max(0,m-.5),2)}c._edt(c._gridOuter,c.size,c.size);c._edt(c._gridInner,c.size,c.size);for(g=0;g<c.size*c.size;g++)f.packFloatRGBA(.5-(c._gridOuter[g]-c._gridInner[g])/(2*d),e,4*g);a(e)};var t=b&&b.signal;if(t)g.onAbort(t,function(){return e(g.createAbortError())})})};a.prototype._initSVG=
function(){if(!this._svg){var a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.setAttribute("style","position: absolute;");a.setAttribute("width","0");a.setAttribute("height","0");a.setAttribute("aria-hidden","true");a.setAttribute("role","presentation");document.body.appendChild(a);this._svg=a}};a.prototype._createSVGString=function(a){var b=document.createElementNS("http://www.w3.org/2000/svg","path");b.setAttribute("d",a);this._svg.appendChild(b);a=b.getBBox();var d=a.width/a.height,
c=this.size/2,e,f,g;1<d?(f=e=c/a.width,g=this.size/4,d=c-1/d*c/2):(e=f=c/a.height,g=c-c*d/2,d=this.size/4);b.setAttribute("style","transform: matrix("+e+", 0, 0, "+f+", "+(-a.x*e+g)+", "+(-a.y*f+d)+")");a='\x3csvg style\x3d"fill:red;" height\x3d"'+this.size+'" width\x3d"'+this.size+'" xmlns\x3d"http://www.w3.org/2000/svg"\x3e'+this._svg.innerHTML+"\x3c/svg\x3e";this._svg.removeChild(b);return a};a.prototype._edt=function(a,b,d){for(var c=this._f,e=this._d,f=this._v,g=this._z,m=0;m<b;m++){for(var k=
0;k<d;k++)c[k]=a[k*b+m];this._edt1d(c,e,f,g,d);for(k=0;k<d;k++)a[k*b+m]=e[k]}for(k=0;k<d;k++){for(m=0;m<b;m++)c[m]=a[k*b+m];this._edt1d(c,e,f,g,b);for(m=0;m<b;m++)a[k*b+m]=Math.sqrt(e[m])}};a.prototype._edt1d=function(a,b,d,c,e){d[0]=0;c[0]=-1E20;c[1]=1E20;for(var f=1,l=0;f<e;f++){for(var g=(a[f]+f*f-(a[d[l]]+d[l]*d[l]))/(2*f-2*d[l]);g<=c[l];)l--,g=(a[f]+f*f-(a[d[l]]+d[l]*d[l]))/(2*f-2*d[l]);l++;d[l]=f;c[l]=g;c[l+1]=1E20}for(l=f=0;f<e;f++){for(;c[l+1]<f;)l++;b[f]=(f-d[l])*(f-d[l])+a[d[l]]}};return a}();
c.default=b})},"esri/views/2d/engine/webgl/packingUtils":function(){define(["require","exports"],function(b,c){function e(a){return a-Math.floor(a)}Object.defineProperty(c,"__esModule",{value:!0});var g=[1,256,65536,16777216],f=[1/256,1/65536,1/16777216,1/4294967296],a=function(a,b){void 0===b&&(b=0);for(var d=0,c=0;4>c;c++)d+=a[b+c]*f[c];return d}(new Uint8ClampedArray([255,255,255,255]));c.packFloatRGBA=function(b,c,d){void 0===d&&(d=0);b=0>b?0:b>a?a:b;for(var f=0;4>f;f++)c[d+f]=Math.floor(256*
e(b*g[f]))}})},"esri/views/2d/engine/webgl/SpriteMosaic":function(){define("require exports ../../../../core/Error ../../../../core/has ../../../../core/maybe ../../../webgl ./GeometryUtils ./Rect ./RectangleBinPack".split(" "),function(b,c,e,g,f,a,n,k,d){function l(a){return a&&"static"===a.type}return function(){function b(a,b,c,e){void 0===e&&(e=0);this._mosaicPages=[];this._currentPage=this._maxItemSize=0;this._fixSpriteLocationsTable=g("fix-sprite-locations");this._testId=g("test-id");this._pageHeight=
this._pageWidth=0;this._mosaicRects=new Map;this._spriteCopyQueue=[];this.pixelRatio=1;(0>=b||0>=c)&&console.error("Sprites mosaic defaultWidth and defaultHeight must be greater than zero!");this._pageWidth=b;this._pageHeight=c;this._requestRender=a;0<e&&(this._maxItemSize=e);this.pixelRatio=window.devicePixelRatio||1;if(this._fixSpriteLocationsTable){a=[];for(var f in this._fixSpriteLocationsTable[this._testId])b=this._fixSpriteLocationsTable[this._testId][f],a[b.page]=b.pageSize;for(f=0;f<a.length;f++)b=
a[f],this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(b[0]*b[1])},size:[b[0],b[1]],dirty:!0,texture:void 0})}this._binPack=new d(this._pageWidth,this._pageHeight);this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(Math.floor(this._pageWidth)*Math.floor(this._pageHeight))},size:[this._pageWidth,this._pageHeight],dirty:!0,texture:void 0})}b.prototype.getWidth=function(a){return a>=this._mosaicPages.length?-1:this._mosaicPages[a].size[0]};b.prototype.getHeight=
function(a){return a>=this._mosaicPages.length?-1:this._mosaicPages[a].size[1]};b.prototype.getPageTexture=function(a){return a<this._mosaicPages.length?this._mosaicPages[a].texture:null};b.prototype.has=function(a){return this._mosaicRects.has(a)};Object.defineProperty(b.prototype,"itemCount",{get:function(){return this._mosaicRects.size},enumerable:!0,configurable:!0});b.prototype.getSpriteItem=function(a){return this._mosaicRects.get(a)};b.prototype.addSpriteItem=function(a,b,d,c,e,f){var g;if(this._mosaicRects.has(a))return this._mosaicRects.get(a);
var m,h;l(d)?this._fixSpriteLocationsTable&&this._fixSpriteLocationsTable[this._testId]&&this._fixSpriteLocationsTable[this._testId][a]?(g=this._fixSpriteLocationsTable[this._testId][a],m=g.rect,h=g.page,g=g.pageSize):(g=this._allocateImage(b[0],b[1]),m=g[0],h=g[1],g=g[2]):(m=new k.default(0,0,b[0],b[1]),h=this._mosaicPages.length,this._mosaicPages.push({mosaicsData:d,size:b,dirty:!0,texture:void 0}));if(0>=m.width||0>=m.height)return null;f={rect:m,width:b[0],height:b[1],sdf:e,simplePattern:f,pixelRatio:1,
page:h};this._mosaicRects.set(a,f);l(d)&&this._copy({rect:m,spriteSize:b,spriteData:d.data,page:h,pageSize:g,repeat:c,sdf:e});return f};b.prototype.hasItemsToProcess=function(){return 0!==this._spriteCopyQueue.length};b.prototype.processNextItem=function(){var a=this._spriteCopyQueue.pop();a&&this._copy(a)};b.prototype.getSpriteItems=function(a){for(var b={},d=0;d<a.length;d++){var c=a[d];b[c]=this.getSpriteItem(c)}return b};b.prototype.getMosaicItemPosition=function(a){var b=(a=this.getSpriteItem(a))&&
a.rect;if(!b)return null;b.width=a.width;b.height=a.height;var d=this._mosaicPages[a.page];return{size:[a.width,a.height],tl:[(b.x+1)/d[0],(b.y+1)/d[1]],br:[(b.x+1+a.width)/d[0],(b.y+1+a.height)/d[1]],page:a.page}};b.prototype.bind=function(b,d,c,e){void 0===c&&(c=0);void 0===e&&(e=0);c=this._mosaicPages[c];var g=c.mosaicsData,m=c.texture;m||(m=c.size,m=l(g)?new a.Texture(b,{pixelFormat:6408,dataType:5121,width:m[0],height:m[1]},new Uint8Array(g.data.buffer)):new a.Texture(b,{pixelFormat:6408,dataType:5121,
samplingMode:9729,wrapMode:33071,width:m[0],height:m[1]},null),c.texture=m);m.setSamplingMode(d);l(g)?(b.bindTexture(m,e),c.dirty&&(m.setData(new Uint8Array(g.data.buffer)),m.generateMipmap())):(d=g.data,g=d.bindFrame(b,m,e),f.isSome(this._requestRender)&&g&&0<d.frameCount&&this._requestRender.requestRender(),d.bindFrame(b,m,e));c.dirty=!1};b._copyBits=function(a,b,d,c,e,f,l,g,h,k,u){var m=c*b+d;l=g*f+l;if(u)for(l-=f,u=-1;u<=k;u++,m=((u+k)%k+c)*b+d,l+=f)for(g=-1;g<=h;g++)e[l+g]=a[m+(g+h)%h];else for(u=
0;u<k;u++){for(g=0;g<h;g++)e[l+g]=a[m+g];m+=b;l+=f}};b.prototype._copy=function(a){if(!(a.page>=this._mosaicPages.length)){var d=this._mosaicPages[a.page],c=d.mosaicsData;if(!l(d.mosaicsData))throw new e("mapview-invalid-resource","unsuitable data type!");var f=a.spriteData;(c=c.data)&&f||console.error("Source or target images are uninitialized!");b._copyBits(f,a.spriteSize[0],0,0,c,a.pageSize[0],a.rect.x+1,a.rect.y+1,a.spriteSize[0],a.spriteSize[1],a.repeat);d.dirty=!0}};b.prototype._allocateImage=
function(a,b){a+=2;b+=2;var c=Math.max(a,b);if(this._maxItemSize&&this._maxItemSize<c){var c=Math.pow(2,Math.ceil(n.log2(a))),e=Math.pow(2,Math.ceil(n.log2(b)));a=new k.default(0,0,a,b);this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(c*e)},size:[c,e],dirty:!0,texture:void 0});return[a,this._mosaicPages.length-1,[c,e]]}c=this._binPack.allocate(a,b);return 0>=c.width?(c=this._mosaicPages[this._currentPage],!c.dirty&&l(c.mosaicsData)&&(c.mosaicsData=null),this._currentPage=this._mosaicPages.length,
this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(this._pageWidth*this._pageHeight)},size:[this._pageWidth,this._pageHeight],dirty:!0,texture:void 0}),this._binPack=new d(this._pageWidth,this._pageHeight),this._allocateImage(a,b)):[c,this._currentPage,[this._pageWidth,this._pageHeight]]};b.prototype.dispose=function(){this._binPack=null;for(var a=0,b=this._mosaicPages;a<b.length;a++){var d=b[a],c=d.texture;c&&c.dispose();d=d.mosaicsData;l(d)||d.data.pause()}this._mosaicPages=
null;this._mosaicRects.clear()};return b}()})},"esri/views/2d/engine/webgl/GeometryUtils":function(){define(["require","exports"],function(b,c){function e(b,a){b%=a;return 0<=b?b:b+a}Object.defineProperty(c,"__esModule",{value:!0});c.C_INFINITY=Number.POSITIVE_INFINITY;c.C_PI=Math.PI;c.C_2PI=2*c.C_PI;c.C_PI_BY_2=c.C_PI/2;c.C_RAD_TO_256=128/c.C_PI;c.C_256_TO_RAD=c.C_PI/128;c.C_DEG_TO_256=256/360;c.C_DEG_TO_RAD=c.C_PI/180;c.C_SQRT2=1.414213562;c.C_SQRT2_INV=1/c.C_SQRT2;var g=1/Math.LN2;c.positiveMod=
e;c.radToByte=function(b){return e(b*c.C_RAD_TO_256,256)};c.degToByte=function(b){return e(b*c.C_DEG_TO_256,256)};c.log2=function(b){return Math.log(b)*g};c.sqr=function(b){return b*b};c.interpolate=function(b,a,c){return b*(1-c)+a*c};c.between=function(b,a,c){return b>=a&&b<=c||b>=c&&b<=a}})},"esri/views/2d/engine/webgl/animatedFormats/apng":function(){define("require exports ../../../../../core/tsSupport/generatorHelper ../../../../../core/tsSupport/awaiterHelper ../../../../../core/tsSupport/assignHelper ../../../../../core/Error ../../../../../core/promiseUtils".split(" "),
function(b,c,e,g,f,a,n){function k(a){var b=a.constructor===Uint8Array?a:new Uint8Array(a);return r.some(function(a,d){return a!==b[d]})?!1:!0}function d(a,b){var d=new Uint8Array(b);if(r.some(function(a,b){return a!==d[b]}))return v;var c=!1;l(d,function(a){return!(c="acTL"===a)});if(!c)return p;var e=[],f=[],g=null,u=null,k=0;l(d,function(b,d,c,l){var m=new DataView(d.buffer);switch(b){case "IHDR":g=d.subarray(c+8,c+8+l);a.width=m.getUint32(c+8);a.height=m.getUint32(c+12);break;case "acTL":a.numPlays=
m.getUint32(c+8+4);break;case "fcTL":u&&(a.frames.push(u),k++);u=new h;u.width=m.getUint32(c+8+4);u.height=m.getUint32(c+8+8);u.left=m.getUint32(c+8+12);u.top=m.getUint32(c+8+16);b=m.getUint16(c+8+20);d=m.getUint16(c+8+22);0===d&&(d=100);u.delay=1E3*b/d;10>=u.delay&&(u.delay=100);a.playTime+=u.delay;u.disposeOp=m.getUint8(c+8+24);u.blendOp=m.getUint8(c+8+25);u.dataParts=[];0===k&&2===u.disposeOp&&(u.disposeOp=1);break;case "fdAT":u&&u.dataParts.push(d.subarray(c+8+4,c+8+l));break;case "IDAT":u&&u.dataParts.push(d.subarray(c+
8,c+8+l));break;case "IEND":f.push(x(d,c,12+l));break;default:e.push(x(d,c,12+l))}});if(0===a.frames.length)return p;a.frameCount=a.frames.length;var q=new Blob(e),t=new Blob(f);a.frames.forEach(function(a){var b=[];b.push(r);g.set(m(a.width),0);g.set(m(a.height),4);b.push(w("IHDR",g));b.push(q);a.dataParts.forEach(function(a){return b.push(w("IDAT",a))});b.push(t);a.data=new Blob(b,{type:"image/png"});delete a.dataParts;b=null});return a}function l(a,b){var d=new DataView(a.buffer),c=8,e,h,f;do h=
d.getUint32(c),e=c+4,e=Array.prototype.slice.call(a.subarray(e,e+4)),e=String.fromCharCode.apply(String,e),f=b(e,a,c,h),c+=12+h;while(!1!==f&&"IEND"!==e&&c<a.length)}function t(a){for(var b=new Uint8Array(a.length),d=0;d<a.length;d++)b[d]=a.charCodeAt(d);return b}function x(a,b,d){var c=new Uint8Array(d);c.set(a.subarray(b,b+d));return c}function w(a,b){var d=a.length+b.length,c=new Uint8Array(d+8),e=new DataView(c.buffer);e.setUint32(0,b.length);c.set(t(a),4);c.set(b,8);var h=4,f=d;void 0===h&&(h=
0);void 0===f&&(f=c.length-h);a=-1;b=h;for(h+=f;b<h;b++)a=a>>>8^z[(a^c[b])&255];e.setUint32(d+4,a^-1);return c}function m(a){return new Uint8Array([a>>>24&255,a>>>16&255,a>>>8&255,a&255])}Object.defineProperty(c,"__esModule",{value:!0});var z=new Uint32Array(256);for(b=0;256>b;b++){f=b;for(var q=0;8>q;q++)f=0!==(f&1)?3988292384^f>>>1:f>>>1;z[b]=f}var v=new a("Not a PNG"),p=new a("Not an animated PNG"),r=new Uint8Array([137,80,78,71,13,10,26,10]);c.isPNG=k;c.getPNGSize=function(a){a=new Uint8Array(a);
var b,d;l(a,function(a,c,e){c=new DataView(c.buffer);"IHDR"===a&&(b=c.getUint32(e+8),d=c.getUint32(e+12))});return[b,d]};c.isAnimatedPNG=function(a){a=new Uint8Array(a);if(!k(a))return!1;var b=!1;l(a,function(a){return!(b="acTL"===a)});return b};b=function(){function b(){this.playTime=this.numPlays=this.height=this.width=0;this.frames=[];this.playing=this.paused=!1;this.playSpeed=1;this.currentFrameNumber=0;this._lastUsedFrame=-1}b.create=function(d,c){return g(this,void 0,void 0,function(){var h,
f;return e(this,function(e){switch(e.label){case 0:h=new b,e.label=1;case 1:return e.trys.push([1,3,,4]),[4,h._load(d,c)];case 2:return e.sent(),[3,4];case 3:return f=e.sent(),n.isAbortError(f)?[3,4]:[2,new a("invalid-resource","Could not load PNG: "+f.message)];case 4:return[2,h]}})})};b.prototype.play=function(){this.playing||(this.paused=!1,this.playing=!0,this._play())};b.prototype.pause=function(){this.paused=!0;this.playing=!1;clearTimeout(this.timerID)};b.prototype.togglePlay=function(){this.paused||
!this.playing?this.play():this.pause()};b.prototype.bindFrame=function(a,b,d){a.bindTexture(b,d);a=this.frameChanged();if(!a)return!1;d=this.currentFrame;var c=d.frameData,e=b.descriptor;(d.left||d.top||d.width!==e.width||d.height!==e.height)&&b.setData(null);b.updateData(0,d.left,d.top,d.width,d.height,c);this.updateUsedFrame();return a};b.prototype.frameChanged=function(){return this._lastUsedFrame!==this.currentFrameNumber};b.prototype.updateUsedFrame=function(){this._lastUsedFrame=this.currentFrameNumber};
b.prototype._load=function(b,c){return g(this,void 0,void 0,function(){var c,h,f=this;return e(this,function(e){switch(e.label){case 0:e.trys.push([0,2,,3]);c=d(this,b);if(c!==this)return[2,c];this._resizeCanvas=document.createElement("canvas");this._resizeCanvas.width=this.width;this._resizeCanvas.height=this.height;return[4,n.all(this.frames.map(function(a){return a.createImage(f._resizeCanvas)}))];case 1:return e.sent(),[3,3];case 2:return h=e.sent(),n.isAbortError(h)?[3,3]:[2,new a("invalid-resource",
"Could not parse PNG")];case 3:return this.play(),[2]}})})};b.prototype._play=function(){var a=this,b;if(0===this.playSpeed)this.pause();else{0>this.playSpeed?(--this.currentFrameNumber,0>this.currentFrameNumber&&(this.currentFrameNumber=this.frames.length-1),b=this.currentFrameNumber,--b,0>b&&(b=this.frames.length-1),b=1*-this.frames[b].delay/this.playSpeed):(this.currentFrameNumber+=1,this.currentFrameNumber%=this.frames.length,b=1*this.frames[this.currentFrameNumber].delay/this.playSpeed);var d=
this.frames[this.currentFrameNumber];this.currentFrame={frameData:d.imageData,top:d.top,left:d.left,width:d.width,height:d.height};this.timerID=window.setTimeout(function(){return a._play()},b)}};return b}();c.default=b;var h=function(){function a(){this.blendOp=this.disposeOp=this.delay=this.height=this.width=this.top=this.left=0;this.imageData=this.data=null}a.prototype.createImage=function(a){return g(this,void 0,void 0,function(){var b=this;return e(this,function(d){return null!==this.imageData?
[2]:[2,n.create(function(d,c){var e=URL.createObjectURL(b.data),h=document.createElement("img");h.onload=function(){URL.revokeObjectURL(e);var c;a.width=h.width;a.height=h.height;c=a.getContext("2d");c.drawImage(h,0,0,h.width,h.height);c=c.getImageData(0,0,h.width,h.height);c=new Uint8Array(c.data);for(var f,l=0;l<c.length;l+=4)f=c[l+3]/255,c[l]*=f,c[l+1]*=f,c[l+2]*=f;c=new ImageData(new Uint8ClampedArray(c.buffer),h.width,h.height);b.imageData=c;d()};h.onerror=function(){URL.revokeObjectURL(e);b.imageData=
null;c(Error("Image creation error"))};h.src=e})]})})};return a}()})},"esri/views/2d/engine/webgl/animatedFormats/gif":function(){define("require exports ../../../../../core/tsSupport/generatorHelper ../../../../../core/tsSupport/awaiterHelper ../../../../../core/tsSupport/assignHelper ../../../../../core/Error ../../../../../core/promiseUtils".split(" "),function(b,c,e,g,f,a,n){function k(a){if(!a||0===a.byteLength)return!1;a=a.constructor===Uint8Array?a:new Uint8Array(a);return 71===a[0]&&73===
a[1]&&70===a[2]&&56===a[3]}Object.defineProperty(c,"__esModule",{value:!0});c.isGIF=k;c.getGIFSize=function(a){var b=new Uint8ClampedArray(a),d=6;a=b[d++]+(b[d++]<<8);b=b[d++]+(b[d++]<<8);return[a,b]};c.isAnimatedGIF=function(a){if(!a||0===a.byteLength)return!1;a=new Uint8Array(a);if(!k(a))return!1;for(var b=0,d=0,c=a.length-9;d<c&&(0!==a[d]||33!==a[d+1]||249!==a[d+2]||4!==a[d+3]||0!==a[d+8]||44!==a[d+9]&&33!==a[d+9]||(b++,!(1<b)));++d);return 1<b};b=function(){function b(){this.playing=this.paused=
!1;this.waitTillDone=!0;this.firstFrameOnly=this.loading=!1;this.frames=[];this.comment="";this.frameCount=this.currentFrameNumber=this.length=0;this.playSpeed=1;this.lastFrame=null;this.playOnLoad=!0;this.complete=!1;this.interlaceOffsets=[0,4,2,1];this.interlaceSteps=[8,8,4,2];this._lastUsedFrame=-1}b.create=function(d,c){return g(this,void 0,void 0,function(){var f,g;return e(this,function(e){switch(e.label){case 0:f=new b,e.label=1;case 1:return e.trys.push([1,3,,4]),[4,f._load(d,c)];case 2:return e.sent(),
[3,4];case 3:return g=e.sent(),n.isAbortError(g)?[3,4]:[2,new a("invalid-resource","Could not load PNG: "+g.message)];case 4:return[2,f]}})})};b.prototype.play=function(){this.playing||(this.paused=!1,this.playing=!0,this._play())};b.prototype.pause=function(){this.paused=!0;this.playing=!1;clearTimeout(this.timerID)};b.prototype.togglePlay=function(){this.paused||!this.playing?this.play():this.pause()};b.prototype.bindFrame=function(a,b,d){a.bindTexture(b,d);if(a=this.frameChanged())d=this.currentFrame,
b.updateData(0,0,0,d.width,d.height,d.frameData),this.updateUsedFrame();return a};b.prototype.seekFrame=function(a){clearTimeout(this.timerID);this.currentFrameNumber=a%this.frames.length;this.playing?this._play():this._setCurrentFrame(this.currentFrameNumber)};b.prototype.seek=function(a){clearTimeout(this.timerID);0>a&&(a=0);a=1E3*a%this.length;for(var b=0;a>this.frames[b].time+this.frames[b].delay&&b<this.frames.length;)b+=1;this.currentFrameNumber=b;this.playing?this._play():this._setCurrentFrame(this.currentFrameNumber)};
b.prototype.frameChanged=function(){return this._lastUsedFrame!==this.currentFrameNumber};b.prototype.updateUsedFrame=function(){this._lastUsedFrame=this.currentFrameNumber};b.prototype._load=function(b,d){return g(this,void 0,void 0,function(){var c;return e(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),this.loading=!0,[4,this._parse(b,d)];case 1:return e.sent(),this.loading=!1,this.play(),[3,3];case 2:return c=e.sent(),n.isAbortError(c)?[3,3]:[2,new a("invalid-resource","Could not parse gif!")];
case 3:return[2]}})})};b.prototype._parse=function(a,b){var c=this,e=new d(a);e.pos+=6;this.width=e.data[e.pos++]+(e.data[e.pos++]<<8);this.height=e.data[e.pos++]+(e.data[e.pos++]<<8);a=e.data[e.pos++];this.globalColourCount=1<<(a&7)+1;e.pos++;e.pos++;a&128&&(this.globalColourTable=this._parseColourTable(this.globalColourCount,e));return n.create(function(a,d){setTimeout(function(){return c._parseBlock(e,a,d,b)},0)})};b.prototype._parseBlock=function(a,b,d,c){return g(this,void 0,void 0,function(){var f,
g=this;return e(this,function(e){if(c&&c.signal&&n.isAborted(c.signal))return d(n.createAbortError()),[2];f=a.data[a.pos++];if(44===f){if(this._parseImg(a),this.firstFrameOnly)return this._finishedLoading(),b(),[2]}else{if(59===f)return this._finishedLoading(),b(),[2];this._parseExt(a)}if("function"===typeof this.onprogress)this.onprogress({bytesRead:a.pos,totalBytes:a.data.length,frame:this.frames.length});setTimeout(function(){return g._parseBlock(a,b,d,c)},0);return[2]})})};b.prototype._parseColourTable=
function(a,b){for(var d=[],c=0;c<a;c++)d.push([b.data[b.pos++],b.data[b.pos++],b.data[b.pos++]]);return d};b.prototype._parseImg=function(a){var b={};this.frames.push(b);b.disposalMethod=this.disposalMethod;b.time=this.length;b.delay=10*this.delayTime;this.length+=b.delay;b.transparencyIndex=this.transparencyGiven?this.transparencyIndex:void 0;b.leftPos=a.data[a.pos++]+(a.data[a.pos++]<<8);b.topPos=a.data[a.pos++]+(a.data[a.pos++]<<8);b.width=a.data[a.pos++]+(a.data[a.pos++]<<8);b.height=a.data[a.pos++]+
(a.data[a.pos++]<<8);var d=a.data[a.pos++];b.localColourTableFlag=d&128?!0:!1;b.localColourTableFlag&&(b.localColourTable=this._parseColourTable(1<<(d&7)+1,a));this.pixelBufSize!==b.width*b.height&&(this.pixelBuf=new Uint8Array(b.width*b.height),this.pixelBufSize=b.width*b.height);this._lzwDecode(a.data[a.pos++],a.readSubBlocksB());if(d&64){b.interlaced=!0;a=b.width;d=this.pixelBufSize/a;this.interlacedBufSize!==this.pixelBufSize&&(this.deinterlaceBuf=new Uint8Array(this.pixelBufSize),this.interlacedBufSize=
this.pixelBufSize);for(var c=0,e=0;4>e;e++)for(var f=this.interlaceOffsets[e];f<d;f+=this.interlaceSteps[e])this.deinterlaceBuf.set(this.pixelBuf.subarray(c,c+a),f*a),c+=a}else b.interlaced=!1;this._processFrame(b)};b.prototype._lzwDecode=function(a,b){var d,c,e,f,g,l,r,h,k,u;e=c=0;var t=[];f=1<<a;g=f+1;l=a+1;for(u=!1;!u;){h=r;for(d=r=0;d<l;d++)b[e>>3]&1<<(e&7)&&(r|=1<<d),e++;if(r===f){t=[];l=a+1;for(d=0;d<f;d++)t[d]=[d];t[f]=[];t[g]=null}else{if(r===g){u=!0;break}r>=t.length?t.push(t[h].concat(t[h][0])):
h!==f&&t.push(t[h].concat(t[r][0]));h=t[r];k=h.length;for(d=0;d<k;d++)this.pixelBuf[c++]=h[d];t.length===1<<l&&12>l&&l++}}};b.prototype._processFrame=function(a){a.image=document.createElement("canvas");a.image.width=this.width;a.image.height=this.height;a.ctx=a.image.getContext("2d");var b=a.localColourTableFlag?a.localColourTable:this.globalColourTable;null===this.lastFrame&&(this.lastFrame=a);var d=2===this.lastFrame.disposalMethod||3===this.lastFrame.disposalMethod?!0:!1;d||a.ctx.drawImage(this.lastFrame.image,
0,0,this.width,this.height);for(var c=a.ctx.getImageData(a.leftPos,a.topPos,a.width,a.height),e=a.transparencyIndex,f=c.data,g=a.interlaced?this.deinterlaceBuf:this.pixelBuf,l=g.length,r=0,h,k,u=0;u<l;u++)h=g[u],k=b[h],e!==h?(f[r++]=k[0],f[r++]=k[1],f[r++]=k[2],f[r++]=255):(d&&(f[r+3]=0),r+=4);a.ctx.putImageData(c,a.leftPos,a.topPos);this.lastFrame=a};b.prototype._parseExt=function(a){var b=a.data[a.pos++];249===b?this._parseGCExt(a):254===b?this.comment+=a.readSubBlocks():255===b?this._parseAppExt(a):
(1===b&&(a.pos+=13),a.readSubBlocks())};b.prototype._parseAppExt=function(a){a.pos+=1;"NETSCAPE"===a.getString(8)?a.pos+=8:(a.pos+=3,a.readSubBlocks())};b.prototype._parseGCExt=function(a){var b;a.pos++;b=a.data[a.pos++];this.disposalMethod=(b&28)>>2;this.transparencyGiven=b&1?!0:!1;this.delayTime=a.data[a.pos++]+(a.data[a.pos++]<<8);this.transparencyIndex=a.data[a.pos++];a.pos++};b.prototype._finishedLoading=function(){this.loading=!1;this.frameCount=this.frames.length;this.lastFrame=null;this.complete=
!0;this.deinterlaceBuf=this.pixelBufSize=this.deinterlaceBuf=this.pixelBuf=this.waitTillDone=this.transparencyIndex=this.delayTime=this.transparencyGiven=this.disposalMethod=void 0;this.currentFrameNumber=0;0<this.frames.length&&this._setCurrentFrame(0);this.playOnLoad&&this.play()};b.prototype._play=function(){var a=this,b;0===this.playSpeed?this.pause():(0>this.playSpeed?(--this.currentFrameNumber,0>this.currentFrameNumber&&(this.currentFrameNumber=this.frames.length-1),b=this.currentFrameNumber,
--b,0>b&&(b=this.frames.length-1),b=1*-this.frames[b].delay/this.playSpeed):(this.currentFrameNumber+=1,this.currentFrameNumber%=this.frames.length,b=1*this.frames[this.currentFrameNumber].delay/this.playSpeed),this._setCurrentFrame(this.currentFrameNumber),this.timerID=window.setTimeout(function(){return a._play()},b))};b.prototype._setCurrentFrame=function(a){this.currentFrame={frameData:this.frames[a].image,top:0,left:0,width:this.width,height:this.height}};return b}();c.default=b;var d=function(){function a(a){this.pos=
0;this.data=new Uint8ClampedArray(a);this.len=this.data.length}a.prototype.getString=function(a){for(var b="";a--;)b+=String.fromCharCode(this.data[this.pos++]);return b};a.prototype.readSubBlocks=function(){var a,b,d="";do for(b=a=this.data[this.pos++];b--;)d+=String.fromCharCode(this.data[this.pos++]);while(0!==a&&this.pos<this.len);return d};a.prototype.readSubBlocksB=function(){var a,b,d=[];do for(b=a=this.data[this.pos++];b--;)d.push(this.data[this.pos++]);while(0!==a&&this.pos<this.len);return d};
return a}()})},"esri/views/2d/engine/webgl/util/BidiText":function(){define(["require","exports","../../../../../core/BidiEngine"],function(b,c,e){Object.defineProperty(c,"__esModule",{value:!0});var g=new e.default;c.bidiText=function(b){if(!g.hasBidiChar(b))return[b,!1];var a;a="rtl"===g.checkContextual(b)?"IDNNN":"ICNNN";return[g.bidiTransform(b,a,"VLYSN"),!0]}})},"esri/core/BidiEngine":function(){define(["require","exports","./bidiEngineTables"],function(b,c,e){function g(b,d,c,e,h){var l=b;void 0===
d&&(d=h.defInFormat);void 0===c&&(c=h.defOutFormat);void 0===e&&(e=h.defSwap);if(d!==c){var m=d.substring(0,1),p=c.substring(0,1),u;u=d.substring(1,4);var r=c.substring(1,4);"C"===u.charAt(0)&&(u=f(l),u="ltr"===u||"rtl"===u?u.toUpperCase():"L"===d.charAt(2)?"LTR":"RTL",d=m+u);"C"===r.charAt(0)&&(u=f(l),"rtl"===u?r="RTL":"ltr"===u?(l=l.split(""),l.reverse(),u=f(l.join("")),r=u.toUpperCase()):r="L"===c.charAt(2)?"LTR":"RTL",c=p+r)}if(d===c)return b;p=d.substring(0,1);l=d.substring(1,4);m=c.substring(0,
1);r=c.substring(1,4);h.inFormat=d;h.outFormat=c;h.swap=e;if("L"===p&&"VLTR"===c){if("LTR"===l)return h.dir=B,a(b,h);if("RTL"===l)return h.dir=C,a(b,h)}if("V"===p&&"V"===m)return h.dir="RTL"===l?C:B,k(b,h);if("L"===p&&"VRTL"===c)return h.dir="LTR"===l?B:C,b=a(b,h),k(b);if("VLTR"===d&&"LLTR"===c)return h.dir=B,a(b,h);if("V"===p&&"L"===m&&l!==r)return b=k(b),"RTL"===l?g(b,"LLTR","VLTR",e,h):g(b,"LRTL","VRTL",e,h);if("VRTL"===d&&"LRTL"===c)return g(b,"LRTL","VRTL",e,h);"L"===p&&"L"===m&&(d=h.swap,h.swap=
d.substr(0,1)+"N","RTL"===l?(h.dir=C,b=a(b,h),h.swap="N"+d.substr(1,2),h.dir=B,b=a(b,h)):(h.dir=B,b=a(b,h),h.swap="N"+d.substr(1,2),b=g(b,"VLTR","LRTL",h.swap,h)));return b}function f(a){return(a=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(a))?"z">=a[0]?"ltr":"rtl":""}function a(a,b){a=a.split("");var d=[];n(a,d,b);if(0!==b.hiLevel&&b.swap.substr(0,1)!==b.swap.substr(1,2))for(var c=0;c<a.length;c++)if(1===d[c]){var f=c,g;b:{g=a[c];for(var l=void 0,m=0,p=e.SwapTable.length-
1;m<=p;)if(l=Math.floor((m+p)/2),g<e.SwapTable[l][0])p=l-1;else if(g>e.SwapTable[l][0])m=l+1;else{g=e.SwapTable[l][1];break b}}a[f]=g}t(2,a,d,b);t(1,a,d,b);h=d;return a.join("")}function n(a,b,d){var c=a.length,h=d.dir?e.impTabRtl:e.impTabLtr,f=null,g=null,l=null,f=0,g=g=null,m=-1,p=g=null,r=[],k=[];d.hiLevel=d.dir;d.lastArabic=!1;d.hasUbatAl=!1;d.hasUbatB=!1;d.hasUbatS=!1;for(g=0;g<c;g++){var p=g,l=a[g].charCodeAt(0),q=e.MasterTable[l>>8];r[p]=q<e.TBBASE?q:e.UnicodeTable[q-e.TBBASE][l&255]}for(p=
0;p<c;p++){k[p]=g=x(a,r,k,p,d);f=h[f][g];g=f&240;f&=15;b[p]=l=h[f][u];if(0<g){if(16===g)for(g=m;g<p;g++)b[g]=1;m=-1}if(g=h[f][D])-1===m&&(m=p);else if(-1<m){for(g=m;g<p;g++)b[g]=l;m=-1}r[p]===e.UBAT_B&&(b[p]=0);d.hiLevel|=l}if(d.hasUbatS)for(a=0;a<c;a++)if(r[a]===e.UBAT_S)for(b[a]=d.dir,h=a-1;0<=h;h--)if(r[h]===e.UBAT_WS)b[h]=d.dir;else break}function k(a,b){a=a.split("");if(b){var d=[];n(a,d,b);h=d}a.reverse();p.reverse();return a.join("")}function d(a){for(var b=0;b<e.ArabicAlefBetIntervalsBegine.length;b++)if(a>=
e.ArabicAlefBetIntervalsBegine[b]&&a<=e.ArabicAlefBetIntervalsEnd[b])return!0;return!1}function l(a,b,c,e){for(;b*c<e&&m(a[b]);)b+=c;return b*c<e&&d(a[b])?!0:!1}function t(a,b,d,c){if(!(c.hiLevel<a))if(1!==a||c.dir!==C||c.hasUbatB){c=b.length;for(var e=0,h,f,g;e<c;){if(d[e]>=a){for(h=e+1;h<c&&d[h]>=a;)h++;for(f=h-1;e<f;e++,f--)g=b[e],b[e]=b[f],b[f]=g,g=p[e],p[e]=p[f],p[f]=g;e=h}e++}}else b.reverse(),p.reverse()}function x(a,b,d,c,h){return{UBAT_L:function(){h.lastArabic=!1;return e.UBAT_L},UBAT_R:function(){h.lastArabic=
!1;return e.UBAT_R},UBAT_ON:function(){return e.UBAT_ON},UBAT_AN:function(){return e.UBAT_AN},UBAT_EN:function(){return h.lastArabic?e.UBAT_AN:e.UBAT_EN},UBAT_AL:function(){h.lastArabic=!0;h.hasUbatAl=!0;return e.UBAT_R},UBAT_WS:function(){return e.UBAT_ON},UBAT_CS:function(){var a,f;if(1>c||c+1>=b.length||(a=d[c-1])!==e.UBAT_EN&&a!==e.UBAT_AN||(f=b[c+1])!==e.UBAT_EN&&f!==e.UBAT_AN)return e.UBAT_ON;h.lastArabic&&(f=e.UBAT_AN);return f===a?f:e.UBAT_ON},UBAT_ES:function(){return(0<c?d[c-1]:e.UBAT_B)===
e.UBAT_EN&&c+1<b.length&&b[c+1]===e.UBAT_EN?e.UBAT_EN:e.UBAT_ON},UBAT_ET:function(){if(0<c&&d[c-1]===e.UBAT_EN)return e.UBAT_EN;if(h.lastArabic)return e.UBAT_ON;for(var a=c+1,f=b.length;a<f&&b[a]===e.UBAT_ET;)a++;return a<f&&b[a]===e.UBAT_EN?e.UBAT_EN:e.UBAT_ON},UBAT_NSM:function(){if("VLTR"===h.inFormat){for(var f=b.length,g=c+1;g<f&&b[g]===e.UBAT_NSM;)g++;if(g<f&&(f=a[c].charCodeAt[0],g=b[g],(1425<=f&&2303>=f||64286===f)&&(g===e.UBAT_R||g===e.UBAT_AL)))return e.UBAT_R}return 1>c||b[c-1]===e.UBAT_B?
e.UBAT_ON:d[c-1]},UBAT_B:function(){h.lastArabic=!0;h.hasUbatB=!0;return h.dir},UBAT_S:function(){h.hasUbatS=!0;return e.UBAT_ON},UBAT_LRE:function(){h.lastArabic=!1;return e.UBAT_ON},UBAT_RLE:function(){h.lastArabic=!1;return e.UBAT_ON},UBAT_LRO:function(){h.lastArabic=!1;return e.UBAT_ON},UBAT_RLO:function(){h.lastArabic=!1;return e.UBAT_ON},UBAT_PDF:function(){h.lastArabic=!1;return e.UBAT_ON},UBAT_BN:function(){return e.UBAT_ON}}[e.TYPES_NAMES[b[c]]]()}function w(a,b){for(var d=0;d<e.BaseForm.length;d++)if(a===
e.BaseForm[d])return b[d];return a}function m(a){return"\u064b"<=a&&"\u0655">=a?!0:!1}function z(a){return"L"===a?"LTR":"R"===a?"RTL":"C"===a?"CLR":"D"===a?"CRL":""}function q(a,b){for(var d=0;d<e.AlefTable.length;d++)if(a===e.AlefTable[d])return b[d];return a}function v(a,b,d,c){for(var e=0;e<a.length;e++)if(a[e]>b||!d&&a[e]===b)a[e]+=c}Object.defineProperty(c,"__esModule",{value:!0});b=function(){function a(){this.inputFormat="ILYNN";this.outputFormat="VLNNN";this.sourceToTarget=[];this.targetToSource=
[];this.levels=[]}a.prototype.bidiTransform=function(a,b,c){this.sourceToTarget=[];this.targetToSource=[];if(!a)return"";var f=this.sourceToTarget,u=this.targetToSource,k=a.length;p=[];h=[];for(var n=0;n<k;n++)f[n]=n,u[n]=n,p[n]=n;if(!this.checkParameters(b,c))return a;b=this.inputFormat;c=this.outputFormat;var f=a,f=y,n=z(b.charAt(1)),u=z(c.charAt(1)),t="I"===b.charAt(0)?"L":b.charAt(0),k="I"===c.charAt(0)?"L":c.charAt(0),n=t+n,u=k+u,k=b.charAt(2)+c.charAt(2);f.defInFormat=n;f.defOutFormat=u;f.defSwap=
k;a=g(a,n,u,k,f);f=!1;if("R"===c.charAt(1))f=!0;else if("C"===c.charAt(1)||"D"===c.charAt(1))f="rtl"===this.checkContextual(a);u=this.sourceToTarget=p;k=Array(u.length);for(n=0;n<u.length;n++)k[u[n]]=n;r=this.targetToSource=k;if(b.charAt(3)===c.charAt(3))f=a;else if("S"===c.charAt(3))if(b=f,c=!0,0===a.length)f="";else{void 0===b&&(b=!0);void 0===c&&(c=!0);a=String(a);a=a.split("");var x=0,u=1,f=a.length;b||(x=a.length-1,u=-1,f=1);for(var k=f,n=c,C=0,f=[],t=0;x*u<k;x+=u)if(d(a[x])||m(a[x])){var A;
if(A="\u0644"===a[x])b:{for(var I=a,B=x+u,D=u,E=k;B*D<E&&m(I[B]);)B+=D;A=" ";if(B*D<E)for(A=I[B],I=0;I<e.AlefTable.length;I++)if(e.AlefTable[I]===A){A=!0;break b}A=!1}if(A){a[x]=0===C?q(a[x+u],e.LamAlefInialTableFE):q(a[x+u],e.LamAlefMedialTableFE);x+=u;C=a;A=x;I=u;for(B=k;A*I<B&&m(C[A]);)A+=I;A*I<B&&(C[A]=" ");n&&(f[t]=x,t++);C=0}else{A=a[x];if(1===C){I=x;if(l(a,x+u,u,k))b:for(B=a[x],D=0;D<e.BaseForm.length;D++){if(B===e.BaseForm[D]){B=e.MedialForm[D];break b}}else B=w(a[x],e.FinalForm);a[I]=B}else!0===
l(a,x+u,u,k)?a[x]=w(a[x],e.InitialForm):a[x]=w(a[x],e.IsolatedForm);m(A)||(C=1);b:{for(I=0;I<e.StandAlonForm.length;I++)if(e.StandAlonForm[I]===A){A=!0;break b}A=!1}!0===A&&(C=0)}}else C=0;u="";for(k=0;k<a.length;k++){if(n=c){b:{for(n=0;n<f.length;n++)if(f[n]===k)break b;n=-1}n=-1<n}n?(v(r,k,!b,-1),p.splice(k,1)):u+=a[k]}f=u}else if(b=a,c=f,a=!0,0===b.length)f="";else for(void 0===a&&(a=!0),void 0===c&&(c=!0),b=String(b),f="",u=b.split(""),k=0;k<b.length;k++)n=!1,"\ufe70"<=u[k]&&"\ufeff">u[k]?(t=
b.charCodeAt(k),"\ufef5"<=u[k]&&"\ufefc">=u[k]?(c?(0<k&&a&&" "===u[k-1]?f=f.substring(0,f.length-1)+"\u0644":(f+="\u0644",n=!0),f+=e.AlefTable[(t-65269)/2]):(f+=e.AlefTable[(t-65269)/2],f+="\u0644",k+1<b.length&&a&&" "===u[k+1]?k++:n=!0),n&&(v(r,k,!0,1),p.splice(k,0,p[k]))):f+=e.FETo06Table[t-65136]):f+=u[k];this.sourceToTarget=p;this.targetToSource=r;this.levels=h;return f};a.prototype._inputFormatSetter=function(a){if(!A.test(a))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");
this.inputFormat=a};a.prototype._outputFormatSetter=function(a){if(!A.test(a))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.outputFormat=a};a.prototype.checkParameters=function(a,b){a?this._inputFormatSetter(a):a=this.inputFormat;b?this._outputFormatSetter(b):b=this.outputFormat;return a===b?!1:!0};a.prototype.checkContextual=function(a){a=f(a);if("ltr"!==a&&"rtl"!==a){try{a=document.dir.toLowerCase()}catch(F){}"ltr"!==a&&"rtl"!==a&&(a="ltr")}return a};a.prototype.hasBidiChar=
function(a){return I.test(a)};return a}();c.default=b;var p=[],r=[],h=[],y={dir:0,defInFormat:"LLTR",defoutFormat:"VLTR",defSwap:"YN",inFormat:"LLTR",outFormat:"VLTR",swap:"YN",hiLevel:0,lastArabic:!1,hasUbatAl:!1,hasBlockSep:!1,hasSegSep:!1,defOutFormat:""},u=5,D=6,B=0,C=1,A=/^[(I|V)][(L|R|C|D)][(Y|N)][(S|N)][N]$/,I=/[\u0591-\u06ff\ufb1d-\ufefc]/})},"esri/core/bidiEngineTables":function(){define(["require","exports"],function(b,c){Object.defineProperty(c,"__esModule",{value:!0});c.SwapTable=[["(",
")"],[")","("],["\x3c","\x3e"],["\x3e","\x3c"],["[","]"],["]","["],["{","}"],["}","{"],["\u00ab","\u00bb"],["\u00bb","\u00ab"],["\u2039","\u203a"],["\u203a","\u2039"],["\u207d","\u207e"],["\u207e","\u207d"],["\u208d","\u208e"],["\u208e","\u208d"],["\u2264","\u2265"],["\u2265","\u2264"],["\u2329","\u232a"],["\u232a","\u2329"],["\ufe59","\ufe5a"],["\ufe5a","\ufe59"],["\ufe5b","\ufe5c"],["\ufe5c","\ufe5b"],["\ufe5d","\ufe5e"],["\ufe5e","\ufe5d"],["\ufe64","\ufe65"],["\ufe65","\ufe64"]];c.AlefTable=["\u0622",
"\u0623","\u0625","\u0627"];c.LamAlefInialTableFE=["\ufef5","\ufef7","\ufef9","\ufefb"];c.LamAlefMedialTableFE=["\ufef6","\ufef8","\ufefa","\ufefc"];c.BaseForm="\u0627\u0628\u062a\u062b\u062c\u062d\u062e\u062f\u0630\u0631\u0632\u0633\u0634\u0635\u0636\u0637\u0638\u0639\u063a\u0641\u0642\u0643\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u06cc\u0626\u0624".split("");c.IsolatedForm="\ufe8d\ufe8f\ufe95\ufe99\ufe9d\ufea1\ufea5\ufea9\ufeab\ufead\ufeaf\ufeb1\ufeb5\ufeb9\ufebd\ufec1\ufec5\ufec9\ufecd\ufed1\ufed5\ufed9\ufedd\ufee1\ufee5\ufee9\ufeed\ufef1\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfc\ufe89\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe89\ufe85".split("");
c.FinalForm="\ufe8e\ufe90\ufe96\ufe9a\ufe9e\ufea2\ufea6\ufeaa\ufeac\ufeae\ufeb0\ufeb2\ufeb6\ufeba\ufebe\ufec2\ufec6\ufeca\ufece\ufed2\ufed6\ufeda\ufede\ufee2\ufee6\ufeea\ufeee\ufef2\ufe88\ufe84\ufe82\ufe94\ufef0\ufbfd\ufe8a\ufe86\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8a\ufe86".split("");c.MedialForm="\ufe8e\ufe92\ufe98\ufe9c\ufea0\ufea4\ufea8\ufeaa\ufeac\ufeae\ufeb0\ufeb4\ufeb8\ufebc\ufec0\ufec4\ufec8\ufecc\ufed0\ufed4\ufed8\ufedc\ufee0\ufee4\ufee8\ufeec\ufeee\ufef4\ufe88\ufe84\ufe82\ufe94\ufef0\ufbff\ufe8c\ufe86\ufe71\ufe72\ufe74\ufe77\ufe79\ufe7b\ufe7d\ufe7f\ufe80\ufe8c\ufe86".split("");
c.InitialForm="\ufe8d\ufe91\ufe97\ufe9b\ufe9f\ufea3\ufea7\ufea9\ufeab\ufead\ufeaf\ufeb3\ufeb7\ufebb\ufebf\ufec3\ufec7\ufecb\ufecf\ufed3\ufed7\ufedb\ufedf\ufee3\ufee7\ufeeb\ufeed\ufef3\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfe\ufe8b\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8b\ufe85".split("");c.StandAlonForm="\u0621\u0622\u0623\u0624\u0625\u0627\u0629\u062f\u0630\u0631\u0632\u0648\u0649".split("");c.FETo06Table="\u064b\u064b\u064c\u061f\u064d\u061f\u064e\u064e\u064f\u064f\u0650\u0650\u0651\u0651\u0652\u0652\u0621\u0622\u0622\u0623\u0623\u0624\u0624\u0625\u0625\u0626\u0626\u0626\u0626\u0627\u0627\u0628\u0628\u0628\u0628\u0629\u0629\u062a\u062a\u062a\u062a\u062b\u062b\u062b\u062b\u062c\u062c\u062c\u062c\u062d\u062d\u062d\u062d\u062e\u062e\u062e\u062e\u062f\u062f\u0630\u0630\u0631\u0631\u0632\u0632\u0633\u0633\u0633\u0633\u0634\u0634\u0634\u0634\u0635\u0635\u0635\u0635\u0636\u0636\u0636\u0636\u0637\u0637\u0637\u0637\u0638\u0638\u0638\u0638\u0639\u0639\u0639\u0639\u063a\u063a\u063a\u063a\u0641\u0641\u0641\u0641\u0642\u0642\u0642\u0642\u0643\u0643\u0643\u0643\u0644\u0644\u0644\u0644\u0645\u0645\u0645\u0645\u0646\u0646\u0646\u0646\u0647\u0647\u0647\u0647\u0648\u0648\u0649\u0649\u064a\u064a\u064a\u064a\ufef5\ufef6\ufef7\ufef8\ufef9\ufefa\ufefb\ufefc\u061f\u061f\u061f".split("");
c.ArabicAlefBetIntervalsBegine=["\u0621","\u0641"];c.ArabicAlefBetIntervalsEnd=["\u063a","\u064a"];c.impTabLtr=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]];c.impTabRtl=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]];c.UBAT_L=0;c.UBAT_R=1;c.UBAT_EN=2;c.UBAT_AN=3;c.UBAT_ON=4;c.UBAT_B=5;c.UBAT_S=6;c.UBAT_AL=7;c.UBAT_WS=8;c.UBAT_CS=9;c.UBAT_ES=10;c.UBAT_ET=11;c.UBAT_NSM=12;c.UBAT_LRE=13;c.UBAT_RLE=14;c.UBAT_PDF=15;c.UBAT_LRO=16;
c.UBAT_RLO=17;c.UBAT_BN=18;c.TYPES_NAMES="UBAT_L UBAT_R UBAT_EN UBAT_AN UBAT_ON UBAT_B UBAT_S UBAT_AL UBAT_WS UBAT_CS UBAT_ES UBAT_ET UBAT_NSM UBAT_LRE UBAT_RLE UBAT_PDF UBAT_LRO UBAT_RLO UBAT_BN".split(" ");c.TBBASE=100;b=c.UBAT_L;var e=c.UBAT_R,g=c.UBAT_EN,f=c.UBAT_AN,a=c.UBAT_ON,n=c.UBAT_B,k=c.UBAT_S,d=c.UBAT_AL,l=c.UBAT_WS,t=c.UBAT_CS,x=c.UBAT_ES,w=c.UBAT_ET,m=c.UBAT_NSM,z=c.UBAT_LRE,q=c.UBAT_RLE,v=c.UBAT_PDF,p=c.UBAT_LRO,r=c.UBAT_RLO,h=c.UBAT_BN;c.MasterTable=[c.TBBASE+0,b,b,b,b,c.TBBASE+1,c.TBBASE+
2,c.TBBASE+3,e,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,c.TBBASE+4,a,a,a,b,a,b,a,b,a,a,a,b,b,a,a,b,b,b,b,b,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,b,b,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,b,b,b,b,b,b,b,b,b,b,b,b,b,b,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,b,b,a,a,b,b,a,a,b,b,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,
b,b,b,c.TBBASE+5,d,d,c.TBBASE+6,c.TBBASE+7];c.UnicodeTable=[[h,h,h,h,h,h,h,h,h,k,n,k,l,n,h,h,h,h,h,h,h,h,h,h,h,h,h,h,n,n,n,k,l,a,a,w,w,w,a,a,a,a,a,x,t,x,t,t,g,g,g,g,g,g,g,g,g,g,t,a,a,a,a,a,a,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,a,a,a,a,a,a,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,a,a,a,a,h,h,h,h,h,h,n,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,t,a,w,w,w,w,a,a,a,a,b,a,a,h,a,a,w,w,g,g,a,b,a,a,a,g,b,a,a,a,a,a,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,a,b,b,b,b,
b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,a,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,a,a,a,a,a,a,a,a,a,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,a,a,b,b,b,b,b,b,b,a,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,a,b,a,a,a,a,a,a,a,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,e,m,e,m,m,e,m,m,e,m,a,a,a,a,a,a,a,a,e,e,e,e,e,e,
e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,a,a,a,a,a,e,e,e,e,e,a,a,a,a,a,a,a,a,a,a,a],[f,f,f,f,a,a,a,a,d,w,w,d,t,d,a,a,m,m,m,m,m,m,m,m,m,m,m,d,a,a,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,f,f,f,f,f,f,f,f,f,f,w,f,f,d,d,d,m,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,
d,d,d,d,d,d,m,m,m,m,m,m,m,f,a,m,m,m,m,m,m,d,d,m,m,a,m,m,m,m,d,d,g,g,g,g,g,g,g,g,g,g,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,a,d,d,m,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,a,a,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,m,m,m,m,m,m,m,m,m,m,m,d,a,a,a,a,a,a,a,a,a,a,a,a,a,a,e,e,e,e,e,e,e,e,e,e,
e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,m,m,m,m,m,m,m,m,m,e,e,a,a,a,a,e,a,a,a,a,a],[l,l,l,l,l,l,l,l,l,l,l,h,h,h,b,e,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,l,n,z,q,v,p,r,t,w,w,w,w,w,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,t,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,l,h,h,h,h,h,a,a,a,a,a,h,h,h,h,h,h,g,b,a,a,g,g,g,g,g,g,x,x,a,a,a,b,g,g,g,g,g,g,g,g,g,g,x,x,a,a,a,a,b,b,b,b,b,b,b,b,b,b,b,b,b,a,a,a,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,a,a,a,a,a,a,a,a,a,a,
a,a,a,a,a,a,a,a,a,a,a,a,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a],[b,b,b,b,b,b,b,a,a,a,a,a,a,a,a,a,a,a,a,b,b,b,b,b,a,a,a,a,a,e,m,e,e,e,e,e,e,e,e,e,e,x,e,e,e,e,e,e,e,e,e,e,e,e,e,a,e,e,e,e,e,a,e,a,e,e,a,e,e,a,e,e,e,e,e,e,e,e,e,e,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,
d,d,d,d,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,m,m,m,m,m,m,m,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,t,a,t,a,a,t,a,a,a,a,a,a,a,a,a,w,a,a,x,x,a,a,a,a,a,w,w,a,a,a,a,a,d,d,d,d,d,a,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,
d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,a,a,h],[a,a,a,w,w,w,a,a,a,a,a,x,t,x,t,t,g,g,g,g,g,g,g,g,g,g,t,a,a,a,a,a,a,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,a,a,a,a,a,a,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,a,a,a,a,a,a,a,a,a,a,a,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,
b,b,b,b,b,b,b,b,b,b,b,b,b,a,a,a,b,b,b,b,b,b,a,a,b,b,b,b,b,b,a,a,b,b,b,b,b,b,a,a,b,b,b,a,a,a,w,w,a,a,a,w,w,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a]]})},"esri/views/2d/engine/webgl/util/Result":function(){define(["require","exports","../../../../../core/Error"],function(b,c,e){Object.defineProperty(c,"__esModule",{value:!0});c.ok=function(b,c){return b&&"name"in b?(c&&c.error(new e(b.name,b.message,b.details)),!1):!0}})},"esri/views/2d/engine/webgl/util/symbolUtils":function(){define(["require",
"exports"],function(b,c){Object.defineProperty(c,"__esModule",{value:!0});c.keyFromSymbol=function(b){switch(b.type){case "esriSMS":return b.style+"."+b.path;case "esriSLS":return b.style+"."+b.cap;case "esriSFS":return""+b.style;case "esriPFS":case "esriPMS":return b.imageData?b.imageData:""+b.url+b.width+b.height;default:return b.mosaicHash?b.mosaicHash:JSON.stringify(b)}}})},"esri/views/2d/engine/webgl/effects/AnimationEffect":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/maybe ../definitions ../VertexStream ./Effect".split(" "),
function(b,c,e,g,f,a,n){Object.defineProperty(c,"__esModule",{value:!0});b=function(b){function d(){var a=null!==b&&b.apply(this,arguments)||this;a.defines=[];a._desc={path:"fx/integrate",attributes:{a_position:0}};return a}e(d,b);d.prototype.dispose=function(){this._quad&&this._quad.dispose()};d.prototype.bind=function(){};d.prototype.unbind=function(){};d.prototype.draw=function(b,d){if(d.size){var c=b.context,e=b.renderingOptions;this._quad||(this._quad=new a(c,[0,0,1,0,0,1,1,1]));var l=c.getBoundFramebufferObject(),
k=c.getViewport(),q=k.x,n=k.y,p=k.width,k=k.height;d.bindTextures(c);var r=d.getBlock(f.ATTRIBUTE_DATA_ANIMATION);if(!g.isNone(r)){var h=r.getFBO(c),r=r.getFBO(c,1);c.setViewport(0,0,d.size,d.size);this._computeDelta(b,r,e.labelsAnimationTime);this._updateAnimationState(b,r,h);c.bindFramebuffer(l);c.setViewport(q,n,p,k)}}};d.prototype._computeDelta=function(a,b,d){var c=a.context,e=a.displayLevel,g=a.painter.materialManager.getProgram(a,this._desc,["delta"]);c.bindFramebuffer(b);c.setClearColor(0,
0,0,0);c.clear(c.gl.COLOR_BUFFER_BIT);c.bindProgram(g);g.setUniform1i("u_maskTexture",f.TEXTURE_BINDING_ATTRIBUTE_DATA_0);g.setUniform1i("u_sourceTexture",f.TEXTURE_BINDING_ATTRIBUTE_DATA_1);g.setUniform1f("u_timeDelta",a.timeDelta);g.setUniform1f("u_animationTime",d/1E3);g.setUniform1f("u_zoomLevel",Math.round(10*e));this._quad.draw()};d.prototype._updateAnimationState=function(a,b,d){var c=a.context;a=a.painter.materialManager.getProgram(a,this._desc,["update"]);c.bindTexture(b.colorTexture,1);
c.bindProgram(a);a.setUniform1i("u_sourceTexture",1);c.bindFramebuffer(d);c.setClearColor(0,0,0,0);c.clear(c.gl.COLOR_BUFFER_BIT);this._quad.draw()};return d}(n.Effect);c.AnimationEffect=b})},"esri/views/2d/engine/webgl/VertexStream":function(){define(["require","exports","../../../../core/tsSupport/declareExtendsHelper","../../../webgl"],function(b,c,e,g){return function(){function b(a,b){this.rctx=a;this._vertexBuffer=g.BufferObject.createVertex(a,35044,new Uint16Array(b));this._vao=new g.VertexArrayObject(a,
{a_position:0},{geometry:[{name:"a_position",count:2,type:5123,offset:0,stride:4,normalized:!1}]},{geometry:this._vertexBuffer})}b.prototype.bind=function(){this._vao.bind()};b.prototype.unbind=function(){this._vao.unbind()};b.prototype.dispose=function(){this._vao.dispose(!1);this._vertexBuffer.dispose()};b.prototype.draw=function(){this.rctx.bindVAO(this._vao);this.rctx.drawArrays(5,0,4)};return b}()})},"esri/views/2d/engine/webgl/effects/Effect":function(){define(["require","exports"],function(b,
c){Object.defineProperty(c,"__esModule",{value:!0});b=function(){return function(){this.name=this.constructor.name}}();c.Effect=b})},"esri/views/2d/engine/webgl/effects/HighlightEffect":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/has ../BitBlitRenderer ../effects/Effect ./highlight/HighlightGradient ./highlight/HighlightRenderer ./highlight/HighlightSurfaces".split(" "),function(b,c,e,g,f,a,n,k,d){Object.defineProperty(c,"__esModule",{value:!0});
b=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b.defines=["highlight"];b._hlRenderer=new k.default;b._hlGradient=new n.default;b._width=void 0;b._height=void 0;b._hlSurfaces=new d.default;b._adjustedWidth=void 0;b._adjustedHeight=void 0;b._blitRenderer=new f.BitBlitRenderer;return b}e(b,a);b.prototype.dispose=function(){this._hlSurfaces&&this._hlSurfaces.dispose();this._hlRenderer&&this._hlRenderer.dispose();this._hlGradient&&this._hlGradient.destroy();this._boundFBO=null};
b.prototype.bind=function(a){var b=a.context,d=a.painter,c=b.getViewport(),e=c.width,c=c.height,d=d.getFbos(e,c).effect0;this.setup(a,e,c);b.bindFramebuffer(d);b.setClearColor(0,0,0,0);b.clear(b.gl.COLOR_BUFFER_BIT)};b.prototype.unbind=function(){};b.prototype.setup=function(a,b,d){a=a.context;this._width=b;this._height=d;var c=b%4,e=d%4;b+=2>c?-c:4-c;d+=2>e?-e:4-e;this._adjustedWidth=b;this._adjustedHeight=d;this._boundFBO=a.getBoundFramebufferObject();b=Math.round(.75*b);d=Math.round(.75*d);this._hlRenderer.setup(a,
b,d);this._hlSurfaces.setup(a,b,d)};b.prototype.draw=function(a){a=a.context;var b=a.getBoundFramebufferObject();a.setViewport(0,0,.75*this._adjustedWidth,.75*this._adjustedHeight);a.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo);a.setStencilTestEnabled(!1);a.setClearColor(0,0,0,0);a.clear(a.gl.COLOR_BUFFER_BIT);this._blitRenderer.render(a,b.colorTexture,9728,1);a.setStencilTestEnabled(!1);a.setBlendingEnabled(!1);a.bindFramebuffer(this._hlSurfaces.sharedBlur2Fbo);a.setClearColor(0,0,0,0);a.clear(a.gl.COLOR_BUFFER_BIT);
this._hlRenderer.preBlur(a,this._hlSurfaces.sharedBlur1Tex);a.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo);a.setClearColor(0,0,0,0);a.clear(a.gl.COLOR_BUFFER_BIT);this._hlRenderer.finalBlur(a,this._hlSurfaces.sharedBlur2Tex);a.bindFramebuffer(this._boundFBO);a.setBlendingEnabled(!0);a.setViewport(0,0,this._width,this._height);this._hlRenderer.renderHighlight(a,this._hlSurfaces.sharedBlur1Tex,this._hlGradient);this._boundFBO=null};b.prototype.setHighlightOptions=function(a){this._hlGradient.setHighlightOptions(a)};
return b}(a.Effect);c.default=b})},"esri/views/2d/engine/webgl/effects/highlight/HighlightGradient":function(){define("require exports ../../../../../../core/Logger ../../../../../webgl ../../definitions ./parameters".split(" "),function(b,c,e,g,f,a){function n(b,d){d.fillColor[0]=b.color.r/255;d.fillColor[1]=b.color.g/255;d.fillColor[2]=b.color.b/255;d.fillColor[3]=b.color.a;b.haloColor?(d.outlineColor[0]=b.haloColor.r/255,d.outlineColor[1]=b.haloColor.g/255,d.outlineColor[2]=b.haloColor.b/255,d.outlineColor[3]=
b.haloColor.a):(d.outlineColor[0]=d.fillColor[0],d.outlineColor[1]=d.fillColor[1],d.outlineColor[2]=d.fillColor[2],d.outlineColor[3]=d.fillColor[3]);d.fillColor[3]*=b.fillOpacity;d.outlineColor[3]*=b.haloOpacity;d.fillColor[0]*=d.fillColor[3];d.fillColor[1]*=d.fillColor[3];d.fillColor[2]*=d.fillColor[3];d.outlineColor[0]*=d.outlineColor[3];d.outlineColor[1]*=d.outlineColor[3];d.outlineColor[2]*=d.outlineColor[3];d.outlineWidth=a.HIGHLIGHT_SIZING.outlineWidth;d.outerHaloWidth=a.HIGHLIGHT_SIZING.outerHaloWidth;
d.innerHaloWidth=a.HIGHLIGHT_SIZING.innerHaloWidth;d.outlinePosition=a.HIGHLIGHT_SIZING.outlinePosition}Object.defineProperty(c,"__esModule",{value:!0});var k=e.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient"),d=[0,0,0,0];b=function(){function b(){this._convertedHighlightOptions={fillColor:[.2*.75,.6*.75,.675,.75],outlineColor:[.2*.9,.54,.81,.9],outlinePosition:a.HIGHLIGHT_SIZING.outlinePosition,outlineWidth:a.HIGHLIGHT_SIZING.outlineWidth,innerHaloWidth:a.HIGHLIGHT_SIZING.innerHaloWidth,
outerHaloWidth:a.HIGHLIGHT_SIZING.outerHaloWidth};this.shadeTexChanged=!0;this.texelData=new Uint8Array(4*a.SHADE_TEXTURE_SIZE);this.minMaxDistance=[0,0]}b.prototype.setHighlightOptions=function(b){function c(a,b,d){h[0]=(1-d)*a[0]+d*b[0];h[1]=(1-d)*a[1]+d*b[1];h[2]=(1-d)*a[2]+d*b[2];h[3]=(1-d)*a[3]+d*b[3]}var e,f=this._convertedHighlightOptions;n(b,f);b=f.outlinePosition-f.outlineWidth/2-f.outerHaloWidth;var g=f.outlinePosition-f.outlineWidth/2,l=f.outlinePosition+f.outlineWidth/2,v=f.outlinePosition+
f.outlineWidth/2+f.innerHaloWidth,p=Math.sqrt(Math.PI/2)*a.SIGMAS[3],r=Math.abs(b)>p?Math.round(10*(Math.abs(b)-p))/10:0,p=Math.abs(v)>p?Math.round(10*(Math.abs(v)-p))/10:0;r&&!p?k.error("The outer rim of the highlight is "+r+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!r&&p?k.error("The inner rim of the highlight is "+p+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):
r&&p&&k.error("The highlight is "+Math.max(r,p)+"px away from the edge of the feature; consider reducing some width values.");for(var h=[void 0,void 0,void 0,void 0],r=this.texelData,p=0;p<a.SHADE_TEXTURE_SIZE;++p)e=b+p/(a.SHADE_TEXTURE_SIZE-1)*(v-b),e<b?(h[4*p+0]=0,h[4*p+1]=0,h[4*p+2]=0,h[4*p+3]=0):e<g?c(d,f.outlineColor,(e-b)/(g-b)):e<l?(e=f.outlineColor,h[0]=e[0],h[1]=e[1],h[2]=e[2],h[3]=e[3]):e<v?c(f.outlineColor,f.fillColor,(e-l)/(v-l)):(e=f.fillColor,h[4*p+0]=e[0],h[4*p+1]=e[1],h[4*p+2]=e[2],
h[4*p+3]=e[3]),r[4*p+0]=255*h[0],r[4*p+1]=255*h[1],r[4*p+2]=255*h[2],r[4*p+3]=255*h[3];this.minMaxDistance[0]=b;this.minMaxDistance[1]=v;this.shadeTexChanged=!0};b.prototype.applyHighlightOptions=function(b,d){this.shadeTex||(this.shadeTex=new g.Texture(b,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:a.SHADE_TEXTURE_SIZE,height:1,samplingMode:9729}));this.shadeTexChanged&&(this.shadeTex.updateData(0,0,0,a.SHADE_TEXTURE_SIZE,1,this.texelData),this.shadeTexChanged=!1);b.bindTexture(this.shadeTex,
f.TEXTURE_BINDING_HIGHLIGHT_1);d.setUniform2fv("u_minMaxDistance",this.minMaxDistance)};b.prototype.destroy=function(){this.shadeTex&&(this.shadeTex.dispose(),this.shadeTex=null)};return b}();c.default=b})},"esri/views/2d/engine/webgl/effects/highlight/parameters":function(){define(["require","exports"],function(b,c){Object.defineProperty(c,"__esModule",{value:!0});c.SIGMAS=[void 0,void 0,void 0,1];c.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1];c.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=
[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];c.SHADE_TEXTURE_SIZE=256;c.HIGHLIGHT_SIZING={outlineWidth:.7,outerHaloWidth:.7,innerHaloWidth:.7,outlinePosition:0}})},"esri/views/2d/engine/webgl/effects/highlight/HighlightRenderer":function(){define("require exports ../../../../../webgl ../../definitions ./parameters ../../shaders/HighlightPrograms".split(" "),function(b,c,e,g,f,a){Object.defineProperty(c,"__esModule",{value:!0});b=function(){function b(){this._height=this._width=void 0;this._resources=null}b.prototype.dispose=
function(){this._resources&&(this._resources.quadGeometry.dispose(),this._resources.quadVAO.dispose(),this._resources.highlightProgram.dispose(),this._resources.blurProgram.dispose(),this._resources=null)};b.prototype.preBlur=function(a,b){a.bindTexture(b,g.TEXTURE_BINDING_HIGHLIGHT_0);a.bindProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",[1,0,1/this._width,0]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",f.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX);
a.bindVAO(this._resources.quadVAO);a.drawArrays(5,0,4);a.bindVAO()};b.prototype.finalBlur=function(a,b){a.bindTexture(b,g.TEXTURE_BINDING_HIGHLIGHT_0);a.bindProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",[0,1,0,1/this._height]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",f.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX);a.bindVAO(this._resources.quadVAO);a.drawArrays(5,0,4);a.bindVAO()};b.prototype.renderHighlight=function(a,b,c){a.bindTexture(b,
g.TEXTURE_BINDING_HIGHLIGHT_0);a.bindProgram(this._resources.highlightProgram);c.applyHighlightOptions(a,this._resources.highlightProgram);a.bindVAO(this._resources.quadVAO);a.setBlendingEnabled(!0);a.setBlendFunction(1,771);a.drawArrays(5,0,4);a.bindVAO()};b.prototype._initialize=function(b,d,c){this._width=d;this._height=c;d=new e.BufferObject(b,34962,35044,(new Int8Array([-1,-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1])).buffer);c=new e.VertexArrayObject(b,{a_position:0,a_texcoord:1},{geometry:[{name:"a_position",
count:2,type:5120,offset:0,stride:4,normalized:!1},{name:"a_texcoord",count:2,type:5121,offset:2,stride:4,normalized:!1}]},{geometry:d});var l=e.createProgram(b,a.highlight);b=e.createProgram(b,a.blur);l.setUniform1i("u_texture",g.TEXTURE_BINDING_HIGHLIGHT_0);l.setUniform1i("u_shade",g.TEXTURE_BINDING_HIGHLIGHT_1);l.setUniform4fv("u_sigmas",f.SIGMAS);b.setUniform1i("u_texture",g.TEXTURE_BINDING_HIGHLIGHT_0);b.setUniform4fv("u_sigmas",f.SIGMAS);this._resources={quadGeometry:d,quadVAO:c,highlightProgram:l,
blurProgram:b}};b.prototype.setup=function(a,b,c){this._resources?(this._width=b,this._height=c):this._initialize(a,b,c)};return b}();c.default=b})},"esri/views/2d/engine/webgl/shaders/HighlightPrograms":function(){define(["require","exports","./sources/resolver"],function(b,c,e){Object.defineProperty(c,"__esModule",{value:!0});c.highlight={name:"highlight",shaders:{vertexShader:e.resolveIncludes("highlight/textured.vert"),fragmentShader:e.resolveIncludes("highlight/highlight.frag")},attributes:{a_position:0,
a_texcoord:1}};c.blur={name:"blur",shaders:{vertexShader:e.resolveIncludes("highlight/textured.vert"),fragmentShader:e.resolveIncludes("highlight/blur.frag")},attributes:{a_position:0,a_texcoord:1}}})},"esri/views/2d/engine/webgl/effects/highlight/HighlightSurfaces":function(){define(["require","exports","../../../../../webgl"],function(b,c,e){function g(b,a,c){a=new e.Texture(b,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:a,height:c,samplingMode:9729});b=new e.FramebufferObject(b,
{colorTarget:0,depthStencilTarget:2},a);return[a,b]}Object.defineProperty(c,"__esModule",{value:!0});b=function(){function b(){this._height=this._width=void 0;this._resources=null}b.prototype.dispose=function(){this._resources&&(this._resources.sharedBlur1Tex.dispose(),this._resources.sharedBlur1Fbo.dispose(),this._resources.sharedBlur2Tex.dispose(),this._resources.sharedBlur2Fbo.dispose(),this._resources=null)};b.prototype._initialize=function(a,b,c){this._width=b;this._height=c;var d=g(a,b,c),e=
d[0],d=d[1];a=g(a,b,c);this._resources={sharedBlur1Tex:e,sharedBlur1Fbo:d,sharedBlur2Tex:a[0],sharedBlur2Fbo:a[1]}};b.prototype.setup=function(a,b,c){!this._resources||this._width===b&&this._height===c||this.dispose();this._resources||this._initialize(a,b,c)};Object.defineProperty(b.prototype,"sharedBlur1Tex",{get:function(){return this._resources.sharedBlur1Tex},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"sharedBlur1Fbo",{get:function(){return this._resources.sharedBlur1Fbo},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"sharedBlur2Tex",{get:function(){return this._resources.sharedBlur2Tex},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"sharedBlur2Fbo",{get:function(){return this._resources.sharedBlur2Fbo},enumerable:!0,configurable:!0});return b}();c.default=b})},"esri/views/2d/engine/webgl/effects/HittestEffect":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/MapUtils ../../../../../core/maybe ../definitions ./Effect".split(" "),
function(b,c,e,g,f,a,n){Object.defineProperty(c,"__esModule",{value:!0});b=function(b){function d(){var a=null!==b&&b.apply(this,arguments)||this;a.name=a.constructor.name;a.defines=["id"];a._lastSize=0;return a}e(d,b);d.prototype.dispose=function(){f.isSome(this._fbo)&&this._fbo.dispose()};d.prototype.bind=function(a){var b=a.context;a=a.painter;var d=b.getViewport();a=a.getFbos(d.width,d.height).effect0;b.bindFramebuffer(a);b.setClearColor(0,0,0,0);b.clear(b.gl.COLOR_BUFFER_BIT)};d.prototype.unbind=
function(){};d.prototype.draw=function(b,d,c){var e=this,f=b.context,l=b.state,k=b.pixelRatio;void 0===c&&(c=a.HITTEST_SEARCH_SIZE);var n=f.getBoundFramebufferObject(),p=l.size[1]*k,r=Math.round(c*k),h=r/2,y=r/2;this._ensureBuffer(r);d.forEach(function(a,b){var c=new Map;n.readPixels(Math.floor(b[0]*k-r/2),Math.floor(p-b[1]*k-r/2),r,r,6408,5121,e._buf);for(var f=0;f<e._buf32.length;f++){var l=e._buf32[f];if(4294967295!==l&&0!==l){var u=f%r,m=r-Math.floor(f/r),u=(h-u)*(h-u)+(y-m)*(y-m),m=c.has(l)?
c.get(l):4294967295;c.set(l,Math.min(u,m))}}c=g.pairsOfMap(c).sort(function(a,b){return a[1]-b[1]}).map(function(a){return a[0]});a.resolve(c);d.delete(b)})};d.prototype._ensureBuffer=function(a){this._lastSize!==a&&(this._lastSize=a,this._buf=new Uint8Array(4*a*a),this._buf32=new Uint32Array(this._buf.buffer))};return d}(n.Effect);c.HittestEffect=b})},"esri/views/2d/engine/webgl/painter/RenderPass":function(){define("require exports @dojo/framework/shim/iterator ../../../../../core/has ../../../../../core/maybe ../enums".split(" "),
function(b,c,e,g,f,a){Object.defineProperty(c,"__esModule",{value:!0});b=function(){function b(b,d){this.brushes=b;this.name=d.name;this.drawPhase=d.drawPhase||a.WGLDrawPhase.MAP;this._targetFn=d.target;this.effects=d.effects||[];this.has=d.has}b.prototype.render=function(a){var b=a.context,c=a.profiler,e=this._targetFn(),f=this.drawPhase&a.drawPhase;c.recordPassStart(this.name);if(f&&(!this.has||g(this.has))){this._doRender(a,e);c.recordPassEnd();for(var f=0,k=this.effects;f<k.length;f++){var m=
k[f];if(m.enable()){var n=m.apply;c.recordPassStart(this.name+"."+n.name);c.recordBrushStart(n.name);var m=m.args&&m.args(),q=b.getViewport(),v=q.x,p=q.y,r=q.width,q=q.height,h=b.getBoundFramebufferObject();n.bind(a,m);this._doRender(a,e,n.defines);n.draw(a,m);n.unbind(a,m);b.bindFramebuffer(h);b.setViewport(v,p,r,q);c.recordBrushEnd();c.recordPassEnd()}}}};b.prototype._doRender=function(a,b,c){if(!f.isNone(b))if(e.isArrayLike(b))for(var d=0;d<b.length;d++){var g=b[d];if(g.isReady&&g.visible)for(var l=
0,m=this.brushes;l<m.length;l++){var k=m[l];a.profiler.recordBrushStart(k.name);k.prepareState(a,g,c);k.draw(a,g,c);a.profiler.recordBrushEnd()}}else for(d=0,g=this.brushes;d<g.length;d++)k=g[d],a.profiler.recordBrushStart(k.name),k.prepareState(a,b,c),k.draw(a,b,c),a.profiler.recordBrushEnd()};return b}();c.default=b})},"esri/views/2d/engine/webgl/Profiler":function(){define("require exports ../../../../core/CircularArray ../../../../core/Evented ../../../../core/has ../../../../core/maybe ../../../webgl/capabilities/DisjointTimerQuery".split(" "),
function(b,c,e,g,f,a,n){Object.defineProperty(c,"__esModule",{value:!0});var k=f("esri-2d-profiler");b=function(){function b(a,b){var d=this;this._events=new g;this._entries=new Map;this._timings=new e.default(10);if(k){this._ext=n.load(a.gl,{});this._debugOutput=b;var c=a.gl;if(this.enableCommandLogging){a=function(a){if("function"===typeof c[a]){var b=c[a],e=-1!==a.indexOf("draw");c[a]=function(){for(var f=[],g=0;g<arguments.length;g++)f[g]=arguments[g];d._events.emit("command",{container:d._currentContainer,
pass:d._currentPass,brush:d._currentBrush,method:a,args:f,isDrawCommand:e});d._currentSummary&&(d._currentSummary.commands++,e&&d._currentSummary.drawCommands++);return b.apply(c,f)}}};for(var f in c)a(f)}}}Object.defineProperty(b.prototype,"enableCommandLogging",{get:function(){return!("object"===typeof k&&k.disableCommands)},enumerable:!0,configurable:!0});b.prototype.recordContainerStart=function(a){k&&(this._currentContainer=a)};b.prototype.recordContainerEnd=function(){k&&(this._currentContainer=
null)};b.prototype.recordPassStart=function(a){k&&(this._currentPass=a,this._initSummary())};b.prototype.recordPassEnd=function(){k&&(this._currentPass=null,this._emitSummary())};b.prototype.recordBrushStart=function(a){k&&(this._currentBrush=a)};b.prototype.recordBrushEnd=function(){k&&(this._currentBrush=null)};b.prototype.recordStart=function(b){if(k&&a.isSome(this._ext)){if(this._entries.has(b)){var d=this._entries.get(b),c=this._ext.resultAvailable(d.query),e=this._ext.disjoint();if(c&&!e){c=
this._ext.getResult(d.query)/1E6;e=0;if(a.isSome(this._timings.enqueue(c))){for(var e=this._timings.entries,f=e.length,g=0,l=0;l<e.length;l++)g+=e[l];e=g/f}c=c.toFixed(2);e=e?e.toFixed(2):"--";this.enableCommandLogging?(console.groupCollapsed("Frame report for "+b+", "+c+" ms ("+e+" last 10 avg)\n"+d.commandsLen+" Commands ("+d.drawCommands+" draw)"),console.log("RenderPass breakdown: "),console.table(d.summaries),console.log("Commands: ",d.commands),console.groupEnd()):console.log("Frame report for "+
b+", "+c+" ms ("+e+" last 10 avg)");this._debugOutput.innerHTML=c+" ("+e+")"}c=0;for(d=d.handles;c<d.length;c++)d[c].remove();this._entries.delete(b)}var n={name:b,query:this._ext.createQuery(),commands:[],commandsLen:0,drawCommands:0,summaries:[],handles:[]};this.enableCommandLogging&&(n.handles.push(this._events.on("command",function(a){n.commandsLen++;n.commands.push(a);a.isDrawCommand&&n.drawCommands++})),n.handles.push(this._events.on("summary",function(a){delete a.target;n.summaries.push(a)})));
this._ext.beginTimeElapsed(n.query);this._entries.set(b,n)}};b.prototype.recordEnd=function(b){k&&a.isSome(this._ext)&&this._entries.has(b)&&this._ext.endTimeElapsed()};b.prototype._initSummary=function(){this.enableCommandLogging&&(this._currentSummary={container:this._currentContainer,pass:this._currentPass,drawCommands:0,commands:0})};b.prototype._emitSummary=function(){this.enableCommandLogging&&this._events.emit("summary",this._currentSummary)};return b}();c.Profiler=b})},"esri/core/CircularArray":function(){define(["require",
"exports"],function(b,c){Object.defineProperty(c,"__esModule",{value:!0});b=function(){function b(b){void 0===b&&(b=Number.POSITIVE_INFINITY);this._start=this.size=0;this.maxSize=b;this._buffer=isFinite(b)?Array(b):[]}Object.defineProperty(b.prototype,"entries",{get:function(){return this._buffer},enumerable:!0,configurable:!0});b.prototype.enqueue=function(b){if(this.size===this.maxSize){var c=this._buffer[this._start];this._buffer[this._start]=b;this._start=(this._start+1)%this.maxSize;return c}isFinite(this.maxSize)?
this._buffer[(this._start+this.size++)%this.maxSize]=b:this._buffer[this._start+this.size++]=b;return null};b.prototype.dequeue=function(){if(0===this.size)return null;var b=this._buffer[this._start];this._buffer[this._start]=null;this.size--;this._start=(this._start+1)%this.maxSize;return b};return b}();c.default=b})},"esri/views/2d/engine/webgl/WebGLDriverTest":function(){define("require exports ../../../../core/Logger ../../../../core/maybe ../../../webgl ./VertexStream".split(" "),function(b,
c,e,g,f,a){Object.defineProperty(c,"__esModule",{value:!0});var n=e.getLogger("esri.views.2d.engine.webgl.WebGLDriverTest"),k=function(){function a(a){this._ignoresSamplerPrecision=null;this._context=a}Object.defineProperty(a.prototype,"ignoresSamplerPrecision",{get:function(){g.isNone(this._ignoresSamplerPrecision)&&(this._ignoresSamplerPrecision=c.testSamplerPrecision(this._context));return this._ignoresSamplerPrecision},enumerable:!0,configurable:!0});return a}();c.testWebGLDriver=function(a){return new k(a)};
c.testSamplerPrecision=function(b){var d=new f.FramebufferObject(b,{colorTarget:0,depthStencilTarget:0},{target:3553,wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1}),c=new Uint8Array(4),e=new a(b,[0,0,1,0,0,1,1,1]),g=new f.Program(b,"\nprecision highp float;\n\nattribute vec2 a_pos;\n\nuniform highp sampler2D u_texture;\nvarying vec4 v_color;\n\nfloat getBit(in float bitset, in int bitIndex) {\n  float offset \x3d pow(2.0, float(bitIndex));\n\n  return mod(floor(bitset / offset), 2.0);\n}\n\nvoid main() {\n  vec4 value \x3d texture2D(u_texture, vec2(0.0));\n\n  float bit \x3d getBit(value.x * 255.0, 1);\n\n  v_color \x3d bit * vec4(1.0);\n\n  gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n}\n",
"\nprecision highp float;\n\nvarying vec4 v_color;\n\nvoid main() {\n  gl_FragColor \x3d v_color;\n}\n",{a_pos:0}),m=new f.Texture(b,{target:3553,wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array([2,255,0,0]));g.setUniform1i("u_texture",0);b.bindTexture(m,0);b.bindFramebuffer(d);b.bindProgram(g);var k=b.getViewport(),m=k.x,q=k.y,v=k.width,k=k.height;b.setViewport(0,0,1,1);e.draw();b.setViewport(m,q,v,k);d.readPixels(0,0,1,1,6408,5121,c);g.dispose();e.dispose();
d.dispose();(b=255!==c[0]||255!==c[1]||255!==c[2]||255!==c[3])&&n.warn("A problem was detected with your graphics driver. Your driver does not appear to honor sampler precision specifiers, which may result in rendering issues due to numerical instability. We recommend ensuring that your drivers have been updated to the latest version. Applying lowp sampler workaround. ["+c[0]+"."+c[1]+"."+c[2]+"."+c[3]+"]");return b}})},"esri/views/2d/engine/webgl/shaders/StencilPrograms":function(){define(["require",
"exports","./sources/resolver"],function(b,c,e){Object.defineProperty(c,"__esModule",{value:!0});c.stencil={name:"stencil",shaders:{vertexShader:e.resolveIncludes("stencil/stencil.vert"),fragmentShader:e.resolveIncludes("stencil/stencil.frag")},attributes:{a_pos:0}}})},"esri/views/2d/engine/webgl/AttributeStoreView":function(){define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/Error ../../../../core/has ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../webgl ./definitions ./Utils ./util/debug ../../../webgl/FramebufferObject".split(" "),
function(b,c,e,g,f,a,n,k,d,l,t,x,w,m){Object.defineProperty(c,"__esModule",{value:!0});var z=n.getLogger("esri.views.2d.engine.webgl.AttributeStoreView"),q=w.createDebugLogger(w.DEBUG_ATTR_UPDATES,z),v=function(){function b(a,b,d){this._lastTexture=this._texture=null;this._fbos={};this.texelSize=4;var c=a.buffer,e=a.pixelType;a=a.textureOnly;var h=x.getPixelArrayCtor(e);this.shared=d;this.pixelType=e;this.size=b;this.textureOnly=a;a||(this.data=new h(k.expect(c)));this._resetRange()}b.prototype.destroy=
function(){k.andThen(this._texture,function(a){return a.dispose()});var a=function(a){k.andThen(b._fbos[a],function(b){"0"===a&&b.detachColorTexture();b.dispose()});b._fbos[a]=null},b=this,d;for(d in this._fbos)a(d);this._texture=null};Object.defineProperty(b.prototype,"_textureDesc",{get:function(){return{target:3553,wrapMode:33071,pixelFormat:6408,dataType:this.pixelType,samplingMode:9728,width:this.size,height:this.size}},enumerable:!0,configurable:!0});b.prototype.setData=function(a,b,d){a&=2147483647;
var c=k.expect(this.data);b=a*this.texelSize+b;!c||b>=c.length||(c[b]=d,this.dirtyStart=Math.min(this.dirtyStart,a),this.dirtyEnd=Math.max(this.dirtyEnd,a))};b.prototype.getData=function(a,b){if(k.isNone(this.data))return null;a=(a&2147483647)*this.texelSize+b;return!this.data||a>=this.data.length?null:this.data[a]};b.prototype.getTexture=function(a){var b=this;return k.unwrapOr(this._texture,function(){return b._initTexture(a)})};b.prototype.getFBO=function(a,b){void 0===b&&(b=0);if(k.isNone(this._fbos[b])){var d=
0===b?this.getTexture(a):this._textureDesc;this._fbos[b]=new m(a,{colorTarget:0,depthStencilTarget:0},d)}return this._fbos[b]};Object.defineProperty(b.prototype,"locked",{get:function(){return 5121===this.pixelType&&this.shared&&!this.textureOnly&&a("esri-atomics")&&this.data?1===Atomics.load(this.data,0):!1},enumerable:!0,configurable:!0});b.prototype.updateTexture=function(a){if(!this.locked)try{var b=this.dirtyStart,d=this.dirtyEnd;if(!(b>d)){this._resetRange();var c=k.expect(this.data).buffer,
e=this.getTexture(a),g=(b-b%this.size)/this.size,l=(d-d%this.size)/this.size,p=g*this.size*4,m=4*(this.size+l*this.size)-p,r=x.getPixelArrayCtor(this.pixelType),q=r.BYTES_PER_ELEMENT;try{new r(c,p*q,m)}catch(J){console.debug(J)}var n=new r(c,p*q,m),v=this.size;a=l-g+1;a>this.size?z.error(new f("mapview-webgl","Out-of-bounds index when updating AttributeData")):e.updateData(0,0,g,v,a,n)}}catch(J){console.debug(J)}};b.prototype.update=function(a){var b=a.data,d=a.start,c=a.end;if(k.isSome(b))for(var e=
this.data,f=d*this.texelSize,g=0;g<b.length;g++)a.layout&1<<g%this.texelSize&&(e[f+g]=b[g]);this.dirtyStart=Math.min(this.dirtyStart,d);this.dirtyEnd=Math.max(this.dirtyEnd,c)};b.prototype.resize=function(a,b){var d=this.size;this.size=b;this.textureOnly?d!==this.size&&(this._lastTexture=this._texture,this._texture=null):(b=x.getPixelArrayCtor(this.pixelType),this.destroy(),this.data=new b(k.expect(a.buffer)))};b.prototype._resetRange=function(){this.dirtyStart=2147483647;this.dirtyEnd=0};b.prototype._initTexture=
function(a){var b=new l.Texture(a,this._textureDesc,k.unwrapOr(this.data,void 0));if(k.isSome(this._lastTexture)&&this._fbos[0]){var d=this._lastTexture.descriptor.width,c=this._lastTexture.descriptor.height,e=this._lastTexture.descriptor.dataType,f=this._lastTexture.descriptor.pixelFormat,g=this.getFBO(a),p=x.getPixelBytes(e),m=x.getPixelArrayCtor(e),p=new ArrayBuffer(d*c*p*this.texelSize),m=new m(p),p=a.getBoundFramebufferObject(),r=a.getViewport(),q=r.x,n=r.y,v=r.width,r=r.height;a.bindFramebuffer(g);
g.readPixels(0,0,d,c,f,e,m);b.updateData(0,0,0,2*d,c/2,m);a.setViewport(q,n,v,r);a.bindFramebuffer(p)}this.destroy();return this._texture=b};return b}();b=function(){function a(){this._locked=this._forceNextUpload=this._initialized=!1}a.prototype.initialize=function(a){var b=a.blocks,d=a.shared,c=a.size;this.shared=d;this.size=c;q("Initializing AttributeStoreView",a);if(k.isNone(this._data))this._data=k.mapMany(b,function(a){return new v(a,c,d)});else for(a=0;a<this._data.length;a++){var e=this._data[a],
f=b[a];k.isSome(f)&&(k.isNone(e)?this._data[a]=new v(f,c,d):e.resize(f,c))}this._initialized=!0};a.prototype.destroy=function(){k.andThen(this._data,function(a){return k.mapMany(a,function(a){return a.destroy()})});k.andThen(this._defaultTexture,function(a){return a.dispose()})};a.prototype.getBlock=function(a){return k.isNone(this._data)?null:this._data[a]};a.prototype.setLabelMinZoom=function(a,b){this.setData(a,0,1,b)};a.prototype.getLabelMinZoom=function(a){return this.getData(a,0,1,255)};a.prototype.getFilterFlags=
function(a){return this.getData(a,0,0,0)};a.prototype.getVVSize=function(a){return this.getData(a,t.ATTRIBUTE_DATA_VV,0,0)};a.prototype.getData=function(a,b,d,c){if(!this._data)return 0;b=k.expect(this._data)[b];if(k.isNone(b))return 0;a=b.getData(a,d);return k.isSome(a)?a:c};a.prototype.setData=function(a,b,d,c){b=k.expect(this._data)[b];k.expect(b).setData(a,d,c)};a.prototype.lockTextureUpload=function(){this._locked=!0};a.prototype.unlockTextureUpload=function(){this._locked=!1};a.prototype.forceTextureUpload=
function(){this._forceNextUpload=!0};a.prototype.requestUpdate=function(a){return g(this,void 0,void 0,function(){var b;return e(this,function(c){if(this._pendingAttributeUpdate)return z.error(new f("mapview-webgl","Tried to update attribute data with a pending update")),[2];b=d.createResolver();q("AttributeStoreView Update Requested",a);this._pendingAttributeUpdate={data:a,resolver:b};return[2,b.promise]})})};a.prototype.update=function(){if(this._initialized&&k.isSome(this._pendingAttributeUpdate)){for(var a=
this._pendingAttributeUpdate,b=a.data,a=a.resolver,d=k.expect(this._data),c=function(a){var c=b.blocks[a];k.andThen(d[a],function(b){return k.andThen(c,function(d){q("Updating block "+a,d);b.update(d)})})},e=0;e<b.blocks.length;e++)c(e);this._pendingAttributeUpdate=null;a()}};a.prototype.bindTextures=function(a){this.update();var b=this._getDefaultTexture(a);if(this._initialized){var d=k.expect(this._data);if(!this._locked||this._forceNextUpload)k.forEachSome(d,function(b){return b.updateTexture(a)}),
this._forceNextUpload=!1;a.bindTexture(k.mapOr(d[0],b,function(b){return b.getTexture(a)}),t.TEXTURE_BINDING_ATTRIBUTE_DATA_0);a.bindTexture(k.mapOr(d[1],b,function(b){return b.getTexture(a)}),t.TEXTURE_BINDING_ATTRIBUTE_DATA_1);a.bindTexture(k.mapOr(d[2],b,function(b){return b.getTexture(a)}),t.TEXTURE_BINDING_ATTRIBUTE_DATA_2);a.bindTexture(k.mapOr(d[3],b,function(b){return b.getTexture(a)}),t.TEXTURE_BINDING_ATTRIBUTE_DATA_3)}else a.bindTexture(b,t.TEXTURE_BINDING_ATTRIBUTE_DATA_0),a.bindTexture(b,
t.TEXTURE_BINDING_ATTRIBUTE_DATA_1),a.bindTexture(b,t.TEXTURE_BINDING_ATTRIBUTE_DATA_2),a.bindTexture(b,t.TEXTURE_BINDING_ATTRIBUTE_DATA_3)};a.prototype._getDefaultTexture=function(a){k.isNone(this._defaultTexture)&&(this._defaultTexture=new l.Texture(a,{wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array(4)));return this._defaultTexture};return a}();c.AttributeStoreView=b})},"esri/views/2d/engine/webgl/Utils":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/Error ../../../../core/Logger ../../../../core/mathUtils ../../../../core/screenUtils ../../../../symbols/cim/enums ../../../webgl ./color ./enums ./SymbolProperties".split(" "),
function(b,c,e,g,f,a,n,k,d,l,t,x){function w(a){for(var b={},d=0;d<a.length;d++){var c=a[d];b[c.name]=c.strideInBytes}return b}function m(a){switch(a){case t.WGLGeometryType.MARKER:return y;case t.WGLGeometryType.FILL:return u;case t.WGLGeometryType.LINE:return D;case t.WGLGeometryType.TEXT:return B;case t.WGLGeometryType.LABEL:return C}return null}function z(a){switch(a%4){case 0:case 2:return 4;case 1:case 3:return 1}}function q(a){return"string"===typeof a}function v(a){switch(a){case 5120:case 5121:return 1;
case 5122:case 5123:return 2;case 5126:case 5124:case 5125:return 4}}function p(a){var b={},d=function(d){var c=0;b[d]=a[d].map(function(a){var b=e({},a,{normalized:a.normalized||!1,divisor:a.divisor||0,offset:c,stride:0});c+=a.count*v(a.type);return b});b[d].forEach(function(a){return a.stride=c})},c;for(c in a)d(c);return b}Object.defineProperty(c,"__esModule",{value:!0});var r,h=f.getLogger("esri.views.2d.engine.webgl.Utils");c.C_VBO_GEOMETRY="geometry";c.C_VBO_PERINSTANCE="per_instance";c.C_VBO_PERINSTANCE_VV=
"per_instance_vv";c.C_ICON_VERTEX_DEF=[{name:c.C_VBO_GEOMETRY,strideInBytes:32,divisor:0}];c.C_FILL_VERTEX_DEF=[{name:c.C_VBO_GEOMETRY,strideInBytes:32,divisor:0}];c.C_FILL_VERTEX_DEF_DD=[{name:c.C_VBO_GEOMETRY,strideInBytes:12,divisor:0}];c.C_LINE_VERTEX_DEF=[{name:c.C_VBO_GEOMETRY,strideInBytes:36,divisor:0}];c.C_TEXT_VERTEX_DEF=[{name:c.C_VBO_GEOMETRY,strideInBytes:32,divisor:0}];c.C_LABEL_VERTEX_DEF=[{name:c.C_VBO_GEOMETRY,strideInBytes:36,divisor:0}];c.C_ICON_STRIDE_SPEC=w(c.C_ICON_VERTEX_DEF);
c.C_FILL_STRIDE_SPEC=w(c.C_FILL_VERTEX_DEF);c.C_FILL_STRIDE_SPEC_DD=w(c.C_FILL_VERTEX_DEF_DD);c.C_LINE_STRIDE_SPEC=w(c.C_LINE_VERTEX_DEF);c.C_TEXT_STRIDE_SPEC=w(c.C_TEXT_VERTEX_DEF);c.C_LABEL_STRIDE_SPEC=w(c.C_LABEL_VERTEX_DEF);c.getStrides=function(a,b){switch(a){case t.WGLGeometryType.MARKER:return c.C_ICON_STRIDE_SPEC;case t.WGLGeometryType.FILL:return b?c.C_FILL_STRIDE_SPEC_DD:c.C_FILL_STRIDE_SPEC;case t.WGLGeometryType.LINE:return c.C_LINE_STRIDE_SPEC;case t.WGLGeometryType.TEXT:return c.C_TEXT_STRIDE_SPEC;
case t.WGLGeometryType.LABEL:return c.C_LABEL_STRIDE_SPEC}return null};var y=[c.C_VBO_GEOMETRY],u=[c.C_VBO_GEOMETRY],D=[c.C_VBO_GEOMETRY],B=[c.C_VBO_GEOMETRY],C=[c.C_VBO_GEOMETRY];c.getNamedBuffers=m;c.strideToPackingFactor=z;c.allocateTypedArrayBuffer=function(a,b){switch(b%4){case 0:case 2:return new Uint32Array(Math.floor(a*b/4));case 1:case 3:return new Uint8Array(a*b)}};c.allocateTypedArrayBufferwithData=function(a,b){switch(b%4){case 0:case 2:return new Uint32Array(a);case 1:case 3:return new Uint8Array(a)}};
c.getTextProperties=function(a){return x.TextProperties.pool.acquire(a.color?l.copyAndPremultiply(a.color):[255,255,255,255],a.haloColor?l.copyAndPremultiply(a.haloColor):[255,255,255,255],n.pt2px(a.haloSize),n.pt2px(a.font.size),a.angle*Math.PI/180,a.xoffset/a.font.size,a.yoffset/a.font.size,"left"===a.horizontalAlignment?0:"right"===a.horizontalAlignment?1:.5,"top"===a.verticalAlignment?0:"bottom"===a.verticalAlignment?1:.5)};c.isDefined=function(a){return null!=a};c.isNumber=function(a){return"number"===
typeof a};c.isString=q;c.isStringOrNull=function(a){return null==a||q(a)};c.getCapType=function(a,b){switch(a){case "butt":return k.CapType.BUTT;case "round":return b?k.CapType.SQUARE:k.CapType.ROUND;case "square":return k.CapType.SQUARE;default:return h.error(new g("mapview-invalid-type","Cap type "+a+" is not a valid option. Defaulting to round")),k.CapType.ROUND}};c.getJoinType=function(a){switch(a){case "miter":return k.JoinType.MITER;case "bevel":return k.JoinType.BEVEL;case "round":return k.JoinType.ROUND;
default:return h.error(new g("mapview-invalid-type","Join type "+a+" is not a valid option. Defaulting to round")),k.JoinType.ROUND}};c.getVVType=function(a){switch(a){case "opacity":return t.VVType.OPACITY;case "color":return t.VVType.COLOR;case "rotation":return t.VVType.ROTATION;case "size":return t.VVType.SIZE;default:return h.error("Cannot interpret unknown vv: "+a),null}};c.getTransformParams=function(a){return{transform:a.transform,hasZ:a.hasZ,hasM:a.hasM}};c.copyMeshData=function(a,b,d,c,
e,f,h){for(var g in f)for(var l=f[g].stride,m=z(l),p=f[g].data,u=d[g].data,k=l*e.vertexCount/m,r=l*a/m,m=l*e.vertexFrom/m,l=0;l<k;++l)u[l+r]=p[l+m];d=e.indexCount;for(l=0;l<d;++l)c[l+b]=h[l+e.indexFrom]-e.vertexFrom+a};c.C_VBO_INFO=(r={},r[c.C_VBO_GEOMETRY]=35044,r);c.createGeometryData=function(a,b){for(var d=[],c=0;5>c;++c){for(var e={},f=0,h=m(c);f<h.length;f++){var g=h[f];e[g]={data:b(c,g)}}d.push({data:a(c),buffers:e})}return d};c.createTextureFromTexelData=function(b,c){var e,f;a.isPowerOfTwo(c.width)&&
a.isPowerOfTwo(c.height)?(e=!0,f=9987):(e=!1,f=9729);return new d.Texture(b,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,hasMipmap:e,samplingMode:f,wrapMode:33071,flipped:!0},c)};c.geometryToMappedGeometry=function(a){return{vertexFrom:void 0,vertexTo:void 0,geometry:a}};c.getBytes=v;c.getPixelBytes=function(a){switch(a){case 5121:return 1;case 32819:return 2;case 5126:return 4;default:h.error(new g("webgl-utils","Unable to handle type "+a))}};c.getPixelArrayCtor=function(a){switch(a){case 5121:return Uint8Array;
case 32819:return Uint16Array;case 5126:return Float32Array;default:h.error(new g("webgl-utils","Unable to handle type "+a))}};var A=new Map;c.createProgramDescriptor=function(a,b){if(!A.has(a)){var d=p(b),c={},e;for(e in d){var f=d[e];c[e]=f.length?f[0].stride:0}e={};for(var h in b)for(var f=0,g=b[h];f<g.length;f++){var l=g[f];e[l.name]=l.location}A.set(a,{strides:c,bufferLayouts:d,attributes:e})}return A.get(a)}})},"esri/views/2d/engine/webgl/color":function(){define(["require","exports","./number"],
function(b,c,e){function g(a,b){Array.isArray(b)?(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3]):(a[0]=b.r,a[1]=b.g,a[2]=b.b,a[3]=b.a);return a}function f(a,b,d){void 0===b&&(b=0);void 0===d&&(d=!1);var c=a[b+3];a[b+0]*=c;a[b+1]*=c;a[b+2]*=c;d||(a[b+3]*=255);return a}Object.defineProperty(c,"__esModule",{value:!0});c.white=[255,255,255,1];var a=[0,0,0,0];c.premultiplyAlpha=f;c.copyAndPremultiply=function(a){return f(g([],a))};c.premultiplyAlphaUint32=function(b){f(g(a,b));return e.i8888to32(a[0],a[1],a[2],
a[3])};c.premultiplyAlphaRGBA=function(a){if(!a)return 0;var b=a.a;return e.i8888to32(a.r*b,a.g*b,a.b*b,255*b)}})},"esri/views/2d/engine/webgl/SymbolProperties":function(){define(["require","exports","../../../../core/ObjectPool"],function(b,c,e){Object.defineProperty(c,"__esModule",{value:!0});b=function(){function b(){this.color=[0,0,0,0];this.haloColor=[0,0,0,0];this.haloSize=0;this.size=12;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=0}b.prototype.acquire=function(b,a,c,e,d,
g,t,x,w){this.color=b;this.haloColor=a;this.haloSize=c;this.size=e;this.angle=d;this.offsetX=g;this.offsetY=t;this.hAnchor=x;this.vAnchor=w};b.prototype.release=function(){this.color[0]=this.color[1]=this.color[2]=this.color[3]=0;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=this.size=this.haloSize=this.haloColor[0]=this.haloColor[1]=this.haloColor[2]=this.haloColor[3]=0};b.pool=new e(b);return b}();c.TextProperties=b})},"esri/views/2d/engine/webgl/util/debug":function(){define(["require",
"exports"],function(b,c){Object.defineProperty(c,"__esModule",{value:!0});c.createDebugLogger=function(b,c){return b&&function(){for(var b=[],a=0;a<arguments.length;a++)b[a]=arguments[a];return c.warn.apply(c,["DEBUG:"].concat(b))}||function(){return null}};c.DEBUG_ATTR_UPDATES=!1})},"esri/views/2d/engine/webgl/collisions/CollisionGrid":function(){define(["require","exports","../definitions"],function(b,c,e){Object.defineProperty(c,"__esModule",{value:!0});b=function(){function b(b){this._bucketSize=
b;this._rowsLength=e.TILE_SIZE/b;this._colsLength=e.TILE_SIZE/b;this._grid=this._initGrid()}b.prototype.checkOverlap=function(b,a){b=Math.floor(b/this._bucketSize);a=Math.floor(a/this._bucketSize);return 0>b||b>=this._rowsLength||0>a||a>=this._colsLength?!0:this._grid[a][b]};b.prototype.markUsed=function(b,a){this._grid[Math.floor(a/this._bucketSize)][Math.floor(b/this._bucketSize)]=!0};b.prototype.reset=function(){this._grid=this._initGrid()};b.prototype._initGrid=function(){for(var b=[],a=0;a<this._rowsLength;a++)b.push(Array(this._colsLength));
return b};return b}();c.CollisionGrid=b})},"esri/views/2d/engine/webgl/collisions/CollisionEngine":function(){define("require exports ../../../../../core/Error ../../../../../core/Logger ../../../../../core/MapUtils ../../../../../core/mathUtils ../definitions ./CollisionBucket ./LayerCollisionInfo".split(" "),function(b,c,e,g,f,a,n,k,d){Object.defineProperty(c,"__esModule",{value:!0});var l=n.TILE_SIZE/n.COLLISION_BUCKET_SIZE,t=g.getLogger("esri.views.2d.engine.webgl.collisions.CollisionEngine");
b=function(){function b(a){this._layers=new Map;this._collisionBuckets=new Map;this._didError=!1;this._tilingScheme=a}Object.defineProperty(b.prototype,"collisionInfos",{get:function(){return f.valuesOfMap(this._layers)},enumerable:!0,configurable:!0});b.prototype.registerLayerView=function(a,b){if(!this._layers.has(a)){var c=d.default.create(a,b,this.collisionInfos,this._tilingScheme);this._layers.set(a,c);this._collisionBuckets.forEach(function(a){return a.onRegisterLayer(c.index)})}};b.prototype.unregisterLayerView=
function(a){var b=this;if(this._layers.has(a)){var c=this._layers.get(a);d.default.delete(c.index,this.collisionInfos);this._layers.delete(a);this._collisionBuckets.forEach(function(a,d){var e=a.getTile(c.index);e&&(a.onUnregisterLayer(c.index),a.canDelete()&&b._collisionBuckets.delete(d),e.reference&&(e.reference.isDirty=!1))})}};b.prototype.addTile=function(a,b){var d=b.key.id;this._layers.has(a)&&(this._collisionBuckets.has(d)||this._collisionBuckets.set(d,new k.default(b.key,this._layers.size)),
a=this._getIndex(a),this._collisionBuckets.get(d).getTile(a).reference=b)};b.prototype.removeTile=function(a,b){this._layers.has(a)&&this._collisionBuckets.has(b)&&(a=this._getIndex(a),b=this._collisionBuckets.get(b).getTile(a),b.dirty=!1,b.reference=null)};b.prototype.run=function(a,b){var c=f.valuesOfMap(this._collisionBuckets).sort(function(a,b){return a.key.compareRowMajor(b.key)}),g=!0,l=a.renderingOptions.labelCollisionsEnabled&&!this._didError,p=this.collisionInfos;try{for(var m=0;m<c.length;m++){var h=
c[m],g=g||h.isDirty;h.computeNeighbors(this._collisionBuckets);for(var k=0;k<this._layers.size;k++){var u=d.default.find(k,p);h.reset(a,g,u)}}for(a=0;a<this._layers.size;a++)for(u=d.default.find(a,p),g=0,m=c;g<m.length;g++)h=m[g],this._run(l,h,u,b)}catch(D){t.error(new e("mapview-labeling","Encountered an error during decluttering. Disabling collisions",D)),this._didError=!0}for(b=0;b<c.length;b++)h=c[b],h.ready()};b.prototype._run=function(a,b,d,c){var e=b.getReference(d.index);e&&e.hasData&&(e.key.level!==
c?this._resetLabelsMinZoom(b,d):this._runVisibility(a,b,e,d,c))};b.prototype._resetLabelsMinZoom=function(a,b){if(a&&"polyline"!==b.geometryType&&(a=a.getReference(b.index))&&a.hasData){b=b.layerView.tileRenderer.featuresView.attributeView;var d=0;for(a=a.displayObjects;d<a.length;d++)b.setLabelMinZoom(a[d].id,255)}};b.prototype._checkLabelsVisible=function(a,b){var d=!b.effect||b.effect.excludedLabelsVisible||!!(a&n.EFFECT_FLAG_0);return(!b.filter||!!(a&n.FILTER_FLAG_0))&&d};b.prototype._runVisibility=
function(a,b,d,c,e){var f=c.layerView.tileRenderer.featuresView.attributeView,g=0;for(d=d.displayObjects.sort(function(a,b){a=f.getLabelMinZoom(a.id);b=f.getLabelMinZoom(b.id);return a-b});g<d.length;g++){var h=d[g];if(h.metrics.length){var l="polyline"===c.geometryType?0:10*(e-1),m=f.getFilterFlags(h.id),k=this._checkLabelsVisible(m,c.layerView);if(a)for(var q=0;q<h.metrics.length;q++)m=h.metrics[q],m=k?-1!==m.minZoom?m.minZoom:this._computeLabelVisibility(h,m,c.index,b,m.baseZoom,e):255,l=Math.max(m,
l);f.setLabelMinZoom(h.id,l);k=0;for(h=h.metrics;k<h.length;k++)m=h[k],m.minZoom=l}}};b.prototype._computeLabelVisibility=function(a,b,d,c,e,f){for(var g=b.xBucket,h=b.yBucket,p=b.xOverflow,m=b.yOverflow,k=g-p,g=g+p+1,p=h+m+1,h=h-m;h<p;h++)for(m=k;m<g;m++)if(!(m<-l||h<-l||m>l||h>l))for(var q=0;q<=d;q++){var n=this._getRelativeSubBucket(q,c,m,h);if(n)for(var v=0;v<n.length;v++){var t=n[v];if(q!==d||t.id!==a.id)t=this._compareLabels(b,t,e,f),e=Math.max(t,e)}}return e};b.prototype._compareLabels=function(b,
d,c,e){if(-1===d.minZoom||d.minZoom>10*(e+1))return c;b=b.findCollisionDelta(d);e=a.clamp(Math.ceil(10*(b+e)),0,255);return d.minZoom>=e?c:Math.max(c,e)};b.prototype._getNeighboringTile=function(a,b,d,c){return(b=b.neighbors[3*(1+c)+(1+d)])&&b.getTile(a)};b.prototype._getRelativeSubBucket=function(b,d,c,e){var f=a.sign(Math.floor(c/4)),g=a.sign(Math.floor(e/4));return(b=this._getNeighboringTile(b,d,f,g))&&b.reference&&b.index&&b.reference.hasData?b.index[e-4*g][c-4*f]:null};b.prototype._getIndex=
function(a){return this._layers.get(a).index};return b}();c.CollisionEngine=b})},"esri/views/2d/engine/webgl/collisions/CollisionBucket":function(){define(["require","exports","../../../tiling","./CollisionBucketEntry"],function(b,c,e,g){Object.defineProperty(c,"__esModule",{value:!0});b=function(){function b(a,b){this.neighbors=Array(9);this._tiles=Array(b);for(var c=0;c<b;c++)this._tiles[c]=new g.default;this.key=a}Object.defineProperty(b.prototype,"isDirty",{get:function(){for(var a=0,b=this._tiles;a<
b.length;a++)if(b[a].dirty)return!0;return!1},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"size",{get:function(){return this._tiles.length},enumerable:!0,configurable:!0});b.prototype.getTile=function(a){return this._tiles[a]};b.prototype.getReference=function(a){return(a=this._tiles[a])&&a.reference};b.prototype.onRegisterLayer=function(a){this.invalidateRange(a);this._add(a)};b.prototype.onUnregisterLayer=function(a){this.invalidateRange(a);this._remove(a)};b.prototype.onLabelsRendered=
function(){};b.prototype.invalidateRange=function(a){for(;a<this._tiles.length;a++)this._tiles[a].dirty=!0};b.prototype.add=function(a){this._add(a)};b.prototype.remove=function(a){this._remove(a)};b.prototype.canDelete=function(){return 0===this._tiles.length};b.prototype.ready=function(){for(var a=0,b=this._tiles;a<b.length;a++)b[a].dirty=!1};b.prototype.computeNeighbors=function(a){this.neighbors[0]=this._getNeighbor(a,-1,-1);this.neighbors[1]=this._getNeighbor(a,0,-1);this.neighbors[2]=this._getNeighbor(a,
1,-1);this.neighbors[3]=this._getNeighbor(a,-1,0);this.neighbors[4]=this;this.neighbors[5]=this._getNeighbor(a,1,0);this.neighbors[6]=this._getNeighbor(a,-1,1);this.neighbors[7]=this._getNeighbor(a,0,1);this.neighbors[8]=this._getNeighbor(a,1,1)};b.prototype.reset=function(a,b,c){var d=this._tiles[c.index];d&&d.reset(a,b,c)};b.prototype._add=function(a){var b=[];if(a>=this._tiles.length)this._tiles.push(new g.default);else{for(var c=0;c<this._tiles.length;c++)c===a&&b.push(new g.default),b.push(this._tiles[c]);
this._tiles=b}};b.prototype._remove=function(a){for(var b=[],c=0;c<this._tiles.length;c++)c!==a&&b.push(this._tiles[c]);this._tiles=b};b.prototype._getNeighbor=function(a,b,c){var d=this.key;b=e.TileKey.getId(d.level,d.row+c,d.col+b,d.world);return a.has(b)?a.get(b):null};return b}();c.default=b})},"esri/views/2d/engine/webgl/collisions/CollisionBucketEntry":function(){define(["require","exports","../../../../../core/libs/gl-matrix-2/vec2"],function(b,c,e){Object.defineProperty(c,"__esModule",{value:!0});
b=function(){function b(){this._reference=null}Object.defineProperty(b.prototype,"dirty",{get:function(){return this.reference&&this.reference.isDirty},set:function(b){this.reference&&this.reference.hasData&&(b||this.reference.isDirty)&&(this.reference.isDirty=b)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"index",{get:function(){return this._reference&&this._reference.labelIndex},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"reference",{get:function(){return this._reference},
set:function(b){this._reference=b},enumerable:!0,configurable:!0});b.prototype.reset=function(b,a,c){b=b.state;var f=c.layerView.tileRenderer,d=this.reference;if(!d||!d.hasData)return!1;a&&(d.isDirty=!0);a=d.transforms.labelMat2d;for(var g=a[4],n=a[5],x=0,w=d.displayObjects;x<w.length;x++)for(var m=w[x],z=f.featuresView.attributeView,z=c.hasVV()?z.getVVSize(m.id):0,q=0,m=m.metrics;q<m.length;q++){var v=m[q];c.hasVV()&&v.computeVVOffset(z,c.vvEval);var p=v.bounds.center,r=v.bounds.centerT;d.isDirty&&
(v.minZoom=-1);var h=e.vec2.copy(r,v.anchor);b.rotation?e.vec2.transformMat2d(h,h,a):(r[0]=h[0]+g,r[1]=h[1]+n);e.vec2.add(r,h,p);r[0]+=v.offsetX;r[1]+=v.offsetY;if(v.boxes)for(p=0,r=v.boxes;p<r.length;p++){var h=r[p],y=h.centerT;e.vec2.add(y,v.anchor,h.center);b.rotation?e.vec2.transformMat2d(y,y,a):(y[0]+=g,y[1]+=n)}}return!0};return b}();c.default=b})},"esri/views/2d/engine/webgl/collisions/LayerCollisionInfo":function(){define("require exports ../../../../../core/Logger ../../../../../core/mathUtils ../../../../../core/screenUtils ./visualVariableSimpleUtils".split(" "),
function(b,c,e,g,f,a){function n(b){return function(d){return f.pt2px(a.getSizeForValueSimple(d,b))}}function k(a){if(!a)return null;for(var b=0;b<a.length;b++){var d=a[b];if("size"===d.type)return n(d)}return null}Object.defineProperty(c,"__esModule",{value:!0});var d=function(a,b){return a.order-b.order},l=function(a,b){return a.index-b.index},t=e.getLogger("esri/views/2d/engine/webgl/collisions/CollisionEngine");c.createLabelVVEvaluator=k;b=function(){function a(a,b,d,c){var e=this;this._vvHandle=
null;var f=a.layer,l=f.geometryType,h=f.labelingInfo,m=f.renderer;f.renderer&&(this.vvEval=k("visualVariables"in m&&m.visualVariables));this._vvHandle=f.watch("renderer",function(a){f.renderer&&(e.vvEval=k("visualVariables"in a&&a.visualVariables))});h=h.map(function(a){var b=!!a.maxScale,d=!!a.minScale&&c.scaleToZoom(a.minScale)||0;a=b&&c.scaleToZoom(a.maxScale)||255;return{minZoom:g.clamp(Math.floor(10*d),0,255),maxZoom:g.clamp(Math.floor(10*a),0,255)}});this.layerView=a;this.geometryType=l;this.index=
b;this.order=d;this.zoomRanges=h;this.layerView=a}a.prototype.hasVV=function(){return!!this.vvEval};a.prototype.allOrNothing=function(){return"polyline"!==this.geometryType};a.prototype.destroy=function(){this._vvHandle.remove()};a.create=function(b,c,e,f){e=e.sort(d);for(var g=!1,l=-1,m=0;m<e.length;m++){var h=e[m];!g&&h.order>c&&(l=h.index,g=!0);g&&h.index++}g||(l=e.length);return new a(b,l,c,f)};a.delete=function(a,b){for(var d=b.sort(l),c=a+1;c<d.length;c++)b[c].index--;b[a].destroy();b.splice(a,
1)};a.find=function(a,b){for(var d=0;d<b.length;d++){var c=b[d];if(c.index===a)return c}t.error("Tried to get a LayerCollisionInfo for an index that doesn't exist!");return null};return a}();c.default=b})},"esri/views/2d/engine/webgl/collisions/visualVariableSimpleUtils":function(){define(["require","exports","../../../../../core/mathUtils","../../../../../renderers/support/utils"],function(b,c,e,g){function f(b,c){switch(c.transformationType){case "additive":var d=a(c.minSize,b);return b+(d||c.minDataValue);
case "constant":return d=(d=c.stops)&&d.length&&d[0].size,null==d&&(d=c.minSize),a(d,b);case "clamped-linear":var d=(b-c.minDataValue)/(c.maxDataValue-c.minDataValue),f=a(c.minSize,b),l=a(c.maxSize,b);b=b<=c.minDataValue?f:b>=c.maxDataValue?l:f+d*(l-f);return b;case "proportional":return d=b/c.minDataValue,f=a(c.minSize,b),b=a(c.maxSize,b),e.clamp(d*f,f,b);case "stops":return f=n(b,c.cache.ipData),l=f[0],d=f[1],f=f[2],l===d?b=a(c.stops[l].size,b):(l=a(c.stops[l].size,b),b=a(c.stops[d].size,b),b=l+
(b-l)*f),b;case "real-world-size":d=g.meterIn[c.valueUnit];f=a(c.minSize,b);l=a(c.maxSize,b);c=c.valueRepresentation;var m=null,m="area"===c?2*Math.sqrt(b/k)/d:"radius"===c||"distance"===c?2*b/d:b/d;return e.clamp(m,f,l);case "identity":return b;case "unknown":return null}}function a(a,b){return"number"===typeof a?a:f(b,a)}function n(a,b){if(b){var d=0,c=b.length-1;b.some(function(b,e){if(a<b)return c=e,!0;d=e;return!1});return[d,c,(a-b[d])/(b[c]-b[d])]}}Object.defineProperty(c,"__esModule",{value:!0});
var k=Math.PI;c.getSizeForValueSimple=f})},"esri/views/2d/engine/webgl/collisions/LayerViewSorter":function(){define(["require","exports","../../../../../core/Error","../../../../../core/Logger"],function(b,c,e,g){function f(a){return"esri.views.2d.layers.FeatureLayerView2D"===a.declaredClass||"esri.views.2d.layers.StreamLayerView2D"===a.declaredClass}Object.defineProperty(c,"__esModule",{value:!0});var a=g.getLogger("esri.views.2d.engine.collisions.LayerViewSorter");b=function(){function b(a,b){this.registerLayer=
a;this.unregisterLayer=b;this._layerViewState=new Map}b.prototype.findIndex=function(a){return a.view.allLayerViews.findIndex(function(b){return b.uid===a.uid})};b.prototype.update=function(b){for(var d=b.added,c=0,g=b.removed;c<g.length;c++)b=g[c],f(b)&&this._layerViewState.has(b)&&this._deleteState(b);for(c=0;c<d.length;c++){b=d[c];if(g=f(b))a:if(b.layer&&b.layer.renderer)switch(b.layer.renderer.type){case "class-breaks":case "simple":case "unique-value":case "dictionary":case "dot-density":g=!0;
break a;default:a.error(new e("mapview-labeling","Renderer of type "+b.layer.renderer.type+" does not currently support labeling")),g=!1}else g=!1;g&&!this._layerViewState.has(b)&&this._createState(b)}this._recomputeOrder()};b.prototype.destroy=function(){this._layerViewState.forEach(function(a){return a.handle.remove()})};b.prototype._createState=function(a){var b={priority:-1,handle:null};b.handle=a.watch("labelsVisible",this._recomputeOrder.bind(this));this._layerViewState.set(a,b);return b};b.prototype._deleteState=
function(a){if(this._layerViewState.has(a)){var b=this._layerViewState.get(a);b.handle.remove();-1!==b.priority&&this.unregisterLayer(a);this._layerViewState.delete(a)}};b.prototype._recomputeOrder=function(){var a=this;this._layerViewState.forEach(function(b,c){var d=c.view.map.allLayers.findIndex(function(a){return a.uid===c.layer.uid}),e=c.layer,d=e.visible&&e.labelsVisible&&e.labelingInfo?4294967295-d:-1;d!==b.priority&&(b.priority=d,a.unregisterLayer(c),-1!==d&&a.registerLayer(c,d))})};return b}();
c.LayerViewSorter=b})},"esri/views/2d/engine/webgl/Geometry":function(){define(["require","exports"],function(b,c){Object.defineProperty(c,"__esModule",{value:!0});b=function(){function b(b,c){this.x=b;this.y=c}b.prototype.clone=function(){return new b(this.x,this.y)};b.prototype.equals=function(b,c){return b===this.x&&c===this.y};b.prototype.isEqual=function(b){return b.x===this.x&&b.y===this.y};b.prototype.setCoords=function(b,c){this.x=b;this.y=c};b.prototype.normalize=function(){var b=this.x,
c=this.y,b=Math.sqrt(b*b+c*c);this.x/=b;this.y/=b};b.prototype.rightPerpendicular=function(){var b=this.x;this.x=this.y;this.y=-b};b.prototype.move=function(b,c){this.x+=b;this.y+=c};b.prototype.assign=function(b){this.x=b.x;this.y=b.y};b.prototype.assignAdd=function(b,c){this.x=b.x+c.x;this.y=b.y+c.y};b.prototype.assignSub=function(b,c){this.x=b.x-c.x;this.y=b.y-c.y};b.prototype.rotate=function(b,c){var a=this.x,e=this.y;this.x=a*b-e*c;this.y=a*c+e*b};b.prototype.scale=function(b){this.x*=b;this.y*=
b};b.prototype.length=function(){var b=this.x,c=this.y;return Math.sqrt(b*b+c*c)};b.distance=function(b,c){var a=c.x-b.x;b=c.y-b.y;return Math.sqrt(a*a+b*b)};b.add=function(c,e){return new b(c.x+e.x,c.y+e.y)};b.sub=function(c,e){return new b(c.x-e.x,c.y-e.y)};return b}();c.Point=b})},"esri/views/2d/engine/webgl/alignmentUtils":function(){define(["require","exports"],function(b,c){Object.defineProperty(c,"__esModule",{value:!0});var e;(function(b){b[b.Left=-1]="Left";b[b.Center=0]="Center";b[b.Right=
1]="Right"})(e=c.HAlign||(c.HAlign={}));var g;(function(b){b[b.Top=1]="Top";b[b.Center=0]="Center";b[b.Bottom=-1]="Bottom";b[b.Baseline=2]="Baseline"})(g=c.VAlign||(c.VAlign={}));c.getXAnchorDirection=function(b){switch(b){case "left":return e.Left;case "right":return e.Right;case "center":case "justify":return e.Center}};c.getYAnchorDirection=function(b){switch(b){case "top":return g.Top;case "middle":return g.Center;case "baseline":return g.Baseline;case "bottom":return g.Bottom}};c.getAlignmentFromPlacement=
function(b){switch(b){case "above-left":return[e.Right,g.Bottom];case "above-center":case "above-along":return[e.Center,g.Bottom];case "above-right":return[e.Left,g.Bottom];case "center-left":return[e.Right,g.Center];case "center-center":case "center-along":return[e.Center,g.Center];case "center-right":return[e.Left,g.Center];case "below-left":return[e.Right,g.Top];case "below-center":case "below-along":return[e.Center,g.Top];case "below-right":return[e.Left,g.Top];case "always-horizontal":return[e.Center,
g.Baseline];default:return console.debug("Found invalid placement type "+b),[e.Center,g.Center]}};c.getXDirection=function(b){switch(b){case e.Right:return-1;case e.Center:return 0;case e.Left:return 1;default:return console.debug("Found invalid horizontal alignment "+b),0}};c.getYDirection=function(b){switch(b){case g.Top:return 1;case g.Center:return 0;case g.Bottom:case g.Baseline:return-1;default:return console.debug("Found invalid vertical alignment "+b),0}};c.getJustification=function(b){switch(b){case "left":return e.Left;
case "right":return e.Right;case "center":case "justify":return e.Center}}})},"esri/views/2d/engine/webgl/brushes/BrushBitmap":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../definitions ../VertexStream ./WGLBrush".split(" "),function(b,c,e,g,f,a){Object.defineProperty(c,"__esModule",{value:!0});var n={nearest:{defines:[],samplingMode:9728,mips:!1},bilinear:{defines:[],samplingMode:9729,mips:!1},bicubic:{defines:["bicubic"],samplingMode:9729,mips:!1},trilinear:{defines:[],
samplingMode:9987,mips:!0}};b=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b._desc={path:"raster/bitmap",attributes:{a_position:0,a_texcoord:1}};return b}e(b,a);b.prototype.dispose=function(){this._quad&&this._quad.dispose()};b.prototype.prepareState=function(a,b){a=a.context;a.setBlendingEnabled(!0);a.setBlendFunctionSeparate(1,771,1,771);a.setColorMask(!0,!0,!0,!0);a.setStencilWriteMask(0);a.setStencilTestEnabled(!0);a.setStencilFunction(514,b.stencilRef,255)};b.prototype.draw=
function(a,b){var d=a.context,c=a.renderingOptions,e=a.painter;if(b.source){a.timeline.begin(this.name);this._quad||(this._quad=new f(d,[0,0,1,0,0,1,1,1]));if("dynamic"===c.samplingMode)var c=a.state,l=b.resolution/b.pixelRatio/c.resolution,k=Math.round(a.pixelRatio)!==a.pixelRatio,c=c.rotation||1.05<l||.95>l||k||b.isSourceScaled||b.rotation?n.bilinear:n.nearest;else c=n[c.samplingMode];e=e.materialManager.getProgram(a,this._desc,c.defines);b.setSamplingProfile(c);b.bind(g.TEXTURE_BINDING_BITMAP);
d.bindProgram(e);e.setUniformMatrix3fv("u_dvsMat3",b.transforms.dvs);e.setUniform1i("u_texture",g.TEXTURE_BINDING_BITMAP);e.setUniform2fv("u_coordScale",b.coordScale);this._quad.draw();a.timeline.end(this.name)}};return b}(a.default);c.default=b})},"esri/views/2d/engine/webgl/brushes/BrushClip":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec4f32 ../Utils ./WGLBrush ../shaders/BackgroundPrograms ../../../../webgl/programUtils".split(" "),
function(b,c,e,g,f,a,n,k){Object.defineProperty(c,"__esModule",{value:!0});b=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b._color=g.vec4f32.fromValues(0,1,0,1);return b}e(b,a);b.prototype.dispose=function(){this._program&&this._program.dispose()};b.prototype.prepareState=function(a){a=a.context;a.setStencilTestEnabled(!0);a.setBlendingEnabled(!1);a.setFaceCullingEnabled(!1);a.setColorMask(!1,!1,!1,!1);a.setStencilOp(7680,7680,7681);a.setStencilWriteMask(255);a.setStencilFunction(519,
0,255)};b.prototype.draw=function(a,b){var d=a.context;a=a.state;this._program||(this._program=k.createProgram(d,n.background));var c=this._program,e=f.createProgramDescriptor("clip",{geometry:[{location:0,name:"a_pos",count:2,type:5122}]});b=b.getVAO(d,a,e.attributes,e.bufferLayouts);d.bindProgram(this._program);c.setUniform2fv("u_coord_range",[1,1]);c.setUniform4fv("u_color",this._color);c.setUniformMatrix3fv("u_dvsMat3",a.displayMat3);d.bindVAO(b);d.drawElements(4,b.indexBuffer.size,5125,0);d.bindVAO()};
return b}(a.default);c.default=b})},"esri/views/2d/engine/webgl/brushes/BrushRasterBitmap":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/tsSupport/assignHelper ../VertexStream ../WGLRasterUtils ./WGLBrush".split(" "),function(b,c,e,g,f,a,n){Object.defineProperty(c,"__esModule",{value:!0});b=function(b){function d(){var a=null!==b&&b.apply(this,arguments)||this;a._desc={lut:{path:"raster/lut",attributes:{a_position:0,a_texcoord:1}},stretch:{path:"raster/stretch",
attributes:{a_position:0,a_texcoord:1}}};return a}e(d,b);d.prototype.dispose=function(){this._quad&&this._quad.dispose()};d.prototype.prepareState=function(a,b){a=a.context;a.setBlendingEnabled(!0);a.setBlendFunctionSeparate(1,771,1,771);a.setColorMask(!0,!0,!0,!0);a.setStencilWriteMask(0);a.setStencilTestEnabled(!0);a.setStencilFunction(514,b.stencilRef,255)};d.prototype.draw=function(b,d){var c=b.context,e=b.painter;if(d.source&&!d.suspended){b.timeline.begin(this.name);this._quad||(this._quad=
new f(c,[0,0,1,0,0,1,1,1]));e=e.materialManager.getProgram(b,this._desc[d.symbolizerParameters.type]);c.bindProgram(e);var l=a.getUniformInfos(c,e),k=d.getTextures();a.setTextures(c,e,k.names,k.textures);k=d.getUniforms();d=g({u_opacity:d.opacity,u_coordScale:d.coordScale},k);d.u_flipY=!1;a.setUniforms(c,e,l,d);this._quad.draw();b.timeline.end(this.name)}};return d}(n.default);c.default=b})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLBackground":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/mat3f32 ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ../../vectorTiles/shaders/Programs ../definitions ../enums ../number ./WGLBrush".split(" "),
function(b,c,e,g,f,a,n,k,d,l,t){Object.defineProperty(c,"__esModule",{value:!0});b=function(b){function c(){var a=null!==b&&b.apply(this,arguments)||this;a._color=f.vec4f32.fromValues(1,0,0,1);a._patternMatrix=g.mat3f32.create();a._programOptions={id:!1,pattern:!1};return a}e(c,b);c.prototype.dispose=function(){this._program&&(this._program.dispose(),this._program=null);this._vao&&(this._vao.dispose(),this._vao=null)};c.prototype.drawMany=function(a,b){var c=a.context,e=a.styleLayerId;this._loadWGLResources(c);
var f=a.displayLevel,g=a.styleLayer,h=a.painter.getVectorTileProgramCach(),m=g.getPaintValue("background-color",f),u=g.getPaintValue("background-opacity",f),n=g.getPaintValue("background-pattern",f),t=void 0!==n,C=m[3]*u,w=a.spriteMosaic,z,x=(window.devicePixelRatio|1)>k.VTL_HIGH_RES_CUTOFF?2:1;a=a.drawPhase===d.WGLDrawPhase.HITTEST;var H=this._programOptions;H.id=a;H.pattern=t;h=h.getProgram(0,(a?1:0)<<1|(t?1:0),H);c.bindVAO(this._vao);c.bindProgram(h);if(t){z=w.getMosaicItemPosition(n,!0);if(!z)return;
h.setUniform1f("u_opacity",u);h.setUniform2f("u_pattern_tl",z.tl[0],z.tl[1]);h.setUniform2f("u_pattern_br",z.br[0],z.br[1]);h.setUniform1i("u_texture",k.VTL_TEXTURE_BINDING_UNIT_SPRITES);w.bind(c,9729,z.page,k.VTL_TEXTURE_BINDING_UNIT_SPRITES)}else this._color[0]=C*m[0],this._color[1]=C*m[1],this._color[2]=C*m[2],this._color[3]=C,h.setUniform4fv("u_color",this._color);h.setUniform1f("u_depth",g.z||0);a&&(e=l.u32to4Xu8(e),h.setUniform4f("u_id",e[0],e[1],e[2],e[3]));for(e=0;e<b.length;e++)g=b[e],h.setUniform1f("u_coord_range",
g.coordRange[0]),h.setUniformMatrix3fv("u_dvsMat3",g.transforms.dvs),t&&(m=x*g.size[0]*Math.max(Math.pow(2,Math.round(f)-g.key.level),1),u=m/z.size[1],this._patternMatrix[0]=m/z.size[0],this._patternMatrix[4]=u,h.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix)),c.setStencilFunction(514,g.stencilRef,255),c.drawArrays(5,0,4)};c.prototype._loadWGLResources=function(b){if(!this._program||!this._vao){var d=a.createProgram(b,n.background);if(d){var c=new Int8Array([0,0,1,0,0,1,1,1]),c=a.BufferObject.createVertex(b,
35044,c);b=new a.VertexArrayObject(b,n.background.attributes,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},{geometry:c});this._program=d;this._vao=b}}};return c}(t.default);c.WGLBrushVTLBackground=b})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLCircle":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ../enums ../number ./WGLBrush".split(" "),function(b,c,e,g,f,
a,n,k){Object.defineProperty(c,"__esModule",{value:!0});var d=[1,1,1,1];b=function(b){function c(){var a=null!==b&&b.apply(this,arguments)||this;a._color=g.vec4f32.create();a._strokeColor=g.vec4f32.create();a._programOptions={id:!1};a._vertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:4,stride:16,normalized:!0,divisor:0},{name:"a_stroke_color",count:4,type:5121,offset:8,stride:16,normalized:!0,divisor:0},
{name:"a_data",count:4,type:5121,offset:12,stride:16,normalized:!1,divisor:0}]};return a}e(c,b);c.prototype.dispose=function(){};c.prototype.drawMany=function(b,c){var e=b.context,f=b.state,g=b.drawPhase,l=b.styleLayerId,p=b.displayLevel,k=b.styleLayer;b=b.painter.getVectorTileProgramCach();var h=k.hasDataDrivenRadius?1:k.getPaintValue("circle-radius",p),y=k.hasDataDrivenColor?d:k.getPaintValue("circle-color",p),u=k.hasDataDrivenOpacity?1:k.getPaintValue("circle-opacity",p),t=k.hasDataDrivenStrokeWidth?
1:k.getPaintValue("circle-stroke-width",p),w=k.hasDataDrivenStrokeColor?d:k.getPaintValue("circle-stroke-color",p),C=k.hasDataDrivenStrokeOpacity?1:k.getPaintValue("circle-stroke-opacity",p),A=k.hasDataDrivenBlur?0:k.getPaintValue("circle-blur",p),u=u*y[3];this._color[0]=u*y[0];this._color[1]=u*y[1];this._color[2]=u*y[2];this._color[3]=u;u=C*w[3];this._strokeColor[0]=u*w[0];this._strokeColor[1]=u*w[1];this._strokeColor[2]=u*w[2];this._strokeColor[3]=u;y=k.getPaintValue("circle-translate",p);p=k.getPaintValue("circle-translate-anchor",
p);w=g===a.WGLDrawPhase.HITTEST;g=this._programOptions;g.id=w;g=b.getProgram(5,w?1:0,g);e.bindProgram(g);g.setUniformMatrix3fv("u_displayMat3",1===p?f.displayMat3:f.displayViewMat3);g.setUniform2fv("u_circleTranslation",y);g.setUniform1f("u_depth",k.z);g.setUniform1f("u_radius",h);g.setUniform4fv("u_color",this._color);g.setUniform1f("u_blur",A);g.setUniform1f("u_stroke_width",t);g.setUniform4fv("u_stroke_color",this._strokeColor);g.setUniform1f("u_antialiasingWidth",1.2);w&&(f=n.u32to4Xu8(l),g.setUniform4f("u_id",
f[0],f[1],f[2],f[3]));for(f=0;f<c.length;f++)if(k=c[f],k.layerData[l]&&(h=k.layerData[l],t=this._getCircleVAO(e,k,b)))e.bindVAO(t),g.setUniformMatrix3fv("u_dvsMat3",k.transforms.dvs),e.setStencilFunction(514,k.stencilRef,255),e.drawElements(4,h.triangleElementCount,5125,12*h.triangleElementStart),k.triangleCount+=h.triangleElementCount/3};c.prototype._getCircleVAO=function(a,b,d){if(b.circleVertexArrayObject)return b.circleVertexArrayObject;var c=b.circleVertexBuffer,e=b.circleIndexBuffer;if(!c||
!e)return null;b.circleVertexArrayObject=new f.VertexArrayObject(a,d.getProgramAttributes(5),this._vertexAttributes,{geometry:c},e);return b.circleVertexArrayObject};return c}(k.default);c.WGLBrushVTLCircle=b})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLFill":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/mat3f32 ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ../definitions ../enums ../number ./WGLBrush".split(" "),
function(b,c,e,g,f,a,n,k,d,l){Object.defineProperty(c,"__esModule",{value:!0});var t=1/65536,x=[1,1,1,1];b=function(b){function c(){var a=null!==b&&b.apply(this,arguments)||this;a._fillVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:4,normalized:!1,divisor:0}]};a._fillVertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:8,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:4,stride:8,normalized:!0,divisor:0}]};a._outlineVertexAttributes=
{geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:8,normalized:!1,divisor:0},{name:"a_offset",count:2,type:5120,offset:4,stride:8,normalized:!1,divisor:0},{name:"a_xnormal",count:2,type:5120,offset:6,stride:8,normalized:!1,divisor:0}]};a._outlineVertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:12,normalized:!1,divisor:0},{name:"a_offset",count:2,type:5120,offset:4,stride:12,normalized:!1,divisor:0},{name:"a_xnormal",count:2,type:5120,offset:6,stride:12,normalized:!1,
divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:12,normalized:!0,divisor:0}]};a._color=f.vec4f32.create();a._outlineColor=f.vec4f32.create();a._fillProgramOptions={id:!1,dd:!1,pattern:!1};a._outlineProgramOptions={id:!1,dd:!1};a._patternMatrix=g.mat3f32.create();return a}e(c,b);c.prototype.dispose=function(){};c.prototype.drawMany=function(a,b){var c=a.displayLevel,e=a.drawPhase,f=a.renderPass,h=a.styleLayerId,g=a.styleLayer,l=g.getPaintValue("fill-pattern",c),m=g.hasDataDrivenColor?
x:g.getPaintValue("fill-color",c),q=g.hasDataDrivenOpacity?1:g.getPaintValue("fill-opacity",c),n=q*m[3],t=void 0!==l||1>n||g.hasDataDrivenFill;if(!t||"opaque"!==f){this._color[0]=n*m[0];this._color[1]=n*m[1];this._color[2]=n*m[2];this._color[3]=n;var w;e===k.WGLDrawPhase.HITTEST&&(w=d.u32to4Xu8(h));e=g.getPaintValue("fill-translate",c);c=g.getPaintValue("fill-translate-anchor",c);this._drawFill(a,h,g,b,e,c,l,t,w);this._drawOutline(a,h,g,b,e,c,l,w,q)}};c.prototype._drawFill=function(a,b,d,c,e,f,g,
l,m){var h=a.context,p=a.displayLevel,u=a.drawPhase,r=a.renderPass,q=a.spriteMosaic,v=a.state;if(l||"translucent"!==r){l=void 0!==g;var r=a.pixelRatio>n.VTL_HIGH_RES_CUTOFF?2:1,y=d.hasDataDrivenFill;a=a.painter.getVectorTileProgramCach();var w,z=u===k.WGLDrawPhase.HITTEST,u=this._fillProgramOptions;u.id=z;u.dd=y;u.pattern=l;u=a.getProgram(1,(z?1:0)<<2|(y?1:0)<<1|(l?1:0),u);h.bindProgram(u);if(l){w=q.getMosaicItemPosition(g,!0);if(!w){h.bindProgram();return}u.setUniform2f("u_pattern_tl",w.tl[0],w.tl[1]);
u.setUniform2f("u_pattern_br",w.br[0],w.br[1]);u.setUniform1i("u_texture",n.VTL_TEXTURE_BINDING_UNIT_SPRITES);q.bind(h,9729,w.page,n.VTL_TEXTURE_BINDING_UNIT_SPRITES)}u.setUniformMatrix3fv("u_displayMat3",1===f?v.displayMat3:v.displayViewMat3);u.setUniform2fv("u_fillTranslation",e);u.setUniform1f("u_depth",d.z+t);u.setUniform4fv("u_color",this._color);z&&u.setUniform4f("u_id",m[0],m[1],m[2],m[3]);for(d=0;d<c.length;d++)if(e=c[d],e.layerData[b]&&(g=this._getFillVAO(h,e,y,a)))f=e.layerData[b],h.bindVAO(g),
u.setUniformMatrix3fv("u_dvsMat3",e.transforms.dvs),l&&(g=e.coordRange[0]/(r*e.size[0]*Math.max(Math.pow(2,Math.round(p)-e.key.level),1)),m=1/(w.size[1]*g),this._patternMatrix[0]=1/(w.size[0]*g),this._patternMatrix[4]=m,u.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix)),h.setStencilFunction(514,e.stencilRef,255),h.drawElements(4,f.triangleElementCount,5125,12*f.triangleElementStart),e.triangleCount+=f.triangleElementCount/3}};c.prototype._drawOutline=function(a,b,d,c,e,f,g,l,m){var h=
a.context,p=a.displayLevel,u=a.drawPhase,r=a.pixelRatio,q=a.state;if("opaque"!==a.renderPass&&(g=void 0!==g,d.getPaintValue("fill-antialias",p)&&!g||d.hasDataDrivenOutlineColor)){a=a.painter.getVectorTileProgramCach();g=d.hasDataDrivenOutline;if(d.outlineUsesFillColor){if(1!==this._color[3])return;this._outlineColor[0]=this._color[0];this._outlineColor[1]=this._color[1];this._outlineColor[2]=this._color[2];this._outlineColor[3]=this._color[3]}else p=d.hasDataDrivenOutlineColor?x:d.getPaintValue("fill-outline-color",
p),m*=p[3],this._outlineColor[0]=m*p[0],this._outlineColor[1]=m*p[1],this._outlineColor[2]=m*p[2],this._outlineColor[3]=m;r=.75/r;m=u===k.WGLDrawPhase.HITTEST;u=this._outlineProgramOptions;u.id=m;u.dd=g;u=a.getProgram(2,(m?1:0)<<1|(g?1:0),u);h.bindProgram(u);u.setUniformMatrix3fv("u_displayMat3",1===f?q.displayMat3:q.displayViewMat3);u.setUniform2fv("u_fillTranslation",e);u.setUniform1f("u_depth",d.z+t);u.setUniform1f("u_outline_width",r);u.setUniform4fv("u_color",this._outlineColor);m&&u.setUniform4f("u_id",
l[0],l[1],l[2],l[3]);for(d=0;d<c.length;d++)if(e=c[d],e.layerData[b]&&(f=e.layerData[b],l=this._getOutlineVAO(h,e,g,a)))h.bindVAO(l),u.setUniformMatrix3fv("u_dvsMat3",e.transforms.dvs),h.setStencilFunction(514,e.stencilRef,255),h.drawElements(4,f.outlineElementCount,5125,12*f.outlineElementStart),e.triangleCount+=f.outlineElementCount/3}};c.prototype._getFillVAO=function(b,d,c,e){if(c){if(d.fillDDVertexArrayObject)return d.fillDDVertexArrayObject;c=d.fillDDVertexBuffer;var f=d.fillIndexBuffer;if(!c||
!f)return null;d.fillDDVertexArrayObject=new a.VertexArrayObject(b,e.getProgramAttributes(1),this._fillVertexAttributesDD,{geometry:c},f);return d.fillDDVertexArrayObject}if(d.fillVertexArrayObject)return d.fillVertexArrayObject;c=d.fillVertexBuffer;f=d.fillIndexBuffer;if(!c||!f)return null;d.fillVertexArrayObject=new a.VertexArrayObject(b,e.getProgramAttributes(1),this._fillVertexAttributes,{geometry:c},f);return d.fillVertexArrayObject};c.prototype._getOutlineVAO=function(b,d,c,e){if(c){if(d.outlineDDVertexArrayObject)return d.outlineDDVertexArrayObject;
c=d.outlineDDVertexBuffer;var f=d.outlineIndexBuffer;if(!c||!f)return null;d.outlineDDVertexArrayObject=new a.VertexArrayObject(b,e.getProgramAttributes(2),this._outlineVertexAttributesDD,{geometry:c},f);return d.outlineDDVertexArrayObject}if(d.outlineVertexArrayObject)return d.outlineVertexArrayObject;c=d.outlineVertexBuffer;f=d.outlineIndexBuffer;if(!c||!f)return null;d.outlineVertexArrayObject=new a.VertexArrayObject(b,e.getProgramAttributes(2),this._outlineVertexAttributes,{geometry:c},f);return d.outlineVertexArrayObject};
return c}(l.default);c.WGLBrushVTLFill=b})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLLine":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec2f32 ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ../definitions ../enums ../number ./WGLBrush".split(" "),function(b,c,e,g,f,a,n,k,d,l){Object.defineProperty(c,"__esModule",{value:!0});c.C_DEG_TO_RAD=Math.PI/180;var t=[1,1,1,1];b=function(b){function c(){var a=null!==
b&&b.apply(this,arguments)||this;a._color=f.vec4f32.create();a._dashArray=g.vec2f32.create();a._programOptions={id:!1,dd:!1,pattern:!1};a._vertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:12,normalized:!1,divisor:0},{name:"a_offsetAndNormal",count:4,type:5120,offset:4,stride:12,normalized:!1,divisor:0},{name:"a_accumulatedDistance",count:2,type:5123,offset:8,stride:12,normalized:!1,divisor:0}]};a._vertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:20,
normalized:!1,divisor:0},{name:"a_offsetAndNormal",count:4,type:5120,offset:4,stride:20,normalized:!1,divisor:0},{name:"a_accumulatedDistance",count:2,type:5122,offset:8,stride:20,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:12,stride:20,normalized:!0,divisor:0},{name:"a_width",count:1,type:5126,offset:16,stride:20,normalized:!1,divisor:0}]};return a}e(c,b);c.prototype.dispose=function(){};c.prototype.drawMany=function(a,b){var c=a.context,e=a.displayLevel,f=a.state,g=a.drawPhase,
h=a.styleLayerId,l=a.styleLayer,u=a.painter.getVectorTileProgramCach(),m=l.getPaintValue("line-translate",e),w=l.getPaintValue("line-translate-anchor",e),C=l.getPaintValue("line-pattern",e),z=void 0!==C,x=1/a.pixelRatio,E=l.getPaintValue("line-blur",e),H=l.hasDataDrivenColor?t:l.getPaintValue("line-color",e),F=l.hasDataDrivenOpacity?1:l.getPaintValue("line-opacity",e),L=l.hasDataDrivenWidth?1:l.getPaintValue("line-width",e),F=F*H[3];this._color[0]=F*H[0];this._color[1]=F*H[1];this._color[2]=F*H[2];
this._color[3]=F;var H=l.hasDataDrivenLine,F=g===k.WGLDrawPhase.HITTEST,J;F&&(J=d.u32to4Xu8(h));g=this._programOptions;g.id=F;g.dd=H;g.pattern=z;g=u.getProgram(3,(F?1:0)<<2|(H?1:0)<<1|(z?1:0),g);c.bindProgram(g);g.setUniformMatrix3fv("u_displayViewMat3",f.displayViewMat3);g.setUniformMatrix3fv("u_displayMat3",1===w?f.displayMat3:f.displayViewMat3);g.setUniform2fv("u_lineTranslation",m);g.setUniform1f("u_depth",l.z);g.setUniform1f("u_blur",E);g.setUniform1f("u_antialiasing",x);g.setUniform4fv("u_color",
this._color);g.setUniform1f("u_width",L);F&&g.setUniform4f("u_id",J[0],J[1],J[2],J[3]);if(z){if(a=a.spriteMosaic,C=a.getMosaicItemPosition(C,!0))a.bind(c,9729,C.page,n.VTL_TEXTURE_BINDING_UNIT_SPRITES),g.setUniform2f("u_pattern_tl",C.tl[0],C.br[1]),g.setUniform2f("u_pattern_br",C.br[0],C.tl[1]),g.setUniform2f("u_spriteSize",8*C.size[0],C.size[1]),g.setUniform1i("u_texture",n.VTL_TEXTURE_BINDING_UNIT_SPRITES)}else C=l.getPaintValue("line-dasharray",e),2>C.length&&(C=[1,-1]),this._dashArray[0]=8*C[0],
this._dashArray[1]=8*C[1],g.setUniform2fv("u_dasharray",this._dashArray);for(C=0;C<b.length;C++)if(a=b[C],a.layerData[h]&&(e=a.layerData[h],f=this._getLineVAO(c,a,H,u)))c.bindVAO(f),g.setUniformMatrix3fv("u_dvsMat3",a.transforms.dvs),c.setStencilFunction(514,a.stencilRef,255),c.drawElements(4,e.triangleElementCount,5125,12*e.triangleElementStart),a.triangleCount+=e.triangleElementCount/3};c.prototype._getLineVAO=function(b,d,c,e){if(c){if(d.lineDDVertexArrayObject)return d.lineDDVertexArrayObject;
c=d.lineDDVertexBuffer;var f=d.lineIndexBuffer;if(!c||!f)return null;d.lineDDVertexArrayObject=new a.VertexArrayObject(b,e.getProgramAttributes(3),this._vertexAttributesDD,{geometry:c},f);return d.lineDDVertexArrayObject}if(d.lineVertexArrayObject)return d.lineVertexArrayObject;c=d.lineVertexBuffer;f=d.lineIndexBuffer;if(!c||!f)return null;d.lineVertexArrayObject=new a.VertexArrayObject(b,e.getProgramAttributes(3),this._vertexAttributes,{geometry:c},f);return d.lineVertexArrayObject};return c}(l.default);
c.WGLBrushVTLLine=b})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLSymbol":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec2f32 ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ../definitions ../enums ../GeometryUtils ../number ./WGLBrush".split(" "),function(b,c,e,g,f,a,n,k,d,l,t){Object.defineProperty(c,"__esModule",{value:!0});var x=1/65536,w=[1,1,1,1];b=function(b){function c(){var a=null!==b&&b.apply(this,
arguments)||this;a._vertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:4,stride:16,normalized:!1,divisor:0},{name:"a_tex",count:4,type:5121,offset:8,stride:16,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:16,normalized:!1,divisor:0}]};a._vertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:24,normalized:!1,divisor:0},{name:"a_vertexOffset",
count:2,type:5122,offset:4,stride:24,normalized:!1,divisor:0},{name:"a_tex",count:4,type:5121,offset:8,stride:24,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:24,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:16,stride:24,normalized:!0,divisor:0},{name:"a_size",count:1,type:5126,offset:20,stride:24,normalized:!1,divisor:0}]};a._iconProgramOptions={id:!1,dd:!1,sdf:!1};a._sdfProgramOptions={id:!1,dd:!1};a._spritesTextureSize=g.vec2f32.create();a._haloColor=
f.vec4f32.create();a._sdfColor=f.vec4f32.create();a._color=f.vec4f32.create();return a}e(c,b);c.prototype.dispose=function(){};c.prototype.drawMany=function(a,b){var d=a.drawPhase,c=a.styleLayerId,e=a.styleLayer,f=a.fadeRecorder.getFadeValues(),g;d===k.WGLDrawPhase.HITTEST&&(g=l.u32to4Xu8(c));this._drawIcons(a,e,b,f,g);this._drawText(a,e,b,f,g)};c.prototype._drawIcons=function(a,b,c,e,f){for(var h=this,g=a.context,l=a.displayLevel,p=a.drawPhase,m=a.painter,r=a.state,q=a.styleLayerId,v,t=!1,x=0;x<
c.length;x++){var z=c[x];if(z.layerData[q]&&(v=z.layerData[q],0<v.iconPerPageElementsMap.size)){t=!0;break}}if(t){var z=b.hasDataDrivenIconSize?1:b.getLayoutValue("icon-size",l),J=b.hasDataDrivenIconColor?w:b.getPaintValue("icon-color",l),G=b.hasDataDrivenIconOpacity?1:b.getPaintValue("icon-opacity",l),t=b.getPaintValue("icon-translate",l),x=b.getPaintValue("icon-translate-anchor",l),N=m.getVectorTileProgramCach(),m=J[3]*G;this._color[0]=m*J[0];this._color[1]=m*J[1];this._color[2]=m*J[2];this._color[3]=
m;m=b.getLayoutValue("icon-rotation-alignment",l);2===m&&(m=1===b.getLayoutValue("symbol-placement",l)?0:1);var J=v.isSDF,M=b.hasDataDrivenIcon,p=p===k.WGLDrawPhase.HITTEST,G=this._iconProgramOptions;G.id=p;G.dd=M;G.sdf=J;var K=N.getProgram(4,(p?1:0)<<2|(M?1:0)<<1|(J?1:0),G);g.bindProgram(K);J&&(J=b.getPaintValue("icon-halo-color",l),G=b.getPaintValue("icon-halo-width",l),K.setUniform4f("u_outlineColor",J[0],J[1],J[2],J[3]),K.setUniform1f("u_outlineSize",G));K.setUniformMatrix3fv("u_displayViewMat3",
0===m?r.displayViewMat3:r.displayMat3);K.setUniformMatrix3fv("u_displayMat3",1===x?r.displayMat3:r.displayViewMat3);K.setUniform2fv("u_iconTranslation",t);K.setUniform1f("u_depth",b.z);K.setUniform1f("u_mapRotation",d.degToByte(r.rotation));K.setUniform1f("u_keepUpright",0);K.setUniform1f("u_level",10*l);K.setUniform1f("u_fadeSpeed",10*e.fadeSpeed);K.setUniform1f("u_minfadeLevel",10*e.minfadeLevel);K.setUniform1f("u_maxfadeLevel",10*e.maxfadeLevel);K.setUniform1f("u_fadeChange",10*(l+e.fadeChange));
K.setUniform1i("u_texture",n.VTL_TEXTURE_BINDING_UNIT_SPRITES);K.setUniform1f("u_size",z);K.setUniform4fv("u_color",this._color);p&&K.setUniform4fv("u_id",f);b=function(b){if(!b.layerData[q])return"continue";v=b.layerData[q];if(0===v.iconPerPageElementsMap.size)return"continue";var d=O._getIconVAO(g,b,M,N);if(!d)return"continue";g.bindVAO(d);K.setUniformMatrix3fv("u_dvsMat3",b.transforms.dvs);v.iconPerPageElementsMap.forEach(function(d,c){h._renderIconRange(a,K,d,c,b)})};var O=this;for(e=0;e<c.length;e++)z=
c[e],b(z)}};c.prototype._renderIconRange=function(a,b,d,c,e){var f=a.context,h=a.hasClipping,g=a.requiredLevel;a=a.spriteMosaic;this._spritesTextureSize[0]=a.getWidth(c)/4;this._spritesTextureSize[1]=a.getHeight(c)/4;b.setUniform2fv("u_mosaicSize",this._spritesTextureSize);a.bind(f,9729,c,n.VTL_TEXTURE_BINDING_UNIT_SPRITES);b=!0;g!==e.key.level||h?f.setStencilFunction(514,e.stencilRef,255):b=!1;f.setStencilTestEnabled(b);f.drawElements(4,d[1],5125,12*d[0]);e.triangleCount+=d[1]/3};c.prototype._drawText=
function(a,b,c,e,f){for(var h=this,l=a.context,p=a.displayLevel,m=a.drawPhase,r=a.glyphMosaic,q=a.hasClipping,v=a.painter,t=a.pixelRatio,z=a.requiredLevel,F=a.state,L=a.styleLayerId,J,G=!1,N=0;N<c.length;N++)if(a=c[N],a.layerData[L]&&(J=a.layerData[L],0<J.glyphPerPageElementsMap.size)){G=!0;break}if(G){a=b.getLayoutValue("text-rotation-alignment",p);2===a&&(a=1===b.getLayoutValue("symbol-placement",p)?0:1);var G=0===a,G=b.getLayoutValue("text-keep-upright",p)&&G,m=m===k.WGLDrawPhase.HITTEST,t=.8*
3/t,N=b.hasDataDrivenTextSize?1:b.getLayoutValue("text-size",p),M=b.hasDataDrivenTextColor?w:b.getPaintValue("text-color",p),K=b.hasDataDrivenTextOpacity?1:b.getPaintValue("text-opacity",p),O=b.getPaintValue("text-halo-color",p),Q=b.getPaintValue("text-halo-width",p),U=3*b.getPaintValue("text-halo-blur",p),S=3*Q,T=v.getVectorTileProgramCach(),v=M[3]*K;this._sdfColor[0]=v*M[0];this._sdfColor[1]=v*M[1];this._sdfColor[2]=v*M[2];this._sdfColor[3]=v;v=O[3]*K;this._haloColor[0]=v*O[0];this._haloColor[1]=
v*O[1];this._haloColor[2]=v*O[2];this._haloColor[3]=v;this._glyphTextureSize||(this._glyphTextureSize=g.vec2f32.fromValues(r.width/4,r.height/4));var v=b.getPaintValue("text-translate",p),M=b.getPaintValue("text-translate-anchor",p),R=b.hasDataDrivenText,K=this._sdfProgramOptions;K.id=m;K.dd=R;var P=T.getProgram(6,(m?1:0)<<1|(R?1:0),K);l.bindProgram(P);P.setUniformMatrix3fv("u_displayViewMat3",0===a?F.displayViewMat3:F.displayMat3);P.setUniformMatrix3fv("u_displayMat3",1===M?F.displayMat3:F.displayViewMat3);
P.setUniform2fv("u_textTranslation",v);P.setUniform1f("u_depth",b.z+x);P.setUniform2fv("u_mosaicSize",this._glyphTextureSize);P.setUniform1f("u_mapRotation",d.degToByte(F.rotation));P.setUniform1f("u_keepUpright",G?1:0);P.setUniform1f("u_level",10*p);P.setUniform1f("u_fadeSpeed",10*e.fadeSpeed);P.setUniform1f("u_minfadeLevel",10*e.minfadeLevel);P.setUniform1f("u_maxfadeLevel",10*e.maxfadeLevel);P.setUniform1f("u_fadeChange",10*(p+e.fadeChange));P.setUniform1i("u_texture",n.VTL_TEXTURE_BINDING_UNIT_GLYPHS);
P.setUniform1f("u_size",N);P.setUniform1f("u_antialiasingWidth",t);m&&P.setUniform4f("u_id",f[0],f[1],f[2],f[3]);b=function(a){if(!a.layerData[L])return"continue";J=a.layerData[L];if(0===J.glyphPerPageElementsMap.size)return"continue";var b=V._getSDFVAO(l,a,R,T);if(!b)return"continue";l.bindVAO(b);P.setUniformMatrix3fv("u_dvsMat3",a.transforms.dvs);b=!0;z!==a.key.level||q?l.setStencilFunction(514,a.stencilRef,255):b=!1;l.setStencilTestEnabled(b);J.glyphPerPageElementsMap.forEach(function(b,c){h._renderGlyphRange(l,
b,c,r,P,O[3],Q,U,S,a)})};var V=this;for(e=0;e<c.length;e++)a=c[e],b(a)}};c.prototype._renderGlyphRange=function(a,b,c,d,e,f,g,l,m,k){d.bind(a,9729,c,n.VTL_TEXTURE_BINDING_UNIT_GLYPHS);0<f&&0<g&&(e.setUniform4fv("u_color",this._haloColor),e.setUniform1f("u_halo",1),e.setUniform1f("u_edgeDistance",m),e.setUniform1f("u_edgeBlur",l),a.drawElements(4,b[1],5125,12*b[0]),k.triangleCount+=b[1]/3);0<this._sdfColor[3]&&(e.setUniform4fv("u_color",this._sdfColor),e.setUniform1f("u_halo",0),e.setUniform1f("u_edgeDistance",
0),e.setUniform1f("u_edgeBlur",0),a.drawElements(4,b[1],5125,12*b[0]),k.triangleCount+=b[1]/3)};c.prototype._getIconVAO=function(b,c,d,e){if(d){if(c.iconDDVertexArrayObject)return c.iconDDVertexArrayObject;d=c.iconDDVertexBuffer;var f=c.iconIndexBuffer;if(!d||!f)return null;c.iconDDVertexArrayObject=new a.VertexArrayObject(b,e.getProgramAttributes(4),this._vertexAttributesDD,{geometry:d},f);return c.iconDDVertexArrayObject}if(c.iconVertexArrayObject)return c.iconVertexArrayObject;d=c.iconVertexBuffer;
f=c.iconIndexBuffer;if(!d||!f)return null;c.iconVertexArrayObject=new a.VertexArrayObject(b,e.getProgramAttributes(4),this._vertexAttributes,{geometry:d},f);return c.iconVertexArrayObject};c.prototype._getSDFVAO=function(b,c,d,e){if(d){if(c.textDDVertexArrayObject)return c.textDDVertexArrayObject;d=c.textDDVertexBuffer;var f=c.textIndexBuffer;if(!d||!f)return null;c.textDDVertexArrayObject=new a.VertexArrayObject(b,e.getProgramAttributes(6),this._vertexAttributesDD,{geometry:d},f);return c.textDDVertexArrayObject}if(c.textVertexArrayObject)return c.textVertexArrayObject;
d=c.textVertexBuffer;f=c.textIndexBuffer;if(!d||!f)return null;c.textVertexArrayObject=new a.VertexArrayObject(b,e.getProgramAttributes(6),this._vertexAttributes,{geometry:d},f);return c.textVertexArrayObject};return c}(t.default);c.WGLBrushVTLSymbol=b})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrush":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../webgl ../definitions ./WGLBrush".split(" "),function(b,c,e,g,f,a){Object.defineProperty(c,"__esModule",
{value:!0});b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}e(b,a);b.prototype.prepareState=function(a,b,c){a=a.context;c=c&&-1!==c.indexOf("id");a.setBlendingEnabled(!c);a.setBlendFunctionSeparate(1,771,1,771);a.setColorMask(!0,!0,!0,!0);a.setStencilWriteMask(0);a.setStencilTestEnabled(!0);a.setStencilFunction(514,b.stencilRef,255)};b.prototype.draw=function(a,b,c){var d=this;if(b.isReady&&b.hasData){b.commitChanges();var e=this.getGeometryType(),f=b.getDisplayList(),g=
b.getGeometry(e);g&&f&&(a.timeline.begin(this.name),f.byType(e,function(e){d.drawGeometry(a,b,e,g,c)}),a.timeline.end(this.name))}};b.prototype._getVAO=function(a,b,c,e){e.vao||(e.vao=new g.VertexArrayObject(a,c,b,e.vertexBufferMap,e.indexBuffer));return e.vao};b.prototype._setSharedUniforms=function(a,b,c){a.setUniform1f("u_pixelRatio",b.pixelRatio);a.setUniformMatrix3fv("u_dvsMat3",c.transforms.dvs);a.setUniformMatrix3fv("u_displayViewMat3",b.state.displayViewMat3);a.setUniformMatrix4fv("u_insideEffectMat4",
b.rendererInfo.insideEffect);a.setUniformMatrix4fv("u_outsideEffectMat4",b.rendererInfo.outsideEffect);a.setUniform1fv("u_insideOpacities",b.rendererInfo.insideOpacities);a.setUniform1fv("u_outsideOpacities",b.rendererInfo.outsideOpacities);a.setUniform1i("u_attributeTextureSize",b.attributeView.size);a.setUniform1i("u_attributeData0",f.TEXTURE_BINDING_ATTRIBUTE_DATA_0);a.setUniform1i("u_attributeData1",f.TEXTURE_BINDING_ATTRIBUTE_DATA_1);a.setUniform1i("u_attributeData2",f.TEXTURE_BINDING_ATTRIBUTE_DATA_2);
a.setUniform1i("u_attributeData3",f.TEXTURE_BINDING_ATTRIBUTE_DATA_3)};return b}(a.default);c.default=b})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushFill":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/tsSupport/assignHelper ../../../../../core/RandomLCG ../../../../webgl ../definitions ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),function(b,c,e,g,f,a,n,k,d,l,t){Object.defineProperty(c,"__esModule",{value:!0});
b=function(b){function c(){var a=null!==b&&b.apply(this,arguments)||this;a._dotTextureSize=0;a._dotTextures=null;a._dotSamplers=new Int32Array([n.TEXTURE_BINDING_RENDERER_0,n.TEXTURE_BINDING_RENDERER_1]);return a}e(c,b);c.prototype.dispose=function(){this._disposeTextures()};c.prototype.getGeometryType=function(){return k.WGLGeometryType.FILL};c.prototype.drawGeometry=function(a,b,c,e,f){var g=a.context,h=a.painter,l=a.rendererInfo,u=a.requiredLevel,p=c.indexCount,m=c.indexFrom;c=t.FillMaterialKey.load(c.materialKey);
var k=d.createProgramDescriptor(c.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121}].concat(c.dotDensity?[]:[{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_tlbr",count:4,type:5123},{location:4,name:"a_aux1",count:4,type:5121},{location:5,name:"a_aux2",count:2,type:5123},{location:6,name:"a_aux3",count:4,type:5121}],c.dotDensity?[{location:2,name:"a_inverseArea",count:1,type:5126}]:[])}),q=k.bufferLayouts,k=k.attributes;
f=h.materialManager.getMaterialProgram(a,c,"materials/fill",k,f);e=this._getVAO(g,q,k,e);g.bindProgram(f);g.bindVAO(e);this._setSharedUniforms(f,a,b);c.textureBinding&&(h.textureManager.bindTextures(g,f,c),h=1/Math.pow(2,u-b.key.level)/a.pixelRatio,f.setUniform1f("u_zoomFactor",h));c.vvColor&&(f.setUniform1fv("u_vvColorValues",l.vvColorValues),f.setUniform4fv("u_vvColors",l.vvColors));c.vvOpacity&&(f.setUniform1fv("u_vvOpacityValues",l.vvOpacityValues),f.setUniform1fv("u_vvOpacities",l.vvOpacities));
c.dotDensity&&(c=n.TILE_SIZE/l.ddDotSize,e=c*window.devicePixelRatio*c*window.devicePixelRatio,h=1/Math.pow(2,u-b.key.level),b=1/h*(1/h),a=l.ddDotScale?a.state.scale/l.ddDotScale:1,f.setUniform1f("u_tileZoomFactor",h),f.setUniform1f("u_tileDotsOverArea",e/(n.TILE_SIZE*window.devicePixelRatio*n.TILE_SIZE*window.devicePixelRatio)),f.setUniformMatrix4fv("u_dotColors",l.ddColors),f.setUniform4fv("u_isActive",l.ddActiveDots),f.setUniform4fv("u_dotBackgroundColor",l.ddBackgroundColor),f.setUniform1f("u_dotValue",
Math.max(1,l.ddDotValue*a*b)),this._bindDotDensityTextures(g,f,l,c));g.drawElements(4,p,5125,4*m);g.bindVAO(null)};c.prototype._disposeTextures=function(){if(this._dotTextures){for(var a=0;a<this._dotTextures.length;a++)this._dotTextures[a].dispose();this._dotTextures=null}};c.prototype._bindDotDensityTextures=function(a,b,c,d){c=this._createDotDensityTextures(a,d,c.ddSeed);b.setUniform1iv("u_dotTextures",this._dotSamplers);for(b=0;b<c.length;b++)a.bindTexture(c[b],this._dotSamplers[b])};c.prototype._createDotDensityTextures=
function(a,b,c){if(this._dotTextureSize!==b||this._seed!==c)this._disposeTextures(),this._dotTextureSize=b,this._seed=c;null===this._dotTextures&&(c=new f(c),this._dotTextures=[this._allocDotDensityTexture(a,b,c),this._allocDotDensityTexture(a,b,c)]);return this._dotTextures};c.prototype._allocDotDensityTexture=function(b,c,d){for(var e=new Float32Array(c*c*4),f=0;f<e.length;f++)e[f]=d.getFloat();return new a.Texture(b,{wrapMode:10497,pixelFormat:6408,dataType:5126,samplingMode:9728,width:c,height:c},
e)};return c}(l.default);c.default=b})},"esri/views/2d/engine/webgl/materialKey/MaterialKey":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/tsSupport/assignHelper ../../../../../renderers ../../../../../core/Error ../../../../../core/maybe ../enums ../mesh/templates/WGLLabelTemplate ../util/vvFlagUtils".split(" "),function(b,c,e,g,f,a,n,k,d,l){Object.defineProperty(c,"__esModule",{value:!0});c.createMaterialKey=function(a,b,c,d){if(n.isSome(b)){a:{if("heatmap"===
b.type)throw Error("Symbol processor does not support heatmap renderer");switch(a){case k.WGLGeometryType.FILL:a=m.from(b);break a;case k.WGLGeometryType.LINE:a=q.from(b,c);break a;case k.WGLGeometryType.MARKER:if("dot-density"===b.type)throw Error("Dot Density renderer does not support Marker GeometryTypes");a=z.from(b);break a;case k.WGLGeometryType.TEXT:a=v.from(b);break a;case k.WGLGeometryType.LABEL:a=p.from(b,d);break a;default:throw Error("Unable to createMaterialKey for unknown geometryType "+
a);}}return a}switch(a){case k.WGLGeometryType.FILL:return m.from(null);case k.WGLGeometryType.LINE:return q.from(null,c);case k.WGLGeometryType.MARKER:return z.from(null);case k.WGLGeometryType.TEXT:return v.from(null);case k.WGLGeometryType.LABEL:return p.from(null,d);default:throw Error("Unable to createMaterialKey for unknown geometryType "+a);}};b=function(){function b(a){this._data=0;this._data=a}b.load=function(a){var b=this.shared;b.data=a;return b};Object.defineProperty(b.prototype,"data",
{get:function(){return this._data},set:function(a){this._data=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"geometryType",{get:function(){return this.bits(8,11)},set:function(a){this.setBits(a,8,11)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"mapAligned",{get:function(){return!!this.bit(20)},set:function(a){this.setBit(20,a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"sdf",{get:function(){return!!this.bit(11)},set:function(a){this.setBit(11,
a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"pattern",{get:function(){return!!this.bit(12)},set:function(a){this.setBit(12,a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"textureBinding",{get:function(){return this.bits(0,8)},set:function(a){this.setBits(a,0,8)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"geometryTypeString",{get:function(){switch(this.geometryType){case k.WGLGeometryType.FILL:return"fill";case k.WGLGeometryType.MARKER:return"marker";
case k.WGLGeometryType.LINE:return"line";case k.WGLGeometryType.TEXT:return"text";case k.WGLGeometryType.LABEL:return"label";default:throw new a("Unable to handle unknown geometryType: "+this.geometryType);}},enumerable:!0,configurable:!0});b.prototype.setBit=function(a,b){a=1<<a;this._data=b?this._data|a:this._data&~a};b.prototype.bit=function(a){return(this._data&1<<a)>>a};b.prototype.setBits=function(a,b,c){for(var d=0;b<c;b++,d++)this.setBit(b,0!==(a&1<<d))};b.prototype.bits=function(a,b){for(var c=
0,d=0;a<b;a++,d++)c|=this.bit(a)<<d;return c};b.prototype.hasVV=function(){return!1};b.prototype.setVV=function(a,b){};b.prototype.getVariation=function(){var a={},b;for(b in this)"boolean"===typeof this[b]&&(a[b]=this[b]);return a};b.prototype.getVariationHash=function(){return this._data&~(7&this.textureBinding)};b.shared=new b(0);return b}();c.MaterialKeyBase=b;g=function(a){return function(a){function b(){return null!==a&&a.apply(this,arguments)||this}e(b,a);Object.defineProperty(b.prototype,
"vvSizeMinMaxValue",{get:function(){return 0!==this.bit(16)},set:function(a){this.setBit(16,a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"vvSizeScaleStops",{get:function(){return 0!==this.bit(17)},set:function(a){this.setBit(17,a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"vvSizeFieldStops",{get:function(){return 0!==this.bit(18)},set:function(a){this.setBit(18,a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"vvSizeUnitValue",
{get:function(){return 0!==this.bit(19)},set:function(a){this.setBit(19,a)},enumerable:!0,configurable:!0});b.prototype.hasVV=function(){return a.prototype.hasVV.call(this)||this.vvSizeMinMaxValue||this.vvSizeScaleStops||this.vvSizeFieldStops||this.vvSizeUnitValue};b.prototype.setVV=function(b,c){a.prototype.setVV.call(this,b,c);b&=l.getSizeFlagsMask(b,c);this.vvSizeMinMaxValue=!!(b&k.WGLVVFlag.SIZE_MINMAX_VALUE);this.vvSizeFieldStops=!!(b&k.WGLVVFlag.SIZE_FIELD_STOPS);this.vvSizeUnitValue=!!(b&k.WGLVVFlag.SIZE_UNIT_VALUE);
this.vvSizeScaleStops=!!(b&k.WGLVVFlag.SIZE_SCALE_STOPS)};return b}(a)};var t=function(a){return function(a){function b(){return null!==a&&a.apply(this,arguments)||this}e(b,a);Object.defineProperty(b.prototype,"vvRotation",{get:function(){return 0!==this.bit(15)},set:function(a){this.setBit(15,a)},enumerable:!0,configurable:!0});b.prototype.hasVV=function(){return a.prototype.hasVV.call(this)||this.vvRotation};b.prototype.setVV=function(b,c){a.prototype.setVV.call(this,b,c);this.vvRotation=!c&&!!(b&
k.WGLVVFlag.ROTATION)};return b}(a)},x=function(a){return function(a){function b(){return null!==a&&a.apply(this,arguments)||this}e(b,a);Object.defineProperty(b.prototype,"vvColor",{get:function(){return 0!==this.bit(13)},set:function(a){this.setBit(13,a)},enumerable:!0,configurable:!0});b.prototype.hasVV=function(){return a.prototype.hasVV.call(this)||this.vvColor};b.prototype.setVV=function(b,c){a.prototype.setVV.call(this,b,c);this.vvColor=!c&&!!(b&k.WGLVVFlag.COLOR)};return b}(a)},w=function(a){return function(a){function b(){return null!==
a&&a.apply(this,arguments)||this}e(b,a);Object.defineProperty(b.prototype,"vvOpacity",{get:function(){return 0!==this.bit(14)},set:function(a){this.setBit(14,a)},enumerable:!0,configurable:!0});b.prototype.hasVV=function(){return a.prototype.hasVV.call(this)||this.vvOpacity};b.prototype.setVV=function(b,c){a.prototype.setVV.call(this,b,c);this.vvOpacity=!c&&!!(b&k.WGLVVFlag.OPACITY)};return b}(a)},m=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}e(b,a);b.load=function(a){var b=
this.shared;b.data=a;return b};b.from=function(a){var b=this.load(0);b.geometryType=k.WGLGeometryType.FILL;n.isSome(a)&&(a instanceof f.DotDensityRenderer?b.dotDensity=!0:(a=l.getVVFlags(a.visualVariables),b.setVV(a,!1)));return b.data};b.prototype.getVariation=function(){return a.prototype.getVariation.call(this)};Object.defineProperty(b.prototype,"dotDensity",{get:function(){return!!this.bit(15)},set:function(a){this.setBit(15,a)},enumerable:!0,configurable:!0});b.shared=new b(0);return b}(x(w(b)));
c.FillMaterialKey=m;var z=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}e(b,a);b.load=function(a){var b=this.shared;b.data=a;return b};b.from=function(a){var b=this.load(0);b.geometryType=k.WGLGeometryType.MARKER;n.isSome(a)&&(a=l.getVVFlags(a.visualVariables),b.setVV(a,!1));return b.data};b.prototype.getVariation=function(){return a.prototype.getVariation.call(this)};b.shared=new b(0);return b}(x(w(t(g(b)))));c.MarkerMaterialKey=z;var q=function(a){function b(){return null!==
a&&a.apply(this,arguments)||this}e(b,a);b.load=function(a){var b=this.shared;b.data=a;return b};b.from=function(a,b){var c=this.load(0);c.geometryType=k.WGLGeometryType.LINE;n.isSome(a)&&(a=l.getVVFlags(a.visualVariables),c.setVV(a,b));return c.data};b.prototype.getVariation=function(){return a.prototype.getVariation.call(this)};b.shared=new b(0);return b}(x(w(g(b))));c.LineMaterialKey=q;var v=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}e(b,a);b.load=function(a){var b=
this.shared;b.data=a;return b};b.from=function(a){var b=this.load(0);b.geometryType=k.WGLGeometryType.TEXT;n.isSome(a)&&(a=l.getVVFlags(a.visualVariables),b.setVV(a,!1));return b.data};b.prototype.getVariation=function(){return a.prototype.getVariation.call(this)};b.shared=new b(0);return b}(x(w(t(g(b)))));c.TextMaterialKey=v;var p=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}e(b,a);b.load=function(a){var b=this.shared;b.data=a;return b};b.from=function(a,b){var c=this.load(0);
c.geometryType=k.WGLGeometryType.LABEL;n.isSome(a)&&(a=l.getVVFlags(a.visualVariables),c.setVV(a,!1));c.mapAligned=!!d.isMapAligned(b.labelPlacement);return c.data};b.prototype.getVariation=function(){return a.prototype.getVariation.call(this)};b.shared=new b(0);return b}(g(b));c.LabelMaterialKey=p})},"esri/views/2d/engine/webgl/mesh/templates/WGLLabelTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/mathUtils ../../../../../../core/mathUtils ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../engine ../../color ../../definitions ../../enums ../../number ../../WGLDisplayRecord ../../collisions/Metric ../../materialKey/MaterialKey ./segmentUtils ./WGLTextTemplate".split(" "),
function(b,c,e,g,f,a,n,k,d,l,t,x,w,m,z,q,v,p,r){Object.defineProperty(c,"__esModule",{value:!0});var h=f.getLogger("esri.views.2d.engine.webgl.WGLLabelTemplate");c.isMapAligned=function(a){switch(a){case "above-along":case "below-along":case "center-along":return 1;default:return 0}};var y=function(a){var b=new Map;return function(c){b.has(c)||b.set(c,a(c));return b.get(c)}}(function(a){var b=0;if(0===a)return Infinity;for(;!(a%2);)b++,a/=2;return b}),u=function(a,b){return m.i1616to32(2*Math.round(8*
a),2*Math.round(8*b))};b=function(b){function c(c,e,f,g){var h=b.call(this,c,f.font.size,f.haloSize||0,f.color&&t.premultiplyAlphaRGBA(f.color)||0,f.haloColor&&t.premultiplyAlphaRGBA(f.haloColor)||0,f.horizontalAlignment,f.verticalAlignment,f.font.decoration,!1,f.angle||0,f.xoffset,f.yoffset,f.id,f.lineWidth,f.lineHeight)||this;h._outLineLabelAngle=0;h._refPlacementPadding=0;h._refPlacementDirX=0;h._refPlacementDirY=0;h._refOffsetX=0;h._refOffsetY=0;h.geometryType=w.WGLGeometryType.LABEL;var p;p=
!!e.minScale&&g.scaleToZoom(e.minScale)||0;p=a.clamp(p,0,25.5);g=!!e.maxScale&&g.scaleToZoom(e.maxScale)||255;g=a.clamp(g,0,25.5);var k=l.alignmentUtils.getAlignmentFromPlacement(e.labelPlacement),m=k[1];h._xAlignD=k[0];h._yAlignD=m;h._minZoom=p;h._maxZoom=g;h._refPlacementPadding=d.pt2px(f.haloSize)+x.TEXT_PLACEMENT_PADDING;c=v.LabelMaterialKey.load(v.createMaterialKey(h.geometryType,c,!1,e));c.sdf=!0;h._materialKey=c.data;return h}e(c,b);c.fromLabelClass=function(a,b,d){if("center-along"===b.labelPlacement){var e=
b.symbol;e.xoffset=0;e.yoffset=0;e.angle=0;e.font.decoration="none"}return new c(a,b,b.symbol,d)};Object.defineProperty(c.prototype,"_shapedBox",{get:function(){return k.unwrap(this._shapingInfo).bounds},enumerable:!0,configurable:!0});c.prototype.bindReferenceTemplate=function(a){var b=l.alignmentUtils.getXDirection(this._xAlignD),c=l.alignmentUtils.getYDirection(this._yAlignD);this._refOffsetY=this._refOffsetX=0;if(k.isNone(a))this._refSymbolAndPlacementOffset=m.i8888to32(0,0,Math.floor(127*b+127),
Math.floor(127*c+127));else{if("circle"===a.boundsType&&(b||c))var d=Math.sqrt(b*b+c*c),b=b/d,c=c/d;d=Math.max(a.height,a.width);this._refSymbolAndPlacementOffset=m.i8888to32(4*this._refPlacementPadding,d,Math.floor(127*b+127),Math.floor(127*c+127));this._referenceSize=d;this._refPlacementDirX=b;this._refPlacementDirY=c;this._refOffsetX=a.xOffset;this._refOffsetY=a.yOffset}};c.prototype.writeMesh=function(a,b,c,d,e,f,l){if(!k.isNone(this._shapingInfo))switch(this.current={outRecords:a,outVecs:b,outMetrics:l,
inId:d,inShaping:this._shapingInfo,zoomLevel:f},c){case "esriGeometryPolyline":return this._placeLineLabels(e.geometry);case "esriGeometryPoint":return this._placePointLabels(e.geometry);case "esriGeometryPolygon":return this._placePointLabels(e.centroid);default:a="Geometry of type "+c+" is not supported",void 0===a&&(a="mapview-labeling"),h.error(new g(a,"mapview-labeling"))}};c.prototype._isVisible=function(a,b){var c=Math.floor(10*this.current.zoomLevel);return Math.floor(10*a)<=c&&c<=Math.floor(10*
b)};c.prototype._placePointLabels=function(a){var b=this.current;this._writeGlyphs(b.outRecords,b.outVecs,b.inId,a,b.outMetrics)};c.prototype._placeLineLabels=function(a){a=p.smoothPaths(a.paths,this.current.inShaping.bounds.width);for(var b=this._placeSubdivGlyphs.bind(this),c=(this._shapedBox.width+128)/4,d=0;d<a.length;d++)p.pathDivide(a[d],c,b)};c.prototype._placeSubdivGlyphs=function(a,b,c,d){var e=y(b);c=n.log2(Math.min(c,d-c)/(4+this._shapedBox.width/4/2));e=Math.max(this._minZoom,this.current.zoomLevel+
2-(0===b?c:Math.min(e,c)));c=this._shapedBox.width/2*Math.pow(2,this.current.zoomLevel-e);this.current.inShaping.isMultiline?0===b&&this._placeStraight(a,e):this._placeCurved(a,e,c)};c.prototype._placeStraight=function(a,b){var c=this.current;this._writeGlyphs(c.outRecords,c.outVecs,c.inId,a,c.outMetrics,b)};c.prototype._placeCurved=function(a,b,c){var d=new q.default(this.current.inId,{from:this.current.outRecords.length,count:-1},a.x,a.y,b),e=a.clone(),f=(180/Math.PI*a.angle+180)%360;this._outLineLabelAngle=
Math.round(180/Math.PI*a.angle%360*(254/360));this._placeFirst(e,d,b,1);this._placeBack(a,e,d,b,c,1);this._placeForward(a,e,d,b,c,1);this._outLineLabelAngle=Math.round(254/360*f);this._placeFirst(e,d,b,0);this._placeBack(a,e,d,b,c,0);this._placeForward(a,e,d,b,c,0);d.range.count=this.current.outRecords.length-d.range.from;d.bounds&&this.current.outMetrics.push(d)};c.prototype._placeBack=function(a,b,c,d,e,f){var g=a.clone();for(a=a.backwardLength+0;g.prev()&&!(a>=e);)this._placeOnSegment(g,b,c,a,
d,-1,f),a+=g.length+0};c.prototype._placeForward=function(a,b,c,d,e,f){var g=a.clone();for(a=a.remainingLength+0;g.next()&&!(a>=e);)this._placeOnSegment(g,b,c,a,d,1,f),a+=g.length+0};c.prototype._placeFirst=function(a,b,c,d){for(var e=this.current.inShaping,f=e.glyphs,g=this.current.zoomLevel,h=this.current,l=h.outRecords,p=h.outVecs,h=h.inId,k=u(a.x,a.y),m=0;m<f.length;m++){var r=f[m],q=r.x>e.bounds.x?d:1-d,q=Math.max(0,g+n.log2(Math.abs(r.x+r.width/2-e.bounds.x)/(q*a.remainingLength+(1-q)*a.backwardLength+
0))),q=Math.max(c,q);r.maxZoom=25;r.angle=a.angle+(1-d)*Math.PI;r.minZoom=q;this._writeGlyph(l,p,r,h,k);d&&this._isVisible(r.minZoom,r.maxZoom)&&b.add(r.bounds,0,0)}};c.prototype._placeOnSegment=function(a,b,c,d,e,f,g){for(var h=this.current.inShaping.glyphs,l=this.current,p=l.outRecords,k=l.outVecs,l=l.inId,m=this.current.inShaping,r=this.current.zoomLevel,q=u(a.x+a.dx/a.length*-f*d,a.y+a.dy/a.length*-f*d),v=0;v<h.length;v++){var t=h[v],w=t.x>m.bounds.x?g:1-g;if(w&&1===f||!w&&-1===f){var y=Math.abs(t.x+
t.width/2-m.bounds.x),w=Math.max(0,r+n.log2(y/d)-.1),y=Math.max(e,r+n.log2(y/(d+a.length+0)));0!==w&&(t.angle=a.angle+(1-g)*Math.PI,t.minZoom=y,t.maxZoom=w,this._writeGlyph(p,k,t,l,q),g&&this._isVisible(t.minZoom,t.maxZoom)&&c.add(t.bounds,a.x-b.x,a.y-b.y))}}};c.prototype._writeGlyphs=function(a,b,c,d,e,f){void 0===f&&(f=this._minZoom);var g=this._shapingInfo;if(!(k.isNone(g)||0>d.x||512<=d.x||0>d.y||512<=d.y)){var h=u(d.x+this._refOffsetX,d.y-this._refOffsetY);d=new q.default(c,{from:a.length,count:-1},
d.x+this._refOffsetX,d.y-this._refOffsetY,f);for(var l=0,p=g.glyphs;l<p.length;l++){var m=p[l];m.minZoom=f;m.maxZoom=this._maxZoom;this._writeGlyph(a,b,m,c,h)}d.range.count=a.length-d.range.from;d.bounds=g.boundsT;a=v.LabelMaterialKey.load(this._materialKey);d.setPlacementOffset(a.vvSizeFieldStops||a.vvSizeMinMaxValue||a.vvSizeScaleStops||a.vvSizeUnitValue,this._referenceSize,this._refPlacementPadding,this._refPlacementDirX,this._refPlacementDirY);e.push(d)}};c.prototype._writeGlyph=function(a,b,
c,d,e){var f=v.MaterialKeyBase.load(this._materialKey),g=new z(d,this.geometryType,f.data,0,0);f.textureBinding=c.textureBinding;g.materialKey=f.data;g.indexFrom=b.indexVector.length;g.indexCount=this._writeIndices(b);g.vertexFrom=b.getVector("geometry").vertexCount;g.vertexCount=this._writeVertex(b,d,e,c);a.push(g)};c.prototype._writeVertexCommon=function(a,b,c,d){var e=this._color,f=this._haloColor,g=m.i8888to32(0,0,this._size,this._haloSize);d=m.i8888to32(Math.floor(10*Math.max(d.minZoom,this._minZoom)),
Math.floor(10*Math.min(d.maxZoom,this._maxZoom)),this._outLineLabelAngle,0);a.push(c);a.push(b);a.push(e);a.push(f);a.push(g);a.push(this._refSymbolAndPlacementOffset);a.push(d)};return c}(r.default);c.default=b})},"esri/views/2d/engine/webgl/WGLDisplayRecord":function(){define(["require","exports","./MeshData","./Utils"],function(b,c,e,g){return function(){function b(a,b,c,d,e){void 0===d&&(d=0);void 0===e&&(e=0);this.id=a;this.geometryType=b;this.materialKey=c;this.minZoom=d;this.maxZoom=e;this.meshData=
null;this.indexCount=this.indexFrom=this.vertexCount=this.vertexFrom=this.zOrder=this.symbolLevel=0}Object.defineProperty(b.prototype,"sortKey",{get:function(){void 0===this._sortKey&&this._computeSortKey();return this._sortKey},enumerable:!0,configurable:!0});b.prototype.clone=function(){return this.copy()};b.prototype.copy=function(){var a=new b(this.id,this.geometryType,this.materialKey);a.vertexFrom=this.vertexFrom;a.vertexCount=this.vertexCount;a.indexFrom=this.indexFrom;a.indexCount=this.indexCount;
a.zOrder=this.zOrder;a.symbolLevel=this.symbolLevel;a.meshData=this.meshData;a.minZoom=this.minZoom;a.maxZoom=this.maxZoom;return a};b.prototype.setMeshDataFromBuffers=function(a,b,c){var d=new e,f;for(f in b){for(var k=b[f].stride,n=b[f].data,w=[],m=g.strideToPackingFactor(k),z=0;z<k*a.vertexCount/m;++z)w[z]=n[z+k*a.vertexFrom/m];d.vertexData.set(f,w)}for(z=d.indexData.length=0;z<a.indexCount;++z)d.indexData[z]=c[z+a.indexFrom]-a.vertexFrom;d.vertexCount=a.vertexCount;this.meshData=d};b.prototype.readMeshDataFromBuffers=
function(a,b){this.meshData?this.meshData.clear():this.meshData=new e;for(var c in a){for(var d=a[c].stride,f=a[c].data,n=[],x=g.strideToPackingFactor(d),w=0;w<d*this.vertexCount/x;++w)n[w]=f[w+d*this.vertexFrom/x];this.meshData.vertexData.set(c,n)}for(w=this.meshData.indexData.length=0;w<this.indexCount;++w)this.meshData.indexData[w]=b[w+this.indexFrom]-this.vertexFrom;this.meshData.vertexCount=this.vertexCount};b.prototype.writeMeshDataToBuffers=function(a,b,c,d){for(var e in b)for(var f=b[e].stride,
k=this.meshData.vertexData.get(e),n=b[e].data,m=g.strideToPackingFactor(f),z=0;z<f*this.meshData.vertexCount/m;++z)n[z+f*a/m]=k[z];for(z=0;z<this.meshData.indexData.length;++z)d[z+c]=this.meshData.indexData[z]+a;this.vertexFrom=a;this.vertexCount=this.meshData.vertexCount;this.indexFrom=c;this.indexCount=this.meshData.indexData.length};b.writeAllMeshDataToBuffers=function(a,b,c){for(var d=0,e=0,f=0;f<a.length;f++){var g=a[f];g.writeMeshDataToBuffers(d,b,e,c);d+=g.vertexCount;e+=g.indexCount}};b.prototype._computeSortKey=
function(){this._sortKey=(this.symbolLevel&31)<<12|(this.zOrder&127)<<4|this.geometryType&7};b.prototype.serialize=function(a){a.push(this.geometryType);a.push(this.materialKey);a.push(this.symbolLevel);a.push(this.zOrder);a.push(this.vertexFrom);a.push(this.vertexCount);a.push(this.indexFrom);a.push(this.indexCount);a.push(this.minZoom);a.push(this.maxZoom);return a};b.deserialize=function(a,c){var e=a.readInt32(),d=a.readInt32();c=new b(c.id,e,d);c.symbolLevel=a.readInt32();c.zOrder=a.readInt32();
c.vertexFrom=a.readInt32();c.vertexCount=a.readInt32();c.indexFrom=a.readInt32();c.indexCount=a.readInt32();c.minZoom=a.readInt32();c.maxZoom=a.readInt32();return c};return b}()})},"esri/views/2d/engine/webgl/MeshData":function(){define(["require","exports"],function(b,c){return function(){function b(){this.vertexData=new Map;this.vertexCount=0;this.indexData=[]}b.prototype.clear=function(){this.vertexData.clear();this.vertexCount=0;this.indexData=[]};b.prototype.update=function(b,c,a){for(var e in b)this.vertexData.set(e,
b[e]);for(e in this.vertexData)null===b[e]&&this.vertexData.delete(e);this.vertexCount=c;this.indexData=a};return b}()})},"esri/views/2d/engine/webgl/collisions/Metric":function(){define("require exports ../../../../../core/Logger ../../../../../core/libs/gl-matrix-2/vec2f32 ../definitions ./BoundingBox ../util/serializationUtils".split(" "),function(b,c,e,g,f,a,n){Object.defineProperty(c,"__esModule",{value:!0});var k=e.getLogger("esri/views/2d/engine/webgl/collisions/Metric");b=function(){function b(a,
b,c,d,e){this.id=a;this.range=b;this.boxes=null;this.minZoom=-1;this.placementPadding=this.offsetY=this.offsetX=this.directionY=this.directionX=this.size=0;this.anchor=g.vec2f32.fromValues(c,d);this.baseZoom=e}b.prototype.add=function(a,b,c){a.x+=b;a.y+=c;this.bounds?(this.boxes?this.boxes.push(a):(this.boxes=[this.bounds,a],this.bounds=this.bounds.clone()),this.bounds.extend(a)):this.bounds=a};b.prototype.computeIndex=function(){var a=Math.floor(this.anchor[1]/f.COLLISION_BUCKET_SIZE);this.xBucket=
Math.floor(this.anchor[0]/f.COLLISION_BUCKET_SIZE);this.yBucket=a;a=f.TILE_SIZE/f.COLLISION_BUCKET_SIZE;this.hasVV?this.yOverflow=this.xOverflow=a:(this.xOverflow=Math.min(a,Math.ceil(2*this.bounds.width/f.COLLISION_BUCKET_SIZE)),this.yOverflow=Math.min(a,Math.ceil(2*this.bounds.height/f.COLLISION_BUCKET_SIZE)))};b.prototype.findCollisionDelta=function(a){var b=this.bounds.findCollisionDelta(a.bounds),c=this.boxes&&this.boxes.length,d=a.boxes&&a.boxes.length;return Math.abs(b)>f.COLLISION_MAX_ZOOM_DELTA||
!c&&!d?b:c&&d?this._boxesToBoxes(a):c?this._boxesToBox(a):this._boxToBoxes(a)};b.prototype.computeVVOffset=function(a,b){b||k.error("mapview-labeling","Unable to compute label offset. Expected an evaluator function but found "+b);var c=this.size;this.hasVV&&(a=b(a),c=isNaN(a)||null==a||Infinity===a?this.size:a);this._computeOffset(c)};b.prototype.setPlacementOffset=function(a,b,c,d,e){this.hasVV=a;this.size=b;this.placementPadding=Math.round(c);this.directionX=d;this.directionY=e};b.prototype.clone=
function(){var a=new b(this.id,this.range,this.anchor[0],this.anchor[1],this.baseZoom);a.minZoom=this.minZoom;this.bounds&&(a.bounds=this.bounds.clone());this.boxes&&(a.boxes=this.boxes.map(function(a){return a.clone()}));a.xBucket=this.xBucket;a.yBucket=this.yBucket;a.xOverflow=this.xOverflow;a.yOverflow=this.yOverflow;a.hasVV=this.hasVV;a.size=this.size;a.directionX=this.directionX;a.directionY=this.directionY;a.offsetX=this.offsetX;a.offsetY=this.offsetY;return a};b.prototype._boxToBoxes=function(a){var b=
-Infinity,c=0;for(a=a.boxes;c<a.length;c++)var d=this.bounds.findCollisionDelta(a[c]),b=Math.max(d,b);return b};b.prototype._boxesToBox=function(a){for(var b=this.boxes[0].findCollisionDelta(a.bounds),c=1;c<this.boxes.length;c++)var d=this.boxes[c].findCollisionDelta(a.bounds),b=Math.max(d,b);return b};b.prototype._boxesToBoxes=function(a){for(var b=-Infinity,c=0;c<this.boxes.length;c++)for(var d=this.boxes[c],e=0,f=a.boxes;e<f.length;e++)var g=d.findCollisionDelta(f[e]),b=Math.max(g,b);return b};
b.prototype._computeOffset=function(a){this.offsetX=this.directionX*(a/2+this.placementPadding);this.offsetY=this.directionY*(a/2+this.placementPadding)};b.prototype.serialize=function(a){a.push(this.id);this.bounds.serialize(a);a.push(this.range.from);a.push(this.range.count);a.push(this.anchor[0]);a.push(this.anchor[1]);a.push(this.baseZoom);a.push(this.hasVV?1:0);a.push(this.size);a.writeF32(this.directionX);a.writeF32(this.directionY);a.push(this.offsetX);a.push(this.offsetY);a.push(this.placementPadding);
n.serializeList(a,this.boxes);return a};b.deserialize=function(c){var d=c.readInt32(),e=a.default.deserialize(c),f=c.readInt32(),g=c.readInt32(),l={from:f,count:g},k=c.readInt32(),v=c.readInt32(),p=c.readInt32(),f=c.readInt32(),g=c.readInt32(),r=c.readF32(),h=c.readF32(),y=c.readInt32(),u=c.readInt32(),D=c.readInt32();c=n.deserializeList(c,a.default);d=new b(d,l,k,v,p);d.bounds=e;d.boxes=c;d.setPlacementOffset(!!f,g,D,r,h);d.offsetX=y;d.offsetY=u;d.computeIndex();f||d._computeOffset(g);return d};
return b}();c.default=b})},"esri/views/2d/engine/webgl/collisions/BoundingBox":function(){define(["require","exports","../../../../../core/mathUtils","../../../../../core/libs/gl-matrix-2/vec2f32"],function(b,c,e,g){Object.defineProperty(c,"__esModule",{value:!0});b=function(){function b(a,b,c,d){this.center=g.vec2f32.fromValues(a,b);this.centerT=g.vec2f32.create();this.halfWidth=c/2;this.halfHeight=d/2;this.width=c;this.height=d}Object.defineProperty(b.prototype,"x",{get:function(){return this.center[0]},
set:function(a){this.center[0]=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"y",{get:function(){return this.center[1]},set:function(a){this.center[1]=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"blX",{get:function(){return this.center[0]+this.halfWidth},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"blY",{get:function(){return this.center[1]+this.halfHeight},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"trX",
{get:function(){return this.center[0]-this.halfWidth},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"trY",{get:function(){return this.center[1]-this.halfHeight},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"xmin",{get:function(){return this.x-this.halfWidth},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"xmax",{get:function(){return this.x+this.halfWidth},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"ymin",{get:function(){return this.y-
this.halfHeight},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"ymax",{get:function(){return this.y+this.halfHeight},enumerable:!0,configurable:!0});b.prototype.clone=function(){return new b(this.x,this.y,this.width,this.height)};b.prototype.serialize=function(a){a.writeF32(this.center[0]);a.writeF32(this.center[1]);a.push(this.width);a.push(this.height);return a};b.prototype.findCollisionDelta=function(a,b){void 0===b&&(b=4);return e.log2(Math.min((a.halfWidth+this.halfWidth+
b)/Math.abs(a.centerT[0]-this.centerT[0]),(a.halfHeight+this.halfHeight+b)/Math.abs(a.centerT[1]-this.centerT[1])))};b.prototype.extend=function(a){var b=Math.min(this.xmin,a.xmin),c=Math.min(this.ymin,a.ymin),d=Math.max(this.xmax,a.xmax)-b;a=Math.max(this.ymax,a.ymax)-c;this.width=d;this.height=a;this.halfWidth=d/2;this.halfHeight=a/2;this.x=b+d/2;this.y=c+a/2};b.deserialize=function(a){var c=a.readF32(),e=a.readF32(),d=a.readInt32();a=a.readInt32();return new b(c,e,d,a)};return b}();c.default=b})},
"esri/views/2d/engine/webgl/util/serializationUtils":function(){define(["require","exports"],function(b,c){Object.defineProperty(c,"__esModule",{value:!0});c.serializeList=function(b,c){if(null===c)b.push(0);else{b.push(c.length);for(var e=0;e<c.length;e++)c[e].serialize(b);return b}};c.deserializeList=function(b,c,f){for(var a=b.readInt32(),a=Array(a),e=0;e<a.length;e++)a[e]=c.deserialize(b,f);return a}})},"esri/views/2d/engine/webgl/mesh/templates/segmentUtils":function(){define(["require","exports",
"../../../../../../core/maybe","./util"],function(b,c,e,g){function f(a){return a.length-1}function a(a){for(var b=0,c=0;c<f(a);c++)b+=n(a,c);return b}function n(a,b,c){void 0===c&&(c=1);b=a[b+1];a=b[0];b=b[1];return Math.sqrt(a*a+b*b)*c}function k(a,b,c,d,f){if(!(c<b)){var g=d.clone().seek(c/2);e.isNone(g)||(a(g.clone(),c,f),c=(c-b)/2,g=e.expect(g.seek(b/2)),k(a,b,c,d,f+1),k(a,b,c,g,f+1))}}Object.defineProperty(c,"__esModule",{value:!0});c.segmentAt=function(a,b){return a[b+1]};c.segmentCount=f;
c.pathLength=a;c.segmentLength=n;var d=function(){function a(a,b,c,d,e){this._segments=a;this._index=b;this._distance=c;this._xStart=d;this._yStart=e;this._done=!1}a.create=function(b){return new a(b,0,0,b[0][0],b[0][1])};a.prototype.clone=function(){return new a(this._segments,this._index,this._distance,this.xStart,this.yStart)};a.prototype.equals=function(a){return this._index===a._index||a._index===this._index-1&&(0===this._distance||1===a._distance)||a._index===this._index+1&&(1===this._distance||
0===a._distance)};a.prototype.leq=function(a){return this._index<a._index||this._index===a._index&&this._distance<=a._distance};a.prototype.geq=function(a){return this._index>a._index||this._index===a._index&&this._distance>=a._distance};Object.defineProperty(a.prototype,"_segment",{get:function(){return this._segments[this._index+1]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"angle",{get:function(){var a=this.dy,b=Math.acos((0*a+-1*-this.dx)/(1*this.length));0<a&&(b=2*Math.PI-
b);return b},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"xStart",{get:function(){return this._xStart},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"yStart",{get:function(){return this._yStart},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"x",{get:function(){return this.xStart+this.distance*this.dx},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"y",{get:function(){return this.yStart+this.distance*this.dy},enumerable:!0,
configurable:!0});Object.defineProperty(a.prototype,"dx",{get:function(){return this._segment[0]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"dy",{get:function(){return this._segment[1]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"xMidpoint",{get:function(){return this.xStart+.5*this.dx},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"yMidpoint",{get:function(){return this.yStart+.5*this.dy},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"xEnd",{get:function(){return this.xStart+this.dx},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"yEnd",{get:function(){return this.yStart+this.dy},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"length",{get:function(){var a=this.dx,b=this.dy;return Math.sqrt(a*a+b*b)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"remainingLength",{get:function(){return this.length*(1-this._distance)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"backwardLength",{get:function(){return this.length*this._distance},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"done",{get:function(){return this._done},enumerable:!0,configurable:!0});a.prototype.hasPrev=function(){return 0<=this._index-1};a.prototype.hasNext=function(){return this._index+1<f(this._segments)};a.prototype.next=function(){if(!this.hasNext())return null;
this._xStart+=this.dx;this._yStart+=this.dy;this._distance=0;this._index+=1;return this};a.prototype.prev=function(){if(!this.hasPrev())return this._done=!0,null;--this._index;this._xStart-=this.dx;this._yStart-=this.dy;this._distance=1;return this};a.prototype._seekBackwards=function(a,b){var c=this.backwardLength;if(a<=c)return this._distance=(c-a)/this.length,this;for(c=this.backwardLength;this.prev();){if(c+this.length>a)return this._seekBackwards(a-c);c+=this.length}this._distance=0;return b?
this:null};a.prototype.seek=function(a,b){void 0===b&&(b=!1);if(0>a)return this._seekBackwards(Math.abs(a),b);if(a<=this.remainingLength)return this._distance=(this.backwardLength+a)/this.length,this;for(var c=this.remainingLength;this.next();){if(c+this.length>a)return this.seek(a-c,b);c+=this.length}this._distance=1;return b?this:null};return a}();c.SegmentCursor=d;c.pathDivide=function(b,c,e){var f=a(b);b=d.create(b);var g=f/2,l=Math.floor((f-c)/2/c);b.seek(g-l*c);for(var k=-l;k<=l;k++)512>b.x&&
0<=b.x&&512>b.y&&0<=b.y&&e(b.clone(),k,g+k*c,f),b.seek(c)};c.pathSubdivide=function(b,c,e){k(e,c,a(b),d.create(b),0)};c.smoothPaths=function(a,b){for(var c=0;c<a.length;c++){var d=a[c],e=[];e.push(d[0]);for(var f=1;f<d.length;f++){var l=e[f-1],k=l[0],l=l[1],k=k+d[f][0],l=l+d[f][1];e.push([k,l])}k=e;l=b;if(!(0>=l||(d=k.length,3>d))){var f=[],p=0;f.push(0);for(var r=1;r<d;r++)p+=g.dist(k[r],k[r-1]),f.push(p);l=Math.min(l,.2*p);p=[];p.push(k[0][0]);p.push(k[0][1]);var h=k[d-1][0],n=k[d-1][1],r=g.sub([0,
0],k[0],k[1]);g.normalize(r);k[0][0]+=l*r[0];k[0][1]+=l*r[1];g.sub(r,k[d-1],k[d-2]);g.normalize(r);k[d-1][0]+=l*r[0];k[d-1][1]+=l*r[1];for(r=1;r<d;r++)f[r]+=l;f[d-1]+=l;for(var u=.5*l,r=1;r<d-1;r++){for(var t=0,B=0,C=0,A=r-1;0<=A&&!(f[A+1]<f[r]-u);A--){var I=u+f[A+1]-f[r],E=f[A+1]-f[A],H=f[r]-f[A]<u?1:I/E;if(1E-6>Math.abs(H))break;var F=H*H,L=H*I-.5*F*E,J=H*E/l,G=k[A+1],N=k[A][0]-G[0],M=k[A][1]-G[1],t=t+J/L*(G[0]*H*I+.5*F*(I*N-E*G[0])-F*H*E*N/3),B=B+J/L*(G[1]*H*I+.5*F*(I*M-E*G[1])-F*H*E*M/3),C=C+
J}for(A=r+1;A<d&&!(f[A-1]>f[r]+u);A++){I=u-f[A-1]+f[r];E=f[A]-f[A-1];H=f[A]-f[r]<u?1:I/E;if(1E-6>Math.abs(H))break;F=H*H;L=H*I-.5*F*E;J=H*E/l;G=k[A-1];N=k[A][0]-G[0];M=k[A][1]-G[1];t+=J/L*(G[0]*H*I+.5*F*(I*N-E*G[0])-F*H*E*N/3);B+=J/L*(G[1]*H*I+.5*F*(I*M-E*G[1])-F*H*E*M/3);C+=J}p.push(t/C);p.push(B/C)}p.push(h);p.push(n);for(A=r=0;r<d;r++)k[r][0]=p[A++],k[r][1]=p[A++]}d=[];d.push(e[0]);for(f=1;f<e.length;f++)k=e[f-1],r=k[0],p=k[1],l=e[f],k=l[0],l=l[1],d.push([Math.round(k-r),Math.round(l-p)]);a[c]=
d}return a}})},"esri/views/2d/engine/webgl/mesh/templates/util":function(){define(["require","exports"],function(b,c){function e(b,c){return Math.sqrt(b*b+c*c)}Object.defineProperty(c,"__esModule",{value:!0});c.sub=function(b,c,a){b[0]=c[0]-a[0];b[1]=c[1]-a[1];return b};c.len=e;c.normalize=function(b){var c=e(b[0],b[1]);b[0]/=c;b[1]/=c};c.dist=function(b,c){return e(b[0]-c[0],b[1]-c[1])};c.isFunction=function(b){return"function"===typeof b};c.getLimitCosine=function(b){return 1/Math.max(b,1)}})},
"esri/views/2d/engine/webgl/mesh/templates/WGLTextTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/screenUtils ../../alignmentUtils ../../color ../../materialKey/MaterialKey ./WGLBaseTextTemplate ./WGLMeshTemplate ../../util/BidiText".split(" "),function(b,c,e,g,f,a,n,k,d,l){Object.defineProperty(c,"__esModule",{value:!0});b=function(b){function c(a,c,d,e,k,l,r,h,y,u,t,B,C,A,x,E){void 0===E&&(E=!1);var p=b.call(this)||this;p._xOffset=
g.pt2px(t);p._yOffset=g.pt2px(B);p._decoration=h||"none";p._color=e;p._haloColor=k;p._haloSize=Math.min(Math.floor(5*g.pt2px(g.toPt(d))),127);p._size=Math.min(Math.round(g.pt2px(c)),127);c=Math.min(Math.round(g.pt2px(c)),127);p._referenceSize=Math.round(Math.sqrt(256*c));p._scale=p._size/24;p._angle=u;p._justify=f.getJustification(l||"center");p._xAlignD=f.getXAnchorDirection(l||"center");p._yAlignD=f.getYAnchorDirection(r||"baseline");p._baseline="baseline"===(r||"baseline");p._bitset=y?1:0;a=n.MaterialKeyBase.load(n.createMaterialKey(p.geometryType,
a,!1));a.sdf=!0;p._materialKey=a.data;p.symbolId=C;p._lineWidth=g.pt2px(A)||512;p._lineHeight=x||1;p._isCIM=E;return p}e(c,b);c.fromText=function(b,d,e){b=new c(b,d.font.size,d.haloSize||0,d.color&&a.premultiplyAlphaRGBA(d.color)||0,d.haloColor&&a.premultiplyAlphaRGBA(d.haloColor)||0,d.horizontalAlignment,d.verticalAlignment,d.font.decoration,!1,d.angle||0,d.xoffset,d.yoffset,d.id,d.lineWidth,d.lineHeight,!1);d=l.bidiText(d.text)[1];b.bindTextInfo(e,d);return b};c.fromCIMText=function(b,d,e){var f=
d.scaleFactor||1;b=new c(b,d.size*d.sizeRatio*f,d.outlineSize*d.sizeRatio,a.premultiplyAlphaRGBA(d.color),a.premultiplyAlphaRGBA(d.outlineColor),d.horizontalAlignment,d.verticalAlignment,d.decoration,d.colorLocked,d.angle,d.offsetX*d.sizeRatio*f,d.offsetY*d.sizeRatio*f,d.materialHash,512,1,!0);d=l.bidiText(d.text)[1];b.bindTextInfo(e,d);return b};return c}(k.default(d.default));c.default=b})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseTextTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/maybe ../../../../engine ../../definitions ../../enums ../../number ../../WGLDisplayRecord ../../materialKey/MaterialKey".split(" "),
function(b,c,e,g,f,a,n,k,d,l,t,x){Object.defineProperty(c,"__esModule",{value:!0});var w=f.getLogger("esri.views.2d.engine.webgl.WGLTextTemplate"),m=function(a,b){void 0===b&&(b="mapview-processing");return w.error(new g(b,a))};c.default=function(b){return function(b){function c(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];a=b.apply(this,a)||this;a._isCIM=!1;a.geometryType=d.WGLGeometryType.TEXT;a._aux=l.i8888to32(0,0,a._referenceSize,a._bitset);return a}e(c,b);c.prototype.bindTextInfo=
function(b,c){var d=this;this._shapingInfo=b&&b.length?a.andThen(b,function(a){return n.shapeGlyphs(a,c,{scale:d._scale,angle:d._angle,xOffset:d._xOffset,yOffset:d._yOffset,hAlign:d._xAlignD,vAlign:d._yAlignD,maxLineWidth:Math.max(32,Math.min(d._lineWidth,512)),lineHeight:k.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(d._lineHeight,4)),decoration:d._decoration,isCIM:d._isCIM})}):null};c.prototype.writeMesh=function(b,c,d,e,f){var g=this;switch(d){case "esriGeometryPoint":this._writeGlyphs(b,c,e,
f.geometry);break;case "esriGeometryPolygon":a.andThen(f.centroid,function(a){return g._writeGlyphs(b,c,e,a)});break;case "esriGeometryMultipoint":var h=d=0,k=0;for(f=f.geometry.points;k<f.length;k++){var l=f[k],p=l[1];d+=l[0];h+=p;this._writeGlyphs(b,c,e,{x:d,y:h})}break;default:m("Unable to handle geometryType: "+d)}};c.prototype._writeGlyphs=function(b,c,d,e){var f=this._shapingInfo;if(!a.isNone(f)){var g=x.MaterialKeyBase.load(this._materialKey);e=l.i1616to32(2*e.x,2*e.y);for(var h=0,f=f.glyphs;h<
f.length;h++){var k=f[h],p=new t(d,this.geometryType,g.data,0,0);g.textureBinding=k.textureBinding;p.materialKey=g.data;p.indexFrom=c.indexVector.length;p.indexCount=this._writeIndices(c);p.vertexFrom=c.getVector("geometry").vertexCount;p.vertexCount=this._writeVertex(c,d,e,k);b.push(p)}}};c.prototype._writeVertexCommon=function(a,b,c,d){d=this._color;var e=this._haloColor,f=l.i8888to32(0,0,this._referenceSize,this._bitset),g=l.i8888to32(0,0,this._size,this._haloSize);a.push(c);a.push(b);a.push(d);
a.push(e);a.push(g);a.push(f)};c.prototype._writeVertex=function(a,b,c,d){a=a.get("geometry");this._writeVertexCommon(a,b,c,d);a.push(d.offsets.upperLeft);a.push(d.texcoords.upperLeft);this._writeVertexCommon(a,b,c,d);a.push(d.offsets.upperRight);a.push(d.texcoords.upperRight);this._writeVertexCommon(a,b,c,d);a.push(d.offsets.lowerLeft);a.push(d.texcoords.lowerLeft);this._writeVertexCommon(a,b,c,d);a.push(d.offsets.lowerRight);a.push(d.texcoords.lowerRight);return 4};c.prototype._writeIndices=function(a){var b=
a.getVector("geometry").vertexCount;a=a.indexVector;a.push(b+0);a.push(b+1);a.push(b+2);a.push(b+1);a.push(b+3);a.push(b+2);return 6};return c}(b)}})},"esri/views/2d/engine/webgl/mesh/templates/WGLMeshTemplate":function(){define(["require","exports","../../../../../../core/tsSupport/extendsHelper"],function(b,c,e){Object.defineProperty(c,"__esModule",{value:!0});b=function(){function b(){}b.prototype.writeMesh=function(b,a,c,e,d){};b.prototype.bindFeature=function(b,a,c){};return b}();c.default=b})},
"esri/views/2d/engine/webgl/util/vvFlagUtils":function(){define(["require","exports","../enums","../visualVariablesUtils"],function(b,c,e,g){function f(a,b){void 0===b&&(b=!1);var c=e.WGLVVFlag.SIZE_FIELD_STOPS|e.WGLVVFlag.SIZE_MINMAX_VALUE|e.WGLVVFlag.SIZE_SCALE_STOPS|e.WGLVVFlag.SIZE_UNIT_VALUE;a=(a&(e.WGLVVTarget.FIELD_TARGETS_OUTLINE|e.WGLVVTarget.MINMAX_TARGETS_OUTLINE|e.WGLVVTarget.SCALE_TARGETS_OUTLINE|e.WGLVVTarget.UNIT_TARGETS_OUTLINE))>>>4;return b?c&a:c&~a}function a(a){var b=f(a,!1);return a&
(e.WGLVVFlag.COLOR|e.WGLVVFlag.OPACITY|e.WGLVVFlag.ROTATION|b)}Object.defineProperty(c,"__esModule",{value:!0});c.getVVFlags=function(a){if(!a)return e.WGLVVFlag.NONE;for(var b=0,c=0;c<a.length;c++){var f=a[c];if("size"===f.type){var n=g.getTypeOfSizeVisualVariable(f),b=b|n;"outline"===f.target&&(b|=n<<4)}else"color"===f.type?b|=e.WGLVVFlag.COLOR:"opacity"===f.type?b|=e.WGLVVFlag.OPACITY:"rotation"===f.type&&(b|=e.WGLVVFlag.ROTATION)}return b};c.getSizeFlagsMask=f;c.getMarkerVVFlags=a;c.getFillVVFlags=
function(a){return a&(e.WGLVVFlag.COLOR|e.WGLVVFlag.OPACITY)};c.getLineVVFlags=function(a,b){if(b)return b=f(a,!0),a&b;b=f(a,!1);return a&(e.WGLVVFlag.COLOR|e.WGLVVFlag.OPACITY|b)};c.getTextVVFlags=function(b){return a(b)};c.getLabelVVFlags=function(a){var b=f(a,!1);return a&b}})},"esri/views/2d/engine/webgl/visualVariablesUtils":function(){define("require exports ../../../../core/Error ../../../../core/Logger ./enums ./Utils".split(" "),function(b,c,e,g,f,a){Object.defineProperty(c,"__esModule",
{value:!0});var n=g.getLogger("esri.views.2d.engine.webgl");c.getTypeOfSizeVisualVariable=function(b){if(a.isNumber(b.minDataValue)&&a.isNumber(b.maxDataValue)&&null!=b.minSize&&null!=b.maxSize)return f.WGLVVFlag.SIZE_MINMAX_VALUE;if((b.expression&&"view.scale"===b.expression||b.valueExpression&&"$view.scale"===b.valueExpression)&&Array.isArray(b.stops))return f.WGLVVFlag.SIZE_SCALE_STOPS;if((null!=b.field||b.expression&&"view.scale"!==b.expression||b.valueExpression&&"$view.scale"!==b.valueExpression)&&
(Array.isArray(b.stops)||"levels"in b&&b.levels))return f.WGLVVFlag.SIZE_FIELD_STOPS;if((null!=b.field||b.expression&&"view.scale"!==b.expression||b.valueExpression&&"$view.scale"!==b.valueExpression)&&null!=b.valueUnit)return f.WGLVVFlag.SIZE_UNIT_VALUE;n.error(new e("mapview-bad-type","Found invalid size VisualVariable",b));return f.WGLVVFlag.NONE}})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLabel":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../webgl ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),
function(b,c,e,g,f,a,n,k){Object.defineProperty(c,"__esModule",{value:!0});b=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}e(c,b);c.prototype.dispose=function(){};c.prototype.getGeometryType=function(){return f.WGLGeometryType.LABEL};c.prototype.drawGeometry=function(b,c,d,e,f){var g=b.context,l=b.painter,p=b.state,m=b.rendererInfo,h=d.indexCount,n=d.indexFrom;d=k.LabelMaterialKey.load(d.materialKey);var u=d.mapAligned?1:0;if(u||!(1<=Math.abs(c.key.level-Math.round(100*b.displayLevel)/
100))){var w=a.createProgramDescriptor(d.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_haloColor",count:4,type:5121,normalized:!0},{location:4,name:"a_texAndSize",count:4,type:5121},{location:5,name:"a_refSymbolAndPlacementOffset",count:4,type:5121},{location:6,name:"a_glyphData",count:4,type:5121},{location:7,name:"a_vertexOffset",count:2,type:5122},{location:8,
name:"a_texCoords",count:2,type:5123}]}),t=w.bufferLayouts,w=w.attributes;f=l.materialManager.getMaterialProgram(b,d,"materials/label",w,f);e=this._getVAO(g,t,w,e);b.context.setStencilFunction(514,0,255);g.bindProgram(f);g.bindVAO(e);this._setSharedUniforms(f,b,c);l.textureManager.bindTextures(g,f,d);l=1===u?p.displayViewMat3:p.displayMat3;d.vvSizeMinMaxValue&&f.setUniform4fv("u_vvSizeMinMaxValue",m.vvSizeMinMaxValue);d.vvSizeScaleStops&&f.setUniform1f("u_vvSizeScaleStopsValue",m.vvSizeScaleStopsValue);
d.vvSizeFieldStops&&(c=m.getSizeVVFieldStops(c.key.level),f.setUniform1fv("u_vvSizeFieldStopsValues",c.values),f.setUniform1fv("u_vvSizeFieldStopsSizes",c.sizes));d.vvSizeUnitValue&&f.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",m.vvSizeUnitValueToPixelsRatio);f.setUniform1f("u_mapRotation",Math.floor(p.rotation/360*254));f.setUniform1f("u_mapAligned",u);f.setUniformMatrix3fv("u_displayMat3",l);f.setUniform1f("u_opacity",1);f.setUniform1f("u_zoomLevel",Math.round(10*b.displayLevel));f.setUniform2fv("u_screenSize",
b.state.size);f.setUniform1f("u_isHalo",1);g.drawElements(4,h,5125,4*n);f.setUniform1f("u_isHalo",0);g.drawElements(4,h,5125,4*n);g.bindVAO(null);g.setStencilTestEnabled(!0);g.setBlendingEnabled(!0)}};return c}(n.default);c.default=b})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLine":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../webgl ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),function(b,c,e,g,f,a,n,k){Object.defineProperty(c,
"__esModule",{value:!0});b=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}e(c,b);c.prototype.dispose=function(){};c.prototype.getGeometryType=function(){return f.WGLGeometryType.LINE};c.prototype.drawGeometry=function(b,c,d,e,f){var g=b.context,l=b.painter,p=b.rendererInfo,m=b.requiredLevel,h=d.indexFrom,n=d.indexCount;d=k.LineMaterialKey.load(d.materialKey);var u=a.createProgramDescriptor(d.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",
count:4,type:5121},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_offsetAndNormal",count:4,type:5120},{location:4,name:"a_accumulatedDistanceAndHalfWidth",count:2,type:5123},{location:5,name:"a_tlbr",count:4,type:5123},{location:6,name:"a_segmentDirection",count:4,type:5120},{location:7,name:"a_aux",count:2,type:5123}]}),w=u.bufferLayouts,u=u.attributes;f=l.materialManager.getMaterialProgram(b,d,"materials/line",u,f);e=this._getVAO(g,w,u,e);w=1/b.pixelRatio;g.bindProgram(f);
g.bindVAO(e);this._setSharedUniforms(f,b,c);d.textureBinding&&l.textureManager.bindTextures(g,f,d);f.setUniform1f("u_zoomFactor",Math.pow(2,m-c.key.level)/b.pixelRatio);f.setUniform1f("u_blur",0+w);f.setUniform1f("u_antialiasing",w);d.vvSizeMinMaxValue&&f.setUniform4fv("u_vvSizeMinMaxValue",p.vvSizeMinMaxValue);d.vvSizeScaleStops&&f.setUniform1f("u_vvSizeScaleStopsValue",p.vvSizeScaleStopsValue);d.vvSizeFieldStops&&(b=p.getSizeVVFieldStops(c.key.level),f.setUniform1fv("u_vvSizeFieldStopsValues",b.values),
f.setUniform1fv("u_vvSizeFieldStopsSizes",b.sizes));d.vvSizeUnitValue&&f.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",p.vvSizeUnitValueToPixelsRatio);d.vvColor&&(f.setUniform1fv("u_vvColorValues",p.vvColorValues),f.setUniform4fv("u_vvColors",p.vvColors));d.vvOpacity&&(f.setUniform1fv("u_vvOpacityValues",p.vvOpacityValues),f.setUniform1fv("u_vvOpacities",p.vvOpacities));g.setFaceCullingEnabled(!0);g.setFrontFace(2305);g.setCullFace(1029);g.drawElements(4,n,5125,4*h);g.setFaceCullingEnabled(!1);
g.bindVAO(null)};return c}(n.default);c.default=b})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushMarker":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/tsSupport/assignHelper ../../../../webgl ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),function(b,c,e,g,f,a,n,k,d){Object.defineProperty(c,"__esModule",{value:!0});b=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}e(c,b);c.prototype.dispose=
function(){};c.prototype.getGeometryType=function(){return a.WGLGeometryType.MARKER};c.prototype.drawGeometry=function(a,b,c,e,f){var g=a.context,l=a.painter,k=a.rendererInfo,h=a.state,m=c.indexCount,u=c.indexFrom;c=d.MarkerMaterialKey.load(c.materialKey);var q=n.createProgramDescriptor(c.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_vertexOffset",count:2,type:5122},{location:2,name:"a_texCoords",count:2,type:5123},{location:3,name:"a_bitSetAndDistRatio",count:4,
type:5121},{location:4,name:"a_id",count:4,type:5121},{location:5,name:"a_color",count:4,type:5121,normalized:!0},{location:6,name:"a_outlineColor",count:4,type:5121,normalized:!0},{location:7,name:"a_sizeAndOutlineWidth",count:4,type:5121}]}),w=q.bufferLayouts,q=q.attributes;f=l.materialManager.getMaterialProgram(a,c,"materials/icon",q,f);e=this._getVAO(g,w,q,e);g.bindProgram(f);g.bindVAO(e);c.textureBinding&&l.textureManager.bindTextures(g,f,c);this._setSharedUniforms(f,a,b);f.setUniformMatrix3fv("u_displayMat3",
c.vvRotation?h.displayViewMat3:h.displayMat3);c.vvSizeMinMaxValue&&f.setUniform4fv("u_vvSizeMinMaxValue",k.vvSizeMinMaxValue);c.vvSizeScaleStops&&f.setUniform1f("u_vvSizeScaleStopsValue",k.vvSizeScaleStopsValue);c.vvSizeFieldStops&&(a=k.getSizeVVFieldStops(b.key.level),f.setUniform1fv("u_vvSizeFieldStopsValues",a.values),f.setUniform1fv("u_vvSizeFieldStopsSizes",a.sizes));c.vvSizeUnitValue&&f.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",k.vvSizeUnitValueToPixelsRatio);c.vvColor&&(f.setUniform1fv("u_vvColorValues",
k.vvColorValues),f.setUniform4fv("u_vvColors",k.vvColors));c.vvOpacity&&(f.setUniform1fv("u_vvOpacityValues",k.vvOpacityValues),f.setUniform1fv("u_vvOpacities",k.vvOpacities));c.vvRotation&&f.setUniform1f("u_vvRotationType","geographic"===k.vvMaterialParameters.vvRotationType?0:1);g.drawElements(4,m,5125,4*u);g.bindVAO(null)};return c}(k.default);c.default=b})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushText":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../webgl ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),
function(b,c,e,g,f,a,n,k){Object.defineProperty(c,"__esModule",{value:!0});b=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}e(c,b);c.prototype.dispose=function(){};c.prototype.getGeometryType=function(){return f.WGLGeometryType.TEXT};c.prototype.drawGeometry=function(b,c,d,e,f){var g=b.context,l=b.painter,p=b.rendererInfo,m=b.state,h=d.indexCount,n=d.indexFrom;d=k.TextMaterialKey.load(d.materialKey);var u=a.createProgramDescriptor(d.data,{geometry:[{location:0,name:"a_pos",
count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_haloColor",count:4,type:5121,normalized:!0},{location:4,name:"a_texFontSize",count:4,type:5121},{location:5,name:"a_aux",count:4,type:5120},{location:6,name:"a_vertexOffset",count:2,type:5122},{location:7,name:"a_texCoords",count:2,type:5123}]}),w=u.bufferLayouts,u=u.attributes;f=l.materialManager.getMaterialProgram(b,d,"materials/text",u,f);e=this._getVAO(g,
w,u,e);g.bindProgram(f);g.bindVAO(e);this._setSharedUniforms(f,b,c);l.textureManager.bindTextures(g,f,d);f.setUniformMatrix3fv("u_displayMat3",m.displayMat3);d.vvSizeMinMaxValue&&f.setUniform4fv("u_vvSizeMinMaxValue",p.vvSizeMinMaxValue);d.vvSizeScaleStops&&f.setUniform1f("u_vvSizeScaleStopsValue",p.vvSizeScaleStopsValue);d.vvSizeFieldStops&&(b=p.getSizeVVFieldStops(c.key.level),f.setUniform1fv("u_vvSizeFieldStopsValues",b.values),f.setUniform1fv("u_vvSizeFieldStopsSizes",b.sizes));d.vvSizeUnitValue&&
f.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",p.vvSizeUnitValueToPixelsRatio);d.vvColor&&(f.setUniform1fv("u_vvColorValues",p.vvColorValues),f.setUniform4fv("u_vvColors",p.vvColors));d.vvOpacity&&(f.setUniform1fv("u_vvOpacityValues",p.vvOpacityValues),f.setUniform1fv("u_vvOpacities",p.vvOpacities));d.vvRotation&&f.setUniform1f("u_vvRotationType","geographic"===p.vvMaterialParameters.vvRotationType?0:1);f.setUniform1f("u_isHalo",1);g.drawElements(4,h,5125,4*n);f.setUniform1f("u_isHalo",0);g.drawElements(4,
h,5125,4*n);g.bindVAO(null)};return c}(n.default);c.default=b})},"esri/views/2d/engine/webgl/mesh/templates/shapingUtils":function(){define("require exports ../../../../../../core/libs/gl-matrix-2/mat2d ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../../../../../core/libs/gl-matrix-2/vec2 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../.. ../../alignmentUtils ../../number ../../collisions/BoundingBox".split(" "),function(b,c,e,g,f,a,n,k,d,l){Object.defineProperty(c,"__esModule",{value:!0});
var t=function(){function a(a,b,c,d){this._rotationT=g.mat2df32.create();this.minZoom=this._yBounds=this._xBounds=0;this.maxZoom=255;var e=c.rect,f=new Float32Array(8);a*=d;b*=d;var l=c.code?e.width*d:c.metrics.width,k=c.code?e.height*d:c.metrics.height;f[0]=a;f[1]=b;f[2]=a+l;f[3]=b;f[4]=a;f[5]=b+k;f[6]=a+l;f[7]=b+k;this._data=f;this._setTextureCoords(e);this._scale=d;this._mosaic=c;this.x=a;this.y=b}Object.defineProperty(a.prototype,"width",{get:function(){return this._mosaic.metrics.width*this._scale},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"mosaic",{get:function(){return this._mosaic},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"angle",{get:function(){return this._angle},set:function(a){this._angle=a;e.mat2d.identity(this._rotationT);e.mat2d.rotate(this._rotationT,this._rotationT,-a);this._setOffsets(this._data)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"xTopLeft",{get:function(){return this._data[0]},enumerable:!0,configurable:!0});
Object.defineProperty(a.prototype,"yTopLeft",{get:function(){return this._data[1]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"xBottomRight",{get:function(){return this._data[6]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"yBottomRight",{get:function(){return this._data[7]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"texcoords",{get:function(){return this._texcoords},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"textureBinding",{get:function(){return this._mosaic.textureBinding},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"offsets",{get:function(){this._offsets||this._setOffsets(this._data);return this._offsets},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"char",{get:function(){return String.fromCharCode(this._mosaic.code)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"code",{get:function(){return this._mosaic.code},enumerable:!0,configurable:!0});
Object.defineProperty(a.prototype,"bounds",{get:function(){var a=this._mosaic.metrics,b=a.width*this._scale,c=Math.abs(a.height)*this._scale,a=new Float32Array(8);a[0]=this.x;a[1]=this.y;a[2]=this.x+b;a[3]=this.y;a[4]=this.x;a[5]=this.y+c;a[6]=this.x+b;a[7]=this.y+c;b=e.mat2d.multiply(g.mat2df32.create(),this._rotationT,this._T);g.mat2df32.transformMany(a,a,b);for(var c=b=Infinity,d=0,f=0,k=0;4>k;k++)var u=a[2*k],m=a[2*k+1],b=Math.min(b,u),c=Math.min(c,m),d=Math.max(d,u),f=Math.max(f,m);a=d-b;f-=
c;return new l.default(b+a/2,c+f/2,a,f)},enumerable:!0,configurable:!0});a.prototype.setTransform=function(a){this._T=a;this._offsets=null};a.prototype._setOffsets=function(a){this._offsets||(this._offsets={upperLeft:0,upperRight:0,lowerLeft:0,lowerRight:0});var b=this._offsets,c=new Float32Array(8),f=e.mat2d.multiply(g.mat2df32.create(),this._rotationT,this._T);g.mat2df32.transformMany(c,a,f);b.upperLeft=d.i1616to32(8*c[0],8*c[1]);b.upperRight=d.i1616to32(8*c[2],8*c[3]);b.lowerLeft=d.i1616to32(8*
c[4],8*c[5]);b.lowerRight=d.i1616to32(8*c[6],8*c[7])};a.prototype._setTextureCoords=function(a){var b=a.x,c=a.y,e=a.width;a=a.height;this._texcoords={upperLeft:d.i1616to32(b,c),upperRight:d.i1616to32(b+e,c),lowerLeft:d.i1616to32(b,c+a),lowerRight:d.i1616to32(b+e,c+a)}};return a}();c.ShapedGlyph=t;var x=function(a,b){return{code:0,page:0,sdf:!0,rect:new n.Rect(0,0,11,8),textureBinding:b,metrics:{advance:0,height:4,width:a,left:0,top:0}}},w=function(){function b(a,b,c){this._decorate(a,b,c);this.glyphs=
a;this.bounds=this._createBounds(a);this.isMultiline=1<b.length;this._hasRotation=0!==c.angle;this._T=this._createGlyphTransform(this.bounds,c);for(b=0;b<a.length;b++)a[b].setTransform(this._T)}b.prototype._decorate=function(a,b,c){if("none"!==c.decoration&&a.length){var d=c.scale;c="underline"===c.decoration?30:20;for(var e=a[0].textureBinding,f=0;f<b.length;f++){var g=b[f];a.push(new t(g.startX*d,g.startY*d+c*d,x((g.width+g.glyphWidthEnd)*d,e),1))}}};Object.defineProperty(b.prototype,"boundsT",
{get:function(){var b=this.bounds,c=f.vec2.set(a.vec2f32.create(),b.x,b.y);f.vec2.transformMat2d(c,c,this._T);return this._hasRotation?(b=Math.max(b.width,b.height),new l.default(c[0],c[1],b,b)):new l.default(c[0],c[1],b.width,b.height)},enumerable:!0,configurable:!0});b.prototype._createBounds=function(a){for(var b=Infinity,c=Infinity,d=0,e=0,f=0;f<a.length;f++)var g=a[f],b=Math.min(b,g.xTopLeft),c=Math.min(c,g.yTopLeft),d=Math.max(d,g.xTopLeft+g.width),e=Math.max(e,g.yBottomRight);a=d-b;e-=c;return new l.default(b+
a/2,c+e/2,a,e)};b.prototype._createGlyphTransform=function(b,c){var d=c.angle*Math.PI/180,l=g.mat2df32.create(),h=a.vec2f32.create();e.mat2d.translate(l,l,f.vec2.set(h,c.xOffset,-c.yOffset));c.isCIM?e.mat2d.rotate(l,l,d):(e.mat2d.translate(l,l,f.vec2.set(h,b.x,b.y)),e.mat2d.rotate(l,l,d),e.mat2d.translate(l,l,f.vec2.set(h,-b.x,-b.y)));return l};return b}();c.ShapingInfo=w;var m=function(){return function(a,b,c,d,e,f){this.startY=this.startX=this.glyphWidthEnd=0;this.start=Math.max(0,Math.min(b,c));
this.end=Math.max(0,Math.max(b,c));this.end<a.length&&(this.glyphWidthEnd=a[this.end].metrics.width);this.width=d;this.yMin=e;this.yMax=f}}();c.shapeGlyphs=function(a,b,c){var d=c.scale,e=[],f=[],g=1/c.scale*c.maxLineWidth,l=b?a.length-1:0,n=b?-1:a.length;b=b?-1:1;for(var q=l,v=0,A=0,x=q,z=x,H=0,F=Infinity,L=0;q!==n;){var J=a[q],G=J.code,J=J.metrics,N=Math.abs(J.top);10!==G&&32!==G&&(F=Math.min(F,N),L=Math.max(L,N+J.height));10===G?(q!==l&&(f.push(new m(a,x,q-b,v,F,L)),F=Infinity,L=0),v=0,x=q+b,z=
q+b,A=0):32===G?(z=q+b,A=0,H=J.advance,v+=J.advance):(v>g&&(z!==x?(G=z-2*b,v-=H,f.push(new m(a,x,G,v-A,F,L)),F=Infinity,L=0,x=z,v=A):(f.push(new m(a,x,q-b,v,F,L)),F=Infinity,L=0,z=x=q,v=0)),v+=J.advance,A+=J.advance);q+=b}g=new m(a,x,q-b,v,F,L);0<=g.start&&g.end<a.length&&f.push(g);for(g=0;g<f.length;g++);l=f[0].yMin;n=c.vAlign;g=c.hAlign;b=n===k.VAlign.Baseline?1:0;l=(1-b)*-l+(f[f.length-1].yMax+c.lineHeight*(f.length-1)+("underline"===c.decoration?4:0)-l)/2*(b?0:n-1)+-26*(b?1:0);for(n=0;n<f.length;n++)for(q=
f[n],A=q.start,b=q.end,q=q.width/2*(g+1)*-1-3,v=n*c.lineHeight+l-3,f[n].startX=q,f[n].startY=v;A<=b;A++)x=a[A],10!==x.code&&(z=new t(q+x.metrics.left,v-x.metrics.top,x,d),q+=x.metrics.advance,e.push(z));return new w(e,f,c)}})},"esri/views/2d/engine/webgl/TileClipper":function(){define(["require","exports","./definitions","./Geometry","./GeometryUtils"],function(b,c,e,g,f){Object.defineProperty(c,"__esModule",{value:!0});var a=function(){return function(a,b,c){this.ratio=a;this.x=b;this.y=c}}();b=
function(){function b(a,b,c,f,g){void 0===f&&(f=8);void 0===g&&(g=8);this.lines=[];this.starts=[];this.pixelRatio=f;this.pixelMargin=g;this.tileSize=e.TILE_SIZE*f;this.dz=a;this.yPos=b;this.xPos=c}b.prototype.setExtent=function(a){this.finalRatio=this.tileSize/a*(1<<this.dz);var b=this.pixelRatio*this.pixelMargin,b=b/this.finalRatio;a>>=this.dz;b>a&&(b=a);this.margin=b;this.xmin=a*this.xPos-b;this.ymin=a*this.yPos-b;this.xmax=this.xmin+a+2*b;this.ymax=this.ymin+a+2*b};b.prototype.reset=function(a){this.type=
a;this.lines=[];this.starts=[];this.line=null;this.start=0};b.prototype.moveTo=function(a,b){this._pushLine();this._prevIsIn=this._isIn(a,b);this._moveTo(a,b,this._prevIsIn);this._prevPt=new g.Point(a,b);this._firstPt=new g.Point(a,b);this._dist=0};b.prototype.lineTo=function(b,c){var d=this._isIn(b,c),e=new g.Point(b,c),f=g.Point.distance(this._prevPt,e),l,k,n;if(d)this._prevIsIn?this._lineTo(b,c,!0):(l=this._prevPt,k=e,b=this._intersect(k,l),this.start=this._dist+f*(1-this._r),this._lineTo(b.x,
b.y,!0),this._lineTo(k.x,k.y,!0));else if(this._prevIsIn)k=this._prevPt,l=e,b=this._intersect(k,l),this._lineTo(b.x,b.y,!0),this._lineTo(l.x,l.y,!1);else{var v=this._prevPt;if(!(v.x<=this.xmin&&e.x<=this.xmin||v.x>=this.xmax&&e.x>=this.xmax||v.y<=this.ymin&&e.y<=this.ymin||v.y>=this.ymax&&e.y>=this.ymax)){b=[];if(v.x<this.xmin&&e.x>this.xmin||v.x>this.xmin&&e.x<this.xmin)c=(this.xmin-v.x)/(e.x-v.x),n=v.y+c*(e.y-v.y),n<=this.ymin?k=!1:n>=this.ymax?k=!0:b.push(new a(c,this.xmin,n));if(v.x<this.xmax&&
e.x>this.xmax||v.x>this.xmax&&e.x<this.xmax)c=(this.xmax-v.x)/(e.x-v.x),n=v.y+c*(e.y-v.y),n<=this.ymin?k=!1:n>=this.ymax?k=!0:b.push(new a(c,this.xmax,n));if(v.y<this.ymin&&e.y>this.ymin||v.y>this.ymin&&e.y<this.ymin)c=(this.ymin-v.y)/(e.y-v.y),n=v.x+c*(e.x-v.x),n<=this.xmin?l=!1:n>=this.xmax?l=!0:b.push(new a(c,n,this.ymin));if(v.y<this.ymax&&e.y>this.ymax||v.y>this.ymax&&e.y<this.ymax)c=(this.ymax-v.y)/(e.y-v.y),n=v.x+c*(e.x-v.x),n<=this.xmin?l=!1:n>=this.xmax?l=!0:b.push(new a(c,n,this.ymax));
if(0===b.length)l?k?this._lineTo(this.xmax,this.ymax,!0):this._lineTo(this.xmax,this.ymin,!0):k?this._lineTo(this.xmin,this.ymax,!0):this._lineTo(this.xmin,this.ymin,!0);else if(1<b.length&&b[0].ratio>b[1].ratio)this.start=this._dist+f*b[1].ratio,this._lineTo(b[1].x,b[1].y,!0),this._lineTo(b[0].x,b[0].y,!0);else for(this.start=this._dist+f*b[0].ratio,l=0;l<b.length;l++)this._lineTo(b[l].x,b[l].y,!0)}this._lineTo(e.x,e.y,!1)}this._dist+=f;this._prevIsIn=d;this._prevPt=e};b.prototype.close=function(){if(2<
this.line.length){var a=this._firstPt,b=this._prevPt;a.x===b.x&&a.y===b.y||this.lineTo(a.x,a.y);a=this.line;for(b=a.length;4<=b;)if(a[0].x===a[1].x&&a[0].x===a[b-2].x||a[0].y===a[1].y&&a[0].y===a[b-2].y)a.pop(),a[0].x=a[b-2].x,a[0].y=a[b-2].y,--b;else break}};b.prototype.result=function(a){void 0===a&&(a=!0);this._pushLine();if(0===this.lines.length)return null;3===this.type&&a&&n.simplify(this.tileSize,this.margin*this.finalRatio,this.lines);return this.lines};b.prototype.resultWithStarts=function(){if(2!==
this.type)throw Error("Only valid for lines");this._pushLine();var a=this.lines,b=a.length;if(0===b)return null;for(var c=[],e=0;e<b;e++)c.push({line:a[e],start:this.starts[e]||0});return c};b.prototype._isIn=function(a,b){return a>=this.xmin&&a<=this.xmax&&b>=this.ymin&&b<=this.ymax};b.prototype._intersect=function(a,b){var c,d,e;if(b.x>=this.xmin&&b.x<=this.xmax)d=b.y<=this.ymin?this.ymin:this.ymax,e=(d-a.y)/(b.y-a.y),c=a.x+e*(b.x-a.x);else if(b.y>=this.ymin&&b.y<=this.ymax)c=b.x<=this.xmin?this.xmin:
this.xmax,e=(c-a.x)/(b.x-a.x),d=a.y+e*(b.y-a.y);else{d=b.y<=this.ymin?this.ymin:this.ymax;c=b.x<=this.xmin?this.xmin:this.xmax;var f=(c-a.x)/(b.x-a.x),k=(d-a.y)/(b.y-a.y);f<k?(e=f,d=a.y+f*(b.y-a.y)):(e=k,c=a.x+k*(b.x-a.x))}this._r=e;return new g.Point(c,d)};b.prototype._pushLine=function(){this.line&&(1===this.type?0<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)):2===this.type?1<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)):3===this.type&&
3<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)));this.line=[];this.start=0};b.prototype._moveTo=function(a,b,c){3!==this.type?c&&(a=Math.round((a-(this.xmin+this.margin))*this.finalRatio),b=Math.round((b-(this.ymin+this.margin))*this.finalRatio),this.line.push(new g.Point(a,b))):(c||(a<this.xmin&&(a=this.xmin),a>this.xmax&&(a=this.xmax),b<this.ymin&&(b=this.ymin),b>this.ymax&&(b=this.ymax)),a=Math.round((a-(this.xmin+this.margin))*this.finalRatio),b=Math.round((b-(this.ymin+
this.margin))*this.finalRatio),this.line.push(new g.Point(a,b)),this._is_v=this._is_h=!1)};b.prototype._lineTo=function(a,b,c){if(3!==this.type)if(c){a=Math.round((a-(this.xmin+this.margin))*this.finalRatio);b=Math.round((b-(this.ymin+this.margin))*this.finalRatio);if(0<this.line.length&&(c=this.line[this.line.length-1],c.equals(a,b)))return;this.line.push(new g.Point(a,b))}else this.line&&0<this.line.length&&this._pushLine();else if(c||(a<this.xmin&&(a=this.xmin),a>this.xmax&&(a=this.xmax),b<this.ymin&&
(b=this.ymin),b>this.ymax&&(b=this.ymax)),a=Math.round((a-(this.xmin+this.margin))*this.finalRatio),b=Math.round((b-(this.ymin+this.margin))*this.finalRatio),this.line&&0<this.line.length){c=this.line[this.line.length-1];var d=c.x===a,e=c.y===b;d&&e||(this._is_h&&d?(c.x=a,c.y=b,c=this.line[this.line.length-2],c.x===a&&c.y===b?(this.line.pop(),1>=this.line.length?this._is_v=this._is_h=!1:(c=this.line[this.line.length-2],this._is_h=c.x===a,this._is_v=c.y===b)):(this._is_h=c.x===a,this._is_v=c.y===b)):
this._is_v&&e?(c.x=a,c.y=b,c=this.line[this.line.length-2],c.x===a&&c.y===b?(this.line.pop(),1>=this.line.length?this._is_v=this._is_h=!1:(c=this.line[this.line.length-2],this._is_h=c.x===a,this._is_v=c.y===b)):(this._is_h=c.x===a,this._is_v=c.y===b)):(this.line.push(new g.Point(a,b)),this._is_h=d,this._is_v=e))}else this.line.push(new g.Point(a,b))};return b}();c.TileClipper=b;b=function(){function a(){}a.prototype.setExtent=function(a){this._ratio=4096===a?1:4096/a};a.prototype.reset=function(a){this.type=
a;this.lines=[];this.line=null};a.prototype.moveTo=function(a,b){this.line&&this.lines.push(this.line);this.line=[];var c=this._ratio;this.line.push(new g.Point(Math.round(a*c),Math.round(b*c)))};a.prototype.lineTo=function(a,b){var c=this._ratio;this.line.push(new g.Point(Math.round(a*c),Math.round(b*c)))};a.prototype.close=function(){var a=this.line;a&&!a[0].isEqual(a[a.length-1])&&a.push(a[0])};a.prototype.result=function(){this.line&&this.lines.push(this.line);if(0===this.lines.length)return null;
3===this.type&&1!==this._ratio&&n.simplify(4096,64,this.lines);return this.lines};return a}();c.SimpleBuilder=b;var n=function(){function a(){}a.simplify=function(b,c,e){if(e){var d=-c,f=b+c,g=-c,k=b+c;b=[];c=[];for(var l=e.length,n=0;n<l;++n){var p=e[n];if(p&&!(2>p.length))for(var r=p[0],h=void 0,y=p.length,u=1;u<y;++u)h=p[u],r.x===h.x&&(r.x<=d&&(r.y>h.y?(b.push(n),b.push(u),b.push(0),b.push(-1)):(c.push(n),c.push(u),c.push(0),c.push(-1))),r.x>=f&&(r.y<h.y?(b.push(n),b.push(u),b.push(1),b.push(-1)):
(c.push(n),c.push(u),c.push(1),c.push(-1)))),r.y===h.y&&(r.y<=g&&(r.x<h.x?(b.push(n),b.push(u),b.push(2),b.push(-1)):(c.push(n),c.push(u),c.push(2),c.push(-1))),r.y>=k&&(r.x>h.x?(b.push(n),b.push(u),b.push(3),b.push(-1)):(c.push(n),c.push(u),c.push(3),c.push(-1)))),r=h}0!==b.length&&0!==c.length&&(a.fillParent(e,c,b),a.fillParent(e,b,c),d=[],a.calcDeltas(d,c,b),a.calcDeltas(d,b,c),a.addDeltas(d,e))}};a.fillParent=function(a,b,c){for(var d=c.length,e=b.length,g=0;g<e;g+=4){for(var k=b[g],l=b[g+1],
n=b[g+2],p=a[k][l-1],k=a[k][l],l=8092,r=-1,h=0;h<d;h+=4)if(c[h+2]===n){var y=c[h],u=c[h+1],t=a[y][u-1],y=a[y][u];switch(n){case 0:case 1:f.between(p.y,t.y,y.y)&&f.between(k.y,t.y,y.y)&&(t=Math.abs(y.y-t.y),t<l&&(l=t,r=h));break;case 2:case 3:f.between(p.x,t.x,y.x)&&f.between(k.x,t.x,y.x)&&(t=Math.abs(y.x-t.x),t<l&&(l=t,r=h))}}b[g+3]=r}};a.calcDeltas=function(b,c,e){for(var d=c.length,f=0;f<d;f+=4){var g=a.calcDelta(f,c,e,[]);b.push(c[f]);b.push(c[f+1]);b.push(c[f+2]);b.push(g)}};a.calcDelta=function(b,
c,e,f){b=c[b+3];if(-1===b)return 0;var d=f.length;if(1<d&&f[d-2]===b)return 0;f.push(b);return a.calcDelta(b,e,c,f)+1};a.addDeltas=function(a,b){for(var c=a.length,d=0,e=0;e<c;e+=4){var f=a[e+3];f>d&&(d=f)}for(e=0;e<c;e+=4){var g=b[a[e]],k=a[e+1],f=d-a[e+3];switch(a[e+2]){case 0:g[k-1].x-=f;g[k].x-=f;1===k&&(g[g.length-1].x-=f);k===g.length-1&&(g[0].x-=f);break;case 1:g[k-1].x+=f;g[k].x+=f;1===k&&(g[g.length-1].x+=f);k===g.length-1&&(g[0].x+=f);break;case 2:g[k-1].y-=f;g[k].y-=f;1===k&&(g[g.length-
1].y-=f);k===g.length-1&&(g[0].y-=f);break;case 3:g[k-1].y+=f,g[k].y+=f,1===k&&(g[g.length-1].y+=f),k===g.length-1&&(g[0].y+=f)}}};return a}()})},"esri/views/2d/engine/webgl/TurboLine":function(){define(["require","exports","../../../../symbols/cim/enums","./mesh/templates/util"],function(b,c,e,g){function f(){if(h.cosine<x.innerBisectorAutoSplitThreshold){h.splitInner=!0;h.gapInner=!0;var a=Math.max(x.innerBisectorAutoSplitThreshold,h.cosine),a=Math.sqrt(1-a*a)/a;h.leftInner.x=h.nextNormal.x+h.sign*
a*h.outbound.x;h.leftInner.y=h.nextNormal.y+h.sign*a*h.outbound.y;h.rightInner.x=h.prevNormal.x-h.sign*a*h.inbound.x;h.rightInner.y=h.prevNormal.y-h.sign*a*h.inbound.y}else x.enableInnerBisectorSplit&&(h.splitInner=!0,h.gapInner=!1,h.leftInner.x=h.rightInner.x=h.bisector.x/h.cosine,h.leftInner.y=h.rightInner.y=h.bisector.y/h.cosine);h.cosine<x.outerBisectorAutoSplitThreshold?(h.splitOuter=!0,h.gapOuter=!0,a=Math.max(x.outerBisectorAutoSplitThreshold,h.cosine),a=Math.sqrt(1-a*a)/a,h.leftOuter.x=h.prevNormal.x-
h.sign*a*h.inbound.x,h.leftOuter.y=h.prevNormal.y-h.sign*a*h.inbound.y,h.rightOuter.x=h.nextNormal.x+h.sign*a*h.outbound.x,h.rightOuter.y=h.nextNormal.y+h.sign*a*h.outbound.y):x.enableOuterBisectorSplit&&(h.splitOuter=!0,h.gapOuter=!1,h.leftOuter.x=h.rightOuter.x=h.bisector.x/h.cosine,h.leftOuter.y=h.rightOuter.y=h.bisector.y/h.cosine)}function a(){if(v)h.distance=0,v=h.isCap=h.isFirstVertex=h.isLastVertex=!1;else{if(0===z)if(h.isFirstVertex=0===m,r=t[m],0===m){if(z=0,h.closed){h.inbound.x=r.x-t[t.length-
2].x;h.inbound.y=r.y-t[t.length-2].y;var a=Math.sqrt(h.inbound.x*h.inbound.x+h.inbound.y*h.inbound.y);h.inbound.x/=a;h.inbound.y/=a}}else h.inbound.x=r.x-p.x,h.inbound.y=r.y-p.y,z=Math.sqrt(h.inbound.x*h.inbound.x+h.inbound.y*h.inbound.y),h.inbound.x/=z,h.inbound.y/=z;h.distance+z-q<=x.wrapDistance?(m<t.length-1?(h.outbound.x=t[m+1].x-r.x,h.outbound.y=t[m+1].y-r.y,a=Math.sqrt(h.outbound.x*h.outbound.x+h.outbound.y*h.outbound.y),h.outbound.x/=a,h.outbound.y/=a):h.closed?(h.outbound.x=t[1].x-r.x,h.outbound.y=
t[1].y-r.y,a=Math.sqrt(h.outbound.x*h.outbound.x+h.outbound.y*h.outbound.y),h.outbound.x/=a,h.outbound.y/=a):(h.outbound.x=h.inbound.x,h.outbound.y=h.inbound.y),0!==m||h.closed||(h.inbound.x=h.outbound.x,h.inbound.y=h.outbound.y),++m,h.isLastVertex=m===t.length,h.isCap=!h.closed&&(h.isFirstVertex||h.isLastVertex),h.distance+=z-q,q=z=0,v=h.distance+z-q===x.wrapDistance,h.currentVertex.x=r.x,h.currentVertex.y=r.y,p=r,r=null):(h.outbound.x=h.inbound.x,h.outbound.y=h.inbound.y,q+=x.wrapDistance-h.distance,
h.distance=x.wrapDistance,v=!0,a=q/z,h.currentVertex.x=(1-a)*p.x+a*r.x,h.currentVertex.y=(1-a)*p.y+a*r.y)}}function n(){h.prevNormal.x=-h.inbound.y;h.prevNormal.y=h.inbound.x;h.nextNormal.x=-h.outbound.y;h.nextNormal.y=h.outbound.x}function k(){n();h.bisector.x=h.prevNormal.x+h.nextNormal.x;h.bisector.y=h.prevNormal.y+h.nextNormal.y;var a=Math.sqrt(h.bisector.x*h.bisector.x+h.bisector.y*h.bisector.y);.001>a?(h.bisector.x=void 0,h.bisector.y=void 0,h.cosine=0,h.sign=void 0):(h.bisector.x/=a,h.bisector.y/=
a,h.cosine=h.bisector.x*h.nextNormal.x+h.bisector.y*h.nextNormal.y,h.sign=0<=h.prevNormal.x*h.nextNormal.y-h.prevNormal.y*h.nextNormal.x?1:-1)}function d(a){w.vertex(h);1===a?(h.leftEntry0=h.entry0,h.leftEntry1=h.entry1,h.leftEntry2=h.entry2,h.leftExit0=h.exit0,h.leftExit1=h.exit1,h.leftExit2=h.exit2):2===a&&(h.rightEntry0=h.entry0,h.rightEntry1=h.entry1,h.rightEntry2=h.entry2,h.rightExit0=h.exit0,h.rightExit1=h.exit1,h.rightExit2=h.exit2)}function l(a){w.vertex(h);1===a?(h.leftEntry0=h.entry0,h.leftEntry2=
h.entry2,h.leftExit0=h.exit0,h.leftExit2=h.exit2):2===a&&(h.rightEntry0=h.entry0,h.rightEntry2=h.entry2,h.rightExit0=h.exit0,h.rightExit2=h.exit2)}Object.defineProperty(c,"__esModule",{value:!0});b=function(){return function(){this.isCap=this.isLastVertex=this.isFirstVertex=this.closed=void 0;this.currentVertex={x:void 0,y:void 0};this.inbound={x:void 0,y:void 0};this.outbound={x:void 0,y:void 0};this.prevNormal={x:void 0,y:void 0};this.nextNormal={x:void 0,y:void 0};this.bisector={x:void 0,y:void 0};
this.leftInner={x:void 0,y:void 0};this.rightInner={x:void 0,y:void 0};this.leftOuter={x:void 0,y:void 0};this.rightOuter={x:void 0,y:void 0}}}();c.TessellationState=b;c.tessellate=function(b,c,e){x.trackDistance=null!=c.trackDistance?c.trackDistance:!1;x.wrapDistance=null!=c.wrapDistance?c.wrapDistance:65535;x.thin=null!=c.thin?c.thin:!1;x.initialDistance=null!=c.initialDistance?c.initialDistance:0;x.enableOuterBisectorSplit=null!=c.enableOuterBisectorSplit?c.enableOuterBisectorSplit:!1;x.outerBisectorAutoSplitThreshold=
null!=c.outerBisectorAutoSplitThreshold?c.outerBisectorAutoSplitThreshold:0;x.enableInnerBisectorSplit=null!=c.enableOuterBisectorSplit?c.enableOuterBisectorSplit:!1;x.innerBisectorAutoSplitThreshold=null!=c.innerBisectorAutoSplitThreshold?c.innerBisectorAutoSplitThreshold:0;t=b;w=e;q=z=m=0;v=!1;r=p=null;h.currentVertex.x=null;h.currentVertex.y=null;h.distance=x.initialDistance;b=t[0];c=t[t.length-1];h.canSplit=!1;h.closed=b.x===c.x&&b.y===c.y;if(!(2>t.length||2===t.length&&h.closed))if(x.thin)if(x.trackDistance)for(a(),
n(),l(1);z-q>x.wrapDistance||m<t.length;)a(),n(),l(2),w.bridge(h),h.leftExit0=h.rightExit0,h.leftExit2=h.rightExit2;else for(;m<t.length;)0<m&&(h.inbound.x=h.outbound.x,h.inbound.y=h.outbound.y),m<t.length-1?(h.outbound.x=t[m+1].x-t[m].x,h.outbound.y=t[m+1].y-t[m].y,b=Math.sqrt(h.outbound.x*h.outbound.x+h.outbound.y*h.outbound.y),h.distance+=b,h.outbound.x/=b,h.outbound.y/=b):(h.outbound.x=h.inbound.x,h.outbound.y=h.inbound.y),0===m&&(h.inbound.x=h.outbound.x,h.inbound.y=h.outbound.y),h.currentVertex.x=
t[m].x,h.currentVertex.y=t[m].y,h.prevNormal.x=-h.inbound.y,h.prevNormal.y=h.inbound.x,h.nextNormal.x=-h.outbound.y,h.nextNormal.y=h.outbound.x,0===m?(w.vertex(h),h.leftEntry0=h.entry0,h.leftEntry2=h.entry2,h.leftExit0=h.exit0,h.leftExit2=h.exit2):(w.vertex(h),h.rightEntry0=h.entry0,h.rightEntry2=h.entry2,h.rightExit0=h.exit0,h.rightExit2=h.exit2,w.bridge(h),h.leftExit0=h.rightExit0,h.leftExit2=h.rightExit2),++m;else{if(x.enableOuterBisectorSplit||0<x.outerBisectorAutoSplitThreshold||x.enableInnerBisectorSplit||
0<x.innerBisectorAutoSplitThreshold)for(h.canSplit=!0,a(),k(),h.splitInner=h.gapInner=h.splitOuter=h.gapOuter=!1,d(1),h.closure0=h.leftEntry0,h.closure1=h.leftEntry1,h.closure2=h.leftEntry2;z-q>x.wrapDistance||m<t.length-1||m<t.length&&(!h.closed||x.trackDistance);)a(),k(),h.splitInner=h.gapInner=h.splitOuter=h.gapOuter=!1,d(2),w.bridge(h),h.leftExit0=h.rightExit0,h.leftExit1=h.rightExit1,h.leftExit2=h.rightExit2;else for(a(),k(),d(1),h.closure0=h.leftEntry0,h.closure1=h.leftEntry1,h.closure2=h.leftEntry2;z-
q>x.wrapDistance||m<t.length-1||m<t.length&&(!h.closed||x.trackDistance);)a(),k(),d(2),w.bridge(h),h.leftExit0=h.rightExit0,h.leftExit1=h.rightExit1,h.leftExit2=h.rightExit2;h.closed&&!x.trackDistance&&(h.rightEntry0=h.closure0,h.rightEntry1=h.closure1,h.rightEntry2=h.closure2,w.bridge(h),h.leftExit0=h.rightExit0,h.leftExit1=h.rightExit1,h.leftExit2=h.rightExit2)}};c.cleanup=function(){w=t=null};c.splitVertex=f;var t,x={},w,m=void 0,z,q,v,p,r,h=new b;b=function(){function a(a,b){this.writeVertex=
a;this.writeTriangle=b;this.capType=e.CapType.BUTT;this.joinType=e.JoinType.MITER;this.miterLimitCosine=g.getLimitCosine(2);this.roundLimitCosine=Math.cos(23*Math.PI/180);this.almostParallelCosine=.97;this.radsPerSlice=.8;this.joinOnUTurn=this.textured=!1}a.prototype.vertex=function(a){var b=this.joinType===e.JoinType.MITER?this.miterLimitCosine:this.roundLimitCosine,c=a.isCap&&this.capType!==e.CapType.BUTT,d=!1;a.cosine>this.almostParallelCosine?(a.exit0=a.entry0=this.writeVertex(a.currentVertex.x,
a.currentVertex.y,0,0,a.bisector.x/a.cosine,a.bisector.y/a.cosine,0,-1,a.distance),a.exit2=a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.bisector.x/a.cosine,-a.bisector.y/a.cosine,0,1,a.distance)):a.cosine<1-this.almostParallelCosine?(d=!a.isCap&&this.joinOnUTurn,a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.prevNormal.x,a.prevNormal.y,0,-1,a.distance),a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.prevNormal.x,-a.prevNormal.y,0,1,
a.distance),a.exit0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.nextNormal.x,a.nextNormal.y,0,-1,a.distance),a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.nextNormal.x,-a.nextNormal.y,0,1,a.distance)):a.canSplit?(f(),0<a.sign?(a.splitInner?(a.exit0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.outbound.x,a.outbound.y,a.leftInner.x,a.leftInner.y,0,-1,a.distance),a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.inbound.x,a.inbound.y,a.rightInner.x,
a.rightInner.y,0,-1,a.distance)):a.exit0=a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.inbound.x,a.inbound.y,a.bisector.x/a.cosine,a.bisector.y/a.cosine,0,-1,a.distance),a.cosine<b?(d=!a.isCap,a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.prevNormal.x,-a.prevNormal.y,0,1,a.distance),a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.nextNormal.x,-a.nextNormal.y,0,1,a.distance)):a.splitOuter?(d=d||a.gapOuter,a.entry2=this.writeVertex(a.currentVertex.x,
a.currentVertex.y,a.inbound.x,a.inbound.y,-a.leftOuter.x,-a.leftOuter.y,0,1,a.distance),a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.outbound.x,a.outbound.y,-a.rightOuter.x,-a.rightOuter.y,0,1,a.distance)):a.entry2=a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.bisector.x/a.cosine,-a.bisector.y/a.cosine,0,1,a.distance)):(a.splitInner?(a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.outbound.x,a.outbound.y,-a.leftInner.x,-a.leftInner.y,0,1,a.distance),
a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.inbound.x,a.inbound.y,-a.rightInner.x,-a.rightInner.y,0,1,a.distance)):a.exit2=a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.bisector.x/a.cosine,-a.bisector.y/a.cosine,0,1,a.distance),a.cosine<b?(d=!a.isCap,a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.prevNormal.x,a.prevNormal.y,0,-1,a.distance),a.exit0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.nextNormal.x,a.nextNormal.y,
0,-1,a.distance)):a.splitOuter?(d=d||a.gapOuter,a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.inbound.x,a.inbound.y,a.leftOuter.x,a.leftOuter.y,0,-1,a.distance),a.exit0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.outbound.x,a.outbound.y,a.rightOuter.x,a.rightOuter.y,0,-1,a.distance)):a.exit0=a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.bisector.x/a.cosine,a.bisector.y/a.cosine,0,-1,a.distance))):0<a.sign?(a.exit0=a.entry0=this.writeVertex(a.currentVertex.x,
a.currentVertex.y,a.inbound.x,a.inbound.y,a.bisector.x/a.cosine,a.bisector.y/a.cosine,0,-1,a.distance),a.cosine<b?(d=!a.isCap,a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.prevNormal.x,-a.prevNormal.y,0,1,a.distance),a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.nextNormal.x,-a.nextNormal.y,0,1,a.distance)):a.entry2=a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.bisector.x/a.cosine,-a.bisector.y/a.cosine,0,1,a.distance)):(a.exit2=a.entry2=
this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.bisector.x/a.cosine,-a.bisector.y/a.cosine,0,1,a.distance),a.cosine<b?(d=!a.isCap,a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.prevNormal.x,a.prevNormal.y,0,-1,a.distance),a.exit0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.nextNormal.x,a.nextNormal.y,0,-1,a.distance)):a.exit0=a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.bisector.x/a.cosine,a.bisector.y/a.cosine,0,-1,a.distance));
b=a.canSplit&&(a.splitInner||a.splitOuter)||d||c?a.entry1=a.exit1=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,0,0,0,0,a.distance):a.entry1=a.exit1=null;if(d&&this.joinType!==e.JoinType.ROUND)this.writeTriangle(b,0<a.sign?a.exit2:a.entry0,0<a.sign?a.entry2:a.exit0);else if(c&&this.capType===e.CapType.ROUND||d&&this.joinType===e.JoinType.ROUND){var g=d=c=void 0,h=void 0,k=void 0,p=void 0;if(a.isCap){var l=Math.PI,k=Math.ceil(l/this.radsPerSlice),p=l/k;a.isFirstVertex?(c=a.prevNormal.x,
d=a.prevNormal.y,g=a.entry0,h=a.entry2):a.isLastVertex&&(c=-a.nextNormal.x,d=-a.nextNormal.y,g=a.exit2,h=a.exit0)}else l=2*Math.acos(a.cosine),k=Math.ceil(l/this.radsPerSlice),p=l/k,c=0<a.sign?-a.prevNormal.x:a.nextNormal.x,d=0<a.sign?-a.prevNormal.y:a.nextNormal.y,g=0<a.sign?a.entry2:a.exit0,h=0<a.sign?a.exit2:a.entry0;for(var l=Math.cos(p),p=Math.sin(p),m=p*c+l*d,c=l*c-p*d,d=m,n,m=void 0,r=0;r<k;++r)n=m,r<k-1&&(m=a.isCap?this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,c,d,a.isFirstVertex?
-1:1,0,a.distance):this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,c,d,0,a.sign,a.distance)),this.writeTriangle(0===r?g:n,b,r===k-1?h:m),n=p*c+l*d,c=l*c-p*d,d=n}else c&&this.capType===e.CapType.SQUARE&&(c=a.isFirstVertex?1:-1,g=d=void 0,this.textured?(d=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.prevNormal.x-c*a.inbound.x,a.prevNormal.y-c*a.inbound.y,-c,-1,a.distance),g=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.prevNormal.x-c*a.inbound.x,-a.prevNormal.y-
c*a.inbound.y,-c,1,a.distance)):(d=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.prevNormal.x-c*a.inbound.x,a.prevNormal.y-c*a.inbound.y,0,-1,a.distance),g=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.prevNormal.x-c*a.inbound.x,-a.prevNormal.y-c*a.inbound.y,0,1,a.distance)),0<c?(this.writeTriangle(b,a.entry2,g),this.writeTriangle(b,g,d),this.writeTriangle(b,d,a.entry0)):(this.writeTriangle(b,g,a.exit2),this.writeTriangle(b,d,g),this.writeTriangle(b,a.exit0,d)))};a.prototype.bridge=
function(a){this.writeTriangle(a.leftExit0,a.rightEntry0,null!=a.leftExit1?a.leftExit1:a.leftExit2);this.writeTriangle(a.rightEntry0,null!=a.rightEntry1?a.rightEntry1:a.rightEntry2,null!=a.leftExit1?a.leftExit1:a.leftExit2);null!=a.leftExit1&&null!=a.rightEntry1?(this.writeTriangle(a.leftExit1,a.rightEntry1,a.leftExit2),this.writeTriangle(a.rightEntry1,a.rightEntry2,a.leftExit2)):null!=a.leftExit1?this.writeTriangle(a.leftExit1,a.rightEntry2,a.leftExit2):null!=a.rightEntry1&&this.writeTriangle(a.rightEntry1,
a.rightEntry2,a.leftExit2)};return a}();c.StandardTessellationCallbacks=b;b=function(){function a(a,b){this.writeVertex=a;this.writeTriangle=b}a.prototype.vertex=function(a){a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.prevNormal.x,a.prevNormal.y,0,-1,a.distance);a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.prevNormal.x,-a.prevNormal.y,0,1,a.distance);a.exit0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.nextNormal.x,a.nextNormal.y,0,-1,
a.distance);a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.nextNormal.x,-a.nextNormal.y,0,1,a.distance)};a.prototype.bridge=function(a){this.writeTriangle(a.leftExit0,a.rightEntry0,a.leftExit2);this.writeTriangle(a.rightEntry0,a.rightEntry2,a.leftExit2)};return a}();c.ThinTessellationCallbacks=b})},"esri/views/2d/engine/webgl/mesh/factories/matcherUtils":function(){define("require exports ../../../../../../core/tsSupport/generatorHelper ../../../../../../core/tsSupport/awaiterHelper ../../../../../../core/Error ../../../../../../core/Logger ../../util/Matcher".split(" "),
function(b,c,e,g,f,a,n){Object.defineProperty(c,"__esModule",{value:!0});var k=a.getLogger("esri/views/2d/engine/webgl/mesh/factories/matcherUtils");c.createMatcher=function(a,b,c){return g(this,void 0,void 0,function(){return e(this,function(d){if(!c)return[2,new n.GraphicMatcher(a)];switch(c.type){case "simple":case "dot-density":return[2,n.FeatureMatcher.fromBasicRenderer(c,a,b)];case "unique-value":return[2,n.MapMatcher.fromUVRenderer(c,a,b)];case "class-breaks":return[2,n.IntervalMatcher.fromCBRenderer(c,
a,b)];case "dictionary":return[2,n.DictionaryMatcher.fromDictionaryRenderer(c,a,b)];default:return k.error(new f("mapview-mesh:invalid-renderer","Unable to handle unknown renderer type")),[2,null]}})})}})},"esri/views/2d/engine/webgl/util/Matcher":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/tsSupport/generatorHelper ../../../../../core/tsSupport/awaiterHelper ../../../../../core/tsSupport/assignHelper ../../../../../core/Error ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../support/arcadeOnDemand ../../../../../symbols/support/cimSymbolUtils ../../../arcade/utils".split(" "),
function(b,c,e,g,f,a,n,k,d,l,t,x,w){function m(a,b){return f(this,void 0,void 0,function(){var c,d;return g(this,function(e){switch(e.label){case 0:return c=a||1,"number"===typeof c?[2,function(a,b,d){return c}]:[4,t.createRendererExpression(c,b.spatialReference,b.fields)];case 1:return d=e.sent(),[2,function(a,c,e){return w.callWithFeature(d,a,{$view:e},b.geometryType,c)||1}]}})})}Object.defineProperty(c,"__esModule",{value:!0});var z=k.getLogger("esri/views/2d/engine/webgl/util/Matcher");b=function(){function a(){this._defaultResult=
null}a.fromBasicRenderer=function(b,c,d){return f(this,void 0,void 0,function(){var e,f,k;return g(this,function(g){switch(g.label){case 0:return[4,x.expandSymbols(b.getSymbols(),b,d)];case 1:return e=g.sent(),f=new a,e.length?[4,c.createTemplateGroup(e[0],null,b)]:[3,3];case 2:k=g.sent(),f.setDefault(k),g.label=3;case 3:return[2,f]}})})};a.prototype.size=function(){return 1};a.prototype.getDefault=function(){return this._defaultResult};a.prototype.setDefault=function(a){this._defaultResult=a};a.prototype.match=
function(a,b,c,d,e){return this.getDefault()};a.prototype.analyze=function(a,b,c,d,e){return f(this,void 0,void 0,function(){return g(this,function(a){return[2]})})};return a}();c.FeatureMatcher=b;k=function(a){function b(b,c,d,e){var f=a.call(this)||this;f._intervals=[];f._isMaxInclusive=c;e?f._getValue=w.callWithFeature.bind(null,e):b&&b.length?"function"===typeof b?(f._field=null,f._getValue=b):(f._field=b,f._normalizationInfo=d,f._getValue=f._getValueFromField.bind(f)):f._field=null;return f}
e(b,a);b.fromCBRenderer=function(a,c,d){return f(this,void 0,void 0,function(){var e,h,k,p,m,n,r,v,q,w,z,J,G,N=this;return g(this,function(u){switch(u.label){case 0:return e=a.isMaxInclusive,h=a.normalizationField,k=a.normalizationTotal,p=a.normalizationType,m=a.field,n={normalizationField:h,normalizationTotal:k,normalizationType:p},(q=r=a.valueExpression)?[4,t.createRendererExpression(r,d.spatialReference,d.fields)]:[3,2];case 1:q=u.sent(),u.label=2;case 2:return v=q,w=new b(m,e,n,v),[4,x.expandSymbol(a.backgroundFillSymbol,
a,d)];case 3:return z=u.sent(),[4,l.all(a.classBreakInfos.map(function(b){return f(N,void 0,void 0,function(){var e,f,h;return g(this,function(g){switch(g.label){case 0:return[4,x.expandSymbol(b.symbol,a,d)];case 1:return e=g.sent(),[4,c.createTemplateGroup(e,z,a)];case 2:return f=g.sent(),h={min:b.minValue,max:b.maxValue},w.add(h,f),[2]}})})}))];case 4:return u.sent(),[4,x.expandSymbol(a.defaultSymbol,a,d)];case 5:return(J=u.sent())?[4,c.createTemplateGroup(J,z,a)]:[3,7];case 6:G=u.sent(),w.setDefault(G),
u.label=7;case 7:return[2,w]}})})};b.prototype.add=function(a,b){this._intervals.push({interval:a,result:b});this._intervals.sort(function(a,b){return a.interval.min-b.interval.min})};b.prototype.size=function(){return a.prototype.size.call(this)+this._intervals.length};b.prototype.match=function(a,b,c,d,e){if(!this._getValue)return this.getDefault();a=this._getValue(b,{$view:e},c,d);if(!a&&(null===a||void 0===a||isNaN(a)))return this.getDefault();for(b=0;b<this._intervals.length;b++)if(d=this._intervals[b],
c=d.interval,d=d.result,e=this._isMaxInclusive?a<=c.max:a<c.max,a>=c.min&&e)return d;return this.getDefault()};b.prototype._needsNormalization=function(){var a=this._normalizationInfo;return a&&(a.normalizationField||a.normalizationTotal||a.normalizationType)};b.prototype._getValueFromField=function(a){var b=a.attributes[this._field];if(!this._needsNormalization())return b;var c=this._normalizationInfo,d=c.normalizationField,e=c.normalizationTotal,c=c.normalizationType;a=!!d&&a.attributes[d];if(c)switch(c){case "field":return(a||
void 0)&&b/a;case "log":return Math.log(b)*Math.LOG10E;case "percent-of-total":return b/e*100;default:z.error("Found unknown normalization type: "+c)}else z.error("Normalization is required, but no type was set!")};return b}(b);c.IntervalMatcher=k;k=function(a){function b(b,c,d){var e=a.call(this)||this;e._nullResult=null;e._resultsMap=new Map;d?e._getValue=w.callWithFeature.bind(null,d):b&&b.length?"function"===typeof b[0]?(e._fields=null,e._getValue=b[0]):(e._fields=b,e._seperator=c||"",e._getValue=
e._getValueFromFields.bind(e)):e._fields=null;return e}e(b,a);b.fromUVRenderer=function(a,c,d){return f(this,void 0,void 0,function(){var e,h,k,p,m,n,r,q,v,w,z=this;return g(this,function(u){switch(u.label){case 0:return e=a.uniqueValueInfos,h=a.fieldDelimiter,k=[a.field],p=a.valueExpression,a.field2&&k.push(a.field2),a.field3&&k.push(a.field3),[4,x.expandSymbol(a.backgroundFillSymbol,a,d)];case 1:return m=u.sent(),(r=p)?[4,t.createRendererExpression(p,d.spatialReference,d.fields)]:[3,3];case 2:r=
u.sent(),u.label=3;case 3:return n=r,q=new b(k,h,n),[4,l.all(e.map(function(b){return f(z,void 0,void 0,function(){var e,f;return g(this,function(g){switch(g.label){case 0:return[4,x.expandSymbol(b.symbol,a,d)];case 1:return e=g.sent(),[4,c.createTemplateGroup(e,m,a)];case 2:return f=g.sent(),"\x3cNull\x3e"===b.value?q.setNullResult(f):q.add(b.value,f),[2]}})})}))];case 4:return u.sent(),[4,x.expandSymbol(a.defaultSymbol,a,d)];case 5:return(v=u.sent())?[4,c.createTemplateGroup(a.defaultSymbol,m,a)]:
[3,7];case 6:w=u.sent(),q.setDefault(w),u.label=7;case 7:return[2,q]}})})};b.prototype.setNullResult=function(a){this._nullResult=a};b.prototype.add=function(a,b){this._resultsMap.set(a.toString(),b)};b.prototype.size=function(){return a.prototype.size.call(this)+this._resultsMap.size};b.prototype.match=function(a,b,c,d,e){if(!this._getValue)return this.getDefault();a=this._getValue(b,{$view:e},c,d);if(null!==this._nullResult&&(null==a||""===a||"\x3cNull\x3e"===a))return this._nullResult;if(!a&&null==
a)return this.getDefault();a=a.toString();return this._resultsMap.has(a)?this._resultsMap.get(a):this.getDefault()};b.prototype._getValueFromFields=function(a){for(var b=[],c=0,d=this._fields;c<d.length;c++)b.push(a.attributes[d[c]]);return b.join(this._seperator)};return b}(b);c.MapMatcher=k;k=function(b){function c(a,c,d,e){var f=b.call(this)||this;f._fidToAttributeHash=new Map;f._attributeHashToGroup=new Map;f._renderer=a;f._fieldMap=a.fieldMap;f._templates=c;f._info=d;f._scaleFn=e;return f}e(c,
b);c.fromDictionaryRenderer=function(a,b,d){return f(this,void 0,void 0,function(){var e;return g(this,function(f){switch(f.label){case 0:return a.fetchResources({spatialReference:d.spatialReference,fields:d.fields}),[4,m(a.scaleExpression,d)];case 1:return e=f.sent(),[2,new c(a,b,d,e)]}})})};c.prototype._analyzeFeature=function(b,c,d,e,k){return f(this,void 0,void 0,function(){var f,h,l,m,p,r,q,v,u,w,t,y;return g(this,function(g){switch(g.label){case 0:f=b.attributes[c];h=this._fidToAttributeHash.get(f);
l=this._hashAttributes(b);if(h===l)return[2];if(m=this._attributeHashToGroup.has(l))return[3,4];p=a({},e,{spatialReference:this._info.spatialReference,abortOptions:k,fields:this._info.fields});r=this._scaleFn(b,d,e);return[4,this._renderer.getSymbolAsync(b,p)];case 1:return q=g.sent(),[4,x.expandSymbol(q,this._renderer,this._info,k)];case 2:v=g.sent();if("expanded-cim"!==v.type)return z.error(new n("mapview-bad-type","Found unexpected type "+v.type+" in dictionary response")),[2];u=0;for(w=v.layers;u<
w.length;u++)t=w[u],t.scaleFactor=r,t.templateHash+="-"+r;return[4,this._templates.createTemplateGroup(v,null,this._renderer)];case 3:y=g.sent(),this._attributeHashToGroup.set(l,y),g.label=4;case 4:return this._fidToAttributeHash.set(f,l),[2]}})})};c.prototype.analyze=function(a,b,c,d,e){return f(this,void 0,void 0,function(){var f,h=this;return g(this,function(g){switch(g.label){case 0:return f=b.map(function(b){return h._analyzeFeature(b,a,c,d,e)}),[4,l.all(f)];case 1:return g.sent(),[2]}})})};
c.prototype.match=function(a,b){a=this._fidToAttributeHash.get(b.attributes[a]);return this._attributeHashToGroup.get(a)};c.prototype._hashAttributes=function(a){var b="",c;for(c in this._fieldMap)b+=". "+a.attributes[this._fieldMap[c]];return b};return c}(b);c.DictionaryMatcher=k;b=function(a){function b(b){var c=a.call(this)||this;c._templates=b;return c}e(b,a);b.prototype.match=function(a,b){return d.isNone(b.symbol)?0:b.groupId?b.groupId:this._templates.createTemplateGroup(b.symbol,null,null)};
return b}(b);c.GraphicMatcher=b})},"esri/views/2d/engine/webgl/mesh/factories/WGLMeshFactory":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/tsSupport/generatorHelper ../../../../../../core/tsSupport/awaiterHelper ../../../../../../core/Error ../../../../../../core/has ../../../../../../core/Logger ../../../../../../core/maybe ../../../../../../core/promiseUtils ../../../../../../geometry/support/jsonUtils ../../../../../../symbols/SimpleLineSymbol ../../definitions ../../enums ../../WGLDisplayObject ../MeshData ../VertexVector ../templates/WGLLabelTemplate ../templates/WGLLineTemplate ../templates/WGLMarkerTemplate ../templates/WGLTemplateStore".split(" "),
function(b,c,e,g,f,a,n,k,d,l,t,x,w,m,z,q,v,p,r,h,y){Object.defineProperty(c,"__esModule",{value:!0});var u=k.getLogger("esri.views.2d.engine.webgl.WGLMeshFactory"),D={esriGeometryPoint:"above-right above-center above-left center-center center-left center-right below-center below-left below-right".split(" "),esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along"],esriGeometryMultipoint:null,esriGeometryEnvelope:null};b=function(){function b(a,b,c,e,f,g){this._isDD=!1;this._labelsDebugTemplate=
null;this._isDD=d.isSome(c)&&"dot-density"===c.type;this._geometryType=a;this._idField=b;this._templateStore=e;this._setLabelTemplates(f,c,g)}b.prototype.update=function(a,b,c){this._isDD=d.isSome(b)&&"dot-density"===b.type;this._setLabelTemplates(a,b,c)};b.prototype._setLabelTemplates=function(a,b,c){a&&this._validateLabelingInfo(a)&&(this._labelTemplates=a.map(function(a){return p.default.fromLabelClass(b,a,c)}))};Object.defineProperty(b.prototype,"templates",{get:function(){return this._templateStore},
enumerable:!0,configurable:!0});b.prototype.createMeshData=function(a){var b=Array(5),c=this._labelTemplates&&0<this._labelTemplates.length,d="esriGeometryPolyline"===this._geometryType?w.HEURISTIC_GLYPHS_PER_LINE:w.HEURISTIC_GLYPHS_PER_FEATURE;b[m.WGLGeometryType.MARKER]=new v.VertexVectors(m.WGLGeometryType.MARKER,a);b[m.WGLGeometryType.FILL]=new v.VertexVectors(m.WGLGeometryType.FILL,a,this._isDD);b[m.WGLGeometryType.LINE]=new v.VertexVectors(m.WGLGeometryType.LINE,a);b[m.WGLGeometryType.TEXT]=
new v.VertexVectors(m.WGLGeometryType.TEXT,a);b[m.WGLGeometryType.LABEL]=new v.VertexVectors(m.WGLGeometryType.LABEL,c?d:0);return new q.MeshData([],b)};b.prototype.analyze=function(a,b,c,e,h){return f(this,void 0,void 0,function(){var f,k,m,p,n,r,q,v,u;return g(this,function(g){switch(g.label){case 0:return f=a,l.isAborted(h)?[2,[]]:d.isSome(b)?[4,b.analyze(this._idField,a,c,e,h)]:[3,2];case 1:g.sent(),g.label=2;case 2:k=0;for(m=f;k<m.length;k++){p=m[k];n=p.groupId;if(null==n||-1===n)n=b.match(this._idField,
p,this._geometryType,c,e);if(y.isDynamicId(n))for(r=this._templateStore.getDynamicTemplateGroup(n),q=0,v=r;q<v.length;q++)(u=v[q])&&u.analyze&&u.analyze(this._templateStore,p,c,e);p.groupId=n}return[2,this._templateStore.finalize(h).then(function(){return f})]}})})};b.prototype.write=function(a,b,c,e,f,g){var h=this._templateStore.getTemplateGroup(b.groupId),k=b.localId;if(null!=k){var l=new z(k);if(y.isDynamicId(b.groupId))for(var m=0;m<h.length;m++){var p=h[m];p.bindFeature(b,c,e)}if(h&&(b.geometry||
b.centroid)){c=l.displayRecords;p=b.insertAfter;void 0!==p&&(l.insertAfter=p);(e=this._geometryType)||(e=null!=b.centroid?"esriGeometryPolygon":t.getJsonType(b.geometry));for(m=0;m<h.length;m++){var p=h[m],n=a.get(p.geometryType);p.writeMesh(c,n,e,k,b)}d.isSome(g)&&(h=g&&this._findLabelRef(h),this._writeLabels(l,a,k,b,g,h,f));a.pushDisplayObject(l)}}};b.prototype._hasBadLabelClass=function(b,c){var d=b.labelPlacement,e=D[c];if(!b.symbol)return u.warn("No LabelClass symbol specified."),!0;if(!e)return u.error(new a("mapview-labeling:unsupported-geometry-type",
"Unable to create labels for Feature Layer, "+c+" is not supported")),!0;e.some(function(a){return a===d})||(e=e[0],d&&u.warn("Found invalid label placement type "+d+" for "+c+". Defaulting to "+e),b.labelPlacement=e);return!1};b.prototype._validateLabelingInfo=function(a){var b=this;return!a.some(function(a){return b._hasBadLabelClass(a,b._geometryType)})};b.prototype._findLabelRef=function(a){for(var b=0;b<a.length;b++){var c=a[b];if(c instanceof h.default)return c}return null};b.prototype._writeLabels=
function(a,b,c,e,f,g,h){for(var k=a.displayRecords,l=[],m=0;m<f.length;m++){var p=f[m];if(d.isSome(p)){var n=p.glyphs,r=p.rtl,p=this._labelTemplates[p.classIndex],q=b.get(p.geometryType);p.bindReferenceTemplate(g);p.bindTextInfo(n,r);p.writeMesh(k,q,this._geometryType,c,e,h,l)}}a.metrics=l;w.DEBUG_LABELS&&this._debugLabels(a,b)};b.prototype._debugLabels=function(a,b){var c=a.displayRecords,d=a.id,e=0;for(a=a.metrics;e<a.length;e++)for(var f=a[e],g=0,h=f.boxes?f.boxes.concat([f.bounds]):[f.bounds];g<
h.length;g++){var k=h[g],k={geometry:{paths:[[[f.anchor[0]+f.offsetX+k.center[0]-k.width/2,f.anchor[1]+f.offsetY+k.center[1]+k.height/2],[0,-k.height],[k.width,0],[0,k.height],[-k.width,0]]]},attributes:{}},l=this._getLabelDebugTemplate(),m=b.get(l.geometryType);l.writeMesh(c,m,"esriGeometryPolyline",d,k)}};b.prototype._getLabelDebugTemplate=function(){this._labelsDebugTemplate||(this._labelsDebugTemplate=this._createLabelsDebugTemplate());return this._labelsDebugTemplate};b.prototype._createLabelsDebugTemplate=
function(){var a=new x({style:"solid",width:1,color:[255,0,0,1]});return r.default.fromSimpleLine(null,!1,a,null,!1)};return b}();c.WGLMeshFactory=b})},"esri/views/2d/engine/webgl/WGLDisplayObject":function(){define(["require","exports","./WGLDisplayRecord","./collisions/Metric","./util/serializationUtils"],function(b,c,e,g,f){return function(){function a(a){this.insertAfter=null;this.id=a;this.displayRecords=[];this.metrics=[]}a.prototype.copy=function(){var b=new a(this.id);b.set(this);return b};
a.prototype.clone=function(){var b=new a(this.id);b.displayRecords=this.displayRecords.map(function(a){return a.clone()});b.metrics=this.metrics.map(function(a){return a.clone()});b.insertAfter=this.insertAfter;return b};a.prototype.set=function(a){this.id=a.id;this.displayRecords=a.displayRecords;this.metrics=a.metrics;this.insertAfter=a.insertAfter};a.prototype.serialize=function(a){a.push(this.id);f.serializeList(a,this.metrics);f.serializeList(a,this.displayRecords);return a};a.deserialize=function(b){var c=
b.readInt32(),d=new a(c),c={id:c},l=f.deserializeList(b,g.default);l.length&&(d.metrics=l);d.displayRecords=f.deserializeList(b,e,c);return d};return a}()})},"esri/views/2d/engine/webgl/mesh/MeshData":function(){define(["require","exports","../util/serializationUtils","../util/Writer"],function(b,c,e,g){Object.defineProperty(c,"__esModule",{value:!0});b=function(){function b(a,b){this.displayObjects=a;this.vertexVectorsMap=b}Object.defineProperty(b.prototype,"vertexBuffersMap",{get:function(){if(!this._vertexBuffersMap){this._vertexBuffersMap=
{};for(var a=0;a<this.vertexVectorsMap.length;a++)this._vertexBuffersMap[a]=this.vertexVectorsMap[a].intoBuffers();this.vertexVectorsMap=null}return this._vertexBuffersMap},enumerable:!0,configurable:!0});b.prototype.get=function(a){return this.vertexVectorsMap[a]};b.prototype.pushDisplayObject=function(a){this.displayObjects.push(a)};b.prototype.encode=function(a,b){var c=e.serializeList(new g.default(Uint32Array,this._guessSize()),this.displayObjects).buffer(),d={};b.push(c);for(var f=0;f<this.vertexVectorsMap.length;f++){var n=
this.vertexVectorsMap[f];d[f]={};n.transfer(d[f],b)}a.displayObjects=c;a.vertexBuffersMap=d;this.destroy()};b.prototype.destroy=function(){this.displayObjects=this.vertexVectorsMap=null};b.prototype._guessSize=function(){for(var a=this.displayObjects,b=Math.min(a.length,4),c=0,d=0;d<b;d++)c=Math.max(c,a[d].displayRecords.length);return 2*(12*a.length+a.length*c*40)};return b}();c.MeshData=b})},"esri/views/2d/engine/webgl/util/Writer":function(){define(["require","exports"],function(b,c){Object.defineProperty(c,
"__esModule",{value:!0});b=function(){function b(b,c){this._pos=0;c=c?this._roundToNearest(c,b.BYTES_PER_ELEMENT):40;this._array=new ArrayBuffer(c);this._buffer=new b(this._array);this._ctor=b}Object.defineProperty(b.prototype,"length",{get:function(){return this._pos},enumerable:!0,configurable:!0});b.prototype._roundToNearest=function(b,c){b=Math.round(b);return b+(c-b%c)};b.prototype._ensureSize=function(b){if(this._pos+b>=this._buffer.length){b=this._roundToNearest(1.5*(this._array.byteLength+
b*this._buffer.BYTES_PER_ELEMENT),this._buffer.BYTES_PER_ELEMENT);b=new ArrayBuffer(b);var c=new this._ctor(b);c.set(this._buffer,0);this._array=b;this._buffer=c}};b.prototype.writeF32=function(b){this._ensureSize(1);var c=this._pos;(new Float32Array(this._array,4*this._pos,1))[0]=b;this._pos++;return c};b.prototype.push=function(b){this._ensureSize(1);var c=this._pos;this._buffer[this._pos++]=b;return c};b.prototype.writeRegion=function(b){this._ensureSize(b.length);var c=this._pos;this._buffer.set(b,
this._pos);this._pos+=b.length;return c};b.prototype.buffer=function(){var b=this._array.slice(0,4*this._pos);this.destroy();return b};b.prototype.seek=function(b){this._pos=b};b.prototype.destroy=function(){this._buffer=this._array=null};return b}();c.default=b})},"esri/views/2d/engine/webgl/mesh/VertexVector":function(){define(["require","exports","../Utils","./VertexBuffer","../util/Writer"],function(b,c,e,g,f){Object.defineProperty(c,"__esModule",{value:!0});var a=function(){function a(a,b){this.data=
a;this.stride=b}Object.defineProperty(a.prototype,"vertexCount",{get:function(){return this.data.length/(this.stride/4)},enumerable:!0,configurable:!0});a.prototype.transfer=function(a,b){var c=this.data.buffer();a.vertexCount=this.vertexCount;a.data=c;a.stride=this.stride;b.push(c)};return a}();c.default=a;b=function(){function b(b,c,g){void 0===g&&(g=!1);this.geometryType=b;this.indexVector=new f.default(Uint32Array,c);this.namedVectors={};b=e.getStrides(b,g);for(var d in b){g=b[d];var k=void 0;
switch(g%4){case 0:case 2:k=new f.default(Uint32Array,g/4*c);break;case 1:case 3:k=new f.default(Uint8Array,g*c)}this.namedVectors[d]=new a(k,g)}}b.prototype.get=function(a){return this.namedVectors[a].data};b.prototype.getVector=function(a){return this.namedVectors[a]};b.prototype.transfer=function(a,b){var c=this.indexVector.buffer(),d={};b.push(c);for(var e in this.namedVectors){var f=this.namedVectors[e];d[e]={};f.transfer(d[e],b)}a.geometryType=this.geometryType;a.indexBuffer=c;a.namedBuffers=
d;this.destroy()};b.prototype.intoBuffers=function(){var a=g.VertexBuffers.fromVertexVectors(this);this.destroy();return a};b.prototype.destroy=function(){this.namedVectors=this.indexVector=null};return b}();c.VertexVectors=b})},"esri/views/2d/engine/webgl/mesh/VertexBuffer":function(){define(["require","exports","../Utils"],function(b,c,e){Object.defineProperty(c,"__esModule",{value:!0});var g=function(){function b(a,b,c){this.data=a;this.stride=b;this.vertexCount=c}b.decode=function(a){var c=e.allocateTypedArrayBufferwithData(a.data,
a.stride);return new b(c,a.stride,a.vertexCount)};b.fromVertexVector=function(a){var c=e.allocateTypedArrayBufferwithData(a.data.buffer(),a.stride);return new b(c,a.stride,a.vertexCount)};return b}();c.default=g;b=function(){function b(a,b,c){this.geometryType=a;this.indexBuffer=new Uint32Array(b);this.namedBuffers=c}b.decode=function(a){var c=a.geometryType,e=a.indexBuffer,d={},f;for(f in a.namedBuffers)d[f]=g.decode(a.namedBuffers[f]);return new b(c,e,d)};b.fromVertexVectors=function(a){var c=a.geometryType,
e=a.indexVector.buffer(),d={},f;for(f in a.namedVectors)d[f]=g.fromVertexVector(a.namedVectors[f]);return new b(c,e,d)};return b}();c.VertexBuffers=b})},"esri/views/2d/engine/webgl/mesh/templates/WGLLineTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Logger ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../color ../../number ../../Utils ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLMeshTemplate".split(" "),
function(b,c,e,g,f,a,n,k,d,l,t,x,w){Object.defineProperty(c,"__esModule",{value:!0});var m=g.getLogger("esri.views.2d.engine.webgl.WGLLineTemplate");b=function(b){function c(a,c,d,e,f,g,k,m,n,q,w,x,z,F,L,J){var h=b.call(this)||this;a=l.LineMaterialKey.load(l.createMaterialKey(h.geometryType,a,z));c&&(a.sdf=c.sdf,a.pattern=!0,a.textureBinding=c.textureBinding);h._capType=e;h._joinType=f;h._miterLimitCosine=t.getLimitCosine(g);h.tessellationProperties._fillColor=k;h.tessellationProperties._tl=m;h.tessellationProperties._br=
n;h._hasPattern=q;h._isDashed=w;h._joinOnUTurn=J;h._isColorLocked=x;h._isOutline=z;h._zOrder=L;h._materialKey=a.data;h.tessellationProperties._bitset=x?1:0;h.tessellationProperties._halfWidth=.5*d;h.tessellationProperties._halfReferenceWidth=.5*F;h._initializeTessellator(!1);return h}e(c,b);c.fromCIMLine=function(b,d,e,g,l){var h=d.color,m=d.scaleFactor||1,p=d.isDashed,r=d.cap;p&&r===a.CapType.ROUND&&(r=a.CapType.SQUARE);var q=d.join,m=f.pt2px(d.width)*m,v=f.pt2px(d.referenceWidth),w=f.pt2px(d.miterLimit),
h=h&&n.premultiplyAlphaRGBA(h)||0;if(!e)return new c(b,e,m,r,q,w,h,0,0,!1,p,d.colorLocked,g,v,d.zOrder,l);var t=e.rect,y=t.x+1+e.width,x=t.y+1+e.height,t=k.i1616to32(t.x+1,t.y+1),y=k.i1616to32(y,x);return new c(b,e,m,r,q,w,h,t,y,!0,p,d.colorLocked,g,v,d.zOrder,l)};c.fromSimpleLine=function(a,b,e,g,l){var h=e.color,m="solid"!==e.style&&"none"!==e.style,p=d.getCapType(e.cap||"round",m),r=d.getJoinType(e.join||"round"),h=h&&"none"!==e.style&&n.premultiplyAlphaRGBA(h)||0;"none"===e.style&&(h=0);var q=
f.pt2px(e.width);e=e.miterLimit;if(!g)return new c(a,g,q,p,r,e,h,0,0,!1,m,!1,b,q,0,l);var v=g.rect,w=v.x+1+g.width,t=v.y+1+g.height,v=k.i1616to32(v.x+1,v.y+1),w=k.i1616to32(w,t);return new c(a,g,q,p,r,e,h,v,w,!0,m,!1,b,q,0,l)};c.fromPictureLineSymbol=function(a,b,c,d){m.error("PictureLineSymbol support does not exist!");return null};return c}(x.default(w.default));c.default=b})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseLineTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/has ../../../../../../core/Logger ../../definitions ../../enums ../../number ../../TileClipper ../../TurboLine ../../WGLDisplayRecord ../../materialKey/MaterialKey".split(" "),
function(b,c,e,g,f,a,n,k,d,l,t,x){Object.defineProperty(c,"__esModule",{value:!0});var w=f.getLogger("esri.views.2d.engine.webgl.WGLLineTemplateBase"),m=a.TILE_SIZE+16,z=1/3.8,q=new d.TileClipper(0,0,0,1,16);q.setExtent(a.TILE_SIZE);var v=new Uint32Array(9),p=new Uint32Array(36),r=new Uint32Array(3),h=new Uint32Array(6),y=function(a){return function(b){var c=Math.ceil(1024*a._halfWidth),d=Math.ceil(1024*a._halfReferenceWidth);b.entry0=a.offset+a.vertexCount++;var e=k.i1616to32(b.distance,c),f=k.i8888to32(Math.round(31*
b.prevNormal.x),Math.round(31*b.prevNormal.y),Math.round(0),Math.round(-31)),g=k.i8888to32(0,0,0,a._bitset);p[0]=k.i1616to32(b.currentVertex.x,b.currentVertex.y);p[1]=a.id;p[2]=a._fillColor;p[3]=f;p[4]=e;p[5]=a._tl;p[6]=a._br;p[7]=g;p[8]=k.i1616to32(d,0);b.entry2=a.offset+a.vertexCount++;e=k.i1616to32(b.distance,c);f=k.i8888to32(Math.round(31*-b.prevNormal.x),Math.round(31*-b.prevNormal.y),Math.round(0),Math.round(31));g=k.i8888to32(0,0,0,a._bitset);p[9]=k.i1616to32(b.currentVertex.x,b.currentVertex.y);
p[10]=a.id;p[11]=a._fillColor;p[12]=f;p[13]=e;p[14]=a._tl;p[15]=a._br;p[16]=g;p[17]=k.i1616to32(d,0);b.exit0=a.offset+a.vertexCount++;e=k.i1616to32(b.distance,c);f=k.i8888to32(Math.round(31*b.nextNormal.x),Math.round(31*b.nextNormal.y),Math.round(0),Math.round(-31));g=k.i8888to32(0,0,0,a._bitset);p[18]=k.i1616to32(b.currentVertex.x,b.currentVertex.y);p[19]=a.id;p[20]=a._fillColor;p[21]=f;p[22]=e;p[23]=a._tl;p[24]=a._br;p[25]=g;p[26]=k.i1616to32(d,0);b.exit2=a.offset+a.vertexCount++;e=k.i1616to32(b.distance,
c);f=k.i8888to32(Math.round(31*-b.nextNormal.x),Math.round(31*-b.nextNormal.y),Math.round(0),Math.round(31));g=k.i8888to32(0,0,0,a._bitset);p[27]=k.i1616to32(b.currentVertex.x,b.currentVertex.y);p[28]=a.id;p[29]=a._fillColor;p[30]=f;p[31]=e;p[32]=a._tl;p[33]=a._br;p[34]=g;p[35]=k.i1616to32(d,0);a.geometryBuf.writeRegion(p)}},u=function(a){return function(b){h[0]=b.leftExit0;h[1]=b.rightEntry0;h[2]=b.leftExit2;h[3]=b.rightEntry0;h[4]=b.rightEntry2;h[5]=b.leftExit2;a.indexCount+=6;a.indexBuf.writeRegion(h)}},
D=function(a){return function(b,c,d,e,f,g,h,l,m){m=k.i1616to32(m,Math.ceil(1024*a._halfWidth));f=k.i8888to32(Math.round(31*f),Math.round(31*g),Math.round(31*h),Math.round(31*l));d=k.i8888to32(31*d,31*e,0,a._bitset);v[0]=k.i1616to32(b,c);v[1]=a.id;v[2]=a._fillColor;v[3]=f;v[4]=m;v[5]=a._tl;v[6]=a._br;v[7]=d;v[8]=k.i1616to32(Math.ceil(1024*a._halfReferenceWidth),0);a.geometryBuf.writeRegion(v);return a.offset+a.vertexCount++}},B=function(a){return function(b,c,d){r[0]=b;r[1]=c;r[2]=d;a.indexCount+=
3;a.indexBuf.writeRegion(r)}};c.default=function(b){return function(b){function c(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];a=b.apply(this,a)||this;a.tessellationProperties={_fillColor:null,_tl:null,_br:null,_halfWidth:null,_bitset:null,_halfReferenceWidth:null,id:null,indexBuf:null,indexCount:null,geometryBuf:null,vertexCount:null,offset:null};a._tessellationOptions={};a.geometryType=n.WGLGeometryType.LINE;return a}e(c,b);c.prototype.writeMesh=function(a,b,c,d,e){var f=b.indexVector,
g=b.get("geometry"),h=new t(d,this.geometryType,this._materialKey);b=b.getVector("geometry").vertexCount;h.vertexFrom=b;h.indexFrom=f.length;switch(c){case "esriGeometryPolyline":c=this._clipLines(e.geometry.paths);if(0===c.length)break;this._write(h,f,g,b,d,c);a.push(h);break;case "esriGeometryPolygon":c=this._clipLines(e.geometry.rings);if(0===c.length)break;this._write(h,f,g,b,d,c);a.push(h);break;default:w.error("Unable to handle geometryType: "+c)}};c.prototype._clipLines=function(a){for(var b=
[],c=!1,d=0;d<a.length;){var e=[],f=a[d];q.reset(2);var g=f[0],h=g[0],g=g[1];if(c)q.moveTo(h,g);else{if(-16>h||h>m||-16>g||g>m){c=!0;continue}e.push({x:h,y:g})}for(var k=!1,l=f.length,p=1;p<l;++p)if(h+=f[p][0],g+=f[p][1],c)q.lineTo(h,g);else{if(-16>h||h>m||-16>g||g>m){k=!0;break}e.push({x:h,y:g})}if(k)c=!0;else{if(c){if(e=q.resultWithStarts())for(c=0;c<e.length;c++)b.push(e[c])}else b.push({line:e,start:0});d++;c=!1}}return b};c.prototype._write=function(a,b,c,d,e,f){this.tessellationProperties.id=
e;this.tessellationProperties.indexBuf=b;this.tessellationProperties.indexCount=0;this.tessellationProperties.geometryBuf=c;this.tessellationProperties.vertexCount=0;this.tessellationProperties.offset=d;for(b=0;b<f.length;b++)c=f[b],d=c.line,2>d.length||(this._tessellationOptions.initialDistance=c.start%65535,this._tessellationCallbacks instanceof l.StandardTessellationCallbacks&&(this._tessellationCallbacks.capType=this._capType,this._tessellationCallbacks.joinType=this._joinType),l.tessellate(d,
this._tessellationOptions,this._tessellationCallbacks),l.cleanup());a.vertexCount=this.tessellationProperties.vertexCount;a.indexCount=this.tessellationProperties.indexCount;a.zOrder=this._zOrder};c.prototype._initializeTessellator=function(b){var c=x.LineMaterialKey.load(this._materialKey);this._tessellationOptions.trackDistance=this._isDashed||this._hasPattern;this._tessellationOptions.thin=!b&&this.tessellationProperties._halfWidth<a.THIN_LINE_THRESHOLD/2&&!(c.vvSizeFieldStops||c.vvSizeMinMaxValue||
c.vvSizeScaleStops||c.vvSizeUnitValue);this._tessellationOptions.wrapDistance=65535;this._tessellationOptions.outerBisectorAutoSplitThreshold=z;this._tessellationOptions.enableOuterBisectorSplit=this._isDashed||this._hasPattern;this._tessellationOptions.innerBisectorAutoSplitThreshold=z;this._tessellationOptions.enableInnerBisectorSplit=this._isDashed||this._hasPattern;this._tessellationOptions.thin?this._tessellationCallbacks={vertex:y(this.tessellationProperties),bridge:u(this.tessellationProperties)}:
(b=new l.StandardTessellationCallbacks(D(this.tessellationProperties),B(this.tessellationProperties)),b.miterLimitCosine=this._miterLimitCosine,b.textured=this._isDashed||this._hasPattern,b.joinOnUTurn=this._joinOnUTurn,this._tessellationCallbacks=b)};return c}(b)}})},"esri/views/2d/engine/webgl/mesh/templates/WGLMarkerTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../core/libs/gl-matrix-2/mat2d ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../../../../../core/libs/gl-matrix-2/vec2 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../../../../../symbols/cim/enums ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./WGLBaseMarkerTemplate ./WGLMeshTemplate".split(" "),
function(b,c,e,g,f,a,n,k,d,l,t,x,w,m,z,q){Object.defineProperty(c,"__esModule",{value:!0});b=function(b){function c(c,e,f,g,p,q,v,t,x,z,H,F,L,J,G,N,M,K,O){var h=b.call(this)||this;h.height=v;h.width=q;h.xOffset=e*O;h.yOffset=f*O;e=d.vec2f32.create();f=n.mat2df32.create();H=(J===l.Alignment.MAP?1:0)|(H?1:0)<<1|(L?1:0)<<2|(F?1:0)<<3;F=G&&G.sdf;a.mat2d.translate(f,f,d.vec2f32.fromValues(h.xOffset,-h.yOffset));g&&a.mat2d.rotate(f,f,3.14159265359/180*g);c=m.MarkerMaterialKey.load(m.createMaterialKey(h.geometryType,
c,!1));c.sdf=F;c.pattern=!0;c.textureBinding=G.textureBinding;h._materialKey=c.data;h._fillColor=p;h._outlineColor=x;h._sizeOutlineWidth=w.i8888to32(Math.round(Math.sqrt(256*q)),Math.round(Math.sqrt(256*v)),Math.round(Math.sqrt(256*z)),Math.round(Math.sqrt(256*t)));p=G.rect.x;t=G.rect.y;x=p+G.rect.width;z=t+G.rect.height;N=.5-((.5+N)*G.width+1)/G.rect.width;M=.5-((.5+M)*G.height+1)/G.rect.height;c=Math.round(Math.min(64*K,255));q*=G.rect.width/G.width*K*O;v*=G.rect.height/G.height*K*O;G=(N-.5)*q;
M=(M-.5)*v;h._bitestAndDistRatio=w.i8888to32(0,0,H,c);k.vec2.set(e,G,M);k.vec2.transformMat2d(e,e,f);h._offsetUpperLeft=w.i1616to32(16*e[0],16*e[1]);h._texUpperLeft=w.i1616to32(p,t);k.vec2.set(e,G+q,M);k.vec2.transformMat2d(e,e,f);h._offsetUpperRight=w.i1616to32(16*e[0],16*e[1]);h._texUpperRight=w.i1616to32(x,t);k.vec2.set(e,G,M+v);k.vec2.transformMat2d(e,e,f);h._offsetBottomLeft=w.i1616to32(16*e[0],16*e[1]);h._texBottomLeft=w.i1616to32(p,z);k.vec2.set(e,G+q,M+v);k.vec2.transformMat2d(e,e,f);h._offsetBottomRight=
w.i1616to32(16*e[0],16*e[1]);h._texBottomRight=w.i1616to32(x,z);return h}e(c,b);c.fromCIMMarker=function(a,b,d){var e=b.size,h=(d&&d.width||1)/(d&&d.height||1)*b.scaleX,k=b.scaleSymbolsProportionally&&b.frameHeight?e/b.frameHeight:1,m=t.premultiplyAlphaRGBA(b.color),p=t.premultiplyAlphaRGBA(b.outlineColor),n=f.pt2px(e),r=n*h,q=f.pt2px(b.offsetX||0),v=f.pt2px(b.offsetY||0),k=f.pt2px(b.outlineWidth||0)*k,w=b.alignment||l.Alignment.SCREEN,y=f.pt2px(b.referenceSize),x=b.rotation||0;b.rotateClockwise||
(x=-x);var z=0,M=0,K=b.anchorPoint;K&&(b.isAbsoluteAnchorPoint?e&&(z=-K.x/(e*h),M=K.y/e):(z=K.x,M=K.y));return new c(a,q,v,x,m,r,n,y,p,k,b.colorLocked,b.scaleSymbolsProportionally,!1,w,d,z,M,b.sizeRatio,g.unwrapOr(b.scaleFactor,1))};c.fromPictureMarker=function(a,b,d){var e=Math.round(f.pt2px(b.width)),g=Math.round(f.pt2px(b.height)),h=x.PICTURE_FILL_COLOR,k=Math.round(f.pt2px(b.xoffset||0)),m=Math.round(f.pt2px(b.yoffset||0));return new c(a,k,m,b.angle,h,e,g,g,0,0,!1,!1,!1,l.Alignment.SCREEN,d,0,
0,1,1)};c.fromSimpleMarker=function(a,b,d){var e=t.premultiplyAlphaRGBA(b.color),g=Math.round(f.pt2px(b.size)),h=Math.round(f.pt2px(b.xoffset||0)),k=Math.round(f.pt2px(b.yoffset||0)),m=b.style,p=b.outline,n=(p&&p.color&&t.premultiplyAlphaRGBA(p.color))|0,p=(p&&p.width&&Math.round(f.pt2px(p.width)))|0;a=new c(a,h,k,b.angle,e,g,g,g,n,p,!1,!1,"cross"===m||"x"===m,l.Alignment.SCREEN,d,0,0,1.96875,1);a.boundsType="circle"===m?"circle":"square";return a};return c}(z.default(q.default));c.default=b})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseMarkerTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Logger ../../enums ../../number ../../WGLDisplayRecord".split(" "),
function(b,c,e,g,f,a,n){Object.defineProperty(c,"__esModule",{value:!0});var k=g.getLogger("esri.views.2d.engine.webgl.WGLMarkerTemplateBase");c.default=function(b){return function(b){function c(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];a=b.apply(this,a)||this;a.xOffset=0;a.yOffset=0;a.width=0;a.height=0;a.boundsType="square";a.geometryType=f.WGLGeometryType.MARKER;return a}e(c,b);c.prototype.writeMesh=function(a,b,c,d,e){var f=b.indexVector,g=b.get("geometry"),l=new n(d,this.geometryType,
this._materialKey);b=b.getVector("geometry").vertexCount;a.push(l);l.vertexFrom=b;l.indexFrom=f.length;switch(c){case "esriGeometryPoint":c=e.geometry;a=c.x;c=c.y;this._writeVertices(l,g,d,this._getPos(a,c));this._writeIndices(l,f,b);break;case "esriGeometryPolyline":this._writeMany(l,f,g,b,d,e.geometry.paths[0]);break;case "esriGeometryPolygon":(c=e.centroid)?(a=c.x,c=c.y,this._writeVertices(l,g,d,this._getPos(a,c)),this._writeIndices(l,f,b)):k.error("Tried to render polygon geometries as markers, but found no centroid!");
break;case "esriGeometryMultipoint":this._writeMany(l,f,g,b,d,e.geometry.points);break;default:k.error("Unable to handle geometryType: "+c)}};c.prototype._getPos=function(b,c){return a.i1616to32(b,c)};c.prototype._writeMany=function(a,b,c,d,e,f){for(var g=0,k=0,h=0,l=0;l<f.length;l++){var m=f[l],n=m[0],m=m[1],q=this._getPos(n+g,m+k);this._writeVertices(a,c,e,q);this._writeIndices(a,b,d+h);g+=n;k+=m;h+=4}};c.prototype._writeVertices=function(a,b,c,d){b.push(d);b.push(this._offsetUpperLeft);b.push(this._texUpperLeft);
b.push(this._bitestAndDistRatio);b.push(c);b.push(this._fillColor);b.push(this._outlineColor);b.push(this._sizeOutlineWidth);b.push(d);b.push(this._offsetUpperRight);b.push(this._texUpperRight);b.push(this._bitestAndDistRatio);b.push(c);b.push(this._fillColor);b.push(this._outlineColor);b.push(this._sizeOutlineWidth);b.push(d);b.push(this._offsetBottomLeft);b.push(this._texBottomLeft);b.push(this._bitestAndDistRatio);b.push(c);b.push(this._fillColor);b.push(this._outlineColor);b.push(this._sizeOutlineWidth);
b.push(d);b.push(this._offsetBottomRight);b.push(this._texBottomRight);b.push(this._bitestAndDistRatio);b.push(c);b.push(this._fillColor);b.push(this._outlineColor);b.push(this._sizeOutlineWidth);a.vertexCount+=4};c.prototype._writeIndices=function(a,b,c){b.push(c+0);b.push(c+1);b.push(c+2);b.push(c+1);b.push(c+3);b.push(c+2);a.indexCount+=6};return c}(b)}})},"esri/views/2d/engine/webgl/mesh/templates/WGLTemplateStore":function(){define("require exports ../../../../../../core/tsSupport/awaiterHelper ../../../../../../core/tsSupport/generatorHelper ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/promiseUtils ../../../../../../symbols/support/defaults ./WGLDynamicLineTemplate ./WGLDynamicMarkerTemplate ./WGLDynamicTextTemplate ./WGLFillTemplate ./WGLLineTemplate ./WGLMarkerTemplate ./WGLTextTemplate ../../util/Lock ../../util/Result ../../../../layers/features/textUtils".split(" "),
function(b,c,e,g,f,a,n,k,d,l,t,x,w,m,z,q,v,p){function r(a,b){var c=a.length;a.push(null);b.then(function(b){return a[c]=b});return a}function h(a){return!!(a&1)}Object.defineProperty(c,"__esModule",{value:!0});var y=a.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLTemplateStore"),u=[];c.isDynamicId=h;b=function(){function a(a,b){this._templateIdCounter=this._idCounter=1;this._idToTemplateGroup=new Map;this._symbolToTemplate=new Map;this._fetchQueue=[];this._idToResolver=new Map;this._cimTemplateCache=
new Map;this._cimAnalyses=[];this._lock=new q.default;this._fetchResource=a;this._joinOnUTurn=b}Object.defineProperty(a.prototype,"_markerError",{get:function(){return this._errorTemplates.marker[0]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"_fillError",{get:function(){return this._errorTemplates.fill[0]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"_lineError",{get:function(){return this._errorTemplates.line[0]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"_textError",{get:function(){return this._errorTemplates.line[0]},enumerable:!0,configurable:!0});a.prototype.createTemplateGroup=function(a,b,c){this._initErrorTemplates();var d=a.hash();if(this._symbolToTemplate.has(d)&&"expanded-cim"!==a.type)return this._symbolToTemplate.get(d);var e=[];b&&this._createMeshTemplates(e,b,c,!0);this._createMeshTemplates(e,a,c,!1);a=this._createGroupId("expanded-cim"===a.type);this._idToTemplateGroup.set(a,e);this._symbolToTemplate.set(d,a);return a};a.prototype.getTemplateGroup=
function(a){return this._idToTemplateGroup.has(a)?this._idToTemplateGroup.get(a):u};a.prototype.getDynamicTemplateGroup=function(a){if(!this._idToTemplateGroup.has(a))return u;h(a)||y.error("mapview-template-store","Id "+a+" does not refer to a dynamic template");return this._idToTemplateGroup.get(a)};a.prototype.getMosaicItem=function(a,b,c){var d=this,e=this._createTemplateId(),f=n.create(function(a){return d._idToResolver.set(e,a)});a=b?a.toJSON():a;this._fetchQueue.push({symbol:a,id:e,glyphIds:c});
return f};a.prototype.finalize=function(a){return this._fetchQueue.length||this._lock.isHeld()?q.withLock(this._lock,this._fetchAllQueuedResources.bind(this),a):n.resolve()};a.prototype._initErrorTemplates=function(){this._errorTemplates||(this._errorTemplates={fill:this._createMeshTemplates([],k.errorPolygonSymbol2D,null,!1),marker:this._createMeshTemplates([],k.errorPointSymbol2D,null,!1),line:this._createMeshTemplates([],k.errorPolylineSymbol2D,null,!1)})};a.prototype._fetchAllQueuedResources=
function(a){var b=this;if(!this._fetchQueue.length)return n.resolve();var c=this._fetchQueue,d=this._cimAnalyses;this._fetchQueue=[];this._cimAnalyses=[];return n.all(d).then(function(){return b._fetchResource(c,a).then(function(a){for(var c=0;c<a.length;c++){var d=a[c],e=d.id,d=d.mosaicItem;b._idToResolver.get(e)(d);b._idToResolver.delete(e)}})}).catch(function(a){n.isAbortError(a)?b._fetchQueue=b._fetchQueue.concat(c):y.error(new f("mapview-template-store","Unable to fetch requested texture resources",
a))})};a.prototype._createGroupId=function(a){return this._idCounter++<<1|(a?1:0)};a.prototype._createTemplateId=function(){return this._templateIdCounter++};a.prototype._createSMS=function(a,b){return e(this,void 0,void 0,function(){var c;return g(this,function(d){switch(d.label){case 0:return[4,this.getMosaicItem(a,!0)];case 1:return c=d.sent().spriteMosaicItem,v.ok(c,y)?[2,m.default.fromSimpleMarker(b,a,c)]:[2,this._markerError]}})})};a.prototype._createPMS=function(a,b){return e(this,void 0,void 0,
function(){var c;return g(this,function(d){switch(d.label){case 0:return[4,this.getMosaicItem(a,!0)];case 1:return c=d.sent().spriteMosaicItem,v.ok(c,y)?[2,m.default.fromPictureMarker(b,a,c)]:[2,this._markerError]}})})};a.prototype._createSFS=function(a,b,c){return e(this,void 0,void 0,function(){var d,e;return g(this,function(f){switch(f.label){case 0:return[4,this.getMosaicItem(a,!0)];case 1:return d=f.sent().spriteMosaicItem,e=a,v.ok(d,y)?[2,x.default.fromSimpleFill(b,e,d,c)]:[2,this._fillError]}})})};
a.prototype._createPFS=function(a,b,c){return e(this,void 0,void 0,function(){var d,e;return g(this,function(f){switch(f.label){case 0:return[4,this.getMosaicItem(a,!0)];case 1:return d=f.sent().spriteMosaicItem,e=a,v.ok(d,y)?[2,x.default.fromPictureFill(b,e,d,c)]:[2,this._fillError]}})})};a.prototype._createSLS=function(a,b,c){return e(this,void 0,void 0,function(){var d,e;return g(this,function(f){switch(f.label){case 0:return[4,this.getMosaicItem(a,!0)];case 1:return d=f.sent().spriteMosaicItem,
e=a,v.ok(d,y)?[2,w.default.fromSimpleLine(b,c,e,d,this._joinOnUTurn)]:[2,this._lineError]}})})};a.prototype._createTS=function(a,b){return e(this,void 0,void 0,function(){var c;return g(this,function(d){switch(d.label){case 0:return[4,this.getMosaicItem(a,!0)];case 1:return c=d.sent().glyphMosaicItems,[2,z.default.fromText(b,a,c)]}})})};a.prototype._createCIMText=function(a,b){return e(this,void 0,void 0,function(){var c;return g(this,function(d){switch(d.label){case 0:return"function"===typeof a.materialHash?
[2,n.resolve(t.default.fromCIMText(b,a))]:[4,this.getMosaicItem(a.cim,!1,p.codepoints(a.text))];case 1:return c=d.sent().glyphMosaicItems,a.cim.mosaicHash=a.materialHash,v.ok(c,y)?[2,z.default.fromCIMText(b,a,c)]:[2,this._textError]}})})};a.prototype._createCIMFill=function(a,b){return e(this,void 0,void 0,function(){var c;return g(this,function(d){switch(d.label){case 0:return a.cim.mosaicHash=a.materialHash,[4,this.getMosaicItem(a.cim,!1)];case 1:return c=d.sent().spriteMosaicItem,v.ok(c,y)?[2,
x.default.fromCIMFill(b,a,c,!1)]:[2,this._fillError]}})})};a.prototype._createCIMLine=function(a,b){return e(this,void 0,void 0,function(){var c;return g(this,function(e){switch(e.label){case 0:if("function"===typeof a.materialHash)return[2,n.resolve(d.default.fromCIMLine(b,a))];a.cim.mosaicHash=a.materialHash;return[4,this.getMosaicItem(a.cim,!1)];case 1:return c=e.sent().spriteMosaicItem,v.ok(c,y)?[2,w.default.fromCIMLine(b,a,c,!1,this._joinOnUTurn)]:[2,this._lineError]}})})};a.prototype._createCIMMarker=
function(a,b){return e(this,void 0,void 0,function(){var c;return g(this,function(d){switch(d.label){case 0:if("function"===typeof a.materialHash)return[2,n.resolve(l.default.fromCIMMarker(b,a))];a.cim.mosaicHash=a.materialHash;return[4,this.getMosaicItem(a.cim,!1)];case 1:return c=d.sent().spriteMosaicItem,v.ok(c,y)?[2,m.default.fromCIMMarker(b,a,c)]:[2,this._markerError]}})})};a.prototype._createCIM=function(a,b){return e(this,void 0,void 0,function(){var c,d,e=this;return g(this,function(f){c=
a.templateHash;if(this._cimTemplateCache.has(c))return[2,this._cimTemplateCache.get(c)];switch(a.type){case "marker":d=this._createCIMMarker(a,b);break;case "line":d=this._createCIMLine(a,b);break;case "fill":d=this._createCIMFill(a,b);break;case "text":d=this._createCIMText(a,b)}d.then(function(a){return e._cimTemplateCache.set(c,a)});return[2,d]})})};a.prototype._createMeshTemplates=function(a,b,c,d){if(-1!==b.type.indexOf("3d"))return y.error("3D symbols are not supported with MapView"),a;switch(b.type){case "cim":return y.error(new f("mapview-bad-type",
"Found a cim type not yet expanded")),a;case "expanded-cim":d=0;for(b=b.layers;d<b.length;d++)r(a,this._createCIM(b[d],c));return a;case "simple-marker":return r(a,this._createSMS(b,c));case "picture-marker":return r(a,this._createPMS(b,c));case "simple-fill":return r(a,this._createSFS(b,c,d)),b.outline&&r(a,this._createSLS(b.outline,c,!0)),a;case "picture-fill":return r(a,this._createPFS(b,c,d)),b.outline&&r(a,this._createSLS(b.outline,c,!0)),a;case "simple-line":return r(a,this._createSLS(b,c,!1));
case "text":return r(a,this._createTS(b,c));default:return y.error("Unable to create mesh template for unknown symbol type {: $ }{symbol.type}"),a}};return a}();c.WGLTemplateStore=b})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicLineTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/screenUtils ../../color ../../number ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(b,c,e,g,f,a,n,k,d,l,t){Object.defineProperty(c,"__esModule",{value:!0});b=function(b){function c(a,c){var d=b.call(this,c)||this;d._cimLineLayer=c;var e=0;k.isFunction(c.width)||(e=.5*g.pt2px(c.width));d._dynamicPropertyMap.set("_halfWidth",function(a,b,d){return k.isFunction(c.width)?.5*g.pt2px(c.width(a,b,d)):e});k.isFunction(c.cap)?d._dynamicPropertyMap.set("_capType",c.cap):d._capType=c.cap;k.isFunction(c.join)?d._dynamicPropertyMap.set("_joinType",c.join):d._joinType=c.join;if(k.isFunction(c.color))d._dynamicPropertyMap.set("_fillColor",
function(a,b,d){return(a=c.color(a,b,d))&&f.premultiplyAlphaRGBA(a)||0});else{var l=c.color;d._fillColor=l&&f.premultiplyAlphaRGBA(l)||0}k.isFunction(c.miterLimit)?d._dynamicPropertyMap.set("_miterLimitCosine",function(a,b,d){return k.getLimitCosine(c.miterLimit(a,b,d))}):d._miterLimitCosine=k.getLimitCosine(c.miterLimit);d._scaleFactor=c.scaleFactor||1;d._isDashed=c.isDashed;d.tessellationProperties._bitset=c.colorLocked?1:0;d._materialKey=n.createMaterialKey(d.geometryType,a,c.isOutline);d._initializeTessellator(!0);
return d}e(c,b);c.fromCIMLine=function(a,b){return new c(a,b)};c.prototype.bindFeature=function(b,c,d){var e=this;this._dynamicPropertyMap.forEach(function(a,f){e[f]=a(b,c,d)});this._halfWidth*=this._scaleFactor;var f=this._materialCache,g=this._cimLineLayer.materialHash,g=g(b,c,d),g=f.get(g),f=null;g&&t.ok(g.spriteMosaicItem)&&(f=g.spriteMosaicItem);if(f){this._hasPattern=!0;var g=f.rect,h=g.x+1+f.width,k=g.y+1+f.height;this.tessellationProperties._tl=a.i1616to32(g.x+1,g.y+1);this.tessellationProperties._br=
a.i1616to32(h,k)}else this._hasPattern=!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=0;this.tessellationProperties._fillColor=this._fillColor;this.tessellationProperties._halfWidth=this._halfWidth;this.tessellationProperties._halfReferenceWidth=this.tessellationProperties._halfWidth;g=n.LineMaterialKey.load(this._materialKey);f&&(g.sdf=f.sdf,g.pattern=!0,g.textureBinding=f.textureBinding);this._materialKey=g.data};return c}(d.default(l.default));c.default=b})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMeshTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Logger ../../../../../../core/promiseUtils ../../../../../../symbols/cim/cimAnalyzer ./WGLMeshTemplate".split(" "),
function(b,c,e,g,f,a,n){Object.defineProperty(c,"__esModule",{value:!0});var k=g.getLogger("esri.views.2d.engine.webgl.WGLDynamicMeshTemplate");b=function(b){function c(a){var c=b.call(this)||this;c._ongoingMaterialRequestMap=new Map;c._materialCache=new Map;c._dynamicPropertyMap=new Map;c._cimLayer=a;return c}e(c,b);c.prototype.analyze=function(b,c,d,e){var g=this,l=this._materialCache,m=this._cimLayer.materialHash;if(!m)return k.error("A Dynamic mesh template must have a material hash value or function!"),
f.reject(null);var p="function"===typeof m?m(c,d,e):m;if(l.has(p))return b=l.get(p),f.resolve(b);if(this._ongoingMaterialRequestMap.has(p))return this._ongoingMaterialRequestMap.get(p);c=a.analyzeCIMResource(this._cimLayer.cim,this._cimLayer.materialOverrides);c.mosaicHash=p;b=b.getMosaicItem(c,!1).then(function(a){g._ongoingMaterialRequestMap.delete(p);l.set(p,a);return a}).catch(function(a){g._ongoingMaterialRequestMap.delete(p);k.error(".analyze()",a.message);return null});this._ongoingMaterialRequestMap.set(p,
b);return b};return c}(n.default);c.default=b})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMarkerTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../core/libs/gl-matrix-2/mat2d ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../../../../../core/libs/gl-matrix-2/vec2 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../../../../../symbols/cim/enums ../../color ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(b,c,e,g,f,a,n,k,d,l,t,x,w,m,z,q,v,p,r){Object.defineProperty(c,"__esModule",{value:!0});var h=3.14159265359/180,y=t.vec2f32.create(),u=d.mat2df32.create(),D=f.getLogger("esri.views.2d.engine.webgl.WGLDynamicMarkerTemplate");b=function(b){function c(c,d){var e=b.call(this,d)||this;e._cimMarkerLayer=d;q.isFunction(d.color)?e._dynamicPropertyMap.set("_fillColor",function(a,b,c){return w.premultiplyAlphaRGBA(d.color(a,b,c))}):e._fillColor=w.premultiplyAlphaRGBA(d.color);q.isFunction(d.outlineColor)?
e._dynamicPropertyMap.set("_outlineColor",function(a,b,c){return w.premultiplyAlphaRGBA(d.outlineColor(a,b,c))}):e._outlineColor=w.premultiplyAlphaRGBA(d.outlineColor);q.isFunction(d.size)?e._dynamicPropertyMap.set("_size",function(a,b,c){return n.pt2px(d.size(a,b,c))}):e._size=n.pt2px(d.size);q.isFunction(d.scaleX)?e._dynamicPropertyMap.set("_scaleX",d.scaleX):e._scaleX=d.scaleX;q.isFunction(d.offsetX)?e._dynamicPropertyMap.set("xOffset",function(a,b,c){return n.pt2px(d.offsetX(a,b,c))}):e.xOffset=
n.pt2px(d.offsetX);q.isFunction(d.offsetY)?e._dynamicPropertyMap.set("yOffset",function(a,b,c){return n.pt2px(d.offsetY(a,b,c))}):e.yOffset=n.pt2px(d.offsetY);q.isFunction(d.outlineWidth)?e._dynamicPropertyMap.set("_outlineWidth",function(a,b,c){return n.pt2px(d.outlineWidth(a,b,c))}):e._outlineWidth=n.pt2px(d.outlineWidth);q.isFunction(d.rotation)?e._dynamicPropertyMap.set("_angle",d.rotation):e._angle=d.rotation;e._scaleFactor=a.unwrapOr(d.scaleFactor,1);e._bitSet=(d.alignment===x.Alignment.MAP?
1:0)|(d.colorLocked?1:0)<<1|(d.scaleSymbolsProportionally?1:0)<<3;e._materialKey=z.createMaterialKey(e.geometryType,c,!1);return e}e(c,b);c.fromCIMMarker=function(a,b){return new c(a,b)};c.prototype.bindFeature=function(a,b,c){var d=this;this._dynamicPropertyMap.forEach(function(e,f){d[f]=e(a,b,c)});var e=this._cimMarkerLayer.materialHash,e="function"===typeof e?e(a,b,c):e;if((e=this._materialCache.get(e))&&r.ok(e.spriteMosaicItem)&&e.spriteMosaicItem){var e=e.spriteMosaicItem,f=this._cimMarkerLayer.sizeRatio,
p=e.width/e.height*this._scaleX,q=this._cimMarkerLayer.rotateClockwise?this._angle:-this._angle,v=this._size,w=v*p,x=this.xOffset*this._scaleFactor,A=this.yOffset*this._scaleFactor,B=this._cimMarkerLayer.scaleSymbolsProportionally&&this._cimMarkerLayer.frameHeight?this._size/n.pt2px(this._cimMarkerLayer.frameHeight):1,C=this._outlineWidth*B,I=n.pt2px(this._cimMarkerLayer.referenceSize),E=0,B=0,R=this._cimMarkerLayer.anchorPoint;R&&(this._cimMarkerLayer.isAbsoluteAnchorPoint?this._size&&(E=-R.x/(this._size*
p),B=R.y/this._size):(E=R.x,B=R.y));this._sizeOutlineWidth=m.i8888to32(Math.round(Math.sqrt(256*w)),Math.round(Math.sqrt(256*v)),Math.round(Math.sqrt(256*C)),Math.round(Math.sqrt(256*I)));k.mat2d.identity(u);k.mat2d.translate(u,u,t.vec2f32.fromValues(x,-A));q&&k.mat2d.rotate(u,u,h*q);p=e.rect.x;q=e.rect.y;x=p+e.rect.width;A=q+e.rect.height;E=.5-((.5+E)*e.width+1)/e.rect.width;B=.5-((.5+B)*e.height+1)/e.rect.height;w=w*f*this._scaleFactor;v=v*f*this._scaleFactor;f=Math.round(64*f);w*=e.rect.width/
e.width;v*=e.rect.height/e.height;E=(E-.5)*w;B=(B-.5)*v;this._bitestAndDistRatio=m.i8888to32(0,0,this._bitSet,f);l.vec2.set(y,E,B);l.vec2.transformMat2d(y,y,u);this._offsetUpperLeft=m.i1616to32(16*y[0],16*y[1]);this._texUpperLeft=m.i1616to32(p,q);l.vec2.set(y,E+w,B);l.vec2.transformMat2d(y,y,u);this._offsetUpperRight=m.i1616to32(16*y[0],16*y[1]);this._texUpperRight=m.i1616to32(x,q);l.vec2.set(y,E,B+v);l.vec2.transformMat2d(y,y,u);this._offsetBottomLeft=m.i1616to32(16*y[0],16*y[1]);this._texBottomLeft=
m.i1616to32(p,A);l.vec2.set(y,E+w,B+v);l.vec2.transformMat2d(y,y,u);this._offsetBottomRight=m.i1616to32(16*y[0],16*y[1]);this._texBottomRight=m.i1616to32(x,A);v=z.MarkerMaterialKey.load(this._materialKey);v.sdf=e.sdf;v.pattern=!0;v.textureBinding=e.textureBinding;this._materialKey=v.data}else D.error(new g("mapview-cim","Encountered an error when binding feature"))};return c}(v.default(p.default));c.default=b})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicTextTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/tsSupport/generatorHelper ../../../../../../core/tsSupport/awaiterHelper ../../../../../../core/screenUtils ../../alignmentUtils ../../color ../../materialKey/MaterialKey ./util ./WGLBaseTextTemplate ./WGLDynamicMeshTemplate ../../../../layers/features/textUtils".split(" "),
function(b,c,e,g,f,a,n,k,d,l,t,x,w){Object.defineProperty(c,"__esModule",{value:!0});b=function(b){function c(c,e){var f=b.call(this,e)||this;f._horizontalAlignment="center";f._verticalAlignment="middle";f._textToGlyphs=new Map;var g=e.scaleFactor||1;f._cimTextLayer=e;l.isFunction(e.color)?f._dynamicPropertyMap.set("_color",function(a,b,c){return k.premultiplyAlphaRGBA(e.color(a,b,c))}):f._color=k.premultiplyAlphaRGBA(e.color);l.isFunction(e.color)?f._dynamicPropertyMap.set("_haloColor",function(a,
b,c){return k.premultiplyAlphaRGBA(e.outlineColor(a,b,c))}):f._haloColor=k.premultiplyAlphaRGBA(e.outlineColor);var h;l.isFunction(e.size)||(h=Math.min(Math.round(a.pt2px(e.size*e.sizeRatio)),127));f._dynamicPropertyMap.set("_size",function(b,c,d){return l.isFunction(e.size)?Math.min(Math.round(a.pt2px(e.size(b,c,d)*e.sizeRatio)),127):h});l.isFunction(e.outlineSize)?f._dynamicPropertyMap.set("_haloSize",function(b,c,d){return Math.min(Math.floor(5*a.pt2px(e.outlineSize(b,c,d)*e.sizeRatio)),127)}):
f._haloSize=Math.min(Math.floor(5*a.pt2px(e.outlineSize*e.sizeRatio)),127);var m;l.isFunction(e.offsetX)||(m=Math.round(a.pt2px(e.offsetX*e.sizeRatio)));f._dynamicPropertyMap.set("_xOffset",function(b,c,d){return l.isFunction(e.offsetX)?Math.round(a.pt2px(e.offsetX(b,c,d)*e.sizeRatio)):m});var n;l.isFunction(e.offsetY)||(n=Math.round(a.pt2px(e.offsetY*e.sizeRatio)));f._dynamicPropertyMap.set("_yOffset",function(b,c,d){return l.isFunction(e.offsetY)?Math.round(a.pt2px(e.offsetY(b,c,d)*e.sizeRatio)):
n});l.isFunction(e.angle)?f._dynamicPropertyMap.set("_angle",e.angle):f._angle=e.angle;l.isFunction(e.horizontalAlignment)?f._dynamicPropertyMap.set("_horizontalAlignment",e.horizontalAlignment):f._horizontalAlignment=e.horizontalAlignment;l.isFunction(e.verticalAlignment)?f._dynamicPropertyMap.set("_verticalAlignment",e.verticalAlignment):f._verticalAlignment=e.verticalAlignment;f._scaleFactor=g;l.isFunction(e.text)?f._dynamicPropertyMap.set("_text",e.text):f._text=e.text;g=Math.min(Math.round(a.pt2px(e.referenceSize*
e.sizeRatio)),127);f._referenceSize=Math.round(Math.sqrt(256*g));f._materialKey=d.createMaterialKey(f.geometryType,c,!1);c=d.TextMaterialKey.load(f._materialKey);c.sdf=!0;f._bitset=e.colorLocked?1:0;f._materialKey=c.data;f._decoration="none";f._lineHeight=1;f._lineWidth=512;f._isCIM=!0;return f}e(c,b);c.fromCIMText=function(a,b){return new c(a,b)};c.prototype.analyze=function(a,b,c,d){return f(this,void 0,void 0,function(){var e,f;return g(this,function(g){switch(g.label){case 0:return g=this._cimTextLayer,
e="string"===typeof g.text?g.text:"function"===typeof g.text?g.text(b,c,d):"",[4,a.getMosaicItem(this._cimTextLayer.cim,!1,w.codepoints(e))];case 1:return f=g.sent(),this._textToGlyphs.set(e,f.glyphMosaicItems),[2,f]}})})};c.prototype.bindFeature=function(a,b,c){var d=this;this._dynamicPropertyMap.forEach(function(e,f){d[f]=e(a,b,c)});if(this._text&&0!==this._text.length){this._size*=this._scaleFactor;this._scale=this._size/24;this._xOffset*=this._scaleFactor;this._yOffset*=this._scaleFactor;this._xAlignD=
n.getXAnchorDirection(this._horizontalAlignment||"center");this._yAlignD=n.getYAnchorDirection(this._verticalAlignment||"baseline");var e=this._textToGlyphs.get(this._text);this.bindTextInfo(e,!1)}else this._shapingInfo=null};return c}(t.default(x.default));c.default=b})},"esri/views/2d/layers/features/textUtils":function(){define(["require","exports"],function(b,c){Object.defineProperty(c,"__esModule",{value:!0});c.codepoints=function(b){for(var c=Array(b.length),e=0;e<b.length;e++)c[e]=b.charCodeAt(e);
return c}})},"esri/views/2d/engine/webgl/mesh/templates/WGLFillTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Logger ../../../../../../core/mathUtils ../../../../../../core/screenUtils ../../../../../../core/libs/earcut/earcut ../../color ../../definitions ../../enums ../../number ../../TileClipper ../../WGLDisplayRecord ../../materialKey/MaterialKey ../Tesselator ./WGLMeshTemplate".split(" "),function(b,c,e,g,f,a,n,k,d,l,t,x,w,m,
z,q){Object.defineProperty(c,"__esModule",{value:!0});var v=g.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLFillTemplate"),p=[],r=[];b=function(b){function c(a,c,e,f,g,h,k,p,n){var r=b.call(this)||this;r.fillColor=e;r.tl=f;r.br=g;r.aux1=h;r.aux2=k;r.aux3=p;r.isBFS=n;r.geometryType=l.WGLGeometryType.FILL;r.forceLibtess=!1;a=m.FillMaterialKey.load(m.createMaterialKey(r.geometryType,a,!1));c&&(a.sdf=c.sdf,a.pattern=!0,a.textureBinding=c.textureBinding);r._materialKey=a.data;r._tesselator=new z.default;
r._tileClipper=new x.TileClipper(0,0,0,1,8);r._tileClipper.setExtent(d.TILE_SIZE);return r}e(c,b);c.fromCIMFill=function(b,d,e,g){void 0===g&&(g=!1);var h=d.color,h=h&&k.premultiplyAlphaRGBA(h)||0,l=t.i8888to32(0,0,0,d.colorLocked?1:0);if(!e)return new c(b,null,h,0,0,0,0,l,g);var l=e.rect,m=e.width,p=e.height,n=l.x+1,r=l.y+1,q=n+m,v=r+p,l=f.nextHighestPowerOfTwo(a.pt2px(d.height||0));255<l?l=255:0>=l&&(l=f.nextHighestPowerOfTwo(v-r));m=f.nextHighestPowerOfTwo(a.pt2px(d.height/p*m||0));255<m?m=255:
0>=m&&(m=f.nextHighestPowerOfTwo(q-n));p=a.pt2px(d.offsetX||0)+128;255<p&&(p=255);var u=a.pt2px(-d.offsetY||0)+128;255<u&&(u=255);d=d.scaleX||1;n=t.i1616to32(n,r);q=t.i1616to32(q,v);l=t.i8888to32(m,l,p,u);d=t.i1616to32(128*d,128);return new c(b,e,h,n,q,l,d,0,g)};c.fromSimpleFill=function(a,b,d,e){void 0===e&&(e=!1);var g=b.color;b=g&&"none"!==b.style&&k.premultiplyAlphaRGBA(g)||0;g=t.i8888to32(0,0,0,e?255:0);if(!d)return new c(a,null,b,0,0,0,0,g,e);var h=d.rect,l=h.x+1,m=h.y+1,p=h.x+1+d.width,n=h.y+
1+d.height,h=t.i1616to32(l,m),r=t.i1616to32(p,n),l=t.i8888to32(f.nextHighestPowerOfTwo(p-l),f.nextHighestPowerOfTwo(n-m),0,0),m=t.i1616to32(128,128);return new c(a,d,b,h,r,l,m,g,e)};c.fromPictureFill=function(b,e,g,h){void 0===h&&(h=!1);var k=d.PICTURE_FILL_COLOR,l=g.rect,m=l.x+1,p=l.y+1,l=m+g.width,n=p+g.height,m=t.i1616to32(m,p),l=t.i1616to32(l,n),n=f.nextHighestPowerOfTwo(a.pt2px(e.width));255<n&&(n=255);p=f.nextHighestPowerOfTwo(a.pt2px(e.height));255<p&&(p=255);var r=a.pt2px(e.xoffset)+128;255<
r&&(r=255);var q=a.pt2px(-e.yoffset)+128;255<q&&(q=255);n=t.i8888to32(n,p,r,q);e=t.i1616to32(128*e.xscale,128*e.yscale);p=t.i8888to32(0,0,0,h?255:0);return new c(b,g,k,m,l,n,e,p,h)};c.prototype.writeMesh=function(a,b,c,d,e){p.length=0;if("esriGeometryPolygon"!==c)"esriGeometryPolyline"!==c&&v.error("Unable to handle geometryType: "+c);else{var f=e.geometry;c=m.FillMaterialKey.load(this._materialKey);var g=(e=this._isClippingRequired(f))?this._clip(f,!1):f.rings;if(c.dotDensity){for(var f=f.rings,
h=0,k=0;k<f.length;k++)for(var l=f[k],n=l[0],r=n[0],n=n[1],q=1;q<l.length;q++)var u=l[q],w=r+u[0],u=n+u[1],h=h-(w-r)*(u+n)/2,r=w,n=u;f=h}else f=0;this.forceLibtess?this._writeMeshLibtess(a,b,d,g,e,c,f):this._writeMeshEarcut(a,b,d,g,e,c,f)||this._writeMeshLibtess(a,b,d,g,e,c,f)}};c.prototype._isClippingRequired=function(a){var b=d.TILE_SIZE+8,c=0;for(a=a.rings;c<a.length;c++){var e=a[c],f=e.length;if(!(3>f)){var g=e[0][0],h=e[0][1];if(-8>g||g>b||-8>h||h>b)return!0;for(var k=1;k<f;++k)if(g+=e[k][0],
h+=e[k][1],-8>g||g>b||-8>h||h>b)return!0}}return!1};c.prototype._clip=function(a,b){var c;this._tileClipper.reset(3);for(var d=0,e=a.rings;d<e.length;d++){var f=e[d],g=f.length;if(!(3>g)){a=f[0][0];c=f[0][1];this._tileClipper.moveTo(a,c);for(var h=1;h<g;++h)a+=f[h][0],c+=f[h][1],this._tileClipper.lineTo(a,c);this._tileClipper.close()}}return this._tileClipper.result(b)};c.prototype._writeMeshLibtess=function(a,b,c,d,e,f,g){if(d&&d.length){var h=[],k=b.indexVector;b=b.getVector("geometry");var l=new w(c,
this.geometryType,this._materialKey),m=b.vertexCount;l.vertexFrom=m;l.indexFrom=k.length;this._tesselator.beginPolygon(p,h);for(var n=0;n<d.length;n++){var r=d[n];if(!(3>r.length)){this._tesselator.beginContour();var q=void 0,v=void 0;e?(q=r[0].x,v=r[0].y):(q=r[0][0],v=r[0][1]);var u=[q,v,0];this._tesselator.addVertex(u,u);for(u=1;u<r.length-1;u++){var t=void 0,y=void 0;e?(q=r[u].x,v=r[u].y):(t=r[u][0],y=r[u][1],q+=t,v+=y);t=[q,v,0];this._tesselator.addVertex(t,t)}this._tesselator.endContour()}}this._tesselator.endPolygon();
this._writeVerticesLibTess(l,b,c,p,f,g);this._writeIndicesLibTess(l,k,m,h);0<l.indexCount&&a.push(l)}};c.prototype._writeMeshEarcut=function(a,b,c,d,e,f,g){if(d&&d.length){var h=b.indexVector;b=b.getVector("geometry");var k=new w(c,this.geometryType,this._materialKey),l=h.length,m=b.data.length;k.vertexFrom=b.vertexCount;k.indexFrom=h.length;for(var n=0,q=0,v=0;v<d.length;v++){var u=d[v],t=q,y=void 0,x=void 0;e?(y=u[0].x,x=u[0].y):(y=u[0][0],x=u[0][1]);p[q++]=y;p[q++]=x;for(var z=0,A=1;A<u.length;++A){var B=
void 0,C=void 0;e?(B=y,C=x,y=u[A].x,x=u[A].y,B=y-B,C=x-C):(B=u[A][0],C=u[A][1],y+=B,x+=C);z-=B*(x+x-C);p[q++]=y;p[q++]=x}if(0<z){if(0<t-n){if(!this._write(k,h,b,c,p,r,n,t,f,g))return h.seek(l),b.data.seek(m),p.length=r.length=0,!1;n=t}r.length=0}else 0>z?0<t-n?r.push(.5*(t-n)):q=t:q=t}if(0<q-n&&!this._write(k,h,b,c,p,r,n,q,f,g))return h.seek(l),b.data.seek(m),p.length=r.length=0,!1;p.length=r.length=0;a.push(k);return!0}};c.prototype._write=function(a,b,c,d,e,f,g,h,k,l){e=e.slice(g,h);g=n.earcut(e,
f,2);if(0<n.deviation(e,f,2,g))return!1;if(g.length)return f=c.vertexCount,this._writeVertices(a,c,d,e,k,l),this._writeIndices(a,b,f,g),!0};c.prototype._writeVertices=function(a,b,c,d,e,f){for(var g=0;g<d.length;g+=2){var h=t.i1616to32(d[g],d[g+1]);b.data.push(h);b.data.push(c);e.dotDensity?b.data.writeF32(1/f):(b.data.push(this.fillColor),b.data.push(this.tl),b.data.push(this.br),b.data.push(this.aux1),b.data.push(this.aux2),b.data.push(this.aux3));a.vertexCount++}};c.prototype._writeIndices=function(a,
b,c,d){for(var e=0;e<d.length;e+=3)b.push(c+d[e]),b.push(c+d[e+1]),b.push(c+d[e+2]),a.indexCount+=3};c.prototype._writeVerticesLibTess=function(a,b,c,d,e,f){for(var g=0;g<d.length;g+=2){var h=t.i1616to32(d[g],d[g+1]);b.data.push(h);b.data.push(c);e.dotDensity?b.data.writeF32(1/f):(b.data.push(this.fillColor),b.data.push(this.tl),b.data.push(this.br),b.data.push(this.aux1),b.data.push(this.aux2),b.data.push(this.aux3));a.vertexCount++}};c.prototype._writeIndicesLibTess=function(a,b,c,d){for(var e=
0;e<d.length;e++)b.push(c+d[e]),a.indexCount++};return c}(q.default);c.default=b})},"esri/views/2d/engine/webgl/mesh/Tesselator":function(){define(["require","exports","../../../../../core/Logger","../../../../../core/libs/libtess/libtess"],function(b,c,e,g){Object.defineProperty(c,"__esModule",{value:!0});var f=e.getLogger("esri.views.2d.engine.webgl.mesh.templates.Tesselator");b=function(){function a(){this._indexCounter=this._currentVertexIndex=0;this._triangleIndices=[-1,-1,-1];this.glu=new g.GluTesselator;
this.glu.gluTessCallback(g.gluEnum.GLU_TESS_BEGIN,this._begincallback.bind(this));this.glu.gluTessCallback(g.gluEnum.GLU_TESS_VERTEX_DATA,this._vertexCallback.bind(this));this.glu.gluTessCallback(g.gluEnum.GLU_TESS_END,this._endcallback.bind(this));this.glu.gluTessCallback(g.gluEnum.GLU_TESS_COMBINE,this._combinecallback.bind(this));this.glu.gluTessCallback(g.gluEnum.GLU_TESS_ERROR,this._errorcallback.bind(this));this.glu.gluTessCallback(g.gluEnum.GLU_TESS_EDGE_FLAG,this._edgeCallback.bind(this));
this.glu.gluTessProperty(g.gluEnum.GLU_TESS_WINDING_RULE,g.windingRule.GLU_TESS_WINDING_ODD)}a.prototype.beginPolygon=function(a,b){this._triangleIndices[0]=-1;this._triangleIndices[1]=-1;this._triangleIndices[2]=-1;this._indexCounter=this._currentVertexIndex=0;this.glu.gluTessBeginPolygon(a);this._indices=b};a.prototype.endPolygon=function(){this.glu.gluTessEndPolygon()};a.prototype.beginContour=function(){this.glu.gluTessBeginContour()};a.prototype.endContour=function(){this.glu.gluTessEndContour()};
a.prototype.addVertex=function(a,b){this.glu.gluTessVertex(a,b)};a.prototype._vertexCallback=function(a,b){b[b.length]=a[0];b[b.length]=a[1];this._triangleIndices[this._currentVertexIndex]=-1;if(2<=this._currentVertexIndex){for(a=0;3>a;a++)-1===this._triangleIndices[a]&&(this._triangleIndices[a]=this._indexCounter++),this._indices[this._indices.length]=this._triangleIndices[a];this._currentVertexIndex=0}else this._currentVertexIndex++};a.prototype._begincallback=function(){this._triangleIndices[0]=
-1;this._triangleIndices[1]=-1;this._triangleIndices[2]=-1;this._currentVertexIndex=0};a.prototype._endcallback=function(){this._currentVertexIndex=0};a.prototype._errorcallback=function(a){f.error("Encountered error during tesselation: "+a)};a.prototype._combinecallback=function(a){return[a[0],a[1],a[2]]};a.prototype._edgeCallback=function(){};return a}();c.default=b})},"esri/core/libs/libtess/libtess":function(){define([],function(){var b={DEBUG:!1,assert:function(c,e){if(b.DEBUG&&!c)throw Error("Assertion failed"+
(e?": "+e:""));},GLU_TESS_MAX_COORD:1E150,TRUE_PROJECT:!1,GLU_TESS_DEFAULT_TOLERANCE:0,windingRule:{GLU_TESS_WINDING_ODD:100130,GLU_TESS_WINDING_NONZERO:100131,GLU_TESS_WINDING_POSITIVE:100132,GLU_TESS_WINDING_NEGATIVE:100133,GLU_TESS_WINDING_ABS_GEQ_TWO:100134},primitiveType:{GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,GL_TRIANGLE_FAN:6},errorType:{GLU_TESS_MISSING_BEGIN_POLYGON:100151,GLU_TESS_MISSING_END_POLYGON:100153,GLU_TESS_MISSING_BEGIN_CONTOUR:100152,GLU_TESS_MISSING_END_CONTOUR:100154,
GLU_TESS_COORD_TOO_LARGE:100155,GLU_TESS_NEED_COMBINE_CALLBACK:100156},gluEnum:{GLU_TESS_BEGIN:100100,GLU_TESS_VERTEX:100101,GLU_TESS_END:100102,GLU_TESS_ERROR:100103,GLU_TESS_EDGE_FLAG:100104,GLU_TESS_COMBINE:100105,GLU_TESS_BEGIN_DATA:100106,GLU_TESS_VERTEX_DATA:100107,GLU_TESS_END_DATA:100108,GLU_TESS_ERROR_DATA:100109,GLU_TESS_EDGE_FLAG_DATA:100110,GLU_TESS_COMBINE_DATA:100111,GLU_TESS_MESH:100112,GLU_TESS_TOLERANCE:100142,GLU_TESS_WINDING_RULE:100140,GLU_TESS_BOUNDARY_ONLY:100141,GLU_INVALID_ENUM:100900,
GLU_INVALID_VALUE:100901},geom:{}};b.geom.vertEq=function(b,e){return b.s===e.s&&b.t===e.t};b.geom.vertLeq=function(b,e){return b.s<e.s||b.s===e.s&&b.t<=e.t};b.geom.edgeEval=function(c,e,g){b.assert(b.geom.vertLeq(c,e)&&b.geom.vertLeq(e,g));var f=e.s-c.s,a=g.s-e.s;return 0<f+a?f<a?e.t-c.t+f/(f+a)*(c.t-g.t):e.t-g.t+a/(f+a)*(g.t-c.t):0};b.geom.edgeSign=function(c,e,g){b.assert(b.geom.vertLeq(c,e)&&b.geom.vertLeq(e,g));var f=e.s-c.s,a=g.s-e.s;return 0<f+a?(e.t-g.t)*f+(e.t-c.t)*a:0};b.geom.transLeq=function(b,
e){return b.t<e.t||b.t===e.t&&b.s<=e.s};b.geom.transEval=function(c,e,g){b.assert(b.geom.transLeq(c,e)&&b.geom.transLeq(e,g));var f=e.t-c.t,a=g.t-e.t;return 0<f+a?f<a?e.s-c.s+f/(f+a)*(c.s-g.s):e.s-g.s+a/(f+a)*(g.s-c.s):0};b.geom.transSign=function(c,e,g){b.assert(b.geom.transLeq(c,e)&&b.geom.transLeq(e,g));var f=e.t-c.t,a=g.t-e.t;return 0<f+a?(e.s-g.s)*f+(e.s-c.s)*a:0};b.geom.edgeGoesLeft=function(c){return b.geom.vertLeq(c.dst(),c.org)};b.geom.edgeGoesRight=function(c){return b.geom.vertLeq(c.org,
c.dst())};b.geom.vertL1dist=function(b,e){return Math.abs(b.s-e.s)+Math.abs(b.t-e.t)};b.geom.vertCCW=function(b,e,g){return 0<=b.s*(e.t-g.t)+e.s*(g.t-b.t)+g.s*(b.t-e.t)};b.geom.interpolate_=function(b,e,g,f){b=0>b?0:b;g=0>g?0:g;return b<=g?0===g?(e+f)/2:e+b/(b+g)*(f-e):f+g/(b+g)*(e-f)};b.geom.edgeIntersect=function(c,e,g,f,a){var n,k;b.geom.vertLeq(c,e)||(n=c,c=e,e=n);b.geom.vertLeq(g,f)||(n=g,g=f,f=n);b.geom.vertLeq(c,g)||(n=c,c=g,g=n,n=e,e=f,f=n);b.geom.vertLeq(g,e)?b.geom.vertLeq(e,f)?(n=b.geom.edgeEval(c,
g,e),k=b.geom.edgeEval(g,e,f),0>n+k&&(n=-n,k=-k),a.s=b.geom.interpolate_(n,g.s,k,e.s)):(n=b.geom.edgeSign(c,g,e),k=-b.geom.edgeSign(c,f,e),0>n+k&&(n=-n,k=-k),a.s=b.geom.interpolate_(n,g.s,k,f.s)):a.s=(g.s+e.s)/2;b.geom.transLeq(c,e)||(n=c,c=e,e=n);b.geom.transLeq(g,f)||(n=g,g=f,f=n);b.geom.transLeq(c,g)||(n=c,c=g,g=n,n=e,e=f,f=n);b.geom.transLeq(g,e)?b.geom.transLeq(e,f)?(n=b.geom.transEval(c,g,e),k=b.geom.transEval(g,e,f),0>n+k&&(n=-n,k=-k),a.t=b.geom.interpolate_(n,g.t,k,e.t)):(n=b.geom.transSign(c,
g,e),k=-b.geom.transSign(c,f,e),0>n+k&&(n=-n,k=-k),a.t=b.geom.interpolate_(n,g.t,k,f.t)):a.t=(g.t+e.t)/2};b.mesh={};b.mesh.makeEdge=function(c){var e=b.mesh.makeEdgePair_(c.eHead);b.mesh.makeVertex_(e,c.vHead);b.mesh.makeVertex_(e.sym,c.vHead);b.mesh.makeFace_(e,c.fHead);return e};b.mesh.meshSplice=function(c,e){var g=!1,f=!1;c!==e&&(e.org!==c.org&&(f=!0,b.mesh.killVertex_(e.org,c.org)),e.lFace!==c.lFace&&(g=!0,b.mesh.killFace_(e.lFace,c.lFace)),b.mesh.splice_(e,c),f||(b.mesh.makeVertex_(e,c.org),
c.org.anEdge=c),g||(b.mesh.makeFace_(e,c.lFace),c.lFace.anEdge=c))};b.mesh.deleteEdge=function(c){var e=c.sym,g=!1;c.lFace!==c.rFace()&&(g=!0,b.mesh.killFace_(c.lFace,c.rFace()));c.oNext===c?b.mesh.killVertex_(c.org,null):(c.rFace().anEdge=c.oPrev(),c.org.anEdge=c.oNext,b.mesh.splice_(c,c.oPrev()),g||b.mesh.makeFace_(c,c.lFace));e.oNext===e?(b.mesh.killVertex_(e.org,null),b.mesh.killFace_(e.lFace,null)):(c.lFace.anEdge=e.oPrev(),e.org.anEdge=e.oNext,b.mesh.splice_(e,e.oPrev()));b.mesh.killEdge_(c)};
b.mesh.addEdgeVertex=function(c){var e=b.mesh.makeEdgePair_(c),g=e.sym;b.mesh.splice_(e,c.lNext);e.org=c.dst();b.mesh.makeVertex_(g,e.org);e.lFace=g.lFace=c.lFace;return e};b.mesh.splitEdge=function(c){var e=b.mesh.addEdgeVertex(c).sym;b.mesh.splice_(c.sym,c.sym.oPrev());b.mesh.splice_(c.sym,e);c.sym.org=e.org;e.dst().anEdge=e.sym;e.sym.lFace=c.rFace();e.winding=c.winding;e.sym.winding=c.sym.winding;return e};b.mesh.connect=function(c,e){var g=!1,f=b.mesh.makeEdgePair_(c),a=f.sym;e.lFace!==c.lFace&&
(g=!0,b.mesh.killFace_(e.lFace,c.lFace));b.mesh.splice_(f,c.lNext);b.mesh.splice_(a,e);f.org=c.dst();a.org=e.org;f.lFace=a.lFace=c.lFace;c.lFace.anEdge=a;g||b.mesh.makeFace_(f,c.lFace);return f};b.mesh.zapFace=function(c){var e=c.anEdge,g=e.lNext,f;do if(f=g,g=f.lNext,f.lFace=null,null===f.rFace()){f.oNext===f?b.mesh.killVertex_(f.org,null):(f.org.anEdge=f.oNext,b.mesh.splice_(f,f.oPrev()));var a=f.sym;a.oNext===a?b.mesh.killVertex_(a.org,null):(a.org.anEdge=a.oNext,b.mesh.splice_(a,a.oPrev()));b.mesh.killEdge_(f)}while(f!==
e);e=c.prev;c=c.next;c.prev=e;e.next=c};b.mesh.meshUnion=function(b,e){var c=b.fHead,f=b.vHead,a=b.eHead,n=e.fHead,k=e.vHead;e=e.eHead;n.next!==n&&(c.prev.next=n.next,n.next.prev=c.prev,n.prev.next=c,c.prev=n.prev);k.next!==k&&(f.prev.next=k.next,k.next.prev=f.prev,k.prev.next=f,f.prev=k.prev);e.next!==e&&(a.sym.next.sym.next=e.next,e.next.sym.next=a.sym.next,e.sym.next.sym.next=a,a.sym.next=e.sym.next);return b};b.mesh.deleteMesh=function(b){};b.mesh.makeEdgePair_=function(c){var e=new b.GluHalfEdge,
g=new b.GluHalfEdge,f=c.sym.next;g.next=f;f.sym.next=e;e.next=c;c.sym.next=g;e.sym=g;e.oNext=e;e.lNext=g;g.sym=e;g.oNext=g;return g.lNext=e};b.mesh.splice_=function(b,e){var c=b.oNext,f=e.oNext;c.sym.lNext=e;f.sym.lNext=b;b.oNext=f;e.oNext=c};b.mesh.makeVertex_=function(c,e){var g=e.prev,f=new b.GluVertex(e,g);g.next=f;e.prev=f;e=f.anEdge=c;do e.org=f,e=e.oNext;while(e!==c)};b.mesh.makeFace_=function(c,e){var g=e.prev,f=new b.GluFace(e,g);g.next=f;e.prev=f;f.anEdge=c;f.inside=e.inside;e=c;do e.lFace=
f,e=e.lNext;while(e!==c)};b.mesh.killEdge_=function(b){var c=b.next;b=b.sym.next;c.sym.next=b;b.sym.next=c};b.mesh.killVertex_=function(b,e){var c=b.anEdge,f=c;do f.org=e,f=f.oNext;while(f!==c);e=b.prev;b=b.next;b.prev=e;e.next=b};b.mesh.killFace_=function(b,e){var c=b.anEdge,f=c;do f.lFace=e,f=f.lNext;while(f!==c);e=b.prev;b=b.next;b.prev=e;e.next=b};b.normal={};b.normal.S_UNIT_X_=1;b.normal.S_UNIT_Y_=0;b.normal.projectPolygon=function(c,e,g,f){var a=!1,n=[e,g,f];0===e&&0===g&&0===f&&(b.normal.computeNormal_(c,
n),a=!0);g=b.normal.longAxis_(n);e=c.mesh.vHead;if(b.TRUE_PROJECT){b.normal.normalize_(n);f=[0,0,0];var k=[0,0,0];f[g]=0;f[(g+1)%3]=b.normal.S_UNIT_X_;f[(g+2)%3]=b.normal.S_UNIT_Y_;g=b.normal.dot_(f,n);f[0]-=g*n[0];f[1]-=g*n[1];f[2]-=g*n[2];b.normal.normalize_(f);k[0]=n[1]*f[2]-n[2]*f[1];k[1]=n[2]*f[0]-n[0]*f[2];k[2]=n[0]*f[1]-n[1]*f[0];b.normal.normalize_(k);for(n=e.next;n!==e;n=n.next)n.s=b.normal.dot_(n.coords,f),n.t=b.normal.dot_(n.coords,k)}else for(f=(g+1)%3,k=(g+2)%3,g=0<n[g]?1:-1,n=e.next;n!==
e;n=n.next)n.s=n.coords[f],n.t=g*n.coords[k];a&&b.normal.checkOrientation_(c)};b.normal.dot_=function(b,e){return b[0]*e[0]+b[1]*e[1]+b[2]*e[2]};b.normal.normalize_=function(c){var e=c[0]*c[0]+c[1]*c[1]+c[2]*c[2];b.assert(0<e);e=Math.sqrt(e);c[0]/=e;c[1]/=e;c[2]/=e};b.normal.longAxis_=function(b){var c=0;Math.abs(b[1])>Math.abs(b[0])&&(c=1);Math.abs(b[2])>Math.abs(b[c])&&(c=2);return c};b.normal.computeNormal_=function(c,e){var g=[-2*b.GLU_TESS_MAX_COORD,-2*b.GLU_TESS_MAX_COORD,-2*b.GLU_TESS_MAX_COORD],
f=[2*b.GLU_TESS_MAX_COORD,2*b.GLU_TESS_MAX_COORD,2*b.GLU_TESS_MAX_COORD],a=[],n=[],k;c=c.mesh.vHead;for(k=c.next;k!==c;k=k.next)for(var d=0;3>d;++d){var l=k.coords[d];l<f[d]&&(f[d]=l,n[d]=k);l>g[d]&&(g[d]=l,a[d]=k)}k=0;g[1]-f[1]>g[0]-f[0]&&(k=1);g[2]-f[2]>g[k]-f[k]&&(k=2);if(f[k]>=g[k])e[0]=0,e[1]=0,e[2]=1;else{g=0;f=n[k];a=a[k];n=[0,0,0];f=[f.coords[0]-a.coords[0],f.coords[1]-a.coords[1],f.coords[2]-a.coords[2]];d=[0,0,0];for(k=c.next;k!==c;k=k.next)d[0]=k.coords[0]-a.coords[0],d[1]=k.coords[1]-
a.coords[1],d[2]=k.coords[2]-a.coords[2],n[0]=f[1]*d[2]-f[2]*d[1],n[1]=f[2]*d[0]-f[0]*d[2],n[2]=f[0]*d[1]-f[1]*d[0],l=n[0]*n[0]+n[1]*n[1]+n[2]*n[2],l>g&&(g=l,e[0]=n[0],e[1]=n[1],e[2]=n[2]);0>=g&&(e[0]=e[1]=e[2]=0,e[b.normal.longAxis_(f)]=1)}};b.normal.checkOrientation_=function(b){for(var c=0,g=b.mesh.fHead,f=g.next;f!==g;f=f.next){var a=f.anEdge;if(!(0>=a.winding)){do c+=(a.org.s-a.dst().s)*(a.org.t+a.dst().t),a=a.lNext;while(a!==f.anEdge)}}if(0>c)for(b=b.mesh.vHead,c=b.next;c!==b;c=c.next)c.t=-c.t};
b.render={};b.render.renderMesh=function(c,e,g){for(var f=!1,a=-1,n=e.fHead.prev;n!==e.fHead;n=n.prev)if(n.inside){f||(c.callBeginCallback(b.primitiveType.GL_TRIANGLES),f=!0);var k=n.anEdge;b.assert(k.lNext.lNext.lNext===k,"renderMesh called with non-triangulated mesh");do{if(g){var d=k.rFace().inside?0:1;a!==d&&(a=d,c.callEdgeFlagCallback(!!a))}c.callVertexCallback(k.org.data);k=k.lNext}while(k!==n.anEdge)}f&&c.callEndCallback()};b.render.renderBoundary=function(c,e){for(var g=e.fHead.next;g!==e.fHead;g=
g.next)if(g.inside){c.callBeginCallback(b.primitiveType.GL_LINE_LOOP);var f=g.anEdge;do c.callVertexCallback(f.org.data),f=f.lNext;while(f!==g.anEdge);c.callEndCallback()}};b.sweep={};b.sweep.SENTINEL_COORD_=4*b.GLU_TESS_MAX_COORD;b.sweep.TOLERANCE_NONZERO_=!1;b.sweep.computeInterior=function(c){c.fatalError=!1;b.sweep.removeDegenerateEdges_(c);b.sweep.initPriorityQ_(c);b.sweep.initEdgeDict_(c);for(var e;null!==(e=c.pq.extractMin());){for(;;){var g=c.pq.minimum();if(null===g||!b.geom.vertEq(g,e))break;
g=c.pq.extractMin();b.sweep.spliceMergeVertices_(c,e.anEdge,g.anEdge)}b.sweep.sweepEvent_(c,e)}e=c.dict.getMin().getKey();c.event=e.eUp.org;b.sweep.doneEdgeDict_(c);b.sweep.donePriorityQ_(c);b.sweep.removeDegenerateFaces_(c.mesh);c.mesh.checkMesh()};b.sweep.addWinding_=function(b,e){b.winding+=e.winding;b.sym.winding+=e.sym.winding};b.sweep.edgeLeq_=function(c,e,g){c=c.event;e=e.eUp;g=g.eUp;if(e.dst()===c)return g.dst()===c?b.geom.vertLeq(e.org,g.org)?0>=b.geom.edgeSign(g.dst(),e.org,g.org):0<=b.geom.edgeSign(e.dst(),
g.org,e.org):0>=b.geom.edgeSign(g.dst(),c,g.org);if(g.dst()===c)return 0<=b.geom.edgeSign(e.dst(),c,e.org);e=b.geom.edgeEval(e.dst(),c,e.org);c=b.geom.edgeEval(g.dst(),c,g.org);return e>=c};b.sweep.deleteRegion_=function(c,e){e.fixUpperEdge&&b.assert(0===e.eUp.winding);e.eUp.activeRegion=null;c.dict.deleteNode(e.nodeUp);e.nodeUp=null};b.sweep.fixUpperEdge_=function(c,e){b.assert(c.fixUpperEdge);b.mesh.deleteEdge(c.eUp);c.fixUpperEdge=!1;c.eUp=e;e.activeRegion=c};b.sweep.topLeftRegion_=function(c){var e=
c.eUp.org;do c=c.regionAbove();while(c.eUp.org===e);c.fixUpperEdge&&(e=b.mesh.connect(c.regionBelow().eUp.sym,c.eUp.lNext),b.sweep.fixUpperEdge_(c,e),c=c.regionAbove());return c};b.sweep.topRightRegion_=function(b){var c=b.eUp.dst();do b=b.regionAbove();while(b.eUp.dst()===c);return b};b.sweep.addRegionBelow_=function(c,e,g){var f=new b.ActiveRegion;f.eUp=g;f.nodeUp=c.dict.insertBefore(e.nodeUp,f);return g.activeRegion=f};b.sweep.isWindingInside_=function(c,e){switch(c.windingRule){case b.windingRule.GLU_TESS_WINDING_ODD:return 0!==
(e&1);case b.windingRule.GLU_TESS_WINDING_NONZERO:return 0!==e;case b.windingRule.GLU_TESS_WINDING_POSITIVE:return 0<e;case b.windingRule.GLU_TESS_WINDING_NEGATIVE:return 0>e;case b.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:return 2<=e||-2>=e}b.assert(!1);return!1};b.sweep.computeWinding_=function(c,e){e.windingNumber=e.regionAbove().windingNumber+e.eUp.winding;e.inside=b.sweep.isWindingInside_(c,e.windingNumber)};b.sweep.finishRegion_=function(c,e){var g=e.eUp,f=g.lFace;f.inside=e.inside;f.anEdge=
g;b.sweep.deleteRegion_(c,e)};b.sweep.finishLeftRegions_=function(c,e,g){var f=e;for(e=e.eUp;f!==g;){f.fixUpperEdge=!1;var a=f.regionBelow(),n=a.eUp;if(n.org!==e.org){if(!a.fixUpperEdge){b.sweep.finishRegion_(c,f);break}n=b.mesh.connect(e.lPrev(),n.sym);b.sweep.fixUpperEdge_(a,n)}e.oNext!==n&&(b.mesh.meshSplice(n.oPrev(),n),b.mesh.meshSplice(e,n));b.sweep.finishRegion_(c,f);e=a.eUp;f=a}return e};b.sweep.addRightEdges_=function(c,e,g,f,a,n){var k=!0;do b.assert(b.geom.vertLeq(g.org,g.dst())),b.sweep.addRegionBelow_(c,
e,g.sym),g=g.oNext;while(g!==f);for(null===a&&(a=e.regionBelow().eUp.rPrev());;){f=e.regionBelow();g=f.eUp.sym;if(g.org!==a.org)break;g.oNext!==a&&(b.mesh.meshSplice(g.oPrev(),g),b.mesh.meshSplice(a.oPrev(),g));f.windingNumber=e.windingNumber-g.winding;f.inside=b.sweep.isWindingInside_(c,f.windingNumber);e.dirty=!0;!k&&b.sweep.checkForRightSplice_(c,e)&&(b.sweep.addWinding_(g,a),b.sweep.deleteRegion_(c,e),b.mesh.deleteEdge(a));k=!1;e=f;a=g}e.dirty=!0;b.assert(e.windingNumber-g.winding===f.windingNumber);
n&&b.sweep.walkDirtyRegions_(c,e)};b.sweep.callCombine_=function(c,e,g,f,a){var n=[e.coords[0],e.coords[1],e.coords[2]];e.data=null;e.data=c.callCombineCallback(n,g,f);null===e.data&&(a?c.fatalError||(c.callErrorCallback(b.errorType.GLU_TESS_NEED_COMBINE_CALLBACK),c.fatalError=!0):e.data=g[0])};b.sweep.spliceMergeVertices_=function(c,e,g){var f=[null,null,null,null];f[0]=e.org.data;f[1]=g.org.data;b.sweep.callCombine_(c,e.org,f,[.5,.5,0,0],!1);b.mesh.meshSplice(e,g)};b.sweep.vertexWeights_=function(c,
e,g,f,a){var n=b.geom.vertL1dist(e,c),k=b.geom.vertL1dist(g,c),d=a+1;f[a]=.5*k/(n+k);f[d]=.5*n/(n+k);c.coords[0]+=f[a]*e.coords[0]+f[d]*g.coords[0];c.coords[1]+=f[a]*e.coords[1]+f[d]*g.coords[1];c.coords[2]+=f[a]*e.coords[2]+f[d]*g.coords[2]};b.sweep.getIntersectData_=function(c,e,g,f,a,n){var k=[0,0,0,0],d=[g.data,f.data,a.data,n.data];e.coords[0]=e.coords[1]=e.coords[2]=0;b.sweep.vertexWeights_(e,g,f,k,0);b.sweep.vertexWeights_(e,a,n,k,2);b.sweep.callCombine_(c,e,d,k,!0)};b.sweep.checkForRightSplice_=
function(c,e){var g=e.regionBelow(),f=e.eUp,a=g.eUp;if(b.geom.vertLeq(f.org,a.org)){if(0<b.geom.edgeSign(a.dst(),f.org,a.org))return!1;b.geom.vertEq(f.org,a.org)?f.org!==a.org&&(c.pq.remove(f.org.pqHandle),b.sweep.spliceMergeVertices_(c,a.oPrev(),f)):(b.mesh.splitEdge(a.sym),b.mesh.meshSplice(f,a.oPrev()),e.dirty=g.dirty=!0)}else{if(0>b.geom.edgeSign(f.dst(),a.org,f.org))return!1;e.regionAbove().dirty=e.dirty=!0;b.mesh.splitEdge(f.sym);b.mesh.meshSplice(a.oPrev(),f)}return!0};b.sweep.checkForLeftSplice_=
function(c,e){var g=e.regionBelow();c=e.eUp;var f=g.eUp;b.assert(!b.geom.vertEq(c.dst(),f.dst()));if(b.geom.vertLeq(c.dst(),f.dst())){if(0>b.geom.edgeSign(c.dst(),f.dst(),c.org))return!1;e.regionAbove().dirty=e.dirty=!0;g=b.mesh.splitEdge(c);b.mesh.meshSplice(f.sym,g);g.lFace.inside=e.inside}else{if(0<b.geom.edgeSign(f.dst(),c.dst(),f.org))return!1;e.dirty=g.dirty=!0;g=b.mesh.splitEdge(f);b.mesh.meshSplice(c.lNext,f.sym);g.rFace().inside=e.inside}return!0};b.sweep.checkForIntersect_=function(c,e){var g=
e.regionBelow(),f=e.eUp,a=g.eUp,n=f.org,k=a.org,d=f.dst(),l=a.dst(),t=new b.GluVertex;b.assert(!b.geom.vertEq(l,d));b.assert(0>=b.geom.edgeSign(d,c.event,n));b.assert(0<=b.geom.edgeSign(l,c.event,k));b.assert(n!==c.event&&k!==c.event);b.assert(!e.fixUpperEdge&&!g.fixUpperEdge);if(n===k||Math.min(n.t,d.t)>Math.max(k.t,l.t))return!1;if(b.geom.vertLeq(n,k)){if(0<b.geom.edgeSign(l,n,k))return!1}else if(0>b.geom.edgeSign(d,k,n))return!1;b.geom.edgeIntersect(d,n,l,k,t);b.assert(Math.min(n.t,d.t)<=t.t);
b.assert(t.t<=Math.max(k.t,l.t));b.assert(Math.min(l.s,d.s)<=t.s);b.assert(t.s<=Math.max(k.s,n.s));b.geom.vertLeq(t,c.event)&&(t.s=c.event.s,t.t=c.event.t);var x=b.geom.vertLeq(n,k)?n:k;b.geom.vertLeq(x,t)&&(t.s=x.s,t.t=x.t);if(b.geom.vertEq(t,n)||b.geom.vertEq(t,k))return b.sweep.checkForRightSplice_(c,e),!1;if(!b.geom.vertEq(d,c.event)&&0<=b.geom.edgeSign(d,c.event,t)||!b.geom.vertEq(l,c.event)&&0>=b.geom.edgeSign(l,c.event,t)){if(l===c.event)return b.mesh.splitEdge(f.sym),b.mesh.meshSplice(a.sym,
f),e=b.sweep.topLeftRegion_(e),f=e.regionBelow().eUp,b.sweep.finishLeftRegions_(c,e.regionBelow(),g),b.sweep.addRightEdges_(c,e,f.oPrev(),f,f,!0),!0;if(d===c.event)return b.mesh.splitEdge(a.sym),b.mesh.meshSplice(f.lNext,a.oPrev()),g=e,e=b.sweep.topRightRegion_(e),n=e.regionBelow().eUp.rPrev(),g.eUp=a.oPrev(),a=b.sweep.finishLeftRegions_(c,g,null),b.sweep.addRightEdges_(c,e,a.oNext,f.rPrev(),n,!0),!0;0<=b.geom.edgeSign(d,c.event,t)&&(e.regionAbove().dirty=e.dirty=!0,b.mesh.splitEdge(f.sym),f.org.s=
c.event.s,f.org.t=c.event.t);0>=b.geom.edgeSign(l,c.event,t)&&(e.dirty=g.dirty=!0,b.mesh.splitEdge(a.sym),a.org.s=c.event.s,a.org.t=c.event.t);return!1}b.mesh.splitEdge(f.sym);b.mesh.splitEdge(a.sym);b.mesh.meshSplice(a.oPrev(),f);f.org.s=t.s;f.org.t=t.t;f.org.pqHandle=c.pq.insert(f.org);b.sweep.getIntersectData_(c,f.org,n,d,k,l);e.regionAbove().dirty=e.dirty=g.dirty=!0;return!1};b.sweep.walkDirtyRegions_=function(c,e){for(var g=e.regionBelow();;){for(;g.dirty;)e=g,g=g.regionBelow();if(!e.dirty&&
(g=e,e=e.regionAbove(),null===e||!e.dirty))break;e.dirty=!1;var f=e.eUp,a=g.eUp;f.dst()!==a.dst()&&b.sweep.checkForLeftSplice_(c,e)&&(g.fixUpperEdge?(b.sweep.deleteRegion_(c,g),b.mesh.deleteEdge(a),g=e.regionBelow(),a=g.eUp):e.fixUpperEdge&&(b.sweep.deleteRegion_(c,e),b.mesh.deleteEdge(f),e=g.regionAbove(),f=e.eUp));if(f.org!==a.org)if(f.dst()===a.dst()||e.fixUpperEdge||g.fixUpperEdge||f.dst()!==c.event&&a.dst()!==c.event)b.sweep.checkForRightSplice_(c,e);else if(b.sweep.checkForIntersect_(c,e))break;
f.org===a.org&&f.dst()===a.dst()&&(b.sweep.addWinding_(a,f),b.sweep.deleteRegion_(c,e),b.mesh.deleteEdge(f),e=g.regionAbove())}};b.sweep.connectRightVertex_=function(c,e,g){var f=g.oNext,a=e.regionBelow(),n=e.eUp,k=a.eUp,d=!1;n.dst()!==k.dst()&&b.sweep.checkForIntersect_(c,e);b.geom.vertEq(n.org,c.event)&&(b.mesh.meshSplice(f.oPrev(),n),e=b.sweep.topLeftRegion_(e),f=e.regionBelow().eUp,b.sweep.finishLeftRegions_(c,e.regionBelow(),a),d=!0);b.geom.vertEq(k.org,c.event)&&(b.mesh.meshSplice(g,k.oPrev()),
g=b.sweep.finishLeftRegions_(c,a,null),d=!0);d?b.sweep.addRightEdges_(c,e,g.oNext,f,f,!0):(f=b.geom.vertLeq(k.org,n.org)?k.oPrev():n,f=b.mesh.connect(g.lPrev(),f),b.sweep.addRightEdges_(c,e,f,f.oNext,f.oNext,!1),f.sym.activeRegion.fixUpperEdge=!0,b.sweep.walkDirtyRegions_(c,e))};b.sweep.connectLeftDegenerate_=function(c,e,g){var f=e.eUp;if(b.geom.vertEq(f.org,g))b.assert(b.sweep.TOLERANCE_NONZERO_),b.sweep.TOLERANCE_NONZERO_&&b.sweep.spliceMergeVertices_(c,f,g.anEdge);else if(b.geom.vertEq(f.dst(),
g)){if(b.assert(b.sweep.TOLERANCE_NONZERO_),b.sweep.TOLERANCE_NONZERO_){e=b.sweep.topRightRegion_(e);var f=e.regionBelow(),a=f.eUp.sym,n=a.oNext,k=n;f.fixUpperEdge&&(b.assert(n!==a),b.sweep.deleteRegion_(c,f),b.mesh.deleteEdge(a),a=n.oPrev());b.mesh.meshSplice(g.anEdge,a);b.geom.edgeGoesLeft(n)||(n=null);b.sweep.addRightEdges_(c,e,a.oNext,k,n,!0)}}else b.mesh.splitEdge(f.sym),e.fixUpperEdge&&(b.mesh.deleteEdge(f.oNext),e.fixUpperEdge=!1),b.mesh.meshSplice(g.anEdge,f),b.sweep.sweepEvent_(c,g)};b.sweep.connectLeftVertex_=
function(c,e){var g=new b.ActiveRegion;g.eUp=e.anEdge.sym;var g=c.dict.search(g).getKey(),f=g.regionBelow(),a=g.eUp,n=f.eUp;0===b.geom.edgeSign(a.dst(),e,a.org)?b.sweep.connectLeftDegenerate_(c,g,e):(f=b.geom.vertLeq(n.dst(),a.dst())?g:f,g.inside||f.fixUpperEdge?(a=f===g?b.mesh.connect(e.anEdge.sym,a.lNext):b.mesh.connect(n.dNext(),e.anEdge).sym,f.fixUpperEdge?b.sweep.fixUpperEdge_(f,a):b.sweep.computeWinding_(c,b.sweep.addRegionBelow_(c,g,a)),b.sweep.sweepEvent_(c,e)):b.sweep.addRightEdges_(c,g,
e.anEdge,e.anEdge,null,!0))};b.sweep.sweepEvent_=function(c,e){c.event=e;for(var g=e.anEdge;null===g.activeRegion;)if(g=g.oNext,g===e.anEdge){b.sweep.connectLeftVertex_(c,e);return}e=b.sweep.topLeftRegion_(g.activeRegion);var f=e.regionBelow(),g=f.eUp,f=b.sweep.finishLeftRegions_(c,f,null);f.oNext===g?b.sweep.connectRightVertex_(c,e,f):b.sweep.addRightEdges_(c,e,f.oNext,g,g,!0)};b.sweep.addSentinel_=function(c,e){var g=new b.ActiveRegion,f=b.mesh.makeEdge(c.mesh);f.org.s=b.sweep.SENTINEL_COORD_;f.org.t=
e;f.dst().s=-b.sweep.SENTINEL_COORD_;f.dst().t=e;c.event=f.dst();g.eUp=f;g.windingNumber=0;g.inside=!1;g.fixUpperEdge=!1;g.sentinel=!0;g.dirty=!1;g.nodeUp=c.dict.insert(g)};b.sweep.initEdgeDict_=function(c){c.dict=new b.Dict(c,b.sweep.edgeLeq_);b.sweep.addSentinel_(c,-b.sweep.SENTINEL_COORD_);b.sweep.addSentinel_(c,b.sweep.SENTINEL_COORD_)};b.sweep.doneEdgeDict_=function(c){for(var e=0,g;null!==(g=c.dict.getMin().getKey());)g.sentinel||(b.assert(g.fixUpperEdge),b.assert(1===++e)),b.assert(0===g.windingNumber),
b.sweep.deleteRegion_(c,g);c.dict=null};b.sweep.removeDegenerateEdges_=function(c){for(var e=c.mesh.eHead,g,f=e.next;f!==e;f=g){g=f.next;var a=f.lNext;b.geom.vertEq(f.org,f.dst())&&f.lNext.lNext!==f&&(b.sweep.spliceMergeVertices_(c,a,f),b.mesh.deleteEdge(f),f=a,a=f.lNext);if(a.lNext===f){if(a!==f){if(a===g||a===g.sym)g=g.next;b.mesh.deleteEdge(a)}if(f===g||f===g.sym)g=g.next;b.mesh.deleteEdge(f)}}};b.sweep.initPriorityQ_=function(c){var e=new b.PriorityQ;c.pq=e;c=c.mesh.vHead;var g;for(g=c.next;g!==
c;g=g.next)g.pqHandle=e.insert(g);e.init()};b.sweep.donePriorityQ_=function(b){b.pq.deleteQ();b.pq=null};b.sweep.removeDegenerateFaces_=function(c){for(var e,g=c.fHead.next;g!==c.fHead;g=e)e=g.next,g=g.anEdge,b.assert(g.lNext!==g),g.lNext.lNext===g&&(b.sweep.addWinding_(g.oNext,g),b.mesh.deleteEdge(g))};b.tessmono={};b.tessmono.tessellateMonoRegion_=function(c){c=c.anEdge;for(b.assert(c.lNext!==c&&c.lNext.lNext!==c);b.geom.vertLeq(c.dst(),c.org);c=c.lPrev());for(;b.geom.vertLeq(c.org,c.dst());c=c.lNext);
for(var e=c.lPrev(),g;c.lNext!==e;)if(b.geom.vertLeq(c.dst(),e.org)){for(;e.lNext!==c&&(b.geom.edgeGoesLeft(e.lNext)||0>=b.geom.edgeSign(e.org,e.dst(),e.lNext.dst()));)g=b.mesh.connect(e.lNext,e),e=g.sym;e=e.lPrev()}else{for(;e.lNext!==c&&(b.geom.edgeGoesRight(c.lPrev())||0<=b.geom.edgeSign(c.dst(),c.org,c.lPrev().org));)g=b.mesh.connect(c,c.lPrev()),c=g.sym;c=c.lNext}for(b.assert(e.lNext!==c);e.lNext.lNext!==c;)g=b.mesh.connect(e.lNext,e),e=g.sym};b.tessmono.tessellateInterior=function(c){for(var e,
g=c.fHead.next;g!==c.fHead;g=e)e=g.next,g.inside&&b.tessmono.tessellateMonoRegion_(g)};b.tessmono.discardExterior=function(c){for(var e,g=c.fHead.next;g!==c.fHead;g=e)e=g.next,g.inside||b.mesh.zapFace(g)};b.tessmono.setWindingNumber=function(c,e,g){for(var f,a=c.eHead.next;a!==c.eHead;a=f)f=a.next,a.rFace().inside!==a.lFace.inside?a.winding=a.lFace.inside?e:-e:g?b.mesh.deleteEdge(a):a.winding=0};b.Dict=function(c,e){this.head_=new b.DictNode;this.frame_=c;this.leq_=e};b.Dict.prototype.deleteDict_=
function(){};b.Dict.prototype.insertBefore=function(c,e){do c=c.prev;while(null!==c.key&&!this.leq_(this.frame_,c.key,e));e=new b.DictNode(e,c.next,c);c.next.prev=e;return c.next=e};b.Dict.prototype.insert=function(b){return this.insertBefore(this.head_,b)};b.Dict.prototype.deleteNode=function(b){b.next.prev=b.prev;b.prev.next=b.next};b.Dict.prototype.search=function(b){var c=this.head_;do c=c.next;while(null!==c.key&&!this.leq_(this.frame_,b,c.key));return c};b.Dict.prototype.getMin=function(){return this.head_.next};
b.Dict.prototype.getMax=function(){return this.head_.prev};b.DictNode=function(b,e,g){this.key=b||null;this.next=e||this;this.prev=g||this};b.DictNode.prototype.getKey=function(){return this.key};b.DictNode.prototype.getSuccessor=function(){return this.next};b.DictNode.prototype.getPredecessor=function(){return this.prev};b.GluTesselator=function(){this.state_=b.GluTesselator.tessState_.T_DORMANT;this.errorCallback_=this.mesh=this.lastEdge_=null;this.normal_=[0,0,0];this.windingRule=b.windingRule.GLU_TESS_WINDING_ODD;
this.fatalError=!1;this.combineCallback_=this.event=this.pq=this.dict=null;this.boundaryOnly_=!1;this.polygonData_=this.meshCallback_=this.endCallback_=this.vertexCallback_=this.edgeFlagCallback_=this.beginCallback_=null};b.GluTesselator.tessState_={T_DORMANT:0,T_IN_POLYGON:1,T_IN_CONTOUR:2};b.GluTesselator.prototype.gluDeleteTess=function(){this.requireState_(b.GluTesselator.tessState_.T_DORMANT)};b.GluTesselator.prototype.gluTessProperty=function(c,e){switch(c){case b.gluEnum.GLU_TESS_TOLERANCE:return;
case b.gluEnum.GLU_TESS_WINDING_RULE:switch(e){case b.windingRule.GLU_TESS_WINDING_ODD:case b.windingRule.GLU_TESS_WINDING_NONZERO:case b.windingRule.GLU_TESS_WINDING_POSITIVE:case b.windingRule.GLU_TESS_WINDING_NEGATIVE:case b.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:this.windingRule=e;return}break;case b.gluEnum.GLU_TESS_BOUNDARY_ONLY:this.boundaryOnly_=!!e;return;default:this.callErrorCallback(b.gluEnum.GLU_INVALID_ENUM);return}this.callErrorCallback(b.gluEnum.GLU_INVALID_VALUE)};b.GluTesselator.prototype.gluGetTessProperty=
function(c){switch(c){case b.gluEnum.GLU_TESS_TOLERANCE:return 0;case b.gluEnum.GLU_TESS_WINDING_RULE:return c=this.windingRule,b.assert(c===b.windingRule.GLU_TESS_WINDING_ODD||c===b.windingRule.GLU_TESS_WINDING_NONZERO||c===b.windingRule.GLU_TESS_WINDING_POSITIVE||c===b.windingRule.GLU_TESS_WINDING_NEGATIVE||c===b.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO),c;case b.gluEnum.GLU_TESS_BOUNDARY_ONLY:return b.assert(!0===this.boundaryOnly_||!1===this.boundaryOnly_),this.boundaryOnly_;default:this.callErrorCallback(b.gluEnum.GLU_INVALID_ENUM)}return!1};
b.GluTesselator.prototype.gluTessNormal=function(b,e,g){this.normal_[0]=b;this.normal_[1]=e;this.normal_[2]=g};b.GluTesselator.prototype.gluTessCallback=function(c,e){e=e?e:null;switch(c){case b.gluEnum.GLU_TESS_BEGIN:case b.gluEnum.GLU_TESS_BEGIN_DATA:this.beginCallback_=e;break;case b.gluEnum.GLU_TESS_EDGE_FLAG:case b.gluEnum.GLU_TESS_EDGE_FLAG_DATA:this.edgeFlagCallback_=e;break;case b.gluEnum.GLU_TESS_VERTEX:case b.gluEnum.GLU_TESS_VERTEX_DATA:this.vertexCallback_=e;break;case b.gluEnum.GLU_TESS_END:case b.gluEnum.GLU_TESS_END_DATA:this.endCallback_=
e;break;case b.gluEnum.GLU_TESS_ERROR:case b.gluEnum.GLU_TESS_ERROR_DATA:this.errorCallback_=e;break;case b.gluEnum.GLU_TESS_COMBINE:case b.gluEnum.GLU_TESS_COMBINE_DATA:this.combineCallback_=e;break;case b.gluEnum.GLU_TESS_MESH:this.meshCallback_=e;break;default:this.callErrorCallback(b.gluEnum.GLU_INVALID_ENUM)}};b.GluTesselator.prototype.gluTessVertex=function(c,e){var g=!1,f=[0,0,0];this.requireState_(b.GluTesselator.tessState_.T_IN_CONTOUR);for(var a=0;3>a;++a){var n=c[a];n<-b.GLU_TESS_MAX_COORD&&
(n=-b.GLU_TESS_MAX_COORD,g=!0);n>b.GLU_TESS_MAX_COORD&&(n=b.GLU_TESS_MAX_COORD,g=!0);f[a]=n}g&&this.callErrorCallback(b.errorType.GLU_TESS_COORD_TOO_LARGE);this.addVertex_(f,e)};b.GluTesselator.prototype.gluTessBeginPolygon=function(c){this.requireState_(b.GluTesselator.tessState_.T_DORMANT);this.state_=b.GluTesselator.tessState_.T_IN_POLYGON;this.mesh=new b.GluMesh;this.polygonData_=c};b.GluTesselator.prototype.gluTessBeginContour=function(){this.requireState_(b.GluTesselator.tessState_.T_IN_POLYGON);
this.state_=b.GluTesselator.tessState_.T_IN_CONTOUR;this.lastEdge_=null};b.GluTesselator.prototype.gluTessEndContour=function(){this.requireState_(b.GluTesselator.tessState_.T_IN_CONTOUR);this.state_=b.GluTesselator.tessState_.T_IN_POLYGON};b.GluTesselator.prototype.gluTessEndPolygon=function(){this.requireState_(b.GluTesselator.tessState_.T_IN_POLYGON);this.state_=b.GluTesselator.tessState_.T_DORMANT;b.normal.projectPolygon(this,this.normal_[0],this.normal_[1],this.normal_[2]);b.sweep.computeInterior(this);
if(!this.fatalError){var c=this.mesh;this.boundaryOnly_?b.tessmono.setWindingNumber(c,1,!0):b.tessmono.tessellateInterior(c);this.mesh.checkMesh();if(this.beginCallback_||this.endCallback_||this.vertexCallback_||this.edgeFlagCallback_)this.boundaryOnly_?b.render.renderBoundary(this,this.mesh):b.render.renderMesh(this,this.mesh,!!this.edgeFlagCallback_);if(this.meshCallback_){b.tessmono.discardExterior(this.mesh);this.meshCallback_(this.mesh);this.polygonData_=this.mesh=null;return}}b.mesh.deleteMesh(this.mesh);
this.mesh=this.polygonData_=null};b.GluTesselator.prototype.requireState_=function(b){this.state_!==b&&this.gotoState_(b)};b.GluTesselator.prototype.gotoState_=function(c){for(;this.state_!==c;)if(this.state_<c)switch(this.state_){case b.GluTesselator.tessState_.T_DORMANT:this.callErrorCallback(b.errorType.GLU_TESS_MISSING_BEGIN_POLYGON);this.gluTessBeginPolygon(null);break;case b.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(b.errorType.GLU_TESS_MISSING_BEGIN_CONTOUR),this.gluTessBeginContour()}else switch(this.state_){case b.GluTesselator.tessState_.T_IN_CONTOUR:this.callErrorCallback(b.errorType.GLU_TESS_MISSING_END_CONTOUR);
this.gluTessEndContour();break;case b.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(b.errorType.GLU_TESS_MISSING_END_POLYGON),this.gluTessEndPolygon()}};b.GluTesselator.prototype.addVertex_=function(c,e){var g=this.lastEdge_;null===g?(g=b.mesh.makeEdge(this.mesh),b.mesh.meshSplice(g,g.sym)):(b.mesh.splitEdge(g),g=g.lNext);g.org.data=e;g.org.coords[0]=c[0];g.org.coords[1]=c[1];g.org.coords[2]=c[2];g.winding=1;g.sym.winding=-1;this.lastEdge_=g};b.GluTesselator.prototype.callBeginCallback=
function(b){this.beginCallback_&&this.beginCallback_(b,this.polygonData_)};b.GluTesselator.prototype.callVertexCallback=function(b){this.vertexCallback_&&this.vertexCallback_(b,this.polygonData_)};b.GluTesselator.prototype.callEdgeFlagCallback=function(b){this.edgeFlagCallback_&&this.edgeFlagCallback_(b,this.polygonData_)};b.GluTesselator.prototype.callEndCallback=function(){this.endCallback_&&this.endCallback_(this.polygonData_)};b.GluTesselator.prototype.callCombineCallback=function(b,e,g){return this.combineCallback_?
this.combineCallback_(b,e,g,this.polygonData_)||null:null};b.GluTesselator.prototype.callErrorCallback=function(b){this.errorCallback_&&this.errorCallback_(b,this.polygonData_)};b.GluFace=function(b,e){this.next=b||this;this.prev=e||this;this.anEdge=null;this.inside=!1};b.GluHalfEdge=function(b){this.next=b||this;this.activeRegion=this.lFace=this.org=this.lNext=this.oNext=this.sym=null;this.winding=0};b.GluHalfEdge.prototype.rFace=function(){return this.sym.lFace};b.GluHalfEdge.prototype.dst=function(){return this.sym.org};
b.GluHalfEdge.prototype.oPrev=function(){return this.sym.lNext};b.GluHalfEdge.prototype.lPrev=function(){return this.oNext.sym};b.GluHalfEdge.prototype.dPrev=function(){return this.lNext.sym};b.GluHalfEdge.prototype.rPrev=function(){return this.sym.oNext};b.GluHalfEdge.prototype.dNext=function(){return this.rPrev().sym};b.GluHalfEdge.prototype.rNext=function(){return this.oPrev().sym};b.GluMesh=function(){this.vHead=new b.GluVertex;this.fHead=new b.GluFace;this.eHead=new b.GluHalfEdge;this.eHeadSym=
new b.GluHalfEdge;this.eHead.sym=this.eHeadSym;this.eHeadSym.sym=this.eHead};b.GluMesh.prototype.checkMesh=function(){if(b.DEBUG){var c=this.fHead,e=this.vHead,g=this.eHead,f,a;for(f=f=c;(a=f.next)!==c;f=a){b.assert(a.prev===f);f=a.anEdge;do b.assert(f.sym!==f),b.assert(f.sym.sym===f),b.assert(f.lNext.oNext.sym===f),b.assert(f.oNext.sym.lNext===f),b.assert(f.lFace===a),f=f.lNext;while(f!==a.anEdge)}b.assert(a.prev===f&&null===a.anEdge);for(f=f=e;(c=f.next)!==e;f=c){b.assert(c.prev===f);f=c.anEdge;
do b.assert(f.sym!==f),b.assert(f.sym.sym===f),b.assert(f.lNext.oNext.sym===f),b.assert(f.oNext.sym.lNext===f),b.assert(f.org===c),f=f.oNext;while(f!==c.anEdge)}b.assert(c.prev===f&&null===c.anEdge&&null===c.data);for(e=e=g;(f=e.next)!==g;e=f)b.assert(f.sym.next===e.sym),b.assert(f.sym!==f),b.assert(f.sym.sym===f),b.assert(null!==f.org),b.assert(null!==f.dst()),b.assert(f.lNext.oNext.sym===f),b.assert(f.oNext.sym.lNext===f);b.assert(f.sym.next===e.sym&&f.sym===this.eHeadSym&&f.sym.sym===f&&null===
f.org&&null===f.dst()&&null===f.lFace&&null===f.rFace())}};b.GluVertex=function(b,e){this.next=b||this;this.prev=e||this;this.data=this.anEdge=null;this.coords=[0,0,0];this.pqHandle=this.t=this.s=0};b.PriorityQ=function(){this.verts_=[];this.order_=null;this.size_=0;this.initialized_=!1;this.heap_=new b.PriorityQHeap};b.PriorityQ.prototype.deleteQ=function(){this.verts_=this.order_=this.heap_=null};b.PriorityQ.prototype.init=function(){this.order_=[];for(var c=0;c<this.size_;c++)this.order_[c]=c;
c=function(c){return function(e,a){return b.geom.vertLeq(c[e],c[a])?1:-1}}(this.verts_);this.order_.sort(c);this.initialized_=!0;this.heap_.init();if(b.DEBUG)for(var e=0+this.size_-1,c=0;c<e;++c)b.assert(b.geom.vertLeq(this.verts_[this.order_[c+1]],this.verts_[this.order_[c]]))};b.PriorityQ.prototype.insert=function(b){if(this.initialized_)return this.heap_.insert(b);var c=this.size_++;this.verts_[c]=b;return-(c+1)};b.PriorityQ.prototype.extractMin=function(){if(0===this.size_)return this.heap_.extractMin();
var c=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var e=this.heap_.minimum();if(b.geom.vertLeq(e,c))return this.heap_.extractMin()}do--this.size_;while(0<this.size_&&null===this.verts_[this.order_[this.size_-1]]);return c};b.PriorityQ.prototype.minimum=function(){if(0===this.size_)return this.heap_.minimum();var c=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var e=this.heap_.minimum();if(b.geom.vertLeq(e,c))return e}return c};b.PriorityQ.prototype.remove=function(c){if(0<=
c)this.heap_.remove(c);else for(c=-(c+1),b.assert(c<this.verts_.length&&null!==this.verts_[c]),this.verts_[c]=null;0<this.size_&&null===this.verts_[this.order_[this.size_-1]];)--this.size_};b.PriorityQHeap=function(){this.heap_=b.PriorityQHeap.reallocNumeric_([0],b.PriorityQHeap.INIT_SIZE_+1);this.verts_=[null,null];this.handles_=[0,0];this.size_=0;this.max_=b.PriorityQHeap.INIT_SIZE_;this.freeList_=0;this.initialized_=!1;this.heap_[1]=1};b.PriorityQHeap.INIT_SIZE_=32;b.PriorityQHeap.reallocNumeric_=
function(b,e){for(var c=Array(e),f=0;f<b.length;f++)c[f]=b[f];for(;f<e;f++)c[f]=0;return c};b.PriorityQHeap.prototype.init=function(){for(var b=this.size_;1<=b;--b)this.floatDown_(b);this.initialized_=!0};b.PriorityQHeap.prototype.insert=function(c){var e=++this.size_;2*e>this.max_&&(this.max_*=2,this.handles_=b.PriorityQHeap.reallocNumeric_(this.handles_,this.max_+1));var g;0===this.freeList_?g=e:(g=this.freeList_,this.freeList_=this.handles_[this.freeList_]);this.verts_[g]=c;this.handles_[g]=e;
this.heap_[e]=g;this.initialized_&&this.floatUp_(e);return g};b.PriorityQHeap.prototype.isEmpty=function(){return 0===this.size_};b.PriorityQHeap.prototype.minimum=function(){return this.verts_[this.heap_[1]]};b.PriorityQHeap.prototype.extractMin=function(){var b=this.heap_,e=this.verts_,g=this.handles_,f=b[1],a=e[f];0<this.size_&&(b[1]=b[this.size_],g[b[1]]=1,e[f]=null,g[f]=this.freeList_,this.freeList_=f,0<--this.size_&&this.floatDown_(1));return a};b.PriorityQHeap.prototype.remove=function(c){var e=
this.heap_,g=this.verts_,f=this.handles_;b.assert(1<=c&&c<=this.max_&&null!==g[c]);var a=f[c];e[a]=e[this.size_];f[e[a]]=a;a<=--this.size_&&(1>=a?this.floatDown_(a):b.geom.vertLeq(g[e[a>>1]],g[e[a]])?this.floatDown_(a):this.floatUp_(a));g[c]=null;f[c]=this.freeList_;this.freeList_=c};b.PriorityQHeap.prototype.floatDown_=function(c){for(var e=this.heap_,g=this.verts_,f=this.handles_,a=e[c];;){var n=c<<1;n<this.size_&&b.geom.vertLeq(g[e[n+1]],g[e[n]])&&(n+=1);b.assert(n<=this.max_);var k=e[n];if(n>
this.size_||b.geom.vertLeq(g[a],g[k])){e[c]=a;f[a]=c;break}e[c]=k;f[k]=c;c=n}};b.PriorityQHeap.prototype.floatUp_=function(c){for(var e=this.heap_,g=this.verts_,f=this.handles_,a=e[c];;){var n=c>>1,k=e[n];if(0===n||b.geom.vertLeq(g[k],g[a])){e[c]=a;f[a]=c;break}e[c]=k;f[k]=c;c=n}};b.ActiveRegion=function(){this.nodeUp=this.eUp=null;this.windingNumber=0;this.fixUpperEdge=this.dirty=this.sentinel=this.inside=!1};b.ActiveRegion.prototype.regionBelow=function(){return this.nodeUp.getPredecessor().getKey()};
b.ActiveRegion.prototype.regionAbove=function(){return this.nodeUp.getSuccessor().getKey()};return b})},"esri/views/2d/engine/webgl/util/Lock":function(){define(["require","exports","../../../../../core/promiseUtils"],function(b,c,e){Object.defineProperty(c,"__esModule",{value:!0});b=function(){function b(){this._resolver=null}b.prototype.isHeld=function(){return!!this._resolver};b.prototype.acquire=function(){var b=this;return this._resolver?this._resolver.promise.then(function(){return b.acquire()}):
(this._resolver=e.createResolver(),e.resolve())};b.prototype.release=function(){var b=this._resolver;this._resolver=null;b.resolve()};return b}();c.default=b;c.withLock=function(b,c,a){return b.acquire().then(function(){return c(a)}).then(function(){return b.release()}).catch(function(a){b.release();throw a;})}})},"esri/views/2d/engine/webgl/TileData":function(){define("require exports ./MemoryRequirements ./TileBufferData ./TileDisplayData ./Utils ./Utils ./WGLDisplayObject ./WGLDisplayRecord ./mesh/VertexBuffer ./util/Reader ./util/serializationUtils ./util/Writer".split(" "),
function(b,c,e,g,f,a,n,k,d,l,t,x,w){Object.defineProperty(c,"__esModule",{value:!0});var m=new e.default,z=new e.default;b=function(){function b(){this.tileBufferData=this.tileDisplayData=null}b.prototype.reshuffle=function(){m.reset();for(var c=f.groupRecordsByGeometryType(this.tileDisplayData.displayObjects),d=0;d<c.length;d++)for(var e=c[d],h=0,k=e;h<k.length;h++){var l=k[h];l&&m.needMore(l.geometryType,l.meshData?l.meshData.vertexCount:l.vertexCount,l.meshData?l.meshData.indexData.length:l.indexCount)}h=
c.length;d=new g;for(k=0;k<h;++k){d.geometries[k].indexBuffer=new Uint32Array(Math.round(1.15*m.indicesFor(k)));var l=[],q;for(q in this.tileBufferData.geometries[k].vertexBuffer)l.push(this.tileBufferData.geometries[k].vertexBuffer[q].stride);var l=b._computeVertexAlignment(l),e=Math.round(1.15*m.verticesFor(k)),l=b._align(e,l),w;for(w in this.tileBufferData.geometries[k].vertexBuffer)e=this.tileBufferData.geometries[k].vertexBuffer[w].stride,d.geometries[k].vertexBuffer[w]={stride:e,data:n.allocateTypedArrayBuffer(l,
e)}}z.reset();this.tileDisplayData.displayList.clear();for(k=0;k<h;++k){e=c[k];q=0;for(w=e;q<w.length;q++){l=w[q];if(l.meshData)l.writeMeshDataToBuffers(z.verticesFor(k),d.geometries[k].vertexBuffer,z.indicesFor(k),d.geometries[k].indexBuffer),l.meshData=null;else{var t=this.tileBufferData.geometries[k].vertexBuffer,x=this.tileBufferData.geometries[k].indexBuffer,I=d.geometries[k].vertexBuffer,E=d.geometries[k].indexBuffer,H=z.verticesFor(k),F=z.indicesFor(k);a.copyMeshData(H,F,I,E,l,t,x);l.vertexFrom=
H;l.indexFrom=F}z.needMore(k,l.vertexCount,l.indexCount)}this.tileDisplayData.displayList.unified||this.tileDisplayData.displayList.addToList(e)}if(this.tileDisplayData.displayList.unified)for(c=0,h=this.tileDisplayData.displayObjects;c<h.length;c++)this.tileDisplayData.displayList.addToList(h[c].displayRecords);this.tileBufferData=d};b.prototype.getStrides=function(){for(var a=[],b=0;b<this.tileBufferData.geometries.length;++b){var c=this.tileBufferData.geometries[b];a[b]={};for(var d in c.vertexBuffer)a[b][d]=
c.vertexBuffer[d].stride}return a};b.prototype.clone=function(){var a=new b;a.tileBufferData=this.tileBufferData.clone();a.tileDisplayData=this.tileDisplayData.clone();return a};b.prototype._guessSize=function(){for(var a=this.tileDisplayData.displayObjects,b=Math.min(a.length,4),c=0,d=0;d<b;d++)c=Math.max(c,a[d].displayRecords.length);return 2*(12*a.length+a.length*c*40)};b.prototype.serialize=function(){var a=this.tileBufferData.serialize(),b=this.tileBufferData.getBuffers(),c=this.tileDisplayData.serialize(new w.default(Int32Array,
this._guessSize())).buffer();b.push(c);return{result:{displayData:c,bufferData:a},transferList:b}};b.decode=function(a){var c=x.deserializeList(new t.default(a.displayObjects),k),d={},e;for(e in a.vertexBuffersMap)d[e]=l.VertexBuffers.decode(a.vertexBuffersMap[e]);return b.fromMeshData({displayObjects:c,vertexBuffersMap:d})};b.fromMeshData=function(a){var c=new b,d=new f.default,e=new g;d.displayObjects=a.displayObjects;for(var k in a.vertexBuffersMap){var l=a.vertexBuffersMap[k];e.geometries[k].indexBuffer=
l.indexBuffer;e.geometries[k].vertexBuffer=l.namedBuffers}c.tileDisplayData=d;c.tileBufferData=e;return c};b.bind=function(a,c){var d=new b;d.tileDisplayData=a;d.tileBufferData=c;return d};b.create=function(a,c){var e=new b;e.tileDisplayData=new f.default;e.tileDisplayData.displayObjects=a;for(var h=[0,0,0,0,0],k=[0,0,0,0,0],l=[[],[],[],[],[]],m=0;m<a.length;m++)for(var p=0,q=a[m].displayRecords;p<q.length;p++){var v=q[p];l[v.geometryType].push(v);h[v.geometryType]+=v.meshData.vertexCount;k[v.geometryType]+=
v.meshData.indexData.length}a=new g;c=[c.fill||{},c.line||{},c.icon||{},c.text||{},c.label||{}];for(m=0;5>m;m++){var p=new Uint32Array(k[m]),q=c[m],v=h[m],w={},t=void 0;for(t in q){var x={data:n.allocateTypedArrayBuffer(v,q[t]),stride:q[t]};w[t]=x}q=w;d.writeAllMeshDataToBuffers(l[m],q,p);a.geometries[m]={indexBuffer:p,vertexBuffer:q}}e.tileBufferData=a;return e};b._align=function(a,b){var c=a%b;return 0===c?a:a+(b-c)};b._computeVertexAlignment=function(a){for(var b=!1,c=!1,d=0;d<a.length;d++){var e=
a[d];2===e%4?b=!0:0!==e%4&&(c=!0)}return c?4:b?2:1};return b}();c.TileData=b})},"esri/views/2d/engine/webgl/MemoryRequirements":function(){define(["require","exports"],function(b,c){Object.defineProperty(c,"__esModule",{value:!0});b=function(){function b(){this._byGeometryType=null}Object.defineProperty(b.prototype,"satisfied",{get:function(){return!this._byGeometryType},enumerable:!0,configurable:!0});b.prototype.reset=function(){this._byGeometryType=null};b.prototype.verticesFor=function(b){return this._byGeometryType?
this._byGeometryType[b].vertices:0};b.prototype.indicesFor=function(b){return this._byGeometryType?this._byGeometryType[b].indices:0};b.prototype.needMore=function(b,c,a){if(c||a)this._byGeometryType||(this._byGeometryType=[{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0}]),b=this._byGeometryType[b],b.vertices+=c,b.indices+=a};return b}();c.default=b})},"esri/views/2d/engine/webgl/TileBufferData":function(){define(["require","exports",
"./Utils"],function(b,c,e){return function(){function b(){this.geometries=[{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}}]}b.prototype.clone=function(){for(var c=new b,a=0;a<this.geometries.length;a++){var e=this.geometries[a],g=c.geometries[a];g.indexBuffer=e.indexBuffer.slice();g.vertexBuffer={};for(var d in e.vertexBuffer){var l=e.vertexBuffer[d],t=l.stride;
g.vertexBuffer[d]={data:l.data.slice(),stride:t}}}return c};b.deserialize=function(c){for(var a=new b,f=0;5>f;++f){a.geometries[f].indexBuffer=new Uint32Array(c.geometries[f].indexBuffer);a.geometries[f].vertexBuffer={};for(var g in c.geometries[f].vertexBuffer)a.geometries[f].vertexBuffer[g]={data:e.allocateTypedArrayBufferwithData(c.geometries[f].vertexBuffer[g].data,c.geometries[f].vertexBuffer[g].stride),stride:c.geometries[f].vertexBuffer[g].stride}}return a};b.prototype.serialize=function(){for(var b=
{geometries:[{indexBuffer:this.geometries[0].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[1].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[2].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[3].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[4].indexBuffer.buffer,vertexBuffer:{}}]},a=0;5>a;++a)for(var c in this.geometries[a].vertexBuffer)b.geometries[a].vertexBuffer[c]={data:this.geometries[a].vertexBuffer[c].data.buffer,stride:this.geometries[a].vertexBuffer[c].stride};
return b};b.prototype.getBuffers=function(){for(var b=[],a=0;5>a;++a){b.push(this.geometries[a].indexBuffer.buffer);for(var c in this.geometries[a].vertexBuffer)b.push(this.geometries[a].vertexBuffer[c].data.buffer)}return b};return b}()})},"esri/views/2d/engine/webgl/TileDisplayData":function(){define(["require","exports","./WGLDisplayList","./WGLDisplayObject","./util/serializationUtils"],function(b,c,e,g,f){function a(a){for(var b=[[],[],[],[],[]],c=0;c<a.length;c++)for(var e=0,f=a[c].displayRecords;e<
f.length;e++){var g=f[e];b[g.geometryType].push(g)}return b}Object.defineProperty(c,"__esModule",{value:!0});c.groupRecordsByGeometryType=a;b=function(){function b(){}Object.defineProperty(b.prototype,"displayObjectRegistry",{get:function(){if(!this._displayObjectRegistry){this._displayObjectRegistry=new Map;for(var a=0,b=this.displayObjects;a<b.length;a++){var c=b[a];this._displayObjectRegistry.set(c.id,c)}}return this._displayObjectRegistry},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"displayList",{get:function(){return this._displayList},enumerable:!0,configurable:!0});b.prototype.computeDisplayList=function(b){this._displayList=new e(b);if(b){b=0;for(var c=this.displayObjects;b<c.length;b++)for(var f=0,g=c[b].displayRecords;f<g.length;f++)this._displayList.addToList(g[f])}else for(b=a(this.displayObjects),c=b.length,f=0;f<c;++f)this._displayList.addToList(b[f])};b.prototype.clone=function(){var a=new b;this.displayObjects&&(a.displayObjects=this.displayObjects.map(function(a){return a.clone()}));
return a};b.prototype.serialize=function(a){f.serializeList(a,this.displayObjects);return a};b.prototype._deserializeObjects=function(a){for(var b=a.readInt32(),b=Array(b),c=new Map,e=0;e<b.length;++e){var f=g.deserialize(a);b[e]=f;c.set(f.id,f)}this.displayObjects=b;this._displayList=null;this._displayObjectRegistry=c};b.deserialize=function(a){var c=new b;c._deserializeObjects(a);return c};return b}();c.default=b})},"esri/views/2d/engine/webgl/WGLDisplayList":function(){define(["require","exports",
"../../../../core/tsSupport/generatorHelper","../../../../core/Logger","./enums"],function(b,c,e,g,f){function a(a,b,c){for(var d=[],e=3;e<arguments.length;e++)d[e-3]=arguments[e];b<a.length?a.splice.apply(a,[b,c].concat(d)):a.push.apply(a,d)}var n=g.getLogger("esri.views.2d.engine.webgl.WGLDisplayList");b=new Map;b.set(f.WGLDrawPhase.MAP,[f.WGLGeometryType.FILL,f.WGLGeometryType.LINE,f.WGLGeometryType.MARKER,f.WGLGeometryType.TEXT]);b.set(f.WGLDrawPhase.LABEL,[f.WGLGeometryType.LABEL]);b.set(f.WGLDrawPhase.LABEL_ALPHA,
[f.WGLGeometryType.LABEL]);b=function(){function b(a){void 0===a&&(a=!1);this.symbolLevels=[];this.unified=a}b.prototype.replay=function(a,b,c){if(this.unified)for(var d=0,e=this.symbolLevels;d<e.length;d++)for(var f=0,g=e[d].zLevels;f<g.length;f++){var h=g[f].geometryDPInfo,k;for(k in h)if(h[k])for(var l=0,m=h[k];l<m.length;l++){var n=m[l],w=a.painter.getGeometryBrush(n.geometryType),t=b.getGeometry(n.geometryType);w.prepareState(a,b);w.drawGeometry(a,b,n,t,c)}}};Object.defineProperty(b.prototype,
"empty",{get:function(){return!this.symbolLevels||0===this.symbolLevels.length},enumerable:!0,configurable:!0});b.prototype.clear=function(){this.symbolLevels.length=0};b.prototype.addToList=function(a,b){if(Array.isArray(a))for(var c=0;c<a.length;c++)this._addToList(a[c],b);else this._addToList(a,b)};b.prototype.removeFromList=function(a){Array.isArray(a)||(a=[a]);for(var b=null,c=0;c<a.length;c++)b=this._removeFromList(a[c]);return b};b.prototype.byType=function(a,b){for(var c=0,d=this.symbolLevels;c<
d.length;c++)for(var e=0,f=d[c].zLevels;e<f.length;e++){var g=f[e].geometryDPInfo,h=this.getDPInfoType(a);if(g[h])for(var k=0,g=g[h];k<g.length;k++)b(g[k])}};b.prototype.clone=function(){for(var a=new b(this.unified),c=0,d=this.symbolLevels;c<d.length;c++)a.symbolLevels.push(d[c].clone());return a};b.prototype.splitAfter=function(a){for(var b=this._getDisplayList(a.symbolLevel,a.zOrder,a.geometryType),c=b.length,d=a.indexFrom+a.indexCount,e=0;e<c;++e){var f=b[e];if(f.geometryType===a.geometryType&&
d>f.indexFrom&&d<=f.indexFrom+f.indexCount)return d<f.indexFrom+f.indexCount&&(a=new k,a.geometryType=f.geometryType,a.materialKey=f.materialKey,a.indexFrom=d,a.indexCount=f.indexFrom+f.indexCount-d,b.splice(e+1,0,a),f.indexCount=d-f.indexFrom),e}};b.prototype._addToList=function(b,c){var d=this._getDisplayList(b.symbolLevel,b.zOrder,b.geometryType);c=null!=c?c:d.length-1;var e=0<=c&&c<d.length?d[c]:null;null===e||e.materialKey!==b.materialKey||e.indexFrom+e.indexCount!==b.indexFrom||this.unified&&
e.geometryType!==b.geometryType?(e=new k,e.indexFrom=b.indexFrom,e.indexCount=b.indexCount,e.materialKey=b.materialKey,e.geometryType=b.geometryType,a(d,c+1,0,e)):e.indexCount+=b.indexCount};b.prototype._removeFromList=function(b){for(var c=this._getDisplayList(b.symbolLevel,b.zOrder,b.geometryType),d=c.length,e=void 0,f=0;f<d;++f){var g=c[f];if(b.indexFrom+b.indexCount>g.indexFrom&&b.indexFrom<g.indexFrom+g.indexCount&&(!this.unified||g.geometryType===b.geometryType)){e=f;break}}if(void 0!==e){g=
c[e];if(b.indexFrom===g.indexFrom)return g.indexCount-=b.indexCount,g.indexFrom+=b.indexCount,0===g.indexCount&&a(c,e,1),e-1;if(b.indexFrom+b.indexCount===g.indexFrom+g.indexCount)return g.indexCount-=b.indexCount,0===g.indexCount?(a(c,e,1),e-1):e;var d=g.indexFrom,f=b.indexFrom-g.indexFrom,l=b.indexCount;b=g.indexFrom+g.indexCount-(b.indexFrom+b.indexCount);g.indexCount=f;var h=new k;h.geometryType=g.geometryType;h.materialKey=g.materialKey;h.indexFrom=d+f+l;h.indexCount=b;a(c,e+1,0,h);return e}return null};
b.prototype._getDisplayList=function(a,b,c){for(var e,g=this.symbolLevels.length,k=0;k<g;k++)if(this.symbolLevels[k].symbolLevel===a){e=this.symbolLevels[k];break}e||(e=new t,e.symbolLevel=a,this.symbolLevels.push(e));var m;a=e.zLevels.length;for(g=0;g<a;g++)if(e.zLevels[g].zLevel===b){m=e.zLevels[g];break}m||(m=new l,m.geometryDPInfo=new d,m.zLevel=b,e.zLevels.push(m));var h;if(this.unified)m.geometryDPInfo.unified||(m.geometryDPInfo.unified=[]),h=m.geometryDPInfo.unified;else switch(c){case f.WGLGeometryType.FILL:m.geometryDPInfo.fill||
(m.geometryDPInfo.fill=[]);h=m.geometryDPInfo.fill;break;case f.WGLGeometryType.LINE:m.geometryDPInfo.line||(m.geometryDPInfo.line=[]);h=m.geometryDPInfo.line;break;case f.WGLGeometryType.MARKER:m.geometryDPInfo.marker||(m.geometryDPInfo.marker=[]);h=m.geometryDPInfo.marker;break;case f.WGLGeometryType.TEXT:m.geometryDPInfo.text||(m.geometryDPInfo.text=[]);h=m.geometryDPInfo.text;break;case f.WGLGeometryType.LABEL:m.geometryDPInfo.label||(m.geometryDPInfo.label=[]);h=m.geometryDPInfo.label;break;
default:console.error("Trying to add a record with geometry type '"+c+"'.")}return h};b.prototype.getDPInfoType=function(a){if(this.unified)return"unified";switch(a){case f.WGLGeometryType.FILL:return"fill";case f.WGLGeometryType.LINE:return"line";case f.WGLGeometryType.MARKER:return"marker";case f.WGLGeometryType.TEXT:return"text";case f.WGLGeometryType.LABEL:return"label";default:n.error("DisplayList: Tried to convert unknown geometryType: "+a)}};return b}();var k=function(){function a(){this.materialKey=
null;this.indexCount=this.indexFrom=0}a.prototype.clone=function(){var b=new a;b.geometryType=this.geometryType;b.materialKey=this.materialKey;b.indexFrom=this.indexFrom;b.indexCount=this.indexCount;return b};return a}(),d=function(){function a(){this.unified=this.label=this.text=this.marker=this.line=this.fill=null}a.prototype.clone=function(){var b=new a;b.fill=this.fill&&this.fill.map(function(a){return a.clone()});b.line=this.line&&this.line.map(function(a){return a.clone()});b.marker=this.marker&&
this.marker.map(function(a){return a.clone()});b.text=this.text&&this.text.map(function(a){return a.clone()});b.label=this.label&&this.label.map(function(a){return a.clone()});b.unified=this.unified&&this.unified.map(function(a){return a.clone()});return b};return a}(),l=function(){function a(){this.geometryDPInfo=new d}a.prototype.clone=function(){var b=new a;b.zLevel=this.zLevel;b.geometryDPInfo=this.geometryDPInfo.clone();return b};return a}(),t=function(){function a(){this.zLevels=[]}a.prototype.clone=
function(){var b=new a;b.symbolLevel=this.symbolLevel;for(var c=0,d=this.zLevels;c<d.length;c++)b.zLevels.push(d[c].clone());return b};return a}();return b})},"esri/views/2d/engine/webgl/util/Reader":function(){define(["require","exports"],function(b,c){Object.defineProperty(c,"__esModule",{value:!0});b=function(){function b(b){this._pos=0;this._buffer=b;this._i32View=new Int32Array(this._buffer);this._f32View=new Float32Array(this._buffer)}b.prototype.readInt32=function(){return this._i32View[this._pos++]};
b.prototype.readF32=function(){return this._f32View[this._pos++]};return b}();c.default=b})},"esri/views/2d/engine/webgl/WGLRendererInfo":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../Color ../../../../core/has ../../../../core/maybe ../../../../core/screenUtils ../../../../core/unitUtils ../../../../core/libs/gl-matrix-2/mat4f32 ../../../../renderers/support/utils ./definitions ./Utils".split(" "),function(b,c,e,g,f,a,n,k,d,l,t,x){function w(a,b){var c=b.length;
if(a<b[0].value||1===c)return b[0].size;for(var d=1;d<c;d++)if(a<b[d].value)return b[d-1].size+(a-b[d-1].value)/(b[d].value-b[d-1].value)*(b[d].size-b[d-1].size);return b[c-1].size}function m(b,c,d){void 0===d&&(d=0);if(a.isNone(c))b[d+0]=0,b[d+1]=0,b[d+2]=0,b[d+3]=0;else{var e=c.g,f=c.b,g=c.a;b[d+0]=c.r*g/255;b[d+1]=e*g/255;b[d+2]=f*g/255;b[d+3]=g}}Object.defineProperty(c,"__esModule",{value:!0});var z=function(a,b,c){for(var d=c*=16,e=0;d<Math.min(c+16,a.length);d++,e++)a[d]=b[e]},q=d.mat4f32.create();
b=function(){function b(){this.symbolLevels=[];this.vvColorValues=new Float32Array(8);this.vvColors=new Float32Array(32);this.vvOpacityValues=new Float32Array(8);this.vvOpacities=new Float32Array(8);this.vvSizeMinMaxValue=new Float32Array(4);this.ddColors=new Float32Array(32);this.ddBackgroundColor=new Float32Array(4);this.ddActiveDots=new Float32Array(8);this.insideEffect=new Float32Array(16*t.MAX_FILTERS);this.insideOpacity=1;this.outsideEffect=new Float32Array(16*t.MAX_FILTERS);this.outsideOpacity=
1;this.effectCount=0;this._vvMaterialParameters={vvSizeEnabled:!1,vvColorEnabled:!1,vvRotationEnabled:!1,vvRotationType:"geographic",vvOpacityEnabled:!1};this._buf0=new Float32Array(2);this._buf1=new Float32Array(2);this.symbolLevels.push(0);for(var a=0;a<t.MAX_FILTERS;a++)z(this.insideEffect,q,a),z(this.outsideEffect,q,a)}Object.defineProperty(b.prototype,"insideOpacities",{get:function(){this._buf0[0]=1;this._buf0[1]=this.insideOpacity;return this._buf0},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"outsideOpacities",{get:function(){this._buf1[0]=0;this._buf1[1]=this.outsideOpacity;return this._buf1},enumerable:!0,configurable:!0});b.prototype.getSizeVVFieldStops=function(b){var c=this._vvSizeFieldStops;switch(c.type){case "static":return c;case "level-dependent":return a.unwrapOr(c.levels[b],function(){var d=Infinity,e=0,f;for(f in c.levels){var g=parseFloat(f),k=Math.abs(b-g);k<d&&(d=k,e=g)}if(Infinity===d)return{sizes:new Float32Array([0,0,0,0,0,0]),values:new Float32Array([0,0,0,0,0,0])};
d=Math.pow(2,(b-e)/2);e=a.expect(c.levels[e]);f=new Float32Array(e.values);f[2]*=d;f[3]*=d;return{sizes:a.unwrap(e.sizes),values:f}})}};Object.defineProperty(b.prototype,"vvMaterialParameters",{get:function(){return this._vvMaterialParameters},enumerable:!0,configurable:!0});b.prototype.update=function(b){a.isSome(this._vvInfo)&&this._updateVisualVariables(this._vvInfo.vvRanges,b)};b.prototype.setInfo=function(b,c,d){var e=this;a.isSome(d)?(d.forEach(function(a,b){return e._updateEffects(b,a)}),this.effectCount=
d.length):this.effectCount=0;this._vvInfo=c;switch(b.type){case "dot-density":this._updateDotDensityInfo(b)}};b.prototype.getVariation=function(){return{ddDotBlending:this.ddDotBlending,outsideLabelsVisible:this.outsideLabelsVisible,effectCount:this.effectCount,oesTextureFloat:f("esri-webgl-texture-float")}};b.prototype.getVariationHash=function(){return(this.ddDotBlending?1:0)|(this.outsideLabelsVisible?1:0)<<1|this.effectCount<<2};b.prototype._updateEffects=function(b,c){b+=1;if(a.isSome(c)&&c.filter&&
c.filter.enabled){this.outsideLabelsVisible=c.excludedLabelsVisible;var d=c.parsedIncludedEffect;c=c.parsedExcludedEffect;a.isSome(d)?(z(this.insideEffect,d.getColorMatrix(),b),this.insideOpacity=d.getOpacity()):(z(this.insideEffect,q,b),this.insideOpacity=1);a.isSome(c)?(z(this.outsideEffect,c.getColorMatrix(),b),this.outsideOpacity=c.getOpacity()):(z(this.outsideEffect,q,b),this.outsideOpacity=1)}else z(this.insideEffect,q,b),z(this.outsideEffect,q,b),this.outsideOpacity=this.insideOpacity=1};b.prototype._updateVisualVariables=
function(a,b){var c=this._vvMaterialParameters;c.vvOpacityEnabled=!1;c.vvSizeEnabled=!1;c.vvColorEnabled=!1;c.vvRotationEnabled=!1;if(a){var d=a.size;if(d){c.vvSizeEnabled=!0;if(d.minMaxValue){var e=d.minMaxValue,f=void 0,g=void 0;x.isDefined(e.minSize)&&x.isDefined(e.maxSize)&&(x.isNumber(e.minSize)&&x.isNumber(e.maxSize)?(f=n.pt2px(e.minSize),g=n.pt2px(e.maxSize)):(g=b.scale,f=n.pt2px(w(g,e.minSize.stops)),g=n.pt2px(w(g,e.maxSize.stops))));this.vvSizeMinMaxValue.set([e.minDataValue,e.maxDataValue,
f,g])}d.scaleStops&&(this.vvSizeScaleStopsValue=n.pt2px(w(b.scale,d.scaleStops.stops)));d.unitValue&&(this.vvSizeUnitValueToPixelsRatio=k.getMetersPerUnitForSR(b.spatialReference)/l.meterIn[d.unitValue.unit]/b.resolution);d.fieldStops&&(this._vvSizeFieldStops=d.fieldStops)}if(b=a.color)c.vvColorEnabled=!0,this.vvColorValues.set(b.values),this.vvColors.set(b.colors);if(b=a.opacity)c.vvOpacityEnabled=!0,this.vvOpacityValues.set(b.values),this.vvOpacities.set(b.opacities);if(a=a.rotation)c.vvRotationEnabled=
!0,c.vvRotationType=a.type}};b.prototype._updateDotDensityInfo=function(a){var b=a.attributes;this.ddDotValue=a.dotValue;this.ddDotScale=a.referenceScale;this.ddDotSize=a.dotSize;this.ddDotBlending=a.dotBlendingEnabled;this.ddSeed=a.seed;for(var c=0;c<t.DOT_DENSITY_MAX_FIELDS;c++){var d=c>=b.length?new g([0,0,0,0]):b[c].color;m(this.ddColors,d,4*c)}for(c=0;8>c;c++)this.ddActiveDots[c]=c<a.attributes.length?1:0;m(this.ddBackgroundColor,a.backgroundColor)};return b}();c.WGLRendererInfo=b})},"esri/views/2d/engine/webgl/WGLTile":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/libs/gl-matrix-2/mat2d ../../../../core/libs/gl-matrix-2/mat2df32 ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f32 ./definitions ./DirtyMap ./DisplayRecordStore ./Fader ./TiledDisplayObject ./WGLBuffers".split(" "),
function(b,c,e,g,f,a,n,k,d,l,t,x,w){Object.defineProperty(c,"__esModule",{value:!0});var m=new Set;b=function(b){function c(a,c,e){void 0===e&&(e=!1);a=b.call(this,a,c,[k.TILE_SIZE,k.TILE_SIZE])||this;a._data=null;a._displayList=null;a._wglBuffers=null;a._dirtyMap=new d.default;a._labelIndex=null;a._dirty=!0;a.fader=new t.default;a._ensureCorrectZOrder=e;a.transforms.labelMat2d=f.mat2df32.create();return a}e(c,b);c.prototype.destroy=function(){this.clear()};Object.defineProperty(c.prototype,"displayObjects",
{get:function(){return this._data.tileDisplayData.displayObjects},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"canDisplay",{get:function(){return!!this.attached},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isDirty",{get:function(){return this._dirty},set:function(a){(this._dirty=a)||this.isReady||this.ready();this.requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"hasData",{get:function(){return!!this._data},enumerable:!0,
configurable:!0});Object.defineProperty(c.prototype,"labelIndex",{get:function(){return this._labelIndex},enumerable:!0,configurable:!0});c.prototype.getGeometry=function(a){return this._wglBuffers&&this._wglBuffers.has(a)?this._wglBuffers.get(a):null};c.prototype.getDisplayList=function(){return this._data&&this._displayList};Object.defineProperty(c.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0});c.prototype.setTransform=function(c,d){b.prototype.setTransform.call(this,
c,d);var e=this.transforms.labelMat2d;d=c.getScreenTransform(e,d);var f=n.vec2f32.create();a.vec2.transformMat2d(f,this.coords,d);g.mat2d.identity(e);g.mat2d.translate(e,e,f);g.mat2d.multiply(e,c.viewMat2d,e)};c.prototype.setData=function(a,b,c){var e=a.addOrUpdate,f=a.remove;!a.clear&&this.hasData||a.addOrUpdate?!a.clear&&this.hasData||!a.addOrUpdate?this.hasData&&this._doPatchData({addOrUpdate:e,remove:f},b,c):(e.tileDisplayData.computeDisplayList(this._ensureCorrectZOrder),this._dirtyMap=new d.default,
this._dispRecStore=l.default.fromTileData(e,this._dirtyMap),this._data=e,this._readyTileIfNoLabels(b,c),this._dirtyMap.markAllDirty(),this._displayList||(this._displayList=e.tileDisplayData.displayList.clone())):(this.clear(),this.ready());this.emit("change")};c.prototype.commitChanges=function(){this.fader.step()||this.requestRender();this._wglBuffers||(this._wglBuffers=new w.default(this.stage.context));this._wglBuffers.upload(this._data.tileBufferData,this._dirtyMap);this._displayList=this._data.tileDisplayData.displayList.clone();
this._dirtyMap.markAllClean()};c.prototype.clear=function(){this._dispRecStore=this._displayList=this._data=null;this._wglBuffers&&(this._wglBuffers.dispose(),this._wglBuffers=null)};c.prototype.attach=function(){return!0};c.prototype._readyTileIfNoLabels=function(a,b){a&&this._rebuildLabelIndex();this.isDirty=a&&b?!0:!1};c.prototype._doPatchData=function(a,b,c){this._patchData(a)||(this._dirtyMap.markAllDirty(),this._data.reshuffle(),this._dispRecStore=l.default.fromTileData(this._data,this._dirtyMap));
this._readyTileIfNoLabels(b,c);this.requestRender()};c.prototype._rebuildLabelIndex=function(){this._labelIndex=this._initLabelIndex();for(var a=0,b=this.displayObjects;a<b.length;a++)for(var c=0,d=b[a].metrics;c<d.length;c++)this._insertIntoLabelIndex(d[c])};c.prototype._insertIntoLabelIndex=function(a){0>a.xBucket||0>a.yBucket||3<a.yBucket||3<a.xBucket||this.labelIndex[a.yBucket][a.xBucket].push(a)};c.prototype._initLabelIndex=function(){for(var a=[],b=0;b<k.TILE_SIZE/k.COLLISION_BUCKET_SIZE;b++){a.push([]);
for(var c=0;c<k.TILE_SIZE/k.COLLISION_BUCKET_SIZE;c++)a[b].push([])}return a};c.prototype._patchData=function(a){for(var b=!0,c=a.addOrUpdate&&a.addOrUpdate.tileDisplayData&&a.addOrUpdate.tileDisplayData.displayObjects||[],d=(a.remove||[]).slice(),e=0;e<c.length;e++){var f=c[e];null!=f.insertAfter&&d.push(f.id)}for(f=0;f<d.length;f++){var g=d[f];if(e=this._data.tileDisplayData.displayObjectRegistry.get(g)){this._data.tileDisplayData.displayList.removeFromList(e.displayRecords);for(var k=0,l=e.displayRecords;k<
l.length;k++)this._dispRecStore.delete(l[k]);this._data.tileDisplayData.displayObjectRegistry.delete(g);e=this._data.tileDisplayData.displayObjects.indexOf(e);this._data.tileDisplayData.displayObjects.splice(e,1)}}for(d=0;d<c.length;d++){f=c[d];e=this._data.tileDisplayData.displayObjectRegistry.get(f.id);g=void 0;if(e){k=e.displayRecords;e.set(f);e.displayRecords=k;k=e.displayRecords.length;for(l=0;l<k;++l){var n=e.displayRecords[l],q=f.displayRecords[l];if(l>=f.displayRecords.length||n.geometryType!==
q.geometryType||n.symbolLevel!==q.symbolLevel||n.zOrder!==q.zOrder||n.materialKey!==q.materialKey)this._dispRecStore.delete(e.displayRecords[l]),l<f.displayRecords.length&&(e.displayRecords[l]=void 0)}e.displayRecords.length=f.displayRecords.length;e.metrics=f.metrics}else if(e=f.copy(),e.displayRecords=[],this._data.tileDisplayData.displayObjectRegistry.set(f.id,e),l=void 0,n=this._data.tileDisplayData.displayObjects,null!=e.insertAfter?(g={},0<=e.insertAfter?(k=this._data.tileDisplayData.displayObjectRegistry.get(e.insertAfter))?
(l=n.indexOf(k)+1,l<n.length?n.splice(l,0,e):(n.push(e),l=n.length)):(n.push(e),l=n.length):(n.unshift(e),l=0)):(n.push(e),l=n.length),g){q=void 0;if(this._data.tileDisplayData.displayList.unified)q=0<f.displayRecords.length?1:0;else{m.clear();for(var q=0,t=f.displayRecords;q<t.length;q++)k=this._data.tileDisplayData.displayList.getDPInfoType(t[q].geometryType),m.add(k);q=m.size}t=0;for(--l;0<=l&&t<q;--l)for(var w=n[l].displayRecords.length-1;0<=w&&t<q;--w){var v=n[l].displayRecords[w],k=this._data.tileDisplayData.displayList.getDPInfoType(v.geometryType);
g[k]||(g[k]=v,++t)}}t=f.displayRecords.length;for(l=0;l<t;++l){q=f.displayRecords[l];(n=e.displayRecords[l])?(n.meshData=q.meshData,n.materialKey=q.materialKey):(n=q.copy(),n.vertexFrom=void 0,n.indexFrom=void 0,e.displayRecords[l]=n);var w=q.geometryType,k=this._data.tileDisplayData.displayList.getDPInfoType(w),v=a.addOrUpdate.tileBufferData.geometries[w],w=v.vertexBuffer,v=v.indexBuffer,x=void 0;g&&(x=g[k]?this._data.tileDisplayData.displayList.splitAfter(g[k]):-1);b=this._dispRecStore.setMeshData(n,
q,w,v,x)&&b;g&&null!=n.indexFrom&&null!=n.indexFrom&&(g[k]=n)}}return b};return c}(x.TiledDisplayObject);c.WGLTile=b})},"esri/views/2d/engine/webgl/DirtyMap":function(){define(["require","exports","./Utils"],function(b,c,e){function g(b,a,c){if(!b.allDirty)if(null!=b.from&&null!=b.count){var e=Math.min(b.from,a);a=Math.max(b.from+b.count,a+c)-e;b.from=e;b.count=a}else b.from=a,b.count=c}Object.defineProperty(c,"__esModule",{value:!0});b=function(){function b(){this._dirties=e.createGeometryData(function(){return{indices:{from:null,
count:null,allDirty:!1}}},function(){return{vertices:{from:null,count:null,allDirty:!1}}})}b.prototype.hasDirty=function(){for(var a=0,b=this._dirties;a<b.length;a++){var c=b[a];if(null!==c.data.indices.count||c.data.indices.allDirty)return!0}return!1};b.prototype.markAllClean=function(){for(var a=0,b=this._dirties;a<b.length;a++){var c=b[a];c.data.indices.from=null;c.data.indices.count=null;c.data.indices.allDirty=!1;for(var d in c.buffers)c.buffers[d].data.vertices.from=null,c.buffers[d].data.vertices.count=
null,c.buffers[d].data.vertices.allDirty=!1}};b.prototype.markAllDirty=function(){for(var a=0,b=this._dirties;a<b.length;a++){var c=b[a];c.data.indices.allDirty=!0;for(var d in c.buffers)c.buffers[d].data.vertices.allDirty=!0}};b.prototype.forEach=function(a){for(var b=0;b<this._dirties.length;++b){var c=this._dirties[b],d={},e;for(e in c.buffers){var f=c.buffers[e].data.vertices;if(f.allDirty||null!=f.from&&null!=f.count&&0<f.count)d[e]=f}c=c.data.indices;f=void 0;f=c.allDirty||null!=c.from&&null!=
c.count&&0<c.count?{indices:c,vertices:d}:{indices:null,vertices:d};(f.indices||0<Object.keys(f).length)&&a(f,b)}};b.prototype.markDirtyIndices=function(a,b,c){g(this._dirties[a].data.indices,b,c)};b.prototype.markDirtyVertices=function(a,b,c,d){g(this._dirties[a].buffers[b].data.vertices,c,d)};return b}();c.default=b})},"esri/views/2d/engine/webgl/DisplayRecordStore":function(){define(["require","exports","../../../../core/has","./FreeList","./Utils"],function(b,c,e,g,f){function a(a){a=a.getStrides();
for(var b={},c=0;c<a.length;c++)b[n[c]]=a[c];return b}Object.defineProperty(c,"__esModule",{value:!0});var n=["FILL","LINE","MARKER","TEXT","LABEL"];b=function(){function b(a,b,c,e){this._strides=a;this._displayList=b;this._freeListsAndStorage={};this._dirtyMap=null;this._dirtyMap=c;for(var d in a){this._freeListsAndStorage[d]={vtxFreeList:e?new g.FreeList(e):null,idxFreeList:e?new g.FreeList(e):null,vertexBuffers:{},indexBuffer:e?new Uint32Array(e):null};for(var k in a[d])this._freeListsAndStorage[d].vertexBuffers[k]=
{data:e?f.allocateTypedArrayBuffer(e,a[d][k]):null,stride:a[d][k]}}}b.fromTileData=function(c,e){var d=a(c),k=[0,0,0,0,0],l=[0,0,0,0,0],m=[];c.tileDisplayData.displayObjectRegistry.forEach(function(a){m.push(a)});for(var z=0;z<m.length;z++)for(var q=0,v=m[z].displayRecords;q<v.length;q++){var p=v[q];k[p.geometryType]=Math.max(k[p.geometryType],p.vertexFrom+p.vertexCount);l[p.geometryType]=Math.max(l[p.geometryType],p.indexFrom+p.indexCount)}e=new b(d,c.tileDisplayData.displayList,e,null);for(d=0;d<
c.tileBufferData.geometries.length;++d){var z=k[d],v=l[d],p=c.tileBufferData.geometries[d],q=e._storageFor(n[d]),r=c.tileBufferData.geometries[d].indexBuffer;q.indexBuffer=r;q.idxFreeList=new g.FreeList(r.length);q.idxFreeList.allocate(v);var v=void 0,h;for(h in p.vertexBuffer)p=c.tileBufferData.geometries[d].vertexBuffer[h],q.vertexBuffers[h].data=p.data,q.vertexBuffers[h].stride=p.stride,r=f.strideToPackingFactor(p.stride),p=p.data.length*r/p.stride,v||(v=p);q.vtxFreeList=new g.FreeList(v);q.vtxFreeList.allocate(z)}return e};
b.prototype.delete=function(a){var b=n[a.geometryType];this._freeVertices(b,a.vertexFrom,a.vertexCount);this._freeIndices(b,a.indexFrom,a.indexCount);this._displayList.removeFromList(a);a.vertexFrom=void 0;a.indexFrom=void 0};b.prototype.setMeshData=function(a,b,c,e,g){var d=n[a.geometryType];a.meshData=null;var k=void 0,l=void 0;void 0===a.vertexFrom?(l=b.vertexCount,k=this._allocateVertices(d,l)):b.vertexCount>a.vertexCount?(this._freeVertices(d,a.vertexFrom,a.vertexCount),l=b.vertexCount,k=this._allocateVertices(d,
l)):b.vertexCount===a.vertexCount?(k=a.vertexFrom,l=a.vertexCount):(this._freeVertices(d,a.vertexFrom+b.vertexCount,a.vertexCount-b.vertexCount),k=a.vertexFrom,l=b.vertexCount);var t=!0,p=void 0,r=void 0,h=void 0;void 0===a.indexFrom?(p=g,h=b.indexCount,r=this._allocateIndices(d,h)):b.indexCount>a.indexCount?(p=this._displayList.removeFromList(a),this._freeIndices(d,a.indexFrom,a.indexCount),h=b.indexCount,r=this._allocateIndices(d,h)):b.indexCount===a.indexCount?(t=!1,r=a.indexFrom,h=a.indexCount):
(p=this._displayList.removeFromList(a),this._freeIndices(d,a.indexFrom+b.indexCount,a.indexCount-b.indexCount),r=a.indexFrom,h=b.indexCount);if(-1!==k&&-1!==r){g=this._storageFor(d);f.copyMeshData(k,r,g.vertexBuffers,g.indexBuffer,b,c,e);a.vertexFrom=k;a.indexFrom=r;a.vertexCount=b.vertexCount;a.indexCount=b.indexCount;if(this._dirtyMap){this._dirtyMap.markDirtyIndices(a.geometryType,a.indexFrom,a.indexCount);for(var w in c)this._dirtyMap.markDirtyVertices(a.geometryType,w,a.vertexFrom,a.vertexCount)}t&&
this._displayList.addToList(a,p);return!0}-1!==k&&this._freeVertices(d,k,l);-1!==r&&this._freeIndices(d,r,h);a.setMeshDataFromBuffers(b,c,e);a.vertexFrom=void 0;a.vertexCount=0;a.indexFrom=void 0;a.indexCount=0;return!1};b.prototype._allocateVertices=function(a,b){a=this._storageFor(a);b=a.vtxFreeList.allocate(b);return-1===b||.5<a.vtxFreeList.fragmentation?-1:b};b.prototype._freeVertices=function(a,b,c){this._storageFor(a).vtxFreeList.free(b,c)};b.prototype._freeIndices=function(a,b,c){this._storageFor(a).idxFreeList.free(b,
c)};b.prototype._allocateIndices=function(a,b){a=this._storageFor(a);b=a.idxFreeList.allocate(b);return-1===b||.5<a.idxFreeList.fragmentation?-1:b};b.prototype._storageFor=function(a){return this._freeListsAndStorage[a]};b.prototype._stridesFor=function(a,b){return this._strides[a][b]};return b}();c.default=b})},"esri/views/2d/engine/webgl/FreeList":function(){define(["require","exports"],function(b,c){Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function b(b){this._largestRange=
null;this._parent=b;this._updateLargestRange()}Object.defineProperty(b.prototype,"largestRange",{get:function(){return this._largestRange},enumerable:!0,configurable:!0});b.prototype.rangeCreated=function(b){if(!this._largestRange||b.count>this._largestRange.count)this._largestRange=b};b.prototype.rangeResized=function(b,a){if(b===this._largestRange)b.count<a&&this._updateLargestRange();else if(!this._largestRange||b.count>this._largestRange.count)this._largestRange=b};b.prototype.findBestRange=function(b){for(var a=
this._parent._freeHead,c=null;null!==a;)a.count>=b&&(!c||a.count-b<c.count-b)&&(c=a),a=a.next;return c};b.prototype.findAdjacentRanges=function(b,a){for(var c=!0,e=!1,d=null,f=this._parent._freeHead;c&&!e;){var g=null!==f?f.from:this._parent._size;b>=(null!==d?d.from+d.count:0)&&b+a<=g?(c=!1,e=!0):null!==f?(d=f,f=f.next):c=!1}return[d,f]};b.prototype._updateLargestRange=function(){for(var b=null,a=this._parent._freeHead;null!==a;){if(!b||a.count>b.count)b=a;a=a.next}this._largestRange=b};return b}();
b=function(){function b(b,a){this._allocated=0;this._size=b;this._freeHead=0<b?{from:0,count:b,prev:null,next:null}:null;this._bookKeeper=a||new e(this);this._freeHead&&this._bookKeeper.rangeCreated(this._freeHead)}b.prototype.allocate=function(c){var a=this._bookKeeper.findBestRange(c);if(null===a)return-1;var e=a.from,f=a.count;a.from+=c;a.count-=c;this._bookKeeper.rangeResized(a,e,f);this._allocated+=c;0===a.count&&(c=null!==a.prev?this._freeHead:a.next,b._removeRange(a),this._freeHead=c);return e};
b.prototype.free=function(c,a){var e=this._bookKeeper.findAdjacentRanges(c,a),f=e[0],e=e[1];c={from:c,count:a,prev:f,next:e};null!==f&&(f.next=c);null!==e&&(e.prev=c);this._bookKeeper.rangeCreated(c);this._allocated-=a;if(null!==e&&c.from+c.count===e.from){a=c.from;var d=c.count;b._fuse(c,e);b._removeRange(e);this._bookKeeper.rangeResized(c,a,d);this._bookKeeper.rangeResized(e,void 0,0)}null!==f&&f.from+f.count===c.from&&(a=f.from,d=f.count,b._fuse(f,c),b._removeRange(c),this._bookKeeper.rangeResized(f,
a,d),this._bookKeeper.rangeResized(c,void 0,0));this._freeHead=null!==c.prev?this._freeHead:c};Object.defineProperty(b.prototype,"fragmentation",{get:function(){var b=this._size-this._allocated;return 0===b?0:1-this._bookKeeper.largestRange.count/b},enumerable:!0,configurable:!0});b._removeRange=function(b){null!==b.prev?null!==b.next?(b.prev.next=b.next,b.next.prev=b.prev):b.prev.next=null:null!==b.next&&(b.next.prev=null)};b._fuse=function(b,a){b.count+=a.count;b.next=a.next;a.from+=a.count;a.count=
0;null!==a.next&&(a.next.prev=b)};return b}();c.FreeList=b})},"esri/views/2d/engine/webgl/Fader":function(){define(["require","exports"],function(b,c){Object.defineProperty(c,"__esModule",{value:!0});b=function(){function b(b){void 0===b&&(b=400);this.duration=b;this._value=this._elapsed=this._lastTime=0;this._finished=!1}Object.defineProperty(b.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0});b.prototype.reset=function(){this._value=this._elapsed=this._lastTime=
0};b.prototype.step=function(){var b=performance.now();if(0===this._lastTime)return this._lastTime=b,this._value=0,!0;if(this._elapsed>=this.duration)return!0;this._elapsed+=b-this._lastTime;this._lastTime=b;this._value=Math.min(this._elapsed/this.duration,1);return!1};return b}();c.default=b})},"esri/views/2d/engine/webgl/WGLBuffers":function(){define(["require","exports","../../../webgl","./Utils"],function(b,c,e,g){Object.defineProperty(c,"__esModule",{value:!0});b=function(){function b(a){this.geometryMap=
g.createGeometryData(function(){return{indexBuffer:e.BufferObject.createIndex(a,35044),vao:null}},function(b,c){return{vertexBuffer:e.BufferObject.createVertex(a,g.C_VBO_INFO[c])}})}b.prototype.dispose=function(){for(var a=0;5>a;a++){var b=this.geometryMap[a];if(b){b.data.vao&&b.data.vao.dispose(!1);b.data.indexBuffer&&b.data.indexBuffer.dispose();for(var c in b.buffers)b.buffers[c]&&b.buffers[c].data.vertexBuffer.dispose()}}};b.prototype.get=function(a){var b=this.geometryMap[a];a={};for(var c in b.buffers)a[c]=
b.buffers[c].data.vertexBuffer;return{indexBuffer:b.data.indexBuffer,get vao(){return b.data.vao},set vao(a){b.data.vao=a},vertexBufferMap:a}};b.prototype.has=function(a){return null!=this.geometryMap[a]};b.prototype.upload=function(a,b){var c=this;b.forEach(function(b,e){c._upload(b,e,a)})};b.prototype._upload=function(a,b,c){a.indices&&(a.indices.allDirty?this._uploadIndices(c,b):null!=a.indices.from&&null!=a.indices.count&&this._uploadIndices(c,b,a.indices.from,a.indices.count));if(a.vertices){a=
a.vertices;for(var d in a){var e=a[d];e.allDirty?this._uploadVertices(c,b,d):null!=e.from&&null!=e.count&&this._uploadVertices(c,b,d,e.from,e.count)}}};b.prototype._uploadVertices=function(a,b,c,d,e){var f=this.geometryMap[b];f&&(b=a.geometries[b].vertexBuffer[c])&&(a=b.stride,b=b.data.buffer,f.buffers[c]&&0<b.byteLength&&(null!=d&&null!=e?f.buffers[c].data.vertexBuffer.setSubData(b,d*a,d*a,(d+e)*a):f.buffers[c].data.vertexBuffer.setData(b)))};b.prototype._uploadIndices=function(a,b,c,d){var e=this.geometryMap[b];
e&&(a=a.geometries[b].indexBuffer.buffer,e.data.indexBuffer&&0<a.byteLength&&(null!=c&&null!=d?e.data.indexBuffer.setSubData(a,4*c,4*c,4*(c+d)):e.data.indexBuffer.setData(a)))};return b}();c.default=b})},"esri/views/2d/engine/webgl/shaders/MagnifierPrograms":function(){define(["require","exports","../../../../webgl","./sources/resolver"],function(b,c,e,g){Object.defineProperty(c,"__esModule",{value:!0});c.magnifier={name:"magnifier",shaders:{vertexShader:g.resolveIncludes("magnifier/magnifier.vert"),
fragmentShader:g.resolveIncludes("magnifier/magnifier.frag")},attributes:{a_pos:0}};c.createMagnifierProgram=function(b){return e.createProgram(b,c.magnifier)}})},"esri/views/2d/engine/BitmapTileContainer":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../../../geometry/support/aaBoundingRect ../engine ./BitmapTile ./webgl/enums ./webgl/TileContainer".split(" "),function(b,c,e,g,f,a,n,k,d){Object.defineProperty(c,"__esModule",{value:!0});
b=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}e(c,b);c.prototype.createTile=function(a){var b=this._tileInfoView.getTileBounds(f.create(),a);return new n.BitmapTile(a,b,this._tileInfoView.tileInfo.size)};c.prototype.destroyTile=function(){};c.prototype.prepareRenderPasses=function(c){var d=this,e=c.registerRenderPass({name:"bitmap (tile)",brushes:[a.brushes.Bitmap],target:function(){return d.children.map(function(a){return a.bitmap})},drawPhase:k.WGLDrawPhase.MAP});return b.prototype.prepareRenderPasses.call(this,
c).concat([e])};c.prototype.doRender=function(a){this.visible&&a.drawPhase===k.WGLDrawPhase.MAP&&b.prototype.doRender.call(this,a)};return c}(d.default);c.BitmapTileContainer=b})},"esri/views/2d/engine/LevelDependentSizeVariable":function(){define("require exports ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/lang ../../../core/accessorSupport/decorators ../../../renderers/visualVariables/SizeVariable ../../../renderers/visualVariables/support/sizeVariableUtils".split(" "),
function(b,c,e,g,f,a,n,k){Object.defineProperty(c,"__esModule",{value:!0});b=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}g(c,b);d=c;c.prototype.writeLevels=function(a,b,c){for(var d in a){b.stops=this.levels[d];break}};c.prototype.clone=function(){return new d({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:k.isSizeVariable(this.maxSize)?this.maxSize.clone():this.maxSize,
minDataValue:this.minDataValue,minSize:k.isSizeVariable(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops&&this.stops.map(function(a){return a.clone()}),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions&&this.legendOptions.clone(),levels:f.clone(this.levels)})};var d;e([a.property()],c.prototype,"levels",void 0);e([a.writer("levels")],
c.prototype,"writeLevels",null);return c=d=e([a.subclass("esri.views.2d.engine.LevelDependentSizeVariable")],c)}(a.declared(n));c.LevelDependentSizeVariable=b})},"*noref":1}});
define("require exports ./engine/Bitmap ./engine/BitmapContainer ./engine/BitmapTile ./engine/Container ./engine/webgl/TileContainer ./engine/DisplayObject ./engine/RasterTile ./engine/RasterTileContainer ./engine/Stage ./engine/webgl/AttributeStoreView ./engine/webgl/collisions/CollisionGrid ./engine/webgl/collisions/CollisionEngine ./engine/webgl/collisions/LayerViewSorter ./engine/webgl/Geometry ./engine/webgl/alignmentUtils ./engine/webgl/color ./engine/webgl/definitions ./engine/webgl/enums ./engine/webgl/fontUtils ./engine/webgl/Utils ./engine/webgl/brushes/BrushBitmap ./engine/webgl/brushes/BrushClip ./engine/webgl/brushes/BrushRasterBitmap ./engine/webgl/brushes/WGLBrushInfo ./engine/webgl/brushes/WGLBrushStencil ./engine/webgl/brushes/WGLBrushVTLBackground ./engine/webgl/brushes/WGLBrushVTLCircle ./engine/webgl/brushes/WGLBrushVTLFill ./engine/webgl/brushes/WGLBrushVTLLine ./engine/webgl/brushes/WGLBrushVTLSymbol ./engine/webgl/brushes/WGLGeometryBrush ./engine/webgl/brushes/WGLGeometryBrushFill ./engine/webgl/brushes/WGLGeometryBrushLabel ./engine/webgl/brushes/WGLGeometryBrushLine ./engine/webgl/brushes/WGLGeometryBrushMarker ./engine/webgl/brushes/WGLGeometryBrushText ./engine/webgl/util/debug ./engine/webgl/mesh/templates/shapingUtils ./engine/webgl/TileClipper ./engine/webgl/TurboLine ./engine/webgl/mesh/factories/matcherUtils ./engine/webgl/mesh/factories/WGLMeshFactory ./engine/webgl/mesh/MeshData ./engine/webgl/mesh/templates/WGLTemplateStore ./engine/webgl/Painter ./engine/webgl/TileData ./engine/webgl/util/BidiText ./engine/webgl/util/Matcher ./engine/webgl/util/vvFlagUtils ./engine/webgl/visualVariablesUtils ./engine/webgl/WGLRendererInfo ./engine/webgl/WGLTile ./engine/webgl/BitBlitRenderer ./engine/webgl/shaders/MagnifierPrograms ../../symbols/cim/CIMSymbolHelper ./engine/webgl/Rect ./engine/webgl/mesh/templates/util ./engine/webgl/painter/RenderPass ./engine/webgl/TiledDisplayObject ./engine/BitmapTileContainer ./engine/LevelDependentSizeVariable".split(" "),function(b,
c,e,g,f,a,n,k,d,l,t,x,w,m,z,q,v,p,r,h,y,u,D,B,C,A,I,E,H,F,L,J,G,N,M,K,O,Q,U,S,T,R,P,V,Y,Z,W,aa,ba,ca,da,ea,fa,ga,ha,X,ia,ja,ka,la,ma,na,oa){Object.defineProperty(c,"__esModule",{value:!0});c.Bitmap=e.Bitmap;c.BitmapContainer=g.BitmapContainer;c.BitmapTile=f.BitmapTile;c.Container=a.Container;c.TileContainer=n.default;c.DisplayObject=k.DisplayObject;c.RasterTile=d.RasterTile;c.RasterTileContainer=l.RasterTileContainer;c.Stage=t.Stage;c.AttributeStoreView=x.AttributeStoreView;c.CollisionGrid=w.CollisionGrid;
c.CollisionEngine=m.CollisionEngine;c.LayerViewSorter=z.LayerViewSorter;c.Point=q.Point;c.alignmentUtils=v;c.color=p;c.definitions=r;c.enums=h;c.fontUtils=y;c.Utils=u;c.debug=U;c.ShapedGlyph=S.ShapedGlyph;c.shapeGlyphs=S.shapeGlyphs;c.ShapingInfo=S.ShapingInfo;c.TileClipper=T.TileClipper;c.SimpleBuilder=T.SimpleBuilder;c.tessellate=R.tessellate;c.TessellationState=R.TessellationState;c.splitVertex=R.splitVertex;c.createMatcher=P.createMatcher;c.WGLMeshFactory=V.WGLMeshFactory;c.MeshData=Y.MeshData;
c.WGLTemplateStore=Z.WGLTemplateStore;c.Painter=W.default;c.PainterOptions=W.PainterOptions;c.TileData=aa.TileData;c.bidiText=ba.bidiText;c.FeatureMatcher=ca.FeatureMatcher;c.getVVFlags=da.getVVFlags;c.getTypeOfSizeVisualVariable=ea.getTypeOfSizeVisualVariable;c.WGLRendererInfo=fa.WGLRendererInfo;c.WGLTile=ga.WGLTile;c.BitBlitRenderer=ha.BitBlitRenderer;c.createMagnifierProgram=X.createMagnifierProgram;c.magnifier=X.magnifier;c.CIMSymbolHelper=ia.CIMSymbolHelper;c.Rect=ja.default;c.getLimitCosine=
ka.getLimitCosine;b=c.brushes||(c.brushes={});b.Geometry=G.default;b.Marker=O.default;b.Line=K.default;b.Fill=N.default;b.Text=Q.default;b.Label=M.default;b.Clip=B.default;b.Stencil=I.default;b.Bitmap=D.default;b.Raster=C.default;b.TileInfo=A.default;b.VTLBackground=E.WGLBrushVTLBackground;b.VTLFill=F.WGLBrushVTLFill;b.VTLLine=L.WGLBrushVTLLine;b.VTLCircle=H.WGLBrushVTLCircle;b.VTLSymbol=J.WGLBrushVTLSymbol;c.RenderPass=la.default;c.TiledDisplayObject=ma.TiledDisplayObject;c.BitmapTileContainer=na.BitmapTileContainer;
c.LevelDependentSizeVariable=oa.LevelDependentSizeVariable});