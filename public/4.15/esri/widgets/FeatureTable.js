// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.15/esri/copyright.txt for details.
//>>built
define("require exports ../core/tsSupport/assignHelper ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/i18n!./FeatureTable/nls/FeatureTable ../intl ../core/HandleOwner ../core/watchUtils ../core/accessorSupport/decorators ./Widget ./FeatureTable/FeatureTableViewModel ./support/widget".split(" "),function(u,v,h,n,d,f,p,q,k,e,r,t,c){var l={header:!0,menu:!0,menuItems:{clearSelection:!0,refreshData:!0,toggleColumns:!0}};return function(m){function a(b){b=m.call(this,b)||
this;b._menuActive=!1;b.attachmentsEnabled=null;b.fieldConfigs=null;b.grid=null;b.label=f.widgetLabel;b.layer=null;b.viewModel=new t;b.visibleElements=h({},l);return b}n(a,m);a.prototype.postInitialize=function(){var b=this;this.handles.add([k.on(this,"grid.selectedItems","change",function(a){return b._onSelectionChange(a)}),k.watch(this,["viewModel.store.querying","viewModel.store.syncing","grid.size"],function(){return b.scheduleRender()})])};a.prototype.castVisibleElements=function(b){return h({},
l,b)};a.prototype.render=function(){return c.tsx("div",{bind:this,class:this.classes("esri-feature-table","esri-widget")},this.visibleElements.header?this._renderHeader():null,c.tsx("div",{class:"esri-feature-table__content"},"disabled"!==this.state&&this.grid&&this.grid.render()))};a.prototype.sortColumn=function(b,a){this.viewModel&&this.viewModel.sortColumn(b,a)};a.prototype.showColumn=function(b){this.grid&&this.grid.showColumn(b)};a.prototype.hideColumn=function(b){this.grid&&this.grid.hideColumn(b)};
a.prototype.clearSelection=function(){this.grid&&this.grid.clearSelection()};a.prototype.refresh=function(){this.grid&&this.grid.refresh()};a.prototype._selectRow=function(b){var a=this.viewModel;a&&(b=(a=a.store)&&a.getIndexForObjectId(b),this.grid&&this.grid.selectRow(b))};a.prototype._deselectRow=function(b){var a=this.viewModel;a&&(b=(a=a.store)&&a.getIndexForObjectId(b),this.grid&&this.grid.deselectRow(b))};a.prototype._renderHeader=function(){return c.tsx("div",{key:"header",class:"esri-feature-table__header"},
this._renderLoader(),this._renderTitle(),this._renderMenu())};a.prototype._renderTitle=function(){return c.tsx("div",{class:"esri-feature-table__title",key:"title"},this._getTitle())};a.prototype._getTitle=function(){var b=this.grid;return b?p.substitute(f.header,{title:this.layer.title,count:this.viewModel.size,selected:b.selectedItems.length||0}):""};a.prototype._renderLoader=function(){var b=this.viewModel,a=b.store;return c.tsx("div",{class:"esri-feature-table__loader-container"},"loading"===
b.state||a.syncing||a.querying?c.tsx("div",{class:"esri-feature-table__loader",key:"loader"}):null)};a.prototype._renderMenu=function(){if(this.visibleElements.menu)return c.tsx("div",{class:"esri-feature-table__menu",key:"menu"},c.tsx("div",{class:"esri-feaute-table__menu-anchor"},this._renderMenuButton(),this._renderMenuContent()))};a.prototype._renderMenuButton=function(){var b=f.menu,a=this.classes(["esri-feature-table__button","esri-icon-menu",this._menuActive?"esri-feature-table__button--selected":
null]);return c.tsx("button",{"aria-label":b,bind:this,class:a,title:b,selected:this._menuActive,onclick:this._onMenuButtonClick})};a.prototype._renderMenuContent=function(){var b=this.visibleElements.menuItems,a=b.refreshData,e=b.toggleColumns;return c.tsx("div",{class:"esri-feature-table__menu-content",bind:this,hidden:!this._menuActive},c.tsx("ul",{class:"esri-feature-table__menu-accordion",role:"menu"},b.clearSelection?this._renderMenuItem(f.clearSelection,this.clearSelection):null,a?this._renderMenuItem(f.refreshData,
this.refresh):null,e?this._renderColumnToggleMenuItemGroup():null))};a.prototype._renderMenuItem=function(b,a){return c.tsx("li",{class:"esri-feature-table__menu-item",role:"menuitem"},c.tsx("button",{bind:this,onclick:a,class:this.classes("esri-feature-table__button","esri-feature-table__menu-item-label")},c.tsx("span",{class:"esri-feature-table__menu-item-label__content"},b)))};a.prototype._renderColumnToggleMenuItemGroup=function(){var a=this.id+"-menu-group";return c.tsx("li",{class:"esri-feature-table__menu-item",
role:"menuitem"},c.tsx("input",{class:"esri-feature-table__menu-input",type:"checkbox",name:a,id:a}),c.tsx("label",{class:"esri-feature-table__menu-item-label",for:a},c.tsx("span",{class:this.classes("esri-feature-table__menu-item-label__content","esri-icon-right"),"aria-hidden":!0}),c.tsx("span",{class:"esri-feature-table__menu-item-label__content"},f.toggleColumns)),this._renderColumnToggleMenuItem())};a.prototype._renderColumnToggleMenuItem=function(){var a=this,e=this.id,d=this.viewModel.columns;
return c.tsx("ul",{class:"esri-feature-table__menu-accordion-sub"},d&&d.items.map(function(b){var d=b.header,f=b.hidden,g=b.path;b=e+"-menu-item-"+g;return c.tsx("li",{key:b,class:"esri-feature-table__menu-item"},c.tsx("a",{class:"esri-feature-table__menu-item-label"},c.tsx("input",{class:"esri-feature-table__menu-item__input",type:"checkbox",name:b,id:b,checked:!f,onchange:function(b){return a._onColumnCheckboxChange(g,b.target)}}),c.tsx("label",{for:b,class:a.classes("esri-feature-table__menu-item__icon",
f?null:"esri-icon-check-mark")}),c.tsx("label",{class:"esri-feature-table__menu-item-label",for:b},d||g)))}))};a.prototype._onColumnCheckboxChange=function(a,c){c&&c.checked?this.showColumn(a):this.hideColumn(a)};a.prototype._onMenuButtonClick=function(){this._menuActive=!this._menuActive};a.prototype._onSelectionChange=function(a){var b=a.removed;this.emit("selection-change",{added:a.added.slice(),removed:b.slice()})};d([e.aliasOf("viewModel.attachmentsEnabled")],a.prototype,"attachmentsEnabled",
void 0);d([e.aliasOf("viewModel.fieldConfigs")],a.prototype,"fieldConfigs",void 0);d([e.aliasOf("viewModel.grid")],a.prototype,"grid",void 0);d([e.property()],a.prototype,"label",void 0);d([e.aliasOf("viewModel.layer")],a.prototype,"layer",void 0);d([e.aliasOf("viewModel.relatedRecordsEnabled")],a.prototype,"relatedRecordsEnabled",void 0);d([e.aliasOf("viewModel.state")],a.prototype,"state",void 0);d([e.property(),c.renderable(["viewModel.attachmentsEnabled","viewModel.layer","viewModel.relatedRecordsEnabled",
"viewModel.state"])],a.prototype,"viewModel",void 0);d([e.property(),c.renderable()],a.prototype,"visibleElements",void 0);d([e.cast("visibleElements")],a.prototype,"castVisibleElements",null);return a=d([e.subclass("esri.widgets.FeatureTable")],a)}(e.declared(q.HandleOwnerMixin(r)))});