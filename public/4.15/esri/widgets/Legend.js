// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.15/esri/copyright.txt for details.
//>>built
/*

 Copyright 2000, Silicon Graphics, Inc. All Rights Reserved.
 Copyright 2015, Google Inc. All Rights Reserved.

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to
 deal in the Software without restriction, including without limitation the
 rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 sell copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice including the dates of first publication and
 either this permission notice or a reference to http://oss.sgi.com/projects/FreeB/
 shall be included in all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL
 SILICON GRAPHICS, INC. BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR
 IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

 Original Code. The Original Code is: OpenGL Sample Implementation,
 Version 1.2.1, released January 26, 2000, developed by Silicon Graphics,
 Inc. The Original Code is Copyright (c) 1991-2000 Silicon Graphics, Inc.
 Copyright in any portions created by third parties is as indicated
 elsewhere herein. All Rights Reserved.
*/
require({cache:{"esri/widgets/Legend/LegendViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/Collection ../../core/Handles ../../core/watchUtils ../../core/accessorSupport/decorators ../../views/2d/layers/support/clusterUtils ./support/ActiveLayerInfo".split(" "),function(g,b,l,k,f,a,q,m,d,c,e){var h=a.ofType(e),p="esri.layers.CSVLayer esri.layers.FeatureLayer esri.layers.HeatmapLayer esri.layers.MapImageLayer esri.layers.PointCloudLayer esri.layers.TileLayer esri.layers.StreamLayer esri.layers.SceneLayer esri.layers.GeoRSSLayer esri.layers.GeoJSONLayer esri.layers.GroupLayer esri.layers.ImageryLayer esri.layers.WMSLayer esri.layers.WMTSLayer esri.layers.TileImageryLayer".split(" "),
n=["view.basemapView.baseLayerViews","view.groundView.layerViews","view.layerViews","view.basemapView.referenceLayerViews"];return function(a){function x(c){c=a.call(this,c)||this;c._handles=new q;c._layerViewByLayerId={};c._layerInfosByLayerViewId={};c._activeLayerInfosByLayerViewId={};c.activeLayerInfos=new h;c.basemapLegendVisible=!1;c.groundLegendVisible=!1;c.respectLayerVisibility=!0;c.layerInfos=[];c.view=null;return c}l(x,a);x.prototype.initialize=function(){this._handles.add(m.init(this,"view",
this._viewHandles),"view")};x.prototype.destroy=function(){this._destroyViewActiveLayerInfos();this._handles.destroy();this.view=this._handles=null};Object.defineProperty(x.prototype,"state",{get:function(){return this.get("view.ready")?"ready":"disabled"},enumerable:!0,configurable:!0});x.prototype._viewHandles=function(){this._handles.remove("state");this.view&&this._handles.add(m.init(this,"state",this._stateHandles),"state")};x.prototype._stateHandles=function(){this._resetAll();"ready"===this.state&&
this._watchPropertiesAndAllLayerViews()};x.prototype._resetAll=function(){this._handles.remove(["all-layer-views","legend-properties"]);this._destroyViewActiveLayerInfos();this.activeLayerInfos.removeAll()};x.prototype._destroyViewActiveLayerInfos=function(){Object.keys(this._activeLayerInfosByLayerViewId).forEach(this._destroyViewActiveLayerInfo,this)};x.prototype._destroyViewActiveLayerInfo=function(c){this._handles.remove(c);var e=this._activeLayerInfosByLayerViewId[c];delete this._activeLayerInfosByLayerViewId[c];
e&&e.parent&&e.parent.children.remove(e)};x.prototype._watchPropertiesAndAllLayerViews=function(){var c=this.view.allLayerViews;c.length&&this._refresh();this._handles.add(c.on("change",this._allLayerViewsChangeHandle.bind(this)),"all-layer-views");this._handles.add(m.watch(this,"layerInfos, basemapLegendVisible, groundLegendVisible",this._propertiesChangeHandle.bind(this)),"legend-properties")};x.prototype._allLayerViewsChangeHandle=function(c){var e=this;c.removed.forEach(function(c){return e._destroyViewActiveLayerInfo(c.uid)});
this._refresh()};x.prototype._propertiesChangeHandle=function(){this._destroyViewActiveLayerInfos();this._refresh()};x.prototype._refresh=function(){this._layerInfosByLayerViewId={};this.activeLayerInfos.removeAll();this._generateLayerViews().filter(this._filterLayerViewsByLayerInfos,this).filter(this._isLayerViewSupported,this).forEach(this._generateActiveLayerInfo,this);this._sortActiveLayerInfos(this.activeLayerInfos)};x.prototype._sortActiveLayerInfos=function(c){var e=this;if(!(2>c.length)){var a=
[];c.forEach(function(d){if(!d.parent){var h=d.layer.parent;(h=(h=h&&"uid"in h&&e._layerViewByLayerId[h.uid])&&e._activeLayerInfosByLayerViewId[h.uid])&&-1!==c.indexOf(h)&&(a.push(d),d.parent=h,h.children.add(d),e._sortActiveLayerInfos(h.children))}});c.removeMany(a);var d={};this.view.allLayerViews.forEach(function(c,e){return d[c.layer.uid]=e});c.sort(function(c,e){return(d[e.layer.uid]||0)-(d[c.layer.uid]||0)})}};x.prototype._generateLayerViews=function(){var c=[];n.filter(this._filterLayerViews,
this).map(this.get,this).filter(function(c){return null!=c}).forEach(this._collectLayerViews("layerViews",c));return c};x.prototype._filterLayerViews=function(c){var e=!this.groundLegendVisible&&"view.groundView.layerViews"===c;return!(!this.basemapLegendVisible&&("view.basemapView.baseLayerViews"===c||"view.basemapView.referenceLayerViews"===c))&&!e};x.prototype._collectLayerViews=function(c,e){var a=function(d){d&&d.forEach(function(d){e.push(d);a(d[c])});return e};return a};x.prototype._filterLayerViewsByLayerInfos=
function(c){var e=this,a=this.layerInfos;return a&&a.length?a.some(function(a){return e._hasLayerInfo(a,c)}):!0};x.prototype._hasLayerInfo=function(c,e){var a=this._isLayerUIDMatching(c.layer,e.layer.uid);a&&(this._layerInfosByLayerViewId[e.uid]=c);return a};x.prototype._isLayerUIDMatching=function(c,e){return c&&(c.uid===e||this._hasLayerUID(c.layers,e))};x.prototype._hasLayerUID=function(c,e){var a=this;return c&&c.some(function(c){return a._isLayerUIDMatching(c,e)})};x.prototype._isLayerViewSupported=
function(c){return-1<p.indexOf(c.layer.declaredClass)?(this._layerViewByLayerId[c.layer.uid]=c,!0):!1};x.prototype._generateActiveLayerInfo=function(c){var e=this;this._isLayerActive(c)?this._buildActiveLayerInfo(c):(this._handles.remove(c.uid),this._handles.add(m.watch(c,"suspended, layer.legendEnabled",function(){return e._layerActiveHandle(c)}),c.uid))};x.prototype._layerActiveHandle=function(c){this._isLayerActive(c)&&(this._handles.remove(c.uid),this._buildActiveLayerInfo(c))};x.prototype._isLayerActive=
function(c){return this.respectLayerVisibility?!c.suspended&&c.get("layer.legendEnabled"):!0};x.prototype._buildActiveLayerInfo=function(c){var a=this,d=c.layer,h=c.uid,n=this._layerInfosByLayerViewId[h],p=this._activeLayerInfosByLayerViewId[h];p||(p=new e({layer:d,title:n&&void 0!==n.title?n.title:d.title,view:this.view,respectLayerVisibility:this.respectLayerVisibility,sublayerIds:n&&n.sublayerIds||[]}),this._activeLayerInfosByLayerViewId[h]=p);p.parent||(n=(n=d.parent)&&this._layerViewByLayerId[n.uid],
p.parent=n&&this._activeLayerInfosByLayerViewId[n.uid]);if(!this._handles.has(h)){var n=m.watch(d,"title",function(e){return a._titleHandle(e,p,c)}),q=m.watch(d,"renderer?, opacity",function(){return a._constructLegendElements(p,c)}),x=m.whenTrue(this.view,"stationary",function(){return a._scaleHandle(p,c)}),b=m.watch(c,"_effectiveRenderer",function(){return a._constructLegendElements(p,c)}),n=[n,q,x,b];this.respectLayerVisibility&&(q=m.watch(c,"suspended",function(e){return a._suspendedHandle(e,
p,c)}),d=m.watch(d,"legendEnabled",function(e){return a._legendEnabledHandle(e,p,c)}),n.push(q,d));this._handles.add(n,h)}p.isScaleDriven||this._constructLegendElements(p,c);this._addActiveLayerInfo(p,c)};x.prototype._titleHandle=function(c,e,a){e.title=c;this._constructLegendElements(e,a)};x.prototype._legendEnabledHandle=function(c,e,a){c?this._addActiveLayerInfo(e,a):this._removeActiveLayerInfo(e)};x.prototype._suspendedHandle=function(c,e,a){c?this._removeActiveLayerInfo(e):this._addActiveLayerInfo(e,
a)};x.prototype._scaleHandle=function(c,e){c.isScaleDriven&&this._constructLegendElements(c,e)};x.prototype._addActiveLayerInfo=function(c,e){this._isLayerActive(e)&&-1===this.activeLayerInfos.indexOf(c)&&((e=c.parent)?(-1===e.children.indexOf(c)&&e.children.push(c),this._sortActiveLayerInfos(e.children)):(this.activeLayerInfos.add(c),this._sortActiveLayerInfos(this.activeLayerInfos)))};x.prototype._removeActiveLayerInfo=function(c){var e=c.parent;e?e.children.remove(c):this.activeLayerInfos.remove(c)};
x.prototype._constructLegendElements=function(e,a){var d=a.layer;d.featureCollections?e.buildLegendElementsForFeatureCollections(d.featureCollections):d.renderer?e.buildLegendElementsForRenderer(d.renderer):d.url&&e.buildLegendElementsForTools();if(d.featureReduction&&"cluster"===d.featureReduction.type){a=a._effectiveRenderer;var h=(d=d.renderer.clone())&&"visualVariables"in d&&d.visualVariables||[];if(!(a&&"visualVariables"in a&&a.visualVariables))return null;a=c.findSizeVV(a.visualVariables);c.getActiveSizeStops(this.view,
a)&&(d.visualVariables=h.concat([a]),e.buildLegendElementsForRenderer(d))}};k([d.property({type:h})],x.prototype,"activeLayerInfos",void 0);k([d.property()],x.prototype,"basemapLegendVisible",void 0);k([d.property()],x.prototype,"groundLegendVisible",void 0);k([d.property()],x.prototype,"respectLayerVisibility",void 0);k([d.property()],x.prototype,"layerInfos",void 0);k([d.property({dependsOn:["view.ready"],readOnly:!0})],x.prototype,"state",null);k([d.property()],x.prototype,"view",void 0);return x=
k([d.subclass("esri.widgets.Legend.LegendViewModel")],x)}(d.declared(f))})},"esri/views/2d/layers/support/clusterUtils":function(){define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/tsSupport/assignHelper ../../../../core/Error ../../../../core/has ../../../../core/Logger ../../../../core/maybe ../../../../core/MD5 ../../../../renderers/visualVariables/SizeVariable ../../../../renderers/visualVariables/support/SizeStop ../../engine".split(" "),
function(g,b,l,k,f,a,q,m,d,c,e,h,p){function n(e,a,d){switch(e){case "avg":case "avg_angle":return"cluster_avg_"+a;case "mode":return"cluster_type_"+a;case "norm":return e=a.toLowerCase()+",norm:field,"+d.toLowerCase(),"cluster_avg_"+c.createMD5Hash(e)}}function u(e,a,d){var h=c.createMD5Hash(a),n="mode"===d?"cluster_type_"+h:"cluster_avg_"+h;e.some(function(c){return c.name===n})||e.push({name:n,outStatistic:{onStatisticField:h,onStatisticValueExpression:a,statisticType:d}});return n}function x(c,
e,a,d){var h=n(a,e,d);c.some(function(c){return c.name===h})||("norm"===a?c.push({name:h,outStatistic:{onStatisticField:e,onStatisticNormalizationField:d,statisticType:a}}):c.push({name:h,outStatistic:{onStatisticField:e,statisticType:a}}));return h}var v=this;Object.defineProperty(b,"__esModule",{value:!0});var t=m.getLogger("esri.views.2d.layers.support.clusterUtils");q.add("esri-cluster-arcade-enabled",1);var w=q("esri-cluster-arcade-enabled");b.createClusterRenderer=function(c,e,a,h,n){return k(v,
void 0,void 0,function(){var e,p,m;return l(this,function(q){e=a.clone();if(!b.isClusterCompatibleRenderer(e))return[2,e];p="visualVariables"in e&&e.visualVariables||[];m=b.findSizeVV(p);p.forEach(function(e){"rotation"===e.type?e.field?e.field=x(c,e.field,"avg_angle"):e.valueExpression&&(e.field=u(c,e.valueExpression,"avg_angle"),e.valueExpression=null):e.normalizationField?(e.field=x(c,e.field,"norm",e.normalizationField),e.normalizationField=null):e.field?e.field=x(c,e.field,"avg"):(e.field=u(c,
e.valueExpression,"avg"),e.valueExpression=null)});d.isNone(m)&&p.push(b.createClusterCountSizeVariable(h,n));switch(e.type){case "unique-value":e.field?e.field=x(c,e.field,"mode"):e.valueExpression&&(e.field=u(c,e.valueExpression,"mode"),e.valueExpression=null);break;case "class-breaks":e.normalizationField?(e.field=x(c,e.field,"norm",e.normalizationField),e.normalizationField=null):e.field?e.field=x(c,e.field,"avg"):(e.field=u(c,e.valueExpression,"avg"),e.valueExpression=null)}e.visualVariables=
p;return[2,e]})})};b.findSizeVV=function(c){for(var e=0;e<c.length;e++){var a=c[e];if("size"===a.type)return a}return null};b.getActiveSizeStops=function(c,e){c=c.featuresTilingScheme.getClosestInfoForScale(c.scale).level;return e.levels?e.levels[c]:null};b.createClusterCountSizeVariable=function(c,a){var n=[new h({value:0,size:0}),new h({value:1})];if(d.isNone(a))return new e({field:"cluster_count",stops:n.concat([new h({value:2,size:0})])});c=Object.keys(a).reduce(function(c,e){var d;return f({},
c,(d={},d[e]=n.concat([new h({value:Math.max(2,a[e].minValue),size:"12px"}),new h({value:Math.max(3,a[e].maxValue),size:"50px"})]),d))},{});return new p.LevelDependentSizeVariable({field:"cluster_count",levels:c})};b.isClusterCompatibleRenderer=function(c){var e=function(e){return t.error(new a("Unsupported-renderer",e,{renderer:c}))};if("unique-value"===c.type){if(c.field2||c.field3)return e("FeatureReductionCluster does not support multi-field UniqueValueRenderers"),!1}else if("class-breaks"===
c.type){if(c.normalizationField){var d=c.normalizationType;if("field"!==d)return e("FeatureReductionCluster does not support a normalizationType of "+d),!1}}else if("simple"!==c.type)return e("FeatureReductionCluster does not support renderers of type "+c.type),!1;if(!w){if("valueExpression"in c&&c.valueExpression)return e("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"),!1;if(("visualVariables"in c&&c.visualVariables||[]).some(function(c){return!!("valueExpression"in
c&&c.valueExpression)}))return e("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"),!1}return!0}})},"esri/core/MD5":function(){define(["require","exports"],function(g,b){function l(a,d){var c=(a&65535)+(d&65535);return(a>>16)+(d>>16)+(c>>16)<<16|c&65535}function k(a,d,c,e,h,p){a=l(l(d,a),l(e,p));return l(a<<h|a>>>32-h,c)}function f(a,d,c,e,h,p,n){return k(d&c|~d&e,a,d,h,p,n)}function a(a,d,c,e,h,p,n){return k(d&e|
c&~e,a,d,h,p,n)}function q(a,d,c,e,h,p,n){return k(c^(d|~e),a,d,h,p,n)}Object.defineProperty(b,"__esModule",{value:!0});b.outputTypes={Base64:0,Hex:1,String:2,Raw:3};b.createMD5Hash=function(m,d){void 0===d&&(d=b.outputTypes.Hex);d=d||b.outputTypes.Base64;for(var c=[],e=0,h=8*m.length;e<h;e+=8)c[e>>5]|=(m.charCodeAt(e/8)&255)<<e%32;m=8*m.length;c[m>>5]|=128<<m%32;c[(m+64>>>9<<4)+14]=m;m=1732584193;for(var e=-271733879,h=-1732584194,p=271733878,n=0;n<c.length;n+=16){var u=m,x=e,v=h,t=p;m=f(m,e,h,p,
c[n+0],7,-680876936);p=f(p,m,e,h,c[n+1],12,-389564586);h=f(h,p,m,e,c[n+2],17,606105819);e=f(e,h,p,m,c[n+3],22,-1044525330);m=f(m,e,h,p,c[n+4],7,-176418897);p=f(p,m,e,h,c[n+5],12,1200080426);h=f(h,p,m,e,c[n+6],17,-1473231341);e=f(e,h,p,m,c[n+7],22,-45705983);m=f(m,e,h,p,c[n+8],7,1770035416);p=f(p,m,e,h,c[n+9],12,-1958414417);h=f(h,p,m,e,c[n+10],17,-42063);e=f(e,h,p,m,c[n+11],22,-1990404162);m=f(m,e,h,p,c[n+12],7,1804603682);p=f(p,m,e,h,c[n+13],12,-40341101);h=f(h,p,m,e,c[n+14],17,-1502002290);e=f(e,
h,p,m,c[n+15],22,1236535329);m=a(m,e,h,p,c[n+1],5,-165796510);p=a(p,m,e,h,c[n+6],9,-1069501632);h=a(h,p,m,e,c[n+11],14,643717713);e=a(e,h,p,m,c[n+0],20,-373897302);m=a(m,e,h,p,c[n+5],5,-701558691);p=a(p,m,e,h,c[n+10],9,38016083);h=a(h,p,m,e,c[n+15],14,-660478335);e=a(e,h,p,m,c[n+4],20,-405537848);m=a(m,e,h,p,c[n+9],5,568446438);p=a(p,m,e,h,c[n+14],9,-1019803690);h=a(h,p,m,e,c[n+3],14,-187363961);e=a(e,h,p,m,c[n+8],20,1163531501);m=a(m,e,h,p,c[n+13],5,-1444681467);p=a(p,m,e,h,c[n+2],9,-51403784);h=
a(h,p,m,e,c[n+7],14,1735328473);e=a(e,h,p,m,c[n+12],20,-1926607734);m=k(e^h^p,m,e,c[n+5],4,-378558);p=k(m^e^h,p,m,c[n+8],11,-2022574463);h=k(p^m^e,h,p,c[n+11],16,1839030562);e=k(h^p^m,e,h,c[n+14],23,-35309556);m=k(e^h^p,m,e,c[n+1],4,-1530992060);p=k(m^e^h,p,m,c[n+4],11,1272893353);h=k(p^m^e,h,p,c[n+7],16,-155497632);e=k(h^p^m,e,h,c[n+10],23,-1094730640);m=k(e^h^p,m,e,c[n+13],4,681279174);p=k(m^e^h,p,m,c[n+0],11,-358537222);h=k(p^m^e,h,p,c[n+3],16,-722521979);e=k(h^p^m,e,h,c[n+6],23,76029189);m=k(e^
h^p,m,e,c[n+9],4,-640364487);p=k(m^e^h,p,m,c[n+12],11,-421815835);h=k(p^m^e,h,p,c[n+15],16,530742520);e=k(h^p^m,e,h,c[n+2],23,-995338651);m=q(m,e,h,p,c[n+0],6,-198630844);p=q(p,m,e,h,c[n+7],10,1126891415);h=q(h,p,m,e,c[n+14],15,-1416354905);e=q(e,h,p,m,c[n+5],21,-57434055);m=q(m,e,h,p,c[n+12],6,1700485571);p=q(p,m,e,h,c[n+3],10,-1894986606);h=q(h,p,m,e,c[n+10],15,-1051523);e=q(e,h,p,m,c[n+1],21,-2054922799);m=q(m,e,h,p,c[n+8],6,1873313359);p=q(p,m,e,h,c[n+15],10,-30611744);h=q(h,p,m,e,c[n+6],15,-1560198380);
e=q(e,h,p,m,c[n+13],21,1309151649);m=q(m,e,h,p,c[n+4],6,-145523070);p=q(p,m,e,h,c[n+11],10,-1120210379);h=q(h,p,m,e,c[n+2],15,718787259);e=q(e,h,p,m,c[n+9],21,-343485551);m=l(m,u);e=l(e,x);h=l(h,v);p=l(p,t)}c=[m,e,h,p];switch(d){case b.outputTypes.Raw:return c;case b.outputTypes.Hex:d=[];m=0;for(e=4*c.length;m<e;m++)d.push("0123456789abcdef".charAt(c[m>>2]>>m%4*8+4&15)+"0123456789abcdef".charAt(c[m>>2]>>m%4*8&15));return d.join("");case b.outputTypes.String:d=[];m=0;for(e=32*c.length;m<e;m+=8)d.push(String.fromCharCode(c[m>>
5]>>>m%32&255));return d.join("");case b.outputTypes.Base64:d=[];m=0;for(e=4*c.length;m<e;m+=3)for(h=(c[m>>2]>>m%4*8&255)<<16|(c[m+1>>2]>>(m+1)%4*8&255)<<8|c[m+2>>2]>>(m+2)%4*8&255,p=0;4>p;p++)8*m+6*p>32*c.length?d.push("\x3d"):d.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(h>>6*(3-p)&63));return d.join("")}}})},"esri/views/2d/engine":function(){define("require exports ./engine/Bitmap ./engine/BitmapContainer ./engine/BitmapTile ./engine/Container ./engine/webgl/TileContainer ./engine/DisplayObject ./engine/RasterTile ./engine/RasterTileContainer ./engine/Stage ./engine/webgl/AttributeStoreView ./engine/webgl/collisions/CollisionGrid ./engine/webgl/collisions/CollisionEngine ./engine/webgl/collisions/LayerViewSorter ./engine/webgl/Geometry ./engine/webgl/alignmentUtils ./engine/webgl/color ./engine/webgl/definitions ./engine/webgl/enums ./engine/webgl/fontUtils ./engine/webgl/Utils ./engine/webgl/brushes/BrushBitmap ./engine/webgl/brushes/BrushClip ./engine/webgl/brushes/BrushRasterBitmap ./engine/webgl/brushes/WGLBrushInfo ./engine/webgl/brushes/WGLBrushStencil ./engine/webgl/brushes/WGLBrushVTLBackground ./engine/webgl/brushes/WGLBrushVTLCircle ./engine/webgl/brushes/WGLBrushVTLFill ./engine/webgl/brushes/WGLBrushVTLLine ./engine/webgl/brushes/WGLBrushVTLSymbol ./engine/webgl/brushes/WGLGeometryBrush ./engine/webgl/brushes/WGLGeometryBrushFill ./engine/webgl/brushes/WGLGeometryBrushLabel ./engine/webgl/brushes/WGLGeometryBrushLine ./engine/webgl/brushes/WGLGeometryBrushMarker ./engine/webgl/brushes/WGLGeometryBrushText ./engine/webgl/util/debug ./engine/webgl/mesh/templates/shapingUtils ./engine/webgl/TileClipper ./engine/webgl/TurboLine ./engine/webgl/mesh/factories/matcherUtils ./engine/webgl/mesh/factories/WGLMeshFactory ./engine/webgl/mesh/MeshData ./engine/webgl/mesh/templates/WGLTemplateStore ./engine/webgl/Painter ./engine/webgl/TileData ./engine/webgl/util/BidiText ./engine/webgl/util/Matcher ./engine/webgl/util/vvFlagUtils ./engine/webgl/visualVariablesUtils ./engine/webgl/WGLRendererInfo ./engine/webgl/WGLTile ./engine/webgl/BitBlitRenderer ./engine/webgl/shaders/MagnifierPrograms ../../symbols/cim/CIMSymbolHelper ./engine/webgl/Rect ./engine/webgl/mesh/templates/util ./engine/webgl/painter/RenderPass ./engine/webgl/TiledDisplayObject ./engine/BitmapTileContainer ./engine/LevelDependentSizeVariable".split(" "),
function(g,b,l,k,f,a,q,m,d,c,e,h,p,n,u,x,v,t,w,r,y,A,z,B,C,D,H,F,E,G,J,K,I,N,M,L,Q,O,S,U,T,R,P,V,X,W,Z,Y,aa,ba,ca,ia,ja,ka,la,ea,ma,na,oa,pa,qa,ra,sa){Object.defineProperty(b,"__esModule",{value:!0});b.Bitmap=l.Bitmap;b.BitmapContainer=k.BitmapContainer;b.BitmapTile=f.BitmapTile;b.Container=a.Container;b.TileContainer=q.default;b.DisplayObject=m.DisplayObject;b.RasterTile=d.RasterTile;b.RasterTileContainer=c.RasterTileContainer;b.Stage=e.Stage;b.AttributeStoreView=h.AttributeStoreView;b.CollisionGrid=
p.CollisionGrid;b.CollisionEngine=n.CollisionEngine;b.LayerViewSorter=u.LayerViewSorter;b.Point=x.Point;b.alignmentUtils=v;b.color=t;b.definitions=w;b.enums=r;b.fontUtils=y;b.Utils=A;b.debug=S;b.ShapedGlyph=U.ShapedGlyph;b.shapeGlyphs=U.shapeGlyphs;b.ShapingInfo=U.ShapingInfo;b.TileClipper=T.TileClipper;b.SimpleBuilder=T.SimpleBuilder;b.tessellate=R.tessellate;b.TessellationState=R.TessellationState;b.splitVertex=R.splitVertex;b.createMatcher=P.createMatcher;b.WGLMeshFactory=V.WGLMeshFactory;b.MeshData=
X.MeshData;b.WGLTemplateStore=W.WGLTemplateStore;b.Painter=Z.default;b.PainterOptions=Z.PainterOptions;b.TileData=Y.TileData;b.bidiText=aa.bidiText;b.FeatureMatcher=ba.FeatureMatcher;b.getVVFlags=ca.getVVFlags;b.getTypeOfSizeVisualVariable=ia.getTypeOfSizeVisualVariable;b.WGLRendererInfo=ja.WGLRendererInfo;b.WGLTile=ka.WGLTile;b.BitBlitRenderer=la.BitBlitRenderer;b.createMagnifierProgram=ea.createMagnifierProgram;b.magnifier=ea.magnifier;b.CIMSymbolHelper=ma.CIMSymbolHelper;b.Rect=na.default;b.getLimitCosine=
oa.getLimitCosine;g=b.brushes||(b.brushes={});g.Geometry=I.default;g.Marker=Q.default;g.Line=L.default;g.Fill=N.default;g.Text=O.default;g.Label=M.default;g.Clip=B.default;g.Stencil=H.default;g.Bitmap=z.default;g.Raster=C.default;g.TileInfo=D.default;g.VTLBackground=F.WGLBrushVTLBackground;g.VTLFill=G.WGLBrushVTLFill;g.VTLLine=J.WGLBrushVTLLine;g.VTLCircle=E.WGLBrushVTLCircle;g.VTLSymbol=K.WGLBrushVTLSymbol;b.RenderPass=pa.default;b.TiledDisplayObject=qa.TiledDisplayObject;b.BitmapTileContainer=ra.BitmapTileContainer;
b.LevelDependentSizeVariable=sa.LevelDependentSizeVariable})},"esri/views/2d/engine/Bitmap":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/libs/gl-matrix-2/mat3 ../../../core/libs/gl-matrix-2/mat3f32 ../../../core/libs/gl-matrix-2/vec2f32 ../../webgl ./DisplayObject ./ImageryBitmapSource".split(" "),function(g,b,l,k,f,a,q,m,d){function c(c){var e=document.createElement("canvas");e.width=c.width;e.height=c.height;c.render(e.getContext("2d"));return e}function e(c,
e,a){var d={target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071};e&&a&&(d.width=e,d.height=a);return new q.Texture(c,d)}function h(c){n.has(c)&&(p.splice(p.indexOf(c),1),n.delete(c))}Object.defineProperty(b,"__esModule",{value:!0});var p=[],n=new Set;g=function(n){function p(c,e){void 0===c&&(c=null);void 0===e&&(e=function(){return null});var a=n.call(this)||this;a.stencilRef=0;a.coordScale=[1,1];a._height=void 0;a.pixelRatio=1;a.resolution=0;a.rotation=0;a._source=null;
a._width=void 0;a.x=0;a.y=0;a.transforms={dvs:f.mat3f32.create()};a.source=c;a.requestRender=e;return a}l(p,n);Object.defineProperty(p.prototype,"isSourceScaled",{get:function(){return this.width!==this.sourceWidth||this.height!==this.sourceHeight},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"height",{get:function(){return void 0!==this._height?this._height:this.sourceHeight},set:function(c){this._height=c},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"source",
{get:function(){return this._source},set:function(c){this._source=c;this.invalidateTexture()},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"sourceHeight",{get:function(){return this._source instanceof HTMLImageElement?this._source.naturalHeight:this._source.height},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"sourceWidth",{get:function(){return this._source instanceof HTMLImageElement?this._source.naturalWidth:this._source.width},enumerable:!0,configurable:!0});
Object.defineProperty(p.prototype,"width",{get:function(){return void 0!==this._width?this._width:this.sourceWidth},set:function(c){this._width=c},enumerable:!0,configurable:!0});p.prototype.attach=function(){this.updateTexture();return!0};p.prototype.detach=function(){this._texture.dispose();this._texture=null;h(this)};p.prototype.invalidateTexture=function(){this.attached?this.updateTexture():h(this)};p.prototype.setTransform=function(c){var e=k.mat3.identity(this.transforms.dvs),d=c.toScreenNoRotation([0,
0],this.x,this.y),h=this.resolution/this.pixelRatio/c.resolution,n=h*this.width,h=h*this.height,p=Math.PI*this.rotation/180;k.mat3.translate(e,e,a.vec2f32.fromValues(d[0],d[1]));k.mat3.translate(e,e,a.vec2f32.fromValues(n/2,h/2));k.mat3.rotate(e,e,-p);k.mat3.translate(e,e,a.vec2f32.fromValues(-n/2,-h/2));k.mat3.scaleByVec2(e,e,a.vec2f32.fromValues(n,h));k.mat3.multiply(this.transforms.dvs,c.displayViewMat3,e)};p.prototype.updateTexture=function(){this._texture||(this._texture=this.source?e(this.stage.context,
this.sourceWidth,this.sourceHeight):e(this.stage.context));var a=this.source;a?(this._texture.resize(this.sourceWidth,this.sourceHeight),a&&"render"in a?a instanceof d.default?(a=a.getRenderedRasterPixels(),this._texture.setData(a.renderedRasterPixels)):this._texture.setData(c(a)):!a||"render"in a||this._texture.setData(a),this.ready(),this.requestRender()):this._texture.setData(null)};p.prototype.setSamplingProfile=function(c){this._texture&&(c.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),
this._texture.setSamplingMode(c.samplingMode))};p.prototype.bind=function(c){this._texture&&this.stage.context.bindTexture(this._texture,c)};return p}(m.DisplayObject);b.Bitmap=g})},"esri/views/2d/engine/DisplayObject":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","../../../core/Evented"],function(g,b,l,k){Object.defineProperty(b,"__esModule",{value:!0});g=function(b){function a(){var a=null!==b&&b.apply(this,arguments)||this;a._renderRequestedCalled=!1;a._attached=
!1;a._isReady=!1;a._opacity=1;a.renderRequested=!1;a._visible=!0;return a}l(a,b);Object.defineProperty(a.prototype,"attached",{get:function(){return this._attached},set:function(a){this._attached!==a&&((this._attached=a)?this.hasEventListener("attach")&&this.emit("attach"):this.hasEventListener("detach")&&this.emit("detach"))},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"isReady",{get:function(){return this._attached&&this._isReady},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"opacity",{get:function(){return this._opacity},set:function(a){this._opacity!==a&&(this._opacity=a,this.requestRender())},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"visible",{get:function(){return this._visible},set:function(a){this._visible!==a&&(this._visible=a,this.requestRender())},enumerable:!0,configurable:!0});a.prototype.attach=function(){this.ready();return!0};a.prototype.setTransform=function(a){};a.prototype.detach=function(){};a.prototype.processRender=function(a){this.visible&&
this.attached&&(this._renderRequestedCalled=!1,this.doRender(a),this._renderRequestedCalled||(this.renderRequested=!1),this.hasEventListener("post-render")&&this.emit("post-render"))};a.prototype.requestRender=function(){var a=this.renderRequested;this.renderRequested=this._renderRequestedCalled=!0;this.parent&&this.parent.requestRender();a!==this.renderRequested&&this.hasEventListener("will-render")&&this.emit("will-render")};a.prototype.dispose=function(){};a.prototype.doRender=function(a){};a.prototype.ready=
function(){this._isReady=!0;this.emit("isReady")};return a}(k);b.DisplayObject=g})},"esri/views/2d/engine/ImageryBitmapSource":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(b,f,a){this.pixelBlock=b;this.extent=f;this.originalPixelBlock=a}Object.defineProperty(b.prototype,"width",{get:function(){return this.pixelBlock?this.pixelBlock.width:0},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"height",{get:function(){return this.pixelBlock?
this.pixelBlock.height:0},enumerable:!0,configurable:!0});b.prototype.render=function(b){var f=this.pixelBlock;if(f){var a=this.filter({pixelBlock:f}),f=a.pixelBlock.getAsRGBA(),a=b.createImageData(a.pixelBlock.width,a.pixelBlock.height);a.data.set(f);b.putImageData(a,0,0)}};b.prototype.getRenderedRasterPixels=function(){var b=this.filter({pixelBlock:this.pixelBlock});return{width:b.pixelBlock.width,height:b.pixelBlock.height,renderedRasterPixels:new Uint8Array(b.pixelBlock.getAsRGBA().buffer)}};
return b}();b.default=g})},"esri/views/2d/engine/BitmapContainer":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../engine ./webgl/WGLContainer".split(" "),function(g,b,l,k,f,a){Object.defineProperty(b,"__esModule",{value:!0});g=function(a){function m(){return null!==a&&a.apply(this,arguments)||this}l(m,a);m.prototype.prepareRenderPasses=function(d){var c=this,e=d.registerRenderPass({name:"bitmap",brushes:[f.brushes.Bitmap],target:function(){return c.children}});
return a.prototype.prepareRenderPasses.call(this,d).concat([e])};return m}(a.default);b.BitmapContainer=g})},"esri/views/2d/engine/webgl/WGLContainer":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/assignHelper ../../../../core/maybe ../../engine ../Container ./ClippingInfo ./enums".split(" "),function(g,b,l,k,f,a,q,m,d){Object.defineProperty(b,"__esModule",{value:!0});g=function(c){function e(e){var a=c.call(this)||this;a.name=a.constructor.name;
a._lastTime=null;a.setClips(e);return a}l(e,c);e.prototype.setClips=function(c){var e=this;f.isSome(this._clippingInfos)&&(this._clippingInfos.forEach(function(c){return c.destroy()}),this._clippingInfos=null);f.isSome(c)&&c.length&&(this._clippingInfos=c.items.map(function(c){return m.default.fromClipArea(e,c)}));this.requestRender()};e.prototype.doRender=function(c){this.attachChildren();this.detachChildren();var e=this.createRenderParams(c),a=e.context,h=e.painter,m=e.globalOpacity,q=e.profiler,
m=e.drawPhase===d.WGLDrawPhase.LABEL?1:m*this.opacity;q.recordContainerStart(this.name);h.beforeRenderLayer(a,this._clippingInfos?255:0,m);this.updateTransforms(c.state);this.renderChildren(e);h.compositeLayer(a,m);q.recordContainerEnd()};e.prototype.renderChildren=function(c){f.isNone(this._renderPasses)&&(this._renderPasses=this.prepareRenderPasses(this.stage.painter));for(var e=0,a=this._renderPasses;e<a.length;e++)a[e].render(c)};e.prototype.createRenderParams=function(c){var e=Date.now(),a=(f.isSome(this._lastTime)?
e-this._lastTime:0)/1E3;this._lastTime=e;return k({},c,{context:this.stage.context,painter:this.stage.painter,profiler:this.stage.profiler,renderingOptions:this.stage.renderingOptions,driverTestResult:this.stage.driverTestResult,timeDelta:a,timeline:this.stage.timeline})};e.prototype.prepareRenderPasses=function(c){var e=this;return[c.registerRenderPass({name:"clip",brushes:[a.brushes.Clip],target:function(){return e._clippingInfos},drawPhase:d.WGLDrawPhase.MAP|d.WGLDrawPhase.LABEL|d.WGLDrawPhase.LABEL_ALPHA|
d.WGLDrawPhase.DEBUG})]};e.prototype.updateTransforms=function(c){for(var e=0,a=this.children;e<a.length;e++)a[e].setTransform(c)};return e}(q.Container);b.default=g})},"esri/views/2d/engine/Container":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","./DisplayObject"],function(g,b,l,k){Object.defineProperty(b,"__esModule",{value:!0});g=function(b){function a(){var a=null!==b&&b.apply(this,arguments)||this;a._childrenSet=new Set;a._childrenToAttach=[];a._childrenToDetach=
[];a.children=[];return a}l(a,b);Object.defineProperty(a.prototype,"numChildren",{get:function(){return this.children.length},enumerable:!0,configurable:!0});a.prototype.detach=function(){for(var a=0,m=this.children.concat(this._childrenToDetach);a<m.length;a++){var d=m[a];d.attached&&(this.detachChild(d),d.attached=!1,d.parent=null)}};a.prototype.doRender=function(a){var m=a.globalOpacity;a.globalOpacity*=this.opacity;this.attachChildren();this.detachChildren();this.renderChildren(a);a.globalOpacity=
m};a.prototype.addChild=function(a){return this.addChildAt(a,this.children.length)};a.prototype.addChildAt=function(a,m){void 0===m&&(m=this.numChildren);if(!a||this.contains(a))return a;var d=a.parent;d&&d!==this&&d.removeChild(a);m>=this.numChildren?this.children.push(a):this.children.splice(m,0,a);this._childrenSet.add(a);m=this._childrenToDetach.indexOf(a);-1<m&&this._childrenToDetach.splice(m,1);this._childrenToAttach.push(a);this.requestRender();return a};a.prototype.contains=function(a){return this._childrenSet.has(a)};
a.prototype.getChildIndex=function(a){return this.children.indexOf(a)};a.prototype.getChildAt=function(a){return 0>a||a>this.children.length?null:this.children[a]};a.prototype.removeAllChildren=function(){for(var a=this.numChildren;a--;)this.removeChildAt(0)};a.prototype.removeChild=function(a){return this.contains(a)?this.removeChildAt(this.getChildIndex(a)):a};a.prototype.removeChildAt=function(a){if(0>a||a>=this.children.length)return null;a=this.children.splice(a,1)[0];this._childrenSet["delete"](a);
if(a.attached)this._childrenToDetach.push(a);else{var m=this._childrenToAttach.indexOf(a);-1<m&&this._childrenToAttach.splice(m,1)}return a};a.prototype.setChildIndex=function(a,m){var d=this.getChildIndex(a);-1<d&&(this.children.splice(d,1),this.children.splice(m,0,a))};a.prototype.sortChildren=function(a){return this.children.sort(a)};a.prototype.attachChildren=function(){var a=this._childrenToAttach;if(0!==a.length)for(var m=0,d=!1;!d;)d=a[m],d.parent=this,d.stage=this.stage,this.attachChild(d)?
(d.attached=!0,a.splice(m,1)):++m,d=a.length===m};a.prototype.detachChildren=function(){for(var a=this._childrenToDetach;0<a.length;){var m=a.shift();this.detachChild(m);m.attached=!1;m.parent=null;m.stage=null}};a.prototype.renderChildren=function(a){for(var m=this.children,d=m.length,c=0;c<d;c++)m[c].processRender(a)};a.prototype.attachChild=function(a){return a.attach()};a.prototype.detachChild=function(a){a.detach()};return a}(k.DisplayObject);b.Container=g})},"esri/views/2d/engine/webgl/ClippingInfo":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../DisplayObject ./Mesh2D ../../../webgl/VertexArrayObject".split(" "),
function(g,b,l,k,f,a,q,m,d){Object.defineProperty(b,"__esModule",{value:!0});var c=f.getLogger("esri.views.2d.engine.webgl.ClippingInfo");g=function(e){function h(c,a){var d=e.call(this)||this;d._cache={};d.parent=c;d._handle=a.watch("version",function(){return d._invalidate()});d._clip=a;d.attach();d.attached=!0;return d}l(h,e);h.fromClipArea=function(c,e){return new h(c,e)};h.prototype._destroyGL=function(){a.isSome(this._cache.mesh)&&(this._cache.mesh.destroy(),this._cache.mesh=null);a.isSome(this._cache.vao)&&
(this._cache.vao.dispose(),this._cache.vao=null)};h.prototype.destroy=function(){this._destroyGL();this._handle.remove()};h.prototype.doRender=function(){};h.prototype.getVAO=function(c,e,h,m){var n=e.size,p=n[0],n=n[1];if("geometry"===this._clip.type||this._lastWidth!==p||this._lastHeight!==n)this._lastWidth=p,this._lastHeight=n,this._destroyGL();a.isNone(this._cache.vao)&&(e=this._createMesh(e,this._clip),p=e.getIndexBuffer(c),n=e.getVertexBuffers(c),this._cache.mesh=e,this._cache.vao=new d(c,h,
m,n,p));return this._cache.vao};h.prototype._invalidate=function(){this._destroyGL();this.requestRender()};h.prototype._createScreenRect=function(c,e){var a=c.size;c=a[0];var a=a[1],d="string"===typeof e.left?parseFloat(e.left)/100*c:e.left,h="string"===typeof e.right?parseFloat(e.right)/100*c:e.right,n="string"===typeof e.top?parseFloat(e.top)/100*a:e.top;e="string"===typeof e.bottom?parseFloat(e.bottom)/100*a:e.bottom;return{x:d,y:n,width:Math.max(c-h-d,0),height:Math.max(a-e-n,0)}};h.prototype._createMesh=
function(e,a){switch(a.type){case "rect":return m.default.fromRect(this._createScreenRect(e,a));case "path":return m.default.fromPath(a);case "geometry":return m.default.fromGeometry(e,a);default:return c.error(new k("mapview-bad-type","Unable to create ClippingInfo mesh from clip of type: ${clip.type}")),m.default.fromRect({x:0,y:0,width:1,height:1})}};return h}(q.DisplayObject);b.default=g})},"esri/views/2d/engine/webgl/Mesh2D":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/libs/earcut/earcut ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f64 ../../../../layers/graphics/featureConversionUtils ../../../../layers/graphics/OptimizedGeometry ./number ../../../webgl/BufferObject".split(" "),
function(g,b,l,k,f,a,q,m,d,c,e,h,p){Object.defineProperty(b,"__esModule",{value:!0});var n=f.getLogger("esri.views.2d.engine.webgl.Mesh2D"),u=function(c,e){var a=c.coords;c=c.lengths;for(var d=[],h=0,n=0;h<c.length;n+=c[h],h+=1){for(var p=n,m=[];h<c.length-1;h+=1,n+=c[h]){for(var b=n+c[h],x=0,u=1;u<c[h+1];u++)x+=(a[2*(b+u)]-a[2*(b+u-1)])*(a[2*(b+u)+1]+a[2*(b+u-1)+1]);if(!(e?0<x:0>x))break;m.push(n+c[h]-p)}x=a.slice(2*p,2*(n+c[h]));b=0;for(m=q.earcut(x,m,2);b<m.length;b++)d.push(m[b]+p)}return d};
g=function(){function b(c,e,a,d){void 0===d&&(d=!1);this._cache={};this.vertices=c;this.indices=e;this.primitiveType=a;this.isMapSpace=d}b.fromRect=function(c){var e=c.x,a=c.y;return b.fromScreenExtent({xmin:e,ymin:a,xmax:e+c.width,ymax:a+c.height})};b.fromPath=function(a){var d=c.convertFromNestedArray(new e.default,a.path,!1,!1);a=d.coords;for(var d=new Uint32Array(u(d,!0)),n=new Uint32Array(a.length/2),p=0;p<n.length;p++)n[p]=h.i1616to32(Math.floor(a[2*p]),Math.floor(a[2*p+1]));return new b({geometry:n},
d,4)};b.fromGeometry=function(c,e){var a=e.geometry.type;switch(a){case "polygon":return b.fromPolygon(c,e.geometry);case "extent":return b.fromMapExtent(c,e.geometry);default:return n.error(new k("mapview-bad-type","Unable to create a mesh from type "+a,e)),b.fromRect({x:0,y:0,width:1,height:1})}};b.fromPolygon=function(a,n){var p=c.convertFromPolygon(new e.default,n,!1,!1);n=p.coords;for(var p=new Uint32Array(u(p,!1)),t=new Uint32Array(n.length/2),x=d.vec2f64.create(),q=d.vec2f64.create(),f=0;f<
t.length;f++)m.vec2.set(x,n[2*f],n[2*f+1]),a.toScreen(q,x),t[f]=h.i1616to32(Math.floor(q[0]),Math.floor(q[1]));return new b({geometry:t},p,4,!0)};b.fromScreenExtent=function(c){var e=c.xmin,a=c.xmax,d=c.ymin;c=c.ymax;e={geometry:new Uint32Array([h.i1616to32(e,d),h.i1616to32(a,d),h.i1616to32(e,c),h.i1616to32(e,c),h.i1616to32(a,d),h.i1616to32(a,c)])};a=new Uint32Array([0,1,2,3,4,5]);return new b(e,a,4)};b.fromMapExtent=function(c,e){var a=c.toScreen([0,0],[e.xmin,e.ymin]),d=a[0],a=a[1];e=c.toScreen([0,
0],[e.xmax,e.ymax]);c=e[0];e=e[1];d={geometry:new Uint32Array([h.i1616to32(d,a),h.i1616to32(c,a),h.i1616to32(d,e),h.i1616to32(d,e),h.i1616to32(c,a),h.i1616to32(c,e)])};a=new Uint32Array([0,1,2,3,4,5]);return new b(d,a,4)};b.prototype.destroy=function(){a.isSome(this._cache.indexBuffer)&&this._cache.indexBuffer.dispose();for(var c in this._cache.vertexBuffers)a.isSome(this._cache.vertexBuffers[c])&&this._cache.vertexBuffers[c].dispose()};Object.defineProperty(b.prototype,"elementType",{get:function(){var c;
a:switch(this.indices.BYTES_PER_ELEMENT){case 1:c=5121;break a;case 2:c=5123;break a;case 4:c=5125;break a;default:throw new k("Cannot get DataType of array");}return c},enumerable:!0,configurable:!0});b.prototype.getIndexBuffer=function(c,e){void 0===e&&(e=35044);this._cache.indexBuffer||(this._cache.indexBuffer=p.createIndex(c,e,this.indices));return this._cache.indexBuffer};b.prototype.getVertexBuffers=function(c,e){var a=this;void 0===e&&(e=35044);this._cache.vertexBuffers||(this._cache.vertexBuffers=
Object.keys(this.vertices).reduce(function(d,h){var n;return l({},d,(n={},n[h]=p.createVertex(c,e,a.vertices[h]),n))},{}));return this._cache.vertexBuffers};return b}();b.default=g})},"esri/core/libs/earcut/earcut":function(){define(["require","exports"],function(g,b){function l(c,e,a,d,h){var p;if(h===0<n(c,e,a,d))for(h=e;h<a;h+=d)p=q(h,c[h],c[h+1],p);else for(h=a-d;h>=e;h-=d)p=q(h,c[h],c[h+1],p);p&&t(p,p.next)&&(m(p),p=p.next);return p}function k(c,e){void 0===e&&(e=c);if(!c)return c;var a;do if(a=
!1,c.steiner||!t(c,c.next)&&0!==h(c.prev,c,c.next))c=c.next;else{m(c);c=e=c.prev;if(c===c.next)break;a=!0}while(a||c!==e);return e}function f(c,d,n,b,q,v,w){void 0===w&&(w=0);if(c){!w&&v&&(c=e(c,b,q,v));for(var A=c;c.prev!==c.next;){var l=c.prev,g=c.next,y;if(v)y=a(c,b,q,v);else a:{y=c;var C=y.prev,z=y,B=y.next;if(0<=h(C,z,B))y=!1;else{for(var D=y.next.next,H=D,F=0;D!==y.prev&&(0===F||D!==H);){F++;if(u(C.x,C.y,z.x,z.y,B.x,B.y,D.x,D.y)&&0<=h(D.prev,D,D.next)){y=!1;break a}D=D.next}y=!0}}if(y)d.push(l.index/
n),d.push(c.index/n),d.push(g.index/n),m(c),A=c=g.next;else if(c=g,c===A){if(!w)f(k(c),d,n,b,q,v,1);else if(1===w){w=d;A=n;l=c;do g=l.prev,y=l.next.next,!t(g,y)&&p(g,l,l.next,y)&&x(g,y)&&x(y,g)&&(w.push(g.index/A),w.push(l.index/A),w.push(y.index/A),m(l),m(l.next),l=c=y),l=l.next;while(l!==c);c=l;f(c,d,n,b,q,v,2)}else if(2===w)a:{w=c;do{for(A=w.next.next;A!==w.prev;){if(l=w.index!==A.index){l=w;g=A;y=void 0;if(y=l.next.index!==g.index&&l.prev.index!==g.index){y=void 0;b:{y=l;do{if(y.index!==l.index&&
y.next.index!==l.index&&y.index!==g.index&&y.next.index!==g.index&&p(y,y.next,l,g)){y=!0;break b}y=y.next}while(y!==l);y=!1}y=!y}C=void 0;if(C=y&&x(l,g)&&x(g,l)){y=l;C=!1;z=(l.x+g.x)/2;g=(l.y+g.y)/2;do y.y>g!==y.next.y>g&&y.next.y!==y.y&&z<(y.next.x-y.x)*(g-y.y)/(y.next.y-y.y)+y.x&&(C=!C),y=y.next;while(y!==l)}l=C}if(l){c=r(w,A);w=k(w,w.next);c=k(c,c.next);f(w,d,n,b,q,v);f(c,d,n,b,q,v);break a}A=A.next}w=w.next}while(w!==c)}break}}}}function a(c,e,a,d){var n=c.prev,p=c.next;if(0<=h(n,c,p))return!1;
var m=n.x>c.x?n.x>p.x?n.x:p.x:c.x>p.x?c.x:p.x,b=n.y>c.y?n.y>p.y?n.y:p.y:c.y>p.y?c.y:p.y,x=v(n.x<c.x?n.x<p.x?n.x:p.x:c.x<p.x?c.x:p.x,n.y<c.y?n.y<p.y?n.y:p.y:c.y<p.y?c.y:p.y,e,a,d);e=v(m,b,e,a,d);a=c.prevZ;for(d=c.nextZ;a&&a.z>=x&&d&&d.z<=e;){if(a!==c.prev&&a!==c.next&&u(n.x,n.y,c.x,c.y,p.x,p.y,a.x,a.y)&&0<=h(a.prev,a,a.next))return!1;a=a.prevZ;if(d!==c.prev&&d!==c.next&&u(n.x,n.y,c.x,c.y,p.x,p.y,d.x,d.y)&&0<=h(d.prev,d,d.next))return!1;d=d.nextZ}for(;a&&a.z>=x;){if(a!==c.prev&&a!==c.next&&u(n.x,n.y,
c.x,c.y,p.x,p.y,a.x,a.y)&&0<=h(a.prev,a,a.next))return!1;a=a.prevZ}for(;d&&d.z<=e;){if(d!==c.prev&&d!==c.next&&u(n.x,n.y,c.x,c.y,p.x,p.y,d.x,d.y)&&0<=h(d.prev,d,d.next))return!1;d=d.nextZ}return!0}function q(c,e,a,d){c=new y(c,e,a);d?(c.next=d.next,c.prev=d,d.next.prev=c,d.next=c):(c.prev=c,c.next=c);return c}function m(c){c.next.prev=c.prev;c.prev.next=c.next;c.prevZ&&(c.prevZ.nextZ=c.nextZ);c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function d(c){var e=c,a=c;do{if(e.x<a.x||e.x===a.x&&e.y<a.y)a=e;e=e.next}while(e!==
c);return a}function c(c,e){var a=e,d=c.x,h=c.y,n=-Infinity,p;do{if(h<=a.y&&h>=a.next.y&&a.next.y!==a.y){var m=a.x+(h-a.y)*(a.next.x-a.x)/(a.next.y-a.y);if(m<=d&&m>n){n=m;if(m===d){if(h===a.y)return a;if(h===a.next.y)return a.next}p=a.x<a.next.x?a:a.next}}a=a.next}while(a!==e);if(!p)return null;if(d===n)return p.prev;e=p;for(var m=p.x,b=p.y,q=Infinity,t,a=p.next;a!==e;)d>=a.x&&a.x>=m&&d!==a.x&&u(h<b?d:n,h,m,b,h<b?n:d,h,a.x,a.y)&&(t=Math.abs(h-a.y)/(d-a.x),(t<q||t===q&&a.x>p.x)&&x(a,c)&&(p=a,q=t)),
a=a.next;return p}function e(c,a,d,h){for(var n=void 0;n!==c;n=n.next){n=n||c;null===n.z&&(n.z=v(n.x,n.y,a,d,h));if(n.prev.next!==n||n.next.prev!==n)return n.prev.next=n,n.next.prev=n,e(c,a,d,h);n.prevZ=n.prev;n.nextZ=n.next}c.prevZ.nextZ=null;c.prevZ=null;a:for(d=1;;){h=c;n=void 0;a=c=null;for(var p=0;h;){p++;for(var n=h,m=0;m<d&&n;m++)n=n.nextZ;for(var b=d;0<m||0<b&&n;){var x=void 0;0===m?(x=n,n=n.nextZ,b--):0!==b&&n?h.z<=n.z?(x=h,h=h.nextZ,m--):(x=n,n=n.nextZ,b--):(x=h,h=h.nextZ,m--);a?a.nextZ=
x:c=x;x.prevZ=a;a=x}h=n}a.nextZ=null;d*=2;if(2>p)break a}return c}function h(c,a,e){return(a.y-c.y)*(e.x-a.x)-(a.x-c.x)*(e.y-a.y)}function p(c,a,e,d){return t(c,a)&&t(e,d)||t(c,d)&&t(e,a)?!0:0<h(c,a,e)!==0<h(c,a,d)&&0<h(e,d,c)!==0<h(e,d,a)}function n(c,a,e,d){for(var h=0,n=e-d;a<e;a+=d)h+=(c[n]-c[a])*(c[a+1]+c[n+1]),n=a;return h}function u(c,a,e,d,h,n,p,m){return 0<=(h-p)*(a-m)-(c-p)*(n-m)&&0<=(c-p)*(d-m)-(e-p)*(a-m)&&0<=(e-p)*(n-m)-(h-p)*(d-m)}function x(c,a){return 0>h(c.prev,c,c.next)?0<=h(c,a,
c.next)&&0<=h(c,c.prev,a):0>h(c,a,c.prev)||0>h(c,c.next,a)}function v(c,a,e,d,h){c=32767*(c-e)*h;a=32767*(a-d)*h;c=(c|c<<8)&16711935;c=(c|c<<4)&252645135;c=(c|c<<2)&858993459;a=(a|a<<8)&16711935;a=(a|a<<4)&252645135;a=(a|a<<2)&858993459;return(c|c<<1)&1431655765|((a|a<<1)&1431655765)<<1}function t(c,a){return c.x===a.x&&c.y===a.y}function w(c,a){return c.x-a.x}function r(c,a){var e=new y(c.index,c.x,c.y),d=new y(a.index,a.x,a.y),h=c.next,n=a.prev;c.next=a;a.prev=c;e.next=h;h.prev=e;d.next=e;e.prev=
d;n.next=d;d.prev=n;return d}Object.defineProperty(b,"__esModule",{value:!0});b.earcut=function(a,e,h){var n=e&&e.length,p=n?e[0]*h:a.length,m=l(a,0,p,h,!0),b=[];if(!m||m.next===m.prev)return b;var x,u,q;if(n){for(var n=[],t=0,v=e.length;t<v;t++){var A=l(a,e[t]*h,t<v-1?e[t+1]*h:a.length,h,!1);A===A.next&&(A.steiner=!0);n.push(d(A))}n.sort(w);for(e=0;e<n.length;e++){t=n[e];v=m;if(v=c(t,v))t=r(v,t),k(t,t.next);m=k(m,m.next)}}if(a.length>80*h){x=q=a[0];u=n=a[1];for(e=h;e<p;e+=h)t=a[e],v=a[e+1],x=Math.min(x,
t),u=Math.min(u,v),q=Math.max(q,t),n=Math.max(n,v);q=Math.max(q-x,n-u);q=0!==q?1/q:0}f(m,b,h,x,u,q);return b};b.deviation=function(c,a,e,d){var h=a&&a.length,p=Math.abs(n(c,0,h?a[0]*e:c.length,e));if(h)for(var h=0,m=a.length;h<m;h++)p-=Math.abs(n(c,a[h]*e,h<m-1?a[h+1]*e:c.length,e));for(h=a=0;h<d.length;h+=3){var m=d[h]*e,b=d[h+1]*e,x=d[h+2]*e;a+=Math.abs((c[m]-c[x])*(c[b+1]-c[m+1])-(c[m]-c[b])*(c[x+1]-c[m+1]))}return 0===p&&0===a?0:Math.abs((a-p)/p)};var y=function(){return function(c,a,e){this.index=
c;this.x=a;this.y=e;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}}()})},"esri/views/2d/engine/webgl/number":function(){define(["require","exports"],function(g,b){function l(a,b,m){return Math.round(Math.max(Math.min(a,m),b))}Object.defineProperty(b,"__esModule",{value:!0});var k=new Float32Array(1),f=new Uint32Array(k.buffer);b.i8=function(a){return l(a,-128,127)};b.i16=function(a){return l(a,-32768,32767)};b.i32=function(a){return l(a,-2147483648,2147483647)};b.u8=function(a){return l(a,
0,255)};b.u16=function(a){return l(a,0,65535)};b.u32=function(a){return l(a,0,4294967295)};b.toUint32=function(a){k[0]=a;return f[0]};b.toFloat32=function(a){f[0]=a;return k[0]};b.u32to4Xu8=function(a){return[a&255,(a&65280)>>>8,(a&16711680)>>>16,(a&4278190080)>>>24]};b.i1616to32=function(a,b){return 65535&a|b<<16};b.i8888to32=function(a,b,m,d){return a&255|(b&255)<<8|(m&255)<<16|d<<24};b.i8816to32=function(a,b,m){return a&255|(b&255)<<8|m<<16};b.numTo32=function(a){return a|0}})},"esri/views/2d/engine/webgl/enums":function(){define(["require",
"exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});(function(b){b[b.FILL=0]="FILL";b[b.LINE=1]="LINE";b[b.MARKER=2]="MARKER";b[b.TEXT=3]="TEXT";b[b.LABEL=4]="LABEL"})(b.WGLGeometryType||(b.WGLGeometryType={}));(function(b){b[b.SUCCEEDED=0]="SUCCEEDED";b[b.FAILED_OUT_OF_MEMORY=1]="FAILED_OUT_OF_MEMORY"})(b.WGLGeometryTransactionStatus||(b.WGLGeometryTransactionStatus={}));(function(b){b[b.NONE=0]="NONE";b[b.MAP=1]="MAP";b[b.LABEL=2]="LABEL";b[b.LABEL_ALPHA=4]="LABEL_ALPHA";b[b.HITTEST=
8]="HITTEST";b[b.HIGHLIGHT=16]="HIGHLIGHT";b[b.CLIP=32]="CLIP";b[b.DEBUG=64]="DEBUG";b[b.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"})(b.WGLDrawPhase||(b.WGLDrawPhase={}));(function(b){b[b.SIZE=0]="SIZE";b[b.COLOR=1]="COLOR";b[b.OPACITY=2]="OPACITY";b[b.ROTATION=3]="ROTATION"})(b.VVType||(b.VVType={}));(function(b){b[b.NONE=0]="NONE";b[b.OPACITY=1]="OPACITY";b[b.COLOR=2]="COLOR";b[b.ROTATION=4]="ROTATION";b[b.SIZE_MINMAX_VALUE=8]="SIZE_MINMAX_VALUE";b[b.SIZE_SCALE_STOPS=16]="SIZE_SCALE_STOPS";b[b.SIZE_FIELD_STOPS=
32]="SIZE_FIELD_STOPS";b[b.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"})(b.WGLVVFlag||(b.WGLVVFlag={}));(function(b){b[b.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE";b[b.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE";b[b.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE";b[b.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"})(b.WGLVVTarget||(b.WGLVVTarget={}));(function(b){b[b.SPRITE=0]="SPRITE";b[b.GLYPH=1]="GLYPH"})(b.MosaicType||(b.MosaicType={}))})},"esri/views/2d/engine/BitmapTile":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ./Bitmap ./webgl/TiledDisplayObject".split(" "),
function(g,b,l,k,f,a){Object.defineProperty(b,"__esModule",{value:!0});g=function(a){function m(d,c,e,h){void 0===h&&(h=null);var p=a.call(this,d,c,e,e)||this;d=p.requestRender.bind(p);p.bitmap=new f.Bitmap(h,d);p.bitmap.coordScale=e;p.bitmap.once("isReady",function(){return p.ready()});return p}l(m,a);Object.defineProperty(m.prototype,"stencilRef",{get:function(){return this.bitmap.stencilRef},set:function(a){this.bitmap.stencilRef=a},enumerable:!0,configurable:!0});m.prototype.setTransform=function(d,
c){a.prototype.setTransform.call(this,d,c);this.bitmap.transforms.dvs=this.transforms.dvs};m.prototype.attach=function(){this.bitmap.stage=this.stage;var a=this.bitmap.attach();a&&(this.bitmap.attached=!0);return a};m.prototype.detach=function(){this.bitmap.detach()};return m}(a.TiledDisplayObject);b.BitmapTile=g})},"esri/views/2d/engine/webgl/TiledDisplayObject":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/has ../../../../core/libs/gl-matrix-2/mat3 ../../../../core/libs/gl-matrix-2/mat3f32 ../DisplayObject ../../tiling/TileKey".split(" "),
function(g,b,l,k,f,a,q,m){Object.defineProperty(b,"__esModule",{value:!0});g=function(d){function c(c,h,p,n){void 0===n&&(n=p);var e=d.call(this)||this;e.transforms={dvs:a.mat3f32.create(),tileMat3:a.mat3f32.create()};e.triangleCount=0;e.key=m.pool.acquire(c);e.bounds=h;e.size=p;e.coordRange=n;return e}l(c,d);c.prototype.destroy=function(){m.pool.release(this.key);this.key=null;this.texture&&(this.texture.dispose(),this.texture=null)};Object.defineProperty(c.prototype,"coords",{get:function(){return this._coords},
enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"bounds",{get:function(){return this._bounds},set:function(c){this._coords=[c[0],c[3]];this._bounds=c},enumerable:!0,configurable:!0});c.prototype.setTransform=function(c,a){a/=c.resolution*c.pixelRatio;var e=this.transforms.tileMat3,d=c.toScreenNoRotation([0,0],this.coords);f.mat3.set(e,this.size[0]/this.coordRange[0]*a,0,0,0,this.size[1]/this.coordRange[1]*a,0,d[0],d[1],1);f.mat3.multiply(this.transforms.dvs,c.displayViewMat3,e)};
return c}(q.DisplayObject);b.TiledDisplayObject=g})},"esri/views/2d/engine/webgl/TileContainer":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/assignHelper ./enums ./WGLContainer ./brushes/WGLBrushInfo ./brushes/WGLBrushStencil".split(" "),function(g,b,l,k,f,a,q,m){Object.defineProperty(b,"__esModule",{value:!0});b.sortByLevel=function(a,c){return 0!==a.key.level-c.key.level?a.key.level-c.key.level:0!==a.key.row-c.key.row?a.key.row-c.key.row:
a.key.col-c.key.col};g=function(a){function c(c,d){d=a.call(this,d)||this;d._tileInfoView=c;return d}l(c,a);c.prototype.renderChildren=function(c){this.sortChildren(b.sortByLevel);this.setStencilReference();a.prototype.renderChildren.call(this,c)};c.prototype.createRenderParams=function(c){var e=c.state;return k({},a.prototype.createRenderParams.call(this,c),{requiredLevel:this._tileInfoView.getClosestInfoForScale(e.scale).level,displayLevel:this._tileInfoView.tileInfo.scaleToZoom(e.scale)})};c.prototype.prepareRenderPasses=
function(c){var e=this,d=c.registerRenderPass({name:"stencil",brushes:[m.default],drawPhase:f.WGLDrawPhase.DEBUG|f.WGLDrawPhase.MAP,target:function(){return e.children}}),n=c.registerRenderPass({name:"tileInfo",brushes:[q.default],drawPhase:f.WGLDrawPhase.DEBUG,target:function(){return e.children},has:"esri-tiles-debug"});return a.prototype.prepareRenderPasses.call(this,c).concat([d,n])};c.prototype.updateTransforms=function(c){for(var a=0,e=this.children;a<e.length;a++){var d=e[a],m=this._tileInfoView.getTileResolution(d.key);
d.setTransform(c,m)}};c.prototype.setStencilReference=function(){for(var c=1,a=0,d=this.children;a<d.length;a++)d[a].stencilRef=c++};return c}(a.default);b.default=g})},"esri/views/2d/engine/webgl/brushes/WGLBrushInfo":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ./WGLBrush ../shaders/BackgroundPrograms ../shaders/TileInfoPrograms".split(" "),function(g,b,l,k,f,a,q,m){Object.defineProperty(b,"__esModule",
{value:!0});g=function(a){function c(){var c=null!==a&&a.apply(this,arguments)||this;c._color=k.vec4f32.fromValues(1,0,0,1);return c}l(c,a);c.prototype.dispose=function(){this._outlineProgram&&(this._outlineProgram.dispose(),this._outlineProgram=null);this._tileInfoProgram&&(this._tileInfoProgram.dispose(),this._tileInfoProgram=null);this._outlineVertexArrayObject&&(this._outlineVertexArrayObject.dispose(),this._outlineVertexArrayObject=null);this._tileInfoVertexArrayObject&&(this._tileInfoVertexArrayObject.dispose(),
this._tileInfoVertexArrayObject=null);this._canvas=null};c.prototype.prepareState=function(c){c=c.context;c.setBlendingEnabled(!0);c.setBlendFunctionSeparate(1,771,1,771);c.setColorMask(!0,!0,!0,!0);c.setStencilWriteMask(0);c.setStencilTestEnabled(!1)};c.prototype.draw=function(c,a){c=c.context;if(a.isReady){this._loadWGLResources(c);c.bindVAO(this._outlineVertexArrayObject);c.bindProgram(this._outlineProgram);this._outlineProgram.setUniformMatrix3fv("u_dvsMat3",a.transforms.dvs);this._outlineProgram.setUniform2f("u_coord_range",
a.coordRange[0],a.coordRange[1]);this._outlineProgram.setUniform1f("u_depth",0);this._outlineProgram.setUniform4fv("u_color",this._color);c.drawArrays(3,0,4);c.bindVAO();var e=this._getTexture(c,a);e&&(c.bindVAO(this._tileInfoVertexArrayObject),c.bindProgram(this._tileInfoProgram),c.bindTexture(e,0),this._tileInfoProgram.setUniformMatrix3fv("u_dvsMat3",a.transforms.dvs),this._tileInfoProgram.setUniform1f("u_depth",0),this._tileInfoProgram.setUniform2f("u_coord_ratio",a.coordRange[0]/a.size[0],a.coordRange[1]/
a.size[1]),this._tileInfoProgram.setUniform2f("u_delta",8,8),this._tileInfoProgram.setUniform2f("u_dimensions",e.descriptor.width,e.descriptor.height),c.drawArrays(5,0,4),c.bindVAO())}};c.prototype._loadWGLResources=function(c){if(!this._outlineProgram||!this._tileInfoProgram){var a=f.createProgram(c,q.background),e=f.createProgram(c,m.tileInfo),d={geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},b=new Int8Array([0,0,1,0,1,1,0,1]),b=f.BufferObject.createVertex(c,
35044,b),b=new f.VertexArrayObject(c,q.background.attributes,d,{geometry:b}),x=new Int8Array([0,0,1,0,0,1,1,1]),x=f.BufferObject.createVertex(c,35044,x);c=new f.VertexArrayObject(c,m.tileInfo.attributes,d,{geometry:x});this._outlineProgram=a;this._tileInfoProgram=e;this._outlineVertexArrayObject=b;this._tileInfoVertexArrayObject=c}};c.prototype._getTexture=function(c,a){if(a.texture)return a.texture;this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("id","canvas2d"),
this._canvas.setAttribute("width","300"),this._canvas.setAttribute("height","32"),this._canvas.setAttribute("style","display:none"));var e=a.triangleCount,d=a.key.id;0<a.triangleCount&&(d+=", "+e);var h=this._canvas,m=h.getContext("2d");m.font="24px sans-serif";m.textAlign="left";m.textBaseline="top";m.clearRect(0,0,300,32);1E5<e?(m.fillStyle="red",m.fillRect(0,0,300,32),m.fillStyle="black"):(m.clearRect(0,0,300,32),m.fillStyle="blue");m.fillText(d,0,0);a.texture=new f.Texture(c,{target:3553,pixelFormat:6408,
dataType:5121,samplingMode:9728,wrapMode:33071},h);return a.texture};return c}(a.default);b.default=g})},"esri/views/2d/engine/webgl/brushes/WGLBrush":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(){this.name=this.constructor.name||"UnnamedBrush"}b.prototype.prepareState=function(b,f,a){};b.prototype.draw=function(b,f,a){};b.prototype.drawMany=function(b,f,a){for(var q=0;q<f.length;q++)this.draw(b,f[q],a)};return b}();
b.default=g})},"esri/views/2d/engine/webgl/shaders/BackgroundPrograms":function(){define(["require","exports","./sources/resolver"],function(g,b,l){Object.defineProperty(b,"__esModule",{value:!0});b.background={name:"background",shaders:{vertexShader:l.resolveIncludes("background/background.vert"),fragmentShader:l.resolveIncludes("background/background.frag")},attributes:{a_pos:0}}})},"esri/views/2d/engine/webgl/shaders/sources/resolver":function(){define(["require","exports","../../../../../webgl",
"./shaderRepository"],function(g,b,l,k){Object.defineProperty(b,"__esModule",{value:!0});var f=new l.ShaderCompiler(function(a){var b=k;a.split("/").forEach(function(a){b&&(b=b[a])});return b});b.resolveIncludes=function(a){return f.resolveIncludes(a)}})},"esri/views/2d/engine/webgl/shaders/sources/shaderRepository":function(){define(["require","exports"],function(g,b){return{background:{"background.frag":"uniform lowp vec4 u_color;\nvoid main() {\n  gl_FragColor \x3d u_color;\n}","background.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump vec2 u_coord_range;\nuniform mediump float u_depth;\nvoid main() {\n  vec3 v_pos \x3d u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0);\n  gl_Position \x3d vec4(v_pos.xy, 0.0, 1.0);\n}"},
bitBlit:{"bitBlit.frag":"uniform lowp sampler2D u_tex;\nuniform lowp float u_opacity;\nvarying mediump vec2 v_uv;\nvoid main() {\n  lowp vec4 color \x3d texture2D(u_tex, v_uv);\n  gl_FragColor \x3d color *  u_opacity;\n}","bitBlit.vert":"attribute vec2 a_pos;\nattribute vec2 a_tex;\nvarying mediump vec2 v_uv;\nvoid main(void) {\n  gl_Position \x3d vec4(a_pos, 0.0, 1.0);\n  v_uv \x3d a_tex;\n}"},filtering:{"bicubic.glsl":"vec4 computeWeights(float v) {\n  float b \x3d 1.0 / 6.0;\n  float v2 \x3d v * v;\n  float v3 \x3d v2 * v;\n  float w0 \x3d b * (-v3 + 3.0 * v2 - 3.0 * v + 1.0);\n  float w1 \x3d b * (3.0 * v3  - 6.0 * v2 + 4.0);\n  float w2 \x3d b * (-3.0 * v3 + 3.0 * v2 + 3.0 * v + 1.0);\n  float w3 \x3d b * v3;\n  return vec4(w0, w1, w2, w3);\n}\nvec4 bicubicOffsetsAndWeights(float v) {\n  vec4 w \x3d computeWeights(v);\n  float g0 \x3d w.x + w.y;\n  float g1 \x3d w.z + w.w;\n  float h0 \x3d 1.0 - (w.y / g0) + v;\n  float h1 \x3d 1.0 + (w.w / g1) - v;\n  return vec4(h0, h1, g0, g1);\n}\nvec4 sampleBicubicBSpline(sampler2D sampler, vec2 coords, vec2 texSize) {\n  vec2 eX \x3d vec2(1.0 / texSize.x, 0.0);\n  vec2 eY \x3d vec2(0.0, 1.0 / texSize.y);\n  vec2 texel \x3d coords * texSize - 0.5;\n  vec3 hgX \x3d bicubicOffsetsAndWeights(fract(texel).x).xyz;\n  vec3 hgY \x3d bicubicOffsetsAndWeights(fract(texel).y).xyz;\n  vec2 coords10 \x3d coords + hgX.x * eX;\n  vec2 coords00 \x3d coords - hgX.y * eX;\n  vec2 coords11 \x3d coords10 + hgY.x * eY;\n  vec2 coords01 \x3d coords00 + hgY.x * eY;\n  coords10 \x3d coords10 - hgY.y * eY;\n  coords00 \x3d coords00 - hgY.y * eY;\n  vec4 color00 \x3d texture2D(sampler, coords00);\n  vec4 color10 \x3d texture2D(sampler, coords10);\n  vec4 color01 \x3d texture2D(sampler, coords01);\n  vec4 color11 \x3d texture2D(sampler, coords11);\n  color00 \x3d mix(color00, color01, hgY.z);\n  color10 \x3d mix(color10, color11, hgY.z);\n  color00 \x3d mix(color00, color10, hgX.z);\n  return color00;\n}",
"bilinear.glsl":"vec4 sampleBilinear(sampler2D sampler, vec2 coords, vec2 texSize) {\n  vec2 texelStart \x3d floor(coords * texSize);\n  vec2 coord0 \x3d texelStart / texSize;\n  vec2 coord1 \x3d (texelStart +  vec2(1.0, 0.0)) / texSize;\n  vec2 coord2 \x3d (texelStart +  vec2(0.0, 1.0)) / texSize;\n  vec2 coord3 \x3d (texelStart +  vec2(1.0, 1.0)) / texSize;\n  vec4 color0 \x3d texture2D(sampler, coord0);\n  vec4 color1 \x3d texture2D(sampler, coord1);\n  vec4 color2 \x3d texture2D(sampler, coord2);\n  vec4 color3 \x3d texture2D(sampler, coord3);\n  vec2 blend \x3d fract(coords * texSize);\n  vec4 color01 \x3d mix(color0, color1, blend.x);\n  vec4 color23 \x3d mix(color2, color3, blend.x);\n  return mix(color01, color23, blend.y);\n}",
"epx.glsl":"vec4 sampleEPX(sampler2D sampler, float size, vec2 coords, vec2 texSize) {\n  vec2 invSize \x3d 1.0 / texSize;\n  vec2 texel \x3d coords * texSize;\n  vec2 texel_i \x3d floor(texel);\n  vec2 texel_frac \x3d fract(texel);\n  vec4 colorP \x3d texture2D(sampler, texel_i * invSize);\n  vec4 colorP1 \x3d vec4(colorP);\n  vec4 colorP2 \x3d vec4(colorP);\n  vec4 colorP3 \x3d vec4(colorP);\n  vec4 colorP4 \x3d vec4(colorP);\n  vec4 colorA \x3d texture2D(sampler, (texel_i - vec2(0.0, 1.0)) * invSize);\n  vec4 colorB \x3d texture2D(sampler, (texel_i + vec2(1.0, 0.0)) * invSize);\n  vec4 colorC \x3d texture2D(sampler, (texel_i - vec2(1.0, 0.0)) * invSize);\n  vec4 colorD \x3d texture2D(sampler, (texel_i + vec2(0.0, 1.0)) * invSize);\n  if (colorC \x3d\x3d colorA \x26\x26 colorC !\x3d colorD \x26\x26 colorA !\x3d colorB) {\n    colorP1 \x3d colorA;\n  }\n  if (colorA \x3d\x3d colorB \x26\x26 colorA !\x3d colorC \x26\x26 colorB !\x3d colorD) {\n    colorP2 \x3d colorB;\n  }\n  if (colorD \x3d\x3d colorC \x26\x26 colorD !\x3d colorB \x26\x26 colorC !\x3d colorA) {\n    colorP3 \x3d colorC;\n  }\n  if (colorB \x3d\x3d colorD \x26\x26 colorB !\x3d colorA \x26\x26 colorD !\x3d colorC) {\n    colorP4 \x3d colorD;\n  }\n  vec4 colorP12 \x3d mix(colorP1, colorP2, texel_frac.x);\n  vec4 colorP34 \x3d mix(colorP1, colorP2, texel_frac.x);\n  return mix(colorP12, colorP34, texel_frac.y);\n}"},
fx:{integrate:{"integrate.frag":"precision mediump float;\nuniform lowp sampler2D u_sourceTexture;\nuniform lowp sampler2D u_maskTexture;\nuniform mediump float u_zoomLevel;\nuniform highp float u_timeDelta;\nuniform highp float u_animationTime;\nvarying highp vec2 v_texcoord;\n#include \x3cmaterials/utils.glsl\x3e\nvoid main()\n{\n#ifdef DELTA\n  vec4 texel \x3d texture2D(u_sourceTexture, v_texcoord);\n  vec4 data0 \x3d texture2D(u_maskTexture, v_texcoord);\n  float flags \x3d data0.r * 255.0;\n  float groupMinZoom \x3d data0.g * 255.0;\n  float isVisible \x3d getFilterBit(flags, 0);\n  float wouldClip \x3d step(groupMinZoom, u_zoomLevel);\n  float direction \x3d wouldClip * 1.0 + (1.0 - wouldClip) * -1.0;\n  float dt \x3d u_timeDelta / max(u_animationTime, 0.0001);\n  vec4 nextState \x3d vec4(texel + direction * dt);\n  gl_FragColor \x3d  vec4(nextState);\n#elif defined(UPDATE)\n  vec4 texel \x3d texture2D(u_sourceTexture, v_texcoord);\n  gl_FragColor \x3d texel;\n#endif\n}",
"integrate.vert":"precision mediump float;\nattribute vec2 a_pos;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos;\n  gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n}"}},highlight:{"blur.frag":"varying mediump vec2 v_texcoord;\nuniform mediump vec4 u_direction;\nuniform mediump mat4 u_channelSelector;\nuniform mediump vec4 u_sigmas;\nuniform sampler2D u_texture;\nmediump vec4 gauss4(mediump vec2 dir) {\n  return exp(-dot(dir, dir) / (2.0 * u_sigmas * u_sigmas));\n}\nmediump float gauss1(mediump vec2 dir) {\n  return exp(-dot(dir, dir) / (2.0 * u_sigmas[3] * u_sigmas[3]));\n}\nmediump vec4 selectChannel(mediump vec4 sample) {\n  return u_channelSelector * sample;\n}\nvoid accumGauss4(mediump float i, inout mediump vec4 tot, inout mediump vec4 weight) {\n  mediump vec4 w \x3d gauss4(i * u_direction.xy);\n  tot +\x3d selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw)) * w;\n  weight +\x3d w;\n}\nvoid accumGauss1(mediump float i, inout mediump float tot, inout mediump float weight) {\n  mediump float w \x3d gauss1(i * u_direction.xy);\n  tot +\x3d selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw))[3] * w;\n  weight +\x3d w;\n}\nvoid main(void) {\n  mediump float tot \x3d 0.0;\n  mediump float weight \x3d 0.0;\n  accumGauss1(-4.0, tot, weight);\n  accumGauss1(-3.0, tot, weight);\n  accumGauss1(-2.0, tot, weight);\n  accumGauss1(-1.0, tot, weight);\n  accumGauss1(0.0, tot, weight);\n  accumGauss1(1.0, tot, weight);\n  accumGauss1(2.0, tot, weight);\n  accumGauss1(3.0, tot, weight);\n  accumGauss1(4.0, tot, weight);\n  gl_FragColor \x3d vec4(0.0, 0.0, 0.0, tot / weight);\n}",
"highlight.frag":"varying mediump vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform mediump vec4 u_sigmas;\nuniform sampler2D u_shade;\nuniform mediump vec2 u_minMaxDistance;\nmediump float estimateDistance() {\n  mediump float sigma \x3d u_sigmas[3];\n  mediump float y \x3d texture2D(u_texture, v_texcoord)[3];\n  const mediump float y0 \x3d 0.5;\n  mediump float m0 \x3d 1.0 / (sqrt(2.0 * 3.1415) * sigma);\n  mediump float d \x3d (y - y0) / m0;\n  return d;\n}\nmediump vec4 shade(mediump float d) {\n  mediump float mappedDistance \x3d (d - u_minMaxDistance.x) / (u_minMaxDistance.y - u_minMaxDistance.x);\n  mappedDistance \x3d clamp(mappedDistance, 0.0, 1.0);\n  return texture2D(u_shade, vec2(mappedDistance, 0.5));\n}\nvoid main(void) {\n  mediump float d \x3d estimateDistance();\n  gl_FragColor \x3d shade(d);\n}",
"textured.vert":"attribute mediump vec2 a_position;\nattribute mediump vec2 a_texcoord;\nvarying mediump vec2 v_texcoord;\nvoid main(void) {\n  gl_Position \x3d vec4(a_position, 0.0, 1.0);\n  v_texcoord \x3d a_texcoord;\n}"},magnifier:{"magnifier.frag":"uniform lowp vec4 u_background;\nuniform mediump sampler2D u_readbackTexture;\nuniform mediump sampler2D u_maskTexture;\nuniform mediump sampler2D u_overlyTexture;\nvarying mediump vec2 v_texCoord;\nvoid main(void)\n{\n  lowp vec4 color \x3d texture2D(u_readbackTexture, v_texCoord);\n  color \x3d color + (1.0 - color.a) * u_background;\n  lowp vec4 mask_color \x3d texture2D(u_maskTexture, v_texCoord);\n  lowp float gray \x3d 1.0 - dot(mask_color, vec4(0.3, 0.59, 0.11, 0));\n  color *\x3d gray;\n  lowp vec4 overley_color \x3d texture2D(u_overlyTexture, v_texCoord);\n  overley_color.rgb *\x3d overley_color.a;\n  gl_FragColor \x3d overley_color + (1.0 - overley_color.a) * color;\n}",
"magnifier.vert":"precision mediump float;\nattribute mediump vec2 a_pos;\nuniform mediump vec2 u_drawPos;\nuniform mediump float u_width;\nuniform mediump float u_height;\nvarying mediump vec2 v_texCoord;\nvoid main(void)\n{\n  v_texCoord \x3d a_pos;\n  vec2 coord \x3d u_drawPos + vec2(a_pos - 0.5) * vec2(u_width, u_height);\n  gl_Position \x3d vec4(coord, 0.0, 1.0);\n}"},materials:{"attributeData.glsl":"uniform highp sampler2D u_attributeData0;\nuniform highp sampler2D u_attributeData1;\nuniform highp sampler2D u_attributeData2;\nuniform highp sampler2D u_attributeData3;\nuniform highp int u_attributeTextureSize;\nhighp vec2 getAttributeDataCoords(in highp vec4 id) {\n  highp vec4 texel \x3d unpackLocalIdTexel(id);\n  highp float size \x3d float(u_attributeTextureSize);\n  highp float u32 \x3d float(int(texel.r) + int(texel.g) * 256 + int(texel.b) * 256 * 256 + int(texel.a) * 256 * 256 * 256);\n  highp float col \x3d mod(u32, size);\n  highp float row \x3d (u32 - col) / size;\n  highp float u \x3d col / size;\n  highp float v \x3d row / size;\n  return vec2(u, v);\n}\nhighp vec4 getAttributeData0(in highp vec4 id) {\n  vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData0, coords);\n}\nhighp vec4 getAttributeData1(in highp vec4 id) {\n  highp vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData1, coords);\n}\nhighp vec4 getAttributeData2(in highp vec4 id) {\n  highp vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData2, coords);\n}\nhighp vec4 getAttributeData3(in highp vec4 id) {\n  highp vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData3, coords);\n}\nfloat u88VVToFloat(in vec2 v) {\n  bool isMagic \x3d v.x \x3d\x3d 255.0 \x26\x26 v.y \x3d\x3d 255.0;\n  if (isMagic) {\n    return NAN_MAGIC_NUMBER;\n  }\n  return (v.x + v.y * float(0x100)) - 32768.0;\n}",
"constants.glsl":"const float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\nconst float SIGNED_BYTE_TO_UNSIGNED \x3d 128.0;\nconst float SOFT_EDGE_RATIO \x3d 1.0;\nconst float THIN_LINE_WIDTH_FACTOR \x3d 1.1;\nconst float THIN_LINE_HALF_WIDTH \x3d 1.0;\nconst float EXTRUDE_SCALE_PLACEMENT_PADDING \x3d 1.0 / 4.0;\nconst float OFFSET_PRECISION \x3d 1.0 / 8.0;\nconst float OUTLINE_SCALE \x3d 1.0 / 5.0;\nconst float SDF_FONT_SIZE \x3d 24.0;\nconst float MAX_SDF_DISTANCE \x3d 8.0;\nconst float PLACEMENT_PADDING \x3d 8.0;\nconst float EPSILON \x3d 0.0000001;\nconst int MAX_FILTER_COUNT \x3d 2;\nconst int ATTR_VV_SIZE \x3d 0;\nconst int ATTR_VV_COLOR \x3d 1;\nconst int ATTR_VV_OPACITY \x3d 2;\nconst int ATTR_VV_ROTATION \x3d 3;\nconst highp float NAN_MAGIC_NUMBER \x3d 1e-30;",
"effects.glsl":"uniform highp mat4 u_insideEffectMat4[ MAX_FILTER_COUNT ];\nuniform highp mat4 u_outsideEffectMat4[ MAX_FILTER_COUNT ];\nuniform highp float u_insideOpacities[ MAX_FILTER_COUNT ];\nuniform highp float u_outsideOpacities[ MAX_FILTER_COUNT ];\nvec4 getEffectColor(in vec4 color, in float filterFlags) {\n  vec4 rgbw \x3d vec4(color.a \x3e 0.0 ? color.rgb / color.a : vec3(0.0), 1.0);\n  float a \x3d color.a;\n  for (int i \x3d 1; i \x3c EFFECT_COUNT + 1; i++) {\n    float bit \x3d getFilterBit(filterFlags, i);\n    rgbw \x3d u_insideEffectMat4[ i ] * (bit  * rgbw) + u_outsideEffectMat4[ i ] * ((1.0 - bit) * rgbw);\n    a    \x3d u_insideOpacities[ i ]  * (bit  * a)    + u_outsideOpacities[ i ]  * ((1.0 - bit) * a);\n  }\n  return vec4(rgbw.rgb * a, a);\n}\nvec3 applyFilter(inout vec4 color, inout vec3 pos, in float filterFlags) {\n  vec4 rgbw \x3d vec4(color.a \x3e 0.0 ? color.rgb / color.a : vec3(0.0), 1.0);\n  float a \x3d color.a;\n  for (int i \x3d 0; i \x3c EFFECT_COUNT + 1; i++) {\n    float bit \x3d getFilterBit(filterFlags, i);\n    rgbw \x3d u_insideEffectMat4[ i ] * (bit  * rgbw) + u_outsideEffectMat4[ i ] * ((1.0 - bit) * rgbw);\n    a    \x3d u_insideOpacities[ i ]  * (bit  * a)    + u_outsideOpacities[ i ]  * ((1.0 - bit) * a);\n  }\n  color.rgb \x3d rgbw.rgb * a;\n  color.a \x3d a;\n  pos.z +\x3d 2.0 * (1.0 - getFilterBit(filterFlags, 0));\n#ifdef HIGHLIGHT\n  pos.z +\x3d 2.0 * (1.0 - getHighlightBit(filterFlags));\n#endif\n  return pos;\n}\nvec3 applyFilterLabels(inout vec4 color, inout vec3 pos, in float filterFlags) {\n  float bit \x3d getFilterBit(filterFlags, 0);\n  pos.z +\x3d 2.0 * (1.0 - bit);\n#ifndef OUTSIDE_LABELS_VISIBLE\n  for (int i \x3d 1; i \x3c EFFECT_COUNT + 1; i++) {\n    float bit \x3d getFilterBit(filterFlags, i);\n    pos.z +\x3d 2.0 * (1.0 - bit);\n  }\n#endif\n  return pos;\n}",
fill:{"common.glsl":"#ifdef PATTERN\nuniform mediump vec2 u_mosaicSize;\n#endif\n#ifdef DOT_DENSITY\nuniform lowp vec4 u_isActive[ 2 ];\nuniform highp float u_dotValue;\nuniform highp float u_tileDotsOverArea;\nuniform highp float u_dotTextureDotCount;\nuniform mediump float u_tileZoomFactor;\n#endif\nvarying vec3 v_pos;\nvarying lowp float v_opacity;\nvarying lowp vec4 v_color;\nvarying highp vec4 v_id;\nvarying highp float v_flags;\n#ifdef PATTERN\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef DOT_DENSITY\nvarying highp vec2 v_dotTextureCoords;\nvarying highp vec4 v_dotThresholds[ 2 ];\n#endif",
"fill.frag":"precision highp float;\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/fill/common.glsl\x3e\n#ifdef DOT_DENSITY\n#include \x3cmaterials/effects.glsl\x3e\n#endif\n#ifdef PATTERN\nuniform lowp sampler2D u_texture;\n#endif\n#ifdef DOT_DENSITY\nuniform mediump mat4 u_dotColors[ 2 ];\nuniform sampler2D u_dotTextures[ 2 ];\nuniform vec4 u_dotBackgroundColor;\n#endif\nvoid main() {\n#ifdef ID\n  gl_FragColor \x3d v_id;\n#elif defined(PATTERN)\n  mediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\n  mediump vec2 samplePos \x3d mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\n  lowp vec4 color \x3d texture2D(u_texture, samplePos);\n  gl_FragColor \x3d v_opacity * v_color * color;\n#elif defined(DOT_DENSITY) \x26\x26 !defined(HIGHLIGHT)\n  vec4 textureThresholds0 \x3d texture2D(u_dotTextures[0], v_dotTextureCoords);\n  vec4 textureThresholds1 \x3d texture2D(u_dotTextures[1], v_dotTextureCoords);\n  vec4 difference0 \x3d v_dotThresholds[0] - textureThresholds0;\n  vec4 difference1 \x3d v_dotThresholds[1] - textureThresholds1;\n#ifdef DD_DOT_BLENDING\n  vec4 isPositive0 \x3d step(0.0, difference0);\n  vec4 isPositive1 \x3d step(0.0, difference1);\n  float weightSum \x3d dot(isPositive0, difference0) + dot(isPositive1, difference1);\n  float lessThanEqZero \x3d step(weightSum, 0.0);\n  float greaterThanZero \x3d 1.0 - lessThanEqZero ;\n  float divisor \x3d (weightSum + lessThanEqZero);\n  vec4 weights0 \x3d difference0 * isPositive0 / divisor;\n  vec4 weights1 \x3d difference1 * isPositive1 / divisor;\n  vec4 dotColor \x3d u_dotColors[0] * weights0 + u_dotColors[1] * weights1;\n  vec4 preEffectColor \x3d greaterThanZero * dotColor + lessThanEqZero * u_dotBackgroundColor;\n#else\n  float diffMax \x3d max(max4(difference0), max4(difference1));\n  float lessThanZero \x3d step(diffMax, 0.0);\n  float greaterOrEqZero \x3d 1.0 - lessThanZero;\n  vec4 isMax0 \x3d step(diffMax, difference0);\n  vec4 isMax1 \x3d step(diffMax, difference1);\n  vec4 dotColor \x3d u_dotColors[0] * isMax0 + u_dotColors[1] * isMax1;\n  vec4 preEffectColor \x3d greaterOrEqZero * dotColor + lessThanZero * u_dotBackgroundColor;\n#endif\n  gl_FragColor \x3d getEffectColor(preEffectColor, v_flags);\n#else\n  gl_FragColor \x3d v_opacity * v_color;\n#endif\n#ifdef HIGHLIGHT\n  gl_FragColor.a \x3d 1.0;\n#endif\n}",
"fill.vert":"precision highp float;\n#ifdef DOT_DENSITY\nattribute float a_inverseArea;\nvec4 a_color \x3d vec4(0.0, 0.0, 0.0, 1.0);\nvec4 a_aux3 \x3d vec4(0.0);\n#else\nattribute vec4 a_color;\nattribute vec4 a_tlbr;\nattribute vec4 a_aux1;\nattribute vec2 a_aux2;\nattribute vec4 a_aux3;\n#endif\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/fill/common.glsl\x3e\n#ifdef DOT_DENSITY\nvec4 dotThreshold(vec4 featureAttrOverFeatureArea, float dotValue, float tileDotsOverArea) {\n  return featureAttrOverFeatureArea * (1.0 / dotValue)  * (1.0 / tileDotsOverArea);\n}\n#endif\n#ifdef PATTERN\nmat3 getPatternMatrix() {\n  mat3 patternMatrix \x3d mat3(1.0);\n  vec2 aux2 \x3d (1.0 / SIGNED_BYTE_TO_UNSIGNED) * a_aux2;\n  patternMatrix[0][0] \x3d 1.0 / (u_zoomFactor * a_aux1.x * aux2.x);\n  patternMatrix[1][1] \x3d 1.0 / (u_zoomFactor * a_aux1.y * aux2.y);\n  return patternMatrix;\n}\n#endif\nvoid main()\n{\n  INIT;\n  float a_bitSet \x3d a_aux3.a;\n  v_color     \x3d getColor(a_color, a_bitSet, 0);\n  v_opacity   \x3d getOpacity(a_bitSet, 1);\n  v_id        \x3d norm(a_id);\n  v_pos       \x3d u_dvsMat3 * vec3(a_pos, 1.);\n  v_flags     \x3d getFilterFlags();\n#ifdef PATTERN\n  vec2 symbolOffset \x3d u_zoomFactor * (a_aux1.zw - SIGNED_BYTE_TO_UNSIGNED);\n  v_tileTextureCoord \x3d (getPatternMatrix() * vec3(a_pos + symbolOffset, 1.0)).xy;\n  v_tlbr \x3d a_tlbr / u_mosaicSize.xyxy;\n#elif defined(DOT_DENSITY)\n  vec4 ddAttributeData0 \x3d getAttributeData2(a_id) * u_isActive[0] * a_inverseArea;\n  vec4 ddAttributeData1 \x3d getAttributeData3(a_id) * u_isActive[1] * a_inverseArea;\n  float size \x3d u_tileZoomFactor * 512.0 * 1.0 / u_pixelRatio;\n  v_dotThresholds[0] \x3d dotThreshold(ddAttributeData0, u_dotValue, u_tileDotsOverArea);\n  v_dotThresholds[1] \x3d dotThreshold(ddAttributeData1, u_dotValue, u_tileDotsOverArea);\n  v_dotTextureCoords \x3d (a_pos + 0.5) / size;\n#endif\n  gl_Position \x3d vec4(applyFilter(v_color, v_pos, v_flags), 1.0);\n}"},
icon:{"common.glsl":"uniform lowp vec2 u_mosaicSize;\nvarying lowp vec4 v_color;\nvarying highp vec4 v_id;\nvarying highp vec4 v_sizeTex;\nvarying mediump vec3 v_pos;\nvarying highp float v_filters;\nvarying lowp float v_opacity;\n#ifdef SDF\nvarying lowp vec4 v_outlineColor;\nvarying mediump float v_outlineWidth;\nvarying mediump float v_distRatio;\nvarying mediump float v_overridingOutlineColor;\nvarying mediump float v_isThin;\n#endif","icon.frag":"precision mediump float;\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cutil/encoding.glsl\x3e\n#include \x3cmaterials/effects.glsl\x3e\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\nuniform lowp sampler2D u_texture;\nvoid main()\n{\n  vec2 v_size \x3d v_sizeTex.xy;\n  vec2 v_tex  \x3d v_sizeTex.zw;\n#ifdef SDF\n  lowp vec4 fillPixelColor \x3d v_color;\n  float d \x3d 0.5 - rgba2float(texture2D(u_texture, v_tex));\n  float size \x3d max(v_size.x, v_size.y);\n  float dist \x3d d * size * SOFT_EDGE_RATIO * v_distRatio;\n  fillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\n  float outlineWidth \x3d v_outlineWidth;\n  #ifdef HIGHLIGHT\n    outlineWidth \x3d max(outlineWidth, 4.0 * v_isThin);\n  #endif\n  if (outlineWidth \x3e 0.25) {\n    lowp vec4 outlinePixelColor \x3d v_overridingOutlineColor * v_color + (1.0 - v_overridingOutlineColor) * v_outlineColor;\n    float clampedOutlineSize \x3d min(outlineWidth, size);\n    outlinePixelColor *\x3d clamp(0.5 - abs(dist) + clampedOutlineSize * 0.5, 0.0, 1.0);\n    gl_FragColor \x3d v_opacity * ((1.0 - outlinePixelColor.a) * fillPixelColor + outlinePixelColor);\n  }\n  else {\n    gl_FragColor \x3d v_opacity * fillPixelColor;\n  }\n#else\n   lowp vec4 texColor \x3d texture2D(u_texture, v_tex);\n   gl_FragColor \x3d v_opacity * getEffectColor(texColor, v_filters);\n#endif\n#ifdef HIGHLIGHT\n  gl_FragColor.a \x3d step(1.0 / 255.0, gl_FragColor.a);\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"icon.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_outlineColor;\nattribute vec4 a_sizeAndOutlineWidth;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nattribute vec4 a_bitSetAndDistRatio;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\nvec2 getMarkerSize(inout vec2 offset, inout vec2 baseSize, inout float outlineSize, in float referenceSize, in float bitSet) {\n#ifdef VV_SIZE\n  float r \x3d getSize(baseSize.y) / referenceSize;\n  baseSize.xy *\x3d r;\n  offset.xy *\x3d r;\n  float scaleSymbolProportionally \x3d getBit(bitSet, 3);\n  outlineSize *\x3d scaleSymbolProportionally * (r - 1.0) + 1.0;\n#endif\n  return baseSize;\n}\nvec3 getOffset(in vec2 in_offset, float a_bitSet) {\n  float isMapAligned \x3d getBit(a_bitSet, 0);\n  vec3  offset       \x3d getRotation() * vec3(in_offset, 0.0);\n  return getMatrix(isMapAligned) * offset;\n}\nvoid main()\n{\n  INIT;\n  vec2  a_size   \x3d a_sizeAndOutlineWidth.xy * a_sizeAndOutlineWidth.xy / 256.0;\n  vec2  a_offset \x3d a_vertexOffset / 16.0;\n  float a_outlineSize \x3d a_sizeAndOutlineWidth.z * a_sizeAndOutlineWidth.z / 256.0;\n  float a_bitSet \x3d a_bitSetAndDistRatio.z;\n  vec2 v_size \x3d getMarkerSize(a_offset, a_size, a_outlineSize, a_sizeAndOutlineWidth.w * a_sizeAndOutlineWidth.w / 256.0, a_bitSet);\n  vec2 v_tex      \x3d a_texCoords / u_mosaicSize;\n  v_color    \x3d getColor(a_color, a_bitSet, 1);\n  v_opacity  \x3d getOpacity(a_bitSet, 1);\n  v_id       \x3d norm(a_id);\n  v_filters  \x3d getFilterFlags();\n  v_pos      \x3d u_dvsMat3 * vec3(a_pos, 1.0) + getOffset(a_offset, a_bitSet);\n  v_sizeTex  \x3d vec4(v_size.xy, v_tex.xy);\n#ifdef SDF\n  v_isThin   \x3d getBit(a_bitSet, 2);\n  #ifdef VV_COLOR\n    v_overridingOutlineColor \x3d v_isThin;\n  #else\n    v_overridingOutlineColor \x3d 0.0;\n  #endif\n  v_outlineWidth \x3d min(a_outlineSize, max(max(v_size.x, v_size.y) - 0.99, 0.0));\n  v_outlineColor \x3d getEffectColor(a_outlineColor, v_filters);\n  v_distRatio \x3d a_bitSetAndDistRatio.w / 126.0;\n#endif\n  gl_Position \x3d vec4(applyFilter(v_color, v_pos, v_filters), 1.0);\n}"},
label:{"common.glsl":"uniform mediump float u_zoomLevel;\nuniform mediump float u_mapRotation;\nuniform mediump float u_mapAligned;\nuniform mediump vec2 u_mosaicSize;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying mediump vec2 v_tex;\nvarying mediump vec4 v_color;\nvarying lowp vec4 v_animation;","label.frag":"#include \x3cmaterials/text/text.frag\x3e","label.vert":"precision highp float;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/text/common.glsl\x3e\nattribute vec4 a_color;\nattribute vec4 a_haloColor;\nattribute vec4 a_texAndSize;\nattribute vec4 a_refSymbolAndPlacementOffset;\nattribute vec4 a_glyphData;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nuniform float u_isHalo;\nuniform float u_zoomLevel;\nuniform float u_mapRotation;\nuniform float u_mapAligned;\nfloat getZ(in float minZoom, in float maxZoom, in float angle) {\n  float glyphAngle \x3d angle * 360.0 / 254.0;\n  float mapAngle \x3d u_mapRotation * 360.0 / 254.0;\n  float diffAngle \x3d min(360.0 - abs(mapAngle - glyphAngle), abs(mapAngle - glyphAngle));\n  float z \x3d 0.0;\n  z +\x3d u_mapAligned * (2.0 * (1.0 - step(minZoom, u_zoomLevel)));\n  z +\x3d u_mapAligned * 2.0 * step(90.0, diffAngle);\n  z +\x3d 2.0 * (1.0 - step(u_zoomLevel, maxZoom));\n  return z;\n}\nvoid main()\n{\n  INIT;\n  float groupMinZoom    \x3d getMinZoom();\n  float glyphMinZoom    \x3d a_glyphData.x;\n  float glyphMaxZoom    \x3d a_glyphData.y;\n  float glyphAngle      \x3d a_glyphData.z;\n  float a_minZoom          \x3d max(groupMinZoom, glyphMinZoom);\n  float a_placementPadding \x3d a_refSymbolAndPlacementOffset.x * EXTRUDE_SCALE_PLACEMENT_PADDING;\n  vec2  a_placementDir     \x3d unpack_u8_nf32(a_refSymbolAndPlacementOffset.zw);\n  float a_refSymbolSize    \x3d a_refSymbolAndPlacementOffset.y;\n  float fontSize           \x3d a_texAndSize.z;\n  float haloSize           \x3d a_texAndSize.w * OUTLINE_SCALE;\n  vec2  vertexOffset \x3d a_vertexOffset * OFFSET_PRECISION;\n  vec3  pos          \x3d vec3(floor(a_pos * 0.5) * OFFSET_PRECISION, 1.0);\n  float z            \x3d getZ(a_minZoom, glyphMaxZoom, glyphAngle);\n  float fontScale    \x3d fontSize / SDF_FONT_SIZE;\n  float halfSize     \x3d getSize(a_refSymbolSize) / 2.0;\n  float animation    \x3d pow(getAnimationState(), vec4(2.0)).r;\n  v_color     \x3d animation * ((1.0 - u_isHalo) * a_color + (u_isHalo * a_haloColor));\n  v_opacity   \x3d 1.0;\n  v_tex       \x3d a_texCoords / u_mosaicSize;\n  v_edgeDistanceOffset \x3d u_isHalo * haloSize / fontScale / MAX_SDF_DISTANCE;\n  v_antialiasingWidth  \x3d 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\n  vec2 placementOffset \x3d a_placementDir * (halfSize + a_placementPadding);\n  vec3 glyphOffset     \x3d u_displayMat3 * vec3(vertexOffset + placementOffset, 0.0);\n  vec3 v_pos           \x3d vec3((u_dvsMat3 * pos + glyphOffset).xy, z);\n  gl_Position \x3d vec4(applyFilterLabels(v_color, v_pos, getFilterFlags()), 1.0);\n#ifdef DEBUG\n  v_color \x3d vec4(a_color.rgb, z \x3d\x3d 0.0 ? 1.0 : 0.645);\n#endif\n}"},
line:{"common.glsl":"varying lowp vec4 v_color;\nvarying highp vec4 v_id;\nvarying mediump vec2 v_normal;\nvarying mediump float v_lineHalfWidth;\nvarying lowp float v_opacity;\nvarying highp vec3 v_pos;\n#ifdef PATTERN\nuniform mediump vec2 u_mosaicSize;\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\n#endif\n#if defined(PATTERN) || defined(SDF)\nvarying highp float v_accumulatedDistance;\n#endif","line.frag":"precision lowp float;\n#include \x3cutil/encoding.glsl\x3e\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/line/common.glsl\x3e\nuniform lowp float u_blur;\nuniform mediump float u_zoomFactor;\n#if defined(PATTERN) || defined(SDF)\nuniform sampler2D u_texture;\n#endif\n#ifdef SDF\nconst float sdfPatternHalfWidth \x3d 15.5;\nconst float widthFactor \x3d 2.0;\n#endif\nvoid main()\n{\n  mediump float thinLineFactor \x3d max(THIN_LINE_WIDTH_FACTOR * step(v_lineHalfWidth, THIN_LINE_HALF_WIDTH), 1.0);\n  mediump float fragDist \x3d length(v_normal) * v_lineHalfWidth;\n  lowp float alpha \x3d clamp(thinLineFactor * (v_lineHalfWidth - fragDist) / (u_blur + thinLineFactor - 1.0), 0.0, 1.0);\n#if defined(SDF) \x26\x26 !defined(HIGHLIGHT)\n  mediump float lineHalfWidth \x3d widthFactor * v_lineHalfWidth;\n  mediump float lineWidthRatio \x3d lineHalfWidth / sdfPatternHalfWidth;\n  mediump float relativeTexX \x3d mod((u_zoomFactor * v_accumulatedDistance + v_normal.x * lineHalfWidth) / (lineWidthRatio * v_patternSize.x), 1.0);\n  mediump float relativeTexY \x3d 0.5 + 0.5 * v_normal.y;\n  mediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\n  mediump float d \x3d rgba2float(texture2D(u_texture, texCoord)) - 0.5;\n  float dist \x3d d * lineHalfWidth;\n  lowp vec4 fillPixelColor \x3d v_opacity * alpha * clamp(0.5 - dist, 0.0, 1.0) * v_color;\n  gl_FragColor \x3d fillPixelColor;\n#elif defined(PATTERN) \x26\x26 !defined(HIGHLIGHT)\n  mediump float relativeTexX \x3d mod((u_zoomFactor * v_accumulatedDistance + v_normal.x * v_lineHalfWidth) / v_patternSize.x, 1.0);\n  mediump float relativeTexY \x3d 0.5 + (v_normal.y * v_lineHalfWidth / v_patternSize.y);\n  mediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\n  lowp vec4 color \x3d texture2D(u_texture, texCoord);\n  gl_FragColor \x3d v_opacity * alpha * v_color * color;\n#else\n  gl_FragColor \x3d v_opacity * alpha * v_color;\n#endif\n#ifdef HIGHLIGHT\n  gl_FragColor.a \x3d step(1.0 / 255.0, gl_FragColor.a);\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"line.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_offsetAndNormal;\nattribute vec2 a_accumulatedDistanceAndHalfWidth;\nattribute vec4 a_tlbr;\nattribute vec4 a_segmentDirection;\nattribute vec2 a_aux;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/line/common.glsl\x3e\nconst float SCALE \x3d 1.0 / 31.0;\nconst float WIDTH_SCALE \x3d 1.0 / 1024.0;\nfloat getBaseLineHalfWidth(in float in_lineHalfWidth) {\n#ifdef VV_SIZE\n  float referenceHalfWidth \x3d a_aux.x * WIDTH_SCALE;\n  float lineWidth \x3d 2.0 * in_lineHalfWidth;\n  return 0.5 * (in_lineHalfWidth / referenceHalfWidth) * getSize(lineWidth);\n#else\n  return in_lineHalfWidth;\n#endif\n}\nfloat getLineHalfWidth(in float baseWidth, in float aa) {\n  float halfWidth \x3d max(baseWidth + aa, 0.45) + 0.1 * aa;\n#ifdef HIGHLIGHT\n  halfWidth \x3d max(halfWidth, 2.0);\n#endif\n  return halfWidth;\n}\nvec2 getDist(in vec2 offset, in float halfWidth) {\n  float thinLineFactor \x3d max(THIN_LINE_WIDTH_FACTOR * step(halfWidth, THIN_LINE_HALF_WIDTH), 1.0);\n#if defined(SDF) \x26\x26 !defined(HIGHLIGHT)\n  thinLineFactor *\x3d 2.0;\n#endif\n  return thinLineFactor * halfWidth * offset * SCALE;\n}\nvoid main()\n{\n  INIT;\n  float a_bitSet          \x3d a_segmentDirection.w;\n  float a_accumulatedDist \x3d a_accumulatedDistanceAndHalfWidth.x;\n  float a_lineHalfWidth   \x3d a_accumulatedDistanceAndHalfWidth.y * WIDTH_SCALE;\n  float aa                \x3d 0.5 * u_antialiasing;\n  vec2  a_offset          \x3d a_offsetAndNormal.xy;\n  float baseWidth \x3d getBaseLineHalfWidth(a_lineHalfWidth);\n  float halfWidth \x3d getLineHalfWidth(baseWidth, aa);\n  float z         \x3d 2.0 * step(baseWidth, 0.0);\n  vec2  dist      \x3d getDist(a_offset, halfWidth);\n  vec3  offset    \x3d u_displayViewMat3 * vec3(dist, 0.0);\n  vec3  pos       \x3d u_dvsMat3 * vec3(a_pos.xy, 1.0) + offset;\n  v_color         \x3d getColor(a_color, a_bitSet, 0);\n  v_opacity       \x3d getOpacity(a_bitSet, 0);\n  v_lineHalfWidth \x3d halfWidth;\n  v_id            \x3d norm(a_id);\n  v_normal        \x3d a_offsetAndNormal.zw * SCALE;\n  v_pos           \x3d vec3(pos.xy, z);\n#ifdef PATTERN\n  v_tlbr          \x3d a_tlbr / u_mosaicSize.xyxy;\n  v_patternSize   \x3d vec2(a_tlbr.z - a_tlbr.x, a_tlbr.w - a_tlbr.y);\n#endif\n#if defined(PATTERN) || defined(SDF)\n  v_accumulatedDistance \x3d a_accumulatedDist + dot(SCALE * a_segmentDirection.xy, dist / u_zoomFactor);\n#endif\n  gl_Position \x3d vec4(applyFilter(v_color, v_pos, getFilterFlags()), 1.0);\n}"},
text:{"common.glsl":"uniform highp vec2 u_mosaicSize;\nvarying highp vec4 v_id;\nvarying mediump vec3 v_pos;\nvarying lowp float v_opacity;\nvarying lowp vec4 v_color;\nvarying highp vec2 v_tex;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying lowp float v_transparency;","text.frag":"precision mediump float;\n#include \x3cmaterials/text/common.glsl\x3e\nuniform lowp sampler2D u_texture;\nvoid main()\n{\n  float SDF_CUTOFF \x3d (2.0 / 8.0);\n  float SDF_BASE_EDGE_DIST \x3d 1.0 - SDF_CUTOFF;\n  lowp float dist \x3d texture2D(u_texture, v_tex).a;\n  mediump float edge \x3d SDF_BASE_EDGE_DIST - v_edgeDistanceOffset;\n#ifdef HIGHLIGHT\n  edge /\x3d 2.0;\n#endif\n  lowp float aa \x3d v_antialiasingWidth;\n  lowp float alpha \x3d smoothstep(edge - aa, edge + aa, dist);\n  gl_FragColor \x3d alpha * v_color * v_opacity;\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"text.vert":"precision highp float;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/text/common.glsl\x3e\nattribute vec4 a_color;\nattribute vec4 a_haloColor;\nattribute vec4 a_texFontSize;\nattribute vec4 a_aux;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nuniform float u_isHalo;\nfloat getTextSize(inout vec2 offset, in float baseSize, in float referenceSize) {\n#ifdef VV_SIZE\n   float ratio \x3d baseSize / referenceSize;\n   baseSize \x3d ratio * getSize(baseSize);\n#endif\n  return baseSize;\n}\nvoid main()\n{\n  INIT;\n  float a_bitSet    \x3d a_aux.w;\n  float a_fontSize  \x3d a_texFontSize.z;\n  vec2  a_offset    \x3d a_vertexOffset * OFFSET_PRECISION;\n  vec3  in_pos      \x3d vec3(floor(a_pos * 0.5), 1.0);\n  float fontSize    \x3d getTextSize(a_offset, a_fontSize, a_aux.z * a_aux.z / 256.0);\n  float scaleFactor \x3d fontSize / a_fontSize;\n  float fontScale   \x3d fontSize / SDF_FONT_SIZE;\n  vec3  offset      \x3d getRotation() * vec3(scaleFactor * a_offset, 0.0);\n  v_color   \x3d u_isHalo * a_haloColor + (1.0 - u_isHalo) * getColor(a_color, a_bitSet, 0);\n  v_opacity \x3d getOpacity(a_bitSet, 0);\n  v_id      \x3d norm(a_id);\n  v_tex     \x3d a_texCoords / u_mosaicSize;\n  v_pos     \x3d u_dvsMat3 * in_pos + u_displayMat3 * offset;\n  v_edgeDistanceOffset \x3d u_isHalo * OUTLINE_SCALE * a_texFontSize.w / fontScale / MAX_SDF_DISTANCE;\n  v_antialiasingWidth  \x3d 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\n  gl_Position \x3d  vec4(applyFilter(v_color, v_pos, getFilterFlags()), 1.0);\n}"},
"utils.glsl":"float rshift(in float u32, in int amount) {\n  return floor(u32 / pow(2.0, float(amount)));\n}\nfloat getBit(in float bitset, in int bitIndex) {\n  float offset \x3d pow(2.0, float(bitIndex));\n  return mod(floor(bitset / offset), 2.0);\n}\nfloat getFilterBit(in float bitset, in int bitIndex) {\n  return getBit(bitset, bitIndex + 1);\n}\nfloat getHighlightBit(in float bitset) {\n  return getBit(bitset, 0);\n}\nhighp vec4 unpackLocalIdTexel(in highp vec4 bitset) {\n  float isAggregate \x3d getBit(bitset.a, 7);\n  return (1.0 - isAggregate) * bitset + isAggregate * (vec4(bitset.rgba) - vec4(0.0, 0.0, 0.0, float(0x80)));\n}\nvec4 unpack(in float u32) {\n  float r \x3d mod(rshift(u32, 0), 255.0);\n  float g \x3d mod(rshift(u32, 8), 255.0);\n  float b \x3d mod(rshift(u32, 16), 255.0);\n  float a \x3d mod(rshift(u32, 24), 255.0);\n  return vec4(r, g, b, a);\n}\nvec4 norm(in vec4 v) {\n  return v /\x3d 255.0;\n}\nfloat max4(vec4 target) {\n  return max(max(max(target.x, target.y), target.z), target.w);\n}\nvec2 unpack_u8_nf32(vec2 bytes) {\n  return (bytes - 127.0) / 127.0;\n}",
"vcommon.glsl":"#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/attributeData.glsl\x3e\n#include \x3cmaterials/vv.glsl\x3e\n#include \x3cmaterials/effects.glsl\x3e\nattribute vec2 a_pos;\nattribute highp vec4 a_id;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform highp float u_pixelRatio;\nuniform mediump float u_zoomFactor;\nuniform mediump float u_antialiasing;\nvec4 VV_ADATA \x3d vec4(0.0);\nvoid loadVisualVariableData(inout vec4 target) {\n#ifdef OES_TEXTURE_FLOAT\n  target.rgba \x3d getAttributeData2(a_id);\n#else\n  vec4 data0 \x3d getAttributeData2(a_id);\n  vec4 data1 \x3d getAttributeData3(a_id);\n  target.r \x3d u88VVToFloat(data0.rg * 255.0);\n  target.g \x3d u88VVToFloat(data0.ba * 255.0);\n  target.b \x3d u88VVToFloat(data1.rg * 255.0);\n  target.a \x3d u88VVToFloat(data1.ba * 255.0);\n#endif\n}\n#ifdef VV\n  #define INIT loadVisualVariableData(VV_ADATA)\n#else\n  #define INIT\n#endif\nvec4 getColor(in vec4 a_color, in float a_bitSet, int index) {\n#ifdef VV_COLOR\n  float isColorLocked   \x3d getBit(a_bitSet, index);\n  return getVVColor(VV_ADATA[ATTR_VV_COLOR], a_color, isColorLocked);\n#else\n  return a_color;\n#endif\n}\nfloat getOpacity(in float a_bitSet, in int index) {\n#ifdef VV_OPACITY\n  float isOpacityLocked \x3d getBit(a_bitSet, index);\n  return getVVOpacity(VV_ADATA[ATTR_VV_OPACITY], isOpacityLocked);\n#else\n  return 1.0;\n#endif\n}\nfloat getSize(in float in_size) {\n#ifdef VV_SIZE\n  return getVVSize(in_size, VV_ADATA[ATTR_VV_SIZE]);\n#else\n  return in_size;\n#endif\n}\nmat3 getRotation() {\n#ifdef VV_ROTATION\n  return getVVRotationMat3(mod(VV_ADATA[ATTR_VV_ROTATION], 360.0));\n#else\n  return mat3(1.0);\n#endif\n}\nfloat getFilterFlags() {\n#ifdef IGNORES_SAMPLER_PRECISION\n  return ceil(getAttributeData0(a_id).x * 255.0);\n#else\n  return getAttributeData0(a_id).x * 255.0;\n#endif\n}\nvec4 getAnimationState() {\n  return getAttributeData1(a_id);\n}\nfloat getMinZoom() {\n  vec4 data0 \x3d getAttributeData0(a_id) * 255.0;\n  return data0.g;\n}\nmat3 getMatrix(float isMapAligned) {\n  return isMapAligned * u_displayViewMat3 + (1.0 - isMapAligned) * u_displayMat3;\n}",
"vv.glsl":"#if defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n  #define VV_SIZE\n#endif\n#if defined(VV_COLOR) || defined(VV_SIZE) || defined(VV_OPACITY) || defined(VV_ROTATION)\n  #define VV\n#endif\n#ifdef VV_COLOR\nuniform highp float u_vvColorValues[8];\nuniform vec4 u_vvColors[8];\n#endif\n#ifdef VV_SIZE_MIN_MAX_VALUE\nuniform highp vec4 u_vvSizeMinMaxValue;\n#endif\n#ifdef VV_SIZE_SCALE_STOPS\nuniform highp float u_vvSizeScaleStopsValue;\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nuniform highp float u_vvSizeFieldStopsValues[6];\nuniform float u_vvSizeFieldStopsSizes[6];\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nuniform highp float u_vvSizeUnitValueWorldToPixelsRatio;\n#endif\n#ifdef VV_OPACITY\nuniform highp float u_vvOpacityValues[8];\nuniform float u_vvOpacities[8];\n#endif\n#ifdef VV_ROTATION\nuniform lowp float u_vvRotationType;\n#endif\nbool isNan(float val) {\n  return (val \x3d\x3d NAN_MAGIC_NUMBER);\n}\n#ifdef VV_SIZE_MIN_MAX_VALUE\nfloat getVVMinMaxSize(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n  float interpolationRatio \x3d (sizeValue  - u_vvSizeMinMaxValue.x) / (u_vvSizeMinMaxValue.y - u_vvSizeMinMaxValue.x);\n  interpolationRatio \x3d clamp(interpolationRatio, 0.0, 1.0);\n  return u_vvSizeMinMaxValue.z + interpolationRatio * (u_vvSizeMinMaxValue.w - u_vvSizeMinMaxValue.z);\n}\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nconst int VV_SIZE_N \x3d 6;\nfloat getVVStopsSize(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n  if (sizeValue \x3c\x3d u_vvSizeFieldStopsValues[0]) {\n    return u_vvSizeFieldStopsSizes[0];\n  }\n  for (int i \x3d 1; i \x3c VV_SIZE_N; ++i) {\n    if (u_vvSizeFieldStopsValues[i] \x3e\x3d sizeValue) {\n      float f \x3d (sizeValue - u_vvSizeFieldStopsValues[i-1]) / (u_vvSizeFieldStopsValues[i] - u_vvSizeFieldStopsValues[i-1]);\n      return mix(u_vvSizeFieldStopsSizes[i-1], u_vvSizeFieldStopsSizes[i], f);\n    }\n  }\n  return u_vvSizeFieldStopsSizes[VV_SIZE_N - 1];\n}\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nfloat getVVUnitValue(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n  return u_vvSizeUnitValueWorldToPixelsRatio * sizeValue;\n}\n#endif\n#ifdef VV_OPACITY\nconst int VV_OPACITY_N \x3d 8;\nfloat getVVOpacity(float opacityValue, float isOpacityLocked) {\n  if (isNan(opacityValue) || isOpacityLocked \x3d\x3d 1.0) {\n    return 1.0;\n  }\n  if (opacityValue \x3c\x3d u_vvOpacityValues[0]) {\n    return u_vvOpacities[0];\n  }\n  for (int i \x3d 1; i \x3c VV_OPACITY_N; ++i) {\n    if (u_vvOpacityValues[i] \x3e\x3d opacityValue) {\n      float f \x3d (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\n      return mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\n    }\n  }\n  return u_vvOpacities[VV_OPACITY_N - 1];\n}\n#endif\n#ifdef VV_ROTATION\nmat4 getVVRotation(float rotationValue) {\n  if (isNan(rotationValue)) {\n    return mat4(1, 0, 0, 0,\n                0, 1, 0, 0,\n                0, 0, 1, 0,\n                0, 0, 0, 1);\n  }\n  float rotation \x3d rotationValue;\n  if (u_vvRotationType \x3d\x3d 1.0) {\n    rotation \x3d 90.0 - rotation;\n  }\n  float angle \x3d C_DEG_TO_RAD * rotation;\n  float sinA \x3d sin(angle);\n  float cosA \x3d cos(angle);\n  return mat4(cosA, sinA, 0, 0,\n              -sinA,  cosA, 0, 0,\n              0,     0, 1, 0,\n              0,     0, 0, 1);\n}\nmat3 getVVRotationMat3(float rotationValue) {\n  if (isNan(rotationValue)) {\n    return mat3(1, 0, 0,\n                0, 1, 0,\n                0, 0, 1);\n  }\n  float rotation \x3d rotationValue;\n  if (u_vvRotationType \x3d\x3d 1.0) {\n    rotation \x3d 90.0 - rotation;\n  }\n  float angle \x3d C_DEG_TO_RAD * -rotation;\n  float sinA \x3d sin(angle);\n  float cosA \x3d cos(angle);\n  return mat3(cosA, -sinA, 0,\n             sinA, cosA, 0,\n              0,    0,    1);\n}\n#endif\n#ifdef VV_COLOR\nconst int VV_COLOR_N \x3d 8;\nvec4 getVVColor(float colorValue, vec4 fallback, float isColorLocked) {\n  if (isNan(colorValue) || isColorLocked \x3d\x3d 1.0) {\n    return fallback;\n  }\n  if (colorValue \x3c\x3d u_vvColorValues[0]) {\n    return u_vvColors[0];\n  }\n  for (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\n    if (u_vvColorValues[i] \x3e\x3d colorValue) {\n      float f \x3d (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\n      return mix(u_vvColors[i-1], u_vvColors[i], f);\n    }\n  }\n  return u_vvColors[VV_COLOR_N - 1];\n}\n#endif\nfloat getVVSize(in float size, in float vvSize)  {\n#ifdef VV_SIZE_MIN_MAX_VALUE\n  return getVVMinMaxSize(vvSize, size);\n#elif defined(VV_SIZE_SCALE_STOPS)\n  return u_vvSizeScaleStopsValue;\n#elif defined(VV_SIZE_FIELD_STOPS)\n  float outSize \x3d getVVStopsSize(vvSize, size);\n  return isNan(outSize) ? size : outSize;\n#elif defined(VV_SIZE_UNIT_VALUE)\n  return getVVUnitValue(vvSize, size);\n#else\n  return size;\n#endif\n}"},
raster:{bitmap:{"bitmap.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform highp vec2 u_coordScale;\n#include \x3cfiltering/bicubic.glsl\x3e\nvoid main() {\n#ifdef BICUBIC\n  vec4 color \x3d sampleBicubicBSpline(u_texture, v_texcoord, u_coordScale);\n#else\n  vec4 color \x3d texture2D(u_texture, v_texcoord);\n#endif\n  gl_FragColor \x3d vec4(color.rgb * color.a, color.a);\n}","bitmap.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos;\n  gl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},
common:{"common.glsl":"uniform sampler2D u_image;\nuniform int u_bandCount;\nuniform bool u_isFloatTexture;\nuniform bool u_flipY;\nuniform bool u_applyTransform;\nuniform float u_opacity;\nuniform int u_resampling;\n#include \x3craster/common/projection.glsl\x3e\nvec2 getPixelLocation(vec2 coords) {\n  vec2 targetLocation \x3d u_flipY ? vec2(coords.s, 1.0 - coords.t) : coords;\n  if (!u_applyTransform) {\n    return targetLocation;\n  }\n  return projectPixelLocation(targetLocation);\n}\nbool isOutside(vec2 coords){\n   if (coords.t\x3e1.00001 ||coords.t\x3c-0.00001 || coords.s\x3e1.00001 ||coords.s\x3c-0.00001) {\n     return true;\n   } else {\n     return false;\n   }\n}\nvec4 getPixel(vec2 pixelLocation) {\n  return texture2D(u_image, pixelLocation);\n}",
"contrastBrightness.glsl":"uniform float u_contrastOffset;\nuniform float u_brightnessOffset;\nvec4 adjustContrastBrightness(vec4 currentPixel, bool isFloat) {\n  vec4 pixelValue \x3d isFloat ? currentPixel * 255.0 : currentPixel;\n  float maxI \x3d 255.0;\n  float mid \x3d 128.0;\n  float c \x3d u_contrastOffset;\n  float b \x3d u_brightnessOffset;\n  vec4 v;\n  if (c \x3e 0.0 \x26\x26 c \x3c 100.0) {\n    v \x3d (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) / (2.0 * (100.0 - c)) + mid;\n  } else if (c \x3c\x3d 0.0 \x26\x26 c \x3e -100.0) {\n    v \x3d (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) * (100.0 + c) / 20000.0 + mid;\n  } else if (c \x3d\x3d 100.0) {\n    v \x3d (200.0 * pixelValue - 100.0 * maxI + (maxI + 1.0) * (100.0 - c) + 2.0 * maxI * b);\n    v \x3d (sign(v) + 1.0) / 2.0;\n  } else if (c \x3d\x3d -100.0) {\n    v \x3d vec4(mid, mid, mid, currentPixel.a);\n  }\n  return vec4(v.r / 255.0, v.g / 255.0, v.b / 255.0, currentPixel.a);\n}",
"projection.glsl":"uniform sampler2D u_transformGrid;\nuniform vec2 u_transformSpacing;\nuniform vec2 u_transformGridSize;\nuniform vec2 u_targetImageSize;\nuniform vec2 u_srcImageSize;\nvec2 projectPixelLocation(vec2 coords) {\n  vec2 index_image \x3d floor(coords * u_targetImageSize);\n  vec2 oneTransformPixel \x3d vec2(0.25 / u_transformGridSize.s, 1.0 / u_transformGridSize.t);\n  vec2 index_transform \x3d floor(index_image / u_transformSpacing) / u_transformGridSize;\n  vec2 pos \x3d fract((index_image + vec2(0.5, 0.5)) / u_transformSpacing);\n  vec2 srcLocation;\n  vec2 transform_location \x3d index_transform + oneTransformPixel * 0.5;\n  if (pos.s \x3c\x3d pos.t) {\n    vec4 ll_abc \x3d texture2D(u_transformGrid, vec2(transform_location.s, transform_location.t));\n    vec4 ll_def \x3d texture2D(u_transformGrid, vec2(transform_location.s + oneTransformPixel.s, transform_location.t));\n    srcLocation.s \x3d dot(ll_abc.rgb, vec3(pos, 1.0));\n    srcLocation.t \x3d dot(ll_def.rgb, vec3(pos, 1.0));\n  } else {\n    vec4 ur_abc \x3d texture2D(u_transformGrid, vec2(transform_location.s + 2.0 * oneTransformPixel.s, transform_location.t));\n    vec4 ur_def \x3d texture2D(u_transformGrid, vec2(transform_location.s + 3.0 * oneTransformPixel.s, transform_location.t));\n    srcLocation.s \x3d dot(ur_abc.rgb, vec3(pos, 1.0));\n    srcLocation.t \x3d dot(ur_def.rgb, vec3(pos, 1.0));\n  }\n  return srcLocation;\n}"},
lut:{"colorize.glsl":"uniform sampler2D u_colormap;\nuniform float u_colormapOffset;\nuniform float u_colormapMaxIndex;\nvec4 colorize(vec4 currentPixel, bool isFloat) {\n  float clrIndex \x3d isFloat ? currentPixel.r - u_colormapOffset : currentPixel.r * 255.0 - u_colormapOffset;\n  vec4 result;\n  if (currentPixel.a \x3d\x3d 0.0 || clrIndex \x3e u_colormapMaxIndex) {\n    result \x3d vec4(0.0, 0.0, 0.0, 0.0);\n  } else {\n    vec2 clrPosition \x3d vec2((clrIndex + 0.5) / (u_colormapMaxIndex + 1.0), 0.0);\n    vec4 color \x3d texture2D(u_colormap, clrPosition);\n    result \x3d vec4(color.rgb, color.a * u_opacity);\n  }\n  return result;\n}",
"lut.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\n#include \x3craster/lut/colorize.glsl\x3e\nvoid main() {\n  vec2 pixelLocation \x3d getPixelLocation(v_texcoord);\n  if (isOutside(pixelLocation)) {\n     gl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\n     return;\n  }\n  vec4 currentPixel \x3d getPixel(pixelLocation);\n  gl_FragColor \x3d colorize(currentPixel, true);\n}","lut.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos;\n  gl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},
stretch:{"stretch.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\nuniform float u_minCutOff[3];\nuniform float u_maxCutOff[3];\nuniform float u_minOutput;\nuniform float u_maxOutput;\nuniform float u_factor[3];\nuniform bool u_useGamma;\nuniform float u_gamma[3];\nuniform float u_gammaCorrection[3];\nuniform bool u_applyColormap;\n#include \x3craster/lut/colorize.glsl\x3e\nfloat stretchOneValue(float val, float minCutOff, float maxCutOff, float minOutput, float maxOutput, float factor, bool useGamma, float gamma, float gammaCorrection) {\n  if (val \x3e\x3d maxCutOff) {\n    return maxOutput;\n  } else if (val \x3c\x3d minCutOff) {\n    return minOutput;\n  }\n  float stretchedVal;\n  if (useGamma) {\n  \tfloat tempf \x3d 1.0;\n\t  float outRange \x3d maxOutput - minOutput;\n\t  float relativeVal \x3d (val - minCutOff) / (maxCutOff - minCutOff);\n\t  if (gamma \x3e 1.0) {\n      tempf -\x3d pow(1.0 / outRange, relativeVal * gammaCorrection);\n    }\n    stretchedVal \x3d floor(tempf * outRange * pow(relativeVal, 1.0 / gamma)) + minOutput;\n  } else {\n    stretchedVal \x3d minOutput + (val - minCutOff) * factor;\n  }\n  return stretchedVal;\n}\nvoid main() {\n  vec2 pixelLocation \x3d getPixelLocation(v_texcoord);\n  if (isOutside(pixelLocation)) {\n     gl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\n     return;\n  }\n  vec4 currentPixel \x3d getPixel(pixelLocation);\n  if (currentPixel.a \x3d\x3d 0.0) {\n    gl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\n    return;\n  }\n  if (u_bandCount \x3d\x3d 1) {\n    float grayVal \x3d stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\n    if (u_applyColormap) {\n      gl_FragColor \x3d colorize(vec4(grayVal, grayVal, grayVal, currentPixel.a), true);\n    } else {\n      gl_FragColor \x3d vec4(grayVal, grayVal, grayVal, currentPixel.a);\n    }\n  } else {\n    float redVal \x3d stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\n    float greenVal \x3d stretchOneValue(currentPixel.g, u_minCutOff[1], u_maxCutOff[1], u_minOutput, u_maxOutput, u_factor[1], u_useGamma, u_gamma[1], u_gammaCorrection[1]);\n    float blueVal \x3d stretchOneValue(currentPixel.b, u_minCutOff[2], u_maxCutOff[2], u_minOutput, u_maxOutput, u_factor[2], u_useGamma, u_gamma[2], u_gammaCorrection[2]);\n    gl_FragColor \x3d vec4(redVal, greenVal, blueVal, currentPixel.a);\n  }\n}",
"stretch.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos;\n  gl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"}},stencil:{"stencil.frag":"void main() {\n  gl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\n}","stencil.vert":"attribute vec2 a_pos;\nvoid main() {\n  gl_Position \x3d vec4(a_pos, 0.0, 1.0);\n}"},tileInfo:{"tileInfo.frag":"uniform mediump sampler2D u_texture;\nvarying mediump vec2 v_tex;\nvoid main(void) {\n  lowp vec4 color \x3d texture2D(u_texture, v_tex);\n  gl_FragColor \x3d 0.75 * color;\n}",
"tileInfo.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_coord_ratio;\nuniform mediump vec2 u_delta;\nuniform mediump vec2 u_dimensions;\nvarying mediump vec2 v_tex;\nvoid main() {\n  mediump vec2 offset \x3d u_coord_ratio * vec2(u_delta + a_pos * u_dimensions);\n  vec3 v_pos \x3d u_dvsMat3 * vec3(offset, 1.0);\n  gl_Position \x3d vec4(v_pos.xy, 0.0, 1.0);\n  v_tex \x3d a_pos;\n}"},util:{"encoding.glsl":"const vec4 rgba2float_factors \x3d vec4(\n    255.0 / (256.0),\n    255.0 / (256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n  );\nfloat rgba2float(vec4 rgba) {\n  return dot(rgba, rgba2float_factors);\n}"}}})},
"esri/views/2d/engine/webgl/shaders/TileInfoPrograms":function(){define(["require","exports","./sources/resolver"],function(g,b,l){Object.defineProperty(b,"__esModule",{value:!0});b.tileInfo={name:"tileInfo",shaders:{vertexShader:l.resolveIncludes("tileInfo/tileInfo.vert"),fragmentShader:l.resolveIncludes("tileInfo/tileInfo.frag")},attributes:{a_pos:0}}})},"esri/views/2d/engine/webgl/brushes/WGLBrushStencil":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ./WGLBrush ../shaders/BackgroundPrograms".split(" "),
function(g,b,l,k,f,a,q){Object.defineProperty(b,"__esModule",{value:!0});g=function(a){function d(){var c=null!==a&&a.apply(this,arguments)||this;c._color=k.vec4f32.fromValues(1,0,0,1);c._initialized=!1;return c}l(d,a);d.prototype.dispose=function(){this._solidProgram&&(this._solidProgram.dispose(),this._solidProgram=null);this._solidVertexArrayObject&&(this._solidVertexArrayObject.dispose(),this._solidVertexArrayObject=null)};d.prototype.prepareState=function(c,a){c=c.context;c.setDepthWriteEnabled(!1);
c.setDepthTestEnabled(!1);c.setStencilTestEnabled(!0);c.setBlendingEnabled(!1);c.setColorMask(!1,!1,!1,!1);c.setStencilOp(7680,7680,7681);c.setStencilWriteMask(255);c.setStencilFunctionSeparate(1032,516,a.stencilRef,255)};d.prototype.draw=function(c,a){c=c.context;this._initialized||this._initialize(c);c.bindVAO(this._solidVertexArrayObject);c.bindProgram(this._solidProgram);this._solidProgram.setUniformMatrix3fv("u_dvsMat3",a.transforms.dvs);this._solidProgram.setUniform2fv("u_coord_range",a.coordRange);
this._solidProgram.setUniform1f("u_depth",0);this._solidProgram.setUniform4fv("u_color",this._color);c.drawArrays(5,0,4);c.bindVAO()};d.prototype._initialize=function(c){if(this._initialized)return!0;var a=f.createProgram(c,q.background);if(!a)return!1;var d=new Int8Array([0,0,1,0,0,1,1,1]),d=f.BufferObject.createVertex(c,35044,d);c=new f.VertexArrayObject(c,q.background.attributes,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},{geometry:d});this._solidProgram=
a;this._solidVertexArrayObject=c;return this._initialized=!0};return d}(a.default);b.default=g})},"esri/views/2d/engine/RasterTile":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ./RasterBitmap ./webgl/TiledDisplayObject".split(" "),function(g,b,l,k,f,a){Object.defineProperty(b,"__esModule",{value:!0});g=function(a){function m(d,c,e,h){void 0===h&&(h=null);var p=a.call(this,d,c,e)||this;d=p.requestRender.bind(p);p.bitmap=new f.RasterBitmap(h,
null,null,d);p.bitmap.coordScale=e;p.bitmap.once("isReady",function(){return p.ready()});return p}l(m,a);Object.defineProperty(m.prototype,"stencilRef",{get:function(){return this.bitmap.stencilRef},set:function(a){this.bitmap.stencilRef=a},enumerable:!0,configurable:!0});m.prototype.setTransform=function(d,c){a.prototype.setTransform.call(this,d,c);this.bitmap.transforms.dvs=this.transforms.dvs};m.prototype.attach=function(){this.bitmap.stage=this.stage;var a=this.bitmap.attach();a&&(this.bitmap.attached=
!0);return a};m.prototype.detach=function(){this.bitmap.detach()};return m}(a.TiledDisplayObject);b.RasterTile=g})},"esri/views/2d/engine/RasterBitmap":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/assignHelper ../../../core/libs/gl-matrix-2/mat3 ../../../core/libs/gl-matrix-2/mat3f32 ../../../core/libs/gl-matrix-2/vec2f32 ../../../layers/support/rasterFunctions/pixelUtils ./DisplayObject ./webgl/WGLRasterUtils".split(" "),function(g,b,l,k,f,a,q,
m,d,c){function e(c){p.has(c)&&(h.splice(h.indexOf(c),1),p.delete(c))}Object.defineProperty(b,"__esModule",{value:!0});var h=[],p=new Set,n={bandCount:3,outMin:0,outMax:1,minCutOff:[0,0,0],maxCutOff:[255,255,255],factor:[1/255,1/255,1/255],useGamma:!1,gamma:[1,1,1],gammaCorrection:[1,1,1],colormap:null,colormapOffset:null,type:"stretch"};g=function(d){function h(c,e,h,n){void 0===c&&(c=null);void 0===e&&(e=null);void 0===h&&(h=null);void 0===n&&(n=function(){return null});var p=d.call(this)||this;
p.stencilRef=0;p.coordScale=[1,1];p._symbolizerParameters=null;p.height=null;p.pixelRatio=1;p.resolution=0;p.rotation=0;p._source=null;p.rawPixelBlock=null;p._suspended=!1;p._bandIds=null;p._interpolation=null;p._transformGrid=null;p.width=null;p.x=0;p.y=0;p.transforms={dvs:a.mat3f32.create()};p.source=c;p.transformGrid=e;p.interpolation=h;p.requestRender=n;return p}l(h,d);Object.defineProperty(h.prototype,"symbolizerParameters",{get:function(){return this._symbolizerParameters||n},set:function(c){this._symbolizerParameters=
c},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"source",{get:function(){return this._source},set:function(c){this._source=c;this._rasterTexture&&(this._rasterTexture.dispose(),this._rasterTexture=null)},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"suspended",{get:function(){return this._suspended},set:function(c){this._suspended&&!c&&this.attached&&(this.ready(),this.requestRender());this._suspended=c},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,
"bandIds",{get:function(){return this._bandIds},set:function(c){this.attached&&this._updateRasterTexture(c);this._bandIds=c},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"interpolation",{get:function(){return this._interpolation},set:function(c){this._interpolation=c;this._rasterTexture&&this._rasterTexture.setSamplingMode("bilinear"===c?9729:9728)},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"transformGrid",{get:function(){return this._transformGrid},set:function(c){this._transformGrid=
c;this._transformGridTexture&&(this._transformGridTexture.dispose(),this._transformGridTexture=null)},enumerable:!0,configurable:!0});h.prototype.attach=function(){this.updateTexture();return!0};h.prototype.detach=function(){this._rasterTexture&&(this._rasterTexture.dispose(),this._rasterTexture=null);this._transformGridTexture&&(this._transformGridTexture.dispose(),this._transformGridTexture=null);this._colormapTexture&&(this._colormapTexture.dispose(),this._colormapTexture=null);e(this)};h.prototype.invalidateTexture=
function(){this.attached?this.updateTexture():e(this)};h.prototype.setTransform=function(c){var a=f.mat3.identity(this.transforms.dvs),e=c.toScreenNoRotation([0,0],this.x,this.y),d=this.resolution/this.pixelRatio/c.resolution,h=d*this.width,d=d*this.height,n=Math.PI*this.rotation/180;f.mat3.translate(a,a,q.vec2f32.fromValues(e[0],e[1]));f.mat3.translate(a,a,q.vec2f32.fromValues(h/2,d/2));f.mat3.rotate(a,a,-n);f.mat3.translate(a,a,q.vec2f32.fromValues(-h/2,-d/2));f.mat3.scaleByVec2(a,a,q.vec2f32.fromValues(h,
d));f.mat3.multiply(this.transforms.dvs,c.displayViewMat3,a)};h.prototype.updateTexture=function(){var a=this.stage.context,e=this.source,e=e&&e.pixels&&0<e.pixels.length;!this._rasterTexture&&e&&this._updateRasterTexture(this.bandIds);this._rasterTexture&&e&&(this._updateColormapTexture(),this.transformGrid&&!this._transformGridTexture&&(this._transformGridTexture=c.createTransformTexture(a,this.transformGrid)));this._rasterTexture&&!e&&this._rasterTexture.setData(null);this.suspended||(this.ready(),
this.requestRender())};h.prototype.getUniforms=function(){var c=this.source,a=this.transformGrid,e;switch(this.symbolizerParameters.type){case "lut":e=this._getColormapUniforms();break;case "stretch":e=this._getStretchUniforms()}c=k({},e,{u_srcImageSize:[c.width,c.height],u_resampling:"nearest",u_flipY:!0,u_applyTransform:a?!0:!1,u_dvsMat3:this.transforms.dvs});this.transformGrid&&(c.u_transformSpacing=a.spacing,c.u_transformGridSize=a.size,c.u_targetImageSize=new Float32Array([this.width,this.height]));
return c};h.prototype.getTextures=function(){if(!this._rasterTexture)return null;var c=[],a=[];this._transformGridTexture&&(a.push(this._transformGridTexture),c.push("u_transformGrid"));this._rasterTexture&&(a.push(this._rasterTexture),c.push("u_image"));this._colormapTexture&&(a.push(this._colormapTexture),c.push("u_colormap"));return{names:c,textures:a}};h.prototype._getColormapUniforms=function(){var c=this.symbolizerParameters;return{u_colormapOffset:c.colormapOffset||0,u_colormapMaxIndex:c.colormap.length/
4-1,u_isFloatTexture:!1}};h.prototype._getStretchUniforms=function(){var c=this.symbolizerParameters,a={u_bandCount:c.bandCount,u_minOutput:c.outMin,u_maxOutput:c.outMax,u_minCutOff:c.minCutOff,u_maxCutOff:c.maxCutOff,u_factor:c.factor,u_useGamma:c.useGamma,u_gamma:c.gamma,u_gammaCorrection:c.gammaCorrection,u_contrast:c.contrast,u_brightness:c.brightness};c.colormap&&(a.u_colormapOffset=c.colormapOffset||0,a.u_colormapMaxIndex=c.colormap.length/4-1,a.u_isFloatTexture=!1,a.u_applyColormap=!0);return a};
h.prototype._updateRasterTexture=function(a){var e=this.source?m.extractBands(this.source,a):null;if(e&&e.pixels&&0<e.pixels.length){a=null==a&&null==this.bandIds||a&&this.bandIds&&a.join("")===this.bandIds.join("");if(this._rasterTexture){if(a)return;this._rasterTexture.dispose();this._rasterTexture=null}this._rasterTexture=c.createRasterTexture(this.stage.context,e,this.interpolation||"nearest")}else this._rasterTexture&&(this._rasterTexture.dispose(),this._rasterTexture=null)};h.prototype._updateColormapTexture=
function(){var a=this._colormap,e=this.symbolizerParameters.colormap;if(e){var d=this.stage.context;if(!a)this._colormapTexture=c.createColormapTexture(d,e),this._colormap=e;else if(e.length!==a.length||e.some(function(c,e){return c!==a[e]}))this._colormapTexture&&(this._colormapTexture.dispose(),this._colormapTexture=null),this._colormapTexture=c.createColormapTexture(d,e),this._colormap=e}else this._colormapTexture&&(this._colormapTexture.dispose(),this._colormapTexture=null),this._colormap=null};
return h}(d.DisplayObject);b.RasterBitmap=g})},"esri/layers/support/rasterFunctions/pixelUtils":function(){define(["require","exports","../PixelBlock"],function(g,b,l){function k(a,d){a=Math.min(Math.max(a,-100),100);d=Math.min(Math.max(d,-100),100);var c,e,h=new Uint8Array(256);for(c=0;256>c;c++)0<a&&100>a?e=(200*c-25500+510*d)/(2*(100-a))+128:0>=a&&-100<a?e=(200*c-25500+510*d)*(100+a)/2E4+128:100===a?(e=200*c-25500+256*(100-a)+510*d,e=0<e?255:0):-100===a&&(e=128),h[c]=255<e?255:0>e?0:e;return h}
function f(a,d,c,e,h,p,n,b){return{xmin:h<=c*a?0:h<c*a+a?h-c*a:a,ymin:p<=e*d?0:p<e*d+d?p-e*d:d,xmax:h+n<=c*a?0:h+n<c*a+a?h+n-c*a:a,ymax:p+b<=e*d?0:p+b<e*d+d?p+b-e*d:d}}function a(a,d,c,e){var h=a.filter(function(c){return q(c)})[0];if(null==h)return null;var p=e?e.width:d.width;e=e?e.height:d.height;var n=h.width,b=h.height,m=d.width/n;d=d.height/b;var k=c?c.x:0;c=c?c.y:0;var t=h.pixelType,w=l.getPixelArrayConstructor(t),r=h.pixels.length,h=[],g,A,z,B,C,D,H,F,E,G;for(C=0;C<r;C++){A=new w(p*e);for(D=
0;D<d;D++)for(H=0;H<m;H++)if(z=a[D*m+H])for(g=z.pixels[C],G=f(n,b,H,D,k,c,p,e),F=G.ymin;F<G.ymax;F++)for(z=(D*b+F-c)*p+(H*n-k),B=F*n,E=G.xmin;E<G.xmax;E++)A[z+E]=g[B+E];h.push(A)}var J;if(a.some(function(c){return null==c||c.mask&&0<c.mask.length}))for(J=new Uint8Array(p*e),D=0;D<d;D++)for(H=0;H<m;H++)if(w=(z=a[D*m+H])?z.mask:null,G=f(n,b,H,D,k,c,p,e),w)for(F=G.ymin;F<G.ymax;F++)for(z=(D*b+F-c)*p+(H*n-k),B=F*n,E=G.xmin;E<G.xmax;E++)J[z+E]=w[B+E];else if(z)for(F=G.ymin;F<G.ymax;F++)for(z=(D*b+F-c)*
p+(H*n-k),B=F*n,E=G.xmin;E<G.xmax;E++)J[z+E]=1;else for(F=G.ymin;F<G.ymax;F++)for(z=(D*b+F-c)*p+(H*n-k),B=F*n,E=G.xmin;E<G.xmax;E++)J[z+E]=0;a=new l({width:p,height:e,pixels:h,pixelType:t,mask:J});a.updateStatistics();return a}Object.defineProperty(b,"__esModule",{value:!0});var q=function(a){return a&&"esri.layers.support.PixelBlock"===a.declaredClass&&a.pixels&&0<a.pixels.length};b.extractBands=function(a,d){if(!d||!q(a))return a;var c=a.pixels.length;return d&&d.some(function(a){return a>=c})||
1===c&&1===d.length&&0===d[0]||c===d.length&&!d.some(function(c,a){return c!==a})?a:new l({pixelType:a.pixelType,width:a.width,height:a.height,mask:a.mask,validPixelCount:a.validPixelCount,maskIsAlpha:a.maskIsAlpha,pixels:d.map(function(c){return a.pixels[c]}),statistics:a.statistics&&d.map(function(c){return a.statistics[c]})})};b.createColormapLUT=function(a){if(a){var d=a.colormap;if(d&&0!==d.length){var d=d.sort(function(c,a){return c[0]-a[0]}),c=0;0>d[0][0]&&(c=d[0][0]);var e=Math.max(256,d[d.length-
1][0]-c+1),h=new Uint8Array(4*e),p=[],n=0,b=0,m=5===d[0].length;if(65536<e)return d.forEach(function(a){p[a[0]-c]=m?a.slice(1):a.slice(1).concat([255])}),{indexed2DColormap:p,offset:c,alphaSpecified:m};if(a.fillUnspecified)for(a=d[b],n=a[0]-c;n<e;n++)h[4*n]=a[1],h[4*n+1]=a[2],h[4*n+2]=a[3],h[4*n+3]=m?a[4]:255,n===a[0]-c&&(a=b===d.length-1?a:d[++b]);else for(n=0;n<d.length;n++)a=d[n],b=4*(a[0]-c),h[b]=a[1],h[b+1]=a[2],h[b+2]=a[3],h[b+3]=m?a[4]:255;return{indexedColormap:h,offset:c,alphaSpecified:m}}}};
b.colorize=function(a,d){if(!q(a)||!d&&(d.indexedColormap||d.indexed2DColormap))return a;var c=a.clone(),e=c.pixels,h=c.mask,p=c.width*c.height;if(1!==e.length)return a;var n=d.indexedColormap;a=d.indexed2DColormap;var b=d.offset;d=d.alphaSpecified;var m=n.length-1,f=0,e=e[0],t=new Uint8Array(e.length),w=new Uint8Array(e.length),r=new Uint8Array(e.length),k=0;if(n)if(h)for(f=0;f<p;f++)h[f]&&(k=4*(e[f]-b),k<b||k>m?h[f]=0:(t[f]=n[k],w[f]=n[k+1],r[f]=n[k+2],h[f]=n[k+3]));else{h=new Uint8Array(p);for(f=
0;f<p;f++)k=4*(e[f]-b),k<b||k>m?h[f]=0:(t[f]=n[k],w[f]=n[k+1],r[f]=n[k+2],h[f]=n[k+3]);c.mask=h}else if(h)for(f=0;f<p;f++)h[f]&&(n=a[e[f]],t[f]=n[0],w[f]=n[1],r[f]=n[2],h[f]=n[3]);else{h=new Uint8Array(p);for(f=0;f<p;f++)n=a[e[f]],t[f]=n[0],w[f]=n[1],r[f]=n[2],h[f]=n[3];c.mask=h}c.pixels=[t,w,r];c.statistics=null;c.pixelType="u8";c.maskIsAlpha=d;return c};b.estimateStatisticsHistograms=function(a){if(!q(a))return null;a.statistics||a.updateStatistics();var d=a.pixels,c=a.mask,e=a.pixelType,h=a.statistics;
a=a.width*a.height;var p=d.length,n,b,m,f,t,w=[],r=[],k,l,g;for(f=0;f<p;f++){k=new Uint32Array(256);g=d[f];if("u8"===e)if(n=-.5,b=255.5,c)for(t=0;t<a;t++)c[t]&&k[g[t]]++;else for(t=0;t<a;t++)k[g[t]]++;else{n=h[f].minValue;b=h[f].maxValue;m=(b-n)/256;l=new Uint32Array(257);if(c)for(t=0;t<a;t++)c[t]&&l[Math.floor((g[t]-n)/m)]++;else for(t=0;t<a;t++)l[Math.floor((g[t]-n)/m)]++;for(t=0;255>t;t++)k[t]=l[t];k[255]=l[255]+l[256]}w.push({min:n,max:b,size:256,counts:k});for(t=g=l=m=0;256>t;t++)m+=k[t],l+=
t*k[t];l/=m;for(t=0;256>t;t++)g+=k[t]*Math.pow(t-l,2);k=Math.sqrt(g/(m-1));m=(b-n)/256;t=(l+.5)*m+n;k*=m;r.push({min:n,max:b,avg:t,stddev:k})}return{statistics:r,histograms:w}};b.createStretchLUT=function(a){var d=a.minCutOff,c=a.maxCutOff,e=a.gamma,h=a.pixelType,p=a.outMin||0,n=a.outMax||255;if(-1===["u8","u16","s8","s16"].indexOf(h))return null;var b=d.length,m,f=0;"s8"===h?f=-127:"s16"===h&&(f=-32767);var q=256;-1<["u16","s16"].indexOf(h)&&(q=65536);for(var w=[],r=n-p,h=0;h<b;h++)w[h]=c[h]-d[h];
m=e&&e.length>=b;var l=[];if(m)for(h=0;h<b;h++)l[h]=1<e[h]?2<e[h]?6.5+Math.pow(e[h]-2,2.5):6.5+100*Math.pow(2-e[h],4):1;var g,z=[],B,C,D;if(m)for(h=0;h<b;h++){D=[];for(m=0;m<q;m++)B=m+f,g=(B-d[h])/w[h],C=1,1<e[h]&&(C-=Math.pow(1/r,g*l[h])),D[m]=B<c[h]&&B>d[h]?Math.floor(C*r*Math.pow(g,1/e[h]))+p:B>=c[h]?n:p;z[h]=D}else for(h=0;h<b;h++){D=[];for(m=0;m<q;m++)B=m+f,D[m]=B<=d[h]?p:B>=c[h]?n:Math.floor((B-d[h])/w[h]*r)+p;z[h]=D}if(null!=a.contrastOffset)for(a=k(a.contrastOffset,a.brightnessOffset),h=0;h<
b;h++)for(D=z[h],m=0;m<q;m++)D[m]=a[D[m]];return{lut:z,offset:f}};b.createContrastBrightnessLUT=k;b.stretch=function(a,d){if(!q(a))return null;a=a.clone();var c=a.pixels,e=a.mask,h=d.minCutOff,p=d.maxCutOff,n=d.gamma,b=d.outMin||0;d=d.outMax||255;var m=a.width*a.height,f=c.length,t,k,r,l,g,z=d-b,B=[];for(t=0;t<f;t++)B[t]=p[t]-h[t];k=n&&n.length>=f;var C=[];if(k)for(t=0;t<f;t++)C[t]=1<n[t]?2<n[t]?6.5+Math.pow(n[t]-2,2.5):6.5+100*Math.pow(2-n[t],4):1;if(k)if(null!=e)for(k=0;k<m;k++){if(e[k])for(t=0;t<
f;t++)r=c[t][k],g=(r-h[t])/B[t],l=1,1<n[t]&&(l-=Math.pow(1/z,g*C[t])),c[t][k]=r<p[t]&&r>h[t]?Math.floor(l*z*Math.pow(g,1/n[t]))+b:r>=p[t]?d:b}else for(k=0;k<m;k++)for(t=0;t<f;t++)r=c[t][k],g=(r-h[t])/B[t],l=1,1<n[t]&&(l-=Math.pow(1/z,g*C[t])),c[t][k]=r<p[t]&&r>h[t]?Math.floor(l*z*Math.pow(g,1/n[t]))+b:r>=p[t]?d:b;else if(null!=e)for(k=0;k<m;k++){if(e[k])for(t=0;t<f;t++)r=c[t][k],c[t][k]=r<p[t]&&r>h[t]?Math.floor((r-h[t])/B[t]*z)+b:r>=p[t]?d:b}else for(k=0;k<m;k++)for(t=0;t<f;t++)r=c[t][k],c[t][k]=
r<p[t]&&r>h[t]?Math.floor((r-h[t])/B[t]*z)+b:r>=p[t]?d:b;a.pixelType="u8";a.updateStatistics();return a};b.lookupPixels=function(a,d){if(!q(a))return null;var c=a.pixels,e=a.mask,h=a.width*a.height,p=c.length,n=d.lut;d=d.offset;var b,m;n&&1===n[0].length&&(n=c.map(function(){return n}));var f=[],t,k,r;if(d)if(null==e)for(b=0;b<p;b++){t=c[b];k=n[b];r=new Uint8Array(h);for(m=0;m<h;m++)r[m]=k[t[m]-d];f.push(r)}else for(b=0;b<p;b++){t=c[b];k=n[b];r=new Uint8Array(h);for(m=0;m<h;m++)e[m]&&(r[m]=k[t[m]-
d]);f.push(r)}else if(null==e)for(b=0;b<p;b++){t=c[b];k=n[b];r=new Uint8Array(h);for(m=0;m<h;m++)r[m]=k[t[m]];f.push(r)}else for(b=0;b<p;b++){t=c[b];k=n[b];r=new Uint8Array(h);for(m=0;m<h;m++)e[m]&&(r[m]=k[t[m]]);f.push(r)}a=new l({width:a.width,height:a.height,pixels:f,mask:e,pixelType:"u8"});a.updateStatistics();return a};b.remapColor=function(a,d){if(!q(a))return null;a=a.clone();var c=a.width*a.height,e=d.length,h=Math.floor(e/2),p=d[Math.floor(h)],n=a.pixels[0],b,m,f,t,k,r,l=!1,g=new Uint8Array(c),
z=new Uint8Array(c),B=new Uint8Array(c),C=a.mask,D=4===d[0].mappedColor.length;C||(C=new Uint8Array(c),C.fill(D?255:1),a.mask=C);for(k=0;k<c;k++)if(C[k]){b=n[k];l=!1;r=h;m=p;f=0;for(t=e-1;1<t-f;){if(b===m.value){l=!0;break}b>m.value?f=r:t=r;r=Math.floor((f+t)/2);m=d[Math.floor(r)]}l||(b===d[f].value?(m=d[f],l=!0):b===d[t].value?(m=d[t],l=!0):b<d[f].value?(l=!1,m=null):b>d[f].value&&(b<d[t].value?(m=d[f],l=!0):t===e-1?(l=!1,m=null):(m=d[t],l=!0)));l?(g[k]=m.mappedColor[0],z[k]=m.mappedColor[1],B[k]=
m.mappedColor[2],C[k]=m.mappedColor[3]):g[k]=z[k]=B[k]=C[k]=0}a.pixels=[g,z,B];a.mask=C;a.pixelType="u8";a.maskIsAlpha=D;return a};b.getClipBounds=f;b.mosaicPixelData=function(b,d){if(!b||0===b.length)return null;var c=b.filter(function(c){return c.pixelBlock})[0];if(!c)return null;var e=(c.extent.xmax-c.extent.xmin)/c.pixelBlock.width,h=(c.extent.ymax-c.extent.ymin)/c.pixelBlock.height,p=.01*Math.min(e,h),n=b.sort(function(c,a){return Math.abs(c.extent.ymax-a.extent.ymax)>p?a.extent.ymax-c.extent.ymax:
Math.abs(c.extent.xmin-a.extent.xmin)>p?c.extent.xmin-a.extent.xmin:0}),m=Math.min.apply(null,n.map(function(c){return c.extent.xmin})),f=Math.min.apply(null,n.map(function(c){return c.extent.ymin})),q=Math.max.apply(null,n.map(function(c){return c.extent.xmax})),t=Math.max.apply(null,n.map(function(c){return c.extent.ymax}));b={x:Math.round((d.xmin-m)/e),y:Math.round((t-d.ymax)/h)};m={width:Math.round((q-m)/e),height:Math.round((t-f)/h)};e={width:Math.round((d.xmax-d.xmin)/e),height:Math.round((d.ymax-
d.ymin)/h)};if(Math.round(m.width/c.pixelBlock.width)*Math.round(m.height/c.pixelBlock.height)!==n.length||0>b.x||0>b.y||m.width<e.width||m.height<e.height)return null;c=n.map(function(c){return c.pixelBlock});c=a(c,m,b,e);return{extent:d,pixelBlock:c}};b.mosaic=a;b.setValidBoundary=function(a,d,c){if(!q(a))return null;var e=a.width,h=a.height,p=d.x;d=d.y;var n=c.width+p;c=c.height+d;if(0>p||0>d||n>e||c>h||0===p&&0===d&&n===e&&c===h)return a;a.mask||(a.mask=new Uint8Array(e*h));for(var b=a.mask,m=
0;m<h;m++)for(var f=m*e,t=0;t<e;t++)b[f+t]=m<d||m>=c||t<p||t>=n?0:1;a.updateStatistics();return a};b.clip=function(a,d,c){if(!q(a))return null;var e=d.x,h=d.y,p=d.x+c.width;d=d.x+c.height;if(d===a.height&&p===a.width)return a;for(var n=a.pixels,b=a.mask,m=a.width,f=m*a.height,t=n.length,k=[],r=0;r<t;r++){for(var g=n[r],A=l.createEmptyBand(a.pixelType,f),z=0,B=h;B<=d;B++)for(var C=B*m,D=e;D<=p;D++)A[z++]=g[C+D];k.push(A)}var H;if(b)for(H=new Uint8Array(c.width*c.height),z=0,B=h;B<=d;B++)for(C=B*m,
D=e;D<=p;D++)H[z++]=b[C+D];a=new l({width:c.width,height:c.height,pixels:k,mask:H});a.updateStatistics();return a};b.approximateTransform=function(a,d,c,e){if(!q(a))return null;var h=a.pixels,p=a.mask,n=a.pixelType,b=a.width,m=a.height;a=l.getPixelArrayConstructor(n);var f=h.length,t=d.width,k=d.height;d=e.cols;var r=e.rows,g=Math.ceil(t/d),A=Math.ceil(k/r),z=!1;for(e=0;e<c.length;e+=3)-1===c[e]&&-1===c[e+1]&&-1===c[e+2]&&(z=!0);var B,C,D,H,F,E,G,J=new Float32Array(t*k),K=new Float32Array(t*k),I=
0,N,M;for(e=0;e<A;e++)for(var L=0;L<g;L++){B=12*(e*g+L);C=c[B];D=c[B+1];H=c[B+2];F=c[B+3];E=c[B+4];G=c[B+5];for(var Q=0;Q<r;Q++){I=(e*r+Q)*t+L*d;M=(Q+.5)/r;for(var O=0;O<Q;O++)N=(O+.5)/d,J[I+O]=Math.round((C*N+D*M+H)*b-.5),K[I+O]=Math.round((F*N+E*M+G)*m-.5)}B+=6;C=c[B];D=c[B+1];H=c[B+2];F=c[B+3];E=c[B+4];G=c[B+5];for(Q=0;Q<r;Q++)for(I=(e*r+Q)*t+L*d,M=(Q+.5)/r,O=Q;O<d;O++)N=(O+.5)/d,J[I+O]=Math.round((C*N+D*M+H)*b-.5),K[I+O]=Math.round((F*N+E*M+G)*m-.5)}c=function(a,c){for(var e=0;e<k;e++){B=e*t;
for(var d=0;d<t;d++)a[B]=z&&(0>J[B]||0>K[B])?0:c[J[B]+K[B]*b],B++}};m=[];for(e=0;e<f;e++)d=new a(t*k),c(d,h[e]),m.push(d);h=new l({width:t,height:k,pixelType:n,pixels:m});if(p)h.mask=new Uint8Array(t*k),c(h.mask,p);else if(z)for(h.mask=new Uint8Array(t*k),e=0;e<t*k;e++)h.mask[e]=0>J[e]||0>K[e]?0:1;h.updateStatistics();return h}})},"esri/layers/support/PixelBlock":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/compilerUtils ../../core/Error ../../core/JSONSupport ../../core/lang ../../core/Logger ../../core/accessorSupport/decorators".split(" "),
function(g,b,l,k,f,a,q,m,d,c){var e=d.getLogger("esri.layers.support.PixelBlock");return function(d){function h(a){a=d.call(this,a)||this;a.width=null;a.height=null;a.pixelType="f32";a.validPixelCount=null;a.mask=null;a.maskIsAlpha=!1;a.pixels=null;a.statistics=null;return a}l(h,d);n=h;h.createEmptyBand=function(a,c){return new (n.getPixelArrayConstructor(a))(c)};h.getPixelArrayConstructor=function(a){var c;switch(a){case "u1":case "u2":case "u4":case "u8":c=Uint8Array;break;case "u16":c=Uint16Array;
break;case "u32":c=Uint32Array;break;case "s8":c=Int8Array;break;case "s16":c=Int16Array;break;case "s32":c=Int32Array;break;case "u32":c=Uint32Array;break;case "f32":c=Float32Array;break;case "f64":c=Float64Array;break;case "c64":case "c128":case "unknown":c=Float32Array;break;default:f.neverReached(a)}return c};h.prototype.castPixelType=function(a){if(!a)return"f32";a=a.toLowerCase();-1<["u1","u2","u4"].indexOf(a)?a="u8":-1==="unknown u8 s8 u16 s16 u32 s32 f32 f64".split(" ").indexOf(a)&&(a="f32");
return a};h.prototype.getPlaneCount=function(){return this.pixels&&this.pixels.length};h.prototype.addData=function(c){if(!c.pixels||c.pixels.length!==this.width*this.height)throw new a("pixelblock:invalid-or-missing-pixels","add data requires valid pixels array that has same length defined by pixel block width * height");this.pixels||(this.pixels=[]);this.statistics||(this.statistics=[]);this.pixels.push(c.pixels);this.statistics.push(c.statistics||{minValue:null,maxValue:null})};h.prototype.getAsRGBA=
function(){var a=new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case "s8":case "s16":case "u16":case "s32":case "u32":case "f32":case "f64":this._fillFromNon8Bit(a);break;default:this._fillFrom8Bit(a)}return new Uint8ClampedArray(a)};h.prototype.getAsRGBAFloat=function(){var a=new Float32Array(this.width*this.height*4);this._fillFrom32Bit(a);return a};h.prototype.updateStatistics=function(){var a=this;this.statistics=this.pixels.map(function(c){return a._calculateBandStatistics(c,
a.mask)});var c=this.mask,e=0;if(c)for(var d=0;d<c.length;d++)c[d]&&e++;else e=this.width*this.height;this.validPixelCount=e};h.prototype.clamp=function(a){if(a&&"f64"!==a&&"f32"!==a){var c;switch(a){case "u8":c=[0,255];break;case "u16":c=[0,65535];break;case "u32":c=[0,4294967295];break;case "s8":c=[-128,127];break;case "s16":c=[-32768,32767];break;case "s32":c=[-2147483648,2147483647];break;default:c=[-3.4*1E39,3.4*1E39]}var e=c[0];c=c[1];for(var d=this.pixels,h=this.width*this.height,p=d.length,
b,m,f,q=[],k=0;k<p;k++){f=n.createEmptyBand(a,h);b=d[k];for(var u=0;u<h;u++)m=b[u],f[u]=m>c?c:m<e?e:m;q.push(f)}this.pixels=q;this.pixelType=a}};h.prototype.clone=function(){var a=new n({width:this.width,height:this.height,pixelType:this.pixelType,maskIsAlpha:this.maskIsAlpha,validPixelCount:this.validPixelCount});this.mask&&(a.mask=this.mask instanceof Uint8Array?new Uint8Array(this.mask):this.mask.slice(0));var c,e=n.getPixelArrayConstructor(this.pixelType);if(this.pixels&&0<this.pixels.length){a.pixels=
[];var d=this.pixels[0].slice;for(c=0;c<this.pixels.length;c++)a.pixels[c]=d?this.pixels[c].slice(0,this.pixels[c].length):new e(this.pixels[c])}if(this.statistics)for(a.statistics=[],c=0;c<this.statistics.length;c++)a.statistics[c]=m.clone(this.statistics[c]);return a};h.prototype._fillFrom8Bit=function(a){var c=this.mask,d=this.maskIsAlpha,h=this.pixels;if(a&&h&&h.length){var n,p,b;n=p=b=h[0];3<=h.length?(p=h[1],b=h[2]):2===h.length&&(p=h[1]);a=new Uint32Array(a);h=this.width*this.height;if(n.length!==
h)e.error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");else if(c&&c.length===h)if(d)for(d=0;d<h;d++)c[d]&&(a[d]=c[d]<<24|b[d]<<16|p[d]<<8|n[d]);else for(d=0;d<h;d++)c[d]&&(a[d]=-16777216|b[d]<<16|p[d]<<8|n[d]);else for(d=0;d<h;d++)a[d]=-16777216|b[d]<<16|p[d]<<8|n[d]}else e.error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")};h.prototype._fillFromNon8Bit=function(a){var c=this.pixels,d=this.mask,h=this.statistics;if(a&&c&&c.length){var n=this.pixelType,
p=1,b=0,p=1;h&&0<h.length?(b=h.map(function(c){return c.minValue}).reduce(function(c,a){return Math.min(c,a)}),p=h.map(function(c){return c.maxValue-c.minValue}).reduce(function(c,a){return Math.max(c,a)}),p=255/p):(p=255,"s8"===n?(b=-128,p=127):"u16"===n?p=65535:"s16"===n?(b=-32768,p=32767):"u32"===n?p=4294967295:"s32"===n?(b=-2147483648,p=2147483647):"f32"===n?(b=-3.4*1E39,p=3.4*1E39):"f64"===n&&(b=-Number.MAX_VALUE,p=Number.MAX_VALUE),p=255/(p-b));a=new Uint32Array(a);var n=this.width*this.height,
m,f,h=m=f=c[0];if(h.length!==n)return e.error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");if(2<=c.length)if(m=c[1],3<=c.length&&(f=c[2]),d&&d.length===n)for(c=0;c<n;c++)d[c]&&(a[c]=-16777216|(f[c]-b)*p<<16|(m[c]-b)*p<<8|(h[c]-b)*p);else for(c=0;c<n;c++)a[c]=-16777216|(f[c]-b)*p<<16|(m[c]-b)*p<<8|(h[c]-b)*p;else if(d&&d.length===n)for(c=0;c<n;c++)m=(h[c]-b)*p,d[c]&&(a[c]=-16777216|m<<16|m<<8|m);else for(c=0;c<n;c++)m=(h[c]-b)*p,a[c]=-16777216|m<<16|m<<8|m}else e.error("getAsRGBA()",
"Unable to convert to RGBA. The input pixel block is empty.")};h.prototype._fillFrom32Bit=function(c){var a=this.pixels,d=this.mask;if(!c||!a||!a.length)return e.error("getAsRGBAFloat()","Unable to convert to RGBA. The input pixel block is empty.");var h,n,p;h=n=p=a[0];3<=a.length?(n=a[1],p=a[2]):2===a.length&&(n=a[1]);var b=this.width*this.height;if(h.length!==b)return e.error("getAsRGBAFloat()","Unable to convert to RGBA. The pixelblock is invalid.");var m=0;if(d&&d.length===b)for(a=0;a<b;a++)c[m++]=
h[a],c[m++]=n[a],c[m++]=p[a],c[m++]=d[a]&1;else for(a=0;a<b;a++)c[m++]=h[a],c[m++]=n[a],c[m++]=p[a],c[m++]=1};h.prototype._calculateBandStatistics=function(c,a){var e=Infinity,d=-Infinity,h=c.length,n,p=0;if(a)for(n=0;n<h;n++)a[n]&&(p=c[n],e=p<e?p:e,d=p>d?p:d);else for(n=0;n<h;n++)p=c[n],e=p<e?p:e,d=p>d?p:d;return{minValue:e,maxValue:d}};var n;k([c.property({json:{write:!0}})],h.prototype,"width",void 0);k([c.property({json:{write:!0}})],h.prototype,"height",void 0);k([c.property({json:{write:!0}})],
h.prototype,"pixelType",void 0);k([c.cast("pixelType")],h.prototype,"castPixelType",null);k([c.property({json:{write:!0}})],h.prototype,"validPixelCount",void 0);k([c.property({json:{write:!0}})],h.prototype,"mask",void 0);k([c.property({json:{write:!0}})],h.prototype,"maskIsAlpha",void 0);k([c.property({json:{write:!0}})],h.prototype,"pixels",void 0);k([c.property({json:{write:!0}})],h.prototype,"statistics",void 0);return h=n=k([c.subclass("esri.layers.support.PixelBlock")],h)}(c.declared(q.JSONSupport))})},
"esri/views/2d/engine/webgl/WGLRasterUtils":function(){define(["require","exports","../../../webgl"],function(g,b,l){Object.defineProperty(b,"__esModule",{value:!0});b.createRasterTexture=function(b,f,a,q){void 0===a&&(a="nearest");void 0===q&&(q=!1);var m=!(q&&"u8"===f.pixelType);q=m?5126:5121;m=null==f.pixels||0===f.pixels.length?null:m?f.getAsRGBAFloat():f.getAsRGBA();return new l.Texture(b,{width:f.width,height:f.height,target:3553,pixelFormat:6408,internalFormat:6408,samplingMode:"bilinear"===
a?9729:9728,dataType:q,wrapMode:33071,flipped:!1},m)};b.createFrameBuffer=function(b,f,a,q){q=new l.Texture(b,{width:f,height:a,target:3553,pixelFormat:6408,internalFormat:6408,samplingMode:9728,dataType:q?5121:5126,wrapMode:33071,flipped:!1});return new l.FramebufferObject(b,{colorTarget:0,depthStencilTarget:3,width:f,height:a},q)};b.createTransformTexture=function(b,f){for(var a=4*f.size[0],q=f.size[1],m={width:a,height:q,target:3553,pixelFormat:6408,internalFormat:6408,dataType:5126,samplingMode:9728,
wrapMode:33071,flipped:!1},a=new Float32Array(a*q*4),d=q=0;d<f.coefficients.length;d++)a[q++]=f.coefficients[d],2===d%3&&(a[q++]=1);return new l.Texture(b,m,a)};b.createColormapTexture=function(b,f){return new l.Texture(b,{width:f.length/4,height:1,target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,flipped:!1},f)};b.getUniformInfos=function(b,f){b=b.gl;f=f.glName;for(var a=b.getProgramParameter(f,b.ACTIVE_UNIFORMS),q=new Map,m,d=0;d<a;d++)(m=b.getActiveUniform(f,
d))&&q.set(m.name,{location:b.getUniformLocation(f,m.name),info:m});return q};b.setUniforms=function(b,f,a,q){Object.keys(q).forEach(function(m){var d=a.get(m)||a.get(m+"[0]");if(d){var c=q[m];if(null!==d&&null!=c){var e=b.gl,d=d.info;switch(d.type){case e.FLOAT:1<d.size?f.setUniform1fv(m,c):f.setUniform1f(m,c);break;case e.FLOAT_VEC2:f.setUniform2fv(m,c);break;case e.FLOAT_VEC3:f.setUniform3fv(m,c);break;case e.FLOAT_VEC4:f.setUniform4fv(m,c);break;case e.FLOAT_MAT3:f.setUniformMatrix3fv(m,c);break;
case e.FLOAT_MAT4:f.setUniformMatrix4fv(m,c);break;case e.INT:case e.BOOL:1<d.size?f.setUniform1iv(m,c):f.setUniform1i(m,c);break;case e.INT_VEC2:case e.BOOL_VEC2:f.setUniform2iv(m,c);break;case e.INT_VEC3:case e.BOOL_VEC3:f.setUniform3iv(m,c);break;case e.INT_VEC4:case e.BOOL_VEC4:f.setUniform4iv(m,c)}}}})};b.setTextures=function(b,f,a,q){a.length===q.length&&(q.some(function(a){return null==a})||a.some(function(a){return null==a})||a.forEach(function(a,d){f.setUniform1i(a,d);b.bindTexture(q[d],
d)}))}})},"esri/views/2d/engine/RasterTileContainer":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../../../geometry/support/aaBoundingRect ../engine ./RasterTile ./webgl/enums ./webgl/TileContainer".split(" "),function(g,b,l,k,f,a,q,m,d){Object.defineProperty(b,"__esModule",{value:!0});g=function(c){function e(){return null!==c&&c.apply(this,arguments)||this}l(e,c);e.prototype.createTile=function(c){var a=this._tileInfoView.getTileBounds(f.create(),
c);return new q.RasterTile(c,a,this._tileInfoView.tileInfo.size)};e.prototype.destroyTile=function(){};e.prototype.prepareRenderPasses=function(e){var d=this,h=e.registerRenderPass({name:"bitmap (tile)",brushes:[a.brushes.Raster],target:function(){return d.children.map(function(c){return c.bitmap})},drawPhase:m.WGLDrawPhase.MAP});return c.prototype.prepareRenderPasses.call(this,e).concat([h])};e.prototype.doRender=function(a){this.visible&&a.drawPhase===m.WGLDrawPhase.MAP&&c.prototype.doRender.call(this,
a)};return e}(d.default);b.RasterTileContainer=g})},"esri/views/2d/engine/Stage":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/assignHelper ../../../core/Error ../../../core/events ../../../core/has ../../../core/promiseUtils ../../../core/scheduling ../../../core/watchUtils ../../../core/libs/gl-matrix-2/common ../../../core/libs/gl-matrix-2/mat2d ../../../core/libs/gl-matrix-2/mat2df64 ../../../core/libs/gl-matrix-2/vec2 ../../../core/libs/gl-matrix-2/vec2f64 ../../webgl ./Container ./webgl/BitBlitRenderer ./webgl/definitions ./webgl/enums ./webgl/Painter ./webgl/Profiler ./webgl/WebGLDriverTest ./webgl/shaders/StencilPrograms ../support/Timeline ../../support/screenshotUtils".split(" "),
function(g,b,l,k,f,a,q,m,d,c,e,h,p,n,u,x,v,t,w,r,y,A,z,B,C,D){Object.defineProperty(b,"__esModule",{value:!0});g=function(b){function k(c,e){var h=b.call(this)||this;h._renderParameters={drawPhase:0,state:h.state,pixelRatio:window.devicePixelRatio,stationary:!1,globalOpacity:1};h._clipData=new Float32Array(8);h._upperLeft=u.vec2f64.create();h._upperRight=u.vec2f64.create();h._lowerLeft=u.vec2f64.create();h._lowerRight=u.vec2f64.create();h._mat2=p.mat2df64.create();h._clipRendererInitialized=!1;h._supersampleScreenshots=
!0;h.dataUploadCounter=0;h.stage=h;h._stationary=!0;h.attached=!0;var n=e.canvas,n=void 0===n?document.createElement("canvas"):n,m=e.alpha,t=e.stencil,k=e.renderContext,r=e.supersampleScreenshots,r=void 0===r?!0:r,l=e.contextOptions,l=void 0===l?{}:l;h._canvas=n;m=x.createContextOrErrorHTML(n,{alpha:void 0===m?!0:m,antialias:!1,depth:!0,stencil:void 0===t?!0:t},void 0===k?"webgl":k);h.context=new x.RenderingContext(m,l);h.painter=new y.default(h.context,h);h._taskHandle=d.addFrameTask({render:function(){return h.renderFrame()}});
h._taskHandle.pause();h._supersampleScreenshots=r;h._lostWebGLContextHandle=a.on(n,"webglcontextlost",function(){h.emit("webgl-error",{error:new f("webgl-context-lost")})});q("esri-2d-profiler")&&(h._debugOutput=document.createElement("div"),h._debugOutput.setAttribute("style","margin: 24px 64px; position: absolute; color: red;"),c.appendChild(h._debugOutput));n.setAttribute("style","width: 100%; height:100%; display:block;");h.profiler=new A.Profiler(h.context,h._debugOutput);h.renderingOptions=
e.renderingOptions;h.timeline=e.timeline||new C.Timeline;h.driverTestResult=z.testWebGLDriver(h.context);c.appendChild(n);return h}l(k,b);k.prototype.destroy=function(){this.removeAllChildren();this.renderFrame();this._taskHandle.remove();this._boundFBO=this._taskHandle=null;this._clipFBO&&(this._clipFBO.dispose(),this._clipFBO=null);this._blitRenderer&&(this._blitRenderer.dispose(),this._blitRenderer=null);this._clipVAO&&(this._clipVAO.dispose(),this._clipVBO=this._clipVAO=null);this._clipStencilProgram&&
(this._clipStencilProgram.dispose(),this._clipStencilProgram=null);this._lostWebGLContextHandle&&(this._lostWebGLContextHandle.remove(),this._lostWebGLContextHandle=null);this._canvas.parentNode&&this._canvas.parentNode.removeChild(this._canvas);this._debugOutput&&this._debugOutput.parentNode&&this._debugOutput.parentNode.removeChild(this._debugOutput);this.painter.dispose();this.context.dispose();this._canvas=null};Object.defineProperty(k.prototype,"background",{get:function(){return this._background},
set:function(c){this._background=c;this.requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"highlightOptions",{get:function(){return this._highlightOptions},set:function(a){var e=this;this._highlightOptionsHandle&&(this._highlightOptionsHandle.remove(),this._highlightOptionsHandle=null);if(this._highlightOptions=a)this._highlightOptionsHandle=c.init(this._highlightOptions,"version",function(){e.painter.setHighlightOptions(a);e.requestRender()})},enumerable:!0,configurable:!0});
Object.defineProperty(k.prototype,"renderingOptions",{get:function(){return this._renderingOptions},set:function(c){this._renderingOptions=c;this.requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"state",{get:function(){return this._state},set:function(c){this._state=c;this.requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"stationary",{get:function(){return this._stationary},set:function(c){this._stationary!==c&&(this._stationary=
c,this.requestRender())},enumerable:!0,configurable:!0});k.prototype.requestRender=function(){this._lastRenderRequestTime=Date.now();this._taskHandle&&this._taskHandle.resume()};k.prototype.renderFrame=function(){Date.now()-this._lastRenderRequestTime>=w.MAX_ANIMATION_TIME_MS&&this._taskHandle.pause();this._renderParameters.state=this._state;this._renderParameters.stationary=this.stationary;this._renderParameters.pixelRatio=window.devicePixelRatio;this._renderParameters.globalOpacity=1;this.processRender(this._renderParameters)};
k.prototype.renderChildren=function(c){var a=this.context,e=this.children,e=c.children?c.children:e;this.profiler.recordStart("drawLayers");this.dataUploadCounter=0;this.beforeRenderChildren(c);c.drawPhase=r.WGLDrawPhase.MAP;this.painter.beforeRenderLayers(a);for(var d=0;d<e.length;d++){var h=e[d];h.attached&&h.processRender(c)}this.painter.renderLayers(a);c.drawPhase=r.WGLDrawPhase.LABEL;this.painter.beforeRenderLayers(a);for(d=0;d<e.length;d++)h=e[d],h.attached&&h.processRender(c);this.painter.renderLayers(a);
if(q("esri-tiles-debug")){c.drawPhase=r.WGLDrawPhase.DEBUG;this.painter.beforeRenderLayers(a);for(d=0;d<e.length;d++)h=e[d],h.attached&&h.processRender(c);this.painter.renderLayers(a)}this.profiler.recordEnd("drawLayers");this.afterRenderChildren()};k.prototype.beforeRenderChildren=function(c){var a=this.context,d=c.state,p=c.pixelRatio;if(this.painter){a.enforceState();var b=d.size;c=d.rotation;var m=Math.round(b[0]*p),b=Math.round(b[1]*p);this._boundFBO=a.getBoundFramebufferObject();if(d.spatialReference&&
(d.spatialReference._isWrappable?d.spatialReference._isWrappable():d.spatialReference.isWrappable)){var f=e.common.toRadian(c),q=Math.abs(Math.cos(f)),t=Math.abs(Math.sin(f)),k=Math.round(d.worldScreenWidth);if(Math.round(m*q+b*t)<=k)this._clipFrame=!1;else{this._clipFBO&&this._clipFBO.width===m&&this._clipFBO.height===b||(this._clipFBO=new x.FramebufferObject(a,{colorTarget:0,depthStencilTarget:3,width:m,height:b}));var r=(this.state.padding.left-this.state.padding.right)/2,u=(this.state.padding.bottom-
this.state.padding.top)/2,l=.5*m,w=.5*b,d=1/m,g=1/b,p=.5*k*p,v=.5*(m*t+b*q),m=this._upperLeft,q=this._upperRight,t=this._lowerLeft,k=this._lowerRight;n.vec2.set(m,-p,-v);n.vec2.set(q,p,-v);n.vec2.set(t,-p,v);n.vec2.set(k,p,v);h.mat2d.identity(this._mat2);h.mat2d.translate(this._mat2,this._mat2,[l+r,w+u]);0!==c&&h.mat2d.rotate(this._mat2,this._mat2,f);n.vec2.transformMat2d(m,m,this._mat2);n.vec2.transformMat2d(q,q,this._mat2);n.vec2.transformMat2d(t,t,this._mat2);n.vec2.transformMat2d(k,k,this._mat2);
c=this._clipData;c.set([2*t[0]*d-1,2*(b-t[1])*g-1,2*k[0]*d-1,2*(b-k[1])*g-1,2*m[0]*d-1,2*(b-m[1])*g-1,2*q[0]*d-1,2*(b-q[1])*g-1]);this._clipRendererInitialized||this._initializeClipRenderer(a);this._clipVBO.setData(c);this._boundFBO=a.getBoundFramebufferObject();a.bindFramebuffer(this._clipFBO);a.setDepthWriteEnabled(!0);a.setStencilWriteMask(255);a.setClearColor(0,0,0,0);a.setClearDepth(1);a.setClearStencil(0);a.clear(a.gl.COLOR_BUFFER_BIT|a.gl.DEPTH_BUFFER_BIT|a.gl.STENCIL_BUFFER_BIT);a.setDepthWriteEnabled(!1);
this._clipFrame=!0}}else this._clipFrame=!1}};k.prototype.afterRenderChildren=function(){var c=this.context;c.logIno();this._clipFrame&&this._clipRendererInitialized&&(c.bindFramebuffer(this._boundFBO),this._boundFBO=null,c.bindVAO(this._clipVAO),c.bindProgram(this._clipStencilProgram),c.setDepthWriteEnabled(!1),c.setDepthTestEnabled(!1),c.setStencilTestEnabled(!0),c.setBlendingEnabled(!1),c.setColorMask(!1,!1,!1,!1),c.setStencilOp(7680,7680,7681),c.setStencilWriteMask(255),c.setStencilFunction(519,
1,255),c.drawElements(4,6,5123,0),c.bindVAO(),c.setColorMask(!0,!0,!0,!0),c.setBlendingEnabled(!0),c.setStencilFunction(514,1,255),this._blitRenderer.render(c,this._clipFBO.colorTexture,9728,1),c.setStencilTestEnabled(!1))};k.prototype.doRender=function(c){var a=this.context,e=c.state,d=c.pixelRatio;this._resizeCanvas(c);this.context.enforceState();a.setViewport(0,0,d*e.size[0],d*e.size[1]);a.setDepthWriteEnabled(!0);a.setStencilWriteMask(255);this.background&&this.background.color?(e=this.background.color,
a.setClearColor(e.r/255,e.g/255,e.b/255,e.a)):a.setClearColor(0,0,0,0);a.setClearDepth(1);a.setClearStencil(0);a.clear(a.gl.COLOR_BUFFER_BIT|a.gl.DEPTH_BUFFER_BIT|a.gl.STENCIL_BUFFER_BIT);a.setDepthWriteEnabled(!1);b.prototype.doRender.call(this,c)};k.prototype.takeScreenshot=function(c,a){var e=D.screenshotSuperSampleSettings(c,this._supersampleScreenshots,this._state.padding),d=e.framebufferWidth,h=e.framebufferHeight,n=this.context,p=c.layers,b={drawPhase:null,globalOpacity:1,stationary:!0,state:this._renderParameters.state.clone(),
pixelRatio:e.pixelRatio};if(null!=c.rotation){var f=b.state.viewpoint;f.rotation=c.rotation;b.state.viewpoint=f}0<p.length&&(b.children=[],p.forEach(function(c){var e=a.find(function(a){return a.layer.id===c.id});e&&"container"in e&&e.container&&e.attached&&b.children.push(e.container)}));var q=new x.FramebufferObject(n,{colorTarget:0,depthStencilTarget:3,width:d,height:h}),p=n.getBoundFramebufferObject(),f=n.getViewport();n.bindFramebuffer(q);n.setViewport(0,0,d,h);d=n.gl;!c.ignoreBackground&&this.background&&
this.background.color?(h=this.background.color,n.setClearColor(h.r/255,h.g/255,h.b/255,h.a)):n.setClearColor(0,0,0,0);n.setClearDepth(1);n.setClearStencil(0);n.clear(d.COLOR_BUFFER_BIT|d.DEPTH_BUFFER_BIT|d.STENCIL_BUFFER_BIT);this.renderChildren(b);e=this._readbackScreenshot(e);n.bindFramebuffer(p);n.setViewport(f.x,f.y,f.width,f.height);this.requestRender();n=this._ensureScreenshotEncodeCanvas();c=D.encodeResult(e,c,n,{flipY:!0,premultipliedAlpha:!0});return m.resolve(c)};k.prototype._ensureScreenshotEncodeCanvas=
function(){this._screenshotEncodeCanvas||(this._screenshotEncodeCanvas=document.createElement("canvas"));return this._screenshotEncodeCanvas};k.prototype._readbackScreenshot=function(c){var a=c.framebufferWidth,e=c.framebufferHeight,d=c.region;c=c.resample;var h=this.context.gl;if(c){var n=D.createEmptyImageData(a,e,this._ensureScreenshotEncodeCanvas());h.readPixels(0,0,a,e,6408,5121,new Uint8Array(n.data.buffer));a=D.createEmptyImageData(d.width,d.height,this._ensureScreenshotEncodeCanvas());return D.resampleHermite(n,
a,!0,c.region.x,e-(c.region.y+c.region.height),c.region.width,c.region.height)}n=D.createEmptyImageData(d.width,d.height,this._ensureScreenshotEncodeCanvas());h.readPixels(d.x,e-(d.y+d.height),d.width,d.height,6408,5121,new Uint8Array(n.data.buffer));return n};k.prototype._resizeCanvas=function(c){var a=this._canvas,e=a.style,d=c.state.size,h=c.pixelRatio;c=d[0];var d=d[1],n=Math.round(c*h),h=Math.round(d*h);if(a.width!==n||a.height!==h)a.width=n,a.height=h;e.width=c+"px";e.height=d+"px"};k.prototype._initializeClipRenderer=
function(c){if(this._clipRendererInitialized)return!0;this._blitRenderer=new t.BitBlitRenderer;var a=B.stencil.attributes,e=x.createProgram(c,B.stencil);if(!e)return!1;var d=x.BufferObject.createVertex(c,35040,32),h=new Uint16Array([0,1,2,2,1,3]),h=x.BufferObject.createIndex(c,35044,h);c=new x.VertexArrayObject(c,a,{geometry:[{name:"a_pos",count:2,type:5126,offset:0,stride:8,normalized:!1,divisor:0}]},{geometry:d},h);this._clipStencilProgram=e;this._clipVBO=d;this._clipVAO=c;return this._clipRendererInitialized=
!0};return k}(v.Container);b.Stage=g})},"esri/views/2d/engine/webgl/BitBlitRenderer":function(){define(["require","exports","../../../webgl","./shaders/BitBlitPrograms"],function(g,b,l,k){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(){this._initialized=!1}b.prototype.dispose=function(){this._program&&(this._program.dispose(),this._program=null);this._vertexArrayObject&&(this._vertexArrayObject.dispose(),this._vertexArrayObject=null)};b.prototype.render=function(a,b,m,d){a&&
(this._initialized||this._initialize(a),a.setBlendFunctionSeparate(1,771,1,771),a.bindVAO(this._vertexArrayObject),a.bindProgram(this._program),b.setSamplingMode(m),a.bindTexture(b,0),this._program.setUniform1i("u_tex",0),this._program.setUniform1f("u_opacity",d),a.drawArrays(5,0,4),a.bindTexture(null,0),a.bindVAO())};b.prototype._initialize=function(a){if(this._initialized)return!0;var b=k.bitBlit.attributes,m=l.createProgram(a,k.bitBlit);if(!m)return!1;var d=new Int8Array(16);d[0]=-1;d[1]=-1;d[2]=
0;d[3]=0;d[4]=1;d[5]=-1;d[6]=1;d[7]=0;d[8]=-1;d[9]=1;d[10]=0;d[11]=1;d[12]=1;d[13]=1;d[14]=1;d[15]=1;a=new l.VertexArrayObject(a,b,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:4,normalized:!1,divisor:0},{name:"a_tex",count:2,type:5120,offset:2,stride:4,normalized:!1,divisor:0}]},{geometry:l.BufferObject.createVertex(a,35044,d)});this._program=m;this._vertexArrayObject=a;return this._initialized=!0};return b}();b.BitBlitRenderer=g})},"esri/views/2d/engine/webgl/shaders/BitBlitPrograms":function(){define(["require",
"exports","./sources/resolver"],function(g,b,l){Object.defineProperty(b,"__esModule",{value:!0});b.bitBlit={name:"bitBlit",shaders:{vertexShader:l.resolveIncludes("bitBlit/bitBlit.vert"),fragmentShader:l.resolveIncludes("bitBlit/bitBlit.frag")},attributes:{a_pos:0,a_tex:1}}})},"esri/views/2d/engine/webgl/definitions":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});b.WEBGL_MAX_STOPS=8;b.WEBGL_MAX_INNER_STOPS=b.WEBGL_MAX_STOPS-2;b.NAN_MAGIC_NUMBER=
1E-30;b.EXTRUDE_SCALE=64;b.PICTURE_FILL_COLOR=4294967295;b.TILE_SIZE=512;b.RASTER_TILE_SIZE=256;b.ANGLE_FACTOR_256=256/360;b.DEBUG_LABELS=!1;b.COLLISION_BUCKET_SIZE=128;b.DOT_DENSITY_MAX_FIELDS=8;b.MAGIC_LABEL_LINE_HEIGHT=29;b.COLLISION_MAX_ZOOM_DELTA=1;b.COLLISION_EARLY_REJECT_BUCKET_SIZE=16;b.COLLISION_BOX_PADDING=16;b.COLLISION_TILE_BOX_SIZE=b.TILE_SIZE/b.COLLISION_BUCKET_SIZE;b.COLLISION_PLACEMENT_PADDING=8;b.HEURISTIC_GLYPHS_PER_LINE=50;b.HEURISTIC_GLYPHS_PER_FEATURE=10;b.GLYPH_SIZE=24;b.TEXT_PLACEMENT_PADDING=
8;b.AVERAGE_GLYPH_MOSAIC_ITEM={metrics:{width:15,height:17,left:0,top:-7,advance:14}};b.ATTRIBUTE_STORE_TEXTURE_SIZE=1024;b.TEXTURE_BINDING_SPRITE_ATLAS=0;b.TEXTURE_BINDING_GLYPH_ATLAS=0;b.TEXTURE_BINDING_BITMAP=0;b.TEXTURE_BINDING_ATTRIBUTE_DATA_0=1;b.TEXTURE_BINDING_ATTRIBUTE_DATA_1=2;b.TEXTURE_BINDING_ATTRIBUTE_DATA_2=3;b.TEXTURE_BINDING_ATTRIBUTE_DATA_3=4;b.TEXTURE_BINDING_HIGHLIGHT_0=5;b.TEXTURE_BINDING_HIGHLIGHT_1=6;b.TEXTURE_BINDING_RENDERER_0=5;b.TEXTURE_BINDING_RENDERER_1=6;b.ATTRIBUTE_DATA_FILTER_FLAGS=
0;b.ATTRIBUTE_DATA_ANIMATION=1;b.ATTRIBUTE_DATA_VV=2;b.ATTRIBUTE_DATA_DD0=3;b.ATTRIBUTE_DATA_DD1=3;b.MAX_FILTERS=2;b.HIGHLIGHT_FLAG=1;b.FILTER_FLAG_0=2;b.EFFECT_FLAG_0=4;b.THIN_LINE_THRESHOLD=2.5;b.HITTEST_SEARCH_SIZE=24;b.MAX_ANIMATION_TIME_MS=2E3;b.VTL_TEXTURE_BINDING_UNIT_SPRITES=5;b.VTL_TEXTURE_BINDING_UNIT_GLYPHS=6;b.VTL_HIGH_RES_CUTOFF=1.15;b.MAX_GPU_UPLOADS_PER_FRAME=2})},"esri/views/2d/engine/webgl/Painter":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../webgl ../../engine ../vectorTiles/shaders/ProgramCache ./BitBlitRenderer ./enums ./MaterialManager ./TextureManager ./effects/AnimationEffect ./effects/HighlightEffect ./effects/HittestEffect ./painter/RenderPass".split(" "),
function(g,b,l,k,f,a,q,m,d,c,e,h,p,n){Object.defineProperty(b,"__esModule",{value:!0});g=function(){return function(){}}();b.PainterOptions=g;g=function(){function b(n,b){this.context=n;this._blitRenderer=new q.BitBlitRenderer;this._brushCache=new Map;this._vtlProgramCache=null;this.brushNameToCtor={marker:f.brushes.Marker,line:f.brushes.Line,fill:f.brushes.Fill,text:f.brushes.Text,label:f.brushes.Label,clip:f.brushes.Clip,stencil:f.brushes.Stencil,bitmap:f.brushes.Bitmap,tileInfo:f.brushes.TileInfo,
vtlBackground:f.brushes.VTLBackground,vtlFill:f.brushes.VTLFill,vtlLine:f.brushes.VTLLine,vtlCircle:f.brushes.VTLCircle,vtlSymbol:f.brushes.VTLSymbol};this.effects={highlight:new h.default,hittest:new p.HittestEffect,integrate:new e.AnimationEffect};this.materialManager=new d(n);this._vtlProgramCache=new a.default(n);this.textureManager=new c(b)}b.prototype.getFbos=function(c,a){if(c!==this._lastWidth||a!==this._lastHeight){this._lastWidth=c;this._lastHeight=a;if(this._fbos)for(var e in this._fbos)this._fbos[e].dispose();
e={target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:c,height:a};var d={colorTarget:0,depthStencilTarget:3};c=new k.Renderbuffer(this.context,{width:c,height:a,internalFormat:34041});this._fbos={output:new k.FramebufferObject(this.context,d,e,c),alpha:new k.FramebufferObject(this.context,d,e,c),effect0:new k.FramebufferObject(this.context,d,e,c)}}return this._fbos};b.prototype.beforeRenderLayers=function(c){var a=c.getViewport(),a=this.getFbos(a.width,a.height);this._prevFBO=
c.getBoundFramebufferObject();c.bindFramebuffer(a.output);c.setDepthWriteEnabled(!0);c.setClearColor(0,0,0,0);c.setClearDepth(1);c.clear(c.gl.COLOR_BUFFER_BIT|c.gl.DEPTH_BUFFER_BIT);c.setDepthWriteEnabled(!1)};b.prototype.beforeRenderLayer=function(c,a,e){1!==e?(c.bindFramebuffer(this._fbos.alpha),c.setColorMask(!0,!0,!0,!0),c.setClearColor(0,0,0,0),c.clear(c.gl.COLOR_BUFFER_BIT)):c.bindFramebuffer(this._fbos.output);c.setDepthWriteEnabled(!1);c.setDepthTestEnabled(!1);c.setStencilTestEnabled(!0);
c.setClearStencil(a);c.setStencilWriteMask(255);c.clear(c.gl.STENCIL_BUFFER_BIT)};b.prototype.compositeLayer=function(c,a){1!==a&&(c.bindFramebuffer(this._fbos.output),c.setStencilTestEnabled(!1),c.setStencilWriteMask(0),c.setBlendingEnabled(!0),c.setBlendFunctionSeparate(1,771,1,771),c.setColorMask(!0,!0,!0,!0),this._blitRenderer.render(c,this._fbos.alpha.colorTexture,9728,a))};b.prototype.renderLayers=function(c){c.bindFramebuffer(this._prevFBO);this._fbos&&(c.setStencilTestEnabled(!1),c.setStencilWriteMask(0),
c.setBlendingEnabled(!0),c.setBlendFunctionSeparate(1,771,1,771),c.setColorMask(!0,!0,!0,!0),this._blitRenderer.render(c,this._fbos.output.colorTexture,9728,1))};b.prototype.dispose=function(){this.materialManager.dispose();this.textureManager.dispose();this._blitRenderer&&(this._blitRenderer.dispose(),this._blitRenderer=null);this._vtlProgramCache&&(this._vtlProgramCache.dispose(),this._vtlProgramCache=null);this._brushCache&&(this._brushCache.forEach(function(c){return c.dispose()}),this._brushCache.clear(),
this._brushCache=null);if(this._fbos)for(var c in this._fbos)this._fbos[c]&&this._fbos[c].dispose();if(this.effects)for(var a in this.effects)this.effects[a]&&this.effects[a].dispose();this._prevFBO=null};b.prototype.getGeometryBrush=function(c){var a;c=(a={},a[m.WGLGeometryType.FILL]=f.brushes.Fill,a[m.WGLGeometryType.LINE]=f.brushes.Line,a[m.WGLGeometryType.MARKER]=f.brushes.Marker,a[m.WGLGeometryType.TEXT]=f.brushes.Text,a)[c];a=this._brushCache.get(c);void 0===a&&(a=new c,this._brushCache.set(c,
a));return this._brushCache.get(c)};b.prototype.renderObject=function(c,a,e,d){e=this.brushNameToCtor[e];if(!e)return null;var h=this._brushCache.get(e);void 0===h&&(h=new e,this._brushCache.set(e,h));h.prepareState(c,a,d);h.draw(c,a,d)};b.prototype.renderObjects=function(c,a,e,d){e=this.brushNameToCtor[e];if(!e)return null;var h=this._brushCache.get(e);void 0===h&&(h=new e,this._brushCache.set(e,h));h.drawMany(c,a,d)};b.prototype.getVectorTileProgramCach=function(){return this._vtlProgramCache};
b.prototype.registerRenderPass=function(c){var a=this,e=c.brushes.map(function(c){a._brushCache.has(c)||a._brushCache.set(c,new c);return a._brushCache.get(c)});return new n.default(e,c)};b.prototype.setHighlightOptions=function(c){this.effects.highlight.setHighlightOptions(c)};return b}();b.default=g})},"esri/views/2d/engine/vectorTiles/shaders/ProgramCache":function(){define(["require","exports","../../../../webgl","./Programs"],function(g,b,l,k){Object.defineProperty(b,"__esModule",{value:!0});
g=function(){function b(a){this._cache=Array(8);for(var b=0;8>b;b++)this._cache[b]={};this._programRepo=new l.ProgramCache(a)}b.prototype.dispose=function(){this._programRepo&&(this._programRepo.dispose(),this._programRepo=null)};b.prototype.getProgram=function(a,b,m){var d=this._cache[a];d[b]||(a=this._programRepo.getProgram(this._getProgramTemplate(a),m),d[b]=a);return d[b]};b.prototype.getProgramAttributes=function(a){switch(a){case 0:return k.background.attributes;case 5:return k.circle.attributes;
case 1:return k.fill.attributes;case 4:return k.icon.attributes;case 3:return k.line.attributes;case 2:return k.outline.attributes;case 6:return k.text.attributes;default:return null}};b.prototype._getProgramTemplate=function(a){switch(a){case 0:return k.background;case 5:return k.circle;case 1:return k.fill;case 4:return k.icon;case 3:return k.line;case 2:return k.outline;case 6:return k.text;default:return null}};return b}();b.default=g})},"esri/views/2d/engine/vectorTiles/shaders/Programs":function(){define(["require",
"exports","../../../../webgl","./sources/resolver"],function(g,b,l,k){Object.defineProperty(b,"__esModule",{value:!0});b.background={name:"background",shaders:function(a){return{vertexShader:l.glslifyDefineMap({ID:a.id,PATTERN:a.pattern})+k.resolveIncludes("background/background.vert"),fragmentShader:l.glslifyDefineMap({ID:a.id,PATTERN:a.pattern})+k.resolveIncludes("background/background.frag")}},attributes:{a_pos:0}};b.circle={name:"circle",shaders:function(a){return{vertexShader:l.glslifyDefineMap({ID:a.id})+
k.resolveIncludes("circle/circle.vert"),fragmentShader:l.glslifyDefineMap({ID:a.id})+k.resolveIncludes("circle/circle.frag")}},attributes:{a_pos:0,a_color:1,a_stroke_color:2,a_data:3}};var f=function(a){return l.glslifyDefineMap({ID:a.id,DD:a.dd,PATTERN:a.pattern})};b.fill={name:"fill",shaders:function(a){return{vertexShader:f(a)+k.resolveIncludes("fill/fill.vert"),fragmentShader:f(a)+k.resolveIncludes("fill/fill.frag")}},attributes:{a_pos:0,a_color:1}};b.outline={name:"outline",shaders:function(a){return{vertexShader:l.glslifyDefineMap({ID:a.id,
DD:a.dd})+k.resolveIncludes("outline/outline.vert"),fragmentShader:l.glslifyDefineMap({ID:a.id,DD:a.dd})+k.resolveIncludes("outline/outline.frag")}},attributes:{a_pos:0,a_offset:1,a_xnormal:2,a_color:3}};b.icon={name:"icon",shaders:function(a){return{vertexShader:l.glslifyDefineMap({ID:a.id,DD:a.dd,SDF:a.sdf})+k.resolveIncludes("icon/icon.vert"),fragmentShader:l.glslifyDefineMap({ID:a.id,DD:a.dd,SDF:a.sdf})+k.resolveIncludes("icon/icon.frag")}},attributes:{a_pos:0,a_vertexOffset:1,a_tex:2,a_levelInfo:3,
a_color:4,a_size:5}};var a=function(a){return l.glslifyDefineMap({ID:a.id,DD:a.dd,PATTERN:a.pattern})};b.line={name:"line",shaders:function(b){return{vertexShader:a(b)+k.resolveIncludes("line/line.vert"),fragmentShader:a(b)+k.resolveIncludes("line/line.frag")}},attributes:{a_pos:0,a_offsetAndNormal:1,a_accumulatedDistance:2,a_color:3,a_width:4}};b.text={name:"text",shaders:function(a){return{vertexShader:l.glslifyDefineMap({ID:a.id,DD:a.dd})+k.resolveIncludes("text/text.vert"),fragmentShader:l.glslifyDefineMap({ID:a.id,
DD:a.dd})+k.resolveIncludes("text/text.frag")}},attributes:{a_pos:0,a_vertexOffset:1,a_tex:2,a_levelInfo:3,a_color:4,a_size:5}}})},"esri/views/2d/engine/vectorTiles/shaders/sources/resolver":function(){define(["require","exports","../../../../../webgl","./shaderRepository"],function(g,b,l,k){Object.defineProperty(b,"__esModule",{value:!0});var f=new l.ShaderCompiler(function(a){var b=k;a.split("/").forEach(function(a){b&&(b=b[a])});return b});b.resolveIncludes=function(a){return f.resolveIncludes(a)}})},
"esri/views/2d/engine/vectorTiles/shaders/sources/shaderRepository":function(){define(["require","exports"],function(g,b){return{background:{"background.frag":"#ifdef PATTERN\nuniform lowp float u_opacity;\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform sampler2D u_texture;\nvarying mediump vec2 v_tileTextureCoord;\n#else\nuniform lowp vec4 u_color;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main() {\n#ifdef PATTERN\n  mediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\n  mediump vec2 samplePos \x3d mix(u_pattern_tl, u_pattern_br, normalizedTextureCoord);\n  lowp vec4 color \x3d texture2D(u_texture, samplePos);\n  gl_FragColor \x3d u_opacity * color;\n#else\n  gl_FragColor \x3d u_color;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"background.vert":"precision mediump float;\nattribute vec2 a_pos;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_coord_range;\nuniform mediump float u_depth;\n#ifdef PATTERN\nuniform mediump mat3 u_pattern_matrix;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\nvoid main() {\n  gl_Position \x3d vec4((u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0)).xy, u_depth, 1.0);\n#ifdef PATTERN\n  v_tileTextureCoord \x3d (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n}"},
circle:{"circle.frag":"precision lowp float;\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  mediump float dist \x3d length(v_offset);\n  mediump float alpha \x3d smoothstep(0.0, -v_blur, dist - 1.0);\n  lowp float color_mix_ratio \x3d v_stroke_width \x3c 0.01 ? 0.0 : smoothstep(-v_blur, 0.0, dist - v_radius / (v_radius + v_stroke_width));\n  gl_FragColor \x3d alpha * mix(v_color, v_stroke_color, color_mix_ratio);\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"circle.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec4 a_color;\nattribute vec4 a_stroke_color;\nattribute vec4 a_data;\nconst float sizePrecision \x3d 0.25;\nconst float blurPrecision \x3d 0.03125;\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_circleTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_radius;\nuniform lowp vec4 u_color;\nuniform mediump float u_blur;\nuniform mediump float u_stroke_width;\nuniform lowp vec4 u_stroke_color;\nuniform mediump float u_antialiasingWidth;\nvoid main()\n{\n  v_color \x3d a_color * u_color;\n  v_stroke_color \x3d a_stroke_color * u_stroke_color;\n  v_stroke_width \x3d a_data[1] * sizePrecision * u_stroke_width;\n  v_radius \x3d a_data[2] * u_radius;\n  v_blur \x3d max(a_data[0] * blurPrecision + u_blur, u_antialiasingWidth / (v_radius + v_stroke_width));\n  mediump vec2 offset \x3d vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\n  v_offset \x3d offset;\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos * 0.5, 1.0) + u_displayMat3 * vec3((v_radius + v_stroke_width) * offset + u_circleTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
fill:{"fill.frag":"precision lowp float;\n#ifdef PATTERN\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform lowp sampler2D u_texture;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvec4 mixColors(vec4 color1, vec4 color2) {\n  float compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\n  vec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\n  return vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef PATTERN\n  mediump vec2 normalizedTextureCoord \x3d fract(v_tileTextureCoord);\n  mediump vec2 samplePos \x3d mix(u_pattern_tl, u_pattern_br, normalizedTextureCoord);\n  lowp vec4 color \x3d texture2D(u_texture, samplePos);\n  gl_FragColor \x3d v_color[3] * color;\n#else\n  gl_FragColor \x3d v_color;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"fill.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_fillTranslation;\n#ifdef PATTERN\nuniform mediump mat3 u_pattern_matrix;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\n#ifdef DD\nattribute vec4 a_color;\n#endif\nuniform lowp vec4 u_color;\nvarying lowp vec4 v_color;\nvoid main()\n{\n#ifdef DD\n  v_color \x3d a_color * u_color;\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n#ifdef PATTERN\n  v_tileTextureCoord \x3d (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\n#endif\n  vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(u_fillTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
icon:{"icon.frag":"precision mediump float;\nuniform lowp sampler2D u_texture;\n#ifdef SDF\nuniform lowp vec4 u_color;\nuniform lowp vec4 u_outlineColor;\nuniform mediump float u_outlineSize;\n#endif\nvarying mediump vec2 v_tex;\nvarying lowp float v_transparency;\nvarying mediump vec2 v_size;\nvarying lowp vec4 v_color;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\n#include \x3cutil/encoding.glsl\x3e\nvec4 mixColors(vec4 color1, vec4 color2) {\n  float compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\n  vec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\n  return vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef SDF\n  lowp vec4 fillPixelColor \x3d v_color;\n  float d \x3d rgba2float(texture2D(u_texture, v_tex)) - 0.5;\n  const float sofetEdgeRatio \x3d 0.248062016;\n  float size \x3d max(v_size.x, v_size.y);\n  float dist \x3d d * sofetEdgeRatio * size;\n  fillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\n  if (u_outlineSize \x3e 0.25) {\n    lowp vec4 outlinePixelColor \x3d u_outlineColor;\n    const float outlineLimitRatio \x3d (16.0 / 86.0);\n    float clampedOutlineSize \x3d sofetEdgeRatio * min(u_outlineSize, outlineLimitRatio * max(v_size.x, v_size.y));\n    outlinePixelColor *\x3d clamp(0.5 - (abs(dist) - clampedOutlineSize), 0.0, 1.0);\n    gl_FragColor \x3d v_transparency * mixColors(fillPixelColor, outlinePixelColor);\n  }\n  else {\n    gl_FragColor \x3d v_transparency * fillPixelColor;\n  }\n#else\n  lowp vec4 texColor \x3d texture2D(u_texture, v_tex);\n  gl_FragColor \x3d v_transparency * texColor;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"icon.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_tex;\nattribute vec4 a_levelInfo;\n#ifdef DD\nattribute vec4 a_color;\nattribute mediump float a_size;\n#endif\nuniform lowp vec4 u_color;\nuniform mediump float u_size;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_iconTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_fadeSpeed;\nuniform mediump float u_minfadeLevel;\nuniform mediump float u_maxfadeLevel;\nuniform mediump float u_fadeChange;\nuniform mediump float u_opacity;\nvarying mediump vec2 v_tex;\nvarying lowp float v_transparency;\nvarying mediump vec2 v_size;\nconst float C_OFFSET_PRECISION \x3d 1.0 / 8.0;\nconst float C_256_TO_RAD \x3d 3.14159265359 / 128.0;\nconst float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\nconst float tileCoordRatio \x3d 1.0 / 8.0;\nvoid main()\n{\n  mediump float a_labelMinLevel \x3d a_levelInfo[0];\n  mediump float a_angle         \x3d a_levelInfo[1];\n  mediump float a_minLevel      \x3d a_levelInfo[2];\n  mediump float a_maxLevel      \x3d a_levelInfo[3];\n  mediump float delta_z \x3d 0.0;\n  mediump float rotated \x3d mod(a_angle + u_mapRotation, 256.0);\n  delta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * step(64.0, rotated) * (1.0 - step(192.0, rotated));\n  delta_z +\x3d 1.0 - step(a_minLevel, u_level);\n  delta_z +\x3d step(a_maxLevel, u_level);\n  mediump float alpha \x3d u_fadeSpeed !\x3d 0.0 ? clamp((u_fadeChange - a_labelMinLevel) / u_fadeSpeed, 0.0, 1.0) : 1.0;\n  v_transparency \x3d (u_fadeSpeed \x3e\x3d 0.0 ? alpha : 1.0 - alpha);\n  if (u_maxfadeLevel \x3c a_labelMinLevel)\n  {\n    v_transparency \x3d 0.0;\n  }\n  if (u_minfadeLevel \x3e\x3d a_labelMinLevel)\n  {\n    v_transparency \x3d 1.0;\n  }\n  delta_z +\x3d step(v_transparency, 0.0);\n  vec2 offset \x3d C_OFFSET_PRECISION * a_vertexOffset;\n  v_size \x3d abs(offset);\n#ifdef SDF\n  offset \x3d (120.0 / 86.0) * offset;\n#endif\n#ifdef DD\n  mediump float icon_size \x3d a_size * u_size;\n#else\n  mediump float icon_size \x3d u_size;\n#endif\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayViewMat3 * vec3(icon_size * offset, 0.0) + u_displayMat3 * vec3(u_iconTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth + delta_z, 1.0);\n#ifdef DD\n  v_color \x3d a_color * u_color;\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  v_tex \x3d a_tex.xy / u_mosaicSize;\n  v_transparency *\x3d v_color.w;\n}"},
line:{"line.frag":"varying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nvarying mediump float v_lineHalfWidth;\nvarying lowp vec4 v_color;\nvarying mediump float v_blur;\n#ifdef PATTERN\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform mediump vec2 u_spriteSize;\nuniform sampler2D u_texture;\nconst mediump float tileCoordRatio \x3d 8.0;\n#else\nvarying mediump vec2 v_dasharray;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  mediump float fragDist \x3d length(v_normal) * v_lineHalfWidth;\n  lowp float alpha \x3d clamp((v_lineHalfWidth - fragDist) / v_blur, 0.0, 1.0);\n#ifdef PATTERN\n  mediump float relativeTexX \x3d mod((v_accumulatedDistance + v_normal.x * v_lineHalfWidth * tileCoordRatio) / u_spriteSize.x, 1.0);\n  mediump float relativeTexY \x3d 0.5 + (v_normal.y * v_lineHalfWidth / u_spriteSize.y);\n  mediump vec2 texCoord \x3d mix(u_pattern_tl, u_pattern_br, vec2(relativeTexX, relativeTexY));\n  lowp vec4 color \x3d texture2D(u_texture, texCoord);\n  gl_FragColor \x3d alpha * v_color[3] * color;\n#else\n  lowp float dashPos \x3d  mod(v_accumulatedDistance, v_dasharray.x + v_dasharray.y);\n  lowp float dashAlpha \x3d clamp(min(dashPos, v_dasharray.x - dashPos) + 0.5, 0.0, 1.0);\n  dashAlpha \x3d max(sign(-v_dasharray.y), dashAlpha);\n  alpha *\x3d dashAlpha;\n  gl_FragColor \x3d alpha * v_color;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"line.vert":"attribute vec2 a_pos;\nattribute vec4 a_offsetAndNormal;\nattribute vec2 a_accumulatedDistance;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_lineTranslation;\nuniform mediump float u_blur;\nuniform mediump float u_antialiasing;\nuniform mediump float u_depth;\nvarying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nconst float scale \x3d 1.0 / 31.0;\n#ifdef DD\nattribute vec4 a_color;\nattribute mediump float a_width;\n#endif\nuniform lowp vec4 u_color;\nuniform mediump float u_width;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvarying mediump float v_lineHalfWidth;\nvarying mediump float v_blur;\n#ifndef PATTERN\nuniform mediump vec2 u_dasharray;\nvarying mediump vec2 v_dasharray;\n#endif\nvoid main()\n{\n  v_normal \x3d a_offsetAndNormal.zw * scale;\n#ifdef DD\n  v_lineHalfWidth \x3d a_width * u_width;\n#else\n  v_lineHalfWidth \x3d u_width;\n#endif\n  v_lineHalfWidth +\x3d u_antialiasing;\n  v_lineHalfWidth *\x3d 0.5;\n#ifndef PATTERN\n#ifdef DD\n  v_dasharray \x3d u_dasharray * a_width;\n#else\n  v_dasharray \x3d u_dasharray * u_width;\n#endif\n#endif\n  mediump vec2 dist \x3d v_lineHalfWidth * scale * a_offsetAndNormal.xy;\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) +  u_displayViewMat3 * vec3(dist, 0.0) + u_displayMat3 * vec3(u_lineTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n  v_accumulatedDistance \x3d a_accumulatedDistance.x;\n  v_blur \x3d u_blur + u_antialiasing;\n  #ifdef DD\n    v_color \x3d a_color * u_color;\n  #else\n    v_color \x3d u_color;\n  #endif\n  #ifdef ID\n    v_id \x3d u_id / 255.0;\n  #endif\n}"},
outline:{"outline.frag":"varying lowp vec4 v_color;\nvarying mediump vec2 v_normal;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  lowp float dist \x3d abs(v_normal.y);\n  lowp float alpha \x3d smoothstep(1.0, 0.0, dist);\n  gl_FragColor \x3d alpha * v_color;\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}","outline.vert":"attribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_xnormal;\n#ifdef DD\nattribute vec4 a_color;\n#endif\nuniform lowp vec4 u_color;\nvarying lowp vec4 v_color;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_fillTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_outline_width;\nvarying lowp vec2 v_normal;\nconst float scale \x3d 1.0 / 15.0;\nvoid main()\n{\n#ifdef DD\n  v_color \x3d a_color * u_color;\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  v_normal \x3d a_xnormal;\n  mediump vec2 dist \x3d u_outline_width * scale * a_offset;\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(dist + u_fillTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
text:{"text.frag":"uniform lowp sampler2D u_texture;\nuniform mediump float u_edgeDistance;\nvarying lowp vec2 v_tex;\nvarying lowp float v_transparency;\nvarying lowp vec4 v_color;\nvarying mediump float v_edgeWidth;\nvarying mediump float v_edgeDistance;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  lowp float dist \x3d texture2D(u_texture, v_tex).a;\n  mediump float alpha \x3d smoothstep(v_edgeDistance - v_edgeWidth, v_edgeDistance + v_edgeWidth, dist) * v_transparency;\n  gl_FragColor \x3d alpha * v_color;\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"text.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_tex;\nattribute vec4 a_levelInfo;\nuniform lowp vec4 u_color;\n#ifdef DD\nattribute vec4 a_color;\n#endif\nvarying lowp vec4 v_color;\nuniform mediump float u_size;\n#ifdef DD\nattribute mediump float a_size;\n#endif\nvarying mediump float v_size;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_textTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_fadeSpeed;\nuniform mediump float u_minfadeLevel;\nuniform mediump float u_maxfadeLevel;\nuniform mediump float u_fadeChange;\nuniform mediump float u_opacity;\nvarying lowp vec2 v_tex;\nvarying lowp float v_transparency;\nconst float offsetPrecision \x3d 1.0 / 8.0;\nconst mediump float edgePos \x3d 0.75;\nuniform mediump float u_edgeDistance;\nuniform mediump float u_edgeBlur;\nuniform mediump float u_antialiasingWidth;\nvarying mediump float v_edgeDistance;\nvarying mediump float v_edgeWidth;\nuniform lowp float u_halo;\nconst float sdfFontScale \x3d 1.0 / 24.0;\nvoid main()\n{\n  mediump float a_labelMinLevel \x3d a_levelInfo[0];\n  mediump float a_angle        \x3d a_levelInfo[1];\n  mediump float a_minLevel    \x3d a_levelInfo[2];\n  mediump float a_maxLevel    \x3d a_levelInfo[3];\n  mediump float delta_z \x3d 0.0;\n  mediump float rotated \x3d mod(a_angle + u_mapRotation, 256.0);\n  delta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * step(64.0, rotated) * (1.0 - step(192.0, rotated));\n  delta_z +\x3d 1.0 - step(a_minLevel, u_level);\n  delta_z +\x3d step(a_maxLevel, u_level);\n  mediump float alpha \x3d u_fadeSpeed !\x3d 0.0 ? clamp((u_fadeChange - a_labelMinLevel) / u_fadeSpeed, 0.0, 1.0) : 1.0;\n  v_transparency \x3d (u_fadeSpeed \x3e\x3d 0.0 ? alpha : 1.0 - alpha);\n  if (u_maxfadeLevel \x3c a_labelMinLevel)\n  {\n    v_transparency \x3d 0.0;\n  }\n  if (u_minfadeLevel \x3e\x3d a_labelMinLevel)\n  {\n    v_transparency \x3d 1.0;\n  }\n  delta_z +\x3d step(v_transparency, 0.0);\n  v_tex \x3d a_tex.xy / u_mosaicSize;\n#ifdef DD\n  if (u_halo \x3e 0.5)\n  {\n    v_color \x3d u_color;\n  }\n  else\n  {\n    v_color \x3d a_color * u_color;\n  }\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef DD\n  v_size \x3d a_size * u_size;\n#else\n  v_size \x3d u_size;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  v_edgeDistance \x3d edgePos - u_edgeDistance / v_size;\n  v_edgeWidth \x3d (u_antialiasingWidth + u_edgeBlur) / v_size;\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + sdfFontScale * u_displayViewMat3 * vec3(offsetPrecision * v_size * a_vertexOffset, 0.0) + u_displayMat3 * vec3(u_textTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth + delta_z, 1.0);\n}"},
util:{"encoding.glsl":"const vec4 rgba2float_factors \x3d vec4(\n    255.0 / (256.0),\n    255.0 / (256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n  );\nfloat rgba2float(vec4 rgba) {\n  return dot(rgba, rgba2float_factors);\n}"}}})},"esri/views/2d/engine/webgl/MaterialManager":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/maybe ../../../webgl ./enums ./shaders/MaterialPrograms".split(" "),function(g,
b,l,k,f,a,q){var m=function(c){return c===a.WGLDrawPhase.HITTEST||c===a.WGLDrawPhase.LABEL_ALPHA},d=function(c,e,d,b){b=b.reduce(function(a,e){var d;return l({},a,(d={},d[e]=c.driverTestResult[e],d))},{});e=l({},e.getVariation(),c.rendererInfo.getVariation(),{highlight:c.drawPhase===a.WGLDrawPhase.HIGHLIGHT,id:m(c.drawPhase)},b);if(k.isSome(d))for(b=0;b<d.length;b++)e[d[b]]=!0;return e};return function(){function c(c){this._programByKey=new Map;this._programCache=new f.ProgramCache(c)}c.prototype.dispose=
function(){this._programCache&&this._programCache.dispose()};c.prototype.getProgram=function(c,a,d,n){void 0===d&&(d=[]);void 0===n&&(n=[]);var e=a.path+d.join(".")+n.join(".");if(this._programByKey.has(e))return this._programByKey.get(e);n=n.reduce(function(a,e){var d;return l({},a,(d={},d[e]=c.driverTestResult[e],d))},{});d=l({},d.reduce(function(c,a){var e;return l({},c,(e={},e[a]=!0,e))},{}),n);a=this._programCache.getProgram(q.createProgramTemplate(a.path,a.attributes),d);if(!a)throw Error("Unable to get program for key: ${key}");
this._programByKey.set(e,a);return a};c.prototype.getMaterialProgram=function(c,h,b,n,f,l){void 0===l&&(l=["ignoresSamplerPrecision"]);var e,p=l;e=c.rendererInfo;var u=c.drawPhase,p=h.getVariationHash()+"-"+p.join(".")+"-",u=(m(u)?1:0)|(u===a.WGLDrawPhase.HIGHLIGHT?2:0);e=p+u+"-"+e.getVariationHash()+"-"+(k.isSome(f)&&f.join("."));if(this._programByKey.has(e))return this._programByKey.get(e);c=d(c,h,f,l);b=this._programCache.getProgram(q.createProgramTemplate(b,n),c);if(!b)throw Error("Unable to get program for key: ${key}");
this._programByKey.set(e,b);return b};return c}()})},"esri/views/2d/engine/webgl/shaders/MaterialPrograms":function(){define(["require","exports","../../../../webgl","./sources/resolver"],function(g,b,l,k){Object.defineProperty(b,"__esModule",{value:!0});var f=function(a){var b={},m;for(m in a){for(var d=m,c=void 0,c=""+d[0].toUpperCase(),e=1;e<d.length;e++){var h=d[e];h===h.toUpperCase()?(c+="_",c+=h):c+=h.toUpperCase()}b[c]=a[m]}return l.glslifyDefineMap(b)};b.createProgramTemplate=function(a,b){var m=
a+a.substring(a.lastIndexOf("/"));return{name:name,attributes:b,shaders:function(a){return{vertexShader:f(a)+k.resolveIncludes(m+".vert"),fragmentShader:f(a)+k.resolveIncludes(m+".frag")}}}}})},"esri/views/2d/engine/webgl/TextureManager":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/tsSupport/generatorHelper ../../../../config ../../../../request ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/screenUtils ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f32 ../../../../symbols/cim/Rasterizer ./definitions ./enums ./fontUtils ./GlyphMosaic ./GlyphSource ./SDFConverter ./SpriteMosaic ./animatedFormats/apng ./animatedFormats/gif ./util/BidiText ./util/Result ./util/symbolUtils".split(" "),
function(g,b,l,k,f,a,q,m,d,c,e,h,p,n,u,x,v,t,w,r,y,A,z,B,C,D,H){function F(c){switch(c.type){case "CIMSolidStroke":case "CIMSolidFill":return!0;case "esriSFS":return"esriSFSSolid"===c.style||"esriSFSNull"===c.style;case "esriSLS":return"esriSLSSolid"===c.style||"esriSLSNull"===c.style;default:return!1}}function E(c){switch(c.type){case "esriSMS":case "esriPMS":case "CIMPointSymbol":case "CIMVectorMarker":case "CIMPictureMarker":case "CIMCharacterMarker":return!1;default:return!0}}function G(c){return k(this,
void 0,void 0,function(){var a,e;return f(this,function(d){switch(d.label){case 0:a=window.URL.createObjectURL(c),d.label=1;case 1:return d.trys.push([1,3,,4]),[4,q(a,{responseType:"image"})];case 2:return e=d.sent().data,window.URL.revokeObjectURL(a),[2,e];case 3:return d.sent(),window.URL.revokeObjectURL(a),[2,new m("mapview-invalid-resource","Could not fetch requested resource at "+a)];case 4:return[2]}})})}function J(c,a){return k(this,void 0,void 0,function(){var d,h,n,b,p,k,r,t,u;return f(this,
function(f){switch(f.label){case 0:d=c.imageData?"data:"+c.contentType+";base64,"+c.imageData:c.url;if(-1===d.indexOf(";base64,"))return[3,1];n=d.indexOf(";base64,")+8;b=d.substring(n);p=atob(b);k=new Uint8Array(p.length);for(r=0;r<p.length;r++)k[r]=p.charCodeAt(r);h=k.buffer;return[3,4];case 1:return f.trys.push([1,3,,4]),[4,q(d,l({responseType:"array-buffer"},a))];case 2:return h=t=f.sent().data,[3,4];case 3:return u=f.sent(),e.isAbortError(u)?[3,4]:[2,new m("mapview-invalid-resource","Could not fetch requested resource at "+
d)];case 4:return[2,h]}})})}var K=n.vec2f32.create(),I=d.getLogger("esri.views.2d.engine.webgl.TextureManager"),N=function(){function c(c,a,e){this.mosaicType=c;this.page=a;this.sdf=e}c.fromMosaic=function(a,e){return new c(a,e.page,e.sdf)};return c}();return function(){function d(c){this._invalidFontsMap=new Map;this._sdfConverter=new y.default(126);this._bindingInfos=[];this._hashToBindingIndex=new Map;this._rasterizer=new u.default;this._spriteMosaic=new A(c,2048,2048,500);this._glyphSource=new r(a.fontsUrl+
"/{fontstack}/{range}.pbf");this._glyphMosaic=new w(1024,1024,this._glyphSource)}d.prototype.dispose=function(){this._spriteMosaic.dispose();this._glyphMosaic.dispose();this._rasterizer.dispose();this._rasterizer=this._glyphMosaic=this._spriteMosaic=null};Object.defineProperty(d.prototype,"sprites",{get:function(){return this._spriteMosaic},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"glyphs",{get:function(){return this._glyphMosaic},enumerable:!0,configurable:!0});d.prototype.rasterizeItem=
function(a,e,d){return k(this,void 0,void 0,function(){var h,n,b,p=this;return f(this,function(f){switch(f.label){case 0:if(c.isNone(a))return I.error(new m("mapview-null-resource","Unable to rasterize null resource",void 0)),[2,null];h=a.type;switch(h){case "CIMTextSymbol":return[3,1];case "esriTS":return[3,1]}return[3,3];case 1:return[4,this._rasterizeText(a,e,d)];case 2:return n=f.sent(),n.forEach(function(c){return p._setTextureBinding(v.MosaicType.GLYPH,c)}),[2,{glyphMosaicItems:n}];case 3:return a.type&&
-1!==a.type.toLowerCase().indexOf("3d")?(I.error(new m("mapview-invalid-type","MapView does not support symbol type: "+a.type,a)),[2,null]):[4,this._rasterizeSpriteSymbol(a,d)];case 4:return b=f.sent(),D.ok(b)&&b&&this._setTextureBinding(v.MosaicType.SPRITE,b),[2,{spriteMosaicItem:b}]}})})};d.prototype.bindTextures=function(c,a,e){if(0!==e.textureBinding){var d=this._bindingInfos[e.textureBinding-1];e=d.page;switch(d.mosaicType){case v.MosaicType.SPRITE:var d=this.sprites.getWidth(e),h=this.sprites.getHeight(e),
d=p.vec2.set(K,d,h);this._spriteMosaic.bind(c,9729,e,x.TEXTURE_BINDING_SPRITE_ATLAS);a.setUniform1i("u_texture",x.TEXTURE_BINDING_SPRITE_ATLAS);a.setUniform2fv("u_mosaicSize",d);break;case v.MosaicType.GLYPH:d=this.glyphs.width;h=this.glyphs.height;d=p.vec2.set(K,d,h);this._glyphMosaic.bind(c,9729,e,x.TEXTURE_BINDING_GLYPH_ATLAS);a.setUniform1i("u_texture",x.TEXTURE_BINDING_GLYPH_ATLAS);a.setUniform2fv("u_mosaicSize",d);break;default:I.error("mapview-texture-manager","Cannot handle unknown type "+
d.mosaicType)}}};d.prototype._hashMosaic=function(c,a){return 1|c<<1|(a.sdf?1:0)<<2|a.page<<3};d.prototype._setTextureBinding=function(c,a){var e=this._hashMosaic(c,a);this._hashToBindingIndex.has(e)||(c=N.fromMosaic(c,a),this._hashToBindingIndex.set(e,this._bindingInfos.length+1),this._bindingInfos.push(c));a.textureBinding=this._hashToBindingIndex.get(e)};d.prototype._rasterizeText=function(c,a,e){return k(this,void 0,void 0,function(){var d,h,n;return f(this,function(b){switch(b.label){case 0:d=
t.getFullyQualifiedFontName(c.font);h=this._invalidFontsMap.has(d);var p;if(a)p=a;else{p=C.bidiText(c.text)[0];for(var f=[],q=0;q<p.length;q++)f.push(p.charCodeAt(q));p=f}n=p;b.label=1;case 1:return b.trys.push([1,3,,4]),[4,this._glyphMosaic.getGlyphItems(h?"arial-unicode-ms-regular":d,n,e)];case 2:return[2,b.sent()];case 3:return b.sent(),I.error(new m("mapview-invalid-resource","Couldn't find font "+d+". Falling back to Arial Unicode MS Regular",void 0)),this._invalidFontsMap.set(d,!0),[2,this._glyphMosaic.getGlyphItems("arial-unicode-ms-regular",
n,e)];case 4:return[2]}})})};d.prototype._rasterizeSpriteSymbol=function(c,a){return k(this,void 0,void 0,function(){var e,d,h,n,b,p;return f(this,function(f){if(F(c))return[2,null];e=H.keyFromSymbol(c);return this._spriteMosaic.has(e)?[2,this._spriteMosaic.getSpriteItem(e)]:"esriSMS"===c.type&&c.path?[2,this._handleSVG(c,e,a)]:c.url||c.imageData?[2,this._handleImage(c,e,a)]:(d=this._rasterizer.rasterizeJSONResource(c))?(h=d.size,n=d.image,b=d.sdf,p=d.simplePattern,[2,this._addItemToMosaic(e,h,{type:"static",
data:n},E(c),b,p)]):[2,new m("TextureManager","unrecognized or null rasterized image")]})})};d.prototype._handleSVG=function(c,a,e){return k(this,void 0,void 0,function(){var d,h;return f(this,function(n){switch(n.label){case 0:return d=[126,126],[4,this._sdfConverter.draw(c.path,e)];case 1:return h=n.sent(),[2,this._addItemToMosaic(a,d,{type:"static",data:new Uint32Array(h.buffer)},!1,!0,!0)]}})})};d.prototype._handleGIFOrPNG=function(c,a,d){return k(this,void 0,void 0,function(){var h,n,b,p,q,k,
r,t,u,l,w,x;return f(this,function(f){switch(f.label){case 0:return[4,J(c,d)];case 1:h=f.sent();if(!D.ok(h))return[3,10];n=B.isGIF(h);b=z.isPNG(h);if(!n&&!b)return[2,new m("mapview-invalid-resource","Image data is neither GIF nor PNG!")];p=void 0;f.label=2;case 2:return f.trys.push([2,7,,8]),n&&B.isAnimatedGIF(h)?[4,B.default.create(h,d)]:[3,4];case 3:return p=f.sent(),[3,6];case 4:return b&&z.isAnimatedPNG(h)?[4,z.default.create(h,d)]:[3,6];case 5:p=f.sent(),f.label=6;case 6:return[3,8];case 7:return q=
f.sent(),e.isAbortError(q)?[3,8]:[2,new m("mapview-invalid-resource","Could not fetch requested resource!")];case 8:if(p&&D.ok(p))return[2,this._addItemToMosaic(a,[p.width,p.height],{type:"animated",data:p},E(c),!1,!1)];k=n?"image/gif":"image/png";r=new Blob([h],{type:k});return[4,G(r)];case 9:if((t=f.sent())&&t instanceof HTMLImageElement)return u=this._rasterizer.rasterizeImageResource(t,c.colorSubstitutions),l=u.size,w=u.sdf,x=u.image,[2,this._addItemToMosaic(a,l,{type:"static",data:x},E(c),w,
!1)];f.label=10;case 10:return[2,new m("mapview-invalid-resource","Could not handle resource!")]}})})};d.prototype._handleImage=function(c,a,d){return k(this,void 0,void 0,function(){var n,b,p,k,r,t,u;return f(this,function(f){switch(f.label){case 0:var w;(w=c.url&&-1!==c.url.indexOf(".gif")||c.contentType&&"image/gif"===c.contentType||c.imageData&&-1!==c.imageData.indexOf("data:image/gif"))||(w=c.url&&-1!==c.url.indexOf(".png")||c.contentType&&"image/png"===c.contentType||c.imageData&&-1!==c.imageData.indexOf("data:image/png"));
if(w)return[2,this._handleGIFOrPNG(c,a,d)];n=c.imageData?"data:"+c.contentType+";base64,"+c.imageData:c.url;f.label=1;case 1:return f.trys.push([1,3,,4]),[4,q(n,l({responseType:"image"},d))];case 2:return b=f.sent().data,-1!==n.indexOf("data:image/svg+xml")&&(b.width=h.pt2px(c.width),b.height=h.pt2px(c.height)),p=this._rasterizer.rasterizeImageResource(b,c.colorSubstitutions),k=p.size,r=p.sdf,t=p.image,[2,this._addItemToMosaic(a,k,{type:"static",data:t},E(c),r,!1)];case 3:return u=f.sent(),e.isAbortError(u)?
[3,4]:[2,new m("mapview-invalid-resource","Could not fetch requested resource at "+n)];case 4:return[2,void 0]}})})};d.prototype._addItemToMosaic=function(c,a,e,d,h,n){return this._spriteMosaic.addSpriteItem(c,a,e,d,h,n)};return d}()})},"esri/symbols/cim/Rasterizer":function(){define(["require","exports","./CIMSymbolHelper","./SDFHelper","./utils"],function(g,b,l,k,f){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function a(){}a.prototype.dispose=function(){this._rasterizationCanvas=
null};a.prototype.rasterizeJSONResource=function(a,b){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));if("simple-fill"===a.type||"esriSFS"===a.type)return b=l.SymbolHelper.rasterizeSimpleFill(this._rasterizationCanvas,a.style),{size:[b[1],b[2]],image:new Uint32Array(b[0].buffer),sdf:!1,simplePattern:!0,anchorX:0,anchorY:0};if("simple-line"===a.type||"esriSLS"===a.type)return b=l.SymbolHelper.rasterizeSimpleLine(a.style,a.cap),{size:[b[1],b[2]],image:new Uint32Array(b[0].buffer),
sdf:!0,simplePattern:!0,anchorX:0,anchorY:0};var d;a="simple-marker"===a.type||"esriSMS"===a.type?l.CIMSymbolHelper.fromSimpleMarker(a):a;if((d=k.getSDFInfo(a))&&!b)return b=k.buildSDF(d),(a=b[0])?{size:[b[1],b[2]],image:new Uint32Array(a.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}:null;b=l.CIMSymbolHelper.rasterize(this._rasterizationCanvas,a,!b);a=b[0];d=b[3];var c=b[4];return a?{size:[b[1],b[2]],image:new Uint32Array(a.buffer),sdf:!1,simplePattern:!1,anchorX:d,anchorY:c}:null};a.prototype.rasterizeImageResource=
function(a,b){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));this._rasterizationCanvas.width=a.width;this._rasterizationCanvas.height=a.height;var d=this._rasterizationCanvas.getContext("2d");a instanceof ImageData?d.putImageData(a,0,0):(a.setAttribute("width",a.width.toString()),a.setAttribute("height",a.height.toString()),d.drawImage(a,0,0,a.width,a.height));d=d.getImageData(0,0,a.width,a.height);d=new Uint8Array(d.data);if(b)for(var c=0;c<b.length;c++){var e=
b[c];if(e&&e.oldColor&&4===e.oldColor.length&&e.newColor&&4===e.newColor.length){var h=e.oldColor,p=h[0],n=h[1],m=h[2],h=h[3],k=e.newColor,e=k[0],q=k[1],t=k[2],l=k[3];if(p!==e||n!==q||m!==t||h!==l)for(k=0;k<d.length;k+=4)p===d[k]&&n===d[k+1]&&m===d[k+2]&&h===d[k+3]&&(d[k]=e,d[k+1]=q,d[k+2]=t,d[k+3]=l)}}for(k=0;k<d.length;k+=4)b=d[k+3]/255,d[k]*=b,d[k+1]*=b,d[k+2]*=b;b=a.width;c=a.height;p=d;if(512<=b||512<=c)p=a.width/a.height,1<p?(b=512,c=Math.round(512/p)):(c=512,b=Math.round(512*p)),p=new Uint8Array(4*
b*c),f.resampleHermite(d,a.width,a.height,new Uint8ClampedArray(p.buffer),b,c,!1);return{size:[b,c],image:new Uint32Array(p.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}};return a}();b.default=g})},"esri/symbols/cim/utils":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});b.evaluateValueOrFunction=function(b,k,f,a){return"function"===typeof b?b(k,f,a):b};b.colorToArray=function(b){return[b.r,b.g,b.b,b.a]};b.resampleHermite=function(b,k,f,
a,q,m,d){void 0===d&&(d=!0);var c=k/q;f/=m;for(var e=Math.ceil(c/2),h=Math.ceil(f/2),p=0;p<m;p++)for(var n=0;n<q;n++){for(var u=4*(n+(d?m-p-1:p)*q),l=0,g=0,t=0,w=0,r=0,y=0,A=0,z=(p+.5)*f,B=Math.floor(p*f);B<(p+1)*f;B++)for(var C=Math.abs(z-(B+.5))/h,D=(n+.5)*c,C=C*C,H=Math.floor(n*c);H<(n+1)*c;H++){var F=Math.abs(D-(H+.5))/e,l=Math.sqrt(C+F*F);-1<=l&&1>=l&&(l=2*l*l*l-3*l*l+1,0<l&&(F=4*(H+B*k),A+=l*b[F+3],t+=l,255>b[F+3]&&(l=l*b[F+3]/250),w+=l*b[F],r+=l*b[F+1],y+=l*b[F+2],g+=l))}a[u]=w/g;a[u+1]=r/
g;a[u+2]=y/g;a[u+3]=A/t}}})},"esri/views/2d/engine/webgl/fontUtils":function(){define(["require","exports"],function(g,b){function l(b){b=b.toLowerCase().split(" ").join("-");switch(b){case "serif":return"noto-serif";case "sans-serif":return"arial-unicode-ms";case "monospace":return"ubuntu-mono";case "fantasy":return"cabin-sketch";case "cursive":return"redressed";default:return b}}Object.defineProperty(b,"__esModule",{value:!0});b.getFullyQualifiedFontName=function(b){var f;a:{if(b.weight)switch(b.weight.toLowerCase()){case "bold":case "bolder":f=
"-bold";break a}f=""}var a;a:{if(b.style)switch(b.style.toLowerCase()){case "italic":case "oblic":a="-italic";break a}a=""}f+=a;return l(b.family)+(0<f.length?f:"-regular")};b.getFontDecorationTop=function(b){switch(b){case "underline":return-26;case "line-through":return-18}return NaN}})},"esri/views/2d/engine/webgl/GlyphMosaic":function(){define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/has ../../../../core/promiseUtils ../../../webgl ./Rect ./RectangleBinPack".split(" "),
function(g,b,l,k,f,a,q,m,d){function c(c){for(var a=new Set,e=0;e<c.length;e++)a.add(Math.floor(c[e]/256));return a}function e(c,e,d){c.has(e)||c.set(e,d().then(function(){c.delete(e)}).catch(function(d){c.delete(e);a.throwIfNotAbortError(d)}));return c.get(e)}return function(){function h(c,a,e){this.height=this.width=0;this._dirties=[];this._glyphData=[];this._currentPage=0;this._glyphCache={};this._textures=[];this._rangePromises=new Map;this.width=c;this.height=a;this._glyphSource=e;this._binPack=
new d(c-4,a-4);this._glyphData.push(new Uint8Array(c*a));this._dirties.push(!0);this._textures.push(null);this._initDecorationGlyph()}h.prototype.dispose=function(){this._binPack=null;for(var c=0,a=this._textures;c<a.length;c++){var e=a[c];e&&e.dispose()}this._textures.length=0;this._glyphData.length=0};h.prototype._initDecorationGlyph=function(){for(var c=[117,149,181,207,207,181,149,117],a=[],e=0;e<c.length;e++)for(var d=c[e],h=0;11>h;h++)a.push(d);c={metrics:{width:5,height:2,left:0,top:0,advance:0},
bitmap:new Uint8Array(a)};this._recordGlyph(c)};h.prototype.getGlyphItems=function(c,a,e){return k(this,void 0,void 0,function(){var d,h=this;return l(this,function(n){switch(n.label){case 0:return d=this._getGlyphCache(c),[4,this._fetchRanges(c,a,e)];case 1:return n.sent(),[2,a.map(function(a){return h._getMosaicItem(d,c,a)})]}})})};h.prototype.bind=function(c,a,e,d){var h=this._getTexture(c,e);h.setSamplingMode(a);this._dirties[e]&&(h.setData(this._glyphData[e]),this._dirties[e]=!1);c.bindTexture(h,
d)};h.prototype._getGlyphCache=function(c){this._glyphCache[c]||(this._glyphCache[c]={});return this._glyphCache[c]};h.prototype._getTexture=function(c,a){this._textures[a]||(this._textures[a]=new q.Texture(c,{pixelFormat:6406,dataType:5121,width:this.width,height:this.height},new Uint8Array(this.width*this.height)));return this._textures[a]};h.prototype._invalidate=function(){this._dirties[this._currentPage]=!0};h.prototype._fetchRanges=function(e,d,h){return k(this,void 0,void 0,function(){var n,
b,p=this;return l(this,function(m){switch(m.label){case 0:return n=c(d),b=[],n.forEach(function(c){b.push(p._fetchRange(e,c,h))}),[4,a.all(b)];case 1:return m.sent(),[2]}})})};h.prototype._fetchRange=function(c,a,d){return k(this,void 0,void 0,function(){var h,n=this;return l(this,function(b){if(256<a)return[2,null];h=c+a;return[2,e(this._rangePromises,h,function(){return n._glyphSource.getRange(c,a,d)})]})})};h.prototype._getMosaicItem=function(c,a,e){if(!c[e]){a=this._glyphSource.getGlyph(a,e);
if(!a||!a.metrics)return{rect:new m.default(0,0,0,0),page:0,metrics:{left:0,width:0,height:0,advance:0,top:0},code:e,sdf:!0};var d=this._recordGlyph(a);c[e]={rect:d,page:this._currentPage,metrics:a.metrics,code:e,sdf:!0};this._invalidate()}return c[e]};h.prototype._getMosaicItemsStable=function(c,a,e){var d=this,h=[],n=e.map(function(c){return c});e.map(function(c){return c}).sort().map(function(e){return d._getMosaicItem(c,a,e)}).forEach(function(c){var a=n.indexOf(c.code);h[a]=c;n[a]=null});return h};
h.prototype._recordGlyph=function(c){var a=c.metrics;if(0===a.width)a=new m.default(0,0,0,0);else{var e=a.width+6,h=a.height+6,a=this._binPack.allocate(e,h);a.isEmpty&&(this._dirties[this._currentPage]||(this._glyphData[this._currentPage]=null),this._currentPage=this._glyphData.length,this._glyphData.push(new Uint8Array(this.width*this.height)),this._dirties.push(!0),this._textures.push(null),this._initDecorationGlyph(),this._binPack=new d(this.width-4,this.height-4),a=this._binPack.allocate(e,h));
var b=this._glyphData[this._currentPage];c=c.bitmap;var p=void 0,k=void 0;if(c)for(var q=0;q<h;q++)for(var p=e*q,k=this.width*(a.y+q)+a.x,l=0;l<e;l++)b[k+l]=c[p+l];f("esri-glyph-debug")&&this._showDebugPage(b)}return a};h.prototype._showDebugPage=function(c){var a=document.createElement("canvas"),e=a.getContext("2d"),d=new ImageData(this.width,this.height),h=d.data;a.width=this.width;a.height=this.height;a.style.border="1px solid black";for(var b=0;b<c.length;++b)h[4*b+0]=c[b],h[4*b+1]=0,h[4*b+2]=
0,h[4*b+3]=255;e.putImageData(d,0,0);document.body.appendChild(a)};return h}()})},"esri/views/2d/engine/webgl/Rect":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(b,f,a,q){void 0===b&&(b=0);void 0===f&&(f=0);void 0===a&&(a=0);void 0===q&&(q=0);this.x=b;this.y=f;this.width=a;this.height=q}Object.defineProperty(b.prototype,"isEmpty",{get:function(){return 0>=this.width||0>=this.height},enumerable:!0,configurable:!0});b.prototype.union=
function(b){this.x=Math.min(this.x,b.x);this.y=Math.min(this.y,b.y);this.width=Math.max(this.width,b.width);this.height=Math.max(this.height,b.height)};return b}();b.default=g})},"esri/views/2d/engine/webgl/RectangleBinPack":function(){define(["require","exports","./Rect"],function(g,b,l){return function(){function b(b,a){this._height=this._width=0;this._free=[];this._width=b;this._height=a;this._free.push(new l.default(0,0,b,a))}Object.defineProperty(b.prototype,"width",{get:function(){return this._width},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0});b.prototype.allocate=function(b,a){if(b>this._width||a>this._height)return new l.default;for(var f=null,m=-1,d=0;d<this._free.length;++d){var c=this._free[d];b<=c.width&&a<=c.height&&(null===f||c.y<=f.y&&c.x<=f.x)&&(f=c,m=d)}if(null===f)return new l.default;this._free.splice(m,1);f.width<f.height?(f.width>b&&this._free.push(new l.default(f.x+b,f.y,f.width-
b,a)),f.height>a&&this._free.push(new l.default(f.x,f.y+a,f.width,f.height-a))):(f.width>b&&this._free.push(new l.default(f.x+b,f.y,f.width-b,f.height)),f.height>a&&this._free.push(new l.default(f.x,f.y+a,b,f.height-a)));return new l.default(f.x,f.y,b,a)};b.prototype.release=function(b){for(var a=0;a<this._free.length;++a){var f=this._free[a];if(f.y===b.y&&f.height===b.height&&f.x+f.width===b.x)f.width+=b.width;else if(f.x===b.x&&f.width===b.width&&f.y+f.height===b.y)f.height+=b.height;else if(b.y===
f.y&&b.height===f.height&&b.x+b.width===f.x)f.x=b.x,f.width+=b.width;else if(b.x===f.x&&b.width===f.width&&b.y+b.height===f.y)f.y=b.y,f.height+=b.height;else continue;this._free.splice(a,1);this.release(b)}this._free.push(b)};return b}()})},"esri/views/2d/engine/webgl/GlyphSource":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../request ../../../../core/pbf ../../../../core/promiseUtils".split(" "),function(g,b,l,k,f,a){var q=function(){function a(c){this._metrics=
[];for(this._bitmaps=[];c.next();)switch(c.tag()){case 1:for(var a=c.getMessage();a.next();)switch(a.tag()){case 3:for(var d=a.getMessage(),b=void 0,n=void 0,m=void 0,f=void 0,k=void 0,t=void 0,q=void 0;d.next();)switch(d.tag()){case 1:b=d.getUInt32();break;case 2:n=d.getBytes();break;case 3:m=d.getUInt32();break;case 4:f=d.getUInt32();break;case 5:k=d.getSInt32();break;case 6:t=d.getSInt32();break;case 7:q=d.getUInt32();break;default:d.skip()}d.release();b&&(this._metrics[b]={width:m,height:f,left:k,
top:t,advance:q},this._bitmaps[b]=n);break;default:a.skip()}a.release();break;default:c.skip()}}a.prototype.getMetrics=function(c){return this._metrics[c]};a.prototype.getBitmap=function(c){return this._bitmaps[c]};return a}(),m=function(){function a(){this._ranges=[]}a.prototype.getRange=function(c){return this._ranges[c]};a.prototype.addRange=function(c,a){this._ranges[c]=a};return a}();return function(){function d(c){this._glyphInfo={};this._baseURL=c}d.prototype.getRange=function(c,e,d){var h=
this._getFontStack(c);if(h.getRange(e))return a.resolve();var b=256*e,m=b+255;c=this._baseURL.replace("{fontstack}",c).replace("{range}",b+"-"+m);return k(c,l({responseType:"array-buffer"},d)).then(function(c){h.addRange(e,new q(new f(new Uint8Array(c.data),new DataView(c.data))))})};d.prototype.getGlyph=function(c,a){if(c=this._getFontStack(c)){var e=Math.floor(a/256);if(!(256<e)&&(c=c.getRange(e)))return{metrics:c.getMetrics(a),bitmap:c.getBitmap(a)}}};d.prototype._getFontStack=function(c){var a=
this._glyphInfo[c];a||(a=this._glyphInfo[c]=new m);return a};return d}()})},"esri/views/2d/engine/webgl/SDFConverter":function(){define(["require","exports","../../../../core/promiseUtils","../../../../core/promiseUtils","./packingUtils"],function(g,b,l,k,f){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function a(a){this.size=a;this.canvas=document.createElement("canvas");this.canvas.width=this.canvas.height=a;this.context=this.canvas.getContext("2d");this._gridOuter=new Float64Array(a*
a);this._gridInner=new Float64Array(a*a);this._f=new Float64Array(a);this._d=new Float64Array(a);this._z=new Float64Array(a+1);this._v=new Int16Array(a)}a.prototype.draw=function(a,b,d){var c=this;void 0===d&&(d=31);this._initSVG();var e=this._createSVGString(a);return l.create(function(a,p){var h=new Image;h.src="data:image/svg+xml; charset\x3dutf8, "+encodeURIComponent(e);h.onload=function(){c.context.clearRect(0,0,c.size,c.size);c.context.drawImage(h,0,0,c.size,c.size);for(var e=c.context.getImageData(0,
0,c.size,c.size),b=new Uint8Array(c.size*c.size*4),n=0;n<c.size*c.size;n++){var p=e.data[4*n+3]/255;c._gridOuter[n]=1===p?0:0===p?1E20:Math.pow(Math.max(0,.5-p),2);c._gridInner[n]=1===p?1E20:0===p?0:Math.pow(Math.max(0,p-.5),2)}c._edt(c._gridOuter,c.size,c.size);c._edt(c._gridInner,c.size,c.size);for(n=0;n<c.size*c.size;n++)f.packFloatRGBA(.5-(c._gridOuter[n]-c._gridInner[n])/(2*d),b,4*n);a(b)};var m=b&&b.signal;if(m)k.onAbort(m,function(){return p(k.createAbortError())})})};a.prototype._initSVG=
function(){if(!this._svg){var a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.setAttribute("style","position: absolute;");a.setAttribute("width","0");a.setAttribute("height","0");a.setAttribute("aria-hidden","true");a.setAttribute("role","presentation");document.body.appendChild(a);this._svg=a}};a.prototype._createSVGString=function(a){var b=document.createElementNS("http://www.w3.org/2000/svg","path");b.setAttribute("d",a);this._svg.appendChild(b);a=b.getBBox();var d=a.width/a.height,
c=this.size/2,e,h,p;1<d?(h=e=c/a.width,p=this.size/4,d=c-1/d*c/2):(e=h=c/a.height,p=c-c*d/2,d=this.size/4);b.setAttribute("style","transform: matrix("+e+", 0, 0, "+h+", "+(-a.x*e+p)+", "+(-a.y*h+d)+")");a='\x3csvg style\x3d"fill:red;" height\x3d"'+this.size+'" width\x3d"'+this.size+'" xmlns\x3d"http://www.w3.org/2000/svg"\x3e'+this._svg.innerHTML+"\x3c/svg\x3e";this._svg.removeChild(b);return a};a.prototype._edt=function(a,b,d){for(var c=this._f,e=this._d,h=this._v,p=this._z,n=0;n<b;n++){for(var m=
0;m<d;m++)c[m]=a[m*b+n];this._edt1d(c,e,h,p,d);for(m=0;m<d;m++)a[m*b+n]=e[m]}for(m=0;m<d;m++){for(n=0;n<b;n++)c[n]=a[m*b+n];this._edt1d(c,e,h,p,b);for(n=0;n<b;n++)a[m*b+n]=Math.sqrt(e[n])}};a.prototype._edt1d=function(a,b,d,c,e){d[0]=0;c[0]=-1E20;c[1]=1E20;for(var h=1,p=0;h<e;h++){for(var n=(a[h]+h*h-(a[d[p]]+d[p]*d[p]))/(2*h-2*d[p]);n<=c[p];)p--,n=(a[h]+h*h-(a[d[p]]+d[p]*d[p]))/(2*h-2*d[p]);p++;d[p]=h;c[p]=n;c[p+1]=1E20}for(p=h=0;h<e;h++){for(;c[p+1]<h;)p++;b[h]=(h-d[p])*(h-d[p])+a[d[p]]}};return a}();
b.default=g})},"esri/views/2d/engine/webgl/packingUtils":function(){define(["require","exports"],function(g,b){function l(a){return a-Math.floor(a)}Object.defineProperty(b,"__esModule",{value:!0});var k=[1,256,65536,16777216],f=[1/256,1/65536,1/16777216,1/4294967296],a=function(a,b){void 0===b&&(b=0);for(var d=0,c=0;4>c;c++)d+=a[b+c]*f[c];return d}(new Uint8ClampedArray([255,255,255,255]));b.packFloatRGBA=function(b,m,d){void 0===d&&(d=0);b=0>b?0:b>a?a:b;for(var c=0;4>c;c++)m[d+c]=Math.floor(256*
l(b*k[c]))}})},"esri/views/2d/engine/webgl/SpriteMosaic":function(){define("require exports ../../../../core/Error ../../../../core/has ../../../../core/maybe ../../../webgl ./GeometryUtils ./Rect ./RectangleBinPack".split(" "),function(g,b,l,k,f,a,q,m,d){function c(a){return a&&"static"===a.type}return function(){function e(a,c,e,b){void 0===b&&(b=0);this._mosaicPages=[];this._currentPage=this._maxItemSize=0;this._fixSpriteLocationsTable=k("fix-sprite-locations");this._testId=k("test-id");this._pageHeight=
this._pageWidth=0;this._mosaicRects=new Map;this._spriteCopyQueue=[];this.pixelRatio=1;(0>=c||0>=e)&&console.error("Sprites mosaic defaultWidth and defaultHeight must be greater than zero!");this._pageWidth=c;this._pageHeight=e;this._requestRender=a;0<b&&(this._maxItemSize=b);this.pixelRatio=window.devicePixelRatio||1;if(this._fixSpriteLocationsTable){a=[];for(var h in this._fixSpriteLocationsTable[this._testId])c=this._fixSpriteLocationsTable[this._testId][h],a[c.page]=c.pageSize;for(h=0;h<a.length;h++)c=
a[h],this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(c[0]*c[1])},size:[c[0],c[1]],dirty:!0,texture:void 0})}this._binPack=new d(this._pageWidth,this._pageHeight);this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(Math.floor(this._pageWidth)*Math.floor(this._pageHeight))},size:[this._pageWidth,this._pageHeight],dirty:!0,texture:void 0})}e.prototype.getWidth=function(a){return a>=this._mosaicPages.length?-1:this._mosaicPages[a].size[0]};e.prototype.getHeight=
function(a){return a>=this._mosaicPages.length?-1:this._mosaicPages[a].size[1]};e.prototype.getPageTexture=function(a){return a<this._mosaicPages.length?this._mosaicPages[a].texture:null};e.prototype.has=function(a){return this._mosaicRects.has(a)};Object.defineProperty(e.prototype,"itemCount",{get:function(){return this._mosaicRects.size},enumerable:!0,configurable:!0});e.prototype.getSpriteItem=function(a){return this._mosaicRects.get(a)};e.prototype.addSpriteItem=function(a,e,d,b,f,k){var h;if(this._mosaicRects.has(a))return this._mosaicRects.get(a);
var n,p;c(d)?this._fixSpriteLocationsTable&&this._fixSpriteLocationsTable[this._testId]&&this._fixSpriteLocationsTable[this._testId][a]?(h=this._fixSpriteLocationsTable[this._testId][a],n=h.rect,p=h.page,h=h.pageSize):(h=this._allocateImage(e[0],e[1]),n=h[0],p=h[1],h=h[2]):(n=new m.default(0,0,e[0],e[1]),p=this._mosaicPages.length,this._mosaicPages.push({mosaicsData:d,size:e,dirty:!0,texture:void 0}));if(0>=n.width||0>=n.height)return null;k={rect:n,width:e[0],height:e[1],sdf:f,simplePattern:k,pixelRatio:1,
page:p};this._mosaicRects.set(a,k);c(d)&&this._copy({rect:n,spriteSize:e,spriteData:d.data,page:p,pageSize:h,repeat:b,sdf:f});return k};e.prototype.hasItemsToProcess=function(){return 0!==this._spriteCopyQueue.length};e.prototype.processNextItem=function(){var a=this._spriteCopyQueue.pop();a&&this._copy(a)};e.prototype.getSpriteItems=function(a){for(var c={},e=0;e<a.length;e++){var d=a[e];c[d]=this.getSpriteItem(d)}return c};e.prototype.getMosaicItemPosition=function(a){var c=(a=this.getSpriteItem(a))&&
a.rect;if(!c)return null;c.width=a.width;c.height=a.height;var e=this._mosaicPages[a.page];return{size:[a.width,a.height],tl:[(c.x+1)/e[0],(c.y+1)/e[1]],br:[(c.x+1+a.width)/e[0],(c.y+1+a.height)/e[1]],page:a.page}};e.prototype.bind=function(e,d,b,m){void 0===b&&(b=0);void 0===m&&(m=0);b=this._mosaicPages[b];var h=b.mosaicsData,n=b.texture;n||(n=b.size,n=c(h)?new a.Texture(e,{pixelFormat:6408,dataType:5121,width:n[0],height:n[1]},new Uint8Array(h.data.buffer)):new a.Texture(e,{pixelFormat:6408,dataType:5121,
samplingMode:9729,wrapMode:33071,width:n[0],height:n[1]},null),b.texture=n);n.setSamplingMode(d);c(h)?(e.bindTexture(n,m),b.dirty&&(n.setData(new Uint8Array(h.data.buffer)),n.generateMipmap())):(d=h.data,h=d.bindFrame(e,n,m),f.isSome(this._requestRender)&&h&&0<d.frameCount&&this._requestRender.requestRender(),d.bindFrame(e,n,m));b.dirty=!1};e._copyBits=function(a,c,e,d,b,m,f,k,r,q,l){var h=d*c+e;f=k*m+f;if(l)for(f-=m,l=-1;l<=q;l++,h=((l+q)%q+d)*c+e,f+=m)for(k=-1;k<=r;k++)b[f+k]=a[h+(k+r)%r];else for(l=
0;l<q;l++){for(k=0;k<r;k++)b[f+k]=a[h+k];h+=c;f+=m}};e.prototype._copy=function(a){if(!(a.page>=this._mosaicPages.length)){var d=this._mosaicPages[a.page],h=d.mosaicsData;if(!c(d.mosaicsData))throw new l("mapview-invalid-resource","unsuitable data type!");var b=a.spriteData;(h=h.data)&&b||console.error("Source or target images are uninitialized!");e._copyBits(b,a.spriteSize[0],0,0,h,a.pageSize[0],a.rect.x+1,a.rect.y+1,a.spriteSize[0],a.spriteSize[1],a.repeat);d.dirty=!0}};e.prototype._allocateImage=
function(a,e){a+=2;e+=2;var h=Math.max(a,e);if(this._maxItemSize&&this._maxItemSize<h){var h=Math.pow(2,Math.ceil(q.log2(a))),b=Math.pow(2,Math.ceil(q.log2(e)));a=new m.default(0,0,a,e);this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(h*b)},size:[h,b],dirty:!0,texture:void 0});return[a,this._mosaicPages.length-1,[h,b]]}h=this._binPack.allocate(a,e);return 0>=h.width?(h=this._mosaicPages[this._currentPage],!h.dirty&&c(h.mosaicsData)&&(h.mosaicsData=null),this._currentPage=this._mosaicPages.length,
this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(this._pageWidth*this._pageHeight)},size:[this._pageWidth,this._pageHeight],dirty:!0,texture:void 0}),this._binPack=new d(this._pageWidth,this._pageHeight),this._allocateImage(a,e)):[h,this._currentPage,[this._pageWidth,this._pageHeight]]};e.prototype.dispose=function(){this._binPack=null;for(var a=0,e=this._mosaicPages;a<e.length;a++){var d=e[a],b=d.texture;b&&b.dispose();d=d.mosaicsData;c(d)||d.data.pause()}this._mosaicPages=
null;this._mosaicRects.clear()};return e}()})},"esri/views/2d/engine/webgl/GeometryUtils":function(){define(["require","exports"],function(g,b){function l(b,a){b%=a;return 0<=b?b:b+a}Object.defineProperty(b,"__esModule",{value:!0});b.C_INFINITY=Number.POSITIVE_INFINITY;b.C_PI=Math.PI;b.C_2PI=2*b.C_PI;b.C_PI_BY_2=b.C_PI/2;b.C_RAD_TO_256=128/b.C_PI;b.C_256_TO_RAD=b.C_PI/128;b.C_DEG_TO_256=256/360;b.C_DEG_TO_RAD=b.C_PI/180;b.C_SQRT2=1.414213562;b.C_SQRT2_INV=1/b.C_SQRT2;var k=1/Math.LN2;b.positiveMod=
l;b.radToByte=function(f){return l(f*b.C_RAD_TO_256,256)};b.degToByte=function(f){return l(f*b.C_DEG_TO_256,256)};b.log2=function(b){return Math.log(b)*k};b.sqr=function(b){return b*b};b.interpolate=function(b,a,k){return b*(1-k)+a*k};b.between=function(b,a,k){return b>=a&&b<=k||b>=k&&b<=a}})},"esri/views/2d/engine/webgl/animatedFormats/apng":function(){define("require exports ../../../../../core/tsSupport/generatorHelper ../../../../../core/tsSupport/awaiterHelper ../../../../../core/tsSupport/assignHelper ../../../../../core/Error ../../../../../core/promiseUtils".split(" "),
function(g,b,l,k,f,a,q){function m(a){var c=a.constructor===Uint8Array?a:new Uint8Array(a);return w.some(function(a,e){return a!==c[e]})?!1:!0}function d(a,e){var d=new Uint8Array(e);if(w.some(function(a,c){return a!==d[c]}))return v;var b=!1;c(d,function(a){return!(b="acTL"===a)});if(!b)return t;var m=[],f=[],k=null,q=null,l=0;c(d,function(c,e,d,b){var n=new DataView(e.buffer);switch(c){case "IHDR":k=e.subarray(d+8,d+8+b);a.width=n.getUint32(d+8);a.height=n.getUint32(d+12);break;case "acTL":a.numPlays=
n.getUint32(d+8+4);break;case "fcTL":q&&(a.frames.push(q),l++);q=new r;q.width=n.getUint32(d+8+4);q.height=n.getUint32(d+8+8);q.left=n.getUint32(d+8+12);q.top=n.getUint32(d+8+16);c=n.getUint16(d+8+20);e=n.getUint16(d+8+22);0===e&&(e=100);q.delay=1E3*c/e;10>=q.delay&&(q.delay=100);a.playTime+=q.delay;q.disposeOp=n.getUint8(d+8+24);q.blendOp=n.getUint8(d+8+25);q.dataParts=[];0===l&&2===q.disposeOp&&(q.disposeOp=1);break;case "fdAT":q&&q.dataParts.push(e.subarray(d+8+4,d+8+b));break;case "IDAT":q&&q.dataParts.push(e.subarray(d+
8,d+8+b));break;case "IEND":f.push(h(e,d,12+b));break;default:m.push(h(e,d,12+b))}});if(0===a.frames.length)return t;a.frameCount=a.frames.length;var u=new Blob(m),g=new Blob(f);a.frames.forEach(function(a){var c=[];c.push(w);k.set(n(a.width),0);k.set(n(a.height),4);c.push(p("IHDR",k));c.push(u);a.dataParts.forEach(function(a){return c.push(p("IDAT",a))});c.push(g);a.data=new Blob(c,{type:"image/png"});delete a.dataParts;c=null});return a}function c(a,c){var e=new DataView(a.buffer),d=8,h,b,n;do b=
e.getUint32(d),h=d+4,h=Array.prototype.slice.call(a.subarray(h,h+4)),h=String.fromCharCode.apply(String,h),n=c(h,a,d,b),d+=12+b;while(!1!==n&&"IEND"!==h&&d<a.length)}function e(a){for(var c=new Uint8Array(a.length),e=0;e<a.length;e++)c[e]=a.charCodeAt(e);return c}function h(a,c,e){var d=new Uint8Array(e);d.set(a.subarray(c,c+e));return d}function p(a,c){var d=a.length+c.length,h=new Uint8Array(d+8),b=new DataView(h.buffer);b.setUint32(0,c.length);h.set(e(a),4);h.set(c,8);var n=4,p=d;void 0===n&&(n=
0);void 0===p&&(p=h.length-n);a=-1;c=n;for(n+=p;c<n;c++)a=a>>>8^u[(a^h[c])&255];b.setUint32(d+4,a^-1);return h}function n(a){return new Uint8Array([a>>>24&255,a>>>16&255,a>>>8&255,a&255])}Object.defineProperty(b,"__esModule",{value:!0});var u=new Uint32Array(256);for(g=0;256>g;g++){f=g;for(var x=0;8>x;x++)f=0!==(f&1)?3988292384^f>>>1:f>>>1;u[g]=f}var v=new a("Not a PNG"),t=new a("Not an animated PNG"),w=new Uint8Array([137,80,78,71,13,10,26,10]);b.isPNG=m;b.getPNGSize=function(a){a=new Uint8Array(a);
var e,d;c(a,function(a,c,h){c=new DataView(c.buffer);"IHDR"===a&&(e=c.getUint32(h+8),d=c.getUint32(h+12))});return[e,d]};b.isAnimatedPNG=function(a){a=new Uint8Array(a);if(!m(a))return!1;var e=!1;c(a,function(a){return!(e="acTL"===a)});return e};g=function(){function c(){this.playTime=this.numPlays=this.height=this.width=0;this.frames=[];this.playing=this.paused=!1;this.playSpeed=1;this.currentFrameNumber=0;this._lastUsedFrame=-1}c.create=function(e,d){return k(this,void 0,void 0,function(){var h,
b;return l(this,function(n){switch(n.label){case 0:h=new c,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,h._load(e,d)];case 2:return n.sent(),[3,4];case 3:return b=n.sent(),q.isAbortError(b)?[3,4]:[2,new a("invalid-resource","Could not load PNG: "+b.message)];case 4:return[2,h]}})})};c.prototype.play=function(){this.playing||(this.paused=!1,this.playing=!0,this._play())};c.prototype.pause=function(){this.paused=!0;this.playing=!1;clearTimeout(this.timerID)};c.prototype.togglePlay=function(){this.paused||
!this.playing?this.play():this.pause()};c.prototype.bindFrame=function(a,c,e){a.bindTexture(c,e);a=this.frameChanged();if(!a)return!1;e=this.currentFrame;var d=e.frameData,h=c.descriptor;(e.left||e.top||e.width!==h.width||e.height!==h.height)&&c.setData(null);c.updateData(0,e.left,e.top,e.width,e.height,d);this.updateUsedFrame();return a};c.prototype.frameChanged=function(){return this._lastUsedFrame!==this.currentFrameNumber};c.prototype.updateUsedFrame=function(){this._lastUsedFrame=this.currentFrameNumber};
c.prototype._load=function(c,e){return k(this,void 0,void 0,function(){var e,h,b=this;return l(this,function(n){switch(n.label){case 0:n.trys.push([0,2,,3]);e=d(this,c);if(e!==this)return[2,e];this._resizeCanvas=document.createElement("canvas");this._resizeCanvas.width=this.width;this._resizeCanvas.height=this.height;return[4,q.all(this.frames.map(function(a){return a.createImage(b._resizeCanvas)}))];case 1:return n.sent(),[3,3];case 2:return h=n.sent(),q.isAbortError(h)?[3,3]:[2,new a("invalid-resource",
"Could not parse PNG")];case 3:return this.play(),[2]}})})};c.prototype._play=function(){var a=this,c;if(0===this.playSpeed)this.pause();else{0>this.playSpeed?(--this.currentFrameNumber,0>this.currentFrameNumber&&(this.currentFrameNumber=this.frames.length-1),c=this.currentFrameNumber,--c,0>c&&(c=this.frames.length-1),c=1*-this.frames[c].delay/this.playSpeed):(this.currentFrameNumber+=1,this.currentFrameNumber%=this.frames.length,c=1*this.frames[this.currentFrameNumber].delay/this.playSpeed);var e=
this.frames[this.currentFrameNumber];this.currentFrame={frameData:e.imageData,top:e.top,left:e.left,width:e.width,height:e.height};this.timerID=window.setTimeout(function(){return a._play()},c)}};return c}();b.default=g;var r=function(){function a(){this.blendOp=this.disposeOp=this.delay=this.height=this.width=this.top=this.left=0;this.imageData=this.data=null}a.prototype.createImage=function(a){return k(this,void 0,void 0,function(){var c=this;return l(this,function(e){return null!==this.imageData?
[2]:[2,q.create(function(e,d){var h=URL.createObjectURL(c.data),b=document.createElement("img");b.onload=function(){URL.revokeObjectURL(h);var d;a.width=b.width;a.height=b.height;d=a.getContext("2d");d.drawImage(b,0,0,b.width,b.height);d=d.getImageData(0,0,b.width,b.height);d=new Uint8Array(d.data);for(var n,p=0;p<d.length;p+=4)n=d[p+3]/255,d[p]*=n,d[p+1]*=n,d[p+2]*=n;d=new ImageData(new Uint8ClampedArray(d.buffer),b.width,b.height);c.imageData=d;e()};b.onerror=function(){URL.revokeObjectURL(h);c.imageData=
null;d(Error("Image creation error"))};b.src=h})]})})};return a}()})},"esri/views/2d/engine/webgl/animatedFormats/gif":function(){define("require exports ../../../../../core/tsSupport/generatorHelper ../../../../../core/tsSupport/awaiterHelper ../../../../../core/tsSupport/assignHelper ../../../../../core/Error ../../../../../core/promiseUtils".split(" "),function(g,b,l,k,f,a,q){function m(a){if(!a||0===a.byteLength)return!1;a=a.constructor===Uint8Array?a:new Uint8Array(a);return 71===a[0]&&73===
a[1]&&70===a[2]&&56===a[3]}Object.defineProperty(b,"__esModule",{value:!0});b.isGIF=m;b.getGIFSize=function(a){var c=new Uint8ClampedArray(a),d=6;a=c[d++]+(c[d++]<<8);c=c[d++]+(c[d++]<<8);return[a,c]};b.isAnimatedGIF=function(a){if(!a||0===a.byteLength)return!1;a=new Uint8Array(a);if(!m(a))return!1;for(var c=0,d=0,b=a.length-9;d<b&&(0!==a[d]||33!==a[d+1]||249!==a[d+2]||4!==a[d+3]||0!==a[d+8]||44!==a[d+9]&&33!==a[d+9]||(c++,!(1<c)));++d);return 1<c};g=function(){function c(){this.playing=this.paused=
!1;this.waitTillDone=!0;this.firstFrameOnly=this.loading=!1;this.frames=[];this.comment="";this.frameCount=this.currentFrameNumber=this.length=0;this.playSpeed=1;this.lastFrame=null;this.playOnLoad=!0;this.complete=!1;this.interlaceOffsets=[0,4,2,1];this.interlaceSteps=[8,8,4,2];this._lastUsedFrame=-1}c.create=function(e,d){return k(this,void 0,void 0,function(){var b,h;return l(this,function(n){switch(n.label){case 0:b=new c,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,b._load(e,d)];case 2:return n.sent(),
[3,4];case 3:return h=n.sent(),q.isAbortError(h)?[3,4]:[2,new a("invalid-resource","Could not load PNG: "+h.message)];case 4:return[2,b]}})})};c.prototype.play=function(){this.playing||(this.paused=!1,this.playing=!0,this._play())};c.prototype.pause=function(){this.paused=!0;this.playing=!1;clearTimeout(this.timerID)};c.prototype.togglePlay=function(){this.paused||!this.playing?this.play():this.pause()};c.prototype.bindFrame=function(a,c,d){a.bindTexture(c,d);if(a=this.frameChanged())d=this.currentFrame,
c.updateData(0,0,0,d.width,d.height,d.frameData),this.updateUsedFrame();return a};c.prototype.seekFrame=function(a){clearTimeout(this.timerID);this.currentFrameNumber=a%this.frames.length;this.playing?this._play():this._setCurrentFrame(this.currentFrameNumber)};c.prototype.seek=function(a){clearTimeout(this.timerID);0>a&&(a=0);a=1E3*a%this.length;for(var c=0;a>this.frames[c].time+this.frames[c].delay&&c<this.frames.length;)c+=1;this.currentFrameNumber=c;this.playing?this._play():this._setCurrentFrame(this.currentFrameNumber)};
c.prototype.frameChanged=function(){return this._lastUsedFrame!==this.currentFrameNumber};c.prototype.updateUsedFrame=function(){this._lastUsedFrame=this.currentFrameNumber};c.prototype._load=function(c,d){return k(this,void 0,void 0,function(){var e;return l(this,function(b){switch(b.label){case 0:return b.trys.push([0,2,,3]),this.loading=!0,[4,this._parse(c,d)];case 1:return b.sent(),this.loading=!1,this.play(),[3,3];case 2:return e=b.sent(),q.isAbortError(e)?[3,3]:[2,new a("invalid-resource","Could not parse gif!")];
case 3:return[2]}})})};c.prototype._parse=function(a,c){var e=this,b=new d(a);b.pos+=6;this.width=b.data[b.pos++]+(b.data[b.pos++]<<8);this.height=b.data[b.pos++]+(b.data[b.pos++]<<8);a=b.data[b.pos++];this.globalColourCount=1<<(a&7)+1;b.pos++;b.pos++;a&128&&(this.globalColourTable=this._parseColourTable(this.globalColourCount,b));return q.create(function(a,d){setTimeout(function(){return e._parseBlock(b,a,d,c)},0)})};c.prototype._parseBlock=function(a,c,d,b){return k(this,void 0,void 0,function(){var e,
h=this;return l(this,function(n){if(b&&b.signal&&q.isAborted(b.signal))return d(q.createAbortError()),[2];e=a.data[a.pos++];if(44===e){if(this._parseImg(a),this.firstFrameOnly)return this._finishedLoading(),c(),[2]}else{if(59===e)return this._finishedLoading(),c(),[2];this._parseExt(a)}if("function"===typeof this.onprogress)this.onprogress({bytesRead:a.pos,totalBytes:a.data.length,frame:this.frames.length});setTimeout(function(){return h._parseBlock(a,c,d,b)},0);return[2]})})};c.prototype._parseColourTable=
function(a,c){for(var e=[],d=0;d<a;d++)e.push([c.data[c.pos++],c.data[c.pos++],c.data[c.pos++]]);return e};c.prototype._parseImg=function(a){var c={};this.frames.push(c);c.disposalMethod=this.disposalMethod;c.time=this.length;c.delay=10*this.delayTime;this.length+=c.delay;c.transparencyIndex=this.transparencyGiven?this.transparencyIndex:void 0;c.leftPos=a.data[a.pos++]+(a.data[a.pos++]<<8);c.topPos=a.data[a.pos++]+(a.data[a.pos++]<<8);c.width=a.data[a.pos++]+(a.data[a.pos++]<<8);c.height=a.data[a.pos++]+
(a.data[a.pos++]<<8);var e=a.data[a.pos++];c.localColourTableFlag=e&128?!0:!1;c.localColourTableFlag&&(c.localColourTable=this._parseColourTable(1<<(e&7)+1,a));this.pixelBufSize!==c.width*c.height&&(this.pixelBuf=new Uint8Array(c.width*c.height),this.pixelBufSize=c.width*c.height);this._lzwDecode(a.data[a.pos++],a.readSubBlocksB());if(e&64){c.interlaced=!0;a=c.width;e=this.pixelBufSize/a;this.interlacedBufSize!==this.pixelBufSize&&(this.deinterlaceBuf=new Uint8Array(this.pixelBufSize),this.interlacedBufSize=
this.pixelBufSize);for(var d=0,b=0;4>b;b++)for(var m=this.interlaceOffsets[b];m<e;m+=this.interlaceSteps[b])this.deinterlaceBuf.set(this.pixelBuf.subarray(d,d+a),m*a),d+=a}else c.interlaced=!1;this._processFrame(c)};c.prototype._lzwDecode=function(a,c){var e,d,b,h,m,f,k,r,q,l;b=d=0;var g=[];h=1<<a;m=h+1;f=a+1;for(l=!1;!l;){r=k;for(e=k=0;e<f;e++)c[b>>3]&1<<(b&7)&&(k|=1<<e),b++;if(k===h){g=[];f=a+1;for(e=0;e<h;e++)g[e]=[e];g[h]=[];g[m]=null}else{if(k===m){l=!0;break}k>=g.length?g.push(g[r].concat(g[r][0])):
r!==h&&g.push(g[r].concat(g[k][0]));r=g[k];q=r.length;for(e=0;e<q;e++)this.pixelBuf[d++]=r[e];g.length===1<<f&&12>f&&f++}}};c.prototype._processFrame=function(a){a.image=document.createElement("canvas");a.image.width=this.width;a.image.height=this.height;a.ctx=a.image.getContext("2d");var c=a.localColourTableFlag?a.localColourTable:this.globalColourTable;null===this.lastFrame&&(this.lastFrame=a);var e=2===this.lastFrame.disposalMethod||3===this.lastFrame.disposalMethod?!0:!1;e||a.ctx.drawImage(this.lastFrame.image,
0,0,this.width,this.height);for(var d=a.ctx.getImageData(a.leftPos,a.topPos,a.width,a.height),b=a.transparencyIndex,m=d.data,f=a.interlaced?this.deinterlaceBuf:this.pixelBuf,k=f.length,q=0,r,l,g=0;g<k;g++)r=f[g],l=c[r],b!==r?(m[q++]=l[0],m[q++]=l[1],m[q++]=l[2],m[q++]=255):(e&&(m[q+3]=0),q+=4);a.ctx.putImageData(d,a.leftPos,a.topPos);this.lastFrame=a};c.prototype._parseExt=function(a){var c=a.data[a.pos++];249===c?this._parseGCExt(a):254===c?this.comment+=a.readSubBlocks():255===c?this._parseAppExt(a):
(1===c&&(a.pos+=13),a.readSubBlocks())};c.prototype._parseAppExt=function(a){a.pos+=1;"NETSCAPE"===a.getString(8)?a.pos+=8:(a.pos+=3,a.readSubBlocks())};c.prototype._parseGCExt=function(a){var c;a.pos++;c=a.data[a.pos++];this.disposalMethod=(c&28)>>2;this.transparencyGiven=c&1?!0:!1;this.delayTime=a.data[a.pos++]+(a.data[a.pos++]<<8);this.transparencyIndex=a.data[a.pos++];a.pos++};c.prototype._finishedLoading=function(){this.loading=!1;this.frameCount=this.frames.length;this.lastFrame=null;this.complete=
!0;this.deinterlaceBuf=this.pixelBufSize=this.deinterlaceBuf=this.pixelBuf=this.waitTillDone=this.transparencyIndex=this.delayTime=this.transparencyGiven=this.disposalMethod=void 0;this.currentFrameNumber=0;0<this.frames.length&&this._setCurrentFrame(0);this.playOnLoad&&this.play()};c.prototype._play=function(){var a=this,c;0===this.playSpeed?this.pause():(0>this.playSpeed?(--this.currentFrameNumber,0>this.currentFrameNumber&&(this.currentFrameNumber=this.frames.length-1),c=this.currentFrameNumber,
--c,0>c&&(c=this.frames.length-1),c=1*-this.frames[c].delay/this.playSpeed):(this.currentFrameNumber+=1,this.currentFrameNumber%=this.frames.length,c=1*this.frames[this.currentFrameNumber].delay/this.playSpeed),this._setCurrentFrame(this.currentFrameNumber),this.timerID=window.setTimeout(function(){return a._play()},c))};c.prototype._setCurrentFrame=function(a){this.currentFrame={frameData:this.frames[a].image,top:0,left:0,width:this.width,height:this.height}};return c}();b.default=g;var d=function(){function a(a){this.pos=
0;this.data=new Uint8ClampedArray(a);this.len=this.data.length}a.prototype.getString=function(a){for(var c="";a--;)c+=String.fromCharCode(this.data[this.pos++]);return c};a.prototype.readSubBlocks=function(){var a,c,d="";do for(c=a=this.data[this.pos++];c--;)d+=String.fromCharCode(this.data[this.pos++]);while(0!==a&&this.pos<this.len);return d};a.prototype.readSubBlocksB=function(){var a,c,d=[];do for(c=a=this.data[this.pos++];c--;)d.push(this.data[this.pos++]);while(0!==a&&this.pos<this.len);return d};
return a}()})},"esri/views/2d/engine/webgl/util/BidiText":function(){define(["require","exports","../../../../../core/BidiEngine"],function(g,b,l){Object.defineProperty(b,"__esModule",{value:!0});var k=new l.default;b.bidiText=function(b){if(!k.hasBidiChar(b))return[b,!1];var a;a="rtl"===k.checkContextual(b)?"IDNNN":"ICNNN";return[k.bidiTransform(b,a,"VLYSN"),!0]}})},"esri/core/BidiEngine":function(){define(["require","exports","./bidiEngineTables"],function(g,b,l){function k(c,e,d,b,h){var n=c;void 0===
e&&(e=h.defInFormat);void 0===d&&(d=h.defOutFormat);void 0===b&&(b=h.defSwap);if(e!==d){var p=e.substring(0,1),r=d.substring(0,1),q;q=e.substring(1,4);var t=d.substring(1,4);"C"===q.charAt(0)&&(q=f(n),q="ltr"===q||"rtl"===q?q.toUpperCase():"L"===e.charAt(2)?"LTR":"RTL",e=p+q);"C"===t.charAt(0)&&(q=f(n),"rtl"===q?t="RTL":"ltr"===q?(n=n.split(""),n.reverse(),q=f(n.join("")),t=q.toUpperCase()):t="L"===d.charAt(2)?"LTR":"RTL",d=r+t)}if(e===d)return c;r=e.substring(0,1);n=e.substring(1,4);p=d.substring(0,
1);t=d.substring(1,4);h.inFormat=e;h.outFormat=d;h.swap=b;if("L"===r&&"VLTR"===d){if("LTR"===n)return h.dir=B,a(c,h);if("RTL"===n)return h.dir=C,a(c,h)}if("V"===r&&"V"===p)return h.dir="RTL"===n?C:B,m(c,h);if("L"===r&&"VRTL"===d)return h.dir="LTR"===n?B:C,c=a(c,h),m(c);if("VLTR"===e&&"LLTR"===d)return h.dir=B,a(c,h);if("V"===r&&"L"===p&&n!==t)return c=m(c),"RTL"===n?k(c,"LLTR","VLTR",b,h):k(c,"LRTL","VRTL",b,h);if("VRTL"===e&&"LRTL"===d)return k(c,"LRTL","VRTL",b,h);"L"===r&&"L"===p&&(e=h.swap,h.swap=
e.substr(0,1)+"N","RTL"===n?(h.dir=C,c=a(c,h),h.swap="N"+e.substr(1,2),h.dir=B,c=a(c,h)):(h.dir=B,c=a(c,h),h.swap="N"+e.substr(1,2),c=k(c,"VLTR","LRTL",h.swap,h)));return c}function f(a){return(a=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(a))?"z">=a[0]?"ltr":"rtl":""}function a(a,c){a=a.split("");var d=[];q(a,d,c);if(0!==c.hiLevel&&c.swap.substr(0,1)!==c.swap.substr(1,2))for(var b=0;b<a.length;b++)if(1===d[b]){var h=b,n;b:{n=a[b];for(var p=void 0,m=0,f=l.SwapTable.length-
1;m<=f;)if(p=Math.floor((m+f)/2),n<l.SwapTable[p][0])f=p-1;else if(n>l.SwapTable[p][0])m=p+1;else{n=l.SwapTable[p][1];break b}}a[h]=n}e(2,a,d,c);e(1,a,d,c);r=d;return a.join("")}function q(a,c,e){var d=a.length,b=e.dir?l.impTabRtl:l.impTabLtr,n=null,p=null,m=null,n=0,p=p=null,f=-1,k=p=null,r=[],q=[];e.hiLevel=e.dir;e.lastArabic=!1;e.hasUbatAl=!1;e.hasUbatB=!1;e.hasUbatS=!1;for(p=0;p<d;p++){var k=p,m=a[p].charCodeAt(0),t=l.MasterTable[m>>8];r[k]=t<l.TBBASE?t:l.UnicodeTable[t-l.TBBASE][m&255]}for(k=
0;k<d;k++){q[k]=p=h(a,r,q,k,e);n=b[n][p];p=n&240;n&=15;c[k]=m=b[n][A];if(0<p){if(16===p)for(p=f;p<k;p++)c[p]=1;f=-1}if(p=b[n][z])-1===f&&(f=k);else if(-1<f){for(p=f;p<k;p++)c[p]=m;f=-1}r[k]===l.UBAT_B&&(c[k]=0);e.hiLevel|=m}if(e.hasUbatS)for(a=0;a<d;a++)if(r[a]===l.UBAT_S)for(c[a]=e.dir,b=a-1;0<=b;b--)if(r[b]===l.UBAT_WS)c[b]=e.dir;else break}function m(a,c){a=a.split("");if(c){var e=[];q(a,e,c);r=e}a.reverse();t.reverse();return a.join("")}function d(a){for(var c=0;c<l.ArabicAlefBetIntervalsBegine.length;c++)if(a>=
l.ArabicAlefBetIntervalsBegine[c]&&a<=l.ArabicAlefBetIntervalsEnd[c])return!0;return!1}function c(a,c,e,b){for(;c*e<b&&n(a[c]);)c+=e;return c*e<b&&d(a[c])?!0:!1}function e(a,c,e,d){if(!(d.hiLevel<a))if(1!==a||d.dir!==C||d.hasUbatB){d=c.length;for(var b=0,h,n,p;b<d;){if(e[b]>=a){for(h=b+1;h<d&&e[h]>=a;)h++;for(n=h-1;b<n;b++,n--)p=c[b],c[b]=c[n],c[n]=p,p=t[b],t[b]=t[n],t[n]=p;b=h}b++}}else c.reverse(),t.reverse()}function h(a,c,e,d,b){return{UBAT_L:function(){b.lastArabic=!1;return l.UBAT_L},UBAT_R:function(){b.lastArabic=
!1;return l.UBAT_R},UBAT_ON:function(){return l.UBAT_ON},UBAT_AN:function(){return l.UBAT_AN},UBAT_EN:function(){return b.lastArabic?l.UBAT_AN:l.UBAT_EN},UBAT_AL:function(){b.lastArabic=!0;b.hasUbatAl=!0;return l.UBAT_R},UBAT_WS:function(){return l.UBAT_ON},UBAT_CS:function(){var a,h;if(1>d||d+1>=c.length||(a=e[d-1])!==l.UBAT_EN&&a!==l.UBAT_AN||(h=c[d+1])!==l.UBAT_EN&&h!==l.UBAT_AN)return l.UBAT_ON;b.lastArabic&&(h=l.UBAT_AN);return h===a?h:l.UBAT_ON},UBAT_ES:function(){return(0<d?e[d-1]:l.UBAT_B)===
l.UBAT_EN&&d+1<c.length&&c[d+1]===l.UBAT_EN?l.UBAT_EN:l.UBAT_ON},UBAT_ET:function(){if(0<d&&e[d-1]===l.UBAT_EN)return l.UBAT_EN;if(b.lastArabic)return l.UBAT_ON;for(var a=d+1,h=c.length;a<h&&c[a]===l.UBAT_ET;)a++;return a<h&&c[a]===l.UBAT_EN?l.UBAT_EN:l.UBAT_ON},UBAT_NSM:function(){if("VLTR"===b.inFormat){for(var h=c.length,n=d+1;n<h&&c[n]===l.UBAT_NSM;)n++;if(n<h&&(h=a[d].charCodeAt[0],n=c[n],(1425<=h&&2303>=h||64286===h)&&(n===l.UBAT_R||n===l.UBAT_AL)))return l.UBAT_R}return 1>d||c[d-1]===l.UBAT_B?
l.UBAT_ON:e[d-1]},UBAT_B:function(){b.lastArabic=!0;b.hasUbatB=!0;return b.dir},UBAT_S:function(){b.hasUbatS=!0;return l.UBAT_ON},UBAT_LRE:function(){b.lastArabic=!1;return l.UBAT_ON},UBAT_RLE:function(){b.lastArabic=!1;return l.UBAT_ON},UBAT_LRO:function(){b.lastArabic=!1;return l.UBAT_ON},UBAT_RLO:function(){b.lastArabic=!1;return l.UBAT_ON},UBAT_PDF:function(){b.lastArabic=!1;return l.UBAT_ON},UBAT_BN:function(){return l.UBAT_ON}}[l.TYPES_NAMES[c[d]]]()}function p(a,c){for(var e=0;e<l.BaseForm.length;e++)if(a===
l.BaseForm[e])return c[e];return a}function n(a){return"\u064b"<=a&&"\u0655">=a?!0:!1}function u(a){return"L"===a?"LTR":"R"===a?"RTL":"C"===a?"CLR":"D"===a?"CRL":""}function x(a,c){for(var e=0;e<l.AlefTable.length;e++)if(a===l.AlefTable[e])return c[e];return a}function v(a,c,e,d){for(var b=0;b<a.length;b++)if(a[b]>c||!e&&a[b]===c)a[b]+=d}Object.defineProperty(b,"__esModule",{value:!0});g=function(){function a(){this.inputFormat="ILYNN";this.outputFormat="VLNNN";this.sourceToTarget=[];this.targetToSource=
[];this.levels=[]}a.prototype.bidiTransform=function(a,e,b){this.sourceToTarget=[];this.targetToSource=[];if(!a)return"";var h=this.sourceToTarget,m=this.targetToSource,f=a.length;t=[];r=[];for(var q=0;q<f;q++)h[q]=q,m[q]=q,t[q]=q;if(!this.checkParameters(e,b))return a;e=this.inputFormat;b=this.outputFormat;var h=a,h=y,q=u(e.charAt(1)),m=u(b.charAt(1)),g="I"===e.charAt(0)?"L":e.charAt(0),f="I"===b.charAt(0)?"L":b.charAt(0),q=g+q,m=f+m,f=e.charAt(2)+b.charAt(2);h.defInFormat=q;h.defOutFormat=m;h.defSwap=
f;a=k(a,q,m,f,h);h=!1;if("R"===b.charAt(1))h=!0;else if("C"===b.charAt(1)||"D"===b.charAt(1))h="rtl"===this.checkContextual(a);m=this.sourceToTarget=t;f=Array(m.length);for(q=0;q<m.length;q++)f[m[q]]=q;w=this.targetToSource=f;if(e.charAt(3)===b.charAt(3))h=a;else if("S"===b.charAt(3))if(e=h,b=!0,0===a.length)h="";else{void 0===e&&(e=!0);void 0===b&&(b=!0);a=String(a);a=a.split("");var A=0,m=1,h=a.length;e||(A=a.length-1,m=-1,h=1);for(var f=h,q=b,C=0,h=[],g=0;A*m<f;A+=m)if(d(a[A])||n(a[A])){var z;
if(z="\u0644"===a[A])b:{for(var B=a,D=A+m,H=m,J=f;D*H<J&&n(B[D]);)D+=H;z=" ";if(D*H<J)for(z=B[D],B=0;B<l.AlefTable.length;B++)if(l.AlefTable[B]===z){z=!0;break b}z=!1}if(z){a[A]=0===C?x(a[A+m],l.LamAlefInialTableFE):x(a[A+m],l.LamAlefMedialTableFE);A+=m;C=a;z=A;B=m;for(D=f;z*B<D&&n(C[z]);)z+=B;z*B<D&&(C[z]=" ");q&&(h[g]=A,g++);C=0}else{z=a[A];if(1===C){B=A;if(c(a,A+m,m,f))b:for(D=a[A],H=0;H<l.BaseForm.length;H++){if(D===l.BaseForm[H]){D=l.MedialForm[H];break b}}else D=p(a[A],l.FinalForm);a[B]=D}else!0===
c(a,A+m,m,f)?a[A]=p(a[A],l.InitialForm):a[A]=p(a[A],l.IsolatedForm);n(z)||(C=1);b:{for(B=0;B<l.StandAlonForm.length;B++)if(l.StandAlonForm[B]===z){z=!0;break b}z=!1}!0===z&&(C=0)}}else C=0;m="";for(f=0;f<a.length;f++){if(q=b){b:{for(q=0;q<h.length;q++)if(h[q]===f)break b;q=-1}q=-1<q}q?(v(w,f,!e,-1),t.splice(f,1)):m+=a[f]}h=m}else if(e=a,b=h,a=!0,0===e.length)h="";else for(void 0===a&&(a=!0),void 0===b&&(b=!0),e=String(e),h="",m=e.split(""),f=0;f<e.length;f++)q=!1,"\ufe70"<=m[f]&&"\ufeff">m[f]?(g=
e.charCodeAt(f),"\ufef5"<=m[f]&&"\ufefc">=m[f]?(b?(0<f&&a&&" "===m[f-1]?h=h.substring(0,h.length-1)+"\u0644":(h+="\u0644",q=!0),h+=l.AlefTable[(g-65269)/2]):(h+=l.AlefTable[(g-65269)/2],h+="\u0644",f+1<e.length&&a&&" "===m[f+1]?f++:q=!0),q&&(v(w,f,!0,1),t.splice(f,0,t[f]))):h+=l.FETo06Table[g-65136]):h+=m[f];this.sourceToTarget=t;this.targetToSource=w;this.levels=r;return h};a.prototype._inputFormatSetter=function(a){if(!D.test(a))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");
this.inputFormat=a};a.prototype._outputFormatSetter=function(a){if(!D.test(a))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.outputFormat=a};a.prototype.checkParameters=function(a,c){a?this._inputFormatSetter(a):a=this.inputFormat;c?this._outputFormatSetter(c):c=this.outputFormat;return a===c?!1:!0};a.prototype.checkContextual=function(a){a=f(a);if("ltr"!==a&&"rtl"!==a){try{a=document.dir.toLowerCase()}catch(G){}"ltr"!==a&&"rtl"!==a&&(a="ltr")}return a};a.prototype.hasBidiChar=
function(a){return H.test(a)};return a}();b.default=g;var t=[],w=[],r=[],y={dir:0,defInFormat:"LLTR",defoutFormat:"VLTR",defSwap:"YN",inFormat:"LLTR",outFormat:"VLTR",swap:"YN",hiLevel:0,lastArabic:!1,hasUbatAl:!1,hasBlockSep:!1,hasSegSep:!1,defOutFormat:""},A=5,z=6,B=0,C=1,D=/^[(I|V)][(L|R|C|D)][(Y|N)][(S|N)][N]$/,H=/[\u0591-\u06ff\ufb1d-\ufefc]/})},"esri/core/bidiEngineTables":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});b.SwapTable=[["(",
")"],[")","("],["\x3c","\x3e"],["\x3e","\x3c"],["[","]"],["]","["],["{","}"],["}","{"],["\u00ab","\u00bb"],["\u00bb","\u00ab"],["\u2039","\u203a"],["\u203a","\u2039"],["\u207d","\u207e"],["\u207e","\u207d"],["\u208d","\u208e"],["\u208e","\u208d"],["\u2264","\u2265"],["\u2265","\u2264"],["\u2329","\u232a"],["\u232a","\u2329"],["\ufe59","\ufe5a"],["\ufe5a","\ufe59"],["\ufe5b","\ufe5c"],["\ufe5c","\ufe5b"],["\ufe5d","\ufe5e"],["\ufe5e","\ufe5d"],["\ufe64","\ufe65"],["\ufe65","\ufe64"]];b.AlefTable=["\u0622",
"\u0623","\u0625","\u0627"];b.LamAlefInialTableFE=["\ufef5","\ufef7","\ufef9","\ufefb"];b.LamAlefMedialTableFE=["\ufef6","\ufef8","\ufefa","\ufefc"];b.BaseForm="\u0627\u0628\u062a\u062b\u062c\u062d\u062e\u062f\u0630\u0631\u0632\u0633\u0634\u0635\u0636\u0637\u0638\u0639\u063a\u0641\u0642\u0643\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u06cc\u0626\u0624".split("");b.IsolatedForm="\ufe8d\ufe8f\ufe95\ufe99\ufe9d\ufea1\ufea5\ufea9\ufeab\ufead\ufeaf\ufeb1\ufeb5\ufeb9\ufebd\ufec1\ufec5\ufec9\ufecd\ufed1\ufed5\ufed9\ufedd\ufee1\ufee5\ufee9\ufeed\ufef1\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfc\ufe89\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe89\ufe85".split("");
b.FinalForm="\ufe8e\ufe90\ufe96\ufe9a\ufe9e\ufea2\ufea6\ufeaa\ufeac\ufeae\ufeb0\ufeb2\ufeb6\ufeba\ufebe\ufec2\ufec6\ufeca\ufece\ufed2\ufed6\ufeda\ufede\ufee2\ufee6\ufeea\ufeee\ufef2\ufe88\ufe84\ufe82\ufe94\ufef0\ufbfd\ufe8a\ufe86\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8a\ufe86".split("");b.MedialForm="\ufe8e\ufe92\ufe98\ufe9c\ufea0\ufea4\ufea8\ufeaa\ufeac\ufeae\ufeb0\ufeb4\ufeb8\ufebc\ufec0\ufec4\ufec8\ufecc\ufed0\ufed4\ufed8\ufedc\ufee0\ufee4\ufee8\ufeec\ufeee\ufef4\ufe88\ufe84\ufe82\ufe94\ufef0\ufbff\ufe8c\ufe86\ufe71\ufe72\ufe74\ufe77\ufe79\ufe7b\ufe7d\ufe7f\ufe80\ufe8c\ufe86".split("");
b.InitialForm="\ufe8d\ufe91\ufe97\ufe9b\ufe9f\ufea3\ufea7\ufea9\ufeab\ufead\ufeaf\ufeb3\ufeb7\ufebb\ufebf\ufec3\ufec7\ufecb\ufecf\ufed3\ufed7\ufedb\ufedf\ufee3\ufee7\ufeeb\ufeed\ufef3\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfe\ufe8b\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8b\ufe85".split("");b.StandAlonForm="\u0621\u0622\u0623\u0624\u0625\u0627\u0629\u062f\u0630\u0631\u0632\u0648\u0649".split("");b.FETo06Table="\u064b\u064b\u064c\u061f\u064d\u061f\u064e\u064e\u064f\u064f\u0650\u0650\u0651\u0651\u0652\u0652\u0621\u0622\u0622\u0623\u0623\u0624\u0624\u0625\u0625\u0626\u0626\u0626\u0626\u0627\u0627\u0628\u0628\u0628\u0628\u0629\u0629\u062a\u062a\u062a\u062a\u062b\u062b\u062b\u062b\u062c\u062c\u062c\u062c\u062d\u062d\u062d\u062d\u062e\u062e\u062e\u062e\u062f\u062f\u0630\u0630\u0631\u0631\u0632\u0632\u0633\u0633\u0633\u0633\u0634\u0634\u0634\u0634\u0635\u0635\u0635\u0635\u0636\u0636\u0636\u0636\u0637\u0637\u0637\u0637\u0638\u0638\u0638\u0638\u0639\u0639\u0639\u0639\u063a\u063a\u063a\u063a\u0641\u0641\u0641\u0641\u0642\u0642\u0642\u0642\u0643\u0643\u0643\u0643\u0644\u0644\u0644\u0644\u0645\u0645\u0645\u0645\u0646\u0646\u0646\u0646\u0647\u0647\u0647\u0647\u0648\u0648\u0649\u0649\u064a\u064a\u064a\u064a\ufef5\ufef6\ufef7\ufef8\ufef9\ufefa\ufefb\ufefc\u061f\u061f\u061f".split("");
b.ArabicAlefBetIntervalsBegine=["\u0621","\u0641"];b.ArabicAlefBetIntervalsEnd=["\u063a","\u064a"];b.impTabLtr=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]];b.impTabRtl=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]];b.UBAT_L=0;b.UBAT_R=1;b.UBAT_EN=2;b.UBAT_AN=3;b.UBAT_ON=4;b.UBAT_B=5;b.UBAT_S=6;b.UBAT_AL=7;b.UBAT_WS=8;b.UBAT_CS=9;b.UBAT_ES=10;b.UBAT_ET=11;b.UBAT_NSM=12;b.UBAT_LRE=13;b.UBAT_RLE=14;b.UBAT_PDF=15;b.UBAT_LRO=16;
b.UBAT_RLO=17;b.UBAT_BN=18;b.TYPES_NAMES="UBAT_L UBAT_R UBAT_EN UBAT_AN UBAT_ON UBAT_B UBAT_S UBAT_AL UBAT_WS UBAT_CS UBAT_ES UBAT_ET UBAT_NSM UBAT_LRE UBAT_RLE UBAT_PDF UBAT_LRO UBAT_RLO UBAT_BN".split(" ");b.TBBASE=100;g=b.UBAT_L;var l=b.UBAT_R,k=b.UBAT_EN,f=b.UBAT_AN,a=b.UBAT_ON,q=b.UBAT_B,m=b.UBAT_S,d=b.UBAT_AL,c=b.UBAT_WS,e=b.UBAT_CS,h=b.UBAT_ES,p=b.UBAT_ET,n=b.UBAT_NSM,u=b.UBAT_LRE,x=b.UBAT_RLE,v=b.UBAT_PDF,t=b.UBAT_LRO,w=b.UBAT_RLO,r=b.UBAT_BN;b.MasterTable=[b.TBBASE+0,g,g,g,g,b.TBBASE+1,b.TBBASE+
2,b.TBBASE+3,l,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,b.TBBASE+4,a,a,a,g,a,g,a,g,a,a,a,g,g,a,a,g,g,g,g,g,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,g,g,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,g,g,g,g,g,g,g,g,g,g,g,g,g,g,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,g,g,a,a,g,g,a,a,g,g,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,
g,g,g,b.TBBASE+5,d,d,b.TBBASE+6,b.TBBASE+7];b.UnicodeTable=[[r,r,r,r,r,r,r,r,r,m,q,m,c,q,r,r,r,r,r,r,r,r,r,r,r,r,r,r,q,q,q,m,c,a,a,p,p,p,a,a,a,a,a,h,e,h,e,e,k,k,k,k,k,k,k,k,k,k,e,a,a,a,a,a,a,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,a,a,a,a,a,a,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,a,a,a,a,r,r,r,r,r,r,q,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,e,a,p,p,p,p,a,a,a,a,g,a,a,r,a,a,p,p,k,k,a,g,a,a,a,k,g,a,a,a,a,a,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,a,g,g,g,g,
g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,a,g,g,g,g,g,g,g,g],[g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,a,a,a,a,a,a,a,a,a,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,a,a,g,g,g,g,g,g,g,a,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,a,g,a,a,a,a,a,a,a,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,l,n,l,n,n,l,n,n,l,n,a,a,a,a,a,a,a,a,l,l,l,l,l,l,
l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,a,a,a,a,a,l,l,l,l,l,a,a,a,a,a,a,a,a,a,a,a],[f,f,f,f,a,a,a,a,d,p,p,d,e,d,a,a,n,n,n,n,n,n,n,n,n,n,n,d,a,a,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,f,f,f,f,f,f,f,f,f,f,p,f,f,d,d,d,n,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,
d,d,d,d,d,d,n,n,n,n,n,n,n,f,a,n,n,n,n,n,n,d,d,n,n,a,n,n,n,n,d,d,k,k,k,k,k,k,k,k,k,k,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,a,d,d,n,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,a,a,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,n,n,n,n,n,n,n,n,n,n,n,d,a,a,a,a,a,a,a,a,a,a,a,a,a,a,l,l,l,l,l,l,l,l,l,l,
l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,n,n,n,n,n,n,n,n,n,l,l,a,a,a,a,l,a,a,a,a,a],[c,c,c,c,c,c,c,c,c,c,c,r,r,r,g,l,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,c,q,u,x,v,t,w,e,p,p,p,p,p,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,e,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,c,r,r,r,r,r,a,a,a,a,a,r,r,r,r,r,r,k,g,a,a,k,k,k,k,k,k,h,h,a,a,a,g,k,k,k,k,k,k,k,k,k,k,h,h,a,a,a,a,g,g,g,g,g,g,g,g,g,g,g,g,g,a,a,a,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,a,a,a,a,a,a,a,a,a,a,
a,a,a,a,a,a,a,a,a,a,a,a,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a],[g,g,g,g,g,g,g,a,a,a,a,a,a,a,a,a,a,a,a,g,g,g,g,g,a,a,a,a,a,l,n,l,l,l,l,l,l,l,l,l,l,h,l,l,l,l,l,l,l,l,l,l,l,l,l,a,l,l,l,l,l,a,l,a,l,l,a,l,l,a,l,l,l,l,l,l,l,l,l,l,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,
d,d,d,d,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,n,n,n,n,n,n,n,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,e,a,e,a,a,e,a,a,a,a,a,a,a,a,a,p,a,a,h,h,a,a,a,a,a,p,p,a,a,a,a,a,d,d,d,d,d,a,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,
d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,a,a,r],[a,a,a,p,p,p,a,a,a,a,a,h,e,h,e,e,k,k,k,k,k,k,k,k,k,k,e,a,a,a,a,a,a,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,a,a,a,a,a,a,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,a,a,a,a,a,a,a,a,a,a,a,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,
g,g,g,g,g,g,g,g,g,g,g,g,g,a,a,a,g,g,g,g,g,g,a,a,g,g,g,g,g,g,a,a,g,g,g,g,g,g,a,a,g,g,g,a,a,a,p,p,a,a,a,p,p,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a]]})},"esri/views/2d/engine/webgl/util/Result":function(){define(["require","exports","../../../../../core/Error"],function(g,b,l){Object.defineProperty(b,"__esModule",{value:!0});b.ok=function(b,f){return b&&"name"in b?(f&&f.error(new l(b.name,b.message,b.details)),!1):!0}})},"esri/views/2d/engine/webgl/util/symbolUtils":function(){define(["require",
"exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});b.keyFromSymbol=function(b){switch(b.type){case "esriSMS":return b.style+"."+b.path;case "esriSLS":return b.style+"."+b.cap;case "esriSFS":return""+b.style;case "esriPFS":case "esriPMS":return b.imageData?b.imageData:""+b.url+b.width+b.height;default:return b.mosaicHash?b.mosaicHash:JSON.stringify(b)}}})},"esri/views/2d/engine/webgl/effects/AnimationEffect":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/maybe ../definitions ../VertexStream ./Effect".split(" "),
function(g,b,l,k,f,a,q){Object.defineProperty(b,"__esModule",{value:!0});g=function(b){function d(){var a=null!==b&&b.apply(this,arguments)||this;a.defines=[];a._desc={path:"fx/integrate",attributes:{a_position:0}};return a}l(d,b);d.prototype.dispose=function(){this._quad&&this._quad.dispose()};d.prototype.bind=function(){};d.prototype.unbind=function(){};d.prototype.draw=function(c,e){if(e.size){var d=c.context,b=c.renderingOptions;this._quad||(this._quad=new a(d,[0,0,1,0,0,1,1,1]));var n=d.getBoundFramebufferObject(),
m=d.getViewport(),q=m.x,l=m.y,t=m.width,m=m.height;e.bindTextures(d);var g=e.getBlock(f.ATTRIBUTE_DATA_ANIMATION);if(!k.isNone(g)){var r=g.getFBO(d),g=g.getFBO(d,1);d.setViewport(0,0,e.size,e.size);this._computeDelta(c,g,b.labelsAnimationTime);this._updateAnimationState(c,g,r);d.bindFramebuffer(n);d.setViewport(q,l,t,m)}}};d.prototype._computeDelta=function(a,e,d){var c=a.context,b=a.displayLevel,h=a.painter.materialManager.getProgram(a,this._desc,["delta"]);c.bindFramebuffer(e);c.setClearColor(0,
0,0,0);c.clear(c.gl.COLOR_BUFFER_BIT);c.bindProgram(h);h.setUniform1i("u_maskTexture",f.TEXTURE_BINDING_ATTRIBUTE_DATA_0);h.setUniform1i("u_sourceTexture",f.TEXTURE_BINDING_ATTRIBUTE_DATA_1);h.setUniform1f("u_timeDelta",a.timeDelta);h.setUniform1f("u_animationTime",d/1E3);h.setUniform1f("u_zoomLevel",Math.round(10*b));this._quad.draw()};d.prototype._updateAnimationState=function(a,e,d){var c=a.context;a=a.painter.materialManager.getProgram(a,this._desc,["update"]);c.bindTexture(e.colorTexture,1);
c.bindProgram(a);a.setUniform1i("u_sourceTexture",1);c.bindFramebuffer(d);c.setClearColor(0,0,0,0);c.clear(c.gl.COLOR_BUFFER_BIT);this._quad.draw()};return d}(q.Effect);b.AnimationEffect=g})},"esri/views/2d/engine/webgl/VertexStream":function(){define(["require","exports","../../../../core/tsSupport/declareExtendsHelper","../../../webgl"],function(g,b,l,k){return function(){function b(a,b){this.rctx=a;this._vertexBuffer=k.BufferObject.createVertex(a,35044,new Uint16Array(b));this._vao=new k.VertexArrayObject(a,
{a_position:0},{geometry:[{name:"a_position",count:2,type:5123,offset:0,stride:4,normalized:!1}]},{geometry:this._vertexBuffer})}b.prototype.bind=function(){this._vao.bind()};b.prototype.unbind=function(){this._vao.unbind()};b.prototype.dispose=function(){this._vao.dispose(!1);this._vertexBuffer.dispose()};b.prototype.draw=function(){this.rctx.bindVAO(this._vao);this.rctx.drawArrays(5,0,4)};return b}()})},"esri/views/2d/engine/webgl/effects/Effect":function(){define(["require","exports"],function(g,
b){Object.defineProperty(b,"__esModule",{value:!0});g=function(){return function(){this.name=this.constructor.name}}();b.Effect=g})},"esri/views/2d/engine/webgl/effects/HighlightEffect":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/has ../BitBlitRenderer ../effects/Effect ./highlight/HighlightGradient ./highlight/HighlightRenderer ./highlight/HighlightSurfaces".split(" "),function(g,b,l,k,f,a,q,m,d){Object.defineProperty(b,"__esModule",{value:!0});
g=function(a){function c(){var c=null!==a&&a.apply(this,arguments)||this;c.defines=["highlight"];c._hlRenderer=new m.default;c._hlGradient=new q.default;c._width=void 0;c._height=void 0;c._hlSurfaces=new d.default;c._adjustedWidth=void 0;c._adjustedHeight=void 0;c._blitRenderer=new f.BitBlitRenderer;return c}l(c,a);c.prototype.dispose=function(){this._hlSurfaces&&this._hlSurfaces.dispose();this._hlRenderer&&this._hlRenderer.dispose();this._hlGradient&&this._hlGradient.destroy();this._boundFBO=null};
c.prototype.bind=function(a){var c=a.context,e=a.painter,d=c.getViewport(),b=d.width,d=d.height,e=e.getFbos(b,d).effect0;this.setup(a,b,d);c.bindFramebuffer(e);c.setClearColor(0,0,0,0);c.clear(c.gl.COLOR_BUFFER_BIT)};c.prototype.unbind=function(){};c.prototype.setup=function(a,c,e){a=a.context;this._width=c;this._height=e;var d=c%4,b=e%4;c+=2>d?-d:4-d;e+=2>b?-b:4-b;this._adjustedWidth=c;this._adjustedHeight=e;this._boundFBO=a.getBoundFramebufferObject();c=Math.round(.75*c);e=Math.round(.75*e);this._hlRenderer.setup(a,
c,e);this._hlSurfaces.setup(a,c,e)};c.prototype.draw=function(a){a=a.context;var c=a.getBoundFramebufferObject();a.setViewport(0,0,.75*this._adjustedWidth,.75*this._adjustedHeight);a.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo);a.setStencilTestEnabled(!1);a.setClearColor(0,0,0,0);a.clear(a.gl.COLOR_BUFFER_BIT);this._blitRenderer.render(a,c.colorTexture,9728,1);a.setStencilTestEnabled(!1);a.setBlendingEnabled(!1);a.bindFramebuffer(this._hlSurfaces.sharedBlur2Fbo);a.setClearColor(0,0,0,0);a.clear(a.gl.COLOR_BUFFER_BIT);
this._hlRenderer.preBlur(a,this._hlSurfaces.sharedBlur1Tex);a.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo);a.setClearColor(0,0,0,0);a.clear(a.gl.COLOR_BUFFER_BIT);this._hlRenderer.finalBlur(a,this._hlSurfaces.sharedBlur2Tex);a.bindFramebuffer(this._boundFBO);a.setBlendingEnabled(!0);a.setViewport(0,0,this._width,this._height);this._hlRenderer.renderHighlight(a,this._hlSurfaces.sharedBlur1Tex,this._hlGradient);this._boundFBO=null};c.prototype.setHighlightOptions=function(a){this._hlGradient.setHighlightOptions(a)};
return c}(a.Effect);b.default=g})},"esri/views/2d/engine/webgl/effects/highlight/HighlightGradient":function(){define("require exports ../../../../../../core/Logger ../../../../../webgl ../../definitions ./parameters".split(" "),function(g,b,l,k,f,a){function q(c,e){e.fillColor[0]=c.color.r/255;e.fillColor[1]=c.color.g/255;e.fillColor[2]=c.color.b/255;e.fillColor[3]=c.color.a;c.haloColor?(e.outlineColor[0]=c.haloColor.r/255,e.outlineColor[1]=c.haloColor.g/255,e.outlineColor[2]=c.haloColor.b/255,e.outlineColor[3]=
c.haloColor.a):(e.outlineColor[0]=e.fillColor[0],e.outlineColor[1]=e.fillColor[1],e.outlineColor[2]=e.fillColor[2],e.outlineColor[3]=e.fillColor[3]);e.fillColor[3]*=c.fillOpacity;e.outlineColor[3]*=c.haloOpacity;e.fillColor[0]*=e.fillColor[3];e.fillColor[1]*=e.fillColor[3];e.fillColor[2]*=e.fillColor[3];e.outlineColor[0]*=e.outlineColor[3];e.outlineColor[1]*=e.outlineColor[3];e.outlineColor[2]*=e.outlineColor[3];e.outlineWidth=a.HIGHLIGHT_SIZING.outlineWidth;e.outerHaloWidth=a.HIGHLIGHT_SIZING.outerHaloWidth;
e.innerHaloWidth=a.HIGHLIGHT_SIZING.innerHaloWidth;e.outlinePosition=a.HIGHLIGHT_SIZING.outlinePosition}Object.defineProperty(b,"__esModule",{value:!0});var m=l.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient"),d=[0,0,0,0];g=function(){function c(){this._convertedHighlightOptions={fillColor:[.2*.75,.6*.75,.675,.75],outlineColor:[.2*.9,.54,.81,.9],outlinePosition:a.HIGHLIGHT_SIZING.outlinePosition,outlineWidth:a.HIGHLIGHT_SIZING.outlineWidth,innerHaloWidth:a.HIGHLIGHT_SIZING.innerHaloWidth,
outerHaloWidth:a.HIGHLIGHT_SIZING.outerHaloWidth};this.shadeTexChanged=!0;this.texelData=new Uint8Array(4*a.SHADE_TEXTURE_SIZE);this.minMaxDistance=[0,0]}c.prototype.setHighlightOptions=function(c){function e(a,c,e){r[0]=(1-e)*a[0]+e*c[0];r[1]=(1-e)*a[1]+e*c[1];r[2]=(1-e)*a[2]+e*c[2];r[3]=(1-e)*a[3]+e*c[3]}var b,n=this._convertedHighlightOptions;q(c,n);c=n.outlinePosition-n.outlineWidth/2-n.outerHaloWidth;var f=n.outlinePosition-n.outlineWidth/2,k=n.outlinePosition+n.outlineWidth/2,l=n.outlinePosition+
n.outlineWidth/2+n.innerHaloWidth,t=Math.sqrt(Math.PI/2)*a.SIGMAS[3],g=Math.abs(c)>t?Math.round(10*(Math.abs(c)-t))/10:0,t=Math.abs(l)>t?Math.round(10*(Math.abs(l)-t))/10:0;g&&!t?m.error("The outer rim of the highlight is "+g+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!g&&t?m.error("The inner rim of the highlight is "+t+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):
g&&t&&m.error("The highlight is "+Math.max(g,t)+"px away from the edge of the feature; consider reducing some width values.");for(var r=[void 0,void 0,void 0,void 0],g=this.texelData,t=0;t<a.SHADE_TEXTURE_SIZE;++t)b=c+t/(a.SHADE_TEXTURE_SIZE-1)*(l-c),b<c?(r[4*t+0]=0,r[4*t+1]=0,r[4*t+2]=0,r[4*t+3]=0):b<f?e(d,n.outlineColor,(b-c)/(f-c)):b<k?(b=n.outlineColor,r[0]=b[0],r[1]=b[1],r[2]=b[2],r[3]=b[3]):b<l?e(n.outlineColor,n.fillColor,(b-k)/(l-k)):(b=n.fillColor,r[4*t+0]=b[0],r[4*t+1]=b[1],r[4*t+2]=b[2],
r[4*t+3]=b[3]),g[4*t+0]=255*r[0],g[4*t+1]=255*r[1],g[4*t+2]=255*r[2],g[4*t+3]=255*r[3];this.minMaxDistance[0]=c;this.minMaxDistance[1]=l;this.shadeTexChanged=!0};c.prototype.applyHighlightOptions=function(c,d){this.shadeTex||(this.shadeTex=new k.Texture(c,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:a.SHADE_TEXTURE_SIZE,height:1,samplingMode:9729}));this.shadeTexChanged&&(this.shadeTex.updateData(0,0,0,a.SHADE_TEXTURE_SIZE,1,this.texelData),this.shadeTexChanged=!1);c.bindTexture(this.shadeTex,
f.TEXTURE_BINDING_HIGHLIGHT_1);d.setUniform2fv("u_minMaxDistance",this.minMaxDistance)};c.prototype.destroy=function(){this.shadeTex&&(this.shadeTex.dispose(),this.shadeTex=null)};return c}();b.default=g})},"esri/views/2d/engine/webgl/effects/highlight/parameters":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});b.SIGMAS=[void 0,void 0,void 0,1];b.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1];b.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=
[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];b.SHADE_TEXTURE_SIZE=256;b.HIGHLIGHT_SIZING={outlineWidth:.7,outerHaloWidth:.7,innerHaloWidth:.7,outlinePosition:0}})},"esri/views/2d/engine/webgl/effects/highlight/HighlightRenderer":function(){define("require exports ../../../../../webgl ../../definitions ./parameters ../../shaders/HighlightPrograms".split(" "),function(g,b,l,k,f,a){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(){this._height=this._width=void 0;this._resources=null}b.prototype.dispose=
function(){this._resources&&(this._resources.quadGeometry.dispose(),this._resources.quadVAO.dispose(),this._resources.highlightProgram.dispose(),this._resources.blurProgram.dispose(),this._resources=null)};b.prototype.preBlur=function(a,d){a.bindTexture(d,k.TEXTURE_BINDING_HIGHLIGHT_0);a.bindProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",[1,0,1/this._width,0]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",f.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX);
a.bindVAO(this._resources.quadVAO);a.drawArrays(5,0,4);a.bindVAO()};b.prototype.finalBlur=function(a,d){a.bindTexture(d,k.TEXTURE_BINDING_HIGHLIGHT_0);a.bindProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",[0,1,0,1/this._height]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",f.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX);a.bindVAO(this._resources.quadVAO);a.drawArrays(5,0,4);a.bindVAO()};b.prototype.renderHighlight=function(a,d,c){a.bindTexture(d,
k.TEXTURE_BINDING_HIGHLIGHT_0);a.bindProgram(this._resources.highlightProgram);c.applyHighlightOptions(a,this._resources.highlightProgram);a.bindVAO(this._resources.quadVAO);a.setBlendingEnabled(!0);a.setBlendFunction(1,771);a.drawArrays(5,0,4);a.bindVAO()};b.prototype._initialize=function(b,d,c){this._width=d;this._height=c;d=new l.BufferObject(b,34962,35044,(new Int8Array([-1,-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1])).buffer);c=new l.VertexArrayObject(b,{a_position:0,a_texcoord:1},{geometry:[{name:"a_position",
count:2,type:5120,offset:0,stride:4,normalized:!1},{name:"a_texcoord",count:2,type:5121,offset:2,stride:4,normalized:!1}]},{geometry:d});var e=l.createProgram(b,a.highlight);b=l.createProgram(b,a.blur);e.setUniform1i("u_texture",k.TEXTURE_BINDING_HIGHLIGHT_0);e.setUniform1i("u_shade",k.TEXTURE_BINDING_HIGHLIGHT_1);e.setUniform4fv("u_sigmas",f.SIGMAS);b.setUniform1i("u_texture",k.TEXTURE_BINDING_HIGHLIGHT_0);b.setUniform4fv("u_sigmas",f.SIGMAS);this._resources={quadGeometry:d,quadVAO:c,highlightProgram:e,
blurProgram:b}};b.prototype.setup=function(a,d,c){this._resources?(this._width=d,this._height=c):this._initialize(a,d,c)};return b}();b.default=g})},"esri/views/2d/engine/webgl/shaders/HighlightPrograms":function(){define(["require","exports","./sources/resolver"],function(g,b,l){Object.defineProperty(b,"__esModule",{value:!0});b.highlight={name:"highlight",shaders:{vertexShader:l.resolveIncludes("highlight/textured.vert"),fragmentShader:l.resolveIncludes("highlight/highlight.frag")},attributes:{a_position:0,
a_texcoord:1}};b.blur={name:"blur",shaders:{vertexShader:l.resolveIncludes("highlight/textured.vert"),fragmentShader:l.resolveIncludes("highlight/blur.frag")},attributes:{a_position:0,a_texcoord:1}}})},"esri/views/2d/engine/webgl/effects/highlight/HighlightSurfaces":function(){define(["require","exports","../../../../../webgl"],function(g,b,l){function k(b,a,k){a=new l.Texture(b,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:a,height:k,samplingMode:9729});b=new l.FramebufferObject(b,
{colorTarget:0,depthStencilTarget:2},a);return[a,b]}Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(){this._height=this._width=void 0;this._resources=null}b.prototype.dispose=function(){this._resources&&(this._resources.sharedBlur1Tex.dispose(),this._resources.sharedBlur1Fbo.dispose(),this._resources.sharedBlur2Tex.dispose(),this._resources.sharedBlur2Fbo.dispose(),this._resources=null)};b.prototype._initialize=function(a,b,m){this._width=b;this._height=m;var d=k(a,b,m),c=
d[0],d=d[1];a=k(a,b,m);this._resources={sharedBlur1Tex:c,sharedBlur1Fbo:d,sharedBlur2Tex:a[0],sharedBlur2Fbo:a[1]}};b.prototype.setup=function(a,b,m){!this._resources||this._width===b&&this._height===m||this.dispose();this._resources||this._initialize(a,b,m)};Object.defineProperty(b.prototype,"sharedBlur1Tex",{get:function(){return this._resources.sharedBlur1Tex},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"sharedBlur1Fbo",{get:function(){return this._resources.sharedBlur1Fbo},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"sharedBlur2Tex",{get:function(){return this._resources.sharedBlur2Tex},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"sharedBlur2Fbo",{get:function(){return this._resources.sharedBlur2Fbo},enumerable:!0,configurable:!0});return b}();b.default=g})},"esri/views/2d/engine/webgl/effects/HittestEffect":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/MapUtils ../../../../../core/maybe ../definitions ./Effect".split(" "),
function(g,b,l,k,f,a,q){Object.defineProperty(b,"__esModule",{value:!0});g=function(b){function d(){var a=null!==b&&b.apply(this,arguments)||this;a.name=a.constructor.name;a.defines=["id"];a._lastSize=0;return a}l(d,b);d.prototype.dispose=function(){f.isSome(this._fbo)&&this._fbo.dispose()};d.prototype.bind=function(a){var c=a.context;a=a.painter;var d=c.getViewport();a=a.getFbos(d.width,d.height).effect0;c.bindFramebuffer(a);c.setClearColor(0,0,0,0);c.clear(c.gl.COLOR_BUFFER_BIT)};d.prototype.unbind=
function(){};d.prototype.draw=function(c,e,d){var b=this,h=c.context,m=c.state,f=c.pixelRatio;void 0===d&&(d=a.HITTEST_SEARCH_SIZE);var q=h.getBoundFramebufferObject(),t=m.size[1]*f,l=Math.round(d*f),r=l/2,g=l/2;this._ensureBuffer(l);e.forEach(function(a,c){var d=new Map;q.readPixels(Math.floor(c[0]*f-l/2),Math.floor(t-c[1]*f-l/2),l,l,6408,5121,b._buf);for(var h=0;h<b._buf32.length;h++){var n=b._buf32[h];if(4294967295!==n&&0!==n){var p=h%l,m=l-Math.floor(h/l),p=(r-p)*(r-p)+(g-m)*(g-m),m=d.has(n)?
d.get(n):4294967295;d.set(n,Math.min(p,m))}}d=k.pairsOfMap(d).sort(function(a,c){return a[1]-c[1]}).map(function(a){return a[0]});a.resolve(d);e.delete(c)})};d.prototype._ensureBuffer=function(a){this._lastSize!==a&&(this._lastSize=a,this._buf=new Uint8Array(4*a*a),this._buf32=new Uint32Array(this._buf.buffer))};return d}(q.Effect);b.HittestEffect=g})},"esri/views/2d/engine/webgl/painter/RenderPass":function(){define("require exports @dojo/framework/shim/iterator ../../../../../core/has ../../../../../core/maybe ../enums".split(" "),
function(g,b,l,k,f,a){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(b,d){this.brushes=b;this.name=d.name;this.drawPhase=d.drawPhase||a.WGLDrawPhase.MAP;this._targetFn=d.target;this.effects=d.effects||[];this.has=d.has}b.prototype.render=function(a){var d=a.context,c=a.profiler,e=this._targetFn(),b=this.drawPhase&a.drawPhase;c.recordPassStart(this.name);if(b&&(!this.has||k(this.has))){this._doRender(a,e);c.recordPassEnd();for(var b=0,p=this.effects;b<p.length;b++){var n=
p[b];if(n.enable()){var m=n.apply;c.recordPassStart(this.name+"."+m.name);c.recordBrushStart(m.name);var n=n.args&&n.args(),f=d.getViewport(),q=f.x,t=f.y,l=f.width,f=f.height,r=d.getBoundFramebufferObject();m.bind(a,n);this._doRender(a,e,m.defines);m.draw(a,n);m.unbind(a,n);d.bindFramebuffer(r);d.setViewport(q,t,l,f);c.recordBrushEnd();c.recordPassEnd()}}}};b.prototype._doRender=function(a,d,c){if(!f.isNone(d))if(l.isArrayLike(d))for(var e=0;e<d.length;e++){var b=d[e];if(b.isReady&&b.visible)for(var p=
0,n=this.brushes;p<n.length;p++){var m=n[p];a.profiler.recordBrushStart(m.name);m.prepareState(a,b,c);m.draw(a,b,c);a.profiler.recordBrushEnd()}}else for(e=0,b=this.brushes;e<b.length;e++)m=b[e],a.profiler.recordBrushStart(m.name),m.prepareState(a,d,c),m.draw(a,d,c),a.profiler.recordBrushEnd()};return b}();b.default=g})},"esri/views/2d/engine/webgl/Profiler":function(){define("require exports ../../../../core/CircularArray ../../../../core/Evented ../../../../core/has ../../../../core/maybe ../../../webgl/capabilities/DisjointTimerQuery".split(" "),
function(g,b,l,k,f,a,q){Object.defineProperty(b,"__esModule",{value:!0});var m=f("esri-2d-profiler");g=function(){function d(a,e){var c=this;this._events=new k;this._entries=new Map;this._timings=new l.default(10);if(m){this._ext=q.load(a.gl,{});this._debugOutput=e;var d=a.gl;if(this.enableCommandLogging){a=function(a){if("function"===typeof d[a]){var e=d[a],b=-1!==a.indexOf("draw");d[a]=function(){for(var h=[],n=0;n<arguments.length;n++)h[n]=arguments[n];c._events.emit("command",{container:c._currentContainer,
pass:c._currentPass,brush:c._currentBrush,method:a,args:h,isDrawCommand:b});c._currentSummary&&(c._currentSummary.commands++,b&&c._currentSummary.drawCommands++);return e.apply(d,h)}}};for(var b in d)a(b)}}}Object.defineProperty(d.prototype,"enableCommandLogging",{get:function(){return!("object"===typeof m&&m.disableCommands)},enumerable:!0,configurable:!0});d.prototype.recordContainerStart=function(a){m&&(this._currentContainer=a)};d.prototype.recordContainerEnd=function(){m&&(this._currentContainer=
null)};d.prototype.recordPassStart=function(a){m&&(this._currentPass=a,this._initSummary())};d.prototype.recordPassEnd=function(){m&&(this._currentPass=null,this._emitSummary())};d.prototype.recordBrushStart=function(a){m&&(this._currentBrush=a)};d.prototype.recordBrushEnd=function(){m&&(this._currentBrush=null)};d.prototype.recordStart=function(c){if(m&&a.isSome(this._ext)){if(this._entries.has(c)){var e=this._entries.get(c),d=this._ext.resultAvailable(e.query),b=this._ext.disjoint();if(d&&!b){d=
this._ext.getResult(e.query)/1E6;b=0;if(a.isSome(this._timings.enqueue(d))){for(var b=this._timings.entries,n=b.length,f=0,k=0;k<b.length;k++)f+=b[k];b=f/n}d=d.toFixed(2);b=b?b.toFixed(2):"--";this.enableCommandLogging?(console.groupCollapsed("Frame report for "+c+", "+d+" ms ("+b+" last 10 avg)\n"+e.commandsLen+" Commands ("+e.drawCommands+" draw)"),console.log("RenderPass breakdown: "),console.table(e.summaries),console.log("Commands: ",e.commands),console.groupEnd()):console.log("Frame report for "+
c+", "+d+" ms ("+b+" last 10 avg)");this._debugOutput.innerHTML=d+" ("+b+")"}d=0;for(e=e.handles;d<e.length;d++)e[d].remove();this._entries.delete(c)}var q={name:c,query:this._ext.createQuery(),commands:[],commandsLen:0,drawCommands:0,summaries:[],handles:[]};this.enableCommandLogging&&(q.handles.push(this._events.on("command",function(a){q.commandsLen++;q.commands.push(a);a.isDrawCommand&&q.drawCommands++})),q.handles.push(this._events.on("summary",function(a){delete a.target;q.summaries.push(a)})));
this._ext.beginTimeElapsed(q.query);this._entries.set(c,q)}};d.prototype.recordEnd=function(c){m&&a.isSome(this._ext)&&this._entries.has(c)&&this._ext.endTimeElapsed()};d.prototype._initSummary=function(){this.enableCommandLogging&&(this._currentSummary={container:this._currentContainer,pass:this._currentPass,drawCommands:0,commands:0})};d.prototype._emitSummary=function(){this.enableCommandLogging&&this._events.emit("summary",this._currentSummary)};return d}();b.Profiler=g})},"esri/core/CircularArray":function(){define(["require",
"exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(b){void 0===b&&(b=Number.POSITIVE_INFINITY);this._start=this.size=0;this.maxSize=b;this._buffer=isFinite(b)?Array(b):[]}Object.defineProperty(b.prototype,"entries",{get:function(){return this._buffer},enumerable:!0,configurable:!0});b.prototype.enqueue=function(b){if(this.size===this.maxSize){var f=this._buffer[this._start];this._buffer[this._start]=b;this._start=(this._start+1)%this.maxSize;return f}isFinite(this.maxSize)?
this._buffer[(this._start+this.size++)%this.maxSize]=b:this._buffer[this._start+this.size++]=b;return null};b.prototype.dequeue=function(){if(0===this.size)return null;var b=this._buffer[this._start];this._buffer[this._start]=null;this.size--;this._start=(this._start+1)%this.maxSize;return b};return b}();b.default=g})},"esri/views/2d/engine/webgl/WebGLDriverTest":function(){define("require exports ../../../../core/Logger ../../../../core/maybe ../../../webgl ./VertexStream".split(" "),function(g,
b,l,k,f,a){Object.defineProperty(b,"__esModule",{value:!0});var q=l.getLogger("esri.views.2d.engine.webgl.WebGLDriverTest"),m=function(){function a(a){this._ignoresSamplerPrecision=null;this._context=a}Object.defineProperty(a.prototype,"ignoresSamplerPrecision",{get:function(){k.isNone(this._ignoresSamplerPrecision)&&(this._ignoresSamplerPrecision=b.testSamplerPrecision(this._context));return this._ignoresSamplerPrecision},enumerable:!0,configurable:!0});return a}();b.testWebGLDriver=function(a){return new m(a)};
b.testSamplerPrecision=function(d){var c=new f.FramebufferObject(d,{colorTarget:0,depthStencilTarget:0},{target:3553,wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1}),e=new Uint8Array(4),b=new a(d,[0,0,1,0,0,1,1,1]),p=new f.Program(d,"\nprecision highp float;\n\nattribute vec2 a_pos;\n\nuniform highp sampler2D u_texture;\nvarying vec4 v_color;\n\nfloat getBit(in float bitset, in int bitIndex) {\n  float offset \x3d pow(2.0, float(bitIndex));\n\n  return mod(floor(bitset / offset), 2.0);\n}\n\nvoid main() {\n  vec4 value \x3d texture2D(u_texture, vec2(0.0));\n\n  float bit \x3d getBit(value.x * 255.0, 1);\n\n  v_color \x3d bit * vec4(1.0);\n\n  gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n}\n",
"\nprecision highp float;\n\nvarying vec4 v_color;\n\nvoid main() {\n  gl_FragColor \x3d v_color;\n}\n",{a_pos:0}),n=new f.Texture(d,{target:3553,wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array([2,255,0,0]));p.setUniform1i("u_texture",0);d.bindTexture(n,0);d.bindFramebuffer(c);d.bindProgram(p);var m=d.getViewport(),n=m.x,k=m.y,l=m.width,m=m.height;d.setViewport(0,0,1,1);b.draw();d.setViewport(n,k,l,m);c.readPixels(0,0,1,1,6408,5121,e);p.dispose();b.dispose();
c.dispose();(d=255!==e[0]||255!==e[1]||255!==e[2]||255!==e[3])&&q.warn("A problem was detected with your graphics driver. Your driver does not appear to honor sampler precision specifiers, which may result in rendering issues due to numerical instability. We recommend ensuring that your drivers have been updated to the latest version. Applying lowp sampler workaround. ["+e[0]+"."+e[1]+"."+e[2]+"."+e[3]+"]");return d}})},"esri/views/2d/engine/webgl/shaders/StencilPrograms":function(){define(["require",
"exports","./sources/resolver"],function(g,b,l){Object.defineProperty(b,"__esModule",{value:!0});b.stencil={name:"stencil",shaders:{vertexShader:l.resolveIncludes("stencil/stencil.vert"),fragmentShader:l.resolveIncludes("stencil/stencil.frag")},attributes:{a_pos:0}}})},"esri/views/2d/engine/webgl/AttributeStoreView":function(){define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/Error ../../../../core/has ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../webgl ./definitions ./Utils ./util/debug ../../../webgl/FramebufferObject".split(" "),
function(g,b,l,k,f,a,q,m,d,c,e,h,p,n){Object.defineProperty(b,"__esModule",{value:!0});var u=q.getLogger("esri.views.2d.engine.webgl.AttributeStoreView"),x=p.createDebugLogger(p.DEBUG_ATTR_UPDATES,u),v=function(){function e(a,c,e){this._lastTexture=this._texture=null;this._fbos={};this.texelSize=4;var d=a.buffer,b=a.pixelType;a=a.textureOnly;var n=h.getPixelArrayCtor(b);this.shared=e;this.pixelType=b;this.size=c;this.textureOnly=a;a||(this.data=new n(m.expect(d)));this._resetRange()}e.prototype.destroy=
function(){m.andThen(this._texture,function(a){return a.dispose()});var a=function(a){m.andThen(c._fbos[a],function(c){"0"===a&&c.detachColorTexture();c.dispose()});c._fbos[a]=null},c=this,e;for(e in this._fbos)a(e);this._texture=null};Object.defineProperty(e.prototype,"_textureDesc",{get:function(){return{target:3553,wrapMode:33071,pixelFormat:6408,dataType:this.pixelType,samplingMode:9728,width:this.size,height:this.size}},enumerable:!0,configurable:!0});e.prototype.setData=function(a,c,e){a&=2147483647;
var d=m.expect(this.data);c=a*this.texelSize+c;!d||c>=d.length||(d[c]=e,this.dirtyStart=Math.min(this.dirtyStart,a),this.dirtyEnd=Math.max(this.dirtyEnd,a))};e.prototype.getData=function(a,c){if(m.isNone(this.data))return null;a=(a&2147483647)*this.texelSize+c;return!this.data||a>=this.data.length?null:this.data[a]};e.prototype.getTexture=function(a){var c=this;return m.unwrapOr(this._texture,function(){return c._initTexture(a)})};e.prototype.getFBO=function(a,c){void 0===c&&(c=0);if(m.isNone(this._fbos[c])){var e=
0===c?this.getTexture(a):this._textureDesc;this._fbos[c]=new n(a,{colorTarget:0,depthStencilTarget:0},e)}return this._fbos[c]};Object.defineProperty(e.prototype,"locked",{get:function(){return 5121===this.pixelType&&this.shared&&!this.textureOnly&&a("esri-atomics")&&this.data?1===Atomics.load(this.data,0):!1},enumerable:!0,configurable:!0});e.prototype.updateTexture=function(a){if(!this.locked)try{var c=this.dirtyStart,e=this.dirtyEnd;if(!(c>e)){this._resetRange();var d=m.expect(this.data).buffer,
b=this.getTexture(a),n=(c-c%this.size)/this.size,p=(e-e%this.size)/this.size,k=n*this.size*4,q=4*(this.size+p*this.size)-k,t=h.getPixelArrayCtor(this.pixelType),l=t.BYTES_PER_ELEMENT;try{new t(d,k*l,q)}catch(K){console.debug(K)}var g=new t(d,k*l,q),w=this.size;a=p-n+1;a>this.size?u.error(new f("mapview-webgl","Out-of-bounds index when updating AttributeData")):b.updateData(0,0,n,w,a,g)}}catch(K){console.debug(K)}};e.prototype.update=function(a){var c=a.data,e=a.start,d=a.end;if(m.isSome(c))for(var b=
this.data,h=e*this.texelSize,n=0;n<c.length;n++)a.layout&1<<n%this.texelSize&&(b[h+n]=c[n]);this.dirtyStart=Math.min(this.dirtyStart,e);this.dirtyEnd=Math.max(this.dirtyEnd,d)};e.prototype.resize=function(a,c){var e=this.size;this.size=c;this.textureOnly?e!==this.size&&(this._lastTexture=this._texture,this._texture=null):(c=h.getPixelArrayCtor(this.pixelType),this.destroy(),this.data=new c(m.expect(a.buffer)))};e.prototype._resetRange=function(){this.dirtyStart=2147483647;this.dirtyEnd=0};e.prototype._initTexture=
function(a){var e=new c.Texture(a,this._textureDesc,m.unwrapOr(this.data,void 0));if(m.isSome(this._lastTexture)&&this._fbos[0]){var d=this._lastTexture.descriptor.width,b=this._lastTexture.descriptor.height,n=this._lastTexture.descriptor.dataType,p=this._lastTexture.descriptor.pixelFormat,f=this.getFBO(a),k=h.getPixelBytes(n),q=h.getPixelArrayCtor(n),k=new ArrayBuffer(d*b*k*this.texelSize),q=new q(k),k=a.getBoundFramebufferObject(),t=a.getViewport(),l=t.x,g=t.y,u=t.width,t=t.height;a.bindFramebuffer(f);
f.readPixels(0,0,d,b,p,n,q);e.updateData(0,0,0,2*d,b/2,q);a.setViewport(l,g,u,t);a.bindFramebuffer(k)}this.destroy();return this._texture=e};return e}();g=function(){function a(){this._locked=this._forceNextUpload=this._initialized=!1}a.prototype.initialize=function(a){var c=a.blocks,e=a.shared,d=a.size;this.shared=e;this.size=d;x("Initializing AttributeStoreView",a);if(m.isNone(this._data))this._data=m.mapMany(c,function(a){return new v(a,d,e)});else for(a=0;a<this._data.length;a++){var b=this._data[a],
h=c[a];m.isSome(h)&&(m.isNone(b)?this._data[a]=new v(h,d,e):b.resize(h,d))}this._initialized=!0};a.prototype.destroy=function(){m.andThen(this._data,function(a){return m.mapMany(a,function(a){return a.destroy()})});m.andThen(this._defaultTexture,function(a){return a.dispose()})};a.prototype.getBlock=function(a){return m.isNone(this._data)?null:this._data[a]};a.prototype.setLabelMinZoom=function(a,c){this.setData(a,0,1,c)};a.prototype.getLabelMinZoom=function(a){return this.getData(a,0,1,255)};a.prototype.getFilterFlags=
function(a){return this.getData(a,0,0,0)};a.prototype.getVVSize=function(a){return this.getData(a,e.ATTRIBUTE_DATA_VV,0,0)};a.prototype.getData=function(a,c,e,d){if(!this._data)return 0;c=m.expect(this._data)[c];if(m.isNone(c))return 0;a=c.getData(a,e);return m.isSome(a)?a:d};a.prototype.setData=function(a,c,e,d){c=m.expect(this._data)[c];m.expect(c).setData(a,e,d)};a.prototype.lockTextureUpload=function(){this._locked=!0};a.prototype.unlockTextureUpload=function(){this._locked=!1};a.prototype.forceTextureUpload=
function(){this._forceNextUpload=!0};a.prototype.requestUpdate=function(a){return k(this,void 0,void 0,function(){var c;return l(this,function(e){if(this._pendingAttributeUpdate)return u.error(new f("mapview-webgl","Tried to update attribute data with a pending update")),[2];c=d.createResolver();x("AttributeStoreView Update Requested",a);this._pendingAttributeUpdate={data:a,resolver:c};return[2,c.promise]})})};a.prototype.update=function(){if(this._initialized&&m.isSome(this._pendingAttributeUpdate)){for(var a=
this._pendingAttributeUpdate,c=a.data,a=a.resolver,e=m.expect(this._data),d=function(a){var d=c.blocks[a];m.andThen(e[a],function(c){return m.andThen(d,function(e){x("Updating block "+a,e);c.update(e)})})},b=0;b<c.blocks.length;b++)d(b);this._pendingAttributeUpdate=null;a()}};a.prototype.bindTextures=function(a){this.update();var c=this._getDefaultTexture(a);if(this._initialized){var d=m.expect(this._data);if(!this._locked||this._forceNextUpload)m.forEachSome(d,function(c){return c.updateTexture(a)}),
this._forceNextUpload=!1;a.bindTexture(m.mapOr(d[0],c,function(c){return c.getTexture(a)}),e.TEXTURE_BINDING_ATTRIBUTE_DATA_0);a.bindTexture(m.mapOr(d[1],c,function(c){return c.getTexture(a)}),e.TEXTURE_BINDING_ATTRIBUTE_DATA_1);a.bindTexture(m.mapOr(d[2],c,function(c){return c.getTexture(a)}),e.TEXTURE_BINDING_ATTRIBUTE_DATA_2);a.bindTexture(m.mapOr(d[3],c,function(c){return c.getTexture(a)}),e.TEXTURE_BINDING_ATTRIBUTE_DATA_3)}else a.bindTexture(c,e.TEXTURE_BINDING_ATTRIBUTE_DATA_0),a.bindTexture(c,
e.TEXTURE_BINDING_ATTRIBUTE_DATA_1),a.bindTexture(c,e.TEXTURE_BINDING_ATTRIBUTE_DATA_2),a.bindTexture(c,e.TEXTURE_BINDING_ATTRIBUTE_DATA_3)};a.prototype._getDefaultTexture=function(a){m.isNone(this._defaultTexture)&&(this._defaultTexture=new c.Texture(a,{wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array(4)));return this._defaultTexture};return a}();b.AttributeStoreView=g})},"esri/views/2d/engine/webgl/Utils":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/Error ../../../../core/Logger ../../../../core/mathUtils ../../../../core/screenUtils ../../../../symbols/cim/enums ../../../webgl ./color ./enums ./SymbolProperties".split(" "),
function(g,b,l,k,f,a,q,m,d,c,e,h){function p(a){for(var c={},e=0;e<a.length;e++){var d=a[e];c[d.name]=d.strideInBytes}return c}function n(a){switch(a){case e.WGLGeometryType.MARKER:return y;case e.WGLGeometryType.FILL:return A;case e.WGLGeometryType.LINE:return z;case e.WGLGeometryType.TEXT:return B;case e.WGLGeometryType.LABEL:return C}return null}function u(a){switch(a%4){case 0:case 2:return 4;case 1:case 3:return 1}}function x(a){return"string"===typeof a}function v(a){switch(a){case 5120:case 5121:return 1;
case 5122:case 5123:return 2;case 5126:case 5124:case 5125:return 4}}function t(a){var c={},e=function(e){var d=0;c[e]=a[e].map(function(a){var c=l({},a,{normalized:a.normalized||!1,divisor:a.divisor||0,offset:d,stride:0});d+=a.count*v(a.type);return c});c[e].forEach(function(a){return a.stride=d})},d;for(d in a)e(d);return c}Object.defineProperty(b,"__esModule",{value:!0});var w,r=f.getLogger("esri.views.2d.engine.webgl.Utils");b.C_VBO_GEOMETRY="geometry";b.C_VBO_PERINSTANCE="per_instance";b.C_VBO_PERINSTANCE_VV=
"per_instance_vv";b.C_ICON_VERTEX_DEF=[{name:b.C_VBO_GEOMETRY,strideInBytes:32,divisor:0}];b.C_FILL_VERTEX_DEF=[{name:b.C_VBO_GEOMETRY,strideInBytes:32,divisor:0}];b.C_FILL_VERTEX_DEF_DD=[{name:b.C_VBO_GEOMETRY,strideInBytes:12,divisor:0}];b.C_LINE_VERTEX_DEF=[{name:b.C_VBO_GEOMETRY,strideInBytes:36,divisor:0}];b.C_TEXT_VERTEX_DEF=[{name:b.C_VBO_GEOMETRY,strideInBytes:32,divisor:0}];b.C_LABEL_VERTEX_DEF=[{name:b.C_VBO_GEOMETRY,strideInBytes:36,divisor:0}];b.C_ICON_STRIDE_SPEC=p(b.C_ICON_VERTEX_DEF);
b.C_FILL_STRIDE_SPEC=p(b.C_FILL_VERTEX_DEF);b.C_FILL_STRIDE_SPEC_DD=p(b.C_FILL_VERTEX_DEF_DD);b.C_LINE_STRIDE_SPEC=p(b.C_LINE_VERTEX_DEF);b.C_TEXT_STRIDE_SPEC=p(b.C_TEXT_VERTEX_DEF);b.C_LABEL_STRIDE_SPEC=p(b.C_LABEL_VERTEX_DEF);b.getStrides=function(a,c){switch(a){case e.WGLGeometryType.MARKER:return b.C_ICON_STRIDE_SPEC;case e.WGLGeometryType.FILL:return c?b.C_FILL_STRIDE_SPEC_DD:b.C_FILL_STRIDE_SPEC;case e.WGLGeometryType.LINE:return b.C_LINE_STRIDE_SPEC;case e.WGLGeometryType.TEXT:return b.C_TEXT_STRIDE_SPEC;
case e.WGLGeometryType.LABEL:return b.C_LABEL_STRIDE_SPEC}return null};var y=[b.C_VBO_GEOMETRY],A=[b.C_VBO_GEOMETRY],z=[b.C_VBO_GEOMETRY],B=[b.C_VBO_GEOMETRY],C=[b.C_VBO_GEOMETRY];b.getNamedBuffers=n;b.strideToPackingFactor=u;b.allocateTypedArrayBuffer=function(a,c){switch(c%4){case 0:case 2:return new Uint32Array(Math.floor(a*c/4));case 1:case 3:return new Uint8Array(a*c)}};b.allocateTypedArrayBufferwithData=function(a,c){switch(c%4){case 0:case 2:return new Uint32Array(a);case 1:case 3:return new Uint8Array(a)}};
b.getTextProperties=function(a){return h.TextProperties.pool.acquire(a.color?c.copyAndPremultiply(a.color):[255,255,255,255],a.haloColor?c.copyAndPremultiply(a.haloColor):[255,255,255,255],q.pt2px(a.haloSize),q.pt2px(a.font.size),a.angle*Math.PI/180,a.xoffset/a.font.size,a.yoffset/a.font.size,"left"===a.horizontalAlignment?0:"right"===a.horizontalAlignment?1:.5,"top"===a.verticalAlignment?0:"bottom"===a.verticalAlignment?1:.5)};b.isDefined=function(a){return null!=a};b.isNumber=function(a){return"number"===
typeof a};b.isString=x;b.isStringOrNull=function(a){return null==a||x(a)};b.getCapType=function(a,c){switch(a){case "butt":return m.CapType.BUTT;case "round":return c?m.CapType.SQUARE:m.CapType.ROUND;case "square":return m.CapType.SQUARE;default:return r.error(new k("mapview-invalid-type","Cap type "+a+" is not a valid option. Defaulting to round")),m.CapType.ROUND}};b.getJoinType=function(a){switch(a){case "miter":return m.JoinType.MITER;case "bevel":return m.JoinType.BEVEL;case "round":return m.JoinType.ROUND;
default:return r.error(new k("mapview-invalid-type","Join type "+a+" is not a valid option. Defaulting to round")),m.JoinType.ROUND}};b.getVVType=function(a){switch(a){case "opacity":return e.VVType.OPACITY;case "color":return e.VVType.COLOR;case "rotation":return e.VVType.ROTATION;case "size":return e.VVType.SIZE;default:return r.error("Cannot interpret unknown vv: "+a),null}};b.getTransformParams=function(a){return{transform:a.transform,hasZ:a.hasZ,hasM:a.hasM}};b.copyMeshData=function(a,c,e,d,
b,h,n){for(var p in h)for(var m=h[p].stride,f=u(m),k=h[p].data,q=e[p].data,r=m*b.vertexCount/f,t=m*a/f,f=m*b.vertexFrom/f,m=0;m<r;++m)q[m+t]=k[m+f];e=b.indexCount;for(m=0;m<e;++m)d[m+c]=n[m+b.indexFrom]-b.vertexFrom+a};b.C_VBO_INFO=(w={},w[b.C_VBO_GEOMETRY]=35044,w);b.createGeometryData=function(a,c){for(var e=[],d=0;5>d;++d){for(var b={},h=0,p=n(d);h<p.length;h++){var m=p[h];b[m]={data:c(d,m)}}e.push({data:a(d),buffers:b})}return e};b.createTextureFromTexelData=function(c,e){var b,h;a.isPowerOfTwo(e.width)&&
a.isPowerOfTwo(e.height)?(b=!0,h=9987):(b=!1,h=9729);return new d.Texture(c,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,hasMipmap:b,samplingMode:h,wrapMode:33071,flipped:!0},e)};b.geometryToMappedGeometry=function(a){return{vertexFrom:void 0,vertexTo:void 0,geometry:a}};b.getBytes=v;b.getPixelBytes=function(a){switch(a){case 5121:return 1;case 32819:return 2;case 5126:return 4;default:r.error(new k("webgl-utils","Unable to handle type "+a))}};b.getPixelArrayCtor=function(a){switch(a){case 5121:return Uint8Array;
case 32819:return Uint16Array;case 5126:return Float32Array;default:r.error(new k("webgl-utils","Unable to handle type "+a))}};var D=new Map;b.createProgramDescriptor=function(a,c){if(!D.has(a)){var e=t(c),d={},b;for(b in e){var h=e[b];d[b]=h.length?h[0].stride:0}b={};for(var n in c)for(var h=0,p=c[n];h<p.length;h++){var m=p[h];b[m.name]=m.location}D.set(a,{strides:d,bufferLayouts:e,attributes:b})}return D.get(a)}})},"esri/views/2d/engine/webgl/color":function(){define(["require","exports","./number"],
function(g,b,l){function k(a,b){Array.isArray(b)?(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3]):(a[0]=b.r,a[1]=b.g,a[2]=b.b,a[3]=b.a);return a}function f(a,b,d){void 0===b&&(b=0);void 0===d&&(d=!1);var c=a[b+3];a[b+0]*=c;a[b+1]*=c;a[b+2]*=c;d||(a[b+3]*=255);return a}Object.defineProperty(b,"__esModule",{value:!0});b.white=[255,255,255,1];var a=[0,0,0,0];b.premultiplyAlpha=f;b.copyAndPremultiply=function(a){return f(k([],a))};b.premultiplyAlphaUint32=function(b){f(k(a,b));return l.i8888to32(a[0],a[1],a[2],
a[3])};b.premultiplyAlphaRGBA=function(a){if(!a)return 0;var b=a.a;return l.i8888to32(a.r*b,a.g*b,a.b*b,255*b)}})},"esri/views/2d/engine/webgl/SymbolProperties":function(){define(["require","exports","../../../../core/ObjectPool"],function(g,b,l){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(){this.color=[0,0,0,0];this.haloColor=[0,0,0,0];this.haloSize=0;this.size=12;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=0}b.prototype.acquire=function(b,a,k,m,d,
c,e,h,p){this.color=b;this.haloColor=a;this.haloSize=k;this.size=m;this.angle=d;this.offsetX=c;this.offsetY=e;this.hAnchor=h;this.vAnchor=p};b.prototype.release=function(){this.color[0]=this.color[1]=this.color[2]=this.color[3]=0;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=this.size=this.haloSize=this.haloColor[0]=this.haloColor[1]=this.haloColor[2]=this.haloColor[3]=0};b.pool=new l(b);return b}();b.TextProperties=g})},"esri/views/2d/engine/webgl/util/debug":function(){define(["require",
"exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});b.createDebugLogger=function(b,k){return b&&function(){for(var b=[],a=0;a<arguments.length;a++)b[a]=arguments[a];return k.warn.apply(k,["DEBUG:"].concat(b))}||function(){return null}};b.DEBUG_ATTR_UPDATES=!1})},"esri/views/2d/engine/webgl/collisions/CollisionGrid":function(){define(["require","exports","../definitions"],function(g,b,l){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(b){this._bucketSize=
b;this._rowsLength=l.TILE_SIZE/b;this._colsLength=l.TILE_SIZE/b;this._grid=this._initGrid()}b.prototype.checkOverlap=function(b,a){b=Math.floor(b/this._bucketSize);a=Math.floor(a/this._bucketSize);return 0>b||b>=this._rowsLength||0>a||a>=this._colsLength?!0:this._grid[a][b]};b.prototype.markUsed=function(b,a){this._grid[Math.floor(a/this._bucketSize)][Math.floor(b/this._bucketSize)]=!0};b.prototype.reset=function(){this._grid=this._initGrid()};b.prototype._initGrid=function(){for(var b=[],a=0;a<this._rowsLength;a++)b.push(Array(this._colsLength));
return b};return b}();b.CollisionGrid=g})},"esri/views/2d/engine/webgl/collisions/CollisionEngine":function(){define("require exports ../../../../../core/Error ../../../../../core/Logger ../../../../../core/MapUtils ../../../../../core/mathUtils ../definitions ./CollisionBucket ./LayerCollisionInfo".split(" "),function(g,b,l,k,f,a,q,m,d){Object.defineProperty(b,"__esModule",{value:!0});var c=q.TILE_SIZE/q.COLLISION_BUCKET_SIZE,e=k.getLogger("esri.views.2d.engine.webgl.collisions.CollisionEngine");
g=function(){function b(a){this._layers=new Map;this._collisionBuckets=new Map;this._didError=!1;this._tilingScheme=a}Object.defineProperty(b.prototype,"collisionInfos",{get:function(){return f.valuesOfMap(this._layers)},enumerable:!0,configurable:!0});b.prototype.registerLayerView=function(a,c){if(!this._layers.has(a)){var e=d.default.create(a,c,this.collisionInfos,this._tilingScheme);this._layers.set(a,e);this._collisionBuckets.forEach(function(a){return a.onRegisterLayer(e.index)})}};b.prototype.unregisterLayerView=
function(a){var c=this;if(this._layers.has(a)){var e=this._layers.get(a);d.default.delete(e.index,this.collisionInfos);this._layers.delete(a);this._collisionBuckets.forEach(function(a,d){var b=a.getTile(e.index);b&&(a.onUnregisterLayer(e.index),a.canDelete()&&c._collisionBuckets.delete(d),b.reference&&(b.reference.isDirty=!1))})}};b.prototype.addTile=function(a,c){var e=c.key.id;this._layers.has(a)&&(this._collisionBuckets.has(e)||this._collisionBuckets.set(e,new m.default(c.key,this._layers.size)),
a=this._getIndex(a),this._collisionBuckets.get(e).getTile(a).reference=c)};b.prototype.removeTile=function(a,c){this._layers.has(a)&&this._collisionBuckets.has(c)&&(a=this._getIndex(a),c=this._collisionBuckets.get(c).getTile(a),c.dirty=!1,c.reference=null)};b.prototype.run=function(a,c){var b=f.valuesOfMap(this._collisionBuckets).sort(function(a,c){return a.key.compareRowMajor(c.key)}),h=!0,n=a.renderingOptions.labelCollisionsEnabled&&!this._didError,p=this.collisionInfos;try{for(var m=0;m<b.length;m++){var k=
b[m],h=h||k.isDirty;k.computeNeighbors(this._collisionBuckets);for(var q=0;q<this._layers.size;q++){var g=d.default.find(q,p);k.reset(a,h,g)}}for(a=0;a<this._layers.size;a++)for(g=d.default.find(a,p),h=0,m=b;h<m.length;h++)k=m[h],this._run(n,k,g,c)}catch(z){e.error(new l("mapview-labeling","Encountered an error during decluttering. Disabling collisions",z)),this._didError=!0}for(c=0;c<b.length;c++)k=b[c],k.ready()};b.prototype._run=function(a,c,e,d){var b=c.getReference(e.index);b&&b.hasData&&(b.key.level!==
d?this._resetLabelsMinZoom(c,e):this._runVisibility(a,c,b,e,d))};b.prototype._resetLabelsMinZoom=function(a,c){if(a&&"polyline"!==c.geometryType&&(a=a.getReference(c.index))&&a.hasData){c=c.layerView.tileRenderer.featuresView.attributeView;var e=0;for(a=a.displayObjects;e<a.length;e++)c.setLabelMinZoom(a[e].id,255)}};b.prototype._checkLabelsVisible=function(a,c){var e=!c.effect||c.effect.excludedLabelsVisible||!!(a&q.EFFECT_FLAG_0);return(!c.filter||!!(a&q.FILTER_FLAG_0))&&e};b.prototype._runVisibility=
function(a,c,e,d,b){var h=d.layerView.tileRenderer.featuresView.attributeView,n=0;for(e=e.displayObjects.sort(function(a,c){a=h.getLabelMinZoom(a.id);c=h.getLabelMinZoom(c.id);return a-c});n<e.length;n++){var p=e[n];if(p.metrics.length){var m="polyline"===d.geometryType?0:10*(b-1),f=h.getFilterFlags(p.id),k=this._checkLabelsVisible(f,d.layerView);if(a)for(var q=0;q<p.metrics.length;q++)f=p.metrics[q],f=k?-1!==f.minZoom?f.minZoom:this._computeLabelVisibility(p,f,d.index,c,f.baseZoom,b):255,m=Math.max(f,
m);h.setLabelMinZoom(p.id,m);k=0;for(p=p.metrics;k<p.length;k++)f=p[k],f.minZoom=m}}};b.prototype._computeLabelVisibility=function(a,e,d,b,h,m){for(var n=e.xBucket,p=e.yBucket,f=e.xOverflow,k=e.yOverflow,q=n-f,n=n+f+1,f=p+k+1,p=p-k;p<f;p++)for(k=q;k<n;k++)if(!(k<-c||p<-c||k>c||p>c))for(var t=0;t<=d;t++){var l=this._getRelativeSubBucket(t,b,k,p);if(l)for(var g=0;g<l.length;g++){var u=l[g];if(t!==d||u.id!==a.id)u=this._compareLabels(e,u,h,m),h=Math.max(u,h)}}return h};b.prototype._compareLabels=function(c,
e,d,b){if(-1===e.minZoom||e.minZoom>10*(b+1))return d;c=c.findCollisionDelta(e);b=a.clamp(Math.ceil(10*(c+b)),0,255);return e.minZoom>=b?d:Math.max(d,b)};b.prototype._getNeighboringTile=function(a,c,e,d){return(c=c.neighbors[3*(1+d)+(1+e)])&&c.getTile(a)};b.prototype._getRelativeSubBucket=function(c,e,d,b){var h=a.sign(Math.floor(d/4)),n=a.sign(Math.floor(b/4));return(c=this._getNeighboringTile(c,e,h,n))&&c.reference&&c.index&&c.reference.hasData?c.index[b-4*n][d-4*h]:null};b.prototype._getIndex=
function(a){return this._layers.get(a).index};return b}();b.CollisionEngine=g})},"esri/views/2d/engine/webgl/collisions/CollisionBucket":function(){define(["require","exports","../../../tiling","./CollisionBucketEntry"],function(g,b,l,k){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(a,b){this.neighbors=Array(9);this._tiles=Array(b);for(var m=0;m<b;m++)this._tiles[m]=new k.default;this.key=a}Object.defineProperty(b.prototype,"isDirty",{get:function(){for(var a=0,b=this._tiles;a<
b.length;a++)if(b[a].dirty)return!0;return!1},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"size",{get:function(){return this._tiles.length},enumerable:!0,configurable:!0});b.prototype.getTile=function(a){return this._tiles[a]};b.prototype.getReference=function(a){return(a=this._tiles[a])&&a.reference};b.prototype.onRegisterLayer=function(a){this.invalidateRange(a);this._add(a)};b.prototype.onUnregisterLayer=function(a){this.invalidateRange(a);this._remove(a)};b.prototype.onLabelsRendered=
function(){};b.prototype.invalidateRange=function(a){for(;a<this._tiles.length;a++)this._tiles[a].dirty=!0};b.prototype.add=function(a){this._add(a)};b.prototype.remove=function(a){this._remove(a)};b.prototype.canDelete=function(){return 0===this._tiles.length};b.prototype.ready=function(){for(var a=0,b=this._tiles;a<b.length;a++)b[a].dirty=!1};b.prototype.computeNeighbors=function(a){this.neighbors[0]=this._getNeighbor(a,-1,-1);this.neighbors[1]=this._getNeighbor(a,0,-1);this.neighbors[2]=this._getNeighbor(a,
1,-1);this.neighbors[3]=this._getNeighbor(a,-1,0);this.neighbors[4]=this;this.neighbors[5]=this._getNeighbor(a,1,0);this.neighbors[6]=this._getNeighbor(a,-1,1);this.neighbors[7]=this._getNeighbor(a,0,1);this.neighbors[8]=this._getNeighbor(a,1,1)};b.prototype.reset=function(a,b,m){var d=this._tiles[m.index];d&&d.reset(a,b,m)};b.prototype._add=function(a){var b=[];if(a>=this._tiles.length)this._tiles.push(new k.default);else{for(var m=0;m<this._tiles.length;m++)m===a&&b.push(new k.default),b.push(this._tiles[m]);
this._tiles=b}};b.prototype._remove=function(a){for(var b=[],m=0;m<this._tiles.length;m++)m!==a&&b.push(this._tiles[m]);this._tiles=b};b.prototype._getNeighbor=function(a,b,m){var d=this.key;b=l.TileKey.getId(d.level,d.row+m,d.col+b,d.world);return a.has(b)?a.get(b):null};return b}();b.default=g})},"esri/views/2d/engine/webgl/collisions/CollisionBucketEntry":function(){define(["require","exports","../../../../../core/libs/gl-matrix-2/vec2"],function(g,b,l){Object.defineProperty(b,"__esModule",{value:!0});
g=function(){function b(){this._reference=null}Object.defineProperty(b.prototype,"dirty",{get:function(){return this.reference&&this.reference.isDirty},set:function(b){this.reference&&this.reference.hasData&&(b||this.reference.isDirty)&&(this.reference.isDirty=b)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"index",{get:function(){return this._reference&&this._reference.labelIndex},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"reference",{get:function(){return this._reference},
set:function(b){this._reference=b},enumerable:!0,configurable:!0});b.prototype.reset=function(b,a,k){b=b.state;var m=k.layerView.tileRenderer,d=this.reference;if(!d||!d.hasData)return!1;a&&(d.isDirty=!0);a=d.transforms.labelMat2d;for(var c=a[4],e=a[5],h=0,p=d.displayObjects;h<p.length;h++)for(var n=p[h],f=m.featuresView.attributeView,f=k.hasVV()?f.getVVSize(n.id):0,q=0,n=n.metrics;q<n.length;q++){var g=n[q];k.hasVV()&&g.computeVVOffset(f,k.vvEval);var t=g.bounds.center,w=g.bounds.centerT;d.isDirty&&
(g.minZoom=-1);var r=l.vec2.copy(w,g.anchor);b.rotation?l.vec2.transformMat2d(r,r,a):(w[0]=r[0]+c,w[1]=r[1]+e);l.vec2.add(w,r,t);w[0]+=g.offsetX;w[1]+=g.offsetY;if(g.boxes)for(t=0,w=g.boxes;t<w.length;t++){var r=w[t],y=r.centerT;l.vec2.add(y,g.anchor,r.center);b.rotation?l.vec2.transformMat2d(y,y,a):(y[0]+=c,y[1]+=e)}}return!0};return b}();b.default=g})},"esri/views/2d/engine/webgl/collisions/LayerCollisionInfo":function(){define("require exports ../../../../../core/Logger ../../../../../core/mathUtils ../../../../../core/screenUtils ./visualVariableSimpleUtils".split(" "),
function(g,b,l,k,f,a){function q(c){return function(e){return f.pt2px(a.getSizeForValueSimple(e,c))}}function m(a){if(!a)return null;for(var c=0;c<a.length;c++){var e=a[c];if("size"===e.type)return q(e)}return null}Object.defineProperty(b,"__esModule",{value:!0});var d=function(a,c){return a.order-c.order},c=function(a,c){return a.index-c.index},e=l.getLogger("esri/views/2d/engine/webgl/collisions/CollisionEngine");b.createLabelVVEvaluator=m;g=function(){function a(a,c,e,d){var b=this;this._vvHandle=
null;var h=a.layer,n=h.geometryType,p=h.labelingInfo,f=h.renderer;h.renderer&&(this.vvEval=m("visualVariables"in f&&f.visualVariables));this._vvHandle=h.watch("renderer",function(a){h.renderer&&(b.vvEval=m("visualVariables"in a&&a.visualVariables))});p=p.map(function(a){var c=!!a.maxScale,e=!!a.minScale&&d.scaleToZoom(a.minScale)||0;a=c&&d.scaleToZoom(a.maxScale)||255;return{minZoom:k.clamp(Math.floor(10*e),0,255),maxZoom:k.clamp(Math.floor(10*a),0,255)}});this.layerView=a;this.geometryType=n;this.index=
c;this.order=e;this.zoomRanges=p;this.layerView=a}a.prototype.hasVV=function(){return!!this.vvEval};a.prototype.allOrNothing=function(){return"polyline"!==this.geometryType};a.prototype.destroy=function(){this._vvHandle.remove()};a.create=function(c,e,b,h){b=b.sort(d);for(var n=!1,p=-1,m=0;m<b.length;m++){var f=b[m];!n&&f.order>e&&(p=f.index,n=!0);n&&f.index++}n||(p=b.length);return new a(c,p,e,h)};a.delete=function(a,e){for(var d=e.sort(c),b=a+1;b<d.length;b++)e[b].index--;e[a].destroy();e.splice(a,
1)};a.find=function(a,c){for(var d=0;d<c.length;d++){var b=c[d];if(b.index===a)return b}e.error("Tried to get a LayerCollisionInfo for an index that doesn't exist!");return null};return a}();b.default=g})},"esri/views/2d/engine/webgl/collisions/visualVariableSimpleUtils":function(){define(["require","exports","../../../../../core/mathUtils","../../../../../renderers/support/utils"],function(g,b,l,k){function f(d,c){switch(c.transformationType){case "additive":var e=a(c.minSize,d);return d+(e||c.minDataValue);
case "constant":return e=(e=c.stops)&&e.length&&e[0].size,null==e&&(e=c.minSize),a(e,d);case "clamped-linear":var e=(d-c.minDataValue)/(c.maxDataValue-c.minDataValue),b=a(c.minSize,d),p=a(c.maxSize,d);d=d<=c.minDataValue?b:d>=c.maxDataValue?p:b+e*(p-b);return d;case "proportional":return e=d/c.minDataValue,b=a(c.minSize,d),d=a(c.maxSize,d),l.clamp(e*b,b,d);case "stops":return b=q(d,c.cache.ipData),p=b[0],e=b[1],b=b[2],p===e?d=a(c.stops[p].size,d):(p=a(c.stops[p].size,d),d=a(c.stops[e].size,d),d=p+
(d-p)*b),d;case "real-world-size":e=k.meterIn[c.valueUnit];b=a(c.minSize,d);p=a(c.maxSize,d);c=c.valueRepresentation;var n=null,n="area"===c?2*Math.sqrt(d/m)/e:"radius"===c||"distance"===c?2*d/e:d/e;return l.clamp(n,b,p);case "identity":return d;case "unknown":return null}}function a(a,c){return"number"===typeof a?a:f(c,a)}function q(a,c){if(c){var e=0,d=c.length-1;c.some(function(c,b){if(a<c)return d=b,!0;e=b;return!1});return[e,d,(a-c[e])/(c[d]-c[e])]}}Object.defineProperty(b,"__esModule",{value:!0});
var m=Math.PI;b.getSizeForValueSimple=f})},"esri/views/2d/engine/webgl/collisions/LayerViewSorter":function(){define(["require","exports","../../../../../core/Error","../../../../../core/Logger"],function(g,b,l,k){function f(a){return"esri.views.2d.layers.FeatureLayerView2D"===a.declaredClass||"esri.views.2d.layers.StreamLayerView2D"===a.declaredClass}Object.defineProperty(b,"__esModule",{value:!0});var a=k.getLogger("esri.views.2d.engine.collisions.LayerViewSorter");g=function(){function b(a,d){this.registerLayer=
a;this.unregisterLayer=d;this._layerViewState=new Map}b.prototype.findIndex=function(a){return a.view.allLayerViews.findIndex(function(d){return d.uid===a.uid})};b.prototype.update=function(b){for(var d=b.added,c=0,e=b.removed;c<e.length;c++)b=e[c],f(b)&&this._layerViewState.has(b)&&this._deleteState(b);for(c=0;c<d.length;c++){b=d[c];if(e=f(b))a:if(b.layer&&b.layer.renderer)switch(b.layer.renderer.type){case "class-breaks":case "simple":case "unique-value":case "dictionary":case "dot-density":e=!0;
break a;default:a.error(new l("mapview-labeling","Renderer of type "+b.layer.renderer.type+" does not currently support labeling")),e=!1}else e=!1;e&&!this._layerViewState.has(b)&&this._createState(b)}this._recomputeOrder()};b.prototype.destroy=function(){this._layerViewState.forEach(function(a){return a.handle.remove()})};b.prototype._createState=function(a){var d={priority:-1,handle:null};d.handle=a.watch("labelsVisible",this._recomputeOrder.bind(this));this._layerViewState.set(a,d);return d};b.prototype._deleteState=
function(a){if(this._layerViewState.has(a)){var d=this._layerViewState.get(a);d.handle.remove();-1!==d.priority&&this.unregisterLayer(a);this._layerViewState.delete(a)}};b.prototype._recomputeOrder=function(){var a=this;this._layerViewState.forEach(function(d,c){var e=c.view.map.allLayers.findIndex(function(a){return a.uid===c.layer.uid}),b=c.layer,e=b.visible&&b.labelsVisible&&b.labelingInfo?4294967295-e:-1;e!==d.priority&&(d.priority=e,a.unregisterLayer(c),-1!==e&&a.registerLayer(c,e))})};return b}();
b.LayerViewSorter=g})},"esri/views/2d/engine/webgl/Geometry":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(b,f){this.x=b;this.y=f}b.prototype.clone=function(){return new b(this.x,this.y)};b.prototype.equals=function(b,f){return b===this.x&&f===this.y};b.prototype.isEqual=function(b){return b.x===this.x&&b.y===this.y};b.prototype.setCoords=function(b,f){this.x=b;this.y=f};b.prototype.normalize=function(){var b=this.x,
f=this.y,b=Math.sqrt(b*b+f*f);this.x/=b;this.y/=b};b.prototype.rightPerpendicular=function(){var b=this.x;this.x=this.y;this.y=-b};b.prototype.move=function(b,f){this.x+=b;this.y+=f};b.prototype.assign=function(b){this.x=b.x;this.y=b.y};b.prototype.assignAdd=function(b,f){this.x=b.x+f.x;this.y=b.y+f.y};b.prototype.assignSub=function(b,f){this.x=b.x-f.x;this.y=b.y-f.y};b.prototype.rotate=function(b,f){var a=this.x,k=this.y;this.x=a*b-k*f;this.y=a*f+k*b};b.prototype.scale=function(b){this.x*=b;this.y*=
b};b.prototype.length=function(){var b=this.x,f=this.y;return Math.sqrt(b*b+f*f)};b.distance=function(b,f){var a=f.x-b.x;b=f.y-b.y;return Math.sqrt(a*a+b*b)};b.add=function(k,f){return new b(k.x+f.x,k.y+f.y)};b.sub=function(k,f){return new b(k.x-f.x,k.y-f.y)};return b}();b.Point=g})},"esri/views/2d/engine/webgl/alignmentUtils":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});var l;(function(b){b[b.Left=-1]="Left";b[b.Center=0]="Center";b[b.Right=
1]="Right"})(l=b.HAlign||(b.HAlign={}));var k;(function(b){b[b.Top=1]="Top";b[b.Center=0]="Center";b[b.Bottom=-1]="Bottom";b[b.Baseline=2]="Baseline"})(k=b.VAlign||(b.VAlign={}));b.getXAnchorDirection=function(b){switch(b){case "left":return l.Left;case "right":return l.Right;case "center":case "justify":return l.Center}};b.getYAnchorDirection=function(b){switch(b){case "top":return k.Top;case "middle":return k.Center;case "baseline":return k.Baseline;case "bottom":return k.Bottom}};b.getAlignmentFromPlacement=
function(b){switch(b){case "above-left":return[l.Right,k.Bottom];case "above-center":case "above-along":return[l.Center,k.Bottom];case "above-right":return[l.Left,k.Bottom];case "center-left":return[l.Right,k.Center];case "center-center":case "center-along":return[l.Center,k.Center];case "center-right":return[l.Left,k.Center];case "below-left":return[l.Right,k.Top];case "below-center":case "below-along":return[l.Center,k.Top];case "below-right":return[l.Left,k.Top];case "always-horizontal":return[l.Center,
k.Baseline];default:return console.debug("Found invalid placement type "+b),[l.Center,k.Center]}};b.getXDirection=function(b){switch(b){case l.Right:return-1;case l.Center:return 0;case l.Left:return 1;default:return console.debug("Found invalid horizontal alignment "+b),0}};b.getYDirection=function(b){switch(b){case k.Top:return 1;case k.Center:return 0;case k.Bottom:case k.Baseline:return-1;default:return console.debug("Found invalid vertical alignment "+b),0}};b.getJustification=function(b){switch(b){case "left":return l.Left;
case "right":return l.Right;case "center":case "justify":return l.Center}}})},"esri/views/2d/engine/webgl/brushes/BrushBitmap":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../definitions ../VertexStream ./WGLBrush".split(" "),function(g,b,l,k,f,a){Object.defineProperty(b,"__esModule",{value:!0});var q={nearest:{defines:[],samplingMode:9728,mips:!1},bilinear:{defines:[],samplingMode:9729,mips:!1},bicubic:{defines:["bicubic"],samplingMode:9729,mips:!1},trilinear:{defines:[],
samplingMode:9987,mips:!0}};g=function(a){function b(){var c=null!==a&&a.apply(this,arguments)||this;c._desc={path:"raster/bitmap",attributes:{a_position:0,a_texcoord:1}};return c}l(b,a);b.prototype.dispose=function(){this._quad&&this._quad.dispose()};b.prototype.prepareState=function(a,e){a=a.context;a.setBlendingEnabled(!0);a.setBlendFunctionSeparate(1,771,1,771);a.setColorMask(!0,!0,!0,!0);a.setStencilWriteMask(0);a.setStencilTestEnabled(!0);a.setStencilFunction(514,e.stencilRef,255)};b.prototype.draw=
function(a,e){var c=a.context,b=a.renderingOptions,d=a.painter;if(e.source){a.timeline.begin(this.name);this._quad||(this._quad=new f(c,[0,0,1,0,0,1,1,1]));if("dynamic"===b.samplingMode)var b=a.state,m=e.resolution/e.pixelRatio/b.resolution,l=Math.round(a.pixelRatio)!==a.pixelRatio,b=b.rotation||1.05<m||.95>m||l||e.isSourceScaled||e.rotation?q.bilinear:q.nearest;else b=q[b.samplingMode];d=d.materialManager.getProgram(a,this._desc,b.defines);e.setSamplingProfile(b);e.bind(k.TEXTURE_BINDING_BITMAP);
c.bindProgram(d);d.setUniformMatrix3fv("u_dvsMat3",e.transforms.dvs);d.setUniform1i("u_texture",k.TEXTURE_BINDING_BITMAP);d.setUniform2fv("u_coordScale",e.coordScale);this._quad.draw();a.timeline.end(this.name)}};return b}(a.default);b.default=g})},"esri/views/2d/engine/webgl/brushes/BrushClip":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec4f32 ../Utils ./WGLBrush ../shaders/BackgroundPrograms ../../../../webgl/programUtils".split(" "),
function(g,b,l,k,f,a,q,m){Object.defineProperty(b,"__esModule",{value:!0});g=function(a){function c(){var c=null!==a&&a.apply(this,arguments)||this;c._color=k.vec4f32.fromValues(0,1,0,1);return c}l(c,a);c.prototype.dispose=function(){this._program&&this._program.dispose()};c.prototype.prepareState=function(a){a=a.context;a.setStencilTestEnabled(!0);a.setBlendingEnabled(!1);a.setFaceCullingEnabled(!1);a.setColorMask(!1,!1,!1,!1);a.setStencilOp(7680,7680,7681);a.setStencilWriteMask(255);a.setStencilFunction(519,
0,255)};c.prototype.draw=function(a,c){var e=a.context;a=a.state;this._program||(this._program=m.createProgram(e,q.background));var b=this._program,d=f.createProgramDescriptor("clip",{geometry:[{location:0,name:"a_pos",count:2,type:5122}]});c=c.getVAO(e,a,d.attributes,d.bufferLayouts);e.bindProgram(this._program);b.setUniform2fv("u_coord_range",[1,1]);b.setUniform4fv("u_color",this._color);b.setUniformMatrix3fv("u_dvsMat3",a.displayMat3);e.bindVAO(c);e.drawElements(4,c.indexBuffer.size,5125,0);e.bindVAO()};
return c}(a.default);b.default=g})},"esri/views/2d/engine/webgl/brushes/BrushRasterBitmap":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/tsSupport/assignHelper ../VertexStream ../WGLRasterUtils ./WGLBrush".split(" "),function(g,b,l,k,f,a,q){Object.defineProperty(b,"__esModule",{value:!0});g=function(b){function d(){var a=null!==b&&b.apply(this,arguments)||this;a._desc={lut:{path:"raster/lut",attributes:{a_position:0,a_texcoord:1}},stretch:{path:"raster/stretch",
attributes:{a_position:0,a_texcoord:1}}};return a}l(d,b);d.prototype.dispose=function(){this._quad&&this._quad.dispose()};d.prototype.prepareState=function(a,e){a=a.context;a.setBlendingEnabled(!0);a.setBlendFunctionSeparate(1,771,1,771);a.setColorMask(!0,!0,!0,!0);a.setStencilWriteMask(0);a.setStencilTestEnabled(!0);a.setStencilFunction(514,e.stencilRef,255)};d.prototype.draw=function(c,e){var b=c.context,d=c.painter;if(e.source&&!e.suspended){c.timeline.begin(this.name);this._quad||(this._quad=
new f(b,[0,0,1,0,0,1,1,1]));d=d.materialManager.getProgram(c,this._desc[e.symbolizerParameters.type]);b.bindProgram(d);var n=a.getUniformInfos(b,d),m=e.getTextures();a.setTextures(b,d,m.names,m.textures);m=e.getUniforms();e=k({u_opacity:e.opacity,u_coordScale:e.coordScale},m);e.u_flipY=!1;a.setUniforms(b,d,n,e);this._quad.draw();c.timeline.end(this.name)}};return d}(q.default);b.default=g})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLBackground":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/mat3f32 ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ../../vectorTiles/shaders/Programs ../definitions ../enums ../number ./WGLBrush".split(" "),
function(g,b,l,k,f,a,q,m,d,c,e){Object.defineProperty(b,"__esModule",{value:!0});g=function(e){function b(){var a=null!==e&&e.apply(this,arguments)||this;a._color=f.vec4f32.fromValues(1,0,0,1);a._patternMatrix=k.mat3f32.create();a._programOptions={id:!1,pattern:!1};return a}l(b,e);b.prototype.dispose=function(){this._program&&(this._program.dispose(),this._program=null);this._vao&&(this._vao.dispose(),this._vao=null)};b.prototype.drawMany=function(a,e){var b=a.context,h=a.styleLayerId;this._loadWGLResources(b);
var n=a.displayLevel,p=a.styleLayer,f=a.painter.getVectorTileProgramCach(),k=p.getPaintValue("background-color",n),q=p.getPaintValue("background-opacity",n),l=p.getPaintValue("background-pattern",n),g=void 0!==l,u=k[3]*q,D=a.spriteMosaic,H,F=(window.devicePixelRatio|1)>m.VTL_HIGH_RES_CUTOFF?2:1;a=a.drawPhase===d.WGLDrawPhase.HITTEST;var E=this._programOptions;E.id=a;E.pattern=g;f=f.getProgram(0,(a?1:0)<<1|(g?1:0),E);b.bindVAO(this._vao);b.bindProgram(f);if(g){H=D.getMosaicItemPosition(l,!0);if(!H)return;
f.setUniform1f("u_opacity",q);f.setUniform2f("u_pattern_tl",H.tl[0],H.tl[1]);f.setUniform2f("u_pattern_br",H.br[0],H.br[1]);f.setUniform1i("u_texture",m.VTL_TEXTURE_BINDING_UNIT_SPRITES);D.bind(b,9729,H.page,m.VTL_TEXTURE_BINDING_UNIT_SPRITES)}else this._color[0]=u*k[0],this._color[1]=u*k[1],this._color[2]=u*k[2],this._color[3]=u,f.setUniform4fv("u_color",this._color);f.setUniform1f("u_depth",p.z||0);a&&(h=c.u32to4Xu8(h),f.setUniform4f("u_id",h[0],h[1],h[2],h[3]));for(h=0;h<e.length;h++)p=e[h],f.setUniform1f("u_coord_range",
p.coordRange[0]),f.setUniformMatrix3fv("u_dvsMat3",p.transforms.dvs),g&&(k=F*p.size[0]*Math.max(Math.pow(2,Math.round(n)-p.key.level),1),q=k/H.size[1],this._patternMatrix[0]=k/H.size[0],this._patternMatrix[4]=q,f.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix)),b.setStencilFunction(514,p.stencilRef,255),b.drawArrays(5,0,4)};b.prototype._loadWGLResources=function(c){if(!this._program||!this._vao){var e=a.createProgram(c,q.background);if(e){var b=new Int8Array([0,0,1,0,0,1,1,1]),b=a.BufferObject.createVertex(c,
35044,b);c=new a.VertexArrayObject(c,q.background.attributes,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},{geometry:b});this._program=e;this._vao=c}}};return b}(e.default);b.WGLBrushVTLBackground=g})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLCircle":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ../enums ../number ./WGLBrush".split(" "),function(g,b,l,k,f,
a,q,m){Object.defineProperty(b,"__esModule",{value:!0});var d=[1,1,1,1];g=function(c){function e(){var a=null!==c&&c.apply(this,arguments)||this;a._color=k.vec4f32.create();a._strokeColor=k.vec4f32.create();a._programOptions={id:!1};a._vertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:4,stride:16,normalized:!0,divisor:0},{name:"a_stroke_color",count:4,type:5121,offset:8,stride:16,normalized:!0,divisor:0},
{name:"a_data",count:4,type:5121,offset:12,stride:16,normalized:!1,divisor:0}]};return a}l(e,c);e.prototype.dispose=function(){};e.prototype.drawMany=function(c,e){var b=c.context,h=c.state,p=c.drawPhase,m=c.styleLayerId,f=c.displayLevel,k=c.styleLayer;c=c.painter.getVectorTileProgramCach();var r=k.hasDataDrivenRadius?1:k.getPaintValue("circle-radius",f),l=k.hasDataDrivenColor?d:k.getPaintValue("circle-color",f),g=k.hasDataDrivenOpacity?1:k.getPaintValue("circle-opacity",f),z=k.hasDataDrivenStrokeWidth?
1:k.getPaintValue("circle-stroke-width",f),B=k.hasDataDrivenStrokeColor?d:k.getPaintValue("circle-stroke-color",f),C=k.hasDataDrivenStrokeOpacity?1:k.getPaintValue("circle-stroke-opacity",f),D=k.hasDataDrivenBlur?0:k.getPaintValue("circle-blur",f),g=g*l[3];this._color[0]=g*l[0];this._color[1]=g*l[1];this._color[2]=g*l[2];this._color[3]=g;g=C*B[3];this._strokeColor[0]=g*B[0];this._strokeColor[1]=g*B[1];this._strokeColor[2]=g*B[2];this._strokeColor[3]=g;l=k.getPaintValue("circle-translate",f);f=k.getPaintValue("circle-translate-anchor",
f);B=p===a.WGLDrawPhase.HITTEST;p=this._programOptions;p.id=B;p=c.getProgram(5,B?1:0,p);b.bindProgram(p);p.setUniformMatrix3fv("u_displayMat3",1===f?h.displayMat3:h.displayViewMat3);p.setUniform2fv("u_circleTranslation",l);p.setUniform1f("u_depth",k.z);p.setUniform1f("u_radius",r);p.setUniform4fv("u_color",this._color);p.setUniform1f("u_blur",D);p.setUniform1f("u_stroke_width",z);p.setUniform4fv("u_stroke_color",this._strokeColor);p.setUniform1f("u_antialiasingWidth",1.2);B&&(h=q.u32to4Xu8(m),p.setUniform4f("u_id",
h[0],h[1],h[2],h[3]));for(h=0;h<e.length;h++)if(k=e[h],k.layerData[m]&&(r=k.layerData[m],z=this._getCircleVAO(b,k,c)))b.bindVAO(z),p.setUniformMatrix3fv("u_dvsMat3",k.transforms.dvs),b.setStencilFunction(514,k.stencilRef,255),b.drawElements(4,r.triangleElementCount,5125,12*r.triangleElementStart),k.triangleCount+=r.triangleElementCount/3};e.prototype._getCircleVAO=function(a,c,e){if(c.circleVertexArrayObject)return c.circleVertexArrayObject;var b=c.circleVertexBuffer,d=c.circleIndexBuffer;if(!b||
!d)return null;c.circleVertexArrayObject=new f.VertexArrayObject(a,e.getProgramAttributes(5),this._vertexAttributes,{geometry:b},d);return c.circleVertexArrayObject};return e}(m.default);b.WGLBrushVTLCircle=g})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLFill":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/mat3f32 ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ../definitions ../enums ../number ./WGLBrush".split(" "),
function(g,b,l,k,f,a,q,m,d,c){Object.defineProperty(b,"__esModule",{value:!0});var e=1/65536,h=[1,1,1,1];g=function(c){function b(){var a=null!==c&&c.apply(this,arguments)||this;a._fillVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:4,normalized:!1,divisor:0}]};a._fillVertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:8,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:4,stride:8,normalized:!0,divisor:0}]};a._outlineVertexAttributes=
{geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:8,normalized:!1,divisor:0},{name:"a_offset",count:2,type:5120,offset:4,stride:8,normalized:!1,divisor:0},{name:"a_xnormal",count:2,type:5120,offset:6,stride:8,normalized:!1,divisor:0}]};a._outlineVertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:12,normalized:!1,divisor:0},{name:"a_offset",count:2,type:5120,offset:4,stride:12,normalized:!1,divisor:0},{name:"a_xnormal",count:2,type:5120,offset:6,stride:12,normalized:!1,
divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:12,normalized:!0,divisor:0}]};a._color=f.vec4f32.create();a._outlineColor=f.vec4f32.create();a._fillProgramOptions={id:!1,dd:!1,pattern:!1};a._outlineProgramOptions={id:!1,dd:!1};a._patternMatrix=k.mat3f32.create();return a}l(b,c);b.prototype.dispose=function(){};b.prototype.drawMany=function(a,c){var e=a.displayLevel,b=a.drawPhase,n=a.renderPass,p=a.styleLayerId,f=a.styleLayer,k=f.getPaintValue("fill-pattern",e),q=f.hasDataDrivenColor?
h:f.getPaintValue("fill-color",e),l=f.hasDataDrivenOpacity?1:f.getPaintValue("fill-opacity",e),g=l*q[3],u=void 0!==k||1>g||f.hasDataDrivenFill;if(!u||"opaque"!==n){this._color[0]=g*q[0];this._color[1]=g*q[1];this._color[2]=g*q[2];this._color[3]=g;var x;b===m.WGLDrawPhase.HITTEST&&(x=d.u32to4Xu8(p));b=f.getPaintValue("fill-translate",e);e=f.getPaintValue("fill-translate-anchor",e);this._drawFill(a,p,f,c,b,e,k,u,x);this._drawOutline(a,p,f,c,b,e,k,x,l)}};b.prototype._drawFill=function(a,c,b,d,h,n,p,
f,k){var r=a.context,g=a.displayLevel,l=a.drawPhase,t=a.renderPass,u=a.spriteMosaic,x=a.state;if(f||"translucent"!==t){f=void 0!==p;var t=a.pixelRatio>q.VTL_HIGH_RES_CUTOFF?2:1,A=b.hasDataDrivenFill;a=a.painter.getVectorTileProgramCach();var w,v=l===m.WGLDrawPhase.HITTEST,l=this._fillProgramOptions;l.id=v;l.dd=A;l.pattern=f;l=a.getProgram(1,(v?1:0)<<2|(A?1:0)<<1|(f?1:0),l);r.bindProgram(l);if(f){w=u.getMosaicItemPosition(p,!0);if(!w){r.bindProgram();return}l.setUniform2f("u_pattern_tl",w.tl[0],w.tl[1]);
l.setUniform2f("u_pattern_br",w.br[0],w.br[1]);l.setUniform1i("u_texture",q.VTL_TEXTURE_BINDING_UNIT_SPRITES);u.bind(r,9729,w.page,q.VTL_TEXTURE_BINDING_UNIT_SPRITES)}l.setUniformMatrix3fv("u_displayMat3",1===n?x.displayMat3:x.displayViewMat3);l.setUniform2fv("u_fillTranslation",h);l.setUniform1f("u_depth",b.z+e);l.setUniform4fv("u_color",this._color);v&&l.setUniform4f("u_id",k[0],k[1],k[2],k[3]);for(b=0;b<d.length;b++)if(h=d[b],h.layerData[c]&&(p=this._getFillVAO(r,h,A,a)))n=h.layerData[c],r.bindVAO(p),
l.setUniformMatrix3fv("u_dvsMat3",h.transforms.dvs),f&&(p=h.coordRange[0]/(t*h.size[0]*Math.max(Math.pow(2,Math.round(g)-h.key.level),1)),k=1/(w.size[1]*p),this._patternMatrix[0]=1/(w.size[0]*p),this._patternMatrix[4]=k,l.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix)),r.setStencilFunction(514,h.stencilRef,255),r.drawElements(4,n.triangleElementCount,5125,12*n.triangleElementStart),h.triangleCount+=n.triangleElementCount/3}};b.prototype._drawOutline=function(a,c,b,d,n,p,f,k,q){var l=
a.context,r=a.displayLevel,g=a.drawPhase,t=a.pixelRatio,u=a.state;if("opaque"!==a.renderPass&&(f=void 0!==f,b.getPaintValue("fill-antialias",r)&&!f||b.hasDataDrivenOutlineColor)){a=a.painter.getVectorTileProgramCach();f=b.hasDataDrivenOutline;if(b.outlineUsesFillColor){if(1!==this._color[3])return;this._outlineColor[0]=this._color[0];this._outlineColor[1]=this._color[1];this._outlineColor[2]=this._color[2];this._outlineColor[3]=this._color[3]}else r=b.hasDataDrivenOutlineColor?h:b.getPaintValue("fill-outline-color",
r),q*=r[3],this._outlineColor[0]=q*r[0],this._outlineColor[1]=q*r[1],this._outlineColor[2]=q*r[2],this._outlineColor[3]=q;t=.75/t;q=g===m.WGLDrawPhase.HITTEST;g=this._outlineProgramOptions;g.id=q;g.dd=f;g=a.getProgram(2,(q?1:0)<<1|(f?1:0),g);l.bindProgram(g);g.setUniformMatrix3fv("u_displayMat3",1===p?u.displayMat3:u.displayViewMat3);g.setUniform2fv("u_fillTranslation",n);g.setUniform1f("u_depth",b.z+e);g.setUniform1f("u_outline_width",t);g.setUniform4fv("u_color",this._outlineColor);q&&g.setUniform4f("u_id",
k[0],k[1],k[2],k[3]);for(b=0;b<d.length;b++)if(n=d[b],n.layerData[c]&&(p=n.layerData[c],k=this._getOutlineVAO(l,n,f,a)))l.bindVAO(k),g.setUniformMatrix3fv("u_dvsMat3",n.transforms.dvs),l.setStencilFunction(514,n.stencilRef,255),l.drawElements(4,p.outlineElementCount,5125,12*p.outlineElementStart),n.triangleCount+=p.outlineElementCount/3}};b.prototype._getFillVAO=function(c,e,b,d){if(b){if(e.fillDDVertexArrayObject)return e.fillDDVertexArrayObject;b=e.fillDDVertexBuffer;var h=e.fillIndexBuffer;if(!b||
!h)return null;e.fillDDVertexArrayObject=new a.VertexArrayObject(c,d.getProgramAttributes(1),this._fillVertexAttributesDD,{geometry:b},h);return e.fillDDVertexArrayObject}if(e.fillVertexArrayObject)return e.fillVertexArrayObject;b=e.fillVertexBuffer;h=e.fillIndexBuffer;if(!b||!h)return null;e.fillVertexArrayObject=new a.VertexArrayObject(c,d.getProgramAttributes(1),this._fillVertexAttributes,{geometry:b},h);return e.fillVertexArrayObject};b.prototype._getOutlineVAO=function(c,e,b,d){if(b){if(e.outlineDDVertexArrayObject)return e.outlineDDVertexArrayObject;
b=e.outlineDDVertexBuffer;var h=e.outlineIndexBuffer;if(!b||!h)return null;e.outlineDDVertexArrayObject=new a.VertexArrayObject(c,d.getProgramAttributes(2),this._outlineVertexAttributesDD,{geometry:b},h);return e.outlineDDVertexArrayObject}if(e.outlineVertexArrayObject)return e.outlineVertexArrayObject;b=e.outlineVertexBuffer;h=e.outlineIndexBuffer;if(!b||!h)return null;e.outlineVertexArrayObject=new a.VertexArrayObject(c,d.getProgramAttributes(2),this._outlineVertexAttributes,{geometry:b},h);return e.outlineVertexArrayObject};
return b}(c.default);b.WGLBrushVTLFill=g})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLLine":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec2f32 ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ../definitions ../enums ../number ./WGLBrush".split(" "),function(g,b,l,k,f,a,q,m,d,c){Object.defineProperty(b,"__esModule",{value:!0});b.C_DEG_TO_RAD=Math.PI/180;var e=[1,1,1,1];g=function(c){function b(){var a=null!==
c&&c.apply(this,arguments)||this;a._color=f.vec4f32.create();a._dashArray=k.vec2f32.create();a._programOptions={id:!1,dd:!1,pattern:!1};a._vertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:12,normalized:!1,divisor:0},{name:"a_offsetAndNormal",count:4,type:5120,offset:4,stride:12,normalized:!1,divisor:0},{name:"a_accumulatedDistance",count:2,type:5123,offset:8,stride:12,normalized:!1,divisor:0}]};a._vertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:20,
normalized:!1,divisor:0},{name:"a_offsetAndNormal",count:4,type:5120,offset:4,stride:20,normalized:!1,divisor:0},{name:"a_accumulatedDistance",count:2,type:5122,offset:8,stride:20,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:12,stride:20,normalized:!0,divisor:0},{name:"a_width",count:1,type:5126,offset:16,stride:20,normalized:!1,divisor:0}]};return a}l(b,c);b.prototype.dispose=function(){};b.prototype.drawMany=function(a,c){var b=a.context,h=a.displayLevel,n=a.state,p=a.drawPhase,
f=a.styleLayerId,k=a.styleLayer,l=a.painter.getVectorTileProgramCach(),g=k.getPaintValue("line-translate",h),u=k.getPaintValue("line-translate-anchor",h),C=k.getPaintValue("line-pattern",h),D=void 0!==C,H=1/a.pixelRatio,F=k.getPaintValue("line-blur",h),E=k.hasDataDrivenColor?e:k.getPaintValue("line-color",h),G=k.hasDataDrivenOpacity?1:k.getPaintValue("line-opacity",h),J=k.hasDataDrivenWidth?1:k.getPaintValue("line-width",h),G=G*E[3];this._color[0]=G*E[0];this._color[1]=G*E[1];this._color[2]=G*E[2];
this._color[3]=G;var E=k.hasDataDrivenLine,G=p===m.WGLDrawPhase.HITTEST,K;G&&(K=d.u32to4Xu8(f));p=this._programOptions;p.id=G;p.dd=E;p.pattern=D;p=l.getProgram(3,(G?1:0)<<2|(E?1:0)<<1|(D?1:0),p);b.bindProgram(p);p.setUniformMatrix3fv("u_displayViewMat3",n.displayViewMat3);p.setUniformMatrix3fv("u_displayMat3",1===u?n.displayMat3:n.displayViewMat3);p.setUniform2fv("u_lineTranslation",g);p.setUniform1f("u_depth",k.z);p.setUniform1f("u_blur",F);p.setUniform1f("u_antialiasing",H);p.setUniform4fv("u_color",
this._color);p.setUniform1f("u_width",J);G&&p.setUniform4f("u_id",K[0],K[1],K[2],K[3]);if(D){if(a=a.spriteMosaic,C=a.getMosaicItemPosition(C,!0))a.bind(b,9729,C.page,q.VTL_TEXTURE_BINDING_UNIT_SPRITES),p.setUniform2f("u_pattern_tl",C.tl[0],C.br[1]),p.setUniform2f("u_pattern_br",C.br[0],C.tl[1]),p.setUniform2f("u_spriteSize",8*C.size[0],C.size[1]),p.setUniform1i("u_texture",q.VTL_TEXTURE_BINDING_UNIT_SPRITES)}else C=k.getPaintValue("line-dasharray",h),2>C.length&&(C=[1,-1]),this._dashArray[0]=8*C[0],
this._dashArray[1]=8*C[1],p.setUniform2fv("u_dasharray",this._dashArray);for(C=0;C<c.length;C++)if(a=c[C],a.layerData[f]&&(h=a.layerData[f],n=this._getLineVAO(b,a,E,l)))b.bindVAO(n),p.setUniformMatrix3fv("u_dvsMat3",a.transforms.dvs),b.setStencilFunction(514,a.stencilRef,255),b.drawElements(4,h.triangleElementCount,5125,12*h.triangleElementStart),a.triangleCount+=h.triangleElementCount/3};b.prototype._getLineVAO=function(c,e,b,d){if(b){if(e.lineDDVertexArrayObject)return e.lineDDVertexArrayObject;
b=e.lineDDVertexBuffer;var h=e.lineIndexBuffer;if(!b||!h)return null;e.lineDDVertexArrayObject=new a.VertexArrayObject(c,d.getProgramAttributes(3),this._vertexAttributesDD,{geometry:b},h);return e.lineDDVertexArrayObject}if(e.lineVertexArrayObject)return e.lineVertexArrayObject;b=e.lineVertexBuffer;h=e.lineIndexBuffer;if(!b||!h)return null;e.lineVertexArrayObject=new a.VertexArrayObject(c,d.getProgramAttributes(3),this._vertexAttributes,{geometry:b},h);return e.lineVertexArrayObject};return b}(c.default);
b.WGLBrushVTLLine=g})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLSymbol":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec2f32 ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ../definitions ../enums ../GeometryUtils ../number ./WGLBrush".split(" "),function(g,b,l,k,f,a,q,m,d,c,e){Object.defineProperty(b,"__esModule",{value:!0});var h=1/65536,p=[1,1,1,1];g=function(e){function b(){var a=null!==e&&e.apply(this,
arguments)||this;a._vertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:4,stride:16,normalized:!1,divisor:0},{name:"a_tex",count:4,type:5121,offset:8,stride:16,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:16,normalized:!1,divisor:0}]};a._vertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:24,normalized:!1,divisor:0},{name:"a_vertexOffset",
count:2,type:5122,offset:4,stride:24,normalized:!1,divisor:0},{name:"a_tex",count:4,type:5121,offset:8,stride:24,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:24,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:16,stride:24,normalized:!0,divisor:0},{name:"a_size",count:1,type:5126,offset:20,stride:24,normalized:!1,divisor:0}]};a._iconProgramOptions={id:!1,dd:!1,sdf:!1};a._sdfProgramOptions={id:!1,dd:!1};a._spritesTextureSize=k.vec2f32.create();a._haloColor=
f.vec4f32.create();a._sdfColor=f.vec4f32.create();a._color=f.vec4f32.create();return a}l(b,e);b.prototype.dispose=function(){};b.prototype.drawMany=function(a,e){var b=a.drawPhase,d=a.styleLayerId,h=a.styleLayer,n=a.fadeRecorder.getFadeValues(),p;b===m.WGLDrawPhase.HITTEST&&(p=c.u32to4Xu8(d));this._drawIcons(a,h,e,n,p);this._drawText(a,h,e,n,p)};b.prototype._drawIcons=function(a,c,e,b,h){for(var n=this,f=a.context,k=a.displayLevel,l=a.drawPhase,g=a.painter,r=a.state,t=a.styleLayerId,u,x=!1,w=0;w<
e.length;w++){var v=e[w];if(v.layerData[t]&&(u=v.layerData[t],0<u.iconPerPageElementsMap.size)){x=!0;break}}if(x){var v=c.hasDataDrivenIconSize?1:c.getLayoutValue("icon-size",k),K=c.hasDataDrivenIconColor?p:c.getPaintValue("icon-color",k),I=c.hasDataDrivenIconOpacity?1:c.getPaintValue("icon-opacity",k),x=c.getPaintValue("icon-translate",k),w=c.getPaintValue("icon-translate-anchor",k),N=g.getVectorTileProgramCach(),g=K[3]*I;this._color[0]=g*K[0];this._color[1]=g*K[1];this._color[2]=g*K[2];this._color[3]=
g;g=c.getLayoutValue("icon-rotation-alignment",k);2===g&&(g=1===c.getLayoutValue("symbol-placement",k)?0:1);var K=u.isSDF,M=c.hasDataDrivenIcon,l=l===m.WGLDrawPhase.HITTEST,I=this._iconProgramOptions;I.id=l;I.dd=M;I.sdf=K;var L=N.getProgram(4,(l?1:0)<<2|(M?1:0)<<1|(K?1:0),I);f.bindProgram(L);K&&(K=c.getPaintValue("icon-halo-color",k),I=c.getPaintValue("icon-halo-width",k),L.setUniform4f("u_outlineColor",K[0],K[1],K[2],K[3]),L.setUniform1f("u_outlineSize",I));L.setUniformMatrix3fv("u_displayViewMat3",
0===g?r.displayViewMat3:r.displayMat3);L.setUniformMatrix3fv("u_displayMat3",1===w?r.displayMat3:r.displayViewMat3);L.setUniform2fv("u_iconTranslation",x);L.setUniform1f("u_depth",c.z);L.setUniform1f("u_mapRotation",d.degToByte(r.rotation));L.setUniform1f("u_keepUpright",0);L.setUniform1f("u_level",10*k);L.setUniform1f("u_fadeSpeed",10*b.fadeSpeed);L.setUniform1f("u_minfadeLevel",10*b.minfadeLevel);L.setUniform1f("u_maxfadeLevel",10*b.maxfadeLevel);L.setUniform1f("u_fadeChange",10*(k+b.fadeChange));
L.setUniform1i("u_texture",q.VTL_TEXTURE_BINDING_UNIT_SPRITES);L.setUniform1f("u_size",v);L.setUniform4fv("u_color",this._color);l&&L.setUniform4fv("u_id",h);c=function(c){if(!c.layerData[t])return"continue";u=c.layerData[t];if(0===u.iconPerPageElementsMap.size)return"continue";var e=Q._getIconVAO(f,c,M,N);if(!e)return"continue";f.bindVAO(e);L.setUniformMatrix3fv("u_dvsMat3",c.transforms.dvs);u.iconPerPageElementsMap.forEach(function(e,b){n._renderIconRange(a,L,e,b,c)})};var Q=this;for(b=0;b<e.length;b++)v=
e[b],c(v)}};b.prototype._renderIconRange=function(a,c,e,b,d){var h=a.context,n=a.hasClipping,p=a.requiredLevel;a=a.spriteMosaic;this._spritesTextureSize[0]=a.getWidth(b)/4;this._spritesTextureSize[1]=a.getHeight(b)/4;c.setUniform2fv("u_mosaicSize",this._spritesTextureSize);a.bind(h,9729,b,q.VTL_TEXTURE_BINDING_UNIT_SPRITES);c=!0;p!==d.key.level||n?h.setStencilFunction(514,d.stencilRef,255):c=!1;h.setStencilTestEnabled(c);h.drawElements(4,e[1],5125,12*e[0]);d.triangleCount+=e[1]/3};b.prototype._drawText=
function(a,c,e,b,n){for(var f=this,l=a.context,g=a.displayLevel,r=a.drawPhase,t=a.glyphMosaic,u=a.hasClipping,w=a.painter,x=a.pixelRatio,v=a.requiredLevel,G=a.state,J=a.styleLayerId,K,I=!1,N=0;N<e.length;N++)if(a=e[N],a.layerData[J]&&(K=a.layerData[J],0<K.glyphPerPageElementsMap.size)){I=!0;break}if(I){a=c.getLayoutValue("text-rotation-alignment",g);2===a&&(a=1===c.getLayoutValue("symbol-placement",g)?0:1);var I=0===a,I=c.getLayoutValue("text-keep-upright",g)&&I,r=r===m.WGLDrawPhase.HITTEST,x=.8*
3/x,N=c.hasDataDrivenTextSize?1:c.getLayoutValue("text-size",g),M=c.hasDataDrivenTextColor?p:c.getPaintValue("text-color",g),L=c.hasDataDrivenTextOpacity?1:c.getPaintValue("text-opacity",g),Q=c.getPaintValue("text-halo-color",g),O=c.getPaintValue("text-halo-width",g),S=3*c.getPaintValue("text-halo-blur",g),U=3*O,T=w.getVectorTileProgramCach(),w=M[3]*L;this._sdfColor[0]=w*M[0];this._sdfColor[1]=w*M[1];this._sdfColor[2]=w*M[2];this._sdfColor[3]=w;w=Q[3]*L;this._haloColor[0]=w*Q[0];this._haloColor[1]=
w*Q[1];this._haloColor[2]=w*Q[2];this._haloColor[3]=w;this._glyphTextureSize||(this._glyphTextureSize=k.vec2f32.fromValues(t.width/4,t.height/4));var w=c.getPaintValue("text-translate",g),M=c.getPaintValue("text-translate-anchor",g),R=c.hasDataDrivenText,L=this._sdfProgramOptions;L.id=r;L.dd=R;var P=T.getProgram(6,(r?1:0)<<1|(R?1:0),L);l.bindProgram(P);P.setUniformMatrix3fv("u_displayViewMat3",0===a?G.displayViewMat3:G.displayMat3);P.setUniformMatrix3fv("u_displayMat3",1===M?G.displayMat3:G.displayViewMat3);
P.setUniform2fv("u_textTranslation",w);P.setUniform1f("u_depth",c.z+h);P.setUniform2fv("u_mosaicSize",this._glyphTextureSize);P.setUniform1f("u_mapRotation",d.degToByte(G.rotation));P.setUniform1f("u_keepUpright",I?1:0);P.setUniform1f("u_level",10*g);P.setUniform1f("u_fadeSpeed",10*b.fadeSpeed);P.setUniform1f("u_minfadeLevel",10*b.minfadeLevel);P.setUniform1f("u_maxfadeLevel",10*b.maxfadeLevel);P.setUniform1f("u_fadeChange",10*(g+b.fadeChange));P.setUniform1i("u_texture",q.VTL_TEXTURE_BINDING_UNIT_GLYPHS);
P.setUniform1f("u_size",N);P.setUniform1f("u_antialiasingWidth",x);r&&P.setUniform4f("u_id",n[0],n[1],n[2],n[3]);c=function(a){if(!a.layerData[J])return"continue";K=a.layerData[J];if(0===K.glyphPerPageElementsMap.size)return"continue";var c=V._getSDFVAO(l,a,R,T);if(!c)return"continue";l.bindVAO(c);P.setUniformMatrix3fv("u_dvsMat3",a.transforms.dvs);c=!0;v!==a.key.level||u?l.setStencilFunction(514,a.stencilRef,255):c=!1;l.setStencilTestEnabled(c);K.glyphPerPageElementsMap.forEach(function(c,e){f._renderGlyphRange(l,
c,e,t,P,Q[3],O,S,U,a)})};var V=this;for(b=0;b<e.length;b++)a=e[b],c(a)}};b.prototype._renderGlyphRange=function(a,c,e,b,d,h,n,p,m,f){b.bind(a,9729,e,q.VTL_TEXTURE_BINDING_UNIT_GLYPHS);0<h&&0<n&&(d.setUniform4fv("u_color",this._haloColor),d.setUniform1f("u_halo",1),d.setUniform1f("u_edgeDistance",m),d.setUniform1f("u_edgeBlur",p),a.drawElements(4,c[1],5125,12*c[0]),f.triangleCount+=c[1]/3);0<this._sdfColor[3]&&(d.setUniform4fv("u_color",this._sdfColor),d.setUniform1f("u_halo",0),d.setUniform1f("u_edgeDistance",
0),d.setUniform1f("u_edgeBlur",0),a.drawElements(4,c[1],5125,12*c[0]),f.triangleCount+=c[1]/3)};b.prototype._getIconVAO=function(c,e,b,d){if(b){if(e.iconDDVertexArrayObject)return e.iconDDVertexArrayObject;b=e.iconDDVertexBuffer;var h=e.iconIndexBuffer;if(!b||!h)return null;e.iconDDVertexArrayObject=new a.VertexArrayObject(c,d.getProgramAttributes(4),this._vertexAttributesDD,{geometry:b},h);return e.iconDDVertexArrayObject}if(e.iconVertexArrayObject)return e.iconVertexArrayObject;b=e.iconVertexBuffer;
h=e.iconIndexBuffer;if(!b||!h)return null;e.iconVertexArrayObject=new a.VertexArrayObject(c,d.getProgramAttributes(4),this._vertexAttributes,{geometry:b},h);return e.iconVertexArrayObject};b.prototype._getSDFVAO=function(c,e,b,d){if(b){if(e.textDDVertexArrayObject)return e.textDDVertexArrayObject;b=e.textDDVertexBuffer;var h=e.textIndexBuffer;if(!b||!h)return null;e.textDDVertexArrayObject=new a.VertexArrayObject(c,d.getProgramAttributes(6),this._vertexAttributesDD,{geometry:b},h);return e.textDDVertexArrayObject}if(e.textVertexArrayObject)return e.textVertexArrayObject;
b=e.textVertexBuffer;h=e.textIndexBuffer;if(!b||!h)return null;e.textVertexArrayObject=new a.VertexArrayObject(c,d.getProgramAttributes(6),this._vertexAttributes,{geometry:b},h);return e.textVertexArrayObject};return b}(e.default);b.WGLBrushVTLSymbol=g})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrush":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../webgl ../definitions ./WGLBrush".split(" "),function(g,b,l,k,f,a){Object.defineProperty(b,"__esModule",
{value:!0});g=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}l(b,a);b.prototype.prepareState=function(a,c,e){a=a.context;e=e&&-1!==e.indexOf("id");a.setBlendingEnabled(!e);a.setBlendFunctionSeparate(1,771,1,771);a.setColorMask(!0,!0,!0,!0);a.setStencilWriteMask(0);a.setStencilTestEnabled(!0);a.setStencilFunction(514,c.stencilRef,255)};b.prototype.draw=function(a,c,e){var b=this;if(c.isReady&&c.hasData){c.commitChanges();var d=this.getGeometryType(),n=c.getDisplayList(),m=
c.getGeometry(d);m&&n&&(a.timeline.begin(this.name),n.byType(d,function(d){b.drawGeometry(a,c,d,m,e)}),a.timeline.end(this.name))}};b.prototype._getVAO=function(a,c,e,b){b.vao||(b.vao=new k.VertexArrayObject(a,e,c,b.vertexBufferMap,b.indexBuffer));return b.vao};b.prototype._setSharedUniforms=function(a,c,e){a.setUniform1f("u_pixelRatio",c.pixelRatio);a.setUniformMatrix3fv("u_dvsMat3",e.transforms.dvs);a.setUniformMatrix3fv("u_displayViewMat3",c.state.displayViewMat3);a.setUniformMatrix4fv("u_insideEffectMat4",
c.rendererInfo.insideEffect);a.setUniformMatrix4fv("u_outsideEffectMat4",c.rendererInfo.outsideEffect);a.setUniform1fv("u_insideOpacities",c.rendererInfo.insideOpacities);a.setUniform1fv("u_outsideOpacities",c.rendererInfo.outsideOpacities);a.setUniform1i("u_attributeTextureSize",c.attributeView.size);a.setUniform1i("u_attributeData0",f.TEXTURE_BINDING_ATTRIBUTE_DATA_0);a.setUniform1i("u_attributeData1",f.TEXTURE_BINDING_ATTRIBUTE_DATA_1);a.setUniform1i("u_attributeData2",f.TEXTURE_BINDING_ATTRIBUTE_DATA_2);
a.setUniform1i("u_attributeData3",f.TEXTURE_BINDING_ATTRIBUTE_DATA_3)};return b}(a.default);b.default=g})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushFill":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/tsSupport/assignHelper ../../../../../core/RandomLCG ../../../../webgl ../definitions ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),function(g,b,l,k,f,a,q,m,d,c,e){Object.defineProperty(b,"__esModule",{value:!0});
g=function(c){function b(){var a=null!==c&&c.apply(this,arguments)||this;a._dotTextureSize=0;a._dotTextures=null;a._dotSamplers=new Int32Array([q.TEXTURE_BINDING_RENDERER_0,q.TEXTURE_BINDING_RENDERER_1]);return a}l(b,c);b.prototype.dispose=function(){this._disposeTextures()};b.prototype.getGeometryType=function(){return m.WGLGeometryType.FILL};b.prototype.drawGeometry=function(a,c,b,h,p){var n=a.context,m=a.painter,f=a.rendererInfo,k=a.requiredLevel,g=b.indexCount,l=b.indexFrom;b=e.FillMaterialKey.load(b.materialKey);
var t=d.createProgramDescriptor(b.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121}].concat(b.dotDensity?[]:[{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_tlbr",count:4,type:5123},{location:4,name:"a_aux1",count:4,type:5121},{location:5,name:"a_aux2",count:2,type:5123},{location:6,name:"a_aux3",count:4,type:5121}],b.dotDensity?[{location:2,name:"a_inverseArea",count:1,type:5126}]:[])}),u=t.bufferLayouts,t=t.attributes;
p=m.materialManager.getMaterialProgram(a,b,"materials/fill",t,p);h=this._getVAO(n,u,t,h);n.bindProgram(p);n.bindVAO(h);this._setSharedUniforms(p,a,c);b.textureBinding&&(m.textureManager.bindTextures(n,p,b),m=1/Math.pow(2,k-c.key.level)/a.pixelRatio,p.setUniform1f("u_zoomFactor",m));b.vvColor&&(p.setUniform1fv("u_vvColorValues",f.vvColorValues),p.setUniform4fv("u_vvColors",f.vvColors));b.vvOpacity&&(p.setUniform1fv("u_vvOpacityValues",f.vvOpacityValues),p.setUniform1fv("u_vvOpacities",f.vvOpacities));
b.dotDensity&&(b=q.TILE_SIZE/f.ddDotSize,h=b*window.devicePixelRatio*b*window.devicePixelRatio,m=1/Math.pow(2,k-c.key.level),c=1/m*(1/m),a=f.ddDotScale?a.state.scale/f.ddDotScale:1,p.setUniform1f("u_tileZoomFactor",m),p.setUniform1f("u_tileDotsOverArea",h/(q.TILE_SIZE*window.devicePixelRatio*q.TILE_SIZE*window.devicePixelRatio)),p.setUniformMatrix4fv("u_dotColors",f.ddColors),p.setUniform4fv("u_isActive",f.ddActiveDots),p.setUniform4fv("u_dotBackgroundColor",f.ddBackgroundColor),p.setUniform1f("u_dotValue",
Math.max(1,f.ddDotValue*a*c)),this._bindDotDensityTextures(n,p,f,b));n.drawElements(4,g,5125,4*l);n.bindVAO(null)};b.prototype._disposeTextures=function(){if(this._dotTextures){for(var a=0;a<this._dotTextures.length;a++)this._dotTextures[a].dispose();this._dotTextures=null}};b.prototype._bindDotDensityTextures=function(a,c,b,e){b=this._createDotDensityTextures(a,e,b.ddSeed);c.setUniform1iv("u_dotTextures",this._dotSamplers);for(c=0;c<b.length;c++)a.bindTexture(b[c],this._dotSamplers[c])};b.prototype._createDotDensityTextures=
function(a,c,b){if(this._dotTextureSize!==c||this._seed!==b)this._disposeTextures(),this._dotTextureSize=c,this._seed=b;null===this._dotTextures&&(b=new f(b),this._dotTextures=[this._allocDotDensityTexture(a,c,b),this._allocDotDensityTexture(a,c,b)]);return this._dotTextures};b.prototype._allocDotDensityTexture=function(c,b,e){for(var d=new Float32Array(b*b*4),h=0;h<d.length;h++)d[h]=e.getFloat();return new a.Texture(c,{wrapMode:10497,pixelFormat:6408,dataType:5126,samplingMode:9728,width:b,height:b},
d)};return b}(c.default);b.default=g})},"esri/views/2d/engine/webgl/materialKey/MaterialKey":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/tsSupport/assignHelper ../../../../../renderers ../../../../../core/Error ../../../../../core/maybe ../enums ../mesh/templates/WGLLabelTemplate ../util/vvFlagUtils".split(" "),function(g,b,l,k,f,a,q,m,d,c){Object.defineProperty(b,"__esModule",{value:!0});b.createMaterialKey=function(a,c,b,e){if(q.isSome(c)){a:{if("heatmap"===
c.type)throw Error("Symbol processor does not support heatmap renderer");switch(a){case m.WGLGeometryType.FILL:a=n.from(c);break a;case m.WGLGeometryType.LINE:a=x.from(c,b);break a;case m.WGLGeometryType.MARKER:if("dot-density"===c.type)throw Error("Dot Density renderer does not support Marker GeometryTypes");a=u.from(c);break a;case m.WGLGeometryType.TEXT:a=v.from(c);break a;case m.WGLGeometryType.LABEL:a=t.from(c,e);break a;default:throw Error("Unable to createMaterialKey for unknown geometryType "+
a);}}return a}switch(a){case m.WGLGeometryType.FILL:return n.from(null);case m.WGLGeometryType.LINE:return x.from(null,b);case m.WGLGeometryType.MARKER:return u.from(null);case m.WGLGeometryType.TEXT:return v.from(null);case m.WGLGeometryType.LABEL:return t.from(null,e);default:throw Error("Unable to createMaterialKey for unknown geometryType "+a);}};g=function(){function c(a){this._data=0;this._data=a}c.load=function(a){var c=this.shared;c.data=a;return c};Object.defineProperty(c.prototype,"data",
{get:function(){return this._data},set:function(a){this._data=a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"geometryType",{get:function(){return this.bits(8,11)},set:function(a){this.setBits(a,8,11)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"mapAligned",{get:function(){return!!this.bit(20)},set:function(a){this.setBit(20,a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"sdf",{get:function(){return!!this.bit(11)},set:function(a){this.setBit(11,
a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"pattern",{get:function(){return!!this.bit(12)},set:function(a){this.setBit(12,a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"textureBinding",{get:function(){return this.bits(0,8)},set:function(a){this.setBits(a,0,8)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"geometryTypeString",{get:function(){switch(this.geometryType){case m.WGLGeometryType.FILL:return"fill";case m.WGLGeometryType.MARKER:return"marker";
case m.WGLGeometryType.LINE:return"line";case m.WGLGeometryType.TEXT:return"text";case m.WGLGeometryType.LABEL:return"label";default:throw new a("Unable to handle unknown geometryType: "+this.geometryType);}},enumerable:!0,configurable:!0});c.prototype.setBit=function(a,c){a=1<<a;this._data=c?this._data|a:this._data&~a};c.prototype.bit=function(a){return(this._data&1<<a)>>a};c.prototype.setBits=function(a,c,b){for(var e=0;c<b;c++,e++)this.setBit(c,0!==(a&1<<e))};c.prototype.bits=function(a,c){for(var b=
0,e=0;a<c;a++,e++)b|=this.bit(a)<<e;return b};c.prototype.hasVV=function(){return!1};c.prototype.setVV=function(a,c){};c.prototype.getVariation=function(){var a={},c;for(c in this)"boolean"===typeof this[c]&&(a[c]=this[c]);return a};c.prototype.getVariationHash=function(){return this._data&~(7&this.textureBinding)};c.shared=new c(0);return c}();b.MaterialKeyBase=g;k=function(a){return function(a){function b(){return null!==a&&a.apply(this,arguments)||this}l(b,a);Object.defineProperty(b.prototype,
"vvSizeMinMaxValue",{get:function(){return 0!==this.bit(16)},set:function(a){this.setBit(16,a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"vvSizeScaleStops",{get:function(){return 0!==this.bit(17)},set:function(a){this.setBit(17,a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"vvSizeFieldStops",{get:function(){return 0!==this.bit(18)},set:function(a){this.setBit(18,a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"vvSizeUnitValue",
{get:function(){return 0!==this.bit(19)},set:function(a){this.setBit(19,a)},enumerable:!0,configurable:!0});b.prototype.hasVV=function(){return a.prototype.hasVV.call(this)||this.vvSizeMinMaxValue||this.vvSizeScaleStops||this.vvSizeFieldStops||this.vvSizeUnitValue};b.prototype.setVV=function(b,e){a.prototype.setVV.call(this,b,e);b&=c.getSizeFlagsMask(b,e);this.vvSizeMinMaxValue=!!(b&m.WGLVVFlag.SIZE_MINMAX_VALUE);this.vvSizeFieldStops=!!(b&m.WGLVVFlag.SIZE_FIELD_STOPS);this.vvSizeUnitValue=!!(b&m.WGLVVFlag.SIZE_UNIT_VALUE);
this.vvSizeScaleStops=!!(b&m.WGLVVFlag.SIZE_SCALE_STOPS)};return b}(a)};var e=function(a){return function(a){function c(){return null!==a&&a.apply(this,arguments)||this}l(c,a);Object.defineProperty(c.prototype,"vvRotation",{get:function(){return 0!==this.bit(15)},set:function(a){this.setBit(15,a)},enumerable:!0,configurable:!0});c.prototype.hasVV=function(){return a.prototype.hasVV.call(this)||this.vvRotation};c.prototype.setVV=function(c,b){a.prototype.setVV.call(this,c,b);this.vvRotation=!b&&!!(c&
m.WGLVVFlag.ROTATION)};return c}(a)},h=function(a){return function(a){function c(){return null!==a&&a.apply(this,arguments)||this}l(c,a);Object.defineProperty(c.prototype,"vvColor",{get:function(){return 0!==this.bit(13)},set:function(a){this.setBit(13,a)},enumerable:!0,configurable:!0});c.prototype.hasVV=function(){return a.prototype.hasVV.call(this)||this.vvColor};c.prototype.setVV=function(c,b){a.prototype.setVV.call(this,c,b);this.vvColor=!b&&!!(c&m.WGLVVFlag.COLOR)};return c}(a)},p=function(a){return function(a){function c(){return null!==
a&&a.apply(this,arguments)||this}l(c,a);Object.defineProperty(c.prototype,"vvOpacity",{get:function(){return 0!==this.bit(14)},set:function(a){this.setBit(14,a)},enumerable:!0,configurable:!0});c.prototype.hasVV=function(){return a.prototype.hasVV.call(this)||this.vvOpacity};c.prototype.setVV=function(c,b){a.prototype.setVV.call(this,c,b);this.vvOpacity=!b&&!!(c&m.WGLVVFlag.OPACITY)};return c}(a)},n=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}l(b,a);b.load=function(a){var c=
this.shared;c.data=a;return c};b.from=function(a){var b=this.load(0);b.geometryType=m.WGLGeometryType.FILL;q.isSome(a)&&(a instanceof f.DotDensityRenderer?b.dotDensity=!0:(a=c.getVVFlags(a.visualVariables),b.setVV(a,!1)));return b.data};b.prototype.getVariation=function(){return a.prototype.getVariation.call(this)};Object.defineProperty(b.prototype,"dotDensity",{get:function(){return!!this.bit(15)},set:function(a){this.setBit(15,a)},enumerable:!0,configurable:!0});b.shared=new b(0);return b}(h(p(g)));
b.FillMaterialKey=n;var u=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}l(b,a);b.load=function(a){var c=this.shared;c.data=a;return c};b.from=function(a){var b=this.load(0);b.geometryType=m.WGLGeometryType.MARKER;q.isSome(a)&&(a=c.getVVFlags(a.visualVariables),b.setVV(a,!1));return b.data};b.prototype.getVariation=function(){return a.prototype.getVariation.call(this)};b.shared=new b(0);return b}(h(p(e(k(g)))));b.MarkerMaterialKey=u;var x=function(a){function b(){return null!==
a&&a.apply(this,arguments)||this}l(b,a);b.load=function(a){var c=this.shared;c.data=a;return c};b.from=function(a,b){var e=this.load(0);e.geometryType=m.WGLGeometryType.LINE;q.isSome(a)&&(a=c.getVVFlags(a.visualVariables),e.setVV(a,b));return e.data};b.prototype.getVariation=function(){return a.prototype.getVariation.call(this)};b.shared=new b(0);return b}(h(p(k(g))));b.LineMaterialKey=x;var v=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}l(b,a);b.load=function(a){var c=
this.shared;c.data=a;return c};b.from=function(a){var b=this.load(0);b.geometryType=m.WGLGeometryType.TEXT;q.isSome(a)&&(a=c.getVVFlags(a.visualVariables),b.setVV(a,!1));return b.data};b.prototype.getVariation=function(){return a.prototype.getVariation.call(this)};b.shared=new b(0);return b}(h(p(e(k(g)))));b.TextMaterialKey=v;var t=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}l(b,a);b.load=function(a){var c=this.shared;c.data=a;return c};b.from=function(a,b){var e=this.load(0);
e.geometryType=m.WGLGeometryType.LABEL;q.isSome(a)&&(a=c.getVVFlags(a.visualVariables),e.setVV(a,!1));e.mapAligned=!!d.isMapAligned(b.labelPlacement);return e.data};b.prototype.getVariation=function(){return a.prototype.getVariation.call(this)};b.shared=new b(0);return b}(k(g));b.LabelMaterialKey=t})},"esri/views/2d/engine/webgl/mesh/templates/WGLLabelTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/mathUtils ../../../../../../core/mathUtils ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../engine ../../color ../../definitions ../../enums ../../number ../../WGLDisplayRecord ../../collisions/Metric ../../materialKey/MaterialKey ./segmentUtils ./WGLTextTemplate".split(" "),
function(g,b,l,k,f,a,q,m,d,c,e,h,p,n,u,x,v,t,w){Object.defineProperty(b,"__esModule",{value:!0});var r=f.getLogger("esri.views.2d.engine.webgl.WGLLabelTemplate");b.isMapAligned=function(a){switch(a){case "above-along":case "below-along":case "center-along":return 1;default:return 0}};var y=function(a){var c=new Map;return function(b){c.has(b)||c.set(b,a(b));return c.get(b)}}(function(a){var c=0;if(0===a)return Infinity;for(;!(a%2);)c++,a/=2;return c}),A=function(a,c){return n.i1616to32(2*Math.round(8*
a),2*Math.round(8*c))};g=function(b){function f(n,f,m,k){var q=b.call(this,n,m.font.size,m.haloSize||0,m.color&&e.premultiplyAlphaRGBA(m.color)||0,m.haloColor&&e.premultiplyAlphaRGBA(m.haloColor)||0,m.horizontalAlignment,m.verticalAlignment,m.font.decoration,!1,m.angle||0,m.xoffset,m.yoffset,m.id,m.lineWidth,m.lineHeight)||this;q._outLineLabelAngle=0;q._refPlacementPadding=0;q._refPlacementDirX=0;q._refPlacementDirY=0;q._refOffsetX=0;q._refOffsetY=0;q.geometryType=p.WGLGeometryType.LABEL;var g;g=
!!f.minScale&&k.scaleToZoom(f.minScale)||0;g=a.clamp(g,0,25.5);k=!!f.maxScale&&k.scaleToZoom(f.maxScale)||255;k=a.clamp(k,0,25.5);var l=c.alignmentUtils.getAlignmentFromPlacement(f.labelPlacement),t=l[1];q._xAlignD=l[0];q._yAlignD=t;q._minZoom=g;q._maxZoom=k;q._refPlacementPadding=d.pt2px(m.haloSize)+h.TEXT_PLACEMENT_PADDING;n=v.LabelMaterialKey.load(v.createMaterialKey(q.geometryType,n,!1,f));n.sdf=!0;q._materialKey=n.data;return q}l(f,b);f.fromLabelClass=function(a,c,b){if("center-along"===c.labelPlacement){var e=
c.symbol;e.xoffset=0;e.yoffset=0;e.angle=0;e.font.decoration="none"}return new f(a,c,c.symbol,b)};Object.defineProperty(f.prototype,"_shapedBox",{get:function(){return m.unwrap(this._shapingInfo).bounds},enumerable:!0,configurable:!0});f.prototype.bindReferenceTemplate=function(a){var b=c.alignmentUtils.getXDirection(this._xAlignD),e=c.alignmentUtils.getYDirection(this._yAlignD);this._refOffsetY=this._refOffsetX=0;if(m.isNone(a))this._refSymbolAndPlacementOffset=n.i8888to32(0,0,Math.floor(127*b+127),
Math.floor(127*e+127));else{if("circle"===a.boundsType&&(b||e))var d=Math.sqrt(b*b+e*e),b=b/d,e=e/d;d=Math.max(a.height,a.width);this._refSymbolAndPlacementOffset=n.i8888to32(4*this._refPlacementPadding,d,Math.floor(127*b+127),Math.floor(127*e+127));this._referenceSize=d;this._refPlacementDirX=b;this._refPlacementDirY=e;this._refOffsetX=a.xOffset;this._refOffsetY=a.yOffset}};f.prototype.writeMesh=function(a,c,b,e,d,h,n){if(!m.isNone(this._shapingInfo))switch(this.current={outRecords:a,outVecs:c,outMetrics:n,
inId:e,inShaping:this._shapingInfo,zoomLevel:h},b){case "esriGeometryPolyline":return this._placeLineLabels(d.geometry);case "esriGeometryPoint":return this._placePointLabels(d.geometry);case "esriGeometryPolygon":return this._placePointLabels(d.centroid);default:a="Geometry of type "+b+" is not supported",void 0===a&&(a="mapview-labeling"),r.error(new k(a,"mapview-labeling"))}};f.prototype._isVisible=function(a,c){var b=Math.floor(10*this.current.zoomLevel);return Math.floor(10*a)<=b&&b<=Math.floor(10*
c)};f.prototype._placePointLabels=function(a){var c=this.current;this._writeGlyphs(c.outRecords,c.outVecs,c.inId,a,c.outMetrics)};f.prototype._placeLineLabels=function(a){a=t.smoothPaths(a.paths,this.current.inShaping.bounds.width);for(var c=this._placeSubdivGlyphs.bind(this),b=(this._shapedBox.width+128)/4,e=0;e<a.length;e++)t.pathDivide(a[e],b,c)};f.prototype._placeSubdivGlyphs=function(a,c,b,e){var d=y(c);b=q.log2(Math.min(b,e-b)/(4+this._shapedBox.width/4/2));d=Math.max(this._minZoom,this.current.zoomLevel+
2-(0===c?b:Math.min(d,b)));b=this._shapedBox.width/2*Math.pow(2,this.current.zoomLevel-d);this.current.inShaping.isMultiline?0===c&&this._placeStraight(a,d):this._placeCurved(a,d,b)};f.prototype._placeStraight=function(a,c){var b=this.current;this._writeGlyphs(b.outRecords,b.outVecs,b.inId,a,b.outMetrics,c)};f.prototype._placeCurved=function(a,c,b){var e=new x.default(this.current.inId,{from:this.current.outRecords.length,count:-1},a.x,a.y,c),d=a.clone(),h=(180/Math.PI*a.angle+180)%360;this._outLineLabelAngle=
Math.round(180/Math.PI*a.angle%360*(254/360));this._placeFirst(d,e,c,1);this._placeBack(a,d,e,c,b,1);this._placeForward(a,d,e,c,b,1);this._outLineLabelAngle=Math.round(254/360*h);this._placeFirst(d,e,c,0);this._placeBack(a,d,e,c,b,0);this._placeForward(a,d,e,c,b,0);e.range.count=this.current.outRecords.length-e.range.from;e.bounds&&this.current.outMetrics.push(e)};f.prototype._placeBack=function(a,c,b,e,d,h){var n=a.clone();for(a=a.backwardLength+0;n.prev()&&!(a>=d);)this._placeOnSegment(n,c,b,a,
e,-1,h),a+=n.length+0};f.prototype._placeForward=function(a,c,b,e,d,h){var n=a.clone();for(a=a.remainingLength+0;n.next()&&!(a>=d);)this._placeOnSegment(n,c,b,a,e,1,h),a+=n.length+0};f.prototype._placeFirst=function(a,c,b,e){for(var d=this.current.inShaping,h=d.glyphs,n=this.current.zoomLevel,p=this.current,f=p.outRecords,m=p.outVecs,p=p.inId,k=A(a.x,a.y),g=0;g<h.length;g++){var l=h[g],t=l.x>d.bounds.x?e:1-e,t=Math.max(0,n+q.log2(Math.abs(l.x+l.width/2-d.bounds.x)/(t*a.remainingLength+(1-t)*a.backwardLength+
0))),t=Math.max(b,t);l.maxZoom=25;l.angle=a.angle+(1-e)*Math.PI;l.minZoom=t;this._writeGlyph(f,m,l,p,k);e&&this._isVisible(l.minZoom,l.maxZoom)&&c.add(l.bounds,0,0)}};f.prototype._placeOnSegment=function(a,c,b,e,d,h,n){for(var p=this.current.inShaping.glyphs,f=this.current,m=f.outRecords,k=f.outVecs,f=f.inId,g=this.current.inShaping,l=this.current.zoomLevel,t=A(a.x+a.dx/a.length*-h*e,a.y+a.dy/a.length*-h*e),r=0;r<p.length;r++){var u=p[r],x=u.x>g.bounds.x?n:1-n;if(x&&1===h||!x&&-1===h){var w=Math.abs(u.x+
u.width/2-g.bounds.x),x=Math.max(0,l+q.log2(w/e)-.1),w=Math.max(d,l+q.log2(w/(e+a.length+0)));0!==x&&(u.angle=a.angle+(1-n)*Math.PI,u.minZoom=w,u.maxZoom=x,this._writeGlyph(m,k,u,f,t),n&&this._isVisible(u.minZoom,u.maxZoom)&&b.add(u.bounds,a.x-c.x,a.y-c.y))}}};f.prototype._writeGlyphs=function(a,c,b,e,d,h){void 0===h&&(h=this._minZoom);var n=this._shapingInfo;if(!(m.isNone(n)||0>e.x||512<=e.x||0>e.y||512<=e.y)){var p=A(e.x+this._refOffsetX,e.y-this._refOffsetY);e=new x.default(b,{from:a.length,count:-1},
e.x+this._refOffsetX,e.y-this._refOffsetY,h);for(var f=0,k=n.glyphs;f<k.length;f++){var q=k[f];q.minZoom=h;q.maxZoom=this._maxZoom;this._writeGlyph(a,c,q,b,p)}e.range.count=a.length-e.range.from;e.bounds=n.boundsT;a=v.LabelMaterialKey.load(this._materialKey);e.setPlacementOffset(a.vvSizeFieldStops||a.vvSizeMinMaxValue||a.vvSizeScaleStops||a.vvSizeUnitValue,this._referenceSize,this._refPlacementPadding,this._refPlacementDirX,this._refPlacementDirY);d.push(e)}};f.prototype._writeGlyph=function(a,c,
b,e,d){var h=v.MaterialKeyBase.load(this._materialKey),n=new u(e,this.geometryType,h.data,0,0);h.textureBinding=b.textureBinding;n.materialKey=h.data;n.indexFrom=c.indexVector.length;n.indexCount=this._writeIndices(c);n.vertexFrom=c.getVector("geometry").vertexCount;n.vertexCount=this._writeVertex(c,e,d,b);a.push(n)};f.prototype._writeVertexCommon=function(a,c,b,e){var d=this._color,h=this._haloColor,p=n.i8888to32(0,0,this._size,this._haloSize);e=n.i8888to32(Math.floor(10*Math.max(e.minZoom,this._minZoom)),
Math.floor(10*Math.min(e.maxZoom,this._maxZoom)),this._outLineLabelAngle,0);a.push(b);a.push(c);a.push(d);a.push(h);a.push(p);a.push(this._refSymbolAndPlacementOffset);a.push(e)};return f}(w.default);b.default=g})},"esri/views/2d/engine/webgl/WGLDisplayRecord":function(){define(["require","exports","./MeshData","./Utils"],function(g,b,l,k){return function(){function b(a,b,m,d,c){void 0===d&&(d=0);void 0===c&&(c=0);this.id=a;this.geometryType=b;this.materialKey=m;this.minZoom=d;this.maxZoom=c;this.meshData=
null;this.indexCount=this.indexFrom=this.vertexCount=this.vertexFrom=this.zOrder=this.symbolLevel=0}Object.defineProperty(b.prototype,"sortKey",{get:function(){void 0===this._sortKey&&this._computeSortKey();return this._sortKey},enumerable:!0,configurable:!0});b.prototype.clone=function(){return this.copy()};b.prototype.copy=function(){var a=new b(this.id,this.geometryType,this.materialKey);a.vertexFrom=this.vertexFrom;a.vertexCount=this.vertexCount;a.indexFrom=this.indexFrom;a.indexCount=this.indexCount;
a.zOrder=this.zOrder;a.symbolLevel=this.symbolLevel;a.meshData=this.meshData;a.minZoom=this.minZoom;a.maxZoom=this.maxZoom;return a};b.prototype.setMeshDataFromBuffers=function(a,b,m){var d=new l,c;for(c in b){for(var e=b[c].stride,h=b[c].data,p=[],n=k.strideToPackingFactor(e),f=0;f<e*a.vertexCount/n;++f)p[f]=h[f+e*a.vertexFrom/n];d.vertexData.set(c,p)}for(f=d.indexData.length=0;f<a.indexCount;++f)d.indexData[f]=m[f+a.indexFrom]-a.vertexFrom;d.vertexCount=a.vertexCount;this.meshData=d};b.prototype.readMeshDataFromBuffers=
function(a,b){this.meshData?this.meshData.clear():this.meshData=new l;for(var f in a){for(var d=a[f].stride,c=a[f].data,e=[],h=k.strideToPackingFactor(d),p=0;p<d*this.vertexCount/h;++p)e[p]=c[p+d*this.vertexFrom/h];this.meshData.vertexData.set(f,e)}for(p=this.meshData.indexData.length=0;p<this.indexCount;++p)this.meshData.indexData[p]=b[p+this.indexFrom]-this.vertexFrom;this.meshData.vertexCount=this.vertexCount};b.prototype.writeMeshDataToBuffers=function(a,b,f,d){for(var c in b)for(var e=b[c].stride,
h=this.meshData.vertexData.get(c),p=b[c].data,n=k.strideToPackingFactor(e),m=0;m<e*this.meshData.vertexCount/n;++m)p[m+e*a/n]=h[m];for(m=0;m<this.meshData.indexData.length;++m)d[m+f]=this.meshData.indexData[m]+a;this.vertexFrom=a;this.vertexCount=this.meshData.vertexCount;this.indexFrom=f;this.indexCount=this.meshData.indexData.length};b.writeAllMeshDataToBuffers=function(a,b,f){for(var d=0,c=0,e=0;e<a.length;e++){var h=a[e];h.writeMeshDataToBuffers(d,b,c,f);d+=h.vertexCount;c+=h.indexCount}};b.prototype._computeSortKey=
function(){this._sortKey=(this.symbolLevel&31)<<12|(this.zOrder&127)<<4|this.geometryType&7};b.prototype.serialize=function(a){a.push(this.geometryType);a.push(this.materialKey);a.push(this.symbolLevel);a.push(this.zOrder);a.push(this.vertexFrom);a.push(this.vertexCount);a.push(this.indexFrom);a.push(this.indexCount);a.push(this.minZoom);a.push(this.maxZoom);return a};b.deserialize=function(a,f){var m=a.readInt32(),d=a.readInt32();f=new b(f.id,m,d);f.symbolLevel=a.readInt32();f.zOrder=a.readInt32();
f.vertexFrom=a.readInt32();f.vertexCount=a.readInt32();f.indexFrom=a.readInt32();f.indexCount=a.readInt32();f.minZoom=a.readInt32();f.maxZoom=a.readInt32();return f};return b}()})},"esri/views/2d/engine/webgl/MeshData":function(){define(["require","exports"],function(g,b){return function(){function b(){this.vertexData=new Map;this.vertexCount=0;this.indexData=[]}b.prototype.clear=function(){this.vertexData.clear();this.vertexCount=0;this.indexData=[]};b.prototype.update=function(b,f,a){for(var k in b)this.vertexData.set(k,
b[k]);for(k in this.vertexData)null===b[k]&&this.vertexData.delete(k);this.vertexCount=f;this.indexData=a};return b}()})},"esri/views/2d/engine/webgl/collisions/Metric":function(){define("require exports ../../../../../core/Logger ../../../../../core/libs/gl-matrix-2/vec2f32 ../definitions ./BoundingBox ../util/serializationUtils".split(" "),function(g,b,l,k,f,a,q){Object.defineProperty(b,"__esModule",{value:!0});var m=l.getLogger("esri/views/2d/engine/webgl/collisions/Metric");g=function(){function b(a,
b,d,p,n){this.id=a;this.range=b;this.boxes=null;this.minZoom=-1;this.placementPadding=this.offsetY=this.offsetX=this.directionY=this.directionX=this.size=0;this.anchor=k.vec2f32.fromValues(d,p);this.baseZoom=n}b.prototype.add=function(a,b,d){a.x+=b;a.y+=d;this.bounds?(this.boxes?this.boxes.push(a):(this.boxes=[this.bounds,a],this.bounds=this.bounds.clone()),this.bounds.extend(a)):this.bounds=a};b.prototype.computeIndex=function(){var a=Math.floor(this.anchor[1]/f.COLLISION_BUCKET_SIZE);this.xBucket=
Math.floor(this.anchor[0]/f.COLLISION_BUCKET_SIZE);this.yBucket=a;a=f.TILE_SIZE/f.COLLISION_BUCKET_SIZE;this.hasVV?this.yOverflow=this.xOverflow=a:(this.xOverflow=Math.min(a,Math.ceil(2*this.bounds.width/f.COLLISION_BUCKET_SIZE)),this.yOverflow=Math.min(a,Math.ceil(2*this.bounds.height/f.COLLISION_BUCKET_SIZE)))};b.prototype.findCollisionDelta=function(a){var c=this.bounds.findCollisionDelta(a.bounds),b=this.boxes&&this.boxes.length,d=a.boxes&&a.boxes.length;return Math.abs(c)>f.COLLISION_MAX_ZOOM_DELTA||
!b&&!d?c:b&&d?this._boxesToBoxes(a):b?this._boxesToBox(a):this._boxToBoxes(a)};b.prototype.computeVVOffset=function(a,b){b||m.error("mapview-labeling","Unable to compute label offset. Expected an evaluator function but found "+b);var c=this.size;this.hasVV&&(a=b(a),c=isNaN(a)||null==a||Infinity===a?this.size:a);this._computeOffset(c)};b.prototype.setPlacementOffset=function(a,b,d,p,n){this.hasVV=a;this.size=b;this.placementPadding=Math.round(d);this.directionX=p;this.directionY=n};b.prototype.clone=
function(){var a=new b(this.id,this.range,this.anchor[0],this.anchor[1],this.baseZoom);a.minZoom=this.minZoom;this.bounds&&(a.bounds=this.bounds.clone());this.boxes&&(a.boxes=this.boxes.map(function(a){return a.clone()}));a.xBucket=this.xBucket;a.yBucket=this.yBucket;a.xOverflow=this.xOverflow;a.yOverflow=this.yOverflow;a.hasVV=this.hasVV;a.size=this.size;a.directionX=this.directionX;a.directionY=this.directionY;a.offsetX=this.offsetX;a.offsetY=this.offsetY;return a};b.prototype._boxToBoxes=function(a){var c=
-Infinity,b=0;for(a=a.boxes;b<a.length;b++)var d=this.bounds.findCollisionDelta(a[b]),c=Math.max(d,c);return c};b.prototype._boxesToBox=function(a){for(var c=this.boxes[0].findCollisionDelta(a.bounds),b=1;b<this.boxes.length;b++)var d=this.boxes[b].findCollisionDelta(a.bounds),c=Math.max(d,c);return c};b.prototype._boxesToBoxes=function(a){for(var c=-Infinity,b=0;b<this.boxes.length;b++)for(var d=this.boxes[b],n=0,f=a.boxes;n<f.length;n++)var m=d.findCollisionDelta(f[n]),c=Math.max(m,c);return c};
b.prototype._computeOffset=function(a){this.offsetX=this.directionX*(a/2+this.placementPadding);this.offsetY=this.directionY*(a/2+this.placementPadding)};b.prototype.serialize=function(a){a.push(this.id);this.bounds.serialize(a);a.push(this.range.from);a.push(this.range.count);a.push(this.anchor[0]);a.push(this.anchor[1]);a.push(this.baseZoom);a.push(this.hasVV?1:0);a.push(this.size);a.writeF32(this.directionX);a.writeF32(this.directionY);a.push(this.offsetX);a.push(this.offsetY);a.push(this.placementPadding);
q.serializeList(a,this.boxes);return a};b.deserialize=function(c){var e=c.readInt32(),d=a.default.deserialize(c),p=c.readInt32(),n=c.readInt32(),f={from:p,count:n},m=c.readInt32(),k=c.readInt32(),g=c.readInt32(),p=c.readInt32(),n=c.readInt32(),l=c.readF32(),r=c.readF32(),y=c.readInt32(),A=c.readInt32(),z=c.readInt32();c=q.deserializeList(c,a.default);e=new b(e,f,m,k,g);e.bounds=d;e.boxes=c;e.setPlacementOffset(!!p,n,z,l,r);e.offsetX=y;e.offsetY=A;e.computeIndex();p||e._computeOffset(n);return e};
return b}();b.default=g})},"esri/views/2d/engine/webgl/collisions/BoundingBox":function(){define(["require","exports","../../../../../core/mathUtils","../../../../../core/libs/gl-matrix-2/vec2f32"],function(g,b,l,k){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(a,b,f,d){this.center=k.vec2f32.fromValues(a,b);this.centerT=k.vec2f32.create();this.halfWidth=f/2;this.halfHeight=d/2;this.width=f;this.height=d}Object.defineProperty(b.prototype,"x",{get:function(){return this.center[0]},
set:function(a){this.center[0]=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"y",{get:function(){return this.center[1]},set:function(a){this.center[1]=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"blX",{get:function(){return this.center[0]+this.halfWidth},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"blY",{get:function(){return this.center[1]+this.halfHeight},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"trX",
{get:function(){return this.center[0]-this.halfWidth},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"trY",{get:function(){return this.center[1]-this.halfHeight},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"xmin",{get:function(){return this.x-this.halfWidth},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"xmax",{get:function(){return this.x+this.halfWidth},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"ymin",{get:function(){return this.y-
this.halfHeight},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"ymax",{get:function(){return this.y+this.halfHeight},enumerable:!0,configurable:!0});b.prototype.clone=function(){return new b(this.x,this.y,this.width,this.height)};b.prototype.serialize=function(a){a.writeF32(this.center[0]);a.writeF32(this.center[1]);a.push(this.width);a.push(this.height);return a};b.prototype.findCollisionDelta=function(a,b){void 0===b&&(b=4);return l.log2(Math.min((a.halfWidth+this.halfWidth+
b)/Math.abs(a.centerT[0]-this.centerT[0]),(a.halfHeight+this.halfHeight+b)/Math.abs(a.centerT[1]-this.centerT[1])))};b.prototype.extend=function(a){var b=Math.min(this.xmin,a.xmin),f=Math.min(this.ymin,a.ymin),d=Math.max(this.xmax,a.xmax)-b;a=Math.max(this.ymax,a.ymax)-f;this.width=d;this.height=a;this.halfWidth=d/2;this.halfHeight=a/2;this.x=b+d/2;this.y=f+a/2};b.deserialize=function(a){var f=a.readF32(),m=a.readF32(),d=a.readInt32();a=a.readInt32();return new b(f,m,d,a)};return b}();b.default=g})},
"esri/views/2d/engine/webgl/util/serializationUtils":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});b.serializeList=function(b,k){if(null===k)b.push(0);else{b.push(k.length);for(var f=0;f<k.length;f++)k[f].serialize(b);return b}};b.deserializeList=function(b,k,f){for(var a=b.readInt32(),a=Array(a),g=0;g<a.length;g++)a[g]=k.deserialize(b,f);return a}})},"esri/views/2d/engine/webgl/mesh/templates/segmentUtils":function(){define(["require","exports",
"../../../../../../core/maybe","./util"],function(g,b,l,k){function f(a){return a.length-1}function a(a){for(var c=0,b=0;b<f(a);b++)c+=q(a,b);return c}function q(a,b,d){void 0===d&&(d=1);b=a[b+1];a=b[0];b=b[1];return Math.sqrt(a*a+b*b)*d}function m(a,b,d,p,n){if(!(d<b)){var c=p.clone().seek(d/2);l.isNone(c)||(a(c.clone(),d,n),d=(d-b)/2,c=l.expect(c.seek(b/2)),m(a,b,d,p,n+1),m(a,b,d,c,n+1))}}Object.defineProperty(b,"__esModule",{value:!0});b.segmentAt=function(a,b){return a[b+1]};b.segmentCount=f;
b.pathLength=a;b.segmentLength=q;var d=function(){function a(a,c,b,d,f){this._segments=a;this._index=c;this._distance=b;this._xStart=d;this._yStart=f;this._done=!1}a.create=function(c){return new a(c,0,0,c[0][0],c[0][1])};a.prototype.clone=function(){return new a(this._segments,this._index,this._distance,this.xStart,this.yStart)};a.prototype.equals=function(a){return this._index===a._index||a._index===this._index-1&&(0===this._distance||1===a._distance)||a._index===this._index+1&&(1===this._distance||
0===a._distance)};a.prototype.leq=function(a){return this._index<a._index||this._index===a._index&&this._distance<=a._distance};a.prototype.geq=function(a){return this._index>a._index||this._index===a._index&&this._distance>=a._distance};Object.defineProperty(a.prototype,"_segment",{get:function(){return this._segments[this._index+1]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"angle",{get:function(){var a=this.dy,c=Math.acos((0*a+-1*-this.dx)/(1*this.length));0<a&&(c=2*Math.PI-
c);return c},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"xStart",{get:function(){return this._xStart},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"yStart",{get:function(){return this._yStart},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"x",{get:function(){return this.xStart+this.distance*this.dx},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"y",{get:function(){return this.yStart+this.distance*this.dy},enumerable:!0,
configurable:!0});Object.defineProperty(a.prototype,"dx",{get:function(){return this._segment[0]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"dy",{get:function(){return this._segment[1]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"xMidpoint",{get:function(){return this.xStart+.5*this.dx},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"yMidpoint",{get:function(){return this.yStart+.5*this.dy},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"xEnd",{get:function(){return this.xStart+this.dx},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"yEnd",{get:function(){return this.yStart+this.dy},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"length",{get:function(){var a=this.dx,c=this.dy;return Math.sqrt(a*a+c*c)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"remainingLength",{get:function(){return this.length*(1-this._distance)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"backwardLength",{get:function(){return this.length*this._distance},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"done",{get:function(){return this._done},enumerable:!0,configurable:!0});a.prototype.hasPrev=function(){return 0<=this._index-1};a.prototype.hasNext=function(){return this._index+1<f(this._segments)};a.prototype.next=function(){if(!this.hasNext())return null;
this._xStart+=this.dx;this._yStart+=this.dy;this._distance=0;this._index+=1;return this};a.prototype.prev=function(){if(!this.hasPrev())return this._done=!0,null;--this._index;this._xStart-=this.dx;this._yStart-=this.dy;this._distance=1;return this};a.prototype._seekBackwards=function(a,c){var b=this.backwardLength;if(a<=b)return this._distance=(b-a)/this.length,this;for(b=this.backwardLength;this.prev();){if(b+this.length>a)return this._seekBackwards(a-b);b+=this.length}this._distance=0;return c?
this:null};a.prototype.seek=function(a,c){void 0===c&&(c=!1);if(0>a)return this._seekBackwards(Math.abs(a),c);if(a<=this.remainingLength)return this._distance=(this.backwardLength+a)/this.length,this;for(var b=this.remainingLength;this.next();){if(b+this.length>a)return this.seek(a-b,c);b+=this.length}this._distance=1;return c?this:null};return a}();b.SegmentCursor=d;b.pathDivide=function(c,b,h){var e=a(c);c=d.create(c);var n=e/2,f=Math.floor((e-b)/2/b);c.seek(n-f*b);for(var m=-f;m<=f;m++)512>c.x&&
0<=c.x&&512>c.y&&0<=c.y&&h(c.clone(),m,n+m*b,e),c.seek(b)};b.pathSubdivide=function(c,b,h){m(h,b,a(c),d.create(c),0)};b.smoothPaths=function(a,b){for(var c=0;c<a.length;c++){var e=a[c],d=[];d.push(e[0]);for(var f=1;f<e.length;f++){var m=d[f-1],g=m[0],m=m[1],g=g+e[f][0],m=m+e[f][1];d.push([g,m])}g=d;m=b;if(!(0>=m||(e=g.length,3>e))){var f=[],q=0;f.push(0);for(var l=1;l<e;l++)q+=k.dist(g[l],g[l-1]),f.push(q);m=Math.min(m,.2*q);q=[];q.push(g[0][0]);q.push(g[0][1]);var r=g[e-1][0],y=g[e-1][1],l=k.sub([0,
0],g[0],g[1]);k.normalize(l);g[0][0]+=m*l[0];g[0][1]+=m*l[1];k.sub(l,g[e-1],g[e-2]);k.normalize(l);g[e-1][0]+=m*l[0];g[e-1][1]+=m*l[1];for(l=1;l<e;l++)f[l]+=m;f[e-1]+=m;for(var A=.5*m,l=1;l<e-1;l++){for(var z=0,B=0,C=0,D=l-1;0<=D&&!(f[D+1]<f[l]-A);D--){var H=A+f[D+1]-f[l],F=f[D+1]-f[D],E=f[l]-f[D]<A?1:H/F;if(1E-6>Math.abs(E))break;var G=E*E,J=E*H-.5*G*F,K=E*F/m,I=g[D+1],N=g[D][0]-I[0],M=g[D][1]-I[1],z=z+K/J*(I[0]*E*H+.5*G*(H*N-F*I[0])-G*E*F*N/3),B=B+K/J*(I[1]*E*H+.5*G*(H*M-F*I[1])-G*E*F*M/3),C=C+
K}for(D=l+1;D<e&&!(f[D-1]>f[l]+A);D++){H=A-f[D-1]+f[l];F=f[D]-f[D-1];E=f[D]-f[l]<A?1:H/F;if(1E-6>Math.abs(E))break;G=E*E;J=E*H-.5*G*F;K=E*F/m;I=g[D-1];N=g[D][0]-I[0];M=g[D][1]-I[1];z+=K/J*(I[0]*E*H+.5*G*(H*N-F*I[0])-G*E*F*N/3);B+=K/J*(I[1]*E*H+.5*G*(H*M-F*I[1])-G*E*F*M/3);C+=K}q.push(z/C);q.push(B/C)}q.push(r);q.push(y);for(D=l=0;l<e;l++)g[l][0]=q[D++],g[l][1]=q[D++]}e=[];e.push(d[0]);for(f=1;f<d.length;f++)g=d[f-1],l=g[0],q=g[1],m=d[f],g=m[0],m=m[1],e.push([Math.round(g-l),Math.round(m-q)]);a[c]=
e}return a}})},"esri/views/2d/engine/webgl/mesh/templates/util":function(){define(["require","exports"],function(g,b){function l(b,f){return Math.sqrt(b*b+f*f)}Object.defineProperty(b,"__esModule",{value:!0});b.sub=function(b,f,a){b[0]=f[0]-a[0];b[1]=f[1]-a[1];return b};b.len=l;b.normalize=function(b){var f=l(b[0],b[1]);b[0]/=f;b[1]/=f};b.dist=function(b,f){return l(b[0]-f[0],b[1]-f[1])};b.isFunction=function(b){return"function"===typeof b};b.getLimitCosine=function(b){return 1/Math.max(b,1)}})},
"esri/views/2d/engine/webgl/mesh/templates/WGLTextTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/screenUtils ../../alignmentUtils ../../color ../../materialKey/MaterialKey ./WGLBaseTextTemplate ./WGLMeshTemplate ../../util/BidiText".split(" "),function(g,b,l,k,f,a,q,m,d,c){Object.defineProperty(b,"__esModule",{value:!0});g=function(b){function e(a,c,e,d,h,m,g,l,y,A,z,B,C,D,H,F){void 0===F&&(F=!1);var n=b.call(this)||this;n._xOffset=
k.pt2px(z);n._yOffset=k.pt2px(B);n._decoration=l||"none";n._color=d;n._haloColor=h;n._haloSize=Math.min(Math.floor(5*k.pt2px(k.toPt(e))),127);n._size=Math.min(Math.round(k.pt2px(c)),127);c=Math.min(Math.round(k.pt2px(c)),127);n._referenceSize=Math.round(Math.sqrt(256*c));n._scale=n._size/24;n._angle=A;n._justify=f.getJustification(m||"center");n._xAlignD=f.getXAnchorDirection(m||"center");n._yAlignD=f.getYAnchorDirection(g||"baseline");n._baseline="baseline"===(g||"baseline");n._bitset=y?1:0;a=q.MaterialKeyBase.load(q.createMaterialKey(n.geometryType,
a,!1));a.sdf=!0;n._materialKey=a.data;n.symbolId=C;n._lineWidth=k.pt2px(D)||512;n._lineHeight=H||1;n._isCIM=F;return n}l(e,b);e.fromText=function(b,d,h){b=new e(b,d.font.size,d.haloSize||0,d.color&&a.premultiplyAlphaRGBA(d.color)||0,d.haloColor&&a.premultiplyAlphaRGBA(d.haloColor)||0,d.horizontalAlignment,d.verticalAlignment,d.font.decoration,!1,d.angle||0,d.xoffset,d.yoffset,d.id,d.lineWidth,d.lineHeight,!1);d=c.bidiText(d.text)[1];b.bindTextInfo(h,d);return b};e.fromCIMText=function(b,d,h){var n=
d.scaleFactor||1;b=new e(b,d.size*d.sizeRatio*n,d.outlineSize*d.sizeRatio,a.premultiplyAlphaRGBA(d.color),a.premultiplyAlphaRGBA(d.outlineColor),d.horizontalAlignment,d.verticalAlignment,d.decoration,d.colorLocked,d.angle,d.offsetX*d.sizeRatio*n,d.offsetY*d.sizeRatio*n,d.materialHash,512,1,!0);d=c.bidiText(d.text)[1];b.bindTextInfo(h,d);return b};return e}(m.default(d.default));b.default=g})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseTextTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/maybe ../../../../engine ../../definitions ../../enums ../../number ../../WGLDisplayRecord ../../materialKey/MaterialKey".split(" "),
function(g,b,l,k,f,a,q,m,d,c,e,h){Object.defineProperty(b,"__esModule",{value:!0});var p=f.getLogger("esri.views.2d.engine.webgl.WGLTextTemplate"),n=function(a,c){void 0===c&&(c="mapview-processing");return p.error(new k(c,a))};b.default=function(b){return function(b){function f(){for(var a=[],e=0;e<arguments.length;e++)a[e]=arguments[e];a=b.apply(this,a)||this;a._isCIM=!1;a.geometryType=d.WGLGeometryType.TEXT;a._aux=c.i8888to32(0,0,a._referenceSize,a._bitset);return a}l(f,b);f.prototype.bindTextInfo=
function(c,b){var e=this;this._shapingInfo=c&&c.length?a.andThen(c,function(a){return q.shapeGlyphs(a,b,{scale:e._scale,angle:e._angle,xOffset:e._xOffset,yOffset:e._yOffset,hAlign:e._xAlignD,vAlign:e._yAlignD,maxLineWidth:Math.max(32,Math.min(e._lineWidth,512)),lineHeight:m.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(e._lineHeight,4)),decoration:e._decoration,isCIM:e._isCIM})}):null};f.prototype.writeMesh=function(c,b,e,d,h){var f=this;switch(e){case "esriGeometryPoint":this._writeGlyphs(c,b,d,
h.geometry);break;case "esriGeometryPolygon":a.andThen(h.centroid,function(a){return f._writeGlyphs(c,b,d,a)});break;case "esriGeometryMultipoint":var m=e=0,p=0;for(h=h.geometry.points;p<h.length;p++){var k=h[p],g=k[1];e+=k[0];m+=g;this._writeGlyphs(c,b,d,{x:e,y:m})}break;default:n("Unable to handle geometryType: "+e)}};f.prototype._writeGlyphs=function(b,d,n,f){var m=this._shapingInfo;if(!a.isNone(m)){var p=h.MaterialKeyBase.load(this._materialKey);f=c.i1616to32(2*f.x,2*f.y);for(var k=0,m=m.glyphs;k<
m.length;k++){var g=m[k],l=new e(n,this.geometryType,p.data,0,0);p.textureBinding=g.textureBinding;l.materialKey=p.data;l.indexFrom=d.indexVector.length;l.indexCount=this._writeIndices(d);l.vertexFrom=d.getVector("geometry").vertexCount;l.vertexCount=this._writeVertex(d,n,f,g);b.push(l)}}};f.prototype._writeVertexCommon=function(a,b,e,d){d=this._color;var h=this._haloColor,n=c.i8888to32(0,0,this._referenceSize,this._bitset),f=c.i8888to32(0,0,this._size,this._haloSize);a.push(e);a.push(b);a.push(d);
a.push(h);a.push(f);a.push(n)};f.prototype._writeVertex=function(a,c,b,e){a=a.get("geometry");this._writeVertexCommon(a,c,b,e);a.push(e.offsets.upperLeft);a.push(e.texcoords.upperLeft);this._writeVertexCommon(a,c,b,e);a.push(e.offsets.upperRight);a.push(e.texcoords.upperRight);this._writeVertexCommon(a,c,b,e);a.push(e.offsets.lowerLeft);a.push(e.texcoords.lowerLeft);this._writeVertexCommon(a,c,b,e);a.push(e.offsets.lowerRight);a.push(e.texcoords.lowerRight);return 4};f.prototype._writeIndices=function(a){var c=
a.getVector("geometry").vertexCount;a=a.indexVector;a.push(c+0);a.push(c+1);a.push(c+2);a.push(c+1);a.push(c+3);a.push(c+2);return 6};return f}(b)}})},"esri/views/2d/engine/webgl/mesh/templates/WGLMeshTemplate":function(){define(["require","exports","../../../../../../core/tsSupport/extendsHelper"],function(g,b,l){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(){}b.prototype.writeMesh=function(b,a,k,m,d){};b.prototype.bindFeature=function(b,a,k){};return b}();b.default=g})},
"esri/views/2d/engine/webgl/util/vvFlagUtils":function(){define(["require","exports","../enums","../visualVariablesUtils"],function(g,b,l,k){function f(a,b){void 0===b&&(b=!1);var d=l.WGLVVFlag.SIZE_FIELD_STOPS|l.WGLVVFlag.SIZE_MINMAX_VALUE|l.WGLVVFlag.SIZE_SCALE_STOPS|l.WGLVVFlag.SIZE_UNIT_VALUE;a=(a&(l.WGLVVTarget.FIELD_TARGETS_OUTLINE|l.WGLVVTarget.MINMAX_TARGETS_OUTLINE|l.WGLVVTarget.SCALE_TARGETS_OUTLINE|l.WGLVVTarget.UNIT_TARGETS_OUTLINE))>>>4;return b?d&a:d&~a}function a(a){var b=f(a,!1);return a&
(l.WGLVVFlag.COLOR|l.WGLVVFlag.OPACITY|l.WGLVVFlag.ROTATION|b)}Object.defineProperty(b,"__esModule",{value:!0});b.getVVFlags=function(a){if(!a)return l.WGLVVFlag.NONE;for(var b=0,d=0;d<a.length;d++){var c=a[d];if("size"===c.type){var e=k.getTypeOfSizeVisualVariable(c),b=b|e;"outline"===c.target&&(b|=e<<4)}else"color"===c.type?b|=l.WGLVVFlag.COLOR:"opacity"===c.type?b|=l.WGLVVFlag.OPACITY:"rotation"===c.type&&(b|=l.WGLVVFlag.ROTATION)}return b};b.getSizeFlagsMask=f;b.getMarkerVVFlags=a;b.getFillVVFlags=
function(a){return a&(l.WGLVVFlag.COLOR|l.WGLVVFlag.OPACITY)};b.getLineVVFlags=function(a,b){if(b)return b=f(a,!0),a&b;b=f(a,!1);return a&(l.WGLVVFlag.COLOR|l.WGLVVFlag.OPACITY|b)};b.getTextVVFlags=function(b){return a(b)};b.getLabelVVFlags=function(a){var b=f(a,!1);return a&b}})},"esri/views/2d/engine/webgl/visualVariablesUtils":function(){define("require exports ../../../../core/Error ../../../../core/Logger ./enums ./Utils".split(" "),function(g,b,l,k,f,a){Object.defineProperty(b,"__esModule",
{value:!0});var q=k.getLogger("esri.views.2d.engine.webgl");b.getTypeOfSizeVisualVariable=function(b){if(a.isNumber(b.minDataValue)&&a.isNumber(b.maxDataValue)&&null!=b.minSize&&null!=b.maxSize)return f.WGLVVFlag.SIZE_MINMAX_VALUE;if((b.expression&&"view.scale"===b.expression||b.valueExpression&&"$view.scale"===b.valueExpression)&&Array.isArray(b.stops))return f.WGLVVFlag.SIZE_SCALE_STOPS;if((null!=b.field||b.expression&&"view.scale"!==b.expression||b.valueExpression&&"$view.scale"!==b.valueExpression)&&
(Array.isArray(b.stops)||"levels"in b&&b.levels))return f.WGLVVFlag.SIZE_FIELD_STOPS;if((null!=b.field||b.expression&&"view.scale"!==b.expression||b.valueExpression&&"$view.scale"!==b.valueExpression)&&null!=b.valueUnit)return f.WGLVVFlag.SIZE_UNIT_VALUE;q.error(new l("mapview-bad-type","Found invalid size VisualVariable",b));return f.WGLVVFlag.NONE}})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLabel":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../webgl ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),
function(g,b,l,k,f,a,q,m){Object.defineProperty(b,"__esModule",{value:!0});g=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}l(c,b);c.prototype.dispose=function(){};c.prototype.getGeometryType=function(){return f.WGLGeometryType.LABEL};c.prototype.drawGeometry=function(c,b,d,n,f){var e=c.context,h=c.painter,p=c.state,k=c.rendererInfo,g=d.indexCount,l=d.indexFrom;d=m.LabelMaterialKey.load(d.materialKey);var q=d.mapAligned?1:0;if(q||!(1<=Math.abs(b.key.level-Math.round(100*c.displayLevel)/
100))){var u=a.createProgramDescriptor(d.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_haloColor",count:4,type:5121,normalized:!0},{location:4,name:"a_texAndSize",count:4,type:5121},{location:5,name:"a_refSymbolAndPlacementOffset",count:4,type:5121},{location:6,name:"a_glyphData",count:4,type:5121},{location:7,name:"a_vertexOffset",count:2,type:5122},{location:8,
name:"a_texCoords",count:2,type:5123}]}),B=u.bufferLayouts,u=u.attributes;f=h.materialManager.getMaterialProgram(c,d,"materials/label",u,f);n=this._getVAO(e,B,u,n);c.context.setStencilFunction(514,0,255);e.bindProgram(f);e.bindVAO(n);this._setSharedUniforms(f,c,b);h.textureManager.bindTextures(e,f,d);h=1===q?p.displayViewMat3:p.displayMat3;d.vvSizeMinMaxValue&&f.setUniform4fv("u_vvSizeMinMaxValue",k.vvSizeMinMaxValue);d.vvSizeScaleStops&&f.setUniform1f("u_vvSizeScaleStopsValue",k.vvSizeScaleStopsValue);
d.vvSizeFieldStops&&(b=k.getSizeVVFieldStops(b.key.level),f.setUniform1fv("u_vvSizeFieldStopsValues",b.values),f.setUniform1fv("u_vvSizeFieldStopsSizes",b.sizes));d.vvSizeUnitValue&&f.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",k.vvSizeUnitValueToPixelsRatio);f.setUniform1f("u_mapRotation",Math.floor(p.rotation/360*254));f.setUniform1f("u_mapAligned",q);f.setUniformMatrix3fv("u_displayMat3",h);f.setUniform1f("u_opacity",1);f.setUniform1f("u_zoomLevel",Math.round(10*c.displayLevel));f.setUniform2fv("u_screenSize",
c.state.size);f.setUniform1f("u_isHalo",1);e.drawElements(4,g,5125,4*l);f.setUniform1f("u_isHalo",0);e.drawElements(4,g,5125,4*l);e.bindVAO(null);e.setStencilTestEnabled(!0);e.setBlendingEnabled(!0)}};return c}(q.default);b.default=g})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLine":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../webgl ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),function(g,b,l,k,f,a,q,m){Object.defineProperty(b,
"__esModule",{value:!0});g=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}l(c,b);c.prototype.dispose=function(){};c.prototype.getGeometryType=function(){return f.WGLGeometryType.LINE};c.prototype.drawGeometry=function(c,b,d,n,f){var e=c.context,h=c.painter,p=c.rendererInfo,k=c.requiredLevel,g=d.indexFrom,l=d.indexCount;d=m.LineMaterialKey.load(d.materialKey);var q=a.createProgramDescriptor(d.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",
count:4,type:5121},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_offsetAndNormal",count:4,type:5120},{location:4,name:"a_accumulatedDistanceAndHalfWidth",count:2,type:5123},{location:5,name:"a_tlbr",count:4,type:5123},{location:6,name:"a_segmentDirection",count:4,type:5120},{location:7,name:"a_aux",count:2,type:5123}]}),u=q.bufferLayouts,q=q.attributes;f=h.materialManager.getMaterialProgram(c,d,"materials/line",q,f);n=this._getVAO(e,u,q,n);u=1/c.pixelRatio;e.bindProgram(f);
e.bindVAO(n);this._setSharedUniforms(f,c,b);d.textureBinding&&h.textureManager.bindTextures(e,f,d);f.setUniform1f("u_zoomFactor",Math.pow(2,k-b.key.level)/c.pixelRatio);f.setUniform1f("u_blur",0+u);f.setUniform1f("u_antialiasing",u);d.vvSizeMinMaxValue&&f.setUniform4fv("u_vvSizeMinMaxValue",p.vvSizeMinMaxValue);d.vvSizeScaleStops&&f.setUniform1f("u_vvSizeScaleStopsValue",p.vvSizeScaleStopsValue);d.vvSizeFieldStops&&(c=p.getSizeVVFieldStops(b.key.level),f.setUniform1fv("u_vvSizeFieldStopsValues",c.values),
f.setUniform1fv("u_vvSizeFieldStopsSizes",c.sizes));d.vvSizeUnitValue&&f.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",p.vvSizeUnitValueToPixelsRatio);d.vvColor&&(f.setUniform1fv("u_vvColorValues",p.vvColorValues),f.setUniform4fv("u_vvColors",p.vvColors));d.vvOpacity&&(f.setUniform1fv("u_vvOpacityValues",p.vvOpacityValues),f.setUniform1fv("u_vvOpacities",p.vvOpacities));e.setFaceCullingEnabled(!0);e.setFrontFace(2305);e.setCullFace(1029);e.drawElements(4,l,5125,4*g);e.setFaceCullingEnabled(!1);
e.bindVAO(null)};return c}(q.default);b.default=g})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushMarker":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/tsSupport/assignHelper ../../../../webgl ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),function(g,b,l,k,f,a,q,m,d){Object.defineProperty(b,"__esModule",{value:!0});g=function(c){function b(){return null!==c&&c.apply(this,arguments)||this}l(b,c);b.prototype.dispose=
function(){};b.prototype.getGeometryType=function(){return a.WGLGeometryType.MARKER};b.prototype.drawGeometry=function(a,c,b,e,f){var h=a.context,n=a.painter,p=a.rendererInfo,m=a.state,k=b.indexCount,g=b.indexFrom;b=d.MarkerMaterialKey.load(b.materialKey);var l=q.createProgramDescriptor(b.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_vertexOffset",count:2,type:5122},{location:2,name:"a_texCoords",count:2,type:5123},{location:3,name:"a_bitSetAndDistRatio",count:4,
type:5121},{location:4,name:"a_id",count:4,type:5121},{location:5,name:"a_color",count:4,type:5121,normalized:!0},{location:6,name:"a_outlineColor",count:4,type:5121,normalized:!0},{location:7,name:"a_sizeAndOutlineWidth",count:4,type:5121}]}),u=l.bufferLayouts,l=l.attributes;f=n.materialManager.getMaterialProgram(a,b,"materials/icon",l,f);e=this._getVAO(h,u,l,e);h.bindProgram(f);h.bindVAO(e);b.textureBinding&&n.textureManager.bindTextures(h,f,b);this._setSharedUniforms(f,a,c);f.setUniformMatrix3fv("u_displayMat3",
b.vvRotation?m.displayViewMat3:m.displayMat3);b.vvSizeMinMaxValue&&f.setUniform4fv("u_vvSizeMinMaxValue",p.vvSizeMinMaxValue);b.vvSizeScaleStops&&f.setUniform1f("u_vvSizeScaleStopsValue",p.vvSizeScaleStopsValue);b.vvSizeFieldStops&&(a=p.getSizeVVFieldStops(c.key.level),f.setUniform1fv("u_vvSizeFieldStopsValues",a.values),f.setUniform1fv("u_vvSizeFieldStopsSizes",a.sizes));b.vvSizeUnitValue&&f.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",p.vvSizeUnitValueToPixelsRatio);b.vvColor&&(f.setUniform1fv("u_vvColorValues",
p.vvColorValues),f.setUniform4fv("u_vvColors",p.vvColors));b.vvOpacity&&(f.setUniform1fv("u_vvOpacityValues",p.vvOpacityValues),f.setUniform1fv("u_vvOpacities",p.vvOpacities));b.vvRotation&&f.setUniform1f("u_vvRotationType","geographic"===p.vvMaterialParameters.vvRotationType?0:1);h.drawElements(4,k,5125,4*g);h.bindVAO(null)};return b}(m.default);b.default=g})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushText":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../webgl ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),
function(g,b,l,k,f,a,q,m){Object.defineProperty(b,"__esModule",{value:!0});g=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}l(c,b);c.prototype.dispose=function(){};c.prototype.getGeometryType=function(){return f.WGLGeometryType.TEXT};c.prototype.drawGeometry=function(c,b,d,n,f){var e=c.context,h=c.painter,p=c.rendererInfo,k=c.state,g=d.indexCount,l=d.indexFrom;d=m.TextMaterialKey.load(d.materialKey);var q=a.createProgramDescriptor(d.data,{geometry:[{location:0,name:"a_pos",
count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_haloColor",count:4,type:5121,normalized:!0},{location:4,name:"a_texFontSize",count:4,type:5121},{location:5,name:"a_aux",count:4,type:5120},{location:6,name:"a_vertexOffset",count:2,type:5122},{location:7,name:"a_texCoords",count:2,type:5123}]}),u=q.bufferLayouts,q=q.attributes;f=h.materialManager.getMaterialProgram(c,d,"materials/text",q,f);n=this._getVAO(e,
u,q,n);e.bindProgram(f);e.bindVAO(n);this._setSharedUniforms(f,c,b);h.textureManager.bindTextures(e,f,d);f.setUniformMatrix3fv("u_displayMat3",k.displayMat3);d.vvSizeMinMaxValue&&f.setUniform4fv("u_vvSizeMinMaxValue",p.vvSizeMinMaxValue);d.vvSizeScaleStops&&f.setUniform1f("u_vvSizeScaleStopsValue",p.vvSizeScaleStopsValue);d.vvSizeFieldStops&&(c=p.getSizeVVFieldStops(b.key.level),f.setUniform1fv("u_vvSizeFieldStopsValues",c.values),f.setUniform1fv("u_vvSizeFieldStopsSizes",c.sizes));d.vvSizeUnitValue&&
f.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",p.vvSizeUnitValueToPixelsRatio);d.vvColor&&(f.setUniform1fv("u_vvColorValues",p.vvColorValues),f.setUniform4fv("u_vvColors",p.vvColors));d.vvOpacity&&(f.setUniform1fv("u_vvOpacityValues",p.vvOpacityValues),f.setUniform1fv("u_vvOpacities",p.vvOpacities));d.vvRotation&&f.setUniform1f("u_vvRotationType","geographic"===p.vvMaterialParameters.vvRotationType?0:1);f.setUniform1f("u_isHalo",1);e.drawElements(4,g,5125,4*l);f.setUniform1f("u_isHalo",0);e.drawElements(4,
g,5125,4*l);e.bindVAO(null)};return c}(q.default);b.default=g})},"esri/views/2d/engine/webgl/mesh/templates/shapingUtils":function(){define("require exports ../../../../../../core/libs/gl-matrix-2/mat2d ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../../../../../core/libs/gl-matrix-2/vec2 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../.. ../../alignmentUtils ../../number ../../collisions/BoundingBox".split(" "),function(g,b,l,k,f,a,q,m,d,c){Object.defineProperty(b,"__esModule",{value:!0});
var e=function(){function a(a,c,b,e){this._rotationT=k.mat2df32.create();this.minZoom=this._yBounds=this._xBounds=0;this.maxZoom=255;var d=b.rect,h=new Float32Array(8);a*=e;c*=e;var n=b.code?d.width*e:b.metrics.width,f=b.code?d.height*e:b.metrics.height;h[0]=a;h[1]=c;h[2]=a+n;h[3]=c;h[4]=a;h[5]=c+f;h[6]=a+n;h[7]=c+f;this._data=h;this._setTextureCoords(d);this._scale=e;this._mosaic=b;this.x=a;this.y=c}Object.defineProperty(a.prototype,"width",{get:function(){return this._mosaic.metrics.width*this._scale},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"mosaic",{get:function(){return this._mosaic},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"angle",{get:function(){return this._angle},set:function(a){this._angle=a;l.mat2d.identity(this._rotationT);l.mat2d.rotate(this._rotationT,this._rotationT,-a);this._setOffsets(this._data)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"xTopLeft",{get:function(){return this._data[0]},enumerable:!0,configurable:!0});
Object.defineProperty(a.prototype,"yTopLeft",{get:function(){return this._data[1]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"xBottomRight",{get:function(){return this._data[6]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"yBottomRight",{get:function(){return this._data[7]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"texcoords",{get:function(){return this._texcoords},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"textureBinding",{get:function(){return this._mosaic.textureBinding},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"offsets",{get:function(){this._offsets||this._setOffsets(this._data);return this._offsets},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"char",{get:function(){return String.fromCharCode(this._mosaic.code)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"code",{get:function(){return this._mosaic.code},enumerable:!0,configurable:!0});
Object.defineProperty(a.prototype,"bounds",{get:function(){var a=this._mosaic.metrics,b=a.width*this._scale,e=Math.abs(a.height)*this._scale,a=new Float32Array(8);a[0]=this.x;a[1]=this.y;a[2]=this.x+b;a[3]=this.y;a[4]=this.x;a[5]=this.y+e;a[6]=this.x+b;a[7]=this.y+e;b=l.mat2d.multiply(k.mat2df32.create(),this._rotationT,this._T);k.mat2df32.transformMany(a,a,b);for(var e=b=Infinity,d=0,h=0,n=0;4>n;n++)var f=a[2*n],p=a[2*n+1],b=Math.min(b,f),e=Math.min(e,p),d=Math.max(d,f),h=Math.max(h,p);a=d-b;h-=
e;return new c.default(b+a/2,e+h/2,a,h)},enumerable:!0,configurable:!0});a.prototype.setTransform=function(a){this._T=a;this._offsets=null};a.prototype._setOffsets=function(a){this._offsets||(this._offsets={upperLeft:0,upperRight:0,lowerLeft:0,lowerRight:0});var c=this._offsets,b=new Float32Array(8),e=l.mat2d.multiply(k.mat2df32.create(),this._rotationT,this._T);k.mat2df32.transformMany(b,a,e);c.upperLeft=d.i1616to32(8*b[0],8*b[1]);c.upperRight=d.i1616to32(8*b[2],8*b[3]);c.lowerLeft=d.i1616to32(8*
b[4],8*b[5]);c.lowerRight=d.i1616to32(8*b[6],8*b[7])};a.prototype._setTextureCoords=function(a){var c=a.x,b=a.y,e=a.width;a=a.height;this._texcoords={upperLeft:d.i1616to32(c,b),upperRight:d.i1616to32(c+e,b),lowerLeft:d.i1616to32(c,b+a),lowerRight:d.i1616to32(c+e,b+a)}};return a}();b.ShapedGlyph=e;var h=function(a,c){return{code:0,page:0,sdf:!0,rect:new q.Rect(0,0,11,8),textureBinding:c,metrics:{advance:0,height:4,width:a,left:0,top:0}}},p=function(){function b(a,c,b){this._decorate(a,c,b);this.glyphs=
a;this.bounds=this._createBounds(a);this.isMultiline=1<c.length;this._hasRotation=0!==b.angle;this._T=this._createGlyphTransform(this.bounds,b);for(c=0;c<a.length;c++)a[c].setTransform(this._T)}b.prototype._decorate=function(a,c,b){if("none"!==b.decoration&&a.length){var d=b.scale;b="underline"===b.decoration?30:20;for(var n=a[0].textureBinding,f=0;f<c.length;f++){var p=c[f];a.push(new e(p.startX*d,p.startY*d+b*d,h((p.width+p.glyphWidthEnd)*d,n),1))}}};Object.defineProperty(b.prototype,"boundsT",
{get:function(){var b=this.bounds,e=f.vec2.set(a.vec2f32.create(),b.x,b.y);f.vec2.transformMat2d(e,e,this._T);return this._hasRotation?(b=Math.max(b.width,b.height),new c.default(e[0],e[1],b,b)):new c.default(e[0],e[1],b.width,b.height)},enumerable:!0,configurable:!0});b.prototype._createBounds=function(a){for(var b=Infinity,e=Infinity,d=0,h=0,n=0;n<a.length;n++)var f=a[n],b=Math.min(b,f.xTopLeft),e=Math.min(e,f.yTopLeft),d=Math.max(d,f.xTopLeft+f.width),h=Math.max(h,f.yBottomRight);a=d-b;h-=e;return new c.default(b+
a/2,e+h/2,a,h)};b.prototype._createGlyphTransform=function(c,b){var e=b.angle*Math.PI/180,d=k.mat2df32.create(),h=a.vec2f32.create();l.mat2d.translate(d,d,f.vec2.set(h,b.xOffset,-b.yOffset));b.isCIM?l.mat2d.rotate(d,d,e):(l.mat2d.translate(d,d,f.vec2.set(h,c.x,c.y)),l.mat2d.rotate(d,d,e),l.mat2d.translate(d,d,f.vec2.set(h,-c.x,-c.y)));return d};return b}();b.ShapingInfo=p;var n=function(){return function(a,c,b,e,d,h){this.startY=this.startX=this.glyphWidthEnd=0;this.start=Math.max(0,Math.min(c,b));
this.end=Math.max(0,Math.max(c,b));this.end<a.length&&(this.glyphWidthEnd=a[this.end].metrics.width);this.width=e;this.yMin=d;this.yMax=h}}();b.shapeGlyphs=function(a,c,b){var d=b.scale,h=[],f=[],k=1/b.scale*b.maxLineWidth,g=c?a.length-1:0,l=c?-1:a.length;c=c?-1:1;for(var q=g,u=0,v=0,x=q,F=x,E=0,G=Infinity,J=0;q!==l;){var K=a[q],I=K.code,K=K.metrics,N=Math.abs(K.top);10!==I&&32!==I&&(G=Math.min(G,N),J=Math.max(J,N+K.height));10===I?(q!==g&&(f.push(new n(a,x,q-c,u,G,J)),G=Infinity,J=0),u=0,x=q+c,F=
q+c,v=0):32===I?(F=q+c,v=0,E=K.advance,u+=K.advance):(u>k&&(F!==x?(I=F-2*c,u-=E,f.push(new n(a,x,I,u-v,G,J)),G=Infinity,J=0,x=F,u=v):(f.push(new n(a,x,q-c,u,G,J)),G=Infinity,J=0,F=x=q,u=0)),u+=K.advance,v+=K.advance);q+=c}k=new n(a,x,q-c,u,G,J);0<=k.start&&k.end<a.length&&f.push(k);for(k=0;k<f.length;k++);g=f[0].yMin;l=b.vAlign;k=b.hAlign;c=l===m.VAlign.Baseline?1:0;g=(1-c)*-g+(f[f.length-1].yMax+b.lineHeight*(f.length-1)+("underline"===b.decoration?4:0)-g)/2*(c?0:l-1)+-26*(c?1:0);for(l=0;l<f.length;l++)for(q=
f[l],v=q.start,c=q.end,q=q.width/2*(k+1)*-1-3,u=l*b.lineHeight+g-3,f[l].startX=q,f[l].startY=u;v<=c;v++)x=a[v],10!==x.code&&(F=new e(q+x.metrics.left,u-x.metrics.top,x,d),q+=x.metrics.advance,h.push(F));return new p(h,f,b)}})},"esri/views/2d/engine/webgl/TileClipper":function(){define(["require","exports","./definitions","./Geometry","./GeometryUtils"],function(g,b,l,k,f){Object.defineProperty(b,"__esModule",{value:!0});var a=function(){return function(a,b,c){this.ratio=a;this.x=b;this.y=c}}();g=
function(){function b(a,c,b,h,f){void 0===h&&(h=8);void 0===f&&(f=8);this.lines=[];this.starts=[];this.pixelRatio=h;this.pixelMargin=f;this.tileSize=l.TILE_SIZE*h;this.dz=a;this.yPos=c;this.xPos=b}b.prototype.setExtent=function(a){this.finalRatio=this.tileSize/a*(1<<this.dz);var c=this.pixelRatio*this.pixelMargin,c=c/this.finalRatio;a>>=this.dz;c>a&&(c=a);this.margin=c;this.xmin=a*this.xPos-c;this.ymin=a*this.yPos-c;this.xmax=this.xmin+a+2*c;this.ymax=this.ymin+a+2*c};b.prototype.reset=function(a){this.type=
a;this.lines=[];this.starts=[];this.line=null;this.start=0};b.prototype.moveTo=function(a,c){this._pushLine();this._prevIsIn=this._isIn(a,c);this._moveTo(a,c,this._prevIsIn);this._prevPt=new k.Point(a,c);this._firstPt=new k.Point(a,c);this._dist=0};b.prototype.lineTo=function(b,c){var e=this._isIn(b,c),d=new k.Point(b,c),f=k.Point.distance(this._prevPt,d),n,m,g;if(e)this._prevIsIn?this._lineTo(b,c,!0):(n=this._prevPt,m=d,b=this._intersect(m,n),this.start=this._dist+f*(1-this._r),this._lineTo(b.x,
b.y,!0),this._lineTo(m.x,m.y,!0));else if(this._prevIsIn)m=this._prevPt,n=d,b=this._intersect(m,n),this._lineTo(b.x,b.y,!0),this._lineTo(n.x,n.y,!1);else{var l=this._prevPt;if(!(l.x<=this.xmin&&d.x<=this.xmin||l.x>=this.xmax&&d.x>=this.xmax||l.y<=this.ymin&&d.y<=this.ymin||l.y>=this.ymax&&d.y>=this.ymax)){b=[];if(l.x<this.xmin&&d.x>this.xmin||l.x>this.xmin&&d.x<this.xmin)c=(this.xmin-l.x)/(d.x-l.x),g=l.y+c*(d.y-l.y),g<=this.ymin?m=!1:g>=this.ymax?m=!0:b.push(new a(c,this.xmin,g));if(l.x<this.xmax&&
d.x>this.xmax||l.x>this.xmax&&d.x<this.xmax)c=(this.xmax-l.x)/(d.x-l.x),g=l.y+c*(d.y-l.y),g<=this.ymin?m=!1:g>=this.ymax?m=!0:b.push(new a(c,this.xmax,g));if(l.y<this.ymin&&d.y>this.ymin||l.y>this.ymin&&d.y<this.ymin)c=(this.ymin-l.y)/(d.y-l.y),g=l.x+c*(d.x-l.x),g<=this.xmin?n=!1:g>=this.xmax?n=!0:b.push(new a(c,g,this.ymin));if(l.y<this.ymax&&d.y>this.ymax||l.y>this.ymax&&d.y<this.ymax)c=(this.ymax-l.y)/(d.y-l.y),g=l.x+c*(d.x-l.x),g<=this.xmin?n=!1:g>=this.xmax?n=!0:b.push(new a(c,g,this.ymax));
if(0===b.length)n?m?this._lineTo(this.xmax,this.ymax,!0):this._lineTo(this.xmax,this.ymin,!0):m?this._lineTo(this.xmin,this.ymax,!0):this._lineTo(this.xmin,this.ymin,!0);else if(1<b.length&&b[0].ratio>b[1].ratio)this.start=this._dist+f*b[1].ratio,this._lineTo(b[1].x,b[1].y,!0),this._lineTo(b[0].x,b[0].y,!0);else for(this.start=this._dist+f*b[0].ratio,n=0;n<b.length;n++)this._lineTo(b[n].x,b[n].y,!0)}this._lineTo(d.x,d.y,!1)}this._dist+=f;this._prevIsIn=e;this._prevPt=d};b.prototype.close=function(){if(2<
this.line.length){var a=this._firstPt,c=this._prevPt;a.x===c.x&&a.y===c.y||this.lineTo(a.x,a.y);a=this.line;for(c=a.length;4<=c;)if(a[0].x===a[1].x&&a[0].x===a[c-2].x||a[0].y===a[1].y&&a[0].y===a[c-2].y)a.pop(),a[0].x=a[c-2].x,a[0].y=a[c-2].y,--c;else break}};b.prototype.result=function(a){void 0===a&&(a=!0);this._pushLine();if(0===this.lines.length)return null;3===this.type&&a&&q.simplify(this.tileSize,this.margin*this.finalRatio,this.lines);return this.lines};b.prototype.resultWithStarts=function(){if(2!==
this.type)throw Error("Only valid for lines");this._pushLine();var a=this.lines,c=a.length;if(0===c)return null;for(var b=[],h=0;h<c;h++)b.push({line:a[h],start:this.starts[h]||0});return b};b.prototype._isIn=function(a,c){return a>=this.xmin&&a<=this.xmax&&c>=this.ymin&&c<=this.ymax};b.prototype._intersect=function(a,c){var b,d,f;if(c.x>=this.xmin&&c.x<=this.xmax)d=c.y<=this.ymin?this.ymin:this.ymax,f=(d-a.y)/(c.y-a.y),b=a.x+f*(c.x-a.x);else if(c.y>=this.ymin&&c.y<=this.ymax)b=c.x<=this.xmin?this.xmin:
this.xmax,f=(b-a.x)/(c.x-a.x),d=a.y+f*(c.y-a.y);else{d=c.y<=this.ymin?this.ymin:this.ymax;b=c.x<=this.xmin?this.xmin:this.xmax;var n=(b-a.x)/(c.x-a.x),m=(d-a.y)/(c.y-a.y);n<m?(f=n,d=a.y+n*(c.y-a.y)):(f=m,b=a.x+m*(c.x-a.x))}this._r=f;return new k.Point(b,d)};b.prototype._pushLine=function(){this.line&&(1===this.type?0<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)):2===this.type?1<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)):3===this.type&&
3<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)));this.line=[];this.start=0};b.prototype._moveTo=function(a,c,b){3!==this.type?b&&(a=Math.round((a-(this.xmin+this.margin))*this.finalRatio),c=Math.round((c-(this.ymin+this.margin))*this.finalRatio),this.line.push(new k.Point(a,c))):(b||(a<this.xmin&&(a=this.xmin),a>this.xmax&&(a=this.xmax),c<this.ymin&&(c=this.ymin),c>this.ymax&&(c=this.ymax)),a=Math.round((a-(this.xmin+this.margin))*this.finalRatio),c=Math.round((c-(this.ymin+
this.margin))*this.finalRatio),this.line.push(new k.Point(a,c)),this._is_v=this._is_h=!1)};b.prototype._lineTo=function(a,c,b){if(3!==this.type)if(b){a=Math.round((a-(this.xmin+this.margin))*this.finalRatio);c=Math.round((c-(this.ymin+this.margin))*this.finalRatio);if(0<this.line.length&&(b=this.line[this.line.length-1],b.equals(a,c)))return;this.line.push(new k.Point(a,c))}else this.line&&0<this.line.length&&this._pushLine();else if(b||(a<this.xmin&&(a=this.xmin),a>this.xmax&&(a=this.xmax),c<this.ymin&&
(c=this.ymin),c>this.ymax&&(c=this.ymax)),a=Math.round((a-(this.xmin+this.margin))*this.finalRatio),c=Math.round((c-(this.ymin+this.margin))*this.finalRatio),this.line&&0<this.line.length){b=this.line[this.line.length-1];var e=b.x===a,d=b.y===c;e&&d||(this._is_h&&e?(b.x=a,b.y=c,b=this.line[this.line.length-2],b.x===a&&b.y===c?(this.line.pop(),1>=this.line.length?this._is_v=this._is_h=!1:(b=this.line[this.line.length-2],this._is_h=b.x===a,this._is_v=b.y===c)):(this._is_h=b.x===a,this._is_v=b.y===c)):
this._is_v&&d?(b.x=a,b.y=c,b=this.line[this.line.length-2],b.x===a&&b.y===c?(this.line.pop(),1>=this.line.length?this._is_v=this._is_h=!1:(b=this.line[this.line.length-2],this._is_h=b.x===a,this._is_v=b.y===c)):(this._is_h=b.x===a,this._is_v=b.y===c)):(this.line.push(new k.Point(a,c)),this._is_h=e,this._is_v=d))}else this.line.push(new k.Point(a,c))};return b}();b.TileClipper=g;g=function(){function a(){}a.prototype.setExtent=function(a){this._ratio=4096===a?1:4096/a};a.prototype.reset=function(a){this.type=
a;this.lines=[];this.line=null};a.prototype.moveTo=function(a,c){this.line&&this.lines.push(this.line);this.line=[];var b=this._ratio;this.line.push(new k.Point(Math.round(a*b),Math.round(c*b)))};a.prototype.lineTo=function(a,c){var b=this._ratio;this.line.push(new k.Point(Math.round(a*b),Math.round(c*b)))};a.prototype.close=function(){var a=this.line;a&&!a[0].isEqual(a[a.length-1])&&a.push(a[0])};a.prototype.result=function(){this.line&&this.lines.push(this.line);if(0===this.lines.length)return null;
3===this.type&&1!==this._ratio&&q.simplify(4096,64,this.lines);return this.lines};return a}();b.SimpleBuilder=g;var q=function(){function a(){}a.simplify=function(b,c,e){if(e){var d=-c,f=b+c,n=-c,m=b+c;b=[];c=[];for(var k=e.length,l=0;l<k;++l){var g=e[l];if(g&&!(2>g.length))for(var q=g[0],r=void 0,y=g.length,A=1;A<y;++A)r=g[A],q.x===r.x&&(q.x<=d&&(q.y>r.y?(b.push(l),b.push(A),b.push(0),b.push(-1)):(c.push(l),c.push(A),c.push(0),c.push(-1))),q.x>=f&&(q.y<r.y?(b.push(l),b.push(A),b.push(1),b.push(-1)):
(c.push(l),c.push(A),c.push(1),c.push(-1)))),q.y===r.y&&(q.y<=n&&(q.x<r.x?(b.push(l),b.push(A),b.push(2),b.push(-1)):(c.push(l),c.push(A),c.push(2),c.push(-1))),q.y>=m&&(q.x>r.x?(b.push(l),b.push(A),b.push(3),b.push(-1)):(c.push(l),c.push(A),c.push(3),c.push(-1)))),q=r}0!==b.length&&0!==c.length&&(a.fillParent(e,c,b),a.fillParent(e,b,c),d=[],a.calcDeltas(d,c,b),a.calcDeltas(d,b,c),a.addDeltas(d,e))}};a.fillParent=function(a,c,b){for(var e=b.length,d=c.length,n=0;n<d;n+=4){for(var m=c[n],k=c[n+1],
l=c[n+2],g=a[m][k-1],m=a[m][k],k=8092,q=-1,r=0;r<e;r+=4)if(b[r+2]===l){var y=b[r],A=b[r+1],z=a[y][A-1],y=a[y][A];switch(l){case 0:case 1:f.between(g.y,z.y,y.y)&&f.between(m.y,z.y,y.y)&&(z=Math.abs(y.y-z.y),z<k&&(k=z,q=r));break;case 2:case 3:f.between(g.x,z.x,y.x)&&f.between(m.x,z.x,y.x)&&(z=Math.abs(y.x-z.x),z<k&&(k=z,q=r))}}c[n+3]=q}};a.calcDeltas=function(b,c,e){for(var d=c.length,f=0;f<d;f+=4){var n=a.calcDelta(f,c,e,[]);b.push(c[f]);b.push(c[f+1]);b.push(c[f+2]);b.push(n)}};a.calcDelta=function(b,
c,e,h){b=c[b+3];if(-1===b)return 0;var d=h.length;if(1<d&&h[d-2]===b)return 0;h.push(b);return a.calcDelta(b,e,c,h)+1};a.addDeltas=function(a,c){for(var b=a.length,d=0,f=0;f<b;f+=4){var n=a[f+3];n>d&&(d=n)}for(f=0;f<b;f+=4){var m=c[a[f]],k=a[f+1],n=d-a[f+3];switch(a[f+2]){case 0:m[k-1].x-=n;m[k].x-=n;1===k&&(m[m.length-1].x-=n);k===m.length-1&&(m[0].x-=n);break;case 1:m[k-1].x+=n;m[k].x+=n;1===k&&(m[m.length-1].x+=n);k===m.length-1&&(m[0].x+=n);break;case 2:m[k-1].y-=n;m[k].y-=n;1===k&&(m[m.length-
1].y-=n);k===m.length-1&&(m[0].y-=n);break;case 3:m[k-1].y+=n,m[k].y+=n,1===k&&(m[m.length-1].y+=n),k===m.length-1&&(m[0].y+=n)}}};return a}()})},"esri/views/2d/engine/webgl/TurboLine":function(){define(["require","exports","../../../../symbols/cim/enums","./mesh/templates/util"],function(g,b,l,k){function f(){if(r.cosine<h.innerBisectorAutoSplitThreshold){r.splitInner=!0;r.gapInner=!0;var a=Math.max(h.innerBisectorAutoSplitThreshold,r.cosine),a=Math.sqrt(1-a*a)/a;r.leftInner.x=r.nextNormal.x+r.sign*
a*r.outbound.x;r.leftInner.y=r.nextNormal.y+r.sign*a*r.outbound.y;r.rightInner.x=r.prevNormal.x-r.sign*a*r.inbound.x;r.rightInner.y=r.prevNormal.y-r.sign*a*r.inbound.y}else h.enableInnerBisectorSplit&&(r.splitInner=!0,r.gapInner=!1,r.leftInner.x=r.rightInner.x=r.bisector.x/r.cosine,r.leftInner.y=r.rightInner.y=r.bisector.y/r.cosine);r.cosine<h.outerBisectorAutoSplitThreshold?(r.splitOuter=!0,r.gapOuter=!0,a=Math.max(h.outerBisectorAutoSplitThreshold,r.cosine),a=Math.sqrt(1-a*a)/a,r.leftOuter.x=r.prevNormal.x-
r.sign*a*r.inbound.x,r.leftOuter.y=r.prevNormal.y-r.sign*a*r.inbound.y,r.rightOuter.x=r.nextNormal.x+r.sign*a*r.outbound.x,r.rightOuter.y=r.nextNormal.y+r.sign*a*r.outbound.y):h.enableOuterBisectorSplit&&(r.splitOuter=!0,r.gapOuter=!1,r.leftOuter.x=r.rightOuter.x=r.bisector.x/r.cosine,r.leftOuter.y=r.rightOuter.y=r.bisector.y/r.cosine)}function a(){if(v)r.distance=0,v=r.isCap=r.isFirstVertex=r.isLastVertex=!1;else{if(0===u)if(r.isFirstVertex=0===n,w=e[n],0===n){if(u=0,r.closed){r.inbound.x=w.x-e[e.length-
2].x;r.inbound.y=w.y-e[e.length-2].y;var a=Math.sqrt(r.inbound.x*r.inbound.x+r.inbound.y*r.inbound.y);r.inbound.x/=a;r.inbound.y/=a}}else r.inbound.x=w.x-t.x,r.inbound.y=w.y-t.y,u=Math.sqrt(r.inbound.x*r.inbound.x+r.inbound.y*r.inbound.y),r.inbound.x/=u,r.inbound.y/=u;r.distance+u-x<=h.wrapDistance?(n<e.length-1?(r.outbound.x=e[n+1].x-w.x,r.outbound.y=e[n+1].y-w.y,a=Math.sqrt(r.outbound.x*r.outbound.x+r.outbound.y*r.outbound.y),r.outbound.x/=a,r.outbound.y/=a):r.closed?(r.outbound.x=e[1].x-w.x,r.outbound.y=
e[1].y-w.y,a=Math.sqrt(r.outbound.x*r.outbound.x+r.outbound.y*r.outbound.y),r.outbound.x/=a,r.outbound.y/=a):(r.outbound.x=r.inbound.x,r.outbound.y=r.inbound.y),0!==n||r.closed||(r.inbound.x=r.outbound.x,r.inbound.y=r.outbound.y),++n,r.isLastVertex=n===e.length,r.isCap=!r.closed&&(r.isFirstVertex||r.isLastVertex),r.distance+=u-x,x=u=0,v=r.distance+u-x===h.wrapDistance,r.currentVertex.x=w.x,r.currentVertex.y=w.y,t=w,w=null):(r.outbound.x=r.inbound.x,r.outbound.y=r.inbound.y,x+=h.wrapDistance-r.distance,
r.distance=h.wrapDistance,v=!0,a=x/u,r.currentVertex.x=(1-a)*t.x+a*w.x,r.currentVertex.y=(1-a)*t.y+a*w.y)}}function q(){r.prevNormal.x=-r.inbound.y;r.prevNormal.y=r.inbound.x;r.nextNormal.x=-r.outbound.y;r.nextNormal.y=r.outbound.x}function m(){q();r.bisector.x=r.prevNormal.x+r.nextNormal.x;r.bisector.y=r.prevNormal.y+r.nextNormal.y;var a=Math.sqrt(r.bisector.x*r.bisector.x+r.bisector.y*r.bisector.y);.001>a?(r.bisector.x=void 0,r.bisector.y=void 0,r.cosine=0,r.sign=void 0):(r.bisector.x/=a,r.bisector.y/=
a,r.cosine=r.bisector.x*r.nextNormal.x+r.bisector.y*r.nextNormal.y,r.sign=0<=r.prevNormal.x*r.nextNormal.y-r.prevNormal.y*r.nextNormal.x?1:-1)}function d(a){p.vertex(r);1===a?(r.leftEntry0=r.entry0,r.leftEntry1=r.entry1,r.leftEntry2=r.entry2,r.leftExit0=r.exit0,r.leftExit1=r.exit1,r.leftExit2=r.exit2):2===a&&(r.rightEntry0=r.entry0,r.rightEntry1=r.entry1,r.rightEntry2=r.entry2,r.rightExit0=r.exit0,r.rightExit1=r.exit1,r.rightExit2=r.exit2)}function c(a){p.vertex(r);1===a?(r.leftEntry0=r.entry0,r.leftEntry2=
r.entry2,r.leftExit0=r.exit0,r.leftExit2=r.exit2):2===a&&(r.rightEntry0=r.entry0,r.rightEntry2=r.entry2,r.rightExit0=r.exit0,r.rightExit2=r.exit2)}Object.defineProperty(b,"__esModule",{value:!0});g=function(){return function(){this.isCap=this.isLastVertex=this.isFirstVertex=this.closed=void 0;this.currentVertex={x:void 0,y:void 0};this.inbound={x:void 0,y:void 0};this.outbound={x:void 0,y:void 0};this.prevNormal={x:void 0,y:void 0};this.nextNormal={x:void 0,y:void 0};this.bisector={x:void 0,y:void 0};
this.leftInner={x:void 0,y:void 0};this.rightInner={x:void 0,y:void 0};this.leftOuter={x:void 0,y:void 0};this.rightOuter={x:void 0,y:void 0}}}();b.TessellationState=g;b.tessellate=function(b,f,k){h.trackDistance=null!=f.trackDistance?f.trackDistance:!1;h.wrapDistance=null!=f.wrapDistance?f.wrapDistance:65535;h.thin=null!=f.thin?f.thin:!1;h.initialDistance=null!=f.initialDistance?f.initialDistance:0;h.enableOuterBisectorSplit=null!=f.enableOuterBisectorSplit?f.enableOuterBisectorSplit:!1;h.outerBisectorAutoSplitThreshold=
null!=f.outerBisectorAutoSplitThreshold?f.outerBisectorAutoSplitThreshold:0;h.enableInnerBisectorSplit=null!=f.enableOuterBisectorSplit?f.enableOuterBisectorSplit:!1;h.innerBisectorAutoSplitThreshold=null!=f.innerBisectorAutoSplitThreshold?f.innerBisectorAutoSplitThreshold:0;e=b;p=k;x=u=n=0;v=!1;w=t=null;r.currentVertex.x=null;r.currentVertex.y=null;r.distance=h.initialDistance;b=e[0];f=e[e.length-1];r.canSplit=!1;r.closed=b.x===f.x&&b.y===f.y;if(!(2>e.length||2===e.length&&r.closed))if(h.thin)if(h.trackDistance)for(a(),
q(),c(1);u-x>h.wrapDistance||n<e.length;)a(),q(),c(2),p.bridge(r),r.leftExit0=r.rightExit0,r.leftExit2=r.rightExit2;else for(;n<e.length;)0<n&&(r.inbound.x=r.outbound.x,r.inbound.y=r.outbound.y),n<e.length-1?(r.outbound.x=e[n+1].x-e[n].x,r.outbound.y=e[n+1].y-e[n].y,b=Math.sqrt(r.outbound.x*r.outbound.x+r.outbound.y*r.outbound.y),r.distance+=b,r.outbound.x/=b,r.outbound.y/=b):(r.outbound.x=r.inbound.x,r.outbound.y=r.inbound.y),0===n&&(r.inbound.x=r.outbound.x,r.inbound.y=r.outbound.y),r.currentVertex.x=
e[n].x,r.currentVertex.y=e[n].y,r.prevNormal.x=-r.inbound.y,r.prevNormal.y=r.inbound.x,r.nextNormal.x=-r.outbound.y,r.nextNormal.y=r.outbound.x,0===n?(p.vertex(r),r.leftEntry0=r.entry0,r.leftEntry2=r.entry2,r.leftExit0=r.exit0,r.leftExit2=r.exit2):(p.vertex(r),r.rightEntry0=r.entry0,r.rightEntry2=r.entry2,r.rightExit0=r.exit0,r.rightExit2=r.exit2,p.bridge(r),r.leftExit0=r.rightExit0,r.leftExit2=r.rightExit2),++n;else{if(h.enableOuterBisectorSplit||0<h.outerBisectorAutoSplitThreshold||h.enableInnerBisectorSplit||
0<h.innerBisectorAutoSplitThreshold)for(r.canSplit=!0,a(),m(),r.splitInner=r.gapInner=r.splitOuter=r.gapOuter=!1,d(1),r.closure0=r.leftEntry0,r.closure1=r.leftEntry1,r.closure2=r.leftEntry2;u-x>h.wrapDistance||n<e.length-1||n<e.length&&(!r.closed||h.trackDistance);)a(),m(),r.splitInner=r.gapInner=r.splitOuter=r.gapOuter=!1,d(2),p.bridge(r),r.leftExit0=r.rightExit0,r.leftExit1=r.rightExit1,r.leftExit2=r.rightExit2;else for(a(),m(),d(1),r.closure0=r.leftEntry0,r.closure1=r.leftEntry1,r.closure2=r.leftEntry2;u-
x>h.wrapDistance||n<e.length-1||n<e.length&&(!r.closed||h.trackDistance);)a(),m(),d(2),p.bridge(r),r.leftExit0=r.rightExit0,r.leftExit1=r.rightExit1,r.leftExit2=r.rightExit2;r.closed&&!h.trackDistance&&(r.rightEntry0=r.closure0,r.rightEntry1=r.closure1,r.rightEntry2=r.closure2,p.bridge(r),r.leftExit0=r.rightExit0,r.leftExit1=r.rightExit1,r.leftExit2=r.rightExit2)}};b.cleanup=function(){p=e=null};b.splitVertex=f;var e,h={},p,n=void 0,u,x,v,t,w,r=new g;g=function(){function a(a,c){this.writeVertex=
a;this.writeTriangle=c;this.capType=l.CapType.BUTT;this.joinType=l.JoinType.MITER;this.miterLimitCosine=k.getLimitCosine(2);this.roundLimitCosine=Math.cos(23*Math.PI/180);this.almostParallelCosine=.97;this.radsPerSlice=.8;this.joinOnUTurn=this.textured=!1}a.prototype.vertex=function(a){var c=this.joinType===l.JoinType.MITER?this.miterLimitCosine:this.roundLimitCosine,b=a.isCap&&this.capType!==l.CapType.BUTT,e=!1;a.cosine>this.almostParallelCosine?(a.exit0=a.entry0=this.writeVertex(a.currentVertex.x,
a.currentVertex.y,0,0,a.bisector.x/a.cosine,a.bisector.y/a.cosine,0,-1,a.distance),a.exit2=a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.bisector.x/a.cosine,-a.bisector.y/a.cosine,0,1,a.distance)):a.cosine<1-this.almostParallelCosine?(e=!a.isCap&&this.joinOnUTurn,a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.prevNormal.x,a.prevNormal.y,0,-1,a.distance),a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.prevNormal.x,-a.prevNormal.y,0,1,
a.distance),a.exit0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.nextNormal.x,a.nextNormal.y,0,-1,a.distance),a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.nextNormal.x,-a.nextNormal.y,0,1,a.distance)):a.canSplit?(f(),0<a.sign?(a.splitInner?(a.exit0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.outbound.x,a.outbound.y,a.leftInner.x,a.leftInner.y,0,-1,a.distance),a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.inbound.x,a.inbound.y,a.rightInner.x,
a.rightInner.y,0,-1,a.distance)):a.exit0=a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.inbound.x,a.inbound.y,a.bisector.x/a.cosine,a.bisector.y/a.cosine,0,-1,a.distance),a.cosine<c?(e=!a.isCap,a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.prevNormal.x,-a.prevNormal.y,0,1,a.distance),a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.nextNormal.x,-a.nextNormal.y,0,1,a.distance)):a.splitOuter?(e=e||a.gapOuter,a.entry2=this.writeVertex(a.currentVertex.x,
a.currentVertex.y,a.inbound.x,a.inbound.y,-a.leftOuter.x,-a.leftOuter.y,0,1,a.distance),a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.outbound.x,a.outbound.y,-a.rightOuter.x,-a.rightOuter.y,0,1,a.distance)):a.entry2=a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.bisector.x/a.cosine,-a.bisector.y/a.cosine,0,1,a.distance)):(a.splitInner?(a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.outbound.x,a.outbound.y,-a.leftInner.x,-a.leftInner.y,0,1,a.distance),
a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.inbound.x,a.inbound.y,-a.rightInner.x,-a.rightInner.y,0,1,a.distance)):a.exit2=a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.bisector.x/a.cosine,-a.bisector.y/a.cosine,0,1,a.distance),a.cosine<c?(e=!a.isCap,a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.prevNormal.x,a.prevNormal.y,0,-1,a.distance),a.exit0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.nextNormal.x,a.nextNormal.y,
0,-1,a.distance)):a.splitOuter?(e=e||a.gapOuter,a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.inbound.x,a.inbound.y,a.leftOuter.x,a.leftOuter.y,0,-1,a.distance),a.exit0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.outbound.x,a.outbound.y,a.rightOuter.x,a.rightOuter.y,0,-1,a.distance)):a.exit0=a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.bisector.x/a.cosine,a.bisector.y/a.cosine,0,-1,a.distance))):0<a.sign?(a.exit0=a.entry0=this.writeVertex(a.currentVertex.x,
a.currentVertex.y,a.inbound.x,a.inbound.y,a.bisector.x/a.cosine,a.bisector.y/a.cosine,0,-1,a.distance),a.cosine<c?(e=!a.isCap,a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.prevNormal.x,-a.prevNormal.y,0,1,a.distance),a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.nextNormal.x,-a.nextNormal.y,0,1,a.distance)):a.entry2=a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.bisector.x/a.cosine,-a.bisector.y/a.cosine,0,1,a.distance)):(a.exit2=a.entry2=
this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.bisector.x/a.cosine,-a.bisector.y/a.cosine,0,1,a.distance),a.cosine<c?(e=!a.isCap,a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.prevNormal.x,a.prevNormal.y,0,-1,a.distance),a.exit0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.nextNormal.x,a.nextNormal.y,0,-1,a.distance)):a.exit0=a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.bisector.x/a.cosine,a.bisector.y/a.cosine,0,-1,a.distance));
c=a.canSplit&&(a.splitInner||a.splitOuter)||e||b?a.entry1=a.exit1=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,0,0,0,0,a.distance):a.entry1=a.exit1=null;if(e&&this.joinType!==l.JoinType.ROUND)this.writeTriangle(c,0<a.sign?a.exit2:a.entry0,0<a.sign?a.entry2:a.exit0);else if(b&&this.capType===l.CapType.ROUND||e&&this.joinType===l.JoinType.ROUND){var d=e=b=void 0,h=void 0,n=void 0,m=void 0;if(a.isCap){var p=Math.PI,n=Math.ceil(p/this.radsPerSlice),m=p/n;a.isFirstVertex?(b=a.prevNormal.x,
e=a.prevNormal.y,d=a.entry0,h=a.entry2):a.isLastVertex&&(b=-a.nextNormal.x,e=-a.nextNormal.y,d=a.exit2,h=a.exit0)}else p=2*Math.acos(a.cosine),n=Math.ceil(p/this.radsPerSlice),m=p/n,b=0<a.sign?-a.prevNormal.x:a.nextNormal.x,e=0<a.sign?-a.prevNormal.y:a.nextNormal.y,d=0<a.sign?a.entry2:a.exit0,h=0<a.sign?a.exit2:a.entry0;for(var p=Math.cos(m),m=Math.sin(m),k=m*b+p*e,b=p*b-m*e,e=k,g,k=void 0,q=0;q<n;++q)g=k,q<n-1&&(k=a.isCap?this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,b,e,a.isFirstVertex?
-1:1,0,a.distance):this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,b,e,0,a.sign,a.distance)),this.writeTriangle(0===q?d:g,c,q===n-1?h:k),g=m*b+p*e,b=p*b-m*e,e=g}else b&&this.capType===l.CapType.SQUARE&&(b=a.isFirstVertex?1:-1,d=e=void 0,this.textured?(e=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.prevNormal.x-b*a.inbound.x,a.prevNormal.y-b*a.inbound.y,-b,-1,a.distance),d=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.prevNormal.x-b*a.inbound.x,-a.prevNormal.y-
b*a.inbound.y,-b,1,a.distance)):(e=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.prevNormal.x-b*a.inbound.x,a.prevNormal.y-b*a.inbound.y,0,-1,a.distance),d=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.prevNormal.x-b*a.inbound.x,-a.prevNormal.y-b*a.inbound.y,0,1,a.distance)),0<b?(this.writeTriangle(c,a.entry2,d),this.writeTriangle(c,d,e),this.writeTriangle(c,e,a.entry0)):(this.writeTriangle(c,d,a.exit2),this.writeTriangle(c,e,d),this.writeTriangle(c,a.exit0,e)))};a.prototype.bridge=
function(a){this.writeTriangle(a.leftExit0,a.rightEntry0,null!=a.leftExit1?a.leftExit1:a.leftExit2);this.writeTriangle(a.rightEntry0,null!=a.rightEntry1?a.rightEntry1:a.rightEntry2,null!=a.leftExit1?a.leftExit1:a.leftExit2);null!=a.leftExit1&&null!=a.rightEntry1?(this.writeTriangle(a.leftExit1,a.rightEntry1,a.leftExit2),this.writeTriangle(a.rightEntry1,a.rightEntry2,a.leftExit2)):null!=a.leftExit1?this.writeTriangle(a.leftExit1,a.rightEntry2,a.leftExit2):null!=a.rightEntry1&&this.writeTriangle(a.rightEntry1,
a.rightEntry2,a.leftExit2)};return a}();b.StandardTessellationCallbacks=g;g=function(){function a(a,c){this.writeVertex=a;this.writeTriangle=c}a.prototype.vertex=function(a){a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.prevNormal.x,a.prevNormal.y,0,-1,a.distance);a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.prevNormal.x,-a.prevNormal.y,0,1,a.distance);a.exit0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.nextNormal.x,a.nextNormal.y,0,-1,
a.distance);a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.nextNormal.x,-a.nextNormal.y,0,1,a.distance)};a.prototype.bridge=function(a){this.writeTriangle(a.leftExit0,a.rightEntry0,a.leftExit2);this.writeTriangle(a.rightEntry0,a.rightEntry2,a.leftExit2)};return a}();b.ThinTessellationCallbacks=g})},"esri/views/2d/engine/webgl/mesh/factories/matcherUtils":function(){define("require exports ../../../../../../core/tsSupport/generatorHelper ../../../../../../core/tsSupport/awaiterHelper ../../../../../../core/Error ../../../../../../core/Logger ../../util/Matcher".split(" "),
function(g,b,l,k,f,a,q){Object.defineProperty(b,"__esModule",{value:!0});var m=a.getLogger("esri/views/2d/engine/webgl/mesh/factories/matcherUtils");b.createMatcher=function(a,c,b){return k(this,void 0,void 0,function(){return l(this,function(e){if(!b)return[2,new q.GraphicMatcher(a)];switch(b.type){case "simple":case "dot-density":return[2,q.FeatureMatcher.fromBasicRenderer(b,a,c)];case "unique-value":return[2,q.MapMatcher.fromUVRenderer(b,a,c)];case "class-breaks":return[2,q.IntervalMatcher.fromCBRenderer(b,
a,c)];case "dictionary":return[2,q.DictionaryMatcher.fromDictionaryRenderer(b,a,c)];default:return m.error(new f("mapview-mesh:invalid-renderer","Unable to handle unknown renderer type")),[2,null]}})})}})},"esri/views/2d/engine/webgl/util/Matcher":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/tsSupport/generatorHelper ../../../../../core/tsSupport/awaiterHelper ../../../../../core/tsSupport/assignHelper ../../../../../core/Error ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../support/arcadeOnDemand ../../../../../symbols/support/cimSymbolUtils ../../../arcade/utils".split(" "),
function(g,b,l,k,f,a,q,m,d,c,e,h,p){function n(a,c){return f(this,void 0,void 0,function(){var b,d;return k(this,function(h){switch(h.label){case 0:return b=a||1,"number"===typeof b?[2,function(a,c,e){return b}]:[4,e.createRendererExpression(b,c.spatialReference,c.fields)];case 1:return d=h.sent(),[2,function(a,b,e){return p.callWithFeature(d,a,{$view:e},c.geometryType,b)||1}]}})})}Object.defineProperty(b,"__esModule",{value:!0});var u=m.getLogger("esri/views/2d/engine/webgl/util/Matcher");g=function(){function a(){this._defaultResult=
null}a.fromBasicRenderer=function(c,b,e){return f(this,void 0,void 0,function(){var d,n,f;return k(this,function(m){switch(m.label){case 0:return[4,h.expandSymbols(c.getSymbols(),c,e)];case 1:return d=m.sent(),n=new a,d.length?[4,b.createTemplateGroup(d[0],null,c)]:[3,3];case 2:f=m.sent(),n.setDefault(f),m.label=3;case 3:return[2,n]}})})};a.prototype.size=function(){return 1};a.prototype.getDefault=function(){return this._defaultResult};a.prototype.setDefault=function(a){this._defaultResult=a};a.prototype.match=
function(a,c,b,e,d){return this.getDefault()};a.prototype.analyze=function(a,c,b,e,d){return f(this,void 0,void 0,function(){return k(this,function(a){return[2]})})};return a}();b.FeatureMatcher=g;m=function(a){function b(c,b,e,d){var h=a.call(this)||this;h._intervals=[];h._isMaxInclusive=b;d?h._getValue=p.callWithFeature.bind(null,d):c&&c.length?"function"===typeof c?(h._field=null,h._getValue=c):(h._field=c,h._normalizationInfo=e,h._getValue=h._getValueFromField.bind(h)):h._field=null;return h}
l(b,a);b.fromCBRenderer=function(a,d,n){return f(this,void 0,void 0,function(){var m,p,l,g,q,r,t,u,w,v,x,K,I,N=this;return k(this,function(y){switch(y.label){case 0:return m=a.isMaxInclusive,p=a.normalizationField,l=a.normalizationTotal,g=a.normalizationType,q=a.field,r={normalizationField:p,normalizationTotal:l,normalizationType:g},(w=t=a.valueExpression)?[4,e.createRendererExpression(t,n.spatialReference,n.fields)]:[3,2];case 1:w=y.sent(),y.label=2;case 2:return u=w,v=new b(q,m,r,u),[4,h.expandSymbol(a.backgroundFillSymbol,
a,n)];case 3:return x=y.sent(),[4,c.all(a.classBreakInfos.map(function(c){return f(N,void 0,void 0,function(){var b,e,f;return k(this,function(m){switch(m.label){case 0:return[4,h.expandSymbol(c.symbol,a,n)];case 1:return b=m.sent(),[4,d.createTemplateGroup(b,x,a)];case 2:return e=m.sent(),f={min:c.minValue,max:c.maxValue},v.add(f,e),[2]}})})}))];case 4:return y.sent(),[4,h.expandSymbol(a.defaultSymbol,a,n)];case 5:return(K=y.sent())?[4,d.createTemplateGroup(K,x,a)]:[3,7];case 6:I=y.sent(),v.setDefault(I),
y.label=7;case 7:return[2,v]}})})};b.prototype.add=function(a,c){this._intervals.push({interval:a,result:c});this._intervals.sort(function(a,c){return a.interval.min-c.interval.min})};b.prototype.size=function(){return a.prototype.size.call(this)+this._intervals.length};b.prototype.match=function(a,c,b,e,d){if(!this._getValue)return this.getDefault();a=this._getValue(c,{$view:d},b,e);if(!a&&(null===a||void 0===a||isNaN(a)))return this.getDefault();for(c=0;c<this._intervals.length;c++)if(e=this._intervals[c],
b=e.interval,e=e.result,d=this._isMaxInclusive?a<=b.max:a<b.max,a>=b.min&&d)return e;return this.getDefault()};b.prototype._needsNormalization=function(){var a=this._normalizationInfo;return a&&(a.normalizationField||a.normalizationTotal||a.normalizationType)};b.prototype._getValueFromField=function(a){var c=a.attributes[this._field];if(!this._needsNormalization())return c;var b=this._normalizationInfo,e=b.normalizationField,d=b.normalizationTotal,b=b.normalizationType;a=!!e&&a.attributes[e];if(b)switch(b){case "field":return(a||
void 0)&&c/a;case "log":return Math.log(c)*Math.LOG10E;case "percent-of-total":return c/d*100;default:u.error("Found unknown normalization type: "+b)}else u.error("Normalization is required, but no type was set!")};return b}(g);b.IntervalMatcher=m;m=function(a){function b(c,b,e){var d=a.call(this)||this;d._nullResult=null;d._resultsMap=new Map;e?d._getValue=p.callWithFeature.bind(null,e):c&&c.length?"function"===typeof c[0]?(d._fields=null,d._getValue=c[0]):(d._fields=c,d._seperator=b||"",d._getValue=
d._getValueFromFields.bind(d)):d._fields=null;return d}l(b,a);b.fromUVRenderer=function(a,d,n){return f(this,void 0,void 0,function(){var m,p,l,g,q,r,t,u,w,v,x=this;return k(this,function(y){switch(y.label){case 0:return m=a.uniqueValueInfos,p=a.fieldDelimiter,l=[a.field],g=a.valueExpression,a.field2&&l.push(a.field2),a.field3&&l.push(a.field3),[4,h.expandSymbol(a.backgroundFillSymbol,a,n)];case 1:return q=y.sent(),(t=g)?[4,e.createRendererExpression(g,n.spatialReference,n.fields)]:[3,3];case 2:t=
y.sent(),y.label=3;case 3:return r=t,u=new b(l,p,r),[4,c.all(m.map(function(c){return f(x,void 0,void 0,function(){var b,e;return k(this,function(f){switch(f.label){case 0:return[4,h.expandSymbol(c.symbol,a,n)];case 1:return b=f.sent(),[4,d.createTemplateGroup(b,q,a)];case 2:return e=f.sent(),"\x3cNull\x3e"===c.value?u.setNullResult(e):u.add(c.value,e),[2]}})})}))];case 4:return y.sent(),[4,h.expandSymbol(a.defaultSymbol,a,n)];case 5:return(w=y.sent())?[4,d.createTemplateGroup(a.defaultSymbol,q,a)]:
[3,7];case 6:v=y.sent(),u.setDefault(v),y.label=7;case 7:return[2,u]}})})};b.prototype.setNullResult=function(a){this._nullResult=a};b.prototype.add=function(a,c){this._resultsMap.set(a.toString(),c)};b.prototype.size=function(){return a.prototype.size.call(this)+this._resultsMap.size};b.prototype.match=function(a,c,b,e,d){if(!this._getValue)return this.getDefault();a=this._getValue(c,{$view:d},b,e);if(null!==this._nullResult&&(null==a||""===a||"\x3cNull\x3e"===a))return this._nullResult;if(!a&&null==
a)return this.getDefault();a=a.toString();return this._resultsMap.has(a)?this._resultsMap.get(a):this.getDefault()};b.prototype._getValueFromFields=function(a){for(var c=[],b=0,e=this._fields;b<e.length;b++)c.push(a.attributes[e[b]]);return c.join(this._seperator)};return b}(g);b.MapMatcher=m;m=function(b){function e(a,c,e,d){var h=b.call(this)||this;h._fidToAttributeHash=new Map;h._attributeHashToGroup=new Map;h._renderer=a;h._fieldMap=a.fieldMap;h._templates=c;h._info=e;h._scaleFn=d;return h}l(e,
b);e.fromDictionaryRenderer=function(a,c,b){return f(this,void 0,void 0,function(){var d;return k(this,function(h){switch(h.label){case 0:return a.fetchResources({spatialReference:b.spatialReference,fields:b.fields}),[4,n(a.scaleExpression,b)];case 1:return d=h.sent(),[2,new e(a,c,b,d)]}})})};e.prototype._analyzeFeature=function(c,b,e,d,n){return f(this,void 0,void 0,function(){var f,m,p,l,g,r,t,w,v,x,y,A;return k(this,function(k){switch(k.label){case 0:f=c.attributes[b];m=this._fidToAttributeHash.get(f);
p=this._hashAttributes(c);if(m===p)return[2];if(l=this._attributeHashToGroup.has(p))return[3,4];g=a({},d,{spatialReference:this._info.spatialReference,abortOptions:n,fields:this._info.fields});r=this._scaleFn(c,e,d);return[4,this._renderer.getSymbolAsync(c,g)];case 1:return t=k.sent(),[4,h.expandSymbol(t,this._renderer,this._info,n)];case 2:w=k.sent();if("expanded-cim"!==w.type)return u.error(new q("mapview-bad-type","Found unexpected type "+w.type+" in dictionary response")),[2];v=0;for(x=w.layers;v<
x.length;v++)y=x[v],y.scaleFactor=r,y.templateHash+="-"+r;return[4,this._templates.createTemplateGroup(w,null,this._renderer)];case 3:A=k.sent(),this._attributeHashToGroup.set(p,A),k.label=4;case 4:return this._fidToAttributeHash.set(f,p),[2]}})})};e.prototype.analyze=function(a,b,e,d,h){return f(this,void 0,void 0,function(){var n,f=this;return k(this,function(m){switch(m.label){case 0:return n=b.map(function(c){return f._analyzeFeature(c,a,e,d,h)}),[4,c.all(n)];case 1:return m.sent(),[2]}})})};
e.prototype.match=function(a,c){a=this._fidToAttributeHash.get(c.attributes[a]);return this._attributeHashToGroup.get(a)};e.prototype._hashAttributes=function(a){var c="",b;for(b in this._fieldMap)c+=". "+a.attributes[this._fieldMap[b]];return c};return e}(g);b.DictionaryMatcher=m;g=function(a){function c(c){var b=a.call(this)||this;b._templates=c;return b}l(c,a);c.prototype.match=function(a,c){return d.isNone(c.symbol)?0:c.groupId?c.groupId:this._templates.createTemplateGroup(c.symbol,null,null)};
return c}(g);b.GraphicMatcher=g})},"esri/views/2d/engine/webgl/mesh/factories/WGLMeshFactory":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/tsSupport/generatorHelper ../../../../../../core/tsSupport/awaiterHelper ../../../../../../core/Error ../../../../../../core/has ../../../../../../core/Logger ../../../../../../core/maybe ../../../../../../core/promiseUtils ../../../../../../geometry/support/jsonUtils ../../../../../../symbols/SimpleLineSymbol ../../definitions ../../enums ../../WGLDisplayObject ../MeshData ../VertexVector ../templates/WGLLabelTemplate ../templates/WGLLineTemplate ../templates/WGLMarkerTemplate ../templates/WGLTemplateStore".split(" "),
function(g,b,l,k,f,a,q,m,d,c,e,h,p,n,u,x,v,t,w,r,y){Object.defineProperty(b,"__esModule",{value:!0});var A=m.getLogger("esri.views.2d.engine.webgl.WGLMeshFactory"),z={esriGeometryPoint:"above-right above-center above-left center-center center-left center-right below-center below-left below-right".split(" "),esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along"],esriGeometryMultipoint:null,esriGeometryEnvelope:null};g=function(){function b(a,c,b,e,h,n){this._isDD=!1;this._labelsDebugTemplate=
null;this._isDD=d.isSome(b)&&"dot-density"===b.type;this._geometryType=a;this._idField=c;this._templateStore=e;this._setLabelTemplates(h,b,n)}b.prototype.update=function(a,c,b){this._isDD=d.isSome(c)&&"dot-density"===c.type;this._setLabelTemplates(a,c,b)};b.prototype._setLabelTemplates=function(a,c,b){a&&this._validateLabelingInfo(a)&&(this._labelTemplates=a.map(function(a){return t.default.fromLabelClass(c,a,b)}))};Object.defineProperty(b.prototype,"templates",{get:function(){return this._templateStore},
enumerable:!0,configurable:!0});b.prototype.createMeshData=function(a){var c=Array(5),b=this._labelTemplates&&0<this._labelTemplates.length,e="esriGeometryPolyline"===this._geometryType?p.HEURISTIC_GLYPHS_PER_LINE:p.HEURISTIC_GLYPHS_PER_FEATURE;c[n.WGLGeometryType.MARKER]=new v.VertexVectors(n.WGLGeometryType.MARKER,a);c[n.WGLGeometryType.FILL]=new v.VertexVectors(n.WGLGeometryType.FILL,a,this._isDD);c[n.WGLGeometryType.LINE]=new v.VertexVectors(n.WGLGeometryType.LINE,a);c[n.WGLGeometryType.TEXT]=
new v.VertexVectors(n.WGLGeometryType.TEXT,a);c[n.WGLGeometryType.LABEL]=new v.VertexVectors(n.WGLGeometryType.LABEL,b?e:0);return new x.MeshData([],c)};b.prototype.analyze=function(a,b,e,h,n){return f(this,void 0,void 0,function(){var f,m,p,l,g,q,r,t,u;return k(this,function(k){switch(k.label){case 0:return f=a,c.isAborted(n)?[2,[]]:d.isSome(b)?[4,b.analyze(this._idField,a,e,h,n)]:[3,2];case 1:k.sent(),k.label=2;case 2:m=0;for(p=f;m<p.length;m++){l=p[m];g=l.groupId;if(null==g||-1===g)g=b.match(this._idField,
l,this._geometryType,e,h);if(y.isDynamicId(g))for(q=this._templateStore.getDynamicTemplateGroup(g),r=0,t=q;r<t.length;r++)(u=t[r])&&u.analyze&&u.analyze(this._templateStore,l,e,h);l.groupId=g}return[2,this._templateStore.finalize(n).then(function(){return f})]}})})};b.prototype.write=function(a,c,b,h,n,f){var m=this._templateStore.getTemplateGroup(c.groupId),p=c.localId;if(null!=p){var k=new u(p);if(y.isDynamicId(c.groupId))for(var l=0;l<m.length;l++){var g=m[l];g.bindFeature(c,b,h)}if(m&&(c.geometry||
c.centroid)){b=k.displayRecords;g=c.insertAfter;void 0!==g&&(k.insertAfter=g);(h=this._geometryType)||(h=null!=c.centroid?"esriGeometryPolygon":e.getJsonType(c.geometry));for(l=0;l<m.length;l++){var g=m[l],q=a.get(g.geometryType);g.writeMesh(b,q,h,p,c)}d.isSome(f)&&(m=f&&this._findLabelRef(m),this._writeLabels(k,a,p,c,f,m,n));a.pushDisplayObject(k)}}};b.prototype._hasBadLabelClass=function(c,b){var e=c.labelPlacement,d=z[b];if(!c.symbol)return A.warn("No LabelClass symbol specified."),!0;if(!d)return A.error(new a("mapview-labeling:unsupported-geometry-type",
"Unable to create labels for Feature Layer, "+b+" is not supported")),!0;d.some(function(a){return a===e})||(d=d[0],e&&A.warn("Found invalid label placement type "+e+" for "+b+". Defaulting to "+d),c.labelPlacement=d);return!1};b.prototype._validateLabelingInfo=function(a){var c=this;return!a.some(function(a){return c._hasBadLabelClass(a,c._geometryType)})};b.prototype._findLabelRef=function(a){for(var c=0;c<a.length;c++){var b=a[c];if(b instanceof r.default)return b}return null};b.prototype._writeLabels=
function(a,c,b,e,h,n,f){for(var m=a.displayRecords,k=[],l=0;l<h.length;l++){var g=h[l];if(d.isSome(g)){var q=g.glyphs,r=g.rtl,g=this._labelTemplates[g.classIndex],t=c.get(g.geometryType);g.bindReferenceTemplate(n);g.bindTextInfo(q,r);g.writeMesh(m,t,this._geometryType,b,e,f,k)}}a.metrics=k;p.DEBUG_LABELS&&this._debugLabels(a,c)};b.prototype._debugLabels=function(a,c){var b=a.displayRecords,e=a.id,d=0;for(a=a.metrics;d<a.length;d++)for(var h=a[d],n=0,f=h.boxes?h.boxes.concat([h.bounds]):[h.bounds];n<
f.length;n++){var m=f[n],m={geometry:{paths:[[[h.anchor[0]+h.offsetX+m.center[0]-m.width/2,h.anchor[1]+h.offsetY+m.center[1]+m.height/2],[0,-m.height],[m.width,0],[0,m.height],[-m.width,0]]]},attributes:{}},p=this._getLabelDebugTemplate(),k=c.get(p.geometryType);p.writeMesh(b,k,"esriGeometryPolyline",e,m)}};b.prototype._getLabelDebugTemplate=function(){this._labelsDebugTemplate||(this._labelsDebugTemplate=this._createLabelsDebugTemplate());return this._labelsDebugTemplate};b.prototype._createLabelsDebugTemplate=
function(){var a=new h({style:"solid",width:1,color:[255,0,0,1]});return w.default.fromSimpleLine(null,!1,a,null,!1)};return b}();b.WGLMeshFactory=g})},"esri/views/2d/engine/webgl/WGLDisplayObject":function(){define(["require","exports","./WGLDisplayRecord","./collisions/Metric","./util/serializationUtils"],function(g,b,l,k,f){return function(){function a(a){this.insertAfter=null;this.id=a;this.displayRecords=[];this.metrics=[]}a.prototype.copy=function(){var b=new a(this.id);b.set(this);return b};
a.prototype.clone=function(){var b=new a(this.id);b.displayRecords=this.displayRecords.map(function(a){return a.clone()});b.metrics=this.metrics.map(function(a){return a.clone()});b.insertAfter=this.insertAfter;return b};a.prototype.set=function(a){this.id=a.id;this.displayRecords=a.displayRecords;this.metrics=a.metrics;this.insertAfter=a.insertAfter};a.prototype.serialize=function(a){a.push(this.id);f.serializeList(a,this.metrics);f.serializeList(a,this.displayRecords);return a};a.deserialize=function(b){var m=
b.readInt32(),d=new a(m),m={id:m},c=f.deserializeList(b,k.default);c.length&&(d.metrics=c);d.displayRecords=f.deserializeList(b,l,m);return d};return a}()})},"esri/views/2d/engine/webgl/mesh/MeshData":function(){define(["require","exports","../util/serializationUtils","../util/Writer"],function(g,b,l,k){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(a,b){this.displayObjects=a;this.vertexVectorsMap=b}Object.defineProperty(b.prototype,"vertexBuffersMap",{get:function(){if(!this._vertexBuffersMap){this._vertexBuffersMap=
{};for(var a=0;a<this.vertexVectorsMap.length;a++)this._vertexBuffersMap[a]=this.vertexVectorsMap[a].intoBuffers();this.vertexVectorsMap=null}return this._vertexBuffersMap},enumerable:!0,configurable:!0});b.prototype.get=function(a){return this.vertexVectorsMap[a]};b.prototype.pushDisplayObject=function(a){this.displayObjects.push(a)};b.prototype.encode=function(a,b){var f=l.serializeList(new k.default(Uint32Array,this._guessSize()),this.displayObjects).buffer(),d={};b.push(f);for(var c=0;c<this.vertexVectorsMap.length;c++){var e=
this.vertexVectorsMap[c];d[c]={};e.transfer(d[c],b)}a.displayObjects=f;a.vertexBuffersMap=d;this.destroy()};b.prototype.destroy=function(){this.displayObjects=this.vertexVectorsMap=null};b.prototype._guessSize=function(){for(var a=this.displayObjects,b=Math.min(a.length,4),f=0,d=0;d<b;d++)f=Math.max(f,a[d].displayRecords.length);return 2*(12*a.length+a.length*f*40)};return b}();b.MeshData=g})},"esri/views/2d/engine/webgl/util/Writer":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,
"__esModule",{value:!0});g=function(){function b(b,f){this._pos=0;f=f?this._roundToNearest(f,b.BYTES_PER_ELEMENT):40;this._array=new ArrayBuffer(f);this._buffer=new b(this._array);this._ctor=b}Object.defineProperty(b.prototype,"length",{get:function(){return this._pos},enumerable:!0,configurable:!0});b.prototype._roundToNearest=function(b,f){b=Math.round(b);return b+(f-b%f)};b.prototype._ensureSize=function(b){if(this._pos+b>=this._buffer.length){b=this._roundToNearest(1.5*(this._array.byteLength+
b*this._buffer.BYTES_PER_ELEMENT),this._buffer.BYTES_PER_ELEMENT);b=new ArrayBuffer(b);var f=new this._ctor(b);f.set(this._buffer,0);this._array=b;this._buffer=f}};b.prototype.writeF32=function(b){this._ensureSize(1);var f=this._pos;(new Float32Array(this._array,4*this._pos,1))[0]=b;this._pos++;return f};b.prototype.push=function(b){this._ensureSize(1);var f=this._pos;this._buffer[this._pos++]=b;return f};b.prototype.writeRegion=function(b){this._ensureSize(b.length);var f=this._pos;this._buffer.set(b,
this._pos);this._pos+=b.length;return f};b.prototype.buffer=function(){var b=this._array.slice(0,4*this._pos);this.destroy();return b};b.prototype.seek=function(b){this._pos=b};b.prototype.destroy=function(){this._buffer=this._array=null};return b}();b.default=g})},"esri/views/2d/engine/webgl/mesh/VertexVector":function(){define(["require","exports","../Utils","./VertexBuffer","../util/Writer"],function(g,b,l,k,f){Object.defineProperty(b,"__esModule",{value:!0});var a=function(){function a(a,b){this.data=
a;this.stride=b}Object.defineProperty(a.prototype,"vertexCount",{get:function(){return this.data.length/(this.stride/4)},enumerable:!0,configurable:!0});a.prototype.transfer=function(a,b){var c=this.data.buffer();a.vertexCount=this.vertexCount;a.data=c;a.stride=this.stride;b.push(c)};return a}();b.default=a;g=function(){function b(b,d,c){void 0===c&&(c=!1);this.geometryType=b;this.indexVector=new f.default(Uint32Array,d);this.namedVectors={};b=l.getStrides(b,c);for(var e in b){c=b[e];var h=void 0;
switch(c%4){case 0:case 2:h=new f.default(Uint32Array,c/4*d);break;case 1:case 3:h=new f.default(Uint8Array,c*d)}this.namedVectors[e]=new a(h,c)}}b.prototype.get=function(a){return this.namedVectors[a].data};b.prototype.getVector=function(a){return this.namedVectors[a]};b.prototype.transfer=function(a,b){var c=this.indexVector.buffer(),e={};b.push(c);for(var d in this.namedVectors){var f=this.namedVectors[d];e[d]={};f.transfer(e[d],b)}a.geometryType=this.geometryType;a.indexBuffer=c;a.namedBuffers=
e;this.destroy()};b.prototype.intoBuffers=function(){var a=k.VertexBuffers.fromVertexVectors(this);this.destroy();return a};b.prototype.destroy=function(){this.namedVectors=this.indexVector=null};return b}();b.VertexVectors=g})},"esri/views/2d/engine/webgl/mesh/VertexBuffer":function(){define(["require","exports","../Utils"],function(g,b,l){Object.defineProperty(b,"__esModule",{value:!0});var k=function(){function b(a,b,f){this.data=a;this.stride=b;this.vertexCount=f}b.decode=function(a){var f=l.allocateTypedArrayBufferwithData(a.data,
a.stride);return new b(f,a.stride,a.vertexCount)};b.fromVertexVector=function(a){var f=l.allocateTypedArrayBufferwithData(a.data.buffer(),a.stride);return new b(f,a.stride,a.vertexCount)};return b}();b.default=k;g=function(){function b(a,b,f){this.geometryType=a;this.indexBuffer=new Uint32Array(b);this.namedBuffers=f}b.decode=function(a){var f=a.geometryType,m=a.indexBuffer,d={},c;for(c in a.namedBuffers)d[c]=k.decode(a.namedBuffers[c]);return new b(f,m,d)};b.fromVertexVectors=function(a){var f=a.geometryType,
m=a.indexVector.buffer(),d={},c;for(c in a.namedVectors)d[c]=k.fromVertexVector(a.namedVectors[c]);return new b(f,m,d)};return b}();b.VertexBuffers=g})},"esri/views/2d/engine/webgl/mesh/templates/WGLLineTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Logger ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../color ../../number ../../Utils ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLMeshTemplate".split(" "),
function(g,b,l,k,f,a,q,m,d,c,e,h,p){Object.defineProperty(b,"__esModule",{value:!0});var n=k.getLogger("esri.views.2d.engine.webgl.WGLLineTemplate");g=function(b){function h(a,d,h,n,f,m,p,k,g,l,q,u,x,G,J,K){var r=b.call(this)||this;a=c.LineMaterialKey.load(c.createMaterialKey(r.geometryType,a,x));d&&(a.sdf=d.sdf,a.pattern=!0,a.textureBinding=d.textureBinding);r._capType=n;r._joinType=f;r._miterLimitCosine=e.getLimitCosine(m);r.tessellationProperties._fillColor=p;r.tessellationProperties._tl=k;r.tessellationProperties._br=
g;r._hasPattern=l;r._isDashed=q;r._joinOnUTurn=K;r._isColorLocked=u;r._isOutline=x;r._zOrder=J;r._materialKey=a.data;r.tessellationProperties._bitset=u?1:0;r.tessellationProperties._halfWidth=.5*h;r.tessellationProperties._halfReferenceWidth=.5*G;r._initializeTessellator(!1);return r}l(h,b);h.fromCIMLine=function(c,b,e,d,n){var p=b.color,k=b.scaleFactor||1,g=b.isDashed,l=b.cap;g&&l===a.CapType.ROUND&&(l=a.CapType.SQUARE);var r=b.join,k=f.pt2px(b.width)*k,t=f.pt2px(b.referenceWidth),u=f.pt2px(b.miterLimit),
p=p&&q.premultiplyAlphaRGBA(p)||0;if(!e)return new h(c,e,k,l,r,u,p,0,0,!1,g,b.colorLocked,d,t,b.zOrder,n);var w=e.rect,v=w.x+1+e.width,x=w.y+1+e.height,w=m.i1616to32(w.x+1,w.y+1),v=m.i1616to32(v,x);return new h(c,e,k,l,r,u,p,w,v,!0,g,b.colorLocked,d,t,b.zOrder,n)};h.fromSimpleLine=function(a,c,b,e,n){var p=b.color,k="solid"!==b.style&&"none"!==b.style,g=d.getCapType(b.cap||"round",k),l=d.getJoinType(b.join||"round"),p=p&&"none"!==b.style&&q.premultiplyAlphaRGBA(p)||0;"none"===b.style&&(p=0);var r=
f.pt2px(b.width);b=b.miterLimit;if(!e)return new h(a,e,r,g,l,b,p,0,0,!1,k,!1,c,r,0,n);var t=e.rect,u=t.x+1+e.width,w=t.y+1+e.height,t=m.i1616to32(t.x+1,t.y+1),u=m.i1616to32(u,w);return new h(a,e,r,g,l,b,p,t,u,!0,k,!1,c,r,0,n)};h.fromPictureLineSymbol=function(a,c,b,e){n.error("PictureLineSymbol support does not exist!");return null};return h}(h.default(p.default));b.default=g})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseLineTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/has ../../../../../../core/Logger ../../definitions ../../enums ../../number ../../TileClipper ../../TurboLine ../../WGLDisplayRecord ../../materialKey/MaterialKey".split(" "),
function(g,b,l,k,f,a,q,m,d,c,e,h){Object.defineProperty(b,"__esModule",{value:!0});var p=f.getLogger("esri.views.2d.engine.webgl.WGLLineTemplateBase"),n=a.TILE_SIZE+16,u=1/3.8,x=new d.TileClipper(0,0,0,1,16);x.setExtent(a.TILE_SIZE);var v=new Uint32Array(9),t=new Uint32Array(36),w=new Uint32Array(3),r=new Uint32Array(6),y=function(a){return function(c){var b=Math.ceil(1024*a._halfWidth),e=Math.ceil(1024*a._halfReferenceWidth);c.entry0=a.offset+a.vertexCount++;var d=m.i1616to32(c.distance,b),h=m.i8888to32(Math.round(31*
c.prevNormal.x),Math.round(31*c.prevNormal.y),Math.round(0),Math.round(-31)),n=m.i8888to32(0,0,0,a._bitset);t[0]=m.i1616to32(c.currentVertex.x,c.currentVertex.y);t[1]=a.id;t[2]=a._fillColor;t[3]=h;t[4]=d;t[5]=a._tl;t[6]=a._br;t[7]=n;t[8]=m.i1616to32(e,0);c.entry2=a.offset+a.vertexCount++;d=m.i1616to32(c.distance,b);h=m.i8888to32(Math.round(31*-c.prevNormal.x),Math.round(31*-c.prevNormal.y),Math.round(0),Math.round(31));n=m.i8888to32(0,0,0,a._bitset);t[9]=m.i1616to32(c.currentVertex.x,c.currentVertex.y);
t[10]=a.id;t[11]=a._fillColor;t[12]=h;t[13]=d;t[14]=a._tl;t[15]=a._br;t[16]=n;t[17]=m.i1616to32(e,0);c.exit0=a.offset+a.vertexCount++;d=m.i1616to32(c.distance,b);h=m.i8888to32(Math.round(31*c.nextNormal.x),Math.round(31*c.nextNormal.y),Math.round(0),Math.round(-31));n=m.i8888to32(0,0,0,a._bitset);t[18]=m.i1616to32(c.currentVertex.x,c.currentVertex.y);t[19]=a.id;t[20]=a._fillColor;t[21]=h;t[22]=d;t[23]=a._tl;t[24]=a._br;t[25]=n;t[26]=m.i1616to32(e,0);c.exit2=a.offset+a.vertexCount++;d=m.i1616to32(c.distance,
b);h=m.i8888to32(Math.round(31*-c.nextNormal.x),Math.round(31*-c.nextNormal.y),Math.round(0),Math.round(31));n=m.i8888to32(0,0,0,a._bitset);t[27]=m.i1616to32(c.currentVertex.x,c.currentVertex.y);t[28]=a.id;t[29]=a._fillColor;t[30]=h;t[31]=d;t[32]=a._tl;t[33]=a._br;t[34]=n;t[35]=m.i1616to32(e,0);a.geometryBuf.writeRegion(t)}},A=function(a){return function(c){r[0]=c.leftExit0;r[1]=c.rightEntry0;r[2]=c.leftExit2;r[3]=c.rightEntry0;r[4]=c.rightEntry2;r[5]=c.leftExit2;a.indexCount+=6;a.indexBuf.writeRegion(r)}},
z=function(a){return function(c,b,e,d,h,n,f,p,k){k=m.i1616to32(k,Math.ceil(1024*a._halfWidth));h=m.i8888to32(Math.round(31*h),Math.round(31*n),Math.round(31*f),Math.round(31*p));e=m.i8888to32(31*e,31*d,0,a._bitset);v[0]=m.i1616to32(c,b);v[1]=a.id;v[2]=a._fillColor;v[3]=h;v[4]=k;v[5]=a._tl;v[6]=a._br;v[7]=e;v[8]=m.i1616to32(Math.ceil(1024*a._halfReferenceWidth),0);a.geometryBuf.writeRegion(v);return a.offset+a.vertexCount++}},B=function(a){return function(c,b,e){w[0]=c;w[1]=b;w[2]=e;a.indexCount+=
3;a.indexBuf.writeRegion(w)}};b.default=function(b){return function(b){function d(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];a=b.apply(this,a)||this;a.tessellationProperties={_fillColor:null,_tl:null,_br:null,_halfWidth:null,_bitset:null,_halfReferenceWidth:null,id:null,indexBuf:null,indexCount:null,geometryBuf:null,vertexCount:null,offset:null};a._tessellationOptions={};a.geometryType=q.WGLGeometryType.LINE;return a}l(d,b);d.prototype.writeMesh=function(a,c,b,d,h){var n=c.indexVector,
f=c.get("geometry"),m=new e(d,this.geometryType,this._materialKey);c=c.getVector("geometry").vertexCount;m.vertexFrom=c;m.indexFrom=n.length;switch(b){case "esriGeometryPolyline":b=this._clipLines(h.geometry.paths);if(0===b.length)break;this._write(m,n,f,c,d,b);a.push(m);break;case "esriGeometryPolygon":b=this._clipLines(h.geometry.rings);if(0===b.length)break;this._write(m,n,f,c,d,b);a.push(m);break;default:p.error("Unable to handle geometryType: "+b)}};d.prototype._clipLines=function(a){for(var c=
[],b=!1,e=0;e<a.length;){var d=[],h=a[e];x.reset(2);var f=h[0],m=f[0],f=f[1];if(b)x.moveTo(m,f);else{if(-16>m||m>n||-16>f||f>n){b=!0;continue}d.push({x:m,y:f})}for(var p=!1,k=h.length,g=1;g<k;++g)if(m+=h[g][0],f+=h[g][1],b)x.lineTo(m,f);else{if(-16>m||m>n||-16>f||f>n){p=!0;break}d.push({x:m,y:f})}if(p)b=!0;else{if(b){if(d=x.resultWithStarts())for(b=0;b<d.length;b++)c.push(d[b])}else c.push({line:d,start:0});e++;b=!1}}return c};d.prototype._write=function(a,b,e,d,h,n){this.tessellationProperties.id=
h;this.tessellationProperties.indexBuf=b;this.tessellationProperties.indexCount=0;this.tessellationProperties.geometryBuf=e;this.tessellationProperties.vertexCount=0;this.tessellationProperties.offset=d;for(b=0;b<n.length;b++)e=n[b],d=e.line,2>d.length||(this._tessellationOptions.initialDistance=e.start%65535,this._tessellationCallbacks instanceof c.StandardTessellationCallbacks&&(this._tessellationCallbacks.capType=this._capType,this._tessellationCallbacks.joinType=this._joinType),c.tessellate(d,
this._tessellationOptions,this._tessellationCallbacks),c.cleanup());a.vertexCount=this.tessellationProperties.vertexCount;a.indexCount=this.tessellationProperties.indexCount;a.zOrder=this._zOrder};d.prototype._initializeTessellator=function(b){var e=h.LineMaterialKey.load(this._materialKey);this._tessellationOptions.trackDistance=this._isDashed||this._hasPattern;this._tessellationOptions.thin=!b&&this.tessellationProperties._halfWidth<a.THIN_LINE_THRESHOLD/2&&!(e.vvSizeFieldStops||e.vvSizeMinMaxValue||
e.vvSizeScaleStops||e.vvSizeUnitValue);this._tessellationOptions.wrapDistance=65535;this._tessellationOptions.outerBisectorAutoSplitThreshold=u;this._tessellationOptions.enableOuterBisectorSplit=this._isDashed||this._hasPattern;this._tessellationOptions.innerBisectorAutoSplitThreshold=u;this._tessellationOptions.enableInnerBisectorSplit=this._isDashed||this._hasPattern;this._tessellationOptions.thin?this._tessellationCallbacks={vertex:y(this.tessellationProperties),bridge:A(this.tessellationProperties)}:
(b=new c.StandardTessellationCallbacks(z(this.tessellationProperties),B(this.tessellationProperties)),b.miterLimitCosine=this._miterLimitCosine,b.textured=this._isDashed||this._hasPattern,b.joinOnUTurn=this._joinOnUTurn,this._tessellationCallbacks=b)};return d}(b)}})},"esri/views/2d/engine/webgl/mesh/templates/WGLMarkerTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../core/libs/gl-matrix-2/mat2d ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../../../../../core/libs/gl-matrix-2/vec2 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../../../../../symbols/cim/enums ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./WGLBaseMarkerTemplate ./WGLMeshTemplate".split(" "),
function(g,b,l,k,f,a,q,m,d,c,e,h,p,n,u,x){Object.defineProperty(b,"__esModule",{value:!0});g=function(b){function g(e,h,f,k,g,l,t,u,v,x,E,G,J,K,I,N,M,L,Q){var r=b.call(this)||this;r.height=t;r.width=l;r.xOffset=h*Q;r.yOffset=f*Q;h=d.vec2f32.create();f=q.mat2df32.create();E=(K===c.Alignment.MAP?1:0)|(E?1:0)<<1|(J?1:0)<<2|(G?1:0)<<3;G=I&&I.sdf;a.mat2d.translate(f,f,d.vec2f32.fromValues(r.xOffset,-r.yOffset));k&&a.mat2d.rotate(f,f,3.14159265359/180*k);e=n.MarkerMaterialKey.load(n.createMaterialKey(r.geometryType,
e,!1));e.sdf=G;e.pattern=!0;e.textureBinding=I.textureBinding;r._materialKey=e.data;r._fillColor=g;r._outlineColor=v;r._sizeOutlineWidth=p.i8888to32(Math.round(Math.sqrt(256*l)),Math.round(Math.sqrt(256*t)),Math.round(Math.sqrt(256*x)),Math.round(Math.sqrt(256*u)));g=I.rect.x;u=I.rect.y;v=g+I.rect.width;x=u+I.rect.height;N=.5-((.5+N)*I.width+1)/I.rect.width;M=.5-((.5+M)*I.height+1)/I.rect.height;e=Math.round(Math.min(64*L,255));l*=I.rect.width/I.width*L*Q;t*=I.rect.height/I.height*L*Q;I=(N-.5)*l;
M=(M-.5)*t;r._bitestAndDistRatio=p.i8888to32(0,0,E,e);m.vec2.set(h,I,M);m.vec2.transformMat2d(h,h,f);r._offsetUpperLeft=p.i1616to32(16*h[0],16*h[1]);r._texUpperLeft=p.i1616to32(g,u);m.vec2.set(h,I+l,M);m.vec2.transformMat2d(h,h,f);r._offsetUpperRight=p.i1616to32(16*h[0],16*h[1]);r._texUpperRight=p.i1616to32(v,u);m.vec2.set(h,I,M+t);m.vec2.transformMat2d(h,h,f);r._offsetBottomLeft=p.i1616to32(16*h[0],16*h[1]);r._texBottomLeft=p.i1616to32(g,x);m.vec2.set(h,I+l,M+t);m.vec2.transformMat2d(h,h,f);r._offsetBottomRight=
p.i1616to32(16*h[0],16*h[1]);r._texBottomRight=p.i1616to32(v,x);return r}l(g,b);g.fromCIMMarker=function(a,b,d){var h=b.size,n=(d&&d.width||1)/(d&&d.height||1)*b.scaleX,m=b.scaleSymbolsProportionally&&b.frameHeight?h/b.frameHeight:1,p=e.premultiplyAlphaRGBA(b.color),l=e.premultiplyAlphaRGBA(b.outlineColor),q=f.pt2px(h),r=q*n,t=f.pt2px(b.offsetX||0),u=f.pt2px(b.offsetY||0),m=f.pt2px(b.outlineWidth||0)*m,v=b.alignment||c.Alignment.SCREEN,w=f.pt2px(b.referenceSize),x=b.rotation||0;b.rotateClockwise||
(x=-x);var y=0,M=0,L=b.anchorPoint;L&&(b.isAbsoluteAnchorPoint?h&&(y=-L.x/(h*n),M=L.y/h):(y=L.x,M=L.y));return new g(a,t,u,x,p,r,q,w,l,m,b.colorLocked,b.scaleSymbolsProportionally,!1,v,d,y,M,b.sizeRatio,k.unwrapOr(b.scaleFactor,1))};g.fromPictureMarker=function(a,b,e){var d=Math.round(f.pt2px(b.width)),n=Math.round(f.pt2px(b.height)),m=h.PICTURE_FILL_COLOR,p=Math.round(f.pt2px(b.xoffset||0)),k=Math.round(f.pt2px(b.yoffset||0));return new g(a,p,k,b.angle,m,d,n,n,0,0,!1,!1,!1,c.Alignment.SCREEN,e,0,
0,1,1)};g.fromSimpleMarker=function(a,b,d){var h=e.premultiplyAlphaRGBA(b.color),n=Math.round(f.pt2px(b.size)),m=Math.round(f.pt2px(b.xoffset||0)),p=Math.round(f.pt2px(b.yoffset||0)),k=b.style,l=b.outline,q=(l&&l.color&&e.premultiplyAlphaRGBA(l.color))|0,l=(l&&l.width&&Math.round(f.pt2px(l.width)))|0;a=new g(a,m,p,b.angle,h,n,n,n,q,l,!1,!1,"cross"===k||"x"===k,c.Alignment.SCREEN,d,0,0,1.96875,1);a.boundsType="circle"===k?"circle":"square";return a};return g}(u.default(x.default));b.default=g})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseMarkerTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Logger ../../enums ../../number ../../WGLDisplayRecord".split(" "),
function(g,b,l,k,f,a,q){Object.defineProperty(b,"__esModule",{value:!0});var m=k.getLogger("esri.views.2d.engine.webgl.WGLMarkerTemplateBase");b.default=function(b){return function(c){function b(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];a=c.apply(this,a)||this;a.xOffset=0;a.yOffset=0;a.width=0;a.height=0;a.boundsType="square";a.geometryType=f.WGLGeometryType.MARKER;return a}l(b,c);b.prototype.writeMesh=function(a,c,b,e,d){var h=c.indexVector,n=c.get("geometry"),f=new q(e,this.geometryType,
this._materialKey);c=c.getVector("geometry").vertexCount;a.push(f);f.vertexFrom=c;f.indexFrom=h.length;switch(b){case "esriGeometryPoint":b=d.geometry;a=b.x;b=b.y;this._writeVertices(f,n,e,this._getPos(a,b));this._writeIndices(f,h,c);break;case "esriGeometryPolyline":this._writeMany(f,h,n,c,e,d.geometry.paths[0]);break;case "esriGeometryPolygon":(b=d.centroid)?(a=b.x,b=b.y,this._writeVertices(f,n,e,this._getPos(a,b)),this._writeIndices(f,h,c)):m.error("Tried to render polygon geometries as markers, but found no centroid!");
break;case "esriGeometryMultipoint":this._writeMany(f,h,n,c,e,d.geometry.points);break;default:m.error("Unable to handle geometryType: "+b)}};b.prototype._getPos=function(c,b){return a.i1616to32(c,b)};b.prototype._writeMany=function(a,c,b,e,d,f){for(var h=0,n=0,m=0,p=0;p<f.length;p++){var k=f[p],g=k[0],k=k[1],l=this._getPos(g+h,k+n);this._writeVertices(a,b,d,l);this._writeIndices(a,c,e+m);h+=g;n+=k;m+=4}};b.prototype._writeVertices=function(a,c,b,e){c.push(e);c.push(this._offsetUpperLeft);c.push(this._texUpperLeft);
c.push(this._bitestAndDistRatio);c.push(b);c.push(this._fillColor);c.push(this._outlineColor);c.push(this._sizeOutlineWidth);c.push(e);c.push(this._offsetUpperRight);c.push(this._texUpperRight);c.push(this._bitestAndDistRatio);c.push(b);c.push(this._fillColor);c.push(this._outlineColor);c.push(this._sizeOutlineWidth);c.push(e);c.push(this._offsetBottomLeft);c.push(this._texBottomLeft);c.push(this._bitestAndDistRatio);c.push(b);c.push(this._fillColor);c.push(this._outlineColor);c.push(this._sizeOutlineWidth);
c.push(e);c.push(this._offsetBottomRight);c.push(this._texBottomRight);c.push(this._bitestAndDistRatio);c.push(b);c.push(this._fillColor);c.push(this._outlineColor);c.push(this._sizeOutlineWidth);a.vertexCount+=4};b.prototype._writeIndices=function(a,c,b){c.push(b+0);c.push(b+1);c.push(b+2);c.push(b+1);c.push(b+3);c.push(b+2);a.indexCount+=6};return b}(b)}})},"esri/views/2d/engine/webgl/mesh/templates/WGLTemplateStore":function(){define("require exports ../../../../../../core/tsSupport/awaiterHelper ../../../../../../core/tsSupport/generatorHelper ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/promiseUtils ../../../../../../symbols/support/defaults ./WGLDynamicLineTemplate ./WGLDynamicMarkerTemplate ./WGLDynamicTextTemplate ./WGLFillTemplate ./WGLLineTemplate ./WGLMarkerTemplate ./WGLTextTemplate ../../util/Lock ../../util/Result ../../../../layers/features/textUtils".split(" "),
function(g,b,l,k,f,a,q,m,d,c,e,h,p,n,u,x,v,t){function w(a,c){var b=a.length;a.push(null);c.then(function(c){return a[b]=c});return a}function r(a){return!!(a&1)}Object.defineProperty(b,"__esModule",{value:!0});var y=a.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLTemplateStore"),A=[];b.isDynamicId=r;g=function(){function a(a,c){this._templateIdCounter=this._idCounter=1;this._idToTemplateGroup=new Map;this._symbolToTemplate=new Map;this._fetchQueue=[];this._idToResolver=new Map;this._cimTemplateCache=
new Map;this._cimAnalyses=[];this._lock=new x.default;this._fetchResource=a;this._joinOnUTurn=c}Object.defineProperty(a.prototype,"_markerError",{get:function(){return this._errorTemplates.marker[0]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"_fillError",{get:function(){return this._errorTemplates.fill[0]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"_lineError",{get:function(){return this._errorTemplates.line[0]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"_textError",{get:function(){return this._errorTemplates.line[0]},enumerable:!0,configurable:!0});a.prototype.createTemplateGroup=function(a,c,b){this._initErrorTemplates();var e=a.hash();if(this._symbolToTemplate.has(e)&&"expanded-cim"!==a.type)return this._symbolToTemplate.get(e);var d=[];c&&this._createMeshTemplates(d,c,b,!0);this._createMeshTemplates(d,a,b,!1);a=this._createGroupId("expanded-cim"===a.type);this._idToTemplateGroup.set(a,d);this._symbolToTemplate.set(e,a);return a};a.prototype.getTemplateGroup=
function(a){return this._idToTemplateGroup.has(a)?this._idToTemplateGroup.get(a):A};a.prototype.getDynamicTemplateGroup=function(a){if(!this._idToTemplateGroup.has(a))return A;r(a)||y.error("mapview-template-store","Id "+a+" does not refer to a dynamic template");return this._idToTemplateGroup.get(a)};a.prototype.getMosaicItem=function(a,c,b){var e=this,d=this._createTemplateId(),h=q.create(function(a){return e._idToResolver.set(d,a)});a=c?a.toJSON():a;this._fetchQueue.push({symbol:a,id:d,glyphIds:b});
return h};a.prototype.finalize=function(a){return this._fetchQueue.length||this._lock.isHeld()?x.withLock(this._lock,this._fetchAllQueuedResources.bind(this),a):q.resolve()};a.prototype._initErrorTemplates=function(){this._errorTemplates||(this._errorTemplates={fill:this._createMeshTemplates([],m.errorPolygonSymbol2D,null,!1),marker:this._createMeshTemplates([],m.errorPointSymbol2D,null,!1),line:this._createMeshTemplates([],m.errorPolylineSymbol2D,null,!1)})};a.prototype._fetchAllQueuedResources=
function(a){var c=this;if(!this._fetchQueue.length)return q.resolve();var b=this._fetchQueue,e=this._cimAnalyses;this._fetchQueue=[];this._cimAnalyses=[];return q.all(e).then(function(){return c._fetchResource(b,a).then(function(a){for(var b=0;b<a.length;b++){var e=a[b],d=e.id,e=e.mosaicItem;c._idToResolver.get(d)(e);c._idToResolver.delete(d)}})}).catch(function(a){q.isAbortError(a)?c._fetchQueue=c._fetchQueue.concat(b):y.error(new f("mapview-template-store","Unable to fetch requested texture resources",
a))})};a.prototype._createGroupId=function(a){return this._idCounter++<<1|(a?1:0)};a.prototype._createTemplateId=function(){return this._templateIdCounter++};a.prototype._createSMS=function(a,c){return l(this,void 0,void 0,function(){var b;return k(this,function(e){switch(e.label){case 0:return[4,this.getMosaicItem(a,!0)];case 1:return b=e.sent().spriteMosaicItem,v.ok(b,y)?[2,n.default.fromSimpleMarker(c,a,b)]:[2,this._markerError]}})})};a.prototype._createPMS=function(a,c){return l(this,void 0,void 0,
function(){var b;return k(this,function(e){switch(e.label){case 0:return[4,this.getMosaicItem(a,!0)];case 1:return b=e.sent().spriteMosaicItem,v.ok(b,y)?[2,n.default.fromPictureMarker(c,a,b)]:[2,this._markerError]}})})};a.prototype._createSFS=function(a,c,b){return l(this,void 0,void 0,function(){var e,d;return k(this,function(n){switch(n.label){case 0:return[4,this.getMosaicItem(a,!0)];case 1:return e=n.sent().spriteMosaicItem,d=a,v.ok(e,y)?[2,h.default.fromSimpleFill(c,d,e,b)]:[2,this._fillError]}})})};
a.prototype._createPFS=function(a,c,b){return l(this,void 0,void 0,function(){var e,d;return k(this,function(n){switch(n.label){case 0:return[4,this.getMosaicItem(a,!0)];case 1:return e=n.sent().spriteMosaicItem,d=a,v.ok(e,y)?[2,h.default.fromPictureFill(c,d,e,b)]:[2,this._fillError]}})})};a.prototype._createSLS=function(a,c,b){return l(this,void 0,void 0,function(){var e,d;return k(this,function(h){switch(h.label){case 0:return[4,this.getMosaicItem(a,!0)];case 1:return e=h.sent().spriteMosaicItem,
d=a,v.ok(e,y)?[2,p.default.fromSimpleLine(c,b,d,e,this._joinOnUTurn)]:[2,this._lineError]}})})};a.prototype._createTS=function(a,c){return l(this,void 0,void 0,function(){var b;return k(this,function(e){switch(e.label){case 0:return[4,this.getMosaicItem(a,!0)];case 1:return b=e.sent().glyphMosaicItems,[2,u.default.fromText(c,a,b)]}})})};a.prototype._createCIMText=function(a,c){return l(this,void 0,void 0,function(){var b;return k(this,function(d){switch(d.label){case 0:return"function"===typeof a.materialHash?
[2,q.resolve(e.default.fromCIMText(c,a))]:[4,this.getMosaicItem(a.cim,!1,t.codepoints(a.text))];case 1:return b=d.sent().glyphMosaicItems,a.cim.mosaicHash=a.materialHash,v.ok(b,y)?[2,u.default.fromCIMText(c,a,b)]:[2,this._textError]}})})};a.prototype._createCIMFill=function(a,c){return l(this,void 0,void 0,function(){var b;return k(this,function(e){switch(e.label){case 0:return a.cim.mosaicHash=a.materialHash,[4,this.getMosaicItem(a.cim,!1)];case 1:return b=e.sent().spriteMosaicItem,v.ok(b,y)?[2,
h.default.fromCIMFill(c,a,b,!1)]:[2,this._fillError]}})})};a.prototype._createCIMLine=function(a,c){return l(this,void 0,void 0,function(){var b;return k(this,function(e){switch(e.label){case 0:if("function"===typeof a.materialHash)return[2,q.resolve(d.default.fromCIMLine(c,a))];a.cim.mosaicHash=a.materialHash;return[4,this.getMosaicItem(a.cim,!1)];case 1:return b=e.sent().spriteMosaicItem,v.ok(b,y)?[2,p.default.fromCIMLine(c,a,b,!1,this._joinOnUTurn)]:[2,this._lineError]}})})};a.prototype._createCIMMarker=
function(a,b){return l(this,void 0,void 0,function(){var e;return k(this,function(d){switch(d.label){case 0:if("function"===typeof a.materialHash)return[2,q.resolve(c.default.fromCIMMarker(b,a))];a.cim.mosaicHash=a.materialHash;return[4,this.getMosaicItem(a.cim,!1)];case 1:return e=d.sent().spriteMosaicItem,v.ok(e,y)?[2,n.default.fromCIMMarker(b,a,e)]:[2,this._markerError]}})})};a.prototype._createCIM=function(a,c){return l(this,void 0,void 0,function(){var b,e,d=this;return k(this,function(h){b=
a.templateHash;if(this._cimTemplateCache.has(b))return[2,this._cimTemplateCache.get(b)];switch(a.type){case "marker":e=this._createCIMMarker(a,c);break;case "line":e=this._createCIMLine(a,c);break;case "fill":e=this._createCIMFill(a,c);break;case "text":e=this._createCIMText(a,c)}e.then(function(a){return d._cimTemplateCache.set(b,a)});return[2,e]})})};a.prototype._createMeshTemplates=function(a,c,b,e){if(-1!==c.type.indexOf("3d"))return y.error("3D symbols are not supported with MapView"),a;switch(c.type){case "cim":return y.error(new f("mapview-bad-type",
"Found a cim type not yet expanded")),a;case "expanded-cim":e=0;for(c=c.layers;e<c.length;e++)w(a,this._createCIM(c[e],b));return a;case "simple-marker":return w(a,this._createSMS(c,b));case "picture-marker":return w(a,this._createPMS(c,b));case "simple-fill":return w(a,this._createSFS(c,b,e)),c.outline&&w(a,this._createSLS(c.outline,b,!0)),a;case "picture-fill":return w(a,this._createPFS(c,b,e)),c.outline&&w(a,this._createSLS(c.outline,b,!0)),a;case "simple-line":return w(a,this._createSLS(c,b,!1));
case "text":return w(a,this._createTS(c,b));default:return y.error("Unable to create mesh template for unknown symbol type {: $ }{symbol.type}"),a}};return a}();b.WGLTemplateStore=g})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicLineTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/screenUtils ../../color ../../number ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(g,b,l,k,f,a,q,m,d,c,e){Object.defineProperty(b,"__esModule",{value:!0});g=function(c){function b(a,b){var e=c.call(this,b)||this;e._cimLineLayer=b;var d=0;m.isFunction(b.width)||(d=.5*k.pt2px(b.width));e._dynamicPropertyMap.set("_halfWidth",function(a,c,e){return m.isFunction(b.width)?.5*k.pt2px(b.width(a,c,e)):d});m.isFunction(b.cap)?e._dynamicPropertyMap.set("_capType",b.cap):e._capType=b.cap;m.isFunction(b.join)?e._dynamicPropertyMap.set("_joinType",b.join):e._joinType=b.join;if(m.isFunction(b.color))e._dynamicPropertyMap.set("_fillColor",
function(a,c,e){return(a=b.color(a,c,e))&&f.premultiplyAlphaRGBA(a)||0});else{var h=b.color;e._fillColor=h&&f.premultiplyAlphaRGBA(h)||0}m.isFunction(b.miterLimit)?e._dynamicPropertyMap.set("_miterLimitCosine",function(a,c,e){return m.getLimitCosine(b.miterLimit(a,c,e))}):e._miterLimitCosine=m.getLimitCosine(b.miterLimit);e._scaleFactor=b.scaleFactor||1;e._isDashed=b.isDashed;e.tessellationProperties._bitset=b.colorLocked?1:0;e._materialKey=q.createMaterialKey(e.geometryType,a,b.isOutline);e._initializeTessellator(!0);
return e}l(b,c);b.fromCIMLine=function(a,c){return new b(a,c)};b.prototype.bindFeature=function(c,b,d){var h=this;this._dynamicPropertyMap.forEach(function(a,e){h[e]=a(c,b,d)});this._halfWidth*=this._scaleFactor;var n=this._materialCache,f=this._cimLineLayer.materialHash,f=f(c,b,d),f=n.get(f),n=null;f&&e.ok(f.spriteMosaicItem)&&(n=f.spriteMosaicItem);if(n){this._hasPattern=!0;var f=n.rect,m=f.x+1+n.width,p=f.y+1+n.height;this.tessellationProperties._tl=a.i1616to32(f.x+1,f.y+1);this.tessellationProperties._br=
a.i1616to32(m,p)}else this._hasPattern=!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=0;this.tessellationProperties._fillColor=this._fillColor;this.tessellationProperties._halfWidth=this._halfWidth;this.tessellationProperties._halfReferenceWidth=this.tessellationProperties._halfWidth;f=q.LineMaterialKey.load(this._materialKey);n&&(f.sdf=n.sdf,f.pattern=!0,f.textureBinding=n.textureBinding);this._materialKey=f.data};return b}(d.default(c.default));b.default=g})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMeshTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Logger ../../../../../../core/promiseUtils ../../../../../../symbols/cim/cimAnalyzer ./WGLMeshTemplate".split(" "),
function(g,b,l,k,f,a,q){Object.defineProperty(b,"__esModule",{value:!0});var m=k.getLogger("esri.views.2d.engine.webgl.WGLDynamicMeshTemplate");g=function(b){function c(a){var c=b.call(this)||this;c._ongoingMaterialRequestMap=new Map;c._materialCache=new Map;c._dynamicPropertyMap=new Map;c._cimLayer=a;return c}l(c,b);c.prototype.analyze=function(c,b,d,n){var e=this,h=this._materialCache,p=this._cimLayer.materialHash;if(!p)return m.error("A Dynamic mesh template must have a material hash value or function!"),
f.reject(null);var k="function"===typeof p?p(b,d,n):p;if(h.has(k))return c=h.get(k),f.resolve(c);if(this._ongoingMaterialRequestMap.has(k))return this._ongoingMaterialRequestMap.get(k);b=a.analyzeCIMResource(this._cimLayer.cim,this._cimLayer.materialOverrides);b.mosaicHash=k;c=c.getMosaicItem(b,!1).then(function(a){e._ongoingMaterialRequestMap.delete(k);h.set(k,a);return a}).catch(function(a){e._ongoingMaterialRequestMap.delete(k);m.error(".analyze()",a.message);return null});this._ongoingMaterialRequestMap.set(k,
c);return c};return c}(q.default);b.default=g})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMarkerTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../core/libs/gl-matrix-2/mat2d ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../../../../../core/libs/gl-matrix-2/vec2 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../../../../../symbols/cim/enums ../../color ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(g,b,l,k,f,a,q,m,d,c,e,h,p,n,u,x,v,t,w){Object.defineProperty(b,"__esModule",{value:!0});var r=3.14159265359/180,y=e.vec2f32.create(),A=d.mat2df32.create(),z=f.getLogger("esri.views.2d.engine.webgl.WGLDynamicMarkerTemplate");g=function(b){function d(c,e){var d=b.call(this,e)||this;d._cimMarkerLayer=e;x.isFunction(e.color)?d._dynamicPropertyMap.set("_fillColor",function(a,c,b){return p.premultiplyAlphaRGBA(e.color(a,c,b))}):d._fillColor=p.premultiplyAlphaRGBA(e.color);x.isFunction(e.outlineColor)?
d._dynamicPropertyMap.set("_outlineColor",function(a,c,b){return p.premultiplyAlphaRGBA(e.outlineColor(a,c,b))}):d._outlineColor=p.premultiplyAlphaRGBA(e.outlineColor);x.isFunction(e.size)?d._dynamicPropertyMap.set("_size",function(a,c,b){return q.pt2px(e.size(a,c,b))}):d._size=q.pt2px(e.size);x.isFunction(e.scaleX)?d._dynamicPropertyMap.set("_scaleX",e.scaleX):d._scaleX=e.scaleX;x.isFunction(e.offsetX)?d._dynamicPropertyMap.set("xOffset",function(a,c,b){return q.pt2px(e.offsetX(a,c,b))}):d.xOffset=
q.pt2px(e.offsetX);x.isFunction(e.offsetY)?d._dynamicPropertyMap.set("yOffset",function(a,c,b){return q.pt2px(e.offsetY(a,c,b))}):d.yOffset=q.pt2px(e.offsetY);x.isFunction(e.outlineWidth)?d._dynamicPropertyMap.set("_outlineWidth",function(a,c,b){return q.pt2px(e.outlineWidth(a,c,b))}):d._outlineWidth=q.pt2px(e.outlineWidth);x.isFunction(e.rotation)?d._dynamicPropertyMap.set("_angle",e.rotation):d._angle=e.rotation;d._scaleFactor=a.unwrapOr(e.scaleFactor,1);d._bitSet=(e.alignment===h.Alignment.MAP?
1:0)|(e.colorLocked?1:0)<<1|(e.scaleSymbolsProportionally?1:0)<<3;d._materialKey=u.createMaterialKey(d.geometryType,c,!1);return d}l(d,b);d.fromCIMMarker=function(a,c){return new d(a,c)};d.prototype.bindFeature=function(a,b,d){var h=this;this._dynamicPropertyMap.forEach(function(c,e){h[e]=c(a,b,d)});var f=this._cimMarkerLayer.materialHash,f="function"===typeof f?f(a,b,d):f;if((f=this._materialCache.get(f))&&w.ok(f.spriteMosaicItem)&&f.spriteMosaicItem){var f=f.spriteMosaicItem,p=this._cimMarkerLayer.sizeRatio,
g=f.width/f.height*this._scaleX,l=this._cimMarkerLayer.rotateClockwise?this._angle:-this._angle,t=this._size,v=t*g,x=this.xOffset*this._scaleFactor,B=this.yOffset*this._scaleFactor,C=this._cimMarkerLayer.scaleSymbolsProportionally&&this._cimMarkerLayer.frameHeight?this._size/q.pt2px(this._cimMarkerLayer.frameHeight):1,D=this._outlineWidth*C,H=q.pt2px(this._cimMarkerLayer.referenceSize),F=0,C=0,R=this._cimMarkerLayer.anchorPoint;R&&(this._cimMarkerLayer.isAbsoluteAnchorPoint?this._size&&(F=-R.x/(this._size*
g),C=R.y/this._size):(F=R.x,C=R.y));this._sizeOutlineWidth=n.i8888to32(Math.round(Math.sqrt(256*v)),Math.round(Math.sqrt(256*t)),Math.round(Math.sqrt(256*D)),Math.round(Math.sqrt(256*H)));m.mat2d.identity(A);m.mat2d.translate(A,A,e.vec2f32.fromValues(x,-B));l&&m.mat2d.rotate(A,A,r*l);g=f.rect.x;l=f.rect.y;x=g+f.rect.width;B=l+f.rect.height;F=.5-((.5+F)*f.width+1)/f.rect.width;C=.5-((.5+C)*f.height+1)/f.rect.height;v=v*p*this._scaleFactor;t=t*p*this._scaleFactor;p=Math.round(64*p);v*=f.rect.width/
f.width;t*=f.rect.height/f.height;F=(F-.5)*v;C=(C-.5)*t;this._bitestAndDistRatio=n.i8888to32(0,0,this._bitSet,p);c.vec2.set(y,F,C);c.vec2.transformMat2d(y,y,A);this._offsetUpperLeft=n.i1616to32(16*y[0],16*y[1]);this._texUpperLeft=n.i1616to32(g,l);c.vec2.set(y,F+v,C);c.vec2.transformMat2d(y,y,A);this._offsetUpperRight=n.i1616to32(16*y[0],16*y[1]);this._texUpperRight=n.i1616to32(x,l);c.vec2.set(y,F,C+t);c.vec2.transformMat2d(y,y,A);this._offsetBottomLeft=n.i1616to32(16*y[0],16*y[1]);this._texBottomLeft=
n.i1616to32(g,B);c.vec2.set(y,F+v,C+t);c.vec2.transformMat2d(y,y,A);this._offsetBottomRight=n.i1616to32(16*y[0],16*y[1]);this._texBottomRight=n.i1616to32(x,B);t=u.MarkerMaterialKey.load(this._materialKey);t.sdf=f.sdf;t.pattern=!0;t.textureBinding=f.textureBinding;this._materialKey=t.data}else z.error(new k("mapview-cim","Encountered an error when binding feature"))};return d}(v.default(t.default));b.default=g})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicTextTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/tsSupport/generatorHelper ../../../../../../core/tsSupport/awaiterHelper ../../../../../../core/screenUtils ../../alignmentUtils ../../color ../../materialKey/MaterialKey ./util ./WGLBaseTextTemplate ./WGLDynamicMeshTemplate ../../../../layers/features/textUtils".split(" "),
function(g,b,l,k,f,a,q,m,d,c,e,h,p){Object.defineProperty(b,"__esModule",{value:!0});g=function(b){function e(e,h){var f=b.call(this,h)||this;f._horizontalAlignment="center";f._verticalAlignment="middle";f._textToGlyphs=new Map;var n=h.scaleFactor||1;f._cimTextLayer=h;c.isFunction(h.color)?f._dynamicPropertyMap.set("_color",function(a,c,b){return m.premultiplyAlphaRGBA(h.color(a,c,b))}):f._color=m.premultiplyAlphaRGBA(h.color);c.isFunction(h.color)?f._dynamicPropertyMap.set("_haloColor",function(a,
c,b){return m.premultiplyAlphaRGBA(h.outlineColor(a,c,b))}):f._haloColor=m.premultiplyAlphaRGBA(h.outlineColor);var p;c.isFunction(h.size)||(p=Math.min(Math.round(a.pt2px(h.size*h.sizeRatio)),127));f._dynamicPropertyMap.set("_size",function(b,e,d){return c.isFunction(h.size)?Math.min(Math.round(a.pt2px(h.size(b,e,d)*h.sizeRatio)),127):p});c.isFunction(h.outlineSize)?f._dynamicPropertyMap.set("_haloSize",function(c,b,e){return Math.min(Math.floor(5*a.pt2px(h.outlineSize(c,b,e)*h.sizeRatio)),127)}):
f._haloSize=Math.min(Math.floor(5*a.pt2px(h.outlineSize*h.sizeRatio)),127);var k;c.isFunction(h.offsetX)||(k=Math.round(a.pt2px(h.offsetX*h.sizeRatio)));f._dynamicPropertyMap.set("_xOffset",function(b,e,d){return c.isFunction(h.offsetX)?Math.round(a.pt2px(h.offsetX(b,e,d)*h.sizeRatio)):k});var g;c.isFunction(h.offsetY)||(g=Math.round(a.pt2px(h.offsetY*h.sizeRatio)));f._dynamicPropertyMap.set("_yOffset",function(b,e,d){return c.isFunction(h.offsetY)?Math.round(a.pt2px(h.offsetY(b,e,d)*h.sizeRatio)):
g});c.isFunction(h.angle)?f._dynamicPropertyMap.set("_angle",h.angle):f._angle=h.angle;c.isFunction(h.horizontalAlignment)?f._dynamicPropertyMap.set("_horizontalAlignment",h.horizontalAlignment):f._horizontalAlignment=h.horizontalAlignment;c.isFunction(h.verticalAlignment)?f._dynamicPropertyMap.set("_verticalAlignment",h.verticalAlignment):f._verticalAlignment=h.verticalAlignment;f._scaleFactor=n;c.isFunction(h.text)?f._dynamicPropertyMap.set("_text",h.text):f._text=h.text;n=Math.min(Math.round(a.pt2px(h.referenceSize*
h.sizeRatio)),127);f._referenceSize=Math.round(Math.sqrt(256*n));f._materialKey=d.createMaterialKey(f.geometryType,e,!1);e=d.TextMaterialKey.load(f._materialKey);e.sdf=!0;f._bitset=h.colorLocked?1:0;f._materialKey=e.data;f._decoration="none";f._lineHeight=1;f._lineWidth=512;f._isCIM=!0;return f}l(e,b);e.fromCIMText=function(a,c){return new e(a,c)};e.prototype.analyze=function(a,c,b,e){return f(this,void 0,void 0,function(){var d,h;return k(this,function(f){switch(f.label){case 0:return f=this._cimTextLayer,
d="string"===typeof f.text?f.text:"function"===typeof f.text?f.text(c,b,e):"",[4,a.getMosaicItem(this._cimTextLayer.cim,!1,p.codepoints(d))];case 1:return h=f.sent(),this._textToGlyphs.set(d,h.glyphMosaicItems),[2,h]}})})};e.prototype.bindFeature=function(a,c,b){var e=this;this._dynamicPropertyMap.forEach(function(d,h){e[h]=d(a,c,b)});if(this._text&&0!==this._text.length){this._size*=this._scaleFactor;this._scale=this._size/24;this._xOffset*=this._scaleFactor;this._yOffset*=this._scaleFactor;this._xAlignD=
q.getXAnchorDirection(this._horizontalAlignment||"center");this._yAlignD=q.getYAnchorDirection(this._verticalAlignment||"baseline");var d=this._textToGlyphs.get(this._text);this.bindTextInfo(d,!1)}else this._shapingInfo=null};return e}(e.default(h.default));b.default=g})},"esri/views/2d/layers/features/textUtils":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});b.codepoints=function(b){for(var k=Array(b.length),f=0;f<b.length;f++)k[f]=b.charCodeAt(f);
return k}})},"esri/views/2d/engine/webgl/mesh/templates/WGLFillTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Logger ../../../../../../core/mathUtils ../../../../../../core/screenUtils ../../../../../../core/libs/earcut/earcut ../../color ../../definitions ../../enums ../../number ../../TileClipper ../../WGLDisplayRecord ../../materialKey/MaterialKey ../Tesselator ./WGLMeshTemplate".split(" "),function(g,b,l,k,f,a,q,m,d,c,e,h,p,n,
u,x){Object.defineProperty(b,"__esModule",{value:!0});var v=k.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLFillTemplate"),t=[],w=[];g=function(b){function k(a,e,f,m,p,k,g,l,q){var r=b.call(this)||this;r.fillColor=f;r.tl=m;r.br=p;r.aux1=k;r.aux2=g;r.aux3=l;r.isBFS=q;r.geometryType=c.WGLGeometryType.FILL;r.forceLibtess=!1;a=n.FillMaterialKey.load(n.createMaterialKey(r.geometryType,a,!1));e&&(a.sdf=e.sdf,a.pattern=!0,a.textureBinding=e.textureBinding);r._materialKey=a.data;r._tesselator=new u.default;
r._tileClipper=new h.TileClipper(0,0,0,1,8);r._tileClipper.setExtent(d.TILE_SIZE);return r}l(k,b);k.fromCIMFill=function(c,b,d,h){void 0===h&&(h=!1);var n=b.color,n=n&&m.premultiplyAlphaRGBA(n)||0,p=e.i8888to32(0,0,0,b.colorLocked?1:0);if(!d)return new k(c,null,n,0,0,0,0,p,h);var p=d.rect,g=d.width,l=d.height,q=p.x+1,r=p.y+1,t=q+g,u=r+l,p=f.nextHighestPowerOfTwo(a.pt2px(b.height||0));255<p?p=255:0>=p&&(p=f.nextHighestPowerOfTwo(u-r));g=f.nextHighestPowerOfTwo(a.pt2px(b.height/l*g||0));255<g?g=255:
0>=g&&(g=f.nextHighestPowerOfTwo(t-q));l=a.pt2px(b.offsetX||0)+128;255<l&&(l=255);var x=a.pt2px(-b.offsetY||0)+128;255<x&&(x=255);b=b.scaleX||1;q=e.i1616to32(q,r);t=e.i1616to32(t,u);p=e.i8888to32(g,p,l,x);b=e.i1616to32(128*b,128);return new k(c,d,n,q,t,p,b,0,h)};k.fromSimpleFill=function(a,c,b,d){void 0===d&&(d=!1);var h=c.color;c=h&&"none"!==c.style&&m.premultiplyAlphaRGBA(h)||0;h=e.i8888to32(0,0,0,d?255:0);if(!b)return new k(a,null,c,0,0,0,0,h,d);var n=b.rect,p=n.x+1,g=n.y+1,l=n.x+1+b.width,q=n.y+
1+b.height,n=e.i1616to32(p,g),r=e.i1616to32(l,q),p=e.i8888to32(f.nextHighestPowerOfTwo(l-p),f.nextHighestPowerOfTwo(q-g),0,0),g=e.i1616to32(128,128);return new k(a,b,c,n,r,p,g,h,d)};k.fromPictureFill=function(c,b,h,n){void 0===n&&(n=!1);var m=d.PICTURE_FILL_COLOR,p=h.rect,g=p.x+1,l=p.y+1,p=g+h.width,q=l+h.height,g=e.i1616to32(g,l),p=e.i1616to32(p,q),q=f.nextHighestPowerOfTwo(a.pt2px(b.width));255<q&&(q=255);l=f.nextHighestPowerOfTwo(a.pt2px(b.height));255<l&&(l=255);var r=a.pt2px(b.xoffset)+128;255<
r&&(r=255);var t=a.pt2px(-b.yoffset)+128;255<t&&(t=255);q=e.i8888to32(q,l,r,t);b=e.i1616to32(128*b.xscale,128*b.yscale);l=e.i8888to32(0,0,0,n?255:0);return new k(c,h,m,g,p,q,b,l,n)};k.prototype.writeMesh=function(a,c,b,e,d){t.length=0;if("esriGeometryPolygon"!==b)"esriGeometryPolyline"!==b&&v.error("Unable to handle geometryType: "+b);else{var h=d.geometry;b=n.FillMaterialKey.load(this._materialKey);var f=(d=this._isClippingRequired(h))?this._clip(h,!1):h.rings;if(b.dotDensity){for(var h=h.rings,
m=0,p=0;p<h.length;p++)for(var k=h[p],g=k[0],l=g[0],g=g[1],q=1;q<k.length;q++)var r=k[q],u=l+r[0],r=g+r[1],m=m-(u-l)*(r+g)/2,l=u,g=r;h=m}else h=0;this.forceLibtess?this._writeMeshLibtess(a,c,e,f,d,b,h):this._writeMeshEarcut(a,c,e,f,d,b,h)||this._writeMeshLibtess(a,c,e,f,d,b,h)}};k.prototype._isClippingRequired=function(a){var c=d.TILE_SIZE+8,b=0;for(a=a.rings;b<a.length;b++){var e=a[b],h=e.length;if(!(3>h)){var f=e[0][0],n=e[0][1];if(-8>f||f>c||-8>n||n>c)return!0;for(var m=1;m<h;++m)if(f+=e[m][0],
n+=e[m][1],-8>f||f>c||-8>n||n>c)return!0}}return!1};k.prototype._clip=function(a,c){var b;this._tileClipper.reset(3);for(var e=0,d=a.rings;e<d.length;e++){var h=d[e],f=h.length;if(!(3>f)){a=h[0][0];b=h[0][1];this._tileClipper.moveTo(a,b);for(var n=1;n<f;++n)a+=h[n][0],b+=h[n][1],this._tileClipper.lineTo(a,b);this._tileClipper.close()}}return this._tileClipper.result(c)};k.prototype._writeMeshLibtess=function(a,c,b,e,d,h,f){if(e&&e.length){var n=[],m=c.indexVector;c=c.getVector("geometry");var k=new p(b,
this.geometryType,this._materialKey),g=c.vertexCount;k.vertexFrom=g;k.indexFrom=m.length;this._tesselator.beginPolygon(t,n);for(var l=0;l<e.length;l++){var q=e[l];if(!(3>q.length)){this._tesselator.beginContour();var r=void 0,u=void 0;d?(r=q[0].x,u=q[0].y):(r=q[0][0],u=q[0][1]);var x=[r,u,0];this._tesselator.addVertex(x,x);for(x=1;x<q.length-1;x++){var w=void 0,v=void 0;d?(r=q[x].x,u=q[x].y):(w=q[x][0],v=q[x][1],r+=w,u+=v);w=[r,u,0];this._tesselator.addVertex(w,w)}this._tesselator.endContour()}}this._tesselator.endPolygon();
this._writeVerticesLibTess(k,c,b,t,h,f);this._writeIndicesLibTess(k,m,g,n);0<k.indexCount&&a.push(k)}};k.prototype._writeMeshEarcut=function(a,c,b,e,d,h,f){if(e&&e.length){var n=c.indexVector;c=c.getVector("geometry");var m=new p(b,this.geometryType,this._materialKey),k=n.length,g=c.data.length;m.vertexFrom=c.vertexCount;m.indexFrom=n.length;for(var l=0,q=0,r=0;r<e.length;r++){var u=e[r],x=q,v=void 0,y=void 0;d?(v=u[0].x,y=u[0].y):(v=u[0][0],y=u[0][1]);t[q++]=v;t[q++]=y;for(var A=0,z=1;z<u.length;++z){var B=
void 0,C=void 0;d?(B=v,C=y,v=u[z].x,y=u[z].y,B=v-B,C=y-C):(B=u[z][0],C=u[z][1],v+=B,y+=C);A-=B*(y+y-C);t[q++]=v;t[q++]=y}if(0<A){if(0<x-l){if(!this._write(m,n,c,b,t,w,l,x,h,f))return n.seek(k),c.data.seek(g),t.length=w.length=0,!1;l=x}w.length=0}else 0>A?0<x-l?w.push(.5*(x-l)):q=x:q=x}if(0<q-l&&!this._write(m,n,c,b,t,w,l,q,h,f))return n.seek(k),c.data.seek(g),t.length=w.length=0,!1;t.length=w.length=0;a.push(m);return!0}};k.prototype._write=function(a,c,b,e,d,h,f,n,m,p){d=d.slice(f,n);f=q.earcut(d,
h,2);if(0<q.deviation(d,h,2,f))return!1;if(f.length)return h=b.vertexCount,this._writeVertices(a,b,e,d,m,p),this._writeIndices(a,c,h,f),!0};k.prototype._writeVertices=function(a,c,b,d,h,f){for(var n=0;n<d.length;n+=2){var m=e.i1616to32(d[n],d[n+1]);c.data.push(m);c.data.push(b);h.dotDensity?c.data.writeF32(1/f):(c.data.push(this.fillColor),c.data.push(this.tl),c.data.push(this.br),c.data.push(this.aux1),c.data.push(this.aux2),c.data.push(this.aux3));a.vertexCount++}};k.prototype._writeIndices=function(a,
c,b,e){for(var d=0;d<e.length;d+=3)c.push(b+e[d]),c.push(b+e[d+1]),c.push(b+e[d+2]),a.indexCount+=3};k.prototype._writeVerticesLibTess=function(a,c,b,d,h,f){for(var n=0;n<d.length;n+=2){var m=e.i1616to32(d[n],d[n+1]);c.data.push(m);c.data.push(b);h.dotDensity?c.data.writeF32(1/f):(c.data.push(this.fillColor),c.data.push(this.tl),c.data.push(this.br),c.data.push(this.aux1),c.data.push(this.aux2),c.data.push(this.aux3));a.vertexCount++}};k.prototype._writeIndicesLibTess=function(a,c,b,e){for(var d=
0;d<e.length;d++)c.push(b+e[d]),a.indexCount++};return k}(x.default);b.default=g})},"esri/views/2d/engine/webgl/mesh/Tesselator":function(){define(["require","exports","../../../../../core/Logger","../../../../../core/libs/libtess/libtess"],function(g,b,l,k){Object.defineProperty(b,"__esModule",{value:!0});var f=l.getLogger("esri.views.2d.engine.webgl.mesh.templates.Tesselator");g=function(){function a(){this._indexCounter=this._currentVertexIndex=0;this._triangleIndices=[-1,-1,-1];this.glu=new k.GluTesselator;
this.glu.gluTessCallback(k.gluEnum.GLU_TESS_BEGIN,this._begincallback.bind(this));this.glu.gluTessCallback(k.gluEnum.GLU_TESS_VERTEX_DATA,this._vertexCallback.bind(this));this.glu.gluTessCallback(k.gluEnum.GLU_TESS_END,this._endcallback.bind(this));this.glu.gluTessCallback(k.gluEnum.GLU_TESS_COMBINE,this._combinecallback.bind(this));this.glu.gluTessCallback(k.gluEnum.GLU_TESS_ERROR,this._errorcallback.bind(this));this.glu.gluTessCallback(k.gluEnum.GLU_TESS_EDGE_FLAG,this._edgeCallback.bind(this));
this.glu.gluTessProperty(k.gluEnum.GLU_TESS_WINDING_RULE,k.windingRule.GLU_TESS_WINDING_ODD)}a.prototype.beginPolygon=function(a,b){this._triangleIndices[0]=-1;this._triangleIndices[1]=-1;this._triangleIndices[2]=-1;this._indexCounter=this._currentVertexIndex=0;this.glu.gluTessBeginPolygon(a);this._indices=b};a.prototype.endPolygon=function(){this.glu.gluTessEndPolygon()};a.prototype.beginContour=function(){this.glu.gluTessBeginContour()};a.prototype.endContour=function(){this.glu.gluTessEndContour()};
a.prototype.addVertex=function(a,b){this.glu.gluTessVertex(a,b)};a.prototype._vertexCallback=function(a,b){b[b.length]=a[0];b[b.length]=a[1];this._triangleIndices[this._currentVertexIndex]=-1;if(2<=this._currentVertexIndex){for(a=0;3>a;a++)-1===this._triangleIndices[a]&&(this._triangleIndices[a]=this._indexCounter++),this._indices[this._indices.length]=this._triangleIndices[a];this._currentVertexIndex=0}else this._currentVertexIndex++};a.prototype._begincallback=function(){this._triangleIndices[0]=
-1;this._triangleIndices[1]=-1;this._triangleIndices[2]=-1;this._currentVertexIndex=0};a.prototype._endcallback=function(){this._currentVertexIndex=0};a.prototype._errorcallback=function(a){f.error("Encountered error during tesselation: "+a)};a.prototype._combinecallback=function(a){return[a[0],a[1],a[2]]};a.prototype._edgeCallback=function(){};return a}();b.default=g})},"esri/core/libs/libtess/libtess":function(){define([],function(){var g={DEBUG:!1,assert:function(b,l){if(g.DEBUG&&!b)throw Error("Assertion failed"+
(l?": "+l:""));},GLU_TESS_MAX_COORD:1E150,TRUE_PROJECT:!1,GLU_TESS_DEFAULT_TOLERANCE:0,windingRule:{GLU_TESS_WINDING_ODD:100130,GLU_TESS_WINDING_NONZERO:100131,GLU_TESS_WINDING_POSITIVE:100132,GLU_TESS_WINDING_NEGATIVE:100133,GLU_TESS_WINDING_ABS_GEQ_TWO:100134},primitiveType:{GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,GL_TRIANGLE_FAN:6},errorType:{GLU_TESS_MISSING_BEGIN_POLYGON:100151,GLU_TESS_MISSING_END_POLYGON:100153,GLU_TESS_MISSING_BEGIN_CONTOUR:100152,GLU_TESS_MISSING_END_CONTOUR:100154,
GLU_TESS_COORD_TOO_LARGE:100155,GLU_TESS_NEED_COMBINE_CALLBACK:100156},gluEnum:{GLU_TESS_BEGIN:100100,GLU_TESS_VERTEX:100101,GLU_TESS_END:100102,GLU_TESS_ERROR:100103,GLU_TESS_EDGE_FLAG:100104,GLU_TESS_COMBINE:100105,GLU_TESS_BEGIN_DATA:100106,GLU_TESS_VERTEX_DATA:100107,GLU_TESS_END_DATA:100108,GLU_TESS_ERROR_DATA:100109,GLU_TESS_EDGE_FLAG_DATA:100110,GLU_TESS_COMBINE_DATA:100111,GLU_TESS_MESH:100112,GLU_TESS_TOLERANCE:100142,GLU_TESS_WINDING_RULE:100140,GLU_TESS_BOUNDARY_ONLY:100141,GLU_INVALID_ENUM:100900,
GLU_INVALID_VALUE:100901},geom:{}};g.geom.vertEq=function(b,g){return b.s===g.s&&b.t===g.t};g.geom.vertLeq=function(b,g){return b.s<g.s||b.s===g.s&&b.t<=g.t};g.geom.edgeEval=function(b,l,k){g.assert(g.geom.vertLeq(b,l)&&g.geom.vertLeq(l,k));var f=l.s-b.s,a=k.s-l.s;return 0<f+a?f<a?l.t-b.t+f/(f+a)*(b.t-k.t):l.t-k.t+a/(f+a)*(k.t-b.t):0};g.geom.edgeSign=function(b,l,k){g.assert(g.geom.vertLeq(b,l)&&g.geom.vertLeq(l,k));var f=l.s-b.s,a=k.s-l.s;return 0<f+a?(l.t-k.t)*f+(l.t-b.t)*a:0};g.geom.transLeq=function(b,
g){return b.t<g.t||b.t===g.t&&b.s<=g.s};g.geom.transEval=function(b,l,k){g.assert(g.geom.transLeq(b,l)&&g.geom.transLeq(l,k));var f=l.t-b.t,a=k.t-l.t;return 0<f+a?f<a?l.s-b.s+f/(f+a)*(b.s-k.s):l.s-k.s+a/(f+a)*(k.s-b.s):0};g.geom.transSign=function(b,l,k){g.assert(g.geom.transLeq(b,l)&&g.geom.transLeq(l,k));var f=l.t-b.t,a=k.t-l.t;return 0<f+a?(l.s-k.s)*f+(l.s-b.s)*a:0};g.geom.edgeGoesLeft=function(b){return g.geom.vertLeq(b.dst(),b.org)};g.geom.edgeGoesRight=function(b){return g.geom.vertLeq(b.org,
b.dst())};g.geom.vertL1dist=function(b,g){return Math.abs(b.s-g.s)+Math.abs(b.t-g.t)};g.geom.vertCCW=function(b,g,k){return 0<=b.s*(g.t-k.t)+g.s*(k.t-b.t)+k.s*(b.t-g.t)};g.geom.interpolate_=function(b,g,k,f){b=0>b?0:b;k=0>k?0:k;return b<=k?0===k?(g+f)/2:g+b/(b+k)*(f-g):f+k/(b+k)*(g-f)};g.geom.edgeIntersect=function(b,l,k,f,a){var q,m;g.geom.vertLeq(b,l)||(q=b,b=l,l=q);g.geom.vertLeq(k,f)||(q=k,k=f,f=q);g.geom.vertLeq(b,k)||(q=b,b=k,k=q,q=l,l=f,f=q);g.geom.vertLeq(k,l)?g.geom.vertLeq(l,f)?(q=g.geom.edgeEval(b,
k,l),m=g.geom.edgeEval(k,l,f),0>q+m&&(q=-q,m=-m),a.s=g.geom.interpolate_(q,k.s,m,l.s)):(q=g.geom.edgeSign(b,k,l),m=-g.geom.edgeSign(b,f,l),0>q+m&&(q=-q,m=-m),a.s=g.geom.interpolate_(q,k.s,m,f.s)):a.s=(k.s+l.s)/2;g.geom.transLeq(b,l)||(q=b,b=l,l=q);g.geom.transLeq(k,f)||(q=k,k=f,f=q);g.geom.transLeq(b,k)||(q=b,b=k,k=q,q=l,l=f,f=q);g.geom.transLeq(k,l)?g.geom.transLeq(l,f)?(q=g.geom.transEval(b,k,l),m=g.geom.transEval(k,l,f),0>q+m&&(q=-q,m=-m),a.t=g.geom.interpolate_(q,k.t,m,l.t)):(q=g.geom.transSign(b,
k,l),m=-g.geom.transSign(b,f,l),0>q+m&&(q=-q,m=-m),a.t=g.geom.interpolate_(q,k.t,m,f.t)):a.t=(k.t+l.t)/2};g.mesh={};g.mesh.makeEdge=function(b){var l=g.mesh.makeEdgePair_(b.eHead);g.mesh.makeVertex_(l,b.vHead);g.mesh.makeVertex_(l.sym,b.vHead);g.mesh.makeFace_(l,b.fHead);return l};g.mesh.meshSplice=function(b,l){var k=!1,f=!1;b!==l&&(l.org!==b.org&&(f=!0,g.mesh.killVertex_(l.org,b.org)),l.lFace!==b.lFace&&(k=!0,g.mesh.killFace_(l.lFace,b.lFace)),g.mesh.splice_(l,b),f||(g.mesh.makeVertex_(l,b.org),
b.org.anEdge=b),k||(g.mesh.makeFace_(l,b.lFace),b.lFace.anEdge=b))};g.mesh.deleteEdge=function(b){var l=b.sym,k=!1;b.lFace!==b.rFace()&&(k=!0,g.mesh.killFace_(b.lFace,b.rFace()));b.oNext===b?g.mesh.killVertex_(b.org,null):(b.rFace().anEdge=b.oPrev(),b.org.anEdge=b.oNext,g.mesh.splice_(b,b.oPrev()),k||g.mesh.makeFace_(b,b.lFace));l.oNext===l?(g.mesh.killVertex_(l.org,null),g.mesh.killFace_(l.lFace,null)):(b.lFace.anEdge=l.oPrev(),l.org.anEdge=l.oNext,g.mesh.splice_(l,l.oPrev()));g.mesh.killEdge_(b)};
g.mesh.addEdgeVertex=function(b){var l=g.mesh.makeEdgePair_(b),k=l.sym;g.mesh.splice_(l,b.lNext);l.org=b.dst();g.mesh.makeVertex_(k,l.org);l.lFace=k.lFace=b.lFace;return l};g.mesh.splitEdge=function(b){var l=g.mesh.addEdgeVertex(b).sym;g.mesh.splice_(b.sym,b.sym.oPrev());g.mesh.splice_(b.sym,l);b.sym.org=l.org;l.dst().anEdge=l.sym;l.sym.lFace=b.rFace();l.winding=b.winding;l.sym.winding=b.sym.winding;return l};g.mesh.connect=function(b,l){var k=!1,f=g.mesh.makeEdgePair_(b),a=f.sym;l.lFace!==b.lFace&&
(k=!0,g.mesh.killFace_(l.lFace,b.lFace));g.mesh.splice_(f,b.lNext);g.mesh.splice_(a,l);f.org=b.dst();a.org=l.org;f.lFace=a.lFace=b.lFace;b.lFace.anEdge=a;k||g.mesh.makeFace_(f,b.lFace);return f};g.mesh.zapFace=function(b){var l=b.anEdge,k=l.lNext,f;do if(f=k,k=f.lNext,f.lFace=null,null===f.rFace()){f.oNext===f?g.mesh.killVertex_(f.org,null):(f.org.anEdge=f.oNext,g.mesh.splice_(f,f.oPrev()));var a=f.sym;a.oNext===a?g.mesh.killVertex_(a.org,null):(a.org.anEdge=a.oNext,g.mesh.splice_(a,a.oPrev()));g.mesh.killEdge_(f)}while(f!==
l);l=b.prev;b=b.next;b.prev=l;l.next=b};g.mesh.meshUnion=function(b,g){var k=b.fHead,f=b.vHead,a=b.eHead,l=g.fHead,m=g.vHead;g=g.eHead;l.next!==l&&(k.prev.next=l.next,l.next.prev=k.prev,l.prev.next=k,k.prev=l.prev);m.next!==m&&(f.prev.next=m.next,m.next.prev=f.prev,m.prev.next=f,f.prev=m.prev);g.next!==g&&(a.sym.next.sym.next=g.next,g.next.sym.next=a.sym.next,g.sym.next.sym.next=a,a.sym.next=g.sym.next);return b};g.mesh.deleteMesh=function(b){};g.mesh.makeEdgePair_=function(b){var l=new g.GluHalfEdge,
k=new g.GluHalfEdge,f=b.sym.next;k.next=f;f.sym.next=l;l.next=b;b.sym.next=k;l.sym=k;l.oNext=l;l.lNext=k;k.sym=l;k.oNext=k;return k.lNext=l};g.mesh.splice_=function(b,g){var k=b.oNext,f=g.oNext;k.sym.lNext=g;f.sym.lNext=b;b.oNext=f;g.oNext=k};g.mesh.makeVertex_=function(b,l){var k=l.prev,f=new g.GluVertex(l,k);k.next=f;l.prev=f;l=f.anEdge=b;do l.org=f,l=l.oNext;while(l!==b)};g.mesh.makeFace_=function(b,l){var k=l.prev,f=new g.GluFace(l,k);k.next=f;l.prev=f;f.anEdge=b;f.inside=l.inside;l=b;do l.lFace=
f,l=l.lNext;while(l!==b)};g.mesh.killEdge_=function(b){var g=b.next;b=b.sym.next;g.sym.next=b;b.sym.next=g};g.mesh.killVertex_=function(b,g){var k=b.anEdge,f=k;do f.org=g,f=f.oNext;while(f!==k);g=b.prev;b=b.next;b.prev=g;g.next=b};g.mesh.killFace_=function(b,g){var k=b.anEdge,f=k;do f.lFace=g,f=f.lNext;while(f!==k);g=b.prev;b=b.next;b.prev=g;g.next=b};g.normal={};g.normal.S_UNIT_X_=1;g.normal.S_UNIT_Y_=0;g.normal.projectPolygon=function(b,l,k,f){var a=!1,q=[l,k,f];0===l&&0===k&&0===f&&(g.normal.computeNormal_(b,
q),a=!0);k=g.normal.longAxis_(q);l=b.mesh.vHead;if(g.TRUE_PROJECT){g.normal.normalize_(q);f=[0,0,0];var m=[0,0,0];f[k]=0;f[(k+1)%3]=g.normal.S_UNIT_X_;f[(k+2)%3]=g.normal.S_UNIT_Y_;k=g.normal.dot_(f,q);f[0]-=k*q[0];f[1]-=k*q[1];f[2]-=k*q[2];g.normal.normalize_(f);m[0]=q[1]*f[2]-q[2]*f[1];m[1]=q[2]*f[0]-q[0]*f[2];m[2]=q[0]*f[1]-q[1]*f[0];g.normal.normalize_(m);for(q=l.next;q!==l;q=q.next)q.s=g.normal.dot_(q.coords,f),q.t=g.normal.dot_(q.coords,m)}else for(f=(k+1)%3,m=(k+2)%3,k=0<q[k]?1:-1,q=l.next;q!==
l;q=q.next)q.s=q.coords[f],q.t=k*q.coords[m];a&&g.normal.checkOrientation_(b)};g.normal.dot_=function(b,g){return b[0]*g[0]+b[1]*g[1]+b[2]*g[2]};g.normal.normalize_=function(b){var l=b[0]*b[0]+b[1]*b[1]+b[2]*b[2];g.assert(0<l);l=Math.sqrt(l);b[0]/=l;b[1]/=l;b[2]/=l};g.normal.longAxis_=function(b){var g=0;Math.abs(b[1])>Math.abs(b[0])&&(g=1);Math.abs(b[2])>Math.abs(b[g])&&(g=2);return g};g.normal.computeNormal_=function(b,l){var k=[-2*g.GLU_TESS_MAX_COORD,-2*g.GLU_TESS_MAX_COORD,-2*g.GLU_TESS_MAX_COORD],
f=[2*g.GLU_TESS_MAX_COORD,2*g.GLU_TESS_MAX_COORD,2*g.GLU_TESS_MAX_COORD],a=[],q=[],m;b=b.mesh.vHead;for(m=b.next;m!==b;m=m.next)for(var d=0;3>d;++d){var c=m.coords[d];c<f[d]&&(f[d]=c,q[d]=m);c>k[d]&&(k[d]=c,a[d]=m)}m=0;k[1]-f[1]>k[0]-f[0]&&(m=1);k[2]-f[2]>k[m]-f[m]&&(m=2);if(f[m]>=k[m])l[0]=0,l[1]=0,l[2]=1;else{k=0;f=q[m];a=a[m];q=[0,0,0];f=[f.coords[0]-a.coords[0],f.coords[1]-a.coords[1],f.coords[2]-a.coords[2]];d=[0,0,0];for(m=b.next;m!==b;m=m.next)d[0]=m.coords[0]-a.coords[0],d[1]=m.coords[1]-
a.coords[1],d[2]=m.coords[2]-a.coords[2],q[0]=f[1]*d[2]-f[2]*d[1],q[1]=f[2]*d[0]-f[0]*d[2],q[2]=f[0]*d[1]-f[1]*d[0],c=q[0]*q[0]+q[1]*q[1]+q[2]*q[2],c>k&&(k=c,l[0]=q[0],l[1]=q[1],l[2]=q[2]);0>=k&&(l[0]=l[1]=l[2]=0,l[g.normal.longAxis_(f)]=1)}};g.normal.checkOrientation_=function(b){for(var g=0,k=b.mesh.fHead,f=k.next;f!==k;f=f.next){var a=f.anEdge;if(!(0>=a.winding)){do g+=(a.org.s-a.dst().s)*(a.org.t+a.dst().t),a=a.lNext;while(a!==f.anEdge)}}if(0>g)for(b=b.mesh.vHead,g=b.next;g!==b;g=g.next)g.t=-g.t};
g.render={};g.render.renderMesh=function(b,l,k){for(var f=!1,a=-1,q=l.fHead.prev;q!==l.fHead;q=q.prev)if(q.inside){f||(b.callBeginCallback(g.primitiveType.GL_TRIANGLES),f=!0);var m=q.anEdge;g.assert(m.lNext.lNext.lNext===m,"renderMesh called with non-triangulated mesh");do{if(k){var d=m.rFace().inside?0:1;a!==d&&(a=d,b.callEdgeFlagCallback(!!a))}b.callVertexCallback(m.org.data);m=m.lNext}while(m!==q.anEdge)}f&&b.callEndCallback()};g.render.renderBoundary=function(b,l){for(var k=l.fHead.next;k!==l.fHead;k=
k.next)if(k.inside){b.callBeginCallback(g.primitiveType.GL_LINE_LOOP);var f=k.anEdge;do b.callVertexCallback(f.org.data),f=f.lNext;while(f!==k.anEdge);b.callEndCallback()}};g.sweep={};g.sweep.SENTINEL_COORD_=4*g.GLU_TESS_MAX_COORD;g.sweep.TOLERANCE_NONZERO_=!1;g.sweep.computeInterior=function(b){b.fatalError=!1;g.sweep.removeDegenerateEdges_(b);g.sweep.initPriorityQ_(b);g.sweep.initEdgeDict_(b);for(var l;null!==(l=b.pq.extractMin());){for(;;){var k=b.pq.minimum();if(null===k||!g.geom.vertEq(k,l))break;
k=b.pq.extractMin();g.sweep.spliceMergeVertices_(b,l.anEdge,k.anEdge)}g.sweep.sweepEvent_(b,l)}l=b.dict.getMin().getKey();b.event=l.eUp.org;g.sweep.doneEdgeDict_(b);g.sweep.donePriorityQ_(b);g.sweep.removeDegenerateFaces_(b.mesh);b.mesh.checkMesh()};g.sweep.addWinding_=function(b,g){b.winding+=g.winding;b.sym.winding+=g.sym.winding};g.sweep.edgeLeq_=function(b,l,k){b=b.event;l=l.eUp;k=k.eUp;if(l.dst()===b)return k.dst()===b?g.geom.vertLeq(l.org,k.org)?0>=g.geom.edgeSign(k.dst(),l.org,k.org):0<=g.geom.edgeSign(l.dst(),
k.org,l.org):0>=g.geom.edgeSign(k.dst(),b,k.org);if(k.dst()===b)return 0<=g.geom.edgeSign(l.dst(),b,l.org);l=g.geom.edgeEval(l.dst(),b,l.org);b=g.geom.edgeEval(k.dst(),b,k.org);return l>=b};g.sweep.deleteRegion_=function(b,l){l.fixUpperEdge&&g.assert(0===l.eUp.winding);l.eUp.activeRegion=null;b.dict.deleteNode(l.nodeUp);l.nodeUp=null};g.sweep.fixUpperEdge_=function(b,l){g.assert(b.fixUpperEdge);g.mesh.deleteEdge(b.eUp);b.fixUpperEdge=!1;b.eUp=l;l.activeRegion=b};g.sweep.topLeftRegion_=function(b){var l=
b.eUp.org;do b=b.regionAbove();while(b.eUp.org===l);b.fixUpperEdge&&(l=g.mesh.connect(b.regionBelow().eUp.sym,b.eUp.lNext),g.sweep.fixUpperEdge_(b,l),b=b.regionAbove());return b};g.sweep.topRightRegion_=function(b){var g=b.eUp.dst();do b=b.regionAbove();while(b.eUp.dst()===g);return b};g.sweep.addRegionBelow_=function(b,l,k){var f=new g.ActiveRegion;f.eUp=k;f.nodeUp=b.dict.insertBefore(l.nodeUp,f);return k.activeRegion=f};g.sweep.isWindingInside_=function(b,l){switch(b.windingRule){case g.windingRule.GLU_TESS_WINDING_ODD:return 0!==
(l&1);case g.windingRule.GLU_TESS_WINDING_NONZERO:return 0!==l;case g.windingRule.GLU_TESS_WINDING_POSITIVE:return 0<l;case g.windingRule.GLU_TESS_WINDING_NEGATIVE:return 0>l;case g.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:return 2<=l||-2>=l}g.assert(!1);return!1};g.sweep.computeWinding_=function(b,l){l.windingNumber=l.regionAbove().windingNumber+l.eUp.winding;l.inside=g.sweep.isWindingInside_(b,l.windingNumber)};g.sweep.finishRegion_=function(b,l){var k=l.eUp,f=k.lFace;f.inside=l.inside;f.anEdge=
k;g.sweep.deleteRegion_(b,l)};g.sweep.finishLeftRegions_=function(b,l,k){var f=l;for(l=l.eUp;f!==k;){f.fixUpperEdge=!1;var a=f.regionBelow(),q=a.eUp;if(q.org!==l.org){if(!a.fixUpperEdge){g.sweep.finishRegion_(b,f);break}q=g.mesh.connect(l.lPrev(),q.sym);g.sweep.fixUpperEdge_(a,q)}l.oNext!==q&&(g.mesh.meshSplice(q.oPrev(),q),g.mesh.meshSplice(l,q));g.sweep.finishRegion_(b,f);l=a.eUp;f=a}return l};g.sweep.addRightEdges_=function(b,l,k,f,a,q){var m=!0;do g.assert(g.geom.vertLeq(k.org,k.dst())),g.sweep.addRegionBelow_(b,
l,k.sym),k=k.oNext;while(k!==f);for(null===a&&(a=l.regionBelow().eUp.rPrev());;){f=l.regionBelow();k=f.eUp.sym;if(k.org!==a.org)break;k.oNext!==a&&(g.mesh.meshSplice(k.oPrev(),k),g.mesh.meshSplice(a.oPrev(),k));f.windingNumber=l.windingNumber-k.winding;f.inside=g.sweep.isWindingInside_(b,f.windingNumber);l.dirty=!0;!m&&g.sweep.checkForRightSplice_(b,l)&&(g.sweep.addWinding_(k,a),g.sweep.deleteRegion_(b,l),g.mesh.deleteEdge(a));m=!1;l=f;a=k}l.dirty=!0;g.assert(l.windingNumber-k.winding===f.windingNumber);
q&&g.sweep.walkDirtyRegions_(b,l)};g.sweep.callCombine_=function(b,l,k,f,a){var q=[l.coords[0],l.coords[1],l.coords[2]];l.data=null;l.data=b.callCombineCallback(q,k,f);null===l.data&&(a?b.fatalError||(b.callErrorCallback(g.errorType.GLU_TESS_NEED_COMBINE_CALLBACK),b.fatalError=!0):l.data=k[0])};g.sweep.spliceMergeVertices_=function(b,l,k){var f=[null,null,null,null];f[0]=l.org.data;f[1]=k.org.data;g.sweep.callCombine_(b,l.org,f,[.5,.5,0,0],!1);g.mesh.meshSplice(l,k)};g.sweep.vertexWeights_=function(b,
l,k,f,a){var q=g.geom.vertL1dist(l,b),m=g.geom.vertL1dist(k,b),d=a+1;f[a]=.5*m/(q+m);f[d]=.5*q/(q+m);b.coords[0]+=f[a]*l.coords[0]+f[d]*k.coords[0];b.coords[1]+=f[a]*l.coords[1]+f[d]*k.coords[1];b.coords[2]+=f[a]*l.coords[2]+f[d]*k.coords[2]};g.sweep.getIntersectData_=function(b,l,k,f,a,q){var m=[0,0,0,0],d=[k.data,f.data,a.data,q.data];l.coords[0]=l.coords[1]=l.coords[2]=0;g.sweep.vertexWeights_(l,k,f,m,0);g.sweep.vertexWeights_(l,a,q,m,2);g.sweep.callCombine_(b,l,d,m,!0)};g.sweep.checkForRightSplice_=
function(b,l){var k=l.regionBelow(),f=l.eUp,a=k.eUp;if(g.geom.vertLeq(f.org,a.org)){if(0<g.geom.edgeSign(a.dst(),f.org,a.org))return!1;g.geom.vertEq(f.org,a.org)?f.org!==a.org&&(b.pq.remove(f.org.pqHandle),g.sweep.spliceMergeVertices_(b,a.oPrev(),f)):(g.mesh.splitEdge(a.sym),g.mesh.meshSplice(f,a.oPrev()),l.dirty=k.dirty=!0)}else{if(0>g.geom.edgeSign(f.dst(),a.org,f.org))return!1;l.regionAbove().dirty=l.dirty=!0;g.mesh.splitEdge(f.sym);g.mesh.meshSplice(a.oPrev(),f)}return!0};g.sweep.checkForLeftSplice_=
function(b,l){var k=l.regionBelow();b=l.eUp;var f=k.eUp;g.assert(!g.geom.vertEq(b.dst(),f.dst()));if(g.geom.vertLeq(b.dst(),f.dst())){if(0>g.geom.edgeSign(b.dst(),f.dst(),b.org))return!1;l.regionAbove().dirty=l.dirty=!0;k=g.mesh.splitEdge(b);g.mesh.meshSplice(f.sym,k);k.lFace.inside=l.inside}else{if(0<g.geom.edgeSign(f.dst(),b.dst(),f.org))return!1;l.dirty=k.dirty=!0;k=g.mesh.splitEdge(f);g.mesh.meshSplice(b.lNext,f.sym);k.rFace().inside=l.inside}return!0};g.sweep.checkForIntersect_=function(b,l){var k=
l.regionBelow(),f=l.eUp,a=k.eUp,q=f.org,m=a.org,d=f.dst(),c=a.dst(),e=new g.GluVertex;g.assert(!g.geom.vertEq(c,d));g.assert(0>=g.geom.edgeSign(d,b.event,q));g.assert(0<=g.geom.edgeSign(c,b.event,m));g.assert(q!==b.event&&m!==b.event);g.assert(!l.fixUpperEdge&&!k.fixUpperEdge);if(q===m||Math.min(q.t,d.t)>Math.max(m.t,c.t))return!1;if(g.geom.vertLeq(q,m)){if(0<g.geom.edgeSign(c,q,m))return!1}else if(0>g.geom.edgeSign(d,m,q))return!1;g.geom.edgeIntersect(d,q,c,m,e);g.assert(Math.min(q.t,d.t)<=e.t);
g.assert(e.t<=Math.max(m.t,c.t));g.assert(Math.min(c.s,d.s)<=e.s);g.assert(e.s<=Math.max(m.s,q.s));g.geom.vertLeq(e,b.event)&&(e.s=b.event.s,e.t=b.event.t);var h=g.geom.vertLeq(q,m)?q:m;g.geom.vertLeq(h,e)&&(e.s=h.s,e.t=h.t);if(g.geom.vertEq(e,q)||g.geom.vertEq(e,m))return g.sweep.checkForRightSplice_(b,l),!1;if(!g.geom.vertEq(d,b.event)&&0<=g.geom.edgeSign(d,b.event,e)||!g.geom.vertEq(c,b.event)&&0>=g.geom.edgeSign(c,b.event,e)){if(c===b.event)return g.mesh.splitEdge(f.sym),g.mesh.meshSplice(a.sym,
f),l=g.sweep.topLeftRegion_(l),f=l.regionBelow().eUp,g.sweep.finishLeftRegions_(b,l.regionBelow(),k),g.sweep.addRightEdges_(b,l,f.oPrev(),f,f,!0),!0;if(d===b.event)return g.mesh.splitEdge(a.sym),g.mesh.meshSplice(f.lNext,a.oPrev()),k=l,l=g.sweep.topRightRegion_(l),q=l.regionBelow().eUp.rPrev(),k.eUp=a.oPrev(),a=g.sweep.finishLeftRegions_(b,k,null),g.sweep.addRightEdges_(b,l,a.oNext,f.rPrev(),q,!0),!0;0<=g.geom.edgeSign(d,b.event,e)&&(l.regionAbove().dirty=l.dirty=!0,g.mesh.splitEdge(f.sym),f.org.s=
b.event.s,f.org.t=b.event.t);0>=g.geom.edgeSign(c,b.event,e)&&(l.dirty=k.dirty=!0,g.mesh.splitEdge(a.sym),a.org.s=b.event.s,a.org.t=b.event.t);return!1}g.mesh.splitEdge(f.sym);g.mesh.splitEdge(a.sym);g.mesh.meshSplice(a.oPrev(),f);f.org.s=e.s;f.org.t=e.t;f.org.pqHandle=b.pq.insert(f.org);g.sweep.getIntersectData_(b,f.org,q,d,m,c);l.regionAbove().dirty=l.dirty=k.dirty=!0;return!1};g.sweep.walkDirtyRegions_=function(b,l){for(var k=l.regionBelow();;){for(;k.dirty;)l=k,k=k.regionBelow();if(!l.dirty&&
(k=l,l=l.regionAbove(),null===l||!l.dirty))break;l.dirty=!1;var f=l.eUp,a=k.eUp;f.dst()!==a.dst()&&g.sweep.checkForLeftSplice_(b,l)&&(k.fixUpperEdge?(g.sweep.deleteRegion_(b,k),g.mesh.deleteEdge(a),k=l.regionBelow(),a=k.eUp):l.fixUpperEdge&&(g.sweep.deleteRegion_(b,l),g.mesh.deleteEdge(f),l=k.regionAbove(),f=l.eUp));if(f.org!==a.org)if(f.dst()===a.dst()||l.fixUpperEdge||k.fixUpperEdge||f.dst()!==b.event&&a.dst()!==b.event)g.sweep.checkForRightSplice_(b,l);else if(g.sweep.checkForIntersect_(b,l))break;
f.org===a.org&&f.dst()===a.dst()&&(g.sweep.addWinding_(a,f),g.sweep.deleteRegion_(b,l),g.mesh.deleteEdge(f),l=k.regionAbove())}};g.sweep.connectRightVertex_=function(b,l,k){var f=k.oNext,a=l.regionBelow(),q=l.eUp,m=a.eUp,d=!1;q.dst()!==m.dst()&&g.sweep.checkForIntersect_(b,l);g.geom.vertEq(q.org,b.event)&&(g.mesh.meshSplice(f.oPrev(),q),l=g.sweep.topLeftRegion_(l),f=l.regionBelow().eUp,g.sweep.finishLeftRegions_(b,l.regionBelow(),a),d=!0);g.geom.vertEq(m.org,b.event)&&(g.mesh.meshSplice(k,m.oPrev()),
k=g.sweep.finishLeftRegions_(b,a,null),d=!0);d?g.sweep.addRightEdges_(b,l,k.oNext,f,f,!0):(f=g.geom.vertLeq(m.org,q.org)?m.oPrev():q,f=g.mesh.connect(k.lPrev(),f),g.sweep.addRightEdges_(b,l,f,f.oNext,f.oNext,!1),f.sym.activeRegion.fixUpperEdge=!0,g.sweep.walkDirtyRegions_(b,l))};g.sweep.connectLeftDegenerate_=function(b,l,k){var f=l.eUp;if(g.geom.vertEq(f.org,k))g.assert(g.sweep.TOLERANCE_NONZERO_),g.sweep.TOLERANCE_NONZERO_&&g.sweep.spliceMergeVertices_(b,f,k.anEdge);else if(g.geom.vertEq(f.dst(),
k)){if(g.assert(g.sweep.TOLERANCE_NONZERO_),g.sweep.TOLERANCE_NONZERO_){l=g.sweep.topRightRegion_(l);var f=l.regionBelow(),a=f.eUp.sym,q=a.oNext,m=q;f.fixUpperEdge&&(g.assert(q!==a),g.sweep.deleteRegion_(b,f),g.mesh.deleteEdge(a),a=q.oPrev());g.mesh.meshSplice(k.anEdge,a);g.geom.edgeGoesLeft(q)||(q=null);g.sweep.addRightEdges_(b,l,a.oNext,m,q,!0)}}else g.mesh.splitEdge(f.sym),l.fixUpperEdge&&(g.mesh.deleteEdge(f.oNext),l.fixUpperEdge=!1),g.mesh.meshSplice(k.anEdge,f),g.sweep.sweepEvent_(b,k)};g.sweep.connectLeftVertex_=
function(b,l){var k=new g.ActiveRegion;k.eUp=l.anEdge.sym;var k=b.dict.search(k).getKey(),f=k.regionBelow(),a=k.eUp,q=f.eUp;0===g.geom.edgeSign(a.dst(),l,a.org)?g.sweep.connectLeftDegenerate_(b,k,l):(f=g.geom.vertLeq(q.dst(),a.dst())?k:f,k.inside||f.fixUpperEdge?(a=f===k?g.mesh.connect(l.anEdge.sym,a.lNext):g.mesh.connect(q.dNext(),l.anEdge).sym,f.fixUpperEdge?g.sweep.fixUpperEdge_(f,a):g.sweep.computeWinding_(b,g.sweep.addRegionBelow_(b,k,a)),g.sweep.sweepEvent_(b,l)):g.sweep.addRightEdges_(b,k,
l.anEdge,l.anEdge,null,!0))};g.sweep.sweepEvent_=function(b,l){b.event=l;for(var k=l.anEdge;null===k.activeRegion;)if(k=k.oNext,k===l.anEdge){g.sweep.connectLeftVertex_(b,l);return}l=g.sweep.topLeftRegion_(k.activeRegion);var f=l.regionBelow(),k=f.eUp,f=g.sweep.finishLeftRegions_(b,f,null);f.oNext===k?g.sweep.connectRightVertex_(b,l,f):g.sweep.addRightEdges_(b,l,f.oNext,k,k,!0)};g.sweep.addSentinel_=function(b,l){var k=new g.ActiveRegion,f=g.mesh.makeEdge(b.mesh);f.org.s=g.sweep.SENTINEL_COORD_;f.org.t=
l;f.dst().s=-g.sweep.SENTINEL_COORD_;f.dst().t=l;b.event=f.dst();k.eUp=f;k.windingNumber=0;k.inside=!1;k.fixUpperEdge=!1;k.sentinel=!0;k.dirty=!1;k.nodeUp=b.dict.insert(k)};g.sweep.initEdgeDict_=function(b){b.dict=new g.Dict(b,g.sweep.edgeLeq_);g.sweep.addSentinel_(b,-g.sweep.SENTINEL_COORD_);g.sweep.addSentinel_(b,g.sweep.SENTINEL_COORD_)};g.sweep.doneEdgeDict_=function(b){for(var l=0,k;null!==(k=b.dict.getMin().getKey());)k.sentinel||(g.assert(k.fixUpperEdge),g.assert(1===++l)),g.assert(0===k.windingNumber),
g.sweep.deleteRegion_(b,k);b.dict=null};g.sweep.removeDegenerateEdges_=function(b){for(var l=b.mesh.eHead,k,f=l.next;f!==l;f=k){k=f.next;var a=f.lNext;g.geom.vertEq(f.org,f.dst())&&f.lNext.lNext!==f&&(g.sweep.spliceMergeVertices_(b,a,f),g.mesh.deleteEdge(f),f=a,a=f.lNext);if(a.lNext===f){if(a!==f){if(a===k||a===k.sym)k=k.next;g.mesh.deleteEdge(a)}if(f===k||f===k.sym)k=k.next;g.mesh.deleteEdge(f)}}};g.sweep.initPriorityQ_=function(b){var l=new g.PriorityQ;b.pq=l;b=b.mesh.vHead;var k;for(k=b.next;k!==
b;k=k.next)k.pqHandle=l.insert(k);l.init()};g.sweep.donePriorityQ_=function(b){b.pq.deleteQ();b.pq=null};g.sweep.removeDegenerateFaces_=function(b){for(var l,k=b.fHead.next;k!==b.fHead;k=l)l=k.next,k=k.anEdge,g.assert(k.lNext!==k),k.lNext.lNext===k&&(g.sweep.addWinding_(k.oNext,k),g.mesh.deleteEdge(k))};g.tessmono={};g.tessmono.tessellateMonoRegion_=function(b){b=b.anEdge;for(g.assert(b.lNext!==b&&b.lNext.lNext!==b);g.geom.vertLeq(b.dst(),b.org);b=b.lPrev());for(;g.geom.vertLeq(b.org,b.dst());b=b.lNext);
for(var l=b.lPrev(),k;b.lNext!==l;)if(g.geom.vertLeq(b.dst(),l.org)){for(;l.lNext!==b&&(g.geom.edgeGoesLeft(l.lNext)||0>=g.geom.edgeSign(l.org,l.dst(),l.lNext.dst()));)k=g.mesh.connect(l.lNext,l),l=k.sym;l=l.lPrev()}else{for(;l.lNext!==b&&(g.geom.edgeGoesRight(b.lPrev())||0<=g.geom.edgeSign(b.dst(),b.org,b.lPrev().org));)k=g.mesh.connect(b,b.lPrev()),b=k.sym;b=b.lNext}for(g.assert(l.lNext!==b);l.lNext.lNext!==b;)k=g.mesh.connect(l.lNext,l),l=k.sym};g.tessmono.tessellateInterior=function(b){for(var l,
k=b.fHead.next;k!==b.fHead;k=l)l=k.next,k.inside&&g.tessmono.tessellateMonoRegion_(k)};g.tessmono.discardExterior=function(b){for(var l,k=b.fHead.next;k!==b.fHead;k=l)l=k.next,k.inside||g.mesh.zapFace(k)};g.tessmono.setWindingNumber=function(b,l,k){for(var f,a=b.eHead.next;a!==b.eHead;a=f)f=a.next,a.rFace().inside!==a.lFace.inside?a.winding=a.lFace.inside?l:-l:k?g.mesh.deleteEdge(a):a.winding=0};g.Dict=function(b,l){this.head_=new g.DictNode;this.frame_=b;this.leq_=l};g.Dict.prototype.deleteDict_=
function(){};g.Dict.prototype.insertBefore=function(b,l){do b=b.prev;while(null!==b.key&&!this.leq_(this.frame_,b.key,l));l=new g.DictNode(l,b.next,b);b.next.prev=l;return b.next=l};g.Dict.prototype.insert=function(b){return this.insertBefore(this.head_,b)};g.Dict.prototype.deleteNode=function(b){b.next.prev=b.prev;b.prev.next=b.next};g.Dict.prototype.search=function(b){var g=this.head_;do g=g.next;while(null!==g.key&&!this.leq_(this.frame_,b,g.key));return g};g.Dict.prototype.getMin=function(){return this.head_.next};
g.Dict.prototype.getMax=function(){return this.head_.prev};g.DictNode=function(b,g,k){this.key=b||null;this.next=g||this;this.prev=k||this};g.DictNode.prototype.getKey=function(){return this.key};g.DictNode.prototype.getSuccessor=function(){return this.next};g.DictNode.prototype.getPredecessor=function(){return this.prev};g.GluTesselator=function(){this.state_=g.GluTesselator.tessState_.T_DORMANT;this.errorCallback_=this.mesh=this.lastEdge_=null;this.normal_=[0,0,0];this.windingRule=g.windingRule.GLU_TESS_WINDING_ODD;
this.fatalError=!1;this.combineCallback_=this.event=this.pq=this.dict=null;this.boundaryOnly_=!1;this.polygonData_=this.meshCallback_=this.endCallback_=this.vertexCallback_=this.edgeFlagCallback_=this.beginCallback_=null};g.GluTesselator.tessState_={T_DORMANT:0,T_IN_POLYGON:1,T_IN_CONTOUR:2};g.GluTesselator.prototype.gluDeleteTess=function(){this.requireState_(g.GluTesselator.tessState_.T_DORMANT)};g.GluTesselator.prototype.gluTessProperty=function(b,l){switch(b){case g.gluEnum.GLU_TESS_TOLERANCE:return;
case g.gluEnum.GLU_TESS_WINDING_RULE:switch(l){case g.windingRule.GLU_TESS_WINDING_ODD:case g.windingRule.GLU_TESS_WINDING_NONZERO:case g.windingRule.GLU_TESS_WINDING_POSITIVE:case g.windingRule.GLU_TESS_WINDING_NEGATIVE:case g.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:this.windingRule=l;return}break;case g.gluEnum.GLU_TESS_BOUNDARY_ONLY:this.boundaryOnly_=!!l;return;default:this.callErrorCallback(g.gluEnum.GLU_INVALID_ENUM);return}this.callErrorCallback(g.gluEnum.GLU_INVALID_VALUE)};g.GluTesselator.prototype.gluGetTessProperty=
function(b){switch(b){case g.gluEnum.GLU_TESS_TOLERANCE:return 0;case g.gluEnum.GLU_TESS_WINDING_RULE:return b=this.windingRule,g.assert(b===g.windingRule.GLU_TESS_WINDING_ODD||b===g.windingRule.GLU_TESS_WINDING_NONZERO||b===g.windingRule.GLU_TESS_WINDING_POSITIVE||b===g.windingRule.GLU_TESS_WINDING_NEGATIVE||b===g.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO),b;case g.gluEnum.GLU_TESS_BOUNDARY_ONLY:return g.assert(!0===this.boundaryOnly_||!1===this.boundaryOnly_),this.boundaryOnly_;default:this.callErrorCallback(g.gluEnum.GLU_INVALID_ENUM)}return!1};
g.GluTesselator.prototype.gluTessNormal=function(b,g,k){this.normal_[0]=b;this.normal_[1]=g;this.normal_[2]=k};g.GluTesselator.prototype.gluTessCallback=function(b,l){l=l?l:null;switch(b){case g.gluEnum.GLU_TESS_BEGIN:case g.gluEnum.GLU_TESS_BEGIN_DATA:this.beginCallback_=l;break;case g.gluEnum.GLU_TESS_EDGE_FLAG:case g.gluEnum.GLU_TESS_EDGE_FLAG_DATA:this.edgeFlagCallback_=l;break;case g.gluEnum.GLU_TESS_VERTEX:case g.gluEnum.GLU_TESS_VERTEX_DATA:this.vertexCallback_=l;break;case g.gluEnum.GLU_TESS_END:case g.gluEnum.GLU_TESS_END_DATA:this.endCallback_=
l;break;case g.gluEnum.GLU_TESS_ERROR:case g.gluEnum.GLU_TESS_ERROR_DATA:this.errorCallback_=l;break;case g.gluEnum.GLU_TESS_COMBINE:case g.gluEnum.GLU_TESS_COMBINE_DATA:this.combineCallback_=l;break;case g.gluEnum.GLU_TESS_MESH:this.meshCallback_=l;break;default:this.callErrorCallback(g.gluEnum.GLU_INVALID_ENUM)}};g.GluTesselator.prototype.gluTessVertex=function(b,l){var k=!1,f=[0,0,0];this.requireState_(g.GluTesselator.tessState_.T_IN_CONTOUR);for(var a=0;3>a;++a){var q=b[a];q<-g.GLU_TESS_MAX_COORD&&
(q=-g.GLU_TESS_MAX_COORD,k=!0);q>g.GLU_TESS_MAX_COORD&&(q=g.GLU_TESS_MAX_COORD,k=!0);f[a]=q}k&&this.callErrorCallback(g.errorType.GLU_TESS_COORD_TOO_LARGE);this.addVertex_(f,l)};g.GluTesselator.prototype.gluTessBeginPolygon=function(b){this.requireState_(g.GluTesselator.tessState_.T_DORMANT);this.state_=g.GluTesselator.tessState_.T_IN_POLYGON;this.mesh=new g.GluMesh;this.polygonData_=b};g.GluTesselator.prototype.gluTessBeginContour=function(){this.requireState_(g.GluTesselator.tessState_.T_IN_POLYGON);
this.state_=g.GluTesselator.tessState_.T_IN_CONTOUR;this.lastEdge_=null};g.GluTesselator.prototype.gluTessEndContour=function(){this.requireState_(g.GluTesselator.tessState_.T_IN_CONTOUR);this.state_=g.GluTesselator.tessState_.T_IN_POLYGON};g.GluTesselator.prototype.gluTessEndPolygon=function(){this.requireState_(g.GluTesselator.tessState_.T_IN_POLYGON);this.state_=g.GluTesselator.tessState_.T_DORMANT;g.normal.projectPolygon(this,this.normal_[0],this.normal_[1],this.normal_[2]);g.sweep.computeInterior(this);
if(!this.fatalError){var b=this.mesh;this.boundaryOnly_?g.tessmono.setWindingNumber(b,1,!0):g.tessmono.tessellateInterior(b);this.mesh.checkMesh();if(this.beginCallback_||this.endCallback_||this.vertexCallback_||this.edgeFlagCallback_)this.boundaryOnly_?g.render.renderBoundary(this,this.mesh):g.render.renderMesh(this,this.mesh,!!this.edgeFlagCallback_);if(this.meshCallback_){g.tessmono.discardExterior(this.mesh);this.meshCallback_(this.mesh);this.polygonData_=this.mesh=null;return}}g.mesh.deleteMesh(this.mesh);
this.mesh=this.polygonData_=null};g.GluTesselator.prototype.requireState_=function(b){this.state_!==b&&this.gotoState_(b)};g.GluTesselator.prototype.gotoState_=function(b){for(;this.state_!==b;)if(this.state_<b)switch(this.state_){case g.GluTesselator.tessState_.T_DORMANT:this.callErrorCallback(g.errorType.GLU_TESS_MISSING_BEGIN_POLYGON);this.gluTessBeginPolygon(null);break;case g.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(g.errorType.GLU_TESS_MISSING_BEGIN_CONTOUR),this.gluTessBeginContour()}else switch(this.state_){case g.GluTesselator.tessState_.T_IN_CONTOUR:this.callErrorCallback(g.errorType.GLU_TESS_MISSING_END_CONTOUR);
this.gluTessEndContour();break;case g.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(g.errorType.GLU_TESS_MISSING_END_POLYGON),this.gluTessEndPolygon()}};g.GluTesselator.prototype.addVertex_=function(b,l){var k=this.lastEdge_;null===k?(k=g.mesh.makeEdge(this.mesh),g.mesh.meshSplice(k,k.sym)):(g.mesh.splitEdge(k),k=k.lNext);k.org.data=l;k.org.coords[0]=b[0];k.org.coords[1]=b[1];k.org.coords[2]=b[2];k.winding=1;k.sym.winding=-1;this.lastEdge_=k};g.GluTesselator.prototype.callBeginCallback=
function(b){this.beginCallback_&&this.beginCallback_(b,this.polygonData_)};g.GluTesselator.prototype.callVertexCallback=function(b){this.vertexCallback_&&this.vertexCallback_(b,this.polygonData_)};g.GluTesselator.prototype.callEdgeFlagCallback=function(b){this.edgeFlagCallback_&&this.edgeFlagCallback_(b,this.polygonData_)};g.GluTesselator.prototype.callEndCallback=function(){this.endCallback_&&this.endCallback_(this.polygonData_)};g.GluTesselator.prototype.callCombineCallback=function(b,g,k){return this.combineCallback_?
this.combineCallback_(b,g,k,this.polygonData_)||null:null};g.GluTesselator.prototype.callErrorCallback=function(b){this.errorCallback_&&this.errorCallback_(b,this.polygonData_)};g.GluFace=function(b,g){this.next=b||this;this.prev=g||this;this.anEdge=null;this.inside=!1};g.GluHalfEdge=function(b){this.next=b||this;this.activeRegion=this.lFace=this.org=this.lNext=this.oNext=this.sym=null;this.winding=0};g.GluHalfEdge.prototype.rFace=function(){return this.sym.lFace};g.GluHalfEdge.prototype.dst=function(){return this.sym.org};
g.GluHalfEdge.prototype.oPrev=function(){return this.sym.lNext};g.GluHalfEdge.prototype.lPrev=function(){return this.oNext.sym};g.GluHalfEdge.prototype.dPrev=function(){return this.lNext.sym};g.GluHalfEdge.prototype.rPrev=function(){return this.sym.oNext};g.GluHalfEdge.prototype.dNext=function(){return this.rPrev().sym};g.GluHalfEdge.prototype.rNext=function(){return this.oPrev().sym};g.GluMesh=function(){this.vHead=new g.GluVertex;this.fHead=new g.GluFace;this.eHead=new g.GluHalfEdge;this.eHeadSym=
new g.GluHalfEdge;this.eHead.sym=this.eHeadSym;this.eHeadSym.sym=this.eHead};g.GluMesh.prototype.checkMesh=function(){if(g.DEBUG){var b=this.fHead,l=this.vHead,k=this.eHead,f,a;for(f=f=b;(a=f.next)!==b;f=a){g.assert(a.prev===f);f=a.anEdge;do g.assert(f.sym!==f),g.assert(f.sym.sym===f),g.assert(f.lNext.oNext.sym===f),g.assert(f.oNext.sym.lNext===f),g.assert(f.lFace===a),f=f.lNext;while(f!==a.anEdge)}g.assert(a.prev===f&&null===a.anEdge);for(f=f=l;(b=f.next)!==l;f=b){g.assert(b.prev===f);f=b.anEdge;
do g.assert(f.sym!==f),g.assert(f.sym.sym===f),g.assert(f.lNext.oNext.sym===f),g.assert(f.oNext.sym.lNext===f),g.assert(f.org===b),f=f.oNext;while(f!==b.anEdge)}g.assert(b.prev===f&&null===b.anEdge&&null===b.data);for(l=l=k;(f=l.next)!==k;l=f)g.assert(f.sym.next===l.sym),g.assert(f.sym!==f),g.assert(f.sym.sym===f),g.assert(null!==f.org),g.assert(null!==f.dst()),g.assert(f.lNext.oNext.sym===f),g.assert(f.oNext.sym.lNext===f);g.assert(f.sym.next===l.sym&&f.sym===this.eHeadSym&&f.sym.sym===f&&null===
f.org&&null===f.dst()&&null===f.lFace&&null===f.rFace())}};g.GluVertex=function(b,g){this.next=b||this;this.prev=g||this;this.data=this.anEdge=null;this.coords=[0,0,0];this.pqHandle=this.t=this.s=0};g.PriorityQ=function(){this.verts_=[];this.order_=null;this.size_=0;this.initialized_=!1;this.heap_=new g.PriorityQHeap};g.PriorityQ.prototype.deleteQ=function(){this.verts_=this.order_=this.heap_=null};g.PriorityQ.prototype.init=function(){this.order_=[];for(var b=0;b<this.size_;b++)this.order_[b]=b;
b=function(b){return function(f,a){return g.geom.vertLeq(b[f],b[a])?1:-1}}(this.verts_);this.order_.sort(b);this.initialized_=!0;this.heap_.init();if(g.DEBUG)for(var l=0+this.size_-1,b=0;b<l;++b)g.assert(g.geom.vertLeq(this.verts_[this.order_[b+1]],this.verts_[this.order_[b]]))};g.PriorityQ.prototype.insert=function(b){if(this.initialized_)return this.heap_.insert(b);var g=this.size_++;this.verts_[g]=b;return-(g+1)};g.PriorityQ.prototype.extractMin=function(){if(0===this.size_)return this.heap_.extractMin();
var b=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var l=this.heap_.minimum();if(g.geom.vertLeq(l,b))return this.heap_.extractMin()}do--this.size_;while(0<this.size_&&null===this.verts_[this.order_[this.size_-1]]);return b};g.PriorityQ.prototype.minimum=function(){if(0===this.size_)return this.heap_.minimum();var b=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var l=this.heap_.minimum();if(g.geom.vertLeq(l,b))return l}return b};g.PriorityQ.prototype.remove=function(b){if(0<=
b)this.heap_.remove(b);else for(b=-(b+1),g.assert(b<this.verts_.length&&null!==this.verts_[b]),this.verts_[b]=null;0<this.size_&&null===this.verts_[this.order_[this.size_-1]];)--this.size_};g.PriorityQHeap=function(){this.heap_=g.PriorityQHeap.reallocNumeric_([0],g.PriorityQHeap.INIT_SIZE_+1);this.verts_=[null,null];this.handles_=[0,0];this.size_=0;this.max_=g.PriorityQHeap.INIT_SIZE_;this.freeList_=0;this.initialized_=!1;this.heap_[1]=1};g.PriorityQHeap.INIT_SIZE_=32;g.PriorityQHeap.reallocNumeric_=
function(b,g){for(var k=Array(g),f=0;f<b.length;f++)k[f]=b[f];for(;f<g;f++)k[f]=0;return k};g.PriorityQHeap.prototype.init=function(){for(var b=this.size_;1<=b;--b)this.floatDown_(b);this.initialized_=!0};g.PriorityQHeap.prototype.insert=function(b){var l=++this.size_;2*l>this.max_&&(this.max_*=2,this.handles_=g.PriorityQHeap.reallocNumeric_(this.handles_,this.max_+1));var k;0===this.freeList_?k=l:(k=this.freeList_,this.freeList_=this.handles_[this.freeList_]);this.verts_[k]=b;this.handles_[k]=l;
this.heap_[l]=k;this.initialized_&&this.floatUp_(l);return k};g.PriorityQHeap.prototype.isEmpty=function(){return 0===this.size_};g.PriorityQHeap.prototype.minimum=function(){return this.verts_[this.heap_[1]]};g.PriorityQHeap.prototype.extractMin=function(){var b=this.heap_,g=this.verts_,k=this.handles_,f=b[1],a=g[f];0<this.size_&&(b[1]=b[this.size_],k[b[1]]=1,g[f]=null,k[f]=this.freeList_,this.freeList_=f,0<--this.size_&&this.floatDown_(1));return a};g.PriorityQHeap.prototype.remove=function(b){var l=
this.heap_,k=this.verts_,f=this.handles_;g.assert(1<=b&&b<=this.max_&&null!==k[b]);var a=f[b];l[a]=l[this.size_];f[l[a]]=a;a<=--this.size_&&(1>=a?this.floatDown_(a):g.geom.vertLeq(k[l[a>>1]],k[l[a]])?this.floatDown_(a):this.floatUp_(a));k[b]=null;f[b]=this.freeList_;this.freeList_=b};g.PriorityQHeap.prototype.floatDown_=function(b){for(var l=this.heap_,k=this.verts_,f=this.handles_,a=l[b];;){var q=b<<1;q<this.size_&&g.geom.vertLeq(k[l[q+1]],k[l[q]])&&(q+=1);g.assert(q<=this.max_);var m=l[q];if(q>
this.size_||g.geom.vertLeq(k[a],k[m])){l[b]=a;f[a]=b;break}l[b]=m;f[m]=b;b=q}};g.PriorityQHeap.prototype.floatUp_=function(b){for(var l=this.heap_,k=this.verts_,f=this.handles_,a=l[b];;){var q=b>>1,m=l[q];if(0===q||g.geom.vertLeq(k[m],k[a])){l[b]=a;f[a]=b;break}l[b]=m;f[m]=b;b=q}};g.ActiveRegion=function(){this.nodeUp=this.eUp=null;this.windingNumber=0;this.fixUpperEdge=this.dirty=this.sentinel=this.inside=!1};g.ActiveRegion.prototype.regionBelow=function(){return this.nodeUp.getPredecessor().getKey()};
g.ActiveRegion.prototype.regionAbove=function(){return this.nodeUp.getSuccessor().getKey()};return g})},"esri/views/2d/engine/webgl/util/Lock":function(){define(["require","exports","../../../../../core/promiseUtils"],function(g,b,l){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(){this._resolver=null}b.prototype.isHeld=function(){return!!this._resolver};b.prototype.acquire=function(){var b=this;return this._resolver?this._resolver.promise.then(function(){return b.acquire()}):
(this._resolver=l.createResolver(),l.resolve())};b.prototype.release=function(){var b=this._resolver;this._resolver=null;b.resolve()};return b}();b.default=g;b.withLock=function(b,f,a){return b.acquire().then(function(){return f(a)}).then(function(){return b.release()}).catch(function(a){b.release();throw a;})}})},"esri/views/2d/engine/webgl/TileData":function(){define("require exports ./MemoryRequirements ./TileBufferData ./TileDisplayData ./Utils ./Utils ./WGLDisplayObject ./WGLDisplayRecord ./mesh/VertexBuffer ./util/Reader ./util/serializationUtils ./util/Writer".split(" "),
function(g,b,l,k,f,a,q,m,d,c,e,h,p){Object.defineProperty(b,"__esModule",{value:!0});var n=new l.default,u=new l.default;g=function(){function b(){this.tileBufferData=this.tileDisplayData=null}b.prototype.reshuffle=function(){n.reset();for(var c=f.groupRecordsByGeometryType(this.tileDisplayData.displayObjects),e=0;e<c.length;e++)for(var d=c[e],h=0,m=d;h<m.length;h++){var p=m[h];p&&n.needMore(p.geometryType,p.meshData?p.meshData.vertexCount:p.vertexCount,p.meshData?p.meshData.indexData.length:p.indexCount)}h=
c.length;e=new k;for(m=0;m<h;++m){e.geometries[m].indexBuffer=new Uint32Array(Math.round(1.15*n.indicesFor(m)));var p=[],g;for(g in this.tileBufferData.geometries[m].vertexBuffer)p.push(this.tileBufferData.geometries[m].vertexBuffer[g].stride);var p=b._computeVertexAlignment(p),d=Math.round(1.15*n.verticesFor(m)),p=b._align(d,p),l;for(l in this.tileBufferData.geometries[m].vertexBuffer)d=this.tileBufferData.geometries[m].vertexBuffer[l].stride,e.geometries[m].vertexBuffer[l]={stride:d,data:q.allocateTypedArrayBuffer(p,
d)}}u.reset();this.tileDisplayData.displayList.clear();for(m=0;m<h;++m){d=c[m];g=0;for(l=d;g<l.length;g++){p=l[g];if(p.meshData)p.writeMeshDataToBuffers(u.verticesFor(m),e.geometries[m].vertexBuffer,u.indicesFor(m),e.geometries[m].indexBuffer),p.meshData=null;else{var x=this.tileBufferData.geometries[m].vertexBuffer,D=this.tileBufferData.geometries[m].indexBuffer,H=e.geometries[m].vertexBuffer,F=e.geometries[m].indexBuffer,E=u.verticesFor(m),G=u.indicesFor(m);a.copyMeshData(E,G,H,F,p,x,D);p.vertexFrom=
E;p.indexFrom=G}u.needMore(m,p.vertexCount,p.indexCount)}this.tileDisplayData.displayList.unified||this.tileDisplayData.displayList.addToList(d)}if(this.tileDisplayData.displayList.unified)for(c=0,h=this.tileDisplayData.displayObjects;c<h.length;c++)this.tileDisplayData.displayList.addToList(h[c].displayRecords);this.tileBufferData=e};b.prototype.getStrides=function(){for(var a=[],c=0;c<this.tileBufferData.geometries.length;++c){var b=this.tileBufferData.geometries[c];a[c]={};for(var e in b.vertexBuffer)a[c][e]=
b.vertexBuffer[e].stride}return a};b.prototype.clone=function(){var a=new b;a.tileBufferData=this.tileBufferData.clone();a.tileDisplayData=this.tileDisplayData.clone();return a};b.prototype._guessSize=function(){for(var a=this.tileDisplayData.displayObjects,c=Math.min(a.length,4),b=0,e=0;e<c;e++)b=Math.max(b,a[e].displayRecords.length);return 2*(12*a.length+a.length*b*40)};b.prototype.serialize=function(){var a=this.tileBufferData.serialize(),c=this.tileBufferData.getBuffers(),b=this.tileDisplayData.serialize(new p.default(Int32Array,
this._guessSize())).buffer();c.push(b);return{result:{displayData:b,bufferData:a},transferList:c}};b.decode=function(a){var d=h.deserializeList(new e.default(a.displayObjects),m),f={},n;for(n in a.vertexBuffersMap)f[n]=c.VertexBuffers.decode(a.vertexBuffersMap[n]);return b.fromMeshData({displayObjects:d,vertexBuffersMap:f})};b.fromMeshData=function(a){var c=new b,e=new f.default,d=new k;e.displayObjects=a.displayObjects;for(var h in a.vertexBuffersMap){var n=a.vertexBuffersMap[h];d.geometries[h].indexBuffer=
n.indexBuffer;d.geometries[h].vertexBuffer=n.namedBuffers}c.tileDisplayData=e;c.tileBufferData=d;return c};b.bind=function(a,c){var e=new b;e.tileDisplayData=a;e.tileBufferData=c;return e};b.create=function(a,c){var e=new b;e.tileDisplayData=new f.default;e.tileDisplayData.displayObjects=a;for(var h=[0,0,0,0,0],n=[0,0,0,0,0],m=[[],[],[],[],[]],p=0;p<a.length;p++)for(var g=0,l=a[p].displayRecords;g<l.length;g++){var t=l[g];m[t.geometryType].push(t);h[t.geometryType]+=t.meshData.vertexCount;n[t.geometryType]+=
t.meshData.indexData.length}a=new k;c=[c.fill||{},c.line||{},c.icon||{},c.text||{},c.label||{}];for(p=0;5>p;p++){var g=new Uint32Array(n[p]),l=c[p],t=h[p],u={},x=void 0;for(x in l){var v={data:q.allocateTypedArrayBuffer(t,l[x]),stride:l[x]};u[x]=v}l=u;d.writeAllMeshDataToBuffers(m[p],l,g);a.geometries[p]={indexBuffer:g,vertexBuffer:l}}e.tileBufferData=a;return e};b._align=function(a,c){var b=a%c;return 0===b?a:a+(c-b)};b._computeVertexAlignment=function(a){for(var c=!1,b=!1,e=0;e<a.length;e++){var d=
a[e];2===d%4?c=!0:0!==d%4&&(b=!0)}return b?4:c?2:1};return b}();b.TileData=g})},"esri/views/2d/engine/webgl/MemoryRequirements":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(){this._byGeometryType=null}Object.defineProperty(b.prototype,"satisfied",{get:function(){return!this._byGeometryType},enumerable:!0,configurable:!0});b.prototype.reset=function(){this._byGeometryType=null};b.prototype.verticesFor=function(b){return this._byGeometryType?
this._byGeometryType[b].vertices:0};b.prototype.indicesFor=function(b){return this._byGeometryType?this._byGeometryType[b].indices:0};b.prototype.needMore=function(b,f,a){if(f||a)this._byGeometryType||(this._byGeometryType=[{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0}]),b=this._byGeometryType[b],b.vertices+=f,b.indices+=a};return b}();b.default=g})},"esri/views/2d/engine/webgl/TileBufferData":function(){define(["require","exports",
"./Utils"],function(g,b,l){return function(){function b(){this.geometries=[{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}}]}b.prototype.clone=function(){for(var f=new b,a=0;a<this.geometries.length;a++){var g=this.geometries[a],m=f.geometries[a];m.indexBuffer=g.indexBuffer.slice();m.vertexBuffer={};for(var d in g.vertexBuffer){var c=g.vertexBuffer[d],e=c.stride;
m.vertexBuffer[d]={data:c.data.slice(),stride:e}}}return f};b.deserialize=function(f){for(var a=new b,g=0;5>g;++g){a.geometries[g].indexBuffer=new Uint32Array(f.geometries[g].indexBuffer);a.geometries[g].vertexBuffer={};for(var m in f.geometries[g].vertexBuffer)a.geometries[g].vertexBuffer[m]={data:l.allocateTypedArrayBufferwithData(f.geometries[g].vertexBuffer[m].data,f.geometries[g].vertexBuffer[m].stride),stride:f.geometries[g].vertexBuffer[m].stride}}return a};b.prototype.serialize=function(){for(var b=
{geometries:[{indexBuffer:this.geometries[0].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[1].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[2].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[3].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[4].indexBuffer.buffer,vertexBuffer:{}}]},a=0;5>a;++a)for(var g in this.geometries[a].vertexBuffer)b.geometries[a].vertexBuffer[g]={data:this.geometries[a].vertexBuffer[g].data.buffer,stride:this.geometries[a].vertexBuffer[g].stride};
return b};b.prototype.getBuffers=function(){for(var b=[],a=0;5>a;++a){b.push(this.geometries[a].indexBuffer.buffer);for(var g in this.geometries[a].vertexBuffer)b.push(this.geometries[a].vertexBuffer[g].data.buffer)}return b};return b}()})},"esri/views/2d/engine/webgl/TileDisplayData":function(){define(["require","exports","./WGLDisplayList","./WGLDisplayObject","./util/serializationUtils"],function(g,b,l,k,f){function a(a){for(var b=[[],[],[],[],[]],d=0;d<a.length;d++)for(var c=0,e=a[d].displayRecords;c<
e.length;c++){var h=e[c];b[h.geometryType].push(h)}return b}Object.defineProperty(b,"__esModule",{value:!0});b.groupRecordsByGeometryType=a;g=function(){function b(){}Object.defineProperty(b.prototype,"displayObjectRegistry",{get:function(){if(!this._displayObjectRegistry){this._displayObjectRegistry=new Map;for(var a=0,b=this.displayObjects;a<b.length;a++){var c=b[a];this._displayObjectRegistry.set(c.id,c)}}return this._displayObjectRegistry},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"displayList",{get:function(){return this._displayList},enumerable:!0,configurable:!0});b.prototype.computeDisplayList=function(b){this._displayList=new l(b);if(b){b=0;for(var d=this.displayObjects;b<d.length;b++)for(var c=0,e=d[b].displayRecords;c<e.length;c++)this._displayList.addToList(e[c])}else for(b=a(this.displayObjects),d=b.length,c=0;c<d;++c)this._displayList.addToList(b[c])};b.prototype.clone=function(){var a=new b;this.displayObjects&&(a.displayObjects=this.displayObjects.map(function(a){return a.clone()}));
return a};b.prototype.serialize=function(a){f.serializeList(a,this.displayObjects);return a};b.prototype._deserializeObjects=function(a){for(var b=a.readInt32(),b=Array(b),c=new Map,e=0;e<b.length;++e){var h=k.deserialize(a);b[e]=h;c.set(h.id,h)}this.displayObjects=b;this._displayList=null;this._displayObjectRegistry=c};b.deserialize=function(a){var d=new b;d._deserializeObjects(a);return d};return b}();b.default=g})},"esri/views/2d/engine/webgl/WGLDisplayList":function(){define(["require","exports",
"../../../../core/tsSupport/generatorHelper","../../../../core/Logger","./enums"],function(g,b,l,k,f){function a(a,c,b){for(var e=[],d=3;d<arguments.length;d++)e[d-3]=arguments[d];c<a.length?a.splice.apply(a,[c,b].concat(e)):a.push.apply(a,e)}var q=k.getLogger("esri.views.2d.engine.webgl.WGLDisplayList");g=new Map;g.set(f.WGLDrawPhase.MAP,[f.WGLGeometryType.FILL,f.WGLGeometryType.LINE,f.WGLGeometryType.MARKER,f.WGLGeometryType.TEXT]);g.set(f.WGLDrawPhase.LABEL,[f.WGLGeometryType.LABEL]);g.set(f.WGLDrawPhase.LABEL_ALPHA,
[f.WGLGeometryType.LABEL]);g=function(){function b(a){void 0===a&&(a=!1);this.symbolLevels=[];this.unified=a}b.prototype.replay=function(a,c,b){if(this.unified)for(var e=0,d=this.symbolLevels;e<d.length;e++)for(var h=0,f=d[e].zLevels;h<f.length;h++){var n=f[h].geometryDPInfo,m;for(m in n)if(n[m])for(var p=0,g=n[m];p<g.length;p++){var k=g[p],l=a.painter.getGeometryBrush(k.geometryType),q=c.getGeometry(k.geometryType);l.prepareState(a,c);l.drawGeometry(a,c,k,q,b)}}};Object.defineProperty(b.prototype,
"empty",{get:function(){return!this.symbolLevels||0===this.symbolLevels.length},enumerable:!0,configurable:!0});b.prototype.clear=function(){this.symbolLevels.length=0};b.prototype.addToList=function(a,c){if(Array.isArray(a))for(var b=0;b<a.length;b++)this._addToList(a[b],c);else this._addToList(a,c)};b.prototype.removeFromList=function(a){Array.isArray(a)||(a=[a]);for(var c=null,b=0;b<a.length;b++)c=this._removeFromList(a[b]);return c};b.prototype.byType=function(a,c){for(var b=0,e=this.symbolLevels;b<
e.length;b++)for(var d=0,h=e[b].zLevels;d<h.length;d++){var f=h[d].geometryDPInfo,n=this.getDPInfoType(a);if(f[n])for(var m=0,f=f[n];m<f.length;m++)c(f[m])}};b.prototype.clone=function(){for(var a=new b(this.unified),c=0,e=this.symbolLevels;c<e.length;c++)a.symbolLevels.push(e[c].clone());return a};b.prototype.splitAfter=function(a){for(var c=this._getDisplayList(a.symbolLevel,a.zOrder,a.geometryType),b=c.length,e=a.indexFrom+a.indexCount,d=0;d<b;++d){var h=c[d];if(h.geometryType===a.geometryType&&
e>h.indexFrom&&e<=h.indexFrom+h.indexCount)return e<h.indexFrom+h.indexCount&&(a=new m,a.geometryType=h.geometryType,a.materialKey=h.materialKey,a.indexFrom=e,a.indexCount=h.indexFrom+h.indexCount-e,c.splice(d+1,0,a),h.indexCount=e-h.indexFrom),d}};b.prototype._addToList=function(c,b){var e=this._getDisplayList(c.symbolLevel,c.zOrder,c.geometryType);b=null!=b?b:e.length-1;var d=0<=b&&b<e.length?e[b]:null;null===d||d.materialKey!==c.materialKey||d.indexFrom+d.indexCount!==c.indexFrom||this.unified&&
d.geometryType!==c.geometryType?(d=new m,d.indexFrom=c.indexFrom,d.indexCount=c.indexCount,d.materialKey=c.materialKey,d.geometryType=c.geometryType,a(e,b+1,0,d)):d.indexCount+=c.indexCount};b.prototype._removeFromList=function(c){for(var b=this._getDisplayList(c.symbolLevel,c.zOrder,c.geometryType),e=b.length,d=void 0,h=0;h<e;++h){var f=b[h];if(c.indexFrom+c.indexCount>f.indexFrom&&c.indexFrom<f.indexFrom+f.indexCount&&(!this.unified||f.geometryType===c.geometryType)){d=h;break}}if(void 0!==d){f=
b[d];if(c.indexFrom===f.indexFrom)return f.indexCount-=c.indexCount,f.indexFrom+=c.indexCount,0===f.indexCount&&a(b,d,1),d-1;if(c.indexFrom+c.indexCount===f.indexFrom+f.indexCount)return f.indexCount-=c.indexCount,0===f.indexCount?(a(b,d,1),d-1):d;var e=f.indexFrom,h=c.indexFrom-f.indexFrom,p=c.indexCount;c=f.indexFrom+f.indexCount-(c.indexFrom+c.indexCount);f.indexCount=h;var g=new m;g.geometryType=f.geometryType;g.materialKey=f.materialKey;g.indexFrom=e+h+p;g.indexCount=c;a(b,d+1,0,g);return d}return null};
b.prototype._getDisplayList=function(a,b,h){for(var n,m=this.symbolLevels.length,g=0;g<m;g++)if(this.symbolLevels[g].symbolLevel===a){n=this.symbolLevels[g];break}n||(n=new e,n.symbolLevel=a,this.symbolLevels.push(n));var p;a=n.zLevels.length;for(m=0;m<a;m++)if(n.zLevels[m].zLevel===b){p=n.zLevels[m];break}p||(p=new c,p.geometryDPInfo=new d,p.zLevel=b,n.zLevels.push(p));var k;if(this.unified)p.geometryDPInfo.unified||(p.geometryDPInfo.unified=[]),k=p.geometryDPInfo.unified;else switch(h){case f.WGLGeometryType.FILL:p.geometryDPInfo.fill||
(p.geometryDPInfo.fill=[]);k=p.geometryDPInfo.fill;break;case f.WGLGeometryType.LINE:p.geometryDPInfo.line||(p.geometryDPInfo.line=[]);k=p.geometryDPInfo.line;break;case f.WGLGeometryType.MARKER:p.geometryDPInfo.marker||(p.geometryDPInfo.marker=[]);k=p.geometryDPInfo.marker;break;case f.WGLGeometryType.TEXT:p.geometryDPInfo.text||(p.geometryDPInfo.text=[]);k=p.geometryDPInfo.text;break;case f.WGLGeometryType.LABEL:p.geometryDPInfo.label||(p.geometryDPInfo.label=[]);k=p.geometryDPInfo.label;break;
default:console.error("Trying to add a record with geometry type '"+h+"'.")}return k};b.prototype.getDPInfoType=function(a){if(this.unified)return"unified";switch(a){case f.WGLGeometryType.FILL:return"fill";case f.WGLGeometryType.LINE:return"line";case f.WGLGeometryType.MARKER:return"marker";case f.WGLGeometryType.TEXT:return"text";case f.WGLGeometryType.LABEL:return"label";default:q.error("DisplayList: Tried to convert unknown geometryType: "+a)}};return b}();var m=function(){function a(){this.materialKey=
null;this.indexCount=this.indexFrom=0}a.prototype.clone=function(){var c=new a;c.geometryType=this.geometryType;c.materialKey=this.materialKey;c.indexFrom=this.indexFrom;c.indexCount=this.indexCount;return c};return a}(),d=function(){function a(){this.unified=this.label=this.text=this.marker=this.line=this.fill=null}a.prototype.clone=function(){var c=new a;c.fill=this.fill&&this.fill.map(function(a){return a.clone()});c.line=this.line&&this.line.map(function(a){return a.clone()});c.marker=this.marker&&
this.marker.map(function(a){return a.clone()});c.text=this.text&&this.text.map(function(a){return a.clone()});c.label=this.label&&this.label.map(function(a){return a.clone()});c.unified=this.unified&&this.unified.map(function(a){return a.clone()});return c};return a}(),c=function(){function a(){this.geometryDPInfo=new d}a.prototype.clone=function(){var c=new a;c.zLevel=this.zLevel;c.geometryDPInfo=this.geometryDPInfo.clone();return c};return a}(),e=function(){function a(){this.zLevels=[]}a.prototype.clone=
function(){var c=new a;c.symbolLevel=this.symbolLevel;for(var b=0,e=this.zLevels;b<e.length;b++)c.zLevels.push(e[b].clone());return c};return a}();return g})},"esri/views/2d/engine/webgl/util/Reader":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(b){this._pos=0;this._buffer=b;this._i32View=new Int32Array(this._buffer);this._f32View=new Float32Array(this._buffer)}b.prototype.readInt32=function(){return this._i32View[this._pos++]};
b.prototype.readF32=function(){return this._f32View[this._pos++]};return b}();b.default=g})},"esri/views/2d/engine/webgl/WGLRendererInfo":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../Color ../../../../core/has ../../../../core/maybe ../../../../core/screenUtils ../../../../core/unitUtils ../../../../core/libs/gl-matrix-2/mat4f32 ../../../../renderers/support/utils ./definitions ./Utils".split(" "),function(g,b,l,k,f,a,q,m,d,c,e,h){function p(a,c){var b=c.length;
if(a<c[0].value||1===b)return c[0].size;for(var e=1;e<b;e++)if(a<c[e].value)return c[e-1].size+(a-c[e-1].value)/(c[e].value-c[e-1].value)*(c[e].size-c[e-1].size);return c[b-1].size}function n(c,b,e){void 0===e&&(e=0);if(a.isNone(b))c[e+0]=0,c[e+1]=0,c[e+2]=0,c[e+3]=0;else{var d=b.g,h=b.b,f=b.a;c[e+0]=b.r*f/255;c[e+1]=d*f/255;c[e+2]=h*f/255;c[e+3]=f}}Object.defineProperty(b,"__esModule",{value:!0});var u=function(a,c,b){for(var e=b*=16,d=0;e<Math.min(b+16,a.length);e++,d++)a[e]=c[d]},x=d.mat4f32.create();
g=function(){function b(){this.symbolLevels=[];this.vvColorValues=new Float32Array(8);this.vvColors=new Float32Array(32);this.vvOpacityValues=new Float32Array(8);this.vvOpacities=new Float32Array(8);this.vvSizeMinMaxValue=new Float32Array(4);this.ddColors=new Float32Array(32);this.ddBackgroundColor=new Float32Array(4);this.ddActiveDots=new Float32Array(8);this.insideEffect=new Float32Array(16*e.MAX_FILTERS);this.insideOpacity=1;this.outsideEffect=new Float32Array(16*e.MAX_FILTERS);this.outsideOpacity=
1;this.effectCount=0;this._vvMaterialParameters={vvSizeEnabled:!1,vvColorEnabled:!1,vvRotationEnabled:!1,vvRotationType:"geographic",vvOpacityEnabled:!1};this._buf0=new Float32Array(2);this._buf1=new Float32Array(2);this.symbolLevels.push(0);for(var a=0;a<e.MAX_FILTERS;a++)u(this.insideEffect,x,a),u(this.outsideEffect,x,a)}Object.defineProperty(b.prototype,"insideOpacities",{get:function(){this._buf0[0]=1;this._buf0[1]=this.insideOpacity;return this._buf0},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"outsideOpacities",{get:function(){this._buf1[0]=0;this._buf1[1]=this.outsideOpacity;return this._buf1},enumerable:!0,configurable:!0});b.prototype.getSizeVVFieldStops=function(c){var b=this._vvSizeFieldStops;switch(b.type){case "static":return b;case "level-dependent":return a.unwrapOr(b.levels[c],function(){var e=Infinity,d=0,h;for(h in b.levels){var f=parseFloat(h),n=Math.abs(c-f);n<e&&(e=n,d=f)}if(Infinity===e)return{sizes:new Float32Array([0,0,0,0,0,0]),values:new Float32Array([0,0,0,0,0,0])};
e=Math.pow(2,(c-d)/2);d=a.expect(b.levels[d]);h=new Float32Array(d.values);h[2]*=e;h[3]*=e;return{sizes:a.unwrap(d.sizes),values:h}})}};Object.defineProperty(b.prototype,"vvMaterialParameters",{get:function(){return this._vvMaterialParameters},enumerable:!0,configurable:!0});b.prototype.update=function(c){a.isSome(this._vvInfo)&&this._updateVisualVariables(this._vvInfo.vvRanges,c)};b.prototype.setInfo=function(c,b,e){var d=this;a.isSome(e)?(e.forEach(function(a,c){return d._updateEffects(c,a)}),this.effectCount=
e.length):this.effectCount=0;this._vvInfo=b;switch(c.type){case "dot-density":this._updateDotDensityInfo(c)}};b.prototype.getVariation=function(){return{ddDotBlending:this.ddDotBlending,outsideLabelsVisible:this.outsideLabelsVisible,effectCount:this.effectCount,oesTextureFloat:f("esri-webgl-texture-float")}};b.prototype.getVariationHash=function(){return(this.ddDotBlending?1:0)|(this.outsideLabelsVisible?1:0)<<1|this.effectCount<<2};b.prototype._updateEffects=function(c,b){c+=1;if(a.isSome(b)&&b.filter&&
b.filter.enabled){this.outsideLabelsVisible=b.excludedLabelsVisible;var e=b.parsedIncludedEffect;b=b.parsedExcludedEffect;a.isSome(e)?(u(this.insideEffect,e.getColorMatrix(),c),this.insideOpacity=e.getOpacity()):(u(this.insideEffect,x,c),this.insideOpacity=1);a.isSome(b)?(u(this.outsideEffect,b.getColorMatrix(),c),this.outsideOpacity=b.getOpacity()):(u(this.outsideEffect,x,c),this.outsideOpacity=1)}else u(this.insideEffect,x,c),u(this.outsideEffect,x,c),this.outsideOpacity=this.insideOpacity=1};b.prototype._updateVisualVariables=
function(a,b){var e=this._vvMaterialParameters;e.vvOpacityEnabled=!1;e.vvSizeEnabled=!1;e.vvColorEnabled=!1;e.vvRotationEnabled=!1;if(a){var d=a.size;if(d){e.vvSizeEnabled=!0;if(d.minMaxValue){var f=d.minMaxValue,n=void 0,g=void 0;h.isDefined(f.minSize)&&h.isDefined(f.maxSize)&&(h.isNumber(f.minSize)&&h.isNumber(f.maxSize)?(n=q.pt2px(f.minSize),g=q.pt2px(f.maxSize)):(g=b.scale,n=q.pt2px(p(g,f.minSize.stops)),g=q.pt2px(p(g,f.maxSize.stops))));this.vvSizeMinMaxValue.set([f.minDataValue,f.maxDataValue,
n,g])}d.scaleStops&&(this.vvSizeScaleStopsValue=q.pt2px(p(b.scale,d.scaleStops.stops)));d.unitValue&&(this.vvSizeUnitValueToPixelsRatio=m.getMetersPerUnitForSR(b.spatialReference)/c.meterIn[d.unitValue.unit]/b.resolution);d.fieldStops&&(this._vvSizeFieldStops=d.fieldStops)}if(b=a.color)e.vvColorEnabled=!0,this.vvColorValues.set(b.values),this.vvColors.set(b.colors);if(b=a.opacity)e.vvOpacityEnabled=!0,this.vvOpacityValues.set(b.values),this.vvOpacities.set(b.opacities);if(a=a.rotation)e.vvRotationEnabled=
!0,e.vvRotationType=a.type}};b.prototype._updateDotDensityInfo=function(a){var c=a.attributes;this.ddDotValue=a.dotValue;this.ddDotScale=a.referenceScale;this.ddDotSize=a.dotSize;this.ddDotBlending=a.dotBlendingEnabled;this.ddSeed=a.seed;for(var b=0;b<e.DOT_DENSITY_MAX_FIELDS;b++){var d=b>=c.length?new k([0,0,0,0]):c[b].color;n(this.ddColors,d,4*b)}for(b=0;8>b;b++)this.ddActiveDots[b]=b<a.attributes.length?1:0;n(this.ddBackgroundColor,a.backgroundColor)};return b}();b.WGLRendererInfo=g})},"esri/views/2d/engine/webgl/WGLTile":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/libs/gl-matrix-2/mat2d ../../../../core/libs/gl-matrix-2/mat2df32 ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f32 ./definitions ./DirtyMap ./DisplayRecordStore ./Fader ./TiledDisplayObject ./WGLBuffers".split(" "),
function(g,b,l,k,f,a,q,m,d,c,e,h,p){Object.defineProperty(b,"__esModule",{value:!0});var n=new Set;g=function(b){function h(a,c,h){void 0===h&&(h=!1);a=b.call(this,a,c,[m.TILE_SIZE,m.TILE_SIZE])||this;a._data=null;a._displayList=null;a._wglBuffers=null;a._dirtyMap=new d.default;a._labelIndex=null;a._dirty=!0;a.fader=new e.default;a._ensureCorrectZOrder=h;a.transforms.labelMat2d=f.mat2df32.create();return a}l(h,b);h.prototype.destroy=function(){this.clear()};Object.defineProperty(h.prototype,"displayObjects",
{get:function(){return this._data.tileDisplayData.displayObjects},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"canDisplay",{get:function(){return!!this.attached},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"isDirty",{get:function(){return this._dirty},set:function(a){(this._dirty=a)||this.isReady||this.ready();this.requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"hasData",{get:function(){return!!this._data},enumerable:!0,
configurable:!0});Object.defineProperty(h.prototype,"labelIndex",{get:function(){return this._labelIndex},enumerable:!0,configurable:!0});h.prototype.getGeometry=function(a){return this._wglBuffers&&this._wglBuffers.has(a)?this._wglBuffers.get(a):null};h.prototype.getDisplayList=function(){return this._data&&this._displayList};Object.defineProperty(h.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0});h.prototype.setTransform=function(c,e){b.prototype.setTransform.call(this,
c,e);var d=this.transforms.labelMat2d;e=c.getScreenTransform(d,e);var h=q.vec2f32.create();a.vec2.transformMat2d(h,this.coords,e);k.mat2d.identity(d);k.mat2d.translate(d,d,h);k.mat2d.multiply(d,c.viewMat2d,d)};h.prototype.setData=function(a,b,e){var h=a.addOrUpdate,f=a.remove;!a.clear&&this.hasData||a.addOrUpdate?!a.clear&&this.hasData||!a.addOrUpdate?this.hasData&&this._doPatchData({addOrUpdate:h,remove:f},b,e):(h.tileDisplayData.computeDisplayList(this._ensureCorrectZOrder),this._dirtyMap=new d.default,
this._dispRecStore=c.default.fromTileData(h,this._dirtyMap),this._data=h,this._readyTileIfNoLabels(b,e),this._dirtyMap.markAllDirty(),this._displayList||(this._displayList=h.tileDisplayData.displayList.clone())):(this.clear(),this.ready());this.emit("change")};h.prototype.commitChanges=function(){this.fader.step()||this.requestRender();this._wglBuffers||(this._wglBuffers=new p.default(this.stage.context));this._wglBuffers.upload(this._data.tileBufferData,this._dirtyMap);this._displayList=this._data.tileDisplayData.displayList.clone();
this._dirtyMap.markAllClean()};h.prototype.clear=function(){this._dispRecStore=this._displayList=this._data=null;this._wglBuffers&&(this._wglBuffers.dispose(),this._wglBuffers=null)};h.prototype.attach=function(){return!0};h.prototype._readyTileIfNoLabels=function(a,c){a&&this._rebuildLabelIndex();this.isDirty=a&&c?!0:!1};h.prototype._doPatchData=function(a,b,e){this._patchData(a)||(this._dirtyMap.markAllDirty(),this._data.reshuffle(),this._dispRecStore=c.default.fromTileData(this._data,this._dirtyMap));
this._readyTileIfNoLabels(b,e);this.requestRender()};h.prototype._rebuildLabelIndex=function(){this._labelIndex=this._initLabelIndex();for(var a=0,c=this.displayObjects;a<c.length;a++)for(var b=0,e=c[a].metrics;b<e.length;b++)this._insertIntoLabelIndex(e[b])};h.prototype._insertIntoLabelIndex=function(a){0>a.xBucket||0>a.yBucket||3<a.yBucket||3<a.xBucket||this.labelIndex[a.yBucket][a.xBucket].push(a)};h.prototype._initLabelIndex=function(){for(var a=[],c=0;c<m.TILE_SIZE/m.COLLISION_BUCKET_SIZE;c++){a.push([]);
for(var b=0;b<m.TILE_SIZE/m.COLLISION_BUCKET_SIZE;b++)a[c].push([])}return a};h.prototype._patchData=function(a){for(var c=!0,b=a.addOrUpdate&&a.addOrUpdate.tileDisplayData&&a.addOrUpdate.tileDisplayData.displayObjects||[],e=(a.remove||[]).slice(),d=0;d<b.length;d++){var h=b[d];null!=h.insertAfter&&e.push(h.id)}for(h=0;h<e.length;h++){var f=e[h];if(d=this._data.tileDisplayData.displayObjectRegistry.get(f)){this._data.tileDisplayData.displayList.removeFromList(d.displayRecords);for(var m=0,g=d.displayRecords;m<
g.length;m++)this._dispRecStore.delete(g[m]);this._data.tileDisplayData.displayObjectRegistry.delete(f);d=this._data.tileDisplayData.displayObjects.indexOf(d);this._data.tileDisplayData.displayObjects.splice(d,1)}}for(e=0;e<b.length;e++){h=b[e];d=this._data.tileDisplayData.displayObjectRegistry.get(h.id);f=void 0;if(d){m=d.displayRecords;d.set(h);d.displayRecords=m;m=d.displayRecords.length;for(g=0;g<m;++g){var p=d.displayRecords[g],k=h.displayRecords[g];if(g>=h.displayRecords.length||p.geometryType!==
k.geometryType||p.symbolLevel!==k.symbolLevel||p.zOrder!==k.zOrder||p.materialKey!==k.materialKey)this._dispRecStore.delete(d.displayRecords[g]),g<h.displayRecords.length&&(d.displayRecords[g]=void 0)}d.displayRecords.length=h.displayRecords.length;d.metrics=h.metrics}else if(d=h.copy(),d.displayRecords=[],this._data.tileDisplayData.displayObjectRegistry.set(h.id,d),g=void 0,p=this._data.tileDisplayData.displayObjects,null!=d.insertAfter?(f={},0<=d.insertAfter?(m=this._data.tileDisplayData.displayObjectRegistry.get(d.insertAfter))?
(g=p.indexOf(m)+1,g<p.length?p.splice(g,0,d):(p.push(d),g=p.length)):(p.push(d),g=p.length):(p.unshift(d),g=0)):(p.push(d),g=p.length),f){k=void 0;if(this._data.tileDisplayData.displayList.unified)k=0<h.displayRecords.length?1:0;else{n.clear();for(var k=0,l=h.displayRecords;k<l.length;k++)m=this._data.tileDisplayData.displayList.getDPInfoType(l[k].geometryType),n.add(m);k=n.size}l=0;for(--g;0<=g&&l<k;--g)for(var q=p[g].displayRecords.length-1;0<=q&&l<k;--q){var u=p[g].displayRecords[q],m=this._data.tileDisplayData.displayList.getDPInfoType(u.geometryType);
f[m]||(f[m]=u,++l)}}l=h.displayRecords.length;for(g=0;g<l;++g){k=h.displayRecords[g];(p=d.displayRecords[g])?(p.meshData=k.meshData,p.materialKey=k.materialKey):(p=k.copy(),p.vertexFrom=void 0,p.indexFrom=void 0,d.displayRecords[g]=p);var q=k.geometryType,m=this._data.tileDisplayData.displayList.getDPInfoType(q),u=a.addOrUpdate.tileBufferData.geometries[q],q=u.vertexBuffer,u=u.indexBuffer,x=void 0;f&&(x=f[m]?this._data.tileDisplayData.displayList.splitAfter(f[m]):-1);c=this._dispRecStore.setMeshData(p,
k,q,u,x)&&c;f&&null!=p.indexFrom&&null!=p.indexFrom&&(f[m]=p)}}return c};return h}(h.TiledDisplayObject);b.WGLTile=g})},"esri/views/2d/engine/webgl/DirtyMap":function(){define(["require","exports","./Utils"],function(g,b,l){function k(b,a,g){if(!b.allDirty)if(null!=b.from&&null!=b.count){var f=Math.min(b.from,a);a=Math.max(b.from+b.count,a+g)-f;b.from=f;b.count=a}else b.from=a,b.count=g}Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(){this._dirties=l.createGeometryData(function(){return{indices:{from:null,
count:null,allDirty:!1}}},function(){return{vertices:{from:null,count:null,allDirty:!1}}})}b.prototype.hasDirty=function(){for(var a=0,b=this._dirties;a<b.length;a++){var f=b[a];if(null!==f.data.indices.count||f.data.indices.allDirty)return!0}return!1};b.prototype.markAllClean=function(){for(var a=0,b=this._dirties;a<b.length;a++){var f=b[a];f.data.indices.from=null;f.data.indices.count=null;f.data.indices.allDirty=!1;for(var d in f.buffers)f.buffers[d].data.vertices.from=null,f.buffers[d].data.vertices.count=
null,f.buffers[d].data.vertices.allDirty=!1}};b.prototype.markAllDirty=function(){for(var a=0,b=this._dirties;a<b.length;a++){var f=b[a];f.data.indices.allDirty=!0;for(var d in f.buffers)f.buffers[d].data.vertices.allDirty=!0}};b.prototype.forEach=function(a){for(var b=0;b<this._dirties.length;++b){var f=this._dirties[b],d={},c;for(c in f.buffers){var e=f.buffers[c].data.vertices;if(e.allDirty||null!=e.from&&null!=e.count&&0<e.count)d[c]=e}f=f.data.indices;e=void 0;e=f.allDirty||null!=f.from&&null!=
f.count&&0<f.count?{indices:f,vertices:d}:{indices:null,vertices:d};(e.indices||0<Object.keys(e).length)&&a(e,b)}};b.prototype.markDirtyIndices=function(a,b,f){k(this._dirties[a].data.indices,b,f)};b.prototype.markDirtyVertices=function(a,b,f,d){k(this._dirties[a].buffers[b].data.vertices,f,d)};return b}();b.default=g})},"esri/views/2d/engine/webgl/DisplayRecordStore":function(){define(["require","exports","../../../../core/has","./FreeList","./Utils"],function(g,b,l,k,f){function a(a){a=a.getStrides();
for(var b={},c=0;c<a.length;c++)b[q[c]]=a[c];return b}Object.defineProperty(b,"__esModule",{value:!0});var q=["FILL","LINE","MARKER","TEXT","LABEL"];g=function(){function b(a,c,b,h){this._strides=a;this._displayList=c;this._freeListsAndStorage={};this._dirtyMap=null;this._dirtyMap=b;for(var e in a){this._freeListsAndStorage[e]={vtxFreeList:h?new k.FreeList(h):null,idxFreeList:h?new k.FreeList(h):null,vertexBuffers:{},indexBuffer:h?new Uint32Array(h):null};for(var d in a[e])this._freeListsAndStorage[e].vertexBuffers[d]=
{data:h?f.allocateTypedArrayBuffer(h,a[e][d]):null,stride:a[e][d]}}}b.fromTileData=function(d,c){var e=a(d),h=[0,0,0,0,0],m=[0,0,0,0,0],n=[];d.tileDisplayData.displayObjectRegistry.forEach(function(a){n.push(a)});for(var g=0;g<n.length;g++)for(var l=0,v=n[g].displayRecords;l<v.length;l++){var t=v[l];h[t.geometryType]=Math.max(h[t.geometryType],t.vertexFrom+t.vertexCount);m[t.geometryType]=Math.max(m[t.geometryType],t.indexFrom+t.indexCount)}c=new b(e,d.tileDisplayData.displayList,c,null);for(e=0;e<
d.tileBufferData.geometries.length;++e){var g=h[e],v=m[e],t=d.tileBufferData.geometries[e],l=c._storageFor(q[e]),w=d.tileBufferData.geometries[e].indexBuffer;l.indexBuffer=w;l.idxFreeList=new k.FreeList(w.length);l.idxFreeList.allocate(v);var v=void 0,r;for(r in t.vertexBuffer)t=d.tileBufferData.geometries[e].vertexBuffer[r],l.vertexBuffers[r].data=t.data,l.vertexBuffers[r].stride=t.stride,w=f.strideToPackingFactor(t.stride),t=t.data.length*w/t.stride,v||(v=t);l.vtxFreeList=new k.FreeList(v);l.vtxFreeList.allocate(g)}return c};
b.prototype.delete=function(a){var c=q[a.geometryType];this._freeVertices(c,a.vertexFrom,a.vertexCount);this._freeIndices(c,a.indexFrom,a.indexCount);this._displayList.removeFromList(a);a.vertexFrom=void 0;a.indexFrom=void 0};b.prototype.setMeshData=function(a,c,b,h,m){var e=q[a.geometryType];a.meshData=null;var d=void 0,g=void 0;void 0===a.vertexFrom?(g=c.vertexCount,d=this._allocateVertices(e,g)):c.vertexCount>a.vertexCount?(this._freeVertices(e,a.vertexFrom,a.vertexCount),g=c.vertexCount,d=this._allocateVertices(e,
g)):c.vertexCount===a.vertexCount?(d=a.vertexFrom,g=a.vertexCount):(this._freeVertices(e,a.vertexFrom+c.vertexCount,a.vertexCount-c.vertexCount),d=a.vertexFrom,g=c.vertexCount);var p=!0,k=void 0,l=void 0,r=void 0;void 0===a.indexFrom?(k=m,r=c.indexCount,l=this._allocateIndices(e,r)):c.indexCount>a.indexCount?(k=this._displayList.removeFromList(a),this._freeIndices(e,a.indexFrom,a.indexCount),r=c.indexCount,l=this._allocateIndices(e,r)):c.indexCount===a.indexCount?(p=!1,l=a.indexFrom,r=a.indexCount):
(k=this._displayList.removeFromList(a),this._freeIndices(e,a.indexFrom+c.indexCount,a.indexCount-c.indexCount),l=a.indexFrom,r=c.indexCount);if(-1!==d&&-1!==l){m=this._storageFor(e);f.copyMeshData(d,l,m.vertexBuffers,m.indexBuffer,c,b,h);a.vertexFrom=d;a.indexFrom=l;a.vertexCount=c.vertexCount;a.indexCount=c.indexCount;if(this._dirtyMap){this._dirtyMap.markDirtyIndices(a.geometryType,a.indexFrom,a.indexCount);for(var y in b)this._dirtyMap.markDirtyVertices(a.geometryType,y,a.vertexFrom,a.vertexCount)}p&&
this._displayList.addToList(a,k);return!0}-1!==d&&this._freeVertices(e,d,g);-1!==l&&this._freeIndices(e,l,r);a.setMeshDataFromBuffers(c,b,h);a.vertexFrom=void 0;a.vertexCount=0;a.indexFrom=void 0;a.indexCount=0;return!1};b.prototype._allocateVertices=function(a,c){a=this._storageFor(a);c=a.vtxFreeList.allocate(c);return-1===c||.5<a.vtxFreeList.fragmentation?-1:c};b.prototype._freeVertices=function(a,c,b){this._storageFor(a).vtxFreeList.free(c,b)};b.prototype._freeIndices=function(a,c,b){this._storageFor(a).idxFreeList.free(c,
b)};b.prototype._allocateIndices=function(a,c){a=this._storageFor(a);c=a.idxFreeList.allocate(c);return-1===c||.5<a.idxFreeList.fragmentation?-1:c};b.prototype._storageFor=function(a){return this._freeListsAndStorage[a]};b.prototype._stridesFor=function(a,c){return this._strides[a][c]};return b}();b.default=g})},"esri/views/2d/engine/webgl/FreeList":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});var l=function(){function b(b){this._largestRange=
null;this._parent=b;this._updateLargestRange()}Object.defineProperty(b.prototype,"largestRange",{get:function(){return this._largestRange},enumerable:!0,configurable:!0});b.prototype.rangeCreated=function(b){if(!this._largestRange||b.count>this._largestRange.count)this._largestRange=b};b.prototype.rangeResized=function(b,a){if(b===this._largestRange)b.count<a&&this._updateLargestRange();else if(!this._largestRange||b.count>this._largestRange.count)this._largestRange=b};b.prototype.findBestRange=function(b){for(var a=
this._parent._freeHead,f=null;null!==a;)a.count>=b&&(!f||a.count-b<f.count-b)&&(f=a),a=a.next;return f};b.prototype.findAdjacentRanges=function(b,a){for(var f=!0,m=!1,d=null,c=this._parent._freeHead;f&&!m;){var e=null!==c?c.from:this._parent._size;b>=(null!==d?d.from+d.count:0)&&b+a<=e?(f=!1,m=!0):null!==c?(d=c,c=c.next):f=!1}return[d,c]};b.prototype._updateLargestRange=function(){for(var b=null,a=this._parent._freeHead;null!==a;){if(!b||a.count>b.count)b=a;a=a.next}this._largestRange=b};return b}();
g=function(){function b(b,a){this._allocated=0;this._size=b;this._freeHead=0<b?{from:0,count:b,prev:null,next:null}:null;this._bookKeeper=a||new l(this);this._freeHead&&this._bookKeeper.rangeCreated(this._freeHead)}b.prototype.allocate=function(f){var a=this._bookKeeper.findBestRange(f);if(null===a)return-1;var g=a.from,m=a.count;a.from+=f;a.count-=f;this._bookKeeper.rangeResized(a,g,m);this._allocated+=f;0===a.count&&(f=null!==a.prev?this._freeHead:a.next,b._removeRange(a),this._freeHead=f);return g};
b.prototype.free=function(f,a){var g=this._bookKeeper.findAdjacentRanges(f,a),m=g[0],g=g[1];f={from:f,count:a,prev:m,next:g};null!==m&&(m.next=f);null!==g&&(g.prev=f);this._bookKeeper.rangeCreated(f);this._allocated-=a;if(null!==g&&f.from+f.count===g.from){a=f.from;var d=f.count;b._fuse(f,g);b._removeRange(g);this._bookKeeper.rangeResized(f,a,d);this._bookKeeper.rangeResized(g,void 0,0)}null!==m&&m.from+m.count===f.from&&(a=m.from,d=m.count,b._fuse(m,f),b._removeRange(f),this._bookKeeper.rangeResized(m,
a,d),this._bookKeeper.rangeResized(f,void 0,0));this._freeHead=null!==f.prev?this._freeHead:f};Object.defineProperty(b.prototype,"fragmentation",{get:function(){var b=this._size-this._allocated;return 0===b?0:1-this._bookKeeper.largestRange.count/b},enumerable:!0,configurable:!0});b._removeRange=function(b){null!==b.prev?null!==b.next?(b.prev.next=b.next,b.next.prev=b.prev):b.prev.next=null:null!==b.next&&(b.next.prev=null)};b._fuse=function(b,a){b.count+=a.count;b.next=a.next;a.from+=a.count;a.count=
0;null!==a.next&&(a.next.prev=b)};return b}();b.FreeList=g})},"esri/views/2d/engine/webgl/Fader":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(b){void 0===b&&(b=400);this.duration=b;this._value=this._elapsed=this._lastTime=0;this._finished=!1}Object.defineProperty(b.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0});b.prototype.reset=function(){this._value=this._elapsed=this._lastTime=
0};b.prototype.step=function(){var b=performance.now();if(0===this._lastTime)return this._lastTime=b,this._value=0,!0;if(this._elapsed>=this.duration)return!0;this._elapsed+=b-this._lastTime;this._lastTime=b;this._value=Math.min(this._elapsed/this.duration,1);return!1};return b}();b.default=g})},"esri/views/2d/engine/webgl/WGLBuffers":function(){define(["require","exports","../../../webgl","./Utils"],function(g,b,l,k){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(a){this.geometryMap=
k.createGeometryData(function(){return{indexBuffer:l.BufferObject.createIndex(a,35044),vao:null}},function(b,f){return{vertexBuffer:l.BufferObject.createVertex(a,k.C_VBO_INFO[f])}})}b.prototype.dispose=function(){for(var a=0;5>a;a++){var b=this.geometryMap[a];if(b){b.data.vao&&b.data.vao.dispose(!1);b.data.indexBuffer&&b.data.indexBuffer.dispose();for(var f in b.buffers)b.buffers[f]&&b.buffers[f].data.vertexBuffer.dispose()}}};b.prototype.get=function(a){var b=this.geometryMap[a];a={};for(var f in b.buffers)a[f]=
b.buffers[f].data.vertexBuffer;return{indexBuffer:b.data.indexBuffer,get vao(){return b.data.vao},set vao(a){b.data.vao=a},vertexBufferMap:a}};b.prototype.has=function(a){return null!=this.geometryMap[a]};b.prototype.upload=function(a,b){var f=this;b.forEach(function(b,c){f._upload(b,c,a)})};b.prototype._upload=function(a,b,f){a.indices&&(a.indices.allDirty?this._uploadIndices(f,b):null!=a.indices.from&&null!=a.indices.count&&this._uploadIndices(f,b,a.indices.from,a.indices.count));if(a.vertices){a=
a.vertices;for(var d in a){var c=a[d];c.allDirty?this._uploadVertices(f,b,d):null!=c.from&&null!=c.count&&this._uploadVertices(f,b,d,c.from,c.count)}}};b.prototype._uploadVertices=function(a,b,f,d,c){var e=this.geometryMap[b];e&&(b=a.geometries[b].vertexBuffer[f])&&(a=b.stride,b=b.data.buffer,e.buffers[f]&&0<b.byteLength&&(null!=d&&null!=c?e.buffers[f].data.vertexBuffer.setSubData(b,d*a,d*a,(d+c)*a):e.buffers[f].data.vertexBuffer.setData(b)))};b.prototype._uploadIndices=function(a,b,f,d){var c=this.geometryMap[b];
c&&(a=a.geometries[b].indexBuffer.buffer,c.data.indexBuffer&&0<a.byteLength&&(null!=f&&null!=d?c.data.indexBuffer.setSubData(a,4*f,4*f,4*(f+d)):c.data.indexBuffer.setData(a)))};return b}();b.default=g})},"esri/views/2d/engine/webgl/shaders/MagnifierPrograms":function(){define(["require","exports","../../../../webgl","./sources/resolver"],function(g,b,l,k){Object.defineProperty(b,"__esModule",{value:!0});b.magnifier={name:"magnifier",shaders:{vertexShader:k.resolveIncludes("magnifier/magnifier.vert"),
fragmentShader:k.resolveIncludes("magnifier/magnifier.frag")},attributes:{a_pos:0}};b.createMagnifierProgram=function(f){return l.createProgram(f,b.magnifier)}})},"esri/views/2d/engine/BitmapTileContainer":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../../../geometry/support/aaBoundingRect ../engine ./BitmapTile ./webgl/enums ./webgl/TileContainer".split(" "),function(g,b,l,k,f,a,q,m,d){Object.defineProperty(b,"__esModule",{value:!0});
g=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}l(c,b);c.prototype.createTile=function(a){var b=this._tileInfoView.getTileBounds(f.create(),a);return new q.BitmapTile(a,b,this._tileInfoView.tileInfo.size)};c.prototype.destroyTile=function(){};c.prototype.prepareRenderPasses=function(c){var e=this,d=c.registerRenderPass({name:"bitmap (tile)",brushes:[a.brushes.Bitmap],target:function(){return e.children.map(function(a){return a.bitmap})},drawPhase:m.WGLDrawPhase.MAP});return b.prototype.prepareRenderPasses.call(this,
c).concat([d])};c.prototype.doRender=function(a){this.visible&&a.drawPhase===m.WGLDrawPhase.MAP&&b.prototype.doRender.call(this,a)};return c}(d.default);b.BitmapTileContainer=g})},"esri/views/2d/engine/LevelDependentSizeVariable":function(){define("require exports ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/lang ../../../core/accessorSupport/decorators ../../../renderers/visualVariables/SizeVariable ../../../renderers/visualVariables/support/sizeVariableUtils".split(" "),
function(g,b,l,k,f,a,q,m){Object.defineProperty(b,"__esModule",{value:!0});g=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}k(c,b);e=c;c.prototype.writeLevels=function(a,b,c){for(var e in a){b.stops=this.levels[e];break}};c.prototype.clone=function(){return new e({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:m.isSizeVariable(this.maxSize)?this.maxSize.clone():this.maxSize,
minDataValue:this.minDataValue,minSize:m.isSizeVariable(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops&&this.stops.map(function(a){return a.clone()}),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions&&this.legendOptions.clone(),levels:f.clone(this.levels)})};var e;l([a.property()],c.prototype,"levels",void 0);l([a.writer("levels")],
c.prototype,"writeLevels",null);return c=e=l([a.subclass("esri.views.2d.engine.LevelDependentSizeVariable")],c)}(a.declared(q));b.LevelDependentSizeVariable=g})},"esri/widgets/Legend/support/ActiveLayerInfo":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/awaiterHelper ../../../core/tsSupport/generatorHelper dojo/i18n!../../Legend/nls/Legend ../../../Color ../../../request ../../../symbols ../../../core/Accessor ../../../core/arrayUtils ../../../core/Collection ../../../core/Handles ../../../core/Logger ../../../core/maybe ../../../core/promiseUtils ../../../core/urlUtils ../../../core/watchUtils ../../../core/accessorSupport/decorators ../../../layers/support/ExportImageParameters ../../../layers/support/fieldUtils ../../../renderers/support/jsonUtils ../../../renderers/visualVariables/SizeVariable ../../../symbols/support/symbolUtils ../../../symbols/support/utils ../../../views/MapView ../../../views/2d/layers/support/clusterUtils ./colorRampUtils ./heatmapRampUtils ./relationshipRampUtils ./sizeRampUtils ./utils @dojo/framework/shim/Promise".split(" "),
function(g,b,l,k,f,a,q,m,d,c,e,h,p,n,u,x,v,t,w,r,y,A,z,B,C,D,H,F,E,G,J,K,I,N){function M(a){return"esri.renderers.SimpleRenderer"===a.declaredClass}function L(a){return"esri.renderers.ClassBreaksRenderer"===a.declaredClass}function Q(a){return"esri.renderers.UniqueValueRenderer"===a.declaredClass}function O(a){return"esri.renderers.HeatmapRenderer"===a.declaredClass}function S(a){return"esri.renderers.PointCloudClassBreaksRenderer"===a.declaredClass}function U(a){return"esri.renderers.PointCloudStretchRenderer"===
a.declaredClass}function T(a){return"esri.renderers.PointCloudUniqueValueRenderer"===a.declaredClass}function R(a){return"esri.renderers.DotDensityRenderer"===a.declaredClass}var P=x.getLogger("esri.widgets.Legend.support.ActiveLayerInfo"),V=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,X=new e.SimpleMarkerSymbol({size:6,outline:{color:[128,128,128,.5],width:.5}}),W=new e.SimpleFillSymbol({style:"solid"}),Z=new e.SimpleMarkerSymbol({style:"path",path:"M10,5 L5,0 0,5 M5,0 L5,15",size:15,outline:{width:1,
color:[85,85,85,1]}});return function(b){function e(a){a=b.call(this,a)||this;a._handles=new u;a._hasColorRamp=!1;a._hasOpacityRamp=!1;a._hasSizeRamp=!1;a._legendResponse={};a._webStyleSymbolCache=new Map;a._dotDensityUrlCache=new Map;a._scaleDrivenSizeVariable=null;a.children=new n;a.layer=null;a.legendElements=[];a.parent=null;a.respectLayerVisibility=!0;a.sublayerIds=[];a.title=null;a.view=null;return a}k(e,b);e.prototype.initialize=function(){var a=this,b=function(){return a.notifyChange("ready")};
this._handles.add([r.on(this,"children","change",function(c){var e=c.removed,d=a._handles;c.added.map(function(a){var c="activeLayerInfo-ready-watcher-"+a.layer.uid;d.add(r.init(a,"ready",b),c)});e.forEach(function(a){return d.remove(a.layer.uid)});b()})])};e.prototype.destroy=function(){this._handles.destroy();this._scaleDrivenSizeVariable=this._dotDensityUrlCache=this._webStyleSymbolCache=this._legendResponse=this._handles=null};Object.defineProperty(e.prototype,"ready",{get:function(){return null===
this.layer?!0:0<this.children.length?this._isGroupActive():0<this.legendElements.length},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"scale",{get:function(){return this.view&&this.view.scale},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"isScaleDriven",{get:function(){var a=this,b=this.layer;if(null===b)return!1;if("featureReduction"in b&&b.featureReduction&&"cluster"===b.featureReduction.type)return!0;if("renderer"in b&&b.renderer){if("dot-density"===b.renderer.type)return!0;
var c=b.get("renderer.valueExpression");if(V.test(c))return!0;if(b=b.get("renderer.visualVariables"))return b.some(function(b){return a._isScaleDrivenSizeVariable(b)})}return this._isLayerScaleDriven(this.layer)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"version",{get:function(){return this._get("version")+1},enumerable:!0,configurable:!0});e.prototype.buildLegendElementsForFeatureCollections=function(b){return a(this,void 0,void 0,function(){var a,c=this;return q(this,function(e){this.legendElements=
[];a=b.map(function(a){if("esri.layers.FeatureLayer"===a.declaredClass)return c._buildRendererLegendElements(a.renderer,{title:a.title,mode:0});if(a.featureSet&&a.featureSet.features.length){var b=a.layerDefinition,b=(b=b&&b.drawingInfo)&&B.fromJSON(b.renderer);return b?c._buildRendererLegendElements(b,{title:a.name,mode:0}):(P.warn("drawingInfo not available!"),null)}return null});return[2,t.eachAlways(a).then(function(){})]})})};e.prototype.buildLegendElementsForRenderer=function(b){return a(this,
void 0,void 0,function(){return q(this,function(a){return[2,this._buildRendererLegendElements(b)]})})};e.prototype.buildLegendElementsForTools=function(){return a(this,void 0,void 0,function(){var a,b=this;return q(this,function(c){switch(c.label){case 0:a=this.layer;if("esri.layers.WMTSLayer"!==a.declaredClass)return[3,1];this._constructLegendElementsForWMTSlayer();return[3,6];case 1:if("esri.layers.WMSLayer"!==a.declaredClass)return[3,2];this._constructLegendElementsForWMSSublayers();return[3,6];
case 2:return"esri.layers.MapImageLayer"!==a.declaredClass&&"esri.layers.TileLayer"!==a.declaredClass?[3,4]:[4,this._constructLegendElementsForSublayers()];case 3:return c.sent(),[3,6];case 4:return this._handles.remove("imageryLayers-watcher"),[4,this._getLegendLayers().then(function(c){b.legendElements=[];c.forEach(function(c){if("esri.layers.ImageryLayer"===a.declaredClass){var e=a.watch("renderingRule, bandIds",function(){b._legendResponse["default"]=null;b.buildLegendElementsForTools()});b._handles.add(e,
"imageryLayers-watcher")}(c=b._generateSymbolTableElementForLegendLayer(c))&&c.infos.length&&("esri.layers.ImageryLayer"===a.declaredClass&&(c.title=a.title),b.legendElements.push(c));b.notifyChange("ready")});b.notifyChange("ready")}).catch(function(a){P.warn("Request to server for legend has failed!",a)})];case 5:c.sent(),c.label=6;case 6:return[2]}})})};e.prototype._isGroupActive=function(){var a=this.children;return a.length?a.some(function(a){return a.ready}):!1};e.prototype._isScaleDrivenSizeVariable=
function(a){if(a&&"size"!==a.type)return!1;var b=a.minSize,c=a.maxSize;return"object"===typeof b&&b?this._isScaleDrivenSizeVariable(b):"object"===typeof c&&c?this._isScaleDrivenSizeVariable(c):!!a.expression||V.test(a.valueExpression)};e.prototype._isLayerScaleDriven=function(a){var b=this;if("minScale"in a&&0<a.minScale||"maxScale"in a&&0<a.maxScale)return!0;if("sublayers"in a&&a.sublayers)return a.sublayers.some(function(a){return b._isLayerScaleDriven(a)});var c=a.parent;if(!1===a.loaded&&"esri.layers.MapImageLayer"===
c.declaredClass&&"source"in a&&a.source&&"map-layer"===a.source.type)for(var e=0,c=c.sourceJSON.layers;e<c.length;e++){var d=c[e];if(d.id===a.source.mapLayerId&&(0<d.minScale||0<d.maxScale))return!0}return!1};e.prototype._buildRendererLegendElements=function(b,c){void 0===c&&(c={});return a(this,void 0,void 0,function(){var a,e;return q(this,function(d){switch(d.label){case 0:return d.trys.push([0,2,,3]),[4,this._getRendererLegendElements(b,{title:c.title})];case 1:return a=d.sent(),0===c.mode?Array.prototype.push.apply(this.legendElements,
a):this.legendElements=a,this.notifyChange("ready"),[3,3];case 2:return e=d.sent(),P.warn("error while building legend for layer!",e),[3,3];case 3:return[2]}})})};e.prototype._constructLegendElementsForWMTSlayer=function(){this.legendElements=[];this._handles.remove("wmts-activeLayer-watcher");var a=this.layer,b=a.activeLayer;this._handles.add(r.watch(this.layer,"activeLayer",this._constructLegendElementsForWMTSlayer.bind(this)),"wmts-activeLayer-watcher");if(b.styleId&&b.styles){var c=null;b.styles.some(function(a){return b.styleId===
a.id?(c=a.legendUrl,!0):!1});c&&(this.legendElements=[{type:"symbol-table",title:b.title,infos:[{src:c,opacity:a.opacity}]}])}this.notifyChange("ready")};e.prototype._constructLegendElementsForWMSSublayers=function(){this.legendElements=[];this._handles.remove("wms-sublayers-watcher");var a=this.layer,b=null;if(a.customParameters||a.customLayerParameters)b=l({},a.customParameters,a.customLayerParameters);this._handles.add(r.watch(this.layer,"sublayers",this._constructLegendElementsForWMSSublayers.bind(this)),
"wms-sublayers-watcher");this.legendElements=this._generateLegendElementsForWMSSublayers(a.sublayers,b);this.notifyChange("ready")};e.prototype._generateLegendElementsForWMSSublayers=function(a,b){var c=this,e=[];this._handles.add(a.on("change",this._constructLegendElementsForWMSSublayers.bind(this)),"wms-sublayers-watcher");a.forEach(function(a){var d=a.watch("title, visible, legendEnabled",function(){return c._constructLegendElementsForWMSSublayers()});c._handles.add(d,"wms-sublayers-watcher");
a.visible&&a.legendEnabled&&(a=c._generateSymbolTableElementForWMSSublayer(a,b))&&a.infos.length&&e.unshift(a)});return e};e.prototype._generateSymbolTableElementForWMSSublayer=function(a,b){return!a.legendUrl&&a.sublayers?(b=this._generateLegendElementsForWMSSublayers(a.sublayers,b).filter(function(a){return a}),{type:"symbol-table",title:a.title,infos:b}):this._generateSymbolTableElementForLegendUrl(a,b)};e.prototype._generateSymbolTableElementForLegendUrl=function(a,b){var c=a.legendUrl;if(c){var e=
{type:"symbol-table",title:a.title||a.name||a.id&&a.id+"",infos:[]};b&&(c+="?"+w.objectToQuery(b));e.infos.push({src:c,opacity:a.layer&&a.layer.opacity});return e}};e.prototype._getLegendLayers=function(a){var b=this,c=(a=a&&a.hasDynamicLayers?a.dynamicLayers:null)||"default",e=this._legendResponse&&this._legendResponse[c];return e?t.resolve(e):this._legendRequest(a).then(function(a){a=a.layers;return b._legendResponse[c]=a})};e.prototype._legendRequest=function(a){var b=this.layer;a={f:"json",dynamicLayers:a};
"esri.layers.ImageryLayer"===b.declaredClass&&(b.renderingRule&&(a.renderingRule=JSON.stringify(b.renderingRule.toJSON())),b.bandIds&&(a.bandIds=b.bandIds.join()),b.raster||b.viewId)&&(a=l({raster:b.raster,viewId:b.viewId},a));var e=b.url.replace(/(\/)+$/,"");"version"in b&&10.01<=b.version?(b=e.indexOf("?"),e=-1<b?e.substring(0,b)+"/legend"+e.substring(b):e+"/legend"):(b=e.toLowerCase().indexOf("/rest/"),e=e.substring(0,b)+e.substring(b+5,e.length),e="https://utility.arcgis.com/sharing/tools/legend?soapUrl\x3d"+
encodeURI(e)+"\x26returnbytes\x3dtrue");return c(e,{query:a}).then(function(a){return a.data})};e.prototype._constructLegendElementsForSublayers=function(){return a(this,void 0,void 0,function(){var a,b,c;return q(this,function(e){switch(e.label){case 0:this.legendElements=[],this._handles.remove("sublayers-watcher"),a=this.layer,this._handles.add(r.watch(a,"sublayers",this._constructLegendElementsForSublayers.bind(this)),"sublayers-watcher"),e.label=1;case 1:return e.trys.push([1,3,,4]),b=this,[4,
this._generateLegendElementsForSublayers(a.sublayers,a.opacity)];case 2:return b.legendElements=e.sent(),this.notifyChange("ready"),[3,4];case 3:return c=e.sent(),P.warn("Request to server for legend has failed!",c),[3,4];case 4:return[2]}})})};e.prototype._generateLegendElementsForSublayers=function(b,c,e){return a(this,void 0,void 0,function(){var a,d,h,f,n,m,g,p,k,l,r,t=this;return q(this,function(q){switch(q.label){case 0:a=[],this._handles.add(b.on("change",this._constructLegendElementsForSublayers.bind(this)),
"sublayers-watcher"),d=b.toArray(),!e&&this.sublayerIds&&this.sublayerIds.length&&(h=this.layer,d=this.sublayerIds.map(function(a){return h.findSublayerById(a)}).filter(Boolean)),f=0,n=d,q.label=1;case 1:if(!(f<n.length))return[3,8];m=n[f];g=m.watch("renderer, opacity, title, visible, legendEnabled",function(){return t._constructLegendElementsForSublayers()});this._handles.add(g,"sublayers-watcher");if(!m.visible||!m.legendEnabled)return[3,7];p=m&&null!=m.opacity?m.opacity:null;k=null!=p?p*c:c;return!m.renderer||
m.sublayers?[3,5]:this.respectLayerVisibility&&!this._isSublayerInScale(m)?[3,4]:[4,m.load()];case 2:return q.sent(),[4,this._getRendererLegendElements(m.renderer,{title:m.title,opacity:k,sublayer:m})];case 3:l=q.sent(),Array.prototype.unshift.apply(a,l),q.label=4;case 4:return[3,7];case 5:return[4,this._generateSymbolTableElementForSublayer(m,k,e)];case 6:(r=q.sent())&&a.unshift(r),q.label=7;case 7:return f++,[3,1];case 8:return[2,a.filter(function(a){return a&&0<a.infos.length})]}})})};e.prototype._generateSymbolTableElementForSublayer=
function(b,c,e){return a(this,void 0,void 0,function(){var a,d,h,f;return q(this,function(n){switch(n.label){case 0:if(e)return[3,4];e=new Map;a=new A.ExportImageParameters({layer:this.layer});n.label=1;case 1:return n.trys.push([1,,3,4]),[4,this._getLegendLayers(a)];case 2:return d=n.sent(),d.forEach(function(a){return e.set(a.layerId,a)}),[3,4];case 3:return a.destroy(),[7];case 4:return(h=e.get(b.id))||!b.sublayers?[3,6]:[4,this._generateLegendElementsForSublayers(b.sublayers,c,e)];case 5:return f=
n.sent(),[2,{type:"symbol-table",title:b.title,infos:f}];case 6:return[2,this._generateSymbolTableElementForLegendLayer(h,b,c)]}})})};e.prototype._generateSymbolTableElementForLegendLayer=function(a,b,c){var e=this;if(!a||!a.legend||this.respectLayerVisibility&&!this._isLegendLayerInScale(a,b))return null;var d=b&&b.renderer,h=b&&b.title||a.layerName;d&&(d=b&&b.title||this._getRendererTitle(d,b))&&(h&&(d.title=h),h=d);h={type:"symbol-table",title:h,infos:[]};a.legendType&&(h.legendType=a.legendType);
b=b?this._sanitizeLegendForSublayer(a.legend.slice(),b):a.legend;h.infos=b.map(function(b){var d=b.url;if(b.imageData&&0<b.imageData.length)d="data:image/png;base64,"+b.imageData;else if(0!==d.indexOf("http"))d=w.addTokenParameter(e.layer.url+"/"+a.layerId+"/images/"+d);else return null;return{label:b.label,src:d,opacity:null==c?e.layer.opacity:c,width:b.width,height:b.height}}).filter(function(a){return!!a});return h.infos.length?h:null};e.prototype._isSublayerInScale=function(a){var b=a.minScale||
0;a=a.maxScale||0;return 0<b&&b<this.scale||a>this.scale?!1:!0};e.prototype._isLegendLayerInScale=function(a,b){b=b||this.layer;var c=null,e=null,d=!0;!b.minScale&&0!==b.minScale||!b.maxScale&&0!==b.maxScale?(0===a.minScale&&b.tileInfo&&(c=b.tileInfo.lods[0].scale),0===a.maxScale&&b.tileInfo&&(e=b.tileInfo.lods[b.tileInfo.lods.length-1].scale)):(c=Math.min(b.minScale,a.minScale)||b.minScale||a.minScale,e=Math.max(b.maxScale,a.maxScale));if(0<c&&c<this.scale||e>this.scale)d=!1;return d};e.prototype._sanitizeLegendForSublayer=
function(a,b){if("version"in this.layer&&10.1>this.layer.version||0===a.length)return a;b=b.renderer;var c=null,e=null;a.some(function(a){return a.values})&&a.some(function(a,b){a.values||(c=b,e=a,e.label||(e.label="others"));return null!=e});b?"unique-value"===b.type?e&&(a.splice(c,1),a.push(e)):"class-breaks"===b.type&&(e&&a.splice(c,1),a.reverse(),e&&a.push(e)):e&&(a.splice(c,1),a.push(e));return a};e.prototype._getRendererLegendElements=function(b,c){void 0===c&&(c={});return a(this,void 0,void 0,
function(){return q(this,function(a){return M(b)||L(b)||Q(b)||"raster-stretch"===b.type||"raster-colormap"===b.type||O(b)||S(b)||U(b)||T(b)||R(b)?S(b)||U(b)||T(b)||"esri.renderers.PointCloudRGBRenderer"===b.declaredClass?[2,this._constructPointCloudRendererLegendElements(b,c)]:R(b)?[2,this._constructDotDensityRendererLegendElements(b)]:[2,this._constructRendererLegendElements(b,c)]:(P.warn("Renderer not supported!"),[2,[]])})})};e.prototype._getPointCloudRendererTitle=function(a){return a.legendOptions&&
a.legendOptions.title||a.field};e.prototype._constructPointCloudRendererLegendElements=function(a,b){var c=this;void 0===b&&(b={});b=b.title;var e=[],d=null,h=null;if(S(a))d={type:"symbol-table",title:b||this._getPointCloudRendererTitle(a),infos:[]},a.colorClassBreakInfos.forEach(function(a){d.infos.unshift({label:a.label||a.minValue+" - "+a.maxValue,value:[a.minValue,a.maxValue],symbol:c._getAppliedCloneSymbol(X,a.color)})});else if(U(a)){var h=a.stops,f=null;if(h.length&&(1===h.length&&(f=h[0].color),
!f)){var n=h[0].value,m=h[h.length-1].value;null!=n&&null!=m&&(f=G.getColorFromPointCloudStops(n+(m-n)/2,h))}d={type:"symbol-table",title:null,infos:[{label:null,value:null,symbol:this._getAppliedCloneSymbol(X,f||X.color)}]};h=G.getRampStopsForPointCloud(a.stops);h={type:"color-ramp",title:b||this._getPointCloudRendererTitle(a),infos:h,preview:D.renderColorRampPreviewHTML(h.map(function(a){return a.color}))}}else T(a)&&(d={type:"symbol-table",title:b||this._getPointCloudRendererTitle(a),infos:[]},
a.colorUniqueValueInfos.forEach(function(a){d.infos.push({label:a.label||a.values.join(", "),value:a.values.join(", "),symbol:c._getAppliedCloneSymbol(X,a.color)})}));d&&d.infos.length&&e.push(d);h&&h.infos.length&&e.push(h);a=e.reduce(function(a,b){return a.concat(b.infos)},[]).filter(function(a){return!!a.symbol}).map(function(a){return c._getSymbolPreview(a,c.layer.opacity)});return t.eachAlways(a).then(function(){return e})};e.prototype._getElementInfoForDotDensity=function(a,b){var c=a.outline,
c=a.dotSize+"-"+b+"-"+a.backgroundColor+"-"+(c&&JSON.stringify(c.toJSON())),e=this._dotDensityUrlCache;a=e.has(c)?e.get(c):D.renderDotDensityPreviewHTML(a,b);e.set(c,a);return{opacity:1,src:a.src,preview:a,width:a.width,height:a.height}};e.prototype._constructDotDensityRendererLegendElements=function(a){var b=this,c=a.calculateDotValue(this.view.scale),e={type:"symbol-table",title:{value:c&&Math.round(c),unit:a.legendOptions&&a.legendOptions.unit||""},infos:[]};a.attributes.forEach(function(c){var d=
b._getElementInfoForDotDensity(a,c.color);d.label=c.label||c.valueExpressionTitle||c.field;e.infos.push(d)});return t.resolve([e])};e.prototype._constructRendererLegendElements=function(b,c){void 0===c&&(c={});return a(this,void 0,void 0,function(){var a,e,d,h,f,n,m,g,p,k,l,r,u,x,w,y,A,z,B,C,N,I,F,H,E,U,G,T,P,R,ba,Y,V,ca,X,aa,S,fa,ga,ha,da=this;return q(this,function(q){switch(q.label){case 0:return a=c.title,d=(e=c.sublayer)||this.layer,[4,this._loadRenderer(b)];case 1:return h=q.sent(),this._hasSizeRamp=
this._hasOpacityRamp=this._hasColorRamp=!1,this._scaleDrivenSizeVariable=null,[4,this._getVisualVariableLegendElements(h,d)];case 2:f=q.sent()||[];n={type:"symbol-table",title:a||this._getRendererTitle(h,d),infos:[]};m=null;g=!1;if(!O(h))return[3,3];p=J.getHeatmapRampStops(h);f.push({type:"heatmap-ramp",title:a,infos:p,preview:D.renderColorRampPreviewHTML(p.map(function(a){return a.color}))});return[3,12];case 3:if(!Q(h))return[3,4];if(l=(k=h&&h.authoringInfo)&&"relationship"===k.type){if(r=k.focus,
u=k.numClasses,x=k.field1,w=k.field2,u&&x&&w){y=[x,w];A=K.getRotationAngleForFocus(r)||0;z=0;for(B=y;z<B.length;z++)C=B[z],N=C.field,I=C.normalizationField,F={field:this._getFieldAlias(N,d),normField:I&&this._getFieldAlias(I,d)},H=Z.clone(),H.angle=A,n.infos.push({label:F,symbol:H}),A+=90;E=K.getRelationshipRampElement({focus:r,numClasses:u,infos:h.uniqueValueInfos});f.unshift(E)}}else U=h.field,h.uniqueValueInfos.forEach(function(a){a.symbol&&n.infos.push({label:a.label||da._getDomainName(U,a.value,
d)||a.value,value:a.value,symbol:a.symbol})});h.defaultSymbol&&(n.infos.push({label:h.defaultLabel||"others",symbol:h.defaultSymbol}),g=!0);return[3,12];case 4:if(!L(h))return[3,5];m=this._isUnclassedRenderer(h);if(G=!m||!this._hasSizeRamp)h.classBreakInfos.forEach(function(a){a.symbol&&n.infos.unshift({label:a.label||(m?null:a.minValue+" - "+a.maxValue),value:[a.minValue,a.maxValue],symbol:a.symbol})}),m&&(n.title=null),this._updateInfosforClassedSizeRenderer(h,n.infos);h.defaultSymbol&&!m&&(n.infos.push({label:h.defaultLabel||
"others",symbol:h.defaultSymbol}),g=!0);return[3,12];case 5:if("raster-stretch"!==h.type)return[3,11];if("esri.layers.TileImageryLayer"!==this.layer.declaredClass)return[3,6];T=this._constructTileImageryStretchRendererElements(h);"stretch-ramp"===T.type?f.push(T):n.infos=T;return[3,10];case 6:return P=this.layer,ba=R=void 0,h.statistics&&h.statistics.length&&(R=h.statistics[0].min||h.statistics[0][0],ba=h.statistics[0].max||h.statistics[0][1]),Y=[],ca=v.unwrap,P.renderingRule?[4,P.generateRasterInfo(P.renderingRule)]:
[3,8];case 7:return X=q.sent(),[3,9];case 8:X=P.serviceRasterInfo,q.label=9;case 9:V=ca.apply(void 0,[X]),aa=V.keyProperties.BandProperties,1===V.bandCount?(R=R||V.statistics&&V.statistics[0].min,ba=ba||V.statistics&&V.statistics[0].max,R||ba?f.push(this._getStretchLegendElements(h,{min:R,max:ba})):this.buildLegendElementsForTools()):P.bandIds&&1===P.bandIds.length?(R=R||V.statistics&&V.statistics[P.bandIds[0]].min,ba=ba||V.statistics&&V.statistics[P.bandIds[0]].max,R||ba?f.push(this._getStretchLegendElements(h,
{min:R,max:ba})):this.buildLegendElementsForTools()):3<=V.bandCount?aa&&aa.length>=V.bandCount?P.bandIds&&3===P.bandIds.length?(Y=P.bandIds.map(function(a){return aa[a].BandName}),n.infos=this._createSymbolTableElementMultiBand(Y)):"lerc"===P.format?(Y=[0,1,2].map(function(a){return aa[a].BandName}),n.infos=this._createSymbolTableElementMultiBand(Y)):this.buildLegendElementsForTools():"lerc"===P.format?(Y=["band0","band1","band2"],n.infos=this._createSymbolTableElementMultiBand(Y)):this.buildLegendElementsForTools():
this.buildLegendElementsForTools(),q.label=10;case 10:return[3,12];case 11:"raster-colormap"===h.type?h.colormapInfos.forEach(function(a){n.infos.push({label:a.label,value:a.value,symbol:da._getAppliedCloneSymbol(W,a.color)})}):M(h)&&h.symbol&&!this._hasSizeRamp&&n.infos.push({label:h.label,symbol:h.symbol}),q.label=12;case 12:return S=h.defaultSymbol,!S||g||M(h)||m&&!this._hasColorRamp&&!this._hasSizeRamp&&!this._hasOpacityRamp||f.push({type:"symbol-table",infos:[{label:h.defaultLabel||"others",
symbol:S}]}),n.infos.length&&f.unshift(n),fa=null==c.opacity?d.opacity:c.opacity,ga=this._getSymbolConfig("visualVariables"in h&&h.visualVariables),ha=f.reduce(function(a,b){return a.concat(b.infos)},[]).filter(function(a){return!(!a||!a.symbol)}).map(function(a){return da._getSymbolPreview(a,fa,ga)}),h=null,[4,t.eachAlways(ha)];case 13:return q.sent(),[2,f]}})})};e.prototype._constructTileImageryStretchRendererElements=function(a){var b=this.layer,c=b.rasterInfo,e=c.bandCount||a.statistics.length,
d,h,f=[],n=c.keyProperties&&c.keyProperties.BandProperties;a.statistics&&a.statistics.length&&(d=void 0!==a.statistics[0].min?a.statistics[0].min:a.statistics[0][0],h=a.statistics[0].max||a.statistics[0][1]);if(1===c.bandCount)return this._getStretchLegendElements(a,{min:d,max:h});f=n&&n.length>=c.bandCount?b.bandIds&&b.bandIds.length===e?b.bandIds.map(function(a){return n[a].BandName}):[0,1,2].map(function(a){return n[a].BandName||"band"+a}):["band0","band1","band2"];3>e&&3>f.length?f.push(f[1]):
3<e&&3<f.length&&f.splice(3);return this._createSymbolTableElementMultiBand(f)};e.prototype._getStretchLegendElements=function(a,b){a=G.getStrectchRampStops(a.colorRamp,b);return{type:"stretch-ramp",title:"",infos:a,preview:D.renderColorRampPreviewHTML(a.map(function(a){return a.color}))}};e.prototype._createSymbolTableElementMultiBand=function(a){var b=[],c=["red","green","blue"];a.forEach(function(a,e){b.push({label:{colorName:c[e],bandName:a},src:N.RGB_IMG_SOURCE[e],opacity:1})});return b};e.prototype._updateInfosforClassedSizeRenderer=
function(a,b){var c=a.authoringInfo&&"class-breaks-size"===a.authoringInfo.type,e=a.classBreakInfos.some(function(a){return H.isVolumetricSymbol(a.symbol)});if(c&&e){var d=I.REAL_WORLD_MAX_SIZE;a=a.classBreakInfos.length;var h=(d-I.REAL_WORLD_MIN_SIZE)/(1<a?a-1:a);b.forEach(function(a,b){a.size=d-h*b})}};e.prototype._getSymbolConfig=function(a){var b=!1,c=!1;if(a)for(var e=0;e<a.length&&(!b||!c);e++){var d=a[e];"size"===d.type&&("height"===d.axis&&(b=!0),"width-and-depth"===d.axis&&(c=!0))}return b&&
c?"tall":null};e.prototype._getSymbolPreview=function(b,c,e){return a(this,void 0,void 0,function(){var a,d;return q(this,function(h){switch(h.label){case 0:return a=b.size,this._scaleDrivenSizeVariable?[4,new Promise(function(a,b){g(["../../../renderers/visualVariables/support/visualVariableUtils"],a,b)})]:[3,2];case 1:d=h.sent().getSize,a=d(this._scaleDrivenSizeVariable,null,{view:this.view,scale:this.scale,shape:"simple-marker"===b.symbol.type?b.symbol.style:null}),h.label=2;case 2:return[2,D.renderPreviewHTML(b.symbol,
{size:a,opacity:c,symbolConfig:e,rotation:b.symbol.angle}).then(function(a){b.preview=a;return b}).catch(function(){b.preview=null;return b})]}})})};e.prototype._loadRenderer=function(b){return a(this,void 0,void 0,function(){var a,c,e,d,h=this;return q(this,function(f){switch(f.label){case 0:return a=[],b=b.clone(),[4,this._getMedianColor(b)];case 1:c=f.sent();if(L(b)||Q(b))e=b.classBreakInfos||b.uniqueValueInfos,d=e.map(function(a){return h._fetchSymbol(a.symbol,c).then(function(b){a.symbol=b}).catch(function(){a.symbol=
null})}),Array.prototype.push.apply(a,d);a.push(this._fetchSymbol(b.symbol||b.defaultSymbol,b.defaultSymbol?null:c).then(function(a){h._applySymbolToRenderer(b,a,M(b))}).catch(function(){h._applySymbolToRenderer(b,null,M(b))}));return[2,t.eachAlways(a).then(function(){return b})]}})})};e.prototype._applySymbolToRenderer=function(a,b,c){c?a.symbol=b:a.defaultSymbol=b};e.prototype._getMedianColor=function(b){return a(this,void 0,void 0,function(){var a,c,e,d,h;return q(this,function(f){switch(f.label){case 0:if(!("visualVariables"in
b&&b.visualVariables))return[2,null];a=p.find(b.visualVariables,function(a){return"color"===a.type});if(!a)return[2,null];e=c=null;if(a.stops){if(1===a.stops.length)return[2,a.stops[0].color];c=a.stops[0].value;e=a.stops[a.stops.length-1].value}d=c+(e-c)/2;return[4,new Promise(function(a,b){g(["../../../renderers/visualVariables/support/visualVariableUtils"],a,b)})];case 1:return h=f.sent().getColor,[2,h(a,d)]}})})};e.prototype._fetchSymbol=function(a,b){var c=this;if(!a)return t.reject();if("web-style"===
a.type){var e=a.portal,e=a.name+"-"+a.styleName+"-"+a.styleUrl+"-"+(e&&e.url)+"-"+(e&&e.user&&e.user.username),d=this._webStyleSymbolCache;d.has(e)||(this.view instanceof F?d.set(e,a.fetchCIMSymbol()):d.set(e,a.fetchSymbol()));return d.get(e).then(function(a){return c._getAppliedCloneSymbol(a,b)}).catch(function(){P.warn("Fetching web-style failed!");return t.reject()})}return t.resolve(this._getAppliedCloneSymbol(a,b))};e.prototype._getAppliedCloneSymbol=function(a,b){if(!a)return a;a=a.clone();
var c=-1<a.type.indexOf("3d");b=b&&b.toRgba();c?this._applyColorTo3dSymbol(a,b):a.color&&(a.color=new d(b||a.color));return a};e.prototype._applyColorTo3dSymbol=function(a,b){b&&a.symbolLayers.forEach(function(a){a&&(a.material||(a.material={}),a.material.color=new d(b))})};e.prototype._createClusterSizeVariable=function(a){var b=E.getActiveSizeStops(this.view,a);return new C({field:a.field,legendOptions:{title:m.clusterCountTitle},minSize:b[2].size,minDataValue:b[2].value,maxSize:b[3].size,maxDataValue:b[3].value})};
e.prototype._getVisualVariableLegendElements=function(b,c){return a(this,void 0,void 0,function(){var e,d,h,f,n,m,g,p,k,l=this;return q(this,function(r){switch(r.label){case 0:if(!("visualVariables"in b&&b.visualVariables))return[2,null];e=b.visualVariables;d=[];h=[];f=[];e.forEach(function(a){"color"===a.type?d.push(a):"size"===a.type?("levels"in a&&a.levels&&(a=l._createClusterSizeVariable(a)),h.push(a)):"opacity"===a.type&&f.push(a)});n=d.concat(h,f);0===d.length&&L(b)&&b.classBreakInfos&&1===
b.classBreakInfos.length&&(m=(p=b.classBreakInfos[0])&&p.symbol);0===d.length&&M(b)&&(m=b.symbol);m&&(-1<m.type.indexOf("3d")?(k=m.symbolLayers.getItemAt(0),"water"===k.type?v.isSome(k.color)&&(g=k.color):v.isSome(k.material)&&v.isSome(k.material.color)&&(g=k.material.color)):m.url||(g=m.color));return[4,t.all(n.map(function(e){return a(l,void 0,void 0,function(){var a,d,h,f,n,m,p,k;return q(this,function(l){switch(l.label){case 0:if(e.legendOptions&&!1===e.legendOptions.showLegend)return[3,10];a=
this._getRampTitle(e,c);d=null;f=(h="getField"in c&&c.getField&&c.getField(e.field))&&z.isDateField(h);return"color"!==e.type?[3,2]:[4,G.getRampStops(e,null,f)];case 1:return n=l.sent(),d={type:"color-ramp",title:a,infos:n,preview:D.renderColorRampPreviewHTML(n.map(function(a){return a.color}))},this._hasColorRamp||(this._hasColorRamp=!(null==d.infos||!d.infos.length)),[3,9];case 2:if("size"!==e.type||"outline"===e.target)return[3,7];if(!V.test(e.valueExpression))return[3,3];this._scaleDrivenSizeVariable=
e;return[3,6];case 3:return m={type:"size-ramp",title:a},p=I.getRampStops,k=[b,e],[4,this._getMedianColor(b)];case 4:return[4,p.apply(void 0,k.concat([l.sent(),this.scale,this.view,f]))];case 5:d=(m.infos=l.sent(),m),this._hasSizeRamp||(this._hasSizeRamp=!(null==d.infos||!d.infos.length)),l.label=6;case 6:return[3,9];case 7:return"opacity"!==e.type?[3,9]:[4,G.getRampStops(e,g,f)];case 8:n=l.sent(),d={type:"opacity-ramp",title:a,infos:n,preview:D.renderColorRampPreviewHTML(n.map(function(a){return a.color}))},
this._hasOpacityRamp||(this._hasOpacityRamp=!(null==d.infos||!d.infos.length)),l.label=9;case 9:return[2,d&&d.infos?d:null];case 10:return[2,void 0]}})})}))];case 1:return[2,r.sent().filter(function(a){return!!a})]}})})};e.prototype._getDomainName=function(a,b,c){return a&&"function"!==typeof a?(c=(a="getField"in c&&c.getField&&c.getField(a))&&"getFieldDomain"in c&&c.getFieldDomain?c.getFieldDomain(a.name):null)&&"coded-value"===c.type?c.getName(b):null:null};e.prototype._getRampTitle=function(a,
b){var c=a.field,e=a.normalizationField,d=!1,h=!1,f=!1,n=null,c="function"===typeof c?null:c,e="function"===typeof e?null:e;if(null!=(a.legendOptions&&a.legendOptions.title))n=a.legendOptions.title;else if(a.valueExpressionTitle)n=a.valueExpressionTitle;else{if("renderer"in b&&b.renderer&&"authoringInfo"in b.renderer&&b.renderer.authoringInfo&&b.renderer.authoringInfo.visualVariables)for(a=b.renderer.authoringInfo.visualVariables,n=0;n<a.length;n++){var m=a[n];if("color"===m.type){if("ratio"===m.style){d=
!0;break}if("percent"===m.style){h=!0;break}if("percent-of-total"===m.style){f=!0;break}}}n={field:c&&this._getFieldAlias(c,b),normField:e&&this._getFieldAlias(e,b),ratio:d,ratioPercent:h,ratioPercentTotal:f}}return n};e.prototype._getRendererTitle=function(a,b){if(a.legendOptions&&a.legendOptions.title)return a.legendOptions.title;if(a.valueExpressionTitle)return a.valueExpressionTitle;var c=a.field,e=null,d=null;L(a)&&(e=a.normalizationField,d="percent-of-total"===a.normalizationType);c="function"===
typeof c?null:c;e="function"===typeof e?null:e;a=null;if(c||e)a={field:c&&this._getFieldAlias(c,b),normField:e&&this._getFieldAlias(e,b),normByPct:d};return a};e.prototype._getFieldAlias=function(a,b){var c="popupTemplate"in b&&b.popupTemplate,c=c&&c.fieldInfos,e=null;c&&c.some(function(b){return a===b.fieldName?(e=b,!0):!1});c=null;"getField"in b&&b.getField?c=b.getField(a):"fieldsIndex"in b&&b.fieldsIndex&&(c=b.fieldsIndex.get(a));b=e||c;var d=null;b&&(d=e&&e.label||c&&c.alias||"name"in b&&b.name||
"fieldName"in b&&b.fieldName);return d};e.prototype._isUnclassedRenderer=function(a){var b=a.visualVariables,c=!1;L(a)&&a.classBreakInfos&&1===a.classBreakInfos.length&&b&&(c=a.field?b.some(function(b){return!(!b||a.field!==b.field||(a.normalizationField||b.normalizationField)&&a.normalizationField!==b.normalizationField)}):!!b.length);return c};f([y.property()],e.prototype,"children",void 0);f([y.property()],e.prototype,"layer",void 0);f([y.property()],e.prototype,"legendElements",void 0);f([y.property()],
e.prototype,"parent",void 0);f([y.property({readOnly:!0})],e.prototype,"ready",null);f([y.property()],e.prototype,"respectLayerVisibility",void 0);f([y.property({dependsOn:["view.scale"],readOnly:!0})],e.prototype,"scale",null);f([y.property()],e.prototype,"sublayerIds",void 0);f([y.property({dependsOn:["layer.renderer?.valueExpression?","layer.renderer?.visualVariables?","layer.featureReduction?","scale"],readOnly:!0})],e.prototype,"isScaleDriven",null);f([y.property()],e.prototype,"title",void 0);
f([y.property({dependsOn:["ready"],readOnly:!0,value:0})],e.prototype,"version",null);f([y.property()],e.prototype,"view",void 0);return e=f([y.subclass("esri.widgets.Legend.support.ActiveLayerInfo")],e)}(y.declared(h))})},"esri/layers/support/ExportImageParameters":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators ./sublayerUtils ./timeUtils ../../views/View".split(" "),
function(g,b,l,k,f,a,q,m,d,c){Object.defineProperty(b,"__esModule",{value:!0});var e={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};g=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b._scale=null;b.view=null;return b}k(b,a);Object.defineProperty(b.prototype,"dynamicLayers",
{get:function(){if(!this.hasDynamicLayers)return null;var a=this.visibleSublayers.map(function(a){return a.toExportImageJSON()});return a.length?JSON.stringify(a):null},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"hasDynamicLayers",{get:function(){return this.layer&&m.isExportDynamic(this.visibleSublayers,this.layer.serviceSublayers,this.layer)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"layer",{set:function(a){var b=this;this._get("layer")!==a&&(this._set("layer",
a),this._layerHandles&&(this._layerHandles.forEach(function(a){return a.remove()}),this._layerHandles.length=0),a&&(this._layerHandles=[a.allSublayers.on("change",function(){return b.notifyChange("visibleSublayers")}),a.on("sublayer-update",function(a){return b.notifyChange(e[a.propertyName])})]))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"layers",{get:function(){var a=this.visibleSublayers;return a?a.length?"show:"+a.map(function(a){return a.id}).join(","):"show:-1":null},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"layerDefs",{get:function(){var a=this.visibleSublayers.filter(function(a){return null!=a.definitionExpression});return a.length?JSON.stringify(a.reduce(function(a,b){a[b.id]=b.definitionExpression;return a},{})):null},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"scale",{get:function(){return null!=this._scale?this._scale:this.view&&this.view.scale||0},set:function(a){this.view||(this._scale=a,this.notifyChange("scale"))},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"version",{get:function(){this.layers;this.layerDefs;this.dynamicLayers;this.timeExtent;var a=this.layer;a&&(a.dpi,a.imageFormat,a.imageTransparency,a.gdbVersion);return(this._get("version")||0)+1},set:function(a){this._set("version",a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"visibleSublayers",{get:function(){var a=this,b=[];if(!this.layer)return b;var c=this.layer.sublayers,e=function(c){var d=a.scale,h=
0===c.minScale||d<=c.minScale,f=0===c.maxScale||d>=c.maxScale;c.visible&&(0===d||h&&f)&&(c.sublayers?c.sublayers.forEach(e):b.unshift(c))};c&&c.forEach(e);c=this._get("visibleSublayers");return!c||c.length!==b.length||c.some(function(a,c){return b[c]!==a})?b:c},enumerable:!0,configurable:!0});b.prototype.toJSON=function(){var a=this.layer,a={dpi:a.dpi,format:a.imageFormat,transparent:a.imageTransparency,gdbVersion:a.gdbVersion||null};this.hasDynamicLayers&&this.dynamicLayers?a.dynamicLayers=this.dynamicLayers:
a=l({},a,{layers:this.layers,layerDefs:this.layerDefs});return a};f([q.property({readOnly:!0,dependsOn:["hasDynamicLayers","visibleSublayers"]})],b.prototype,"dynamicLayers",null);f([q.property({readOnly:!0,dependsOn:["visibleSublayers","layer.serviceSublayers","layer.capabilities"]})],b.prototype,"hasDynamicLayers",null);f([q.property()],b.prototype,"layer",null);f([q.property({readOnly:!0,dependsOn:["visibleSublayers"]})],b.prototype,"layers",null);f([q.property({readOnly:!0,dependsOn:["visibleSublayers"]})],
b.prototype,"layerDefs",null);f([q.property({type:Number,dependsOn:["view.scale"]})],b.prototype,"scale",null);f([q.property(d.combinedViewLayerTimeExtentProperty)],b.prototype,"timeExtent",void 0);f([q.property({dependsOn:"layers layerDefs dynamicLayers layer.dpi layer.imageFormat layer.imageTransparency layer.gdbVersion timeExtent".split(" ")})],b.prototype,"version",null);f([q.property({type:c})],b.prototype,"view",void 0);f([q.property({readOnly:!0,dependsOn:["layer.sublayers","scale"]})],b.prototype,
"visibleSublayers",null);return b=f([q.subclass("esri.layers.mixins.ExportImageParameters")],b)}(q.declared(a));b.ExportImageParameters=g})},"esri/layers/support/sublayerUtils":function(){define(["require","exports","./layerSourceUtils"],function(g,b,l){function k(b,a){if(!b||!b.length)return!0;a=a.slice().reverse().flatten(function(a){return(a=a.sublayers)&&a.toArray().reverse()}).map(function(a){return a.id}).toArray();if(b.length>a.length)return!1;for(var f=0,m=a.length,d=0;d<b.length;d++){for(var c=
b[d].id;f<m&&a[f]!==c;)f++;if(f>=m)return!1}return!0}Object.defineProperty(b,"__esModule",{value:!0});b.shouldWriteSublayerStructure=function(b,a,g){return a.flatten(function(a){return a.sublayers}).length!==b.length||b.some(function(a){return a.originIdOf("minScale")>g||a.originIdOf("maxScale")>g||a.originIdOf("renderer")>g||a.originIdOf("labelingInfo")>g||a.originIdOf("opacity")>g||a.originIdOf("labelsVisible")>g||a.originIdOf("source")>g})?!0:!k(b,a)};b.isExportDynamic=function(b,a,g){return b.some(function(a){var b=
a.source;return!(!b||b.type===l.MAPLAYER&&b.mapLayerId===a.id&&(!b.gdbVersion||b.gdbVersion===g.gdbVersion))||2<a.originIdOf("renderer")||2<a.originIdOf("labelingInfo")||2<a.originIdOf("opacity")||2<a.originIdOf("labelsVisible")})?!0:!k(b,a)};b.isSublayerOverhaul=function(b){return!!b&&b.some(function(a){return null!=a.minScale||a.layerDefinition&&null!=a.layerDefinition.minScale})}})},"esri/symbols/support/symbolUtils":function(){define("require exports ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../core/tsSupport/assignHelper ../../core/compilerUtils ../../core/maybe ../../core/promiseUtils ../../support/arcadeOnDemand ./previewCIMSymbol ./previewSymbol2D ./previewSymbol3D ./previewWebStyleSymbol ./utils".split(" "),
function(g,b,l,k,f,a,q,m,d,c,e,h,p,n){function u(b,d){switch(b.type){case "web-style":return p.previewWebStyleSymbol(b,u,d);case "label-3d":case "line-3d":case "mesh-3d":case "point-3d":case "polygon-3d":return h.previewSymbol3D(b,d);case "simple-marker":case "simple-line":case "simple-fill":case "picture-marker":case "picture-fill":case "text":return e.previewSymbol2D(b,d);case "cim":return c.previewCIMSymbol(b,d);default:a.neverReached(b)}}function x(a){return a&&"opacity"in a?a.opacity*x(a.parent):
1}Object.defineProperty(b,"__esModule",{value:!0});var v=null;b.renderDotDensityPreviewHTML=function(a,b,c){var e=a.backgroundColor,d=a.outline;a=a.dotSize;var h=c&&c.swatchSize||22,f=Math.round(h*h/Math.pow(a,2)*.8),n=window.devicePixelRatio;c=document.createElement("canvas");var m=h*n;c.width=m;c.height=m;c.style.width=c.width/n+"px";c.style.height=c.height/n+"px";var g=c.getContext("2d");e&&(g.fillStyle=e.toCss(!0),g.fillRect(0,0,m,m),g.fill());g.fillStyle=b.toCss(!0);if(v&&v.length/2===f)for(b=
0;b<2*f;b+=2){var e=v[b],p=v[b+1];g.fillRect(e,p,a*n,a*n);g.fill()}else for(v=[],b=0;b<2*f;b+=2)e=Math.floor(Math.random()*(m-0+1)+0),p=Math.floor(Math.random()*(m-0+1)+0),v.push(e,p),g.fillRect(e,p,a*n,a*n),g.fill();d&&(d.color&&(g.strokeStyle=d.color.toCss(!0)),g.lineWidth=d.width,g.strokeRect(0,0,m,m));d=new Image(h,h);d.src=c.toDataURL();return d};b.renderColorRampPreviewHTML=function(a,b){void 0===b&&(b={});var c="horizontal"===b.align,e=b.width,e=void 0===e?c?75:24:e,d=b.height,d=void 0===d?
c?24:75:d;b=b.gradient;var h=void 0===b?!0:b;b=window.devicePixelRatio;var f=e*b,n=d*b;b=document.createElement("canvas");b.width=f;b.height=n;b.style.width=e+"px";b.style.height=d+"px";var m=b.getContext("2d"),g=c?f:0,p=c?0:n;if(h){var k=m.createLinearGradient(0,0,g,p),l=1/(a.length-1);a.forEach(function(a,b){return k.addColorStop(b*l,a.toString())});m.fillStyle=k;m.fillRect(0,0,f,n)}else for(h=c?f/a.length:f,f=c?n:n/a.length,p=g=n=0;p<a.length;p++)m.fillStyle=a[p].toString(),m.fillRect(n,g,h,f),
n=c?n+h:0,g=c?0:g+f;a=document.createElement("div");a.style.width=e+"px";a.style.height=d+"px";a.appendChild(b);return a};b.renderPreviewHTML=u;b.getDisplayedSymbol=function(a,b){return k(this,void 0,void 0,function(){var c,e,h,p,k,u,t,v,w,E,G,J,K,I,N,M,L,Q,O,S,U,T,R;return l(this,function(l){switch(l.label){case 0:if(!a)return[2,void 0];c=x(a.layer||a.sourceLayer);return!q.isSome(a.symbol)||q.isSome(b)&&!0===b.ignoreGraphicSymbol?[3,4]:"web-style"!==a.symbol.type?[3,2]:[4,a.symbol.fetchSymbol(q.isSome(b)?
b.abortOptions:null)];case 1:return h=l.sent(),[3,3];case 2:h=a.symbol.clone(),l.label=3;case 3:return e=h,n.applyColorToSymbol(e,null,c),[2,e];case 4:return p=a.get("layer.renderer")||a.get("sourceLayer.renderer"),[4,p.getSymbolAsync(a)];case 5:return(k=l.sent())?"web-style"!==k.type?[3,7]:[4,k.fetchSymbol(q.isSome(b)?b.abortOptions:null)]:[2,void 0];case 6:return k=l.sent(),[3,8];case 7:k=k.clone(),l.label=8;case 8:if(!("visualVariables"in p)||"visualVariables"in p&&!p.visualVariables||"visualVariables"in
p&&p.visualVariables&&!p.visualVariables.length)return[2,k];if(!p.arcadeRequiredForVisualVariables||!q.isNone(b)&&!q.isNone(b.arcade))return[3,10];t=u=f({},q.unwrap(b));return[4,d.loadArcade()];case 9:t.arcade=l.sent(),b=u,l.label=10;case 10:return[4,m.create(function(a){return g(["../../renderers/visualVariables/support/visualVariableUtils"],a)})];case 11:v=l.sent();w=[];E=[];G=[];J=[];K=0;for(I=p.visualVariables;K<I.length;K++)switch(N=I[K],N.type){case "color":w.push(N);break;case "opacity":E.push(N);
break;case "rotation":J.push(N);break;case "size":N.target||G.push(N)}L=(M=!!w.length&&w[w.length-1])?v.getColor(M,a,b):null;O=(Q=!!E.length&&E[E.length-1])?v.getOpacity(Q,a,b):null;null!=c&&(O=null!=O?O*c:c);n.applyColorToSymbol(k,L,O);if(!G.length)return[3,13];S=v.getAllSizes(G,a,b);return[4,n.applySizesToSymbol(k,S)];case 12:l.sent(),l.label=13;case 13:U=0;for(T=J;U<T.length;U++)R=T[U],n.applyRotationToSymbol(k,v.getRotationAngle(R,a,b),R.axis);return[2,k]}})})}})},"esri/symbols/support/previewCIMSymbol":function(){define(["require",
"exports","../../core/tsSupport/generatorHelper","../../core/tsSupport/awaiterHelper","../cim/CIMSymbolRasterizer"],function(g,b,l,k,f){Object.defineProperty(b,"__esModule",{value:!0});var a=new f(null,!0);b.previewCIMSymbol=function(b,f){void 0===f&&(f={});return k(this,void 0,void 0,function(){var d,c,e,h,m,n,g,k,q,t;return l(this,function(p){switch(p.label){case 0:return d=f.size,c=f.maxSize,e=f.feature,h=f.fieldMap,m=Math.min(d||22,c||120),n=3,[4,a.rasterizeCIMSymbolAsync(b,e,h,{targetSize:m*
n})];case 1:return g=p.sent(),k=document.createElement("canvas"),k.width=g.imageData.width,k.height=g.imageData.height,q=k.getContext("2d"),q.putImageData(g.imageData,0,0),t=new Image(k.width/n,k.height/n),t.src=k.toDataURL(),[2,t]}})})}})},"esri/symbols/cim/CIMSymbolRasterizer":function(){define("require exports ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../request ../../core/promiseUtils ../../core/screenUtils ../../geometry/support/jsonUtils ./cimAnalyzer ./Rasterizer ./TextRasterizer ./utils ../support/cimSymbolUtils ../support/Symbol3DAnchorPosition2D".split(" "),
function(g,b,l,k,f,a,q,m,d,c,e,h,p,n){function u(a){return(a?Object.keys(a):[]).map(function(b){return{name:b,alias:b,type:"string"===typeof a[b]?"esriFieldTypeString":"esriFieldTypeDouble"}})}var x=function(a,b){return a&&a.targetSize?a.targetSize/b.referenceSize:a&&a.scaleFactor?a.scaleFactor:1};return function(){function b(a,b){this._spatialReference=a;this._avoidSDF=b;this._resourceCache=new Map;this._rasterizer=new c.default;this._textRasterizer=new e.default;this._pictureMarkerCache=new Map}
b.prototype.rasterizeCIMSymbolAsync=function(a,b,c,e,d,h,f){return k(this,void 0,void 0,function(){var n,g;return l(this,function(p){switch(p.label){case 0:return n=b?null!==b.centroid?"esriGeometryPolygon":m.getJsonType(b.geometry):null,[4,this.analyzeCIMSymbol(a,b?u(b.attributes):null,c,n,f)];case 1:return g=p.sent(),[2,this.rasterizeCIMSymbol(g,b,e,d,h)]}})})};b.prototype.analyzeCIMSymbol=function(b,c,e,h,f){return k(this,void 0,void 0,function(){var n,m,g,k,q,r,u;return l(this,function(l){switch(l.label){case 0:return[4,
p.fetchSymbol(b,f)];case 1:return n=l.sent(),m=[],c?g={geometryType:h,spatialReference:this._spatialReference,fields:c}:(n=n.clone(),n.data.primitiveOverrides=[],g=null),[4,d.analyzeCIMSymbol(n.data,e,g,m,this._avoidSDF)];case 2:l.sent();a.throwIfAborted(f);q=0;for(r=m;q<r.length;q++)u=r[q],"CIMPictureMarker"===u.cim.type&&(k||(k=[]),k.push(this.fetchPictureMarkerResource(u,f)));return k?[4,a.all(k)]:[3,4];case 3:l.sent(),l.label=4;case 4:return[2,m]}})})};b.prototype.fetchPictureMarkerResource=function(a,
b){return k(this,void 0,void 0,function(){var c,e,d;return l(this,function(h){switch(h.label){case 0:return c=a.materialHash,this._pictureMarkerCache.get(c)?[3,2]:[4,f(a.cim.url,{responseType:"image",signal:b&&b.signal})];case 1:e=h.sent(),d=e.data,this._pictureMarkerCache.set(c,d),h.label=2;case 2:return[2]}})})};b.prototype.rasterizeCIMSymbol=function(a,b,c,e,d){for(var h=[],f=0;f<a.length;f++){var n=a[f];!c||"function"!==typeof c.scaleFactor||"marker"!==n.type&&"text"!==n.type||(c.scaleFactor=
c.scaleFactor(b,e,d));var m=this._getRasterizedResource(n,b,c,e,d);null!=m&&h.push({cimLayer:n,rasterizedResource:m})}return this.getSymbolImage(h,b,c,e,d)};b.prototype.getSymbolImage=function(a,b,c,e,d){for(var f=document.createElement("canvas"),m=f.getContext("2d"),g=0,p=0,k=0,l=0,r=[],u=0;u<a.length;u++){var t=a[u],v=t.rasterizedResource;if(v){var w=t.cimLayer;if("line"!==w.type&&"fill"!==w.type){var y=x(c,w),A=v.size,L=h.evaluateValueOrFunction(w.offsetX,b,e,d)*y,y=h.evaluateValueOrFunction(w.offsetY,
b,e,d)*y,L=L?L:0,y=y?y:0,Q=t.rasterizedResource.anchorX,t=t.rasterizedResource.anchorY,O=!1,S=w.type,U=void 0;"marker"===w.type&&(U=h.evaluateValueOrFunction(w.rotation,b,e,d),O=w.rotateClockwise?w.rotateClockwise:!1);if("text"===w.type){U=h.evaluateValueOrFunction(w.angle,b,e,d);if(void 0!==w.horizontalAlignment)switch(w.horizontalAlignment){case "left":Q=-.5;break;case "right":Q=.5;break;default:Q=0}if(void 0!==w.verticalAlignment)switch(w.verticalAlignment){case "top":t=.5;break;case "bottom":t=
-.5;break;case "baseline":t=-.25;break;default:t=0}}var w=q.pt2px(L)-A[0]*(.5+Q),T=q.pt2px(y)-A[1]*(.5+t),R=w+A[0],P=T+A[1];if(U){O&&(U=-U);var V=Math.sin(U*Math.PI/180),X=Math.cos(U*Math.PI/180),A=w*X-T*V,W=w*V+T*X,Z=w*X-P*V,Y=w*V+P*X,aa=R*X-P*V,P=R*V+P*X,ba=R*X-T*V,V=R*V+T*X,w=Math.min(A,Z,aa,ba),T=Math.min(W,Y,P,V),R=Math.max(A,Z,aa,ba),P=Math.max(W,Y,P,V)}g=w<g?w:g;p=T<p?T:p;k=R>k?R:k;l=P>l?P:l;w=m.createImageData(v.size[0],v.size[1]);w.data.set(new Uint8ClampedArray(v.image.buffer));v={offsetX:L,
offsetY:y,rotateClockwise:O,type:S,angle:U,rasterizedImage:w,anchorX:Q,anchorY:t};r.push(v)}}}f.width=k-g;f.height=l-p;a=-g;for(u=0;u<r.length;u++)v=r[u],b=this._imageDataToCanvas(v.rasterizedImage),c=a-v.rasterizedImage.width*(.5+v.anchorX),e=l-v.rasterizedImage.height*(.5-v.anchorY),v.angle?(d=(360-v.angle)*Math.PI/180,m.save(),m.translate(q.pt2px(v.offsetX),-q.pt2px(v.offsetY)),m.translate(a,l),m.rotate(d),m.translate(-a,-l),m.drawImage(b,c,e),m.restore()):m.drawImage(b,c+q.pt2px(v.offsetX),e-
q.pt2px(v.offsetY));r=new n.default({x:a/f.width-.5,y:l/f.height-.5});return{imageData:0!==f.width&&0!==f.height?m.getImageData(0,0,f.width,f.height):m.createImageData(1,1),anchorPosition:r}};b.prototype._imageDataToCanvas=function(a){this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas"));var b=this._imageDataCanvas,c=b.getContext("2d");b.width=a.width;b.height=a.height;c.putImageData(a,0,0);return b};b.prototype._imageTo32Array=function(a,b,c){this._imageDataCanvas||(this._imageDataCanvas=
document.createElement("canvas"));var e=this._imageDataCanvas,d=e.getContext("2d");e.width=b;e.height=c;d.drawImage(a,0,0,b,c);return new Uint32Array(d.getImageData(0,0,b,c).data.buffer)};b.prototype._getRasterizedResource=function(a,b,c,e,f){var n;if("text"===a.type)n=a.cim,a=this._rasterizeTextResource(a,b,c,e,f);else{var m=this._resourceCache,g=void 0;"function"===typeof a.materialHash?(g=a.materialHash,g=g(b,e,f),n=d.analyzeCIMResource(a.cim,a.materialOverrides)):(g=a.materialHash,c&&(g+=JSON.stringify(c)),
n=a.cim);if(m.has(g))return m.get(g);c=x(c,a);if("CIMPictureMarker"===a.cim.type){f=h.evaluateValueOrFunction(a.cim.size,b,e,f)*c;b=this._pictureMarkerCache.get(a.materialHash);if(!b)return null;c=b.height/b.width;e=1<c?q.pt2px(f):q.pt2px(f)/c;f=1<c?q.pt2px(f)*c:q.pt2px(f);a={image:this._imageTo32Array(b,e,f),size:[e,f],sdf:!1,simplePattern:!1,anchorX:a.anchorPoint?a.anchorPoint.x:0,anchorY:a.anchorPoint?a.anchorPoint.y:0}}else n.size*=c,a=this._rasterizer.rasterizeJSONResource(n,this._avoidSDF);
m.set(g,a)}return a};b.prototype._rasterizeTextResource=function(a,b,c,e,d){var f=x(c,a);c=h.evaluateValueOrFunction(a.text,b,e,d);if(!c||0===c.length)return null;var n=h.evaluateValueOrFunction(a.fontName,b,e,d),m=h.evaluateValueOrFunction(a.style,b,e,d),g=h.evaluateValueOrFunction(a.weight,b,e,d),p=h.evaluateValueOrFunction(a.decoration,b,e,d),f=h.evaluateValueOrFunction(a.size,b,e,d)*f,k=h.evaluateValueOrFunction(a.horizontalAlignment,b,e,d),l=h.evaluateValueOrFunction(a.verticalAlignment,b,e,
d),q=h.colorToArray(h.evaluateValueOrFunction(a.color,b,e,d)),r=h.colorToArray(h.evaluateValueOrFunction(a.outlineColor,b,e,d));a=h.evaluateValueOrFunction(a.outlineSize,b,e,d);return this._textRasterizer.rasterizeText(c,{color:q,size:f,horizontalAlignment:k,verticalAlignment:l,font:{family:n,style:m,weight:g,decoration:p},halo:{size:a||0,color:r,style:m},pixelRatio:1,premultiplyColors:!this._avoidSDF})};return b}()})},"esri/symbols/cim/TextRasterizer":function(){define(["require","exports","../../core/screenUtils"],
function(g,b,l){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function a(){}a.prototype.rasterizeText=function(a,b){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));var d=this._textRasterizationCanvas,c=d.getContext("2d");this.setFontProperties(c,b);this.parameters=b;this.textLines=a.split(/\r?\n/);this.lineHeight=this.computeLineHeight();a=this.computeTextWidth(c,b);var e=this.lineHeight*this.textLines.length;d.width=a;d.height=e;this.renderedLineHeight=
Math.round(this.lineHeight*b.pixelRatio);this.renderedHaloSize=b.halo.size*b.pixelRatio;this.renderedWidth=a*b.pixelRatio;this.renderedHeight=e*b.pixelRatio;d=b.color;this.fillStyle="rgba("+d.slice(0,3).toString()+","+d[3]+")";this.haloStyle="rgb("+b.halo.color.slice(0,3).toString()+")";var d=this.renderedLineHeight,h=this.renderedHaloSize;this.setFontProperties(c,b);a=c.textAlign;var e=this.renderedWidth,f=("center"===a?.5*e:"right"===a?e:0)+h,e=a=0;0<h&&this.renderHalo(c,f,h,a,e,b);e+=h;a+=f;h=
0;for(f=this.textLines;h<f.length;h++){var n=f[h];c.globalCompositeOperation="destination-out";c.fillStyle="rgb(0, 0, 0)";c.fillText(n,a,e);c.globalCompositeOperation="source-over";c.fillStyle=this.fillStyle;c.fillText(n,a,e);e+=d}c=c.getImageData(0,0,this.renderedWidth,this.renderedHeight);c=new Uint8Array(c.data);if(b.premultiplyColors)for(b=void 0,d=0;d<c.length;d+=4)b=c[d+3]/255,c[d]*=b,c[d+1]*=b,c[d+2]*=b;return{size:[this.renderedWidth,this.renderedHeight],image:new Uint32Array(c.buffer),sdf:!1,
simplePattern:!1,anchorX:0,anchorY:0}};a.prototype.renderHalo=function(a,b,d,c,e,h){var f=this.renderedWidth,n=this.renderedHeight;this._haloRasterizationCanvas||(this._haloRasterizationCanvas=document.createElement("canvas"));this._haloRasterizationCanvas.width=f;this._haloRasterizationCanvas.height=n;var g=this._haloRasterizationCanvas,m=g.getContext("2d");m.clearRect(0,0,f,n);this.setFontProperties(m,h);m.fillStyle=this.haloStyle;m.strokeStyle=this.haloStyle;h=3>this.renderedHaloSize;m.lineJoin=
h?"miter":"round";h?this.renderHaloEmulated(m,b,d):this.renderHaloNative(m,b,d);a.globalAlpha=this.parameters.halo.color[3];a.drawImage(g,0,0,f,n,c,e,f,n);a.globalAlpha=1};a.prototype.renderHaloEmulated=function(a,b,d){for(var c=this.renderedLineHeight,e=this.renderedHaloSize,h=0,f=this.textLines;h<f.length;h++){for(var n=f[h],m=0,g=k;m<g.length;m++){var l=g[m];a.fillText(n,b+e*l[0],d+e*l[1])}d+=c}};a.prototype.renderHaloNative=function(a,b,d){for(var c=this.renderedLineHeight,e=this.renderedHaloSize,
h=0,f=this.textLines;h<f.length;h++){for(var n=f[h],m=2*e,g=0;5>g;g++)a.lineWidth=(.6+.1*g)*m,a.strokeText(n,b,d);d+=c}};a.prototype.setFontProperties=function(a,b){var d=b.font;b=d.style+" "+d.weight+" "+l.pt2px(b.size*b.pixelRatio)+"px "+d.family+", sans-serif";a.font=b;a.textAlign="left";a.textBaseline="top"};a.prototype.computeTextWidth=function(a,b){for(var d=0,c=0,e=this.textLines;c<e.length;c++)d=Math.max(d,a.measureText(e[c]).width);b=b.font;if("italic"===b.style||"oblique"===b.style||"string"===
typeof b.weight&&("bold"===b.weight||"bolder"===b.weight)||"number"===typeof b.weight&&600<b.weight)d+=.3*a.measureText("A").width;d+=2*this.parameters.halo.size;return Math.round(d)};a.prototype.computeLineHeight=function(){return Math.round(1.275*this.parameters.size+2*this.parameters.halo.size)};return a}();b.TextRasterizer=g;for(var k=[],f=0;360>f;f+=22.5)k.push([Math.cos(Math.PI*f/180),Math.sin(Math.PI*f/180)]);b.default=g})},"esri/symbols/support/previewSymbol2D":function(){define("require exports ../../core/Error ../../core/promiseUtils ../../core/screenUtils ./gfxUtils ./previewUtils ./renderUtils".split(" "),
function(g,b,l,k,f,a,q,m){function d(a,b){var c=e.getContext("2d"),d=[];b&&(b.weight&&d.push(b.weight),b.size&&d.push(b.size+"px"),b.family&&d.push(b.family));c.font=d.join(" ");return c.measureText(a).width}function c(a){if(0===a.length)return 0;if(2<a.length){var b=f.px2pt(1),c=parseFloat(a);switch(a.slice(-2)){case "px":return c;case "pt":return c*b;case "in":return 72*c*b;case "pc":return 12*c*b;case "mm":return c*h*b;case "cm":return c*p*b}}return parseFloat(a)}Object.defineProperty(b,"__esModule",
{value:!0});var e=document.createElement("canvas"),h=7.2/2.54,p=72/2.54;b.previewSymbol2D=function(b,e){var h=e&&e.size?f.pt2px(e.size):null,n=e&&e.maxSize?f.pt2px(e.maxSize):null,g=e&&null!=e.opacity?e.opacity:null,p=e&&null!=e.rotation?e.rotation:null,r=a.getStroke(b),u={shape:null,fill:null,stroke:r};r&&r.width&&(r.width=Math.min(r.width,80));var A=0,z=0;switch(b.type){case "simple-marker":var r=b.style,B=f.pt2px(b.size),A=Math.min(h||B||22,n||120),z=Math.min(h||B||22,n||120);switch(r){case "circle":u.shape=
{type:"circle",cx:.5*B,cy:.5*B,r:.5*B};break;case "cross":u.shape={type:"path",path:[{command:"M",values:[0,.5*z]},{command:"L",values:[A,.5*z]},{command:"M",values:[.5*A,0]},{command:"L",values:[.5*A,z]}]};break;case "diamond":u.shape={type:"path",path:[{command:"M",values:[0,.5*z]},{command:"L",values:[.5*A,0]},{command:"L",values:[A,.5*z]},{command:"L",values:[.5*A,z]},{command:"Z",values:[]}]};break;case "square":u.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[A,0]},
{command:"L",values:[A,z]},{command:"L",values:[0,z]},{command:"Z",values:[]}]};break;case "triangle":u.shape={type:"path",path:[{command:"M",values:[.5*A,0]},{command:"L",values:[A,z]},{command:"L",values:[0,z]},{command:"Z",values:[]}]};break;case "x":u.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[A,z]},{command:"M",values:[A,0]},{command:"L",values:[0,z]}]};break;case "path":u.shape={type:"path",path:b.path||""}}break;case "simple-line":h=Math.min(h||r&&r.width||22,
n||80);r.width=h;A=22<h?2*h:40;z=h;u.shape={type:"path",path:[{command:"M",values:[0,z]},{command:"L",values:[A,z]}]};break;case "picture-fill":case "simple-fill":A=Math.min(h||22,n||120);z=Math.min(h||22,n||120);u.shape=q.shapes.fill[0];break;case "picture-marker":var r=f.pt2px(b.width),C=f.pt2px(b.height),B=Math.max(r,C),C=r/C,r=1>=C?Math.ceil(B*C):B,C=1>=C?B:Math.ceil(B/C),A=Math.min(h||r||22,n||120),z=Math.min(h||C||22,n||120);u.shape={type:"image",x:-Math.round(A/2),y:-Math.round(z/2),width:A,
height:z,src:b.url||""};break;case "text":r=b.text||"Aa",B=b.font,h=Math.min(h||f.pt2px(B.size),n||120),C=d(r,{weight:B.weight,size:h,family:B.family}),A=(n=/[\uE600-\uE6FF]/.test(r))?h:C,z=h,C=.25*c((B?h:0).toString()),n&&(C+=5),u.shape={type:"text",text:r,x:0,y:C,align:"middle",decoration:B&&B.decoration,rotated:b.rotated,kerning:b.kerning},u.font=B&&{size:h,style:B.style,decoration:B.decoration,weight:B.weight,family:B.family}}if(!u.shape)return k.reject(new l("symbolPreview: renderPreviewHTML2D",
"symbol not supported."));var D=a.getFill(b),h=b.color,n=null;D&&"pattern"===D.type&&h&&"picture-fill"!==b.type?n=a.getPatternUrlWithColor(D.src,h.toCss(!0)).then(function(a){D.src=a;u.fill=D;return u}):(u.fill=D,n=k.resolve(u));return n.then(function(a){return m.renderSymbol([[a]],[A,z],{node:e&&e.node,scale:!0,opacity:g,rotation:p})})}})},"esri/symbols/support/gfxUtils":function(){define("require exports ../../core/tsSupport/assignHelper ../../Color ../../request ../../core/ItemCache ../../core/promiseUtils ../../core/screenUtils".split(" "),
function(g,b,l,k,f,a,q,m){function d(a){if(!a)return null;var b;switch(a.type){case "simple-fill":case "picture-fill":case "simple-marker":b=d(a.outline);break;case "simple-line":var c=m.pt2px(a.width);"none"!==a.style&&0!==c&&(b={color:a.color,style:n(a.style),width:c,cap:a.cap,join:"miter"===a.join?m.pt2px(a.miterLimit):a.join});break;default:b=null}return b}Object.defineProperty(b,"__esModule",{value:!0});var c=g.toUrl("../../symbols/patterns/"),e={left:"start",center:"middle",right:"end",justify:"start"},
h={top:"text-before-edge",middle:"central",baseline:"alphabetic",bottom:"text-after-edge"},p=new a(1E3);b.getSVGAlign=function(a){return a=(a=a.horizontalAlignment)&&e[a.toLowerCase()]||"middle"};b.getSVGBaseline=function(a){return(a=a.verticalAlignment)&&h[a.toLowerCase()]||"alphabetic"};b.getSVGBaselineShift=function(a){return"bottom"===a.verticalAlignment?"super":null};b.getFill=function(a){var b=a.style,e=null;if(a)switch(a.type){case "simple-marker":"cross"!==b&&"x"!==b&&(e=a.color);break;case "simple-fill":"solid"===
b?e=a.color:"none"!==b&&(e={type:"pattern",x:0,y:0,src:c+b+".png",width:8,height:8});break;case "picture-fill":e={type:"pattern",src:a.url,width:m.pt2px(a.width)*a.xscale,height:m.pt2px(a.height)*a.yscale,x:m.pt2px(a.xoffset),y:m.pt2px(a.yoffset)};break;case "text":e=a.color}return e};b.getPatternUrlWithColor=function(a,b){var c=a+"-"+b;return void 0!==p.get(c)?q.resolve(p.get(c)):f(a,{responseType:"image"}).then(function(a){a=a.data;var e=a.naturalWidth,d=a.naturalHeight,h=document.createElement("canvas");
h.width=e;h.height=d;var f=h.getContext("2d");f.fillStyle=b;f.fillRect(0,0,e,d);f.globalCompositeOperation="destination-in";f.drawImage(a,0,0);a=h.toDataURL();p.put(c,a);return a})};b.getStroke=d;var n=function(){var a={};return function(b){if(a[b])return a[b];var c=b.replace(/-/g,"");return a[b]=c}}();b.defaultThematicColor=new k([128,128,128])})},"esri/core/ItemCache":function(){define(["require","exports","./MemCache"],function(g,b,l){return function(){function b(b,a){this._storage=new l.MemCacheStorage;
this._storage.maxSize=b;a&&this._storage.registerRemoveFunc("",a)}b.prototype.put=function(b,a){this._storage.put(b,a,1,1)};b.prototype.pop=function(b){return this._storage.pop(b)};b.prototype.get=function(b){return this._storage.get(b)};b.prototype.clear=function(){this._storage.clearAll()};b.prototype.destroy=function(){this._storage.clearAll()};return b}()})},"esri/symbols/support/previewUtils":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});
b.shapes={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",
path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",
path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},
{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};b.getPathSymbolShapes=function(b){var g=22,f=22;1>b?g*=.75:1<b&&(f*=1.25);return[{type:"path",path:[{command:"M",values:[22,0]},{command:"L",values:[19.25,0]},{command:"L",values:[0,f-11]},{command:"L",values:[g-11,f-11]},{command:"Z",
values:[]}]},{type:"path",path:[{command:"M",values:[22,0]},{command:"L",values:[22,2.75]},{command:"L",values:[g-11,22]},{command:"L",values:[g-11,f-11]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[g-11,f-11]},{command:"L",values:[0,f-11]},{command:"L",values:[0,22]},{command:"L",values:[g-11,22]},{command:"Z",values:[]}]}]};b.getExtrudeSymbolShapes=function(b){b*=.5;return[{type:"path",path:[{command:"M",values:[0,.7*11]},{command:"L",values:[6.6,22*.7]},{command:"L",values:[6.6,
22*.7+b]},{command:"L",values:[0,22*.7+b-.7*11]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[6.6,22*.7]},{command:"L",values:[6.6,22*.7+b]},{command:"L",values:[22,b]},{command:"L",values:[22,0]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[6.6,0]},{command:"L",values:[22,0]},{command:"L",values:[6.6,22*.7]},{command:"L",values:[0,.7*11]},{command:"Z",values:[]}]}]};b.getWaterSymbolShapes=function(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},
{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},
{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]};
b.getCubeShapes=function(b,g){var f=g?20:b,a=g?4:6,a=f=22>=f?f-.5*a:f-a;g=g?.35*f:.5*f;return[{type:"path",path:[{command:"M",values:[.5*a,0]},{command:"L",values:[a,.5*g]},{command:"L",values:[.5*a,g]},{command:"L",values:[0,.5*g]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*g]},{command:"L",values:[.5*a,g]},{command:"L",values:[.5*a,b]},{command:"L",values:[0,b-.5*g]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*a,g]},{command:"L",values:[.5*a,
b]},{command:"L",values:[a,b-.5*g]},{command:"L",values:[a,.5*g]},{command:"Z",values:[]}]}]};b.getCylinderShapes=function(b,g){var f=g?20:b;g=g?4:6;f=22>=f?f-.5*g:f-g;g=.5*f;var a=.15*f;b-=a;return[{type:"ellipse",cx:.5*f,cy:b,rx:g,ry:a},{type:"path",path:[{command:"M",values:[0,a]},{command:"L",values:[0,b]},{command:"L",values:[f,b]},{command:"L",values:[f,a]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*f,cy:a,rx:g,ry:a}]};b.getConeShapes=function(b,g){var f=g?20:b;g=g?4:6;f=22>=f?f-.5*g:f-
g;g=.15*f;var a=f;b-=g;return[{type:"ellipse",cx:.5*f,cy:b,rx:.5*f,ry:g},{type:"path",path:[{command:"M",values:[.5*a,0]},{command:"L",values:[a,b]},{command:"L",values:[0,b]},{command:"Z",values:[]}]}]};b.getInvertedConeShapes=function(b){var g=b,g=22>g?g-3:g-6,f=.15*g,a=g;return[{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[a,0]},{command:"L",values:[.5*a,b-f]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*g,cy:0,rx:.5*g,ry:f}]};b.getDiamondShapes=function(b){var g=b,g=22>
g?g-2:g-4,f=Math.floor(b/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*g,0]},{command:"L",values:[g,.5*b-f]},{command:"L",values:[.45*g-f,.5*b+f]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*g,0]},{command:"L",values:[.45*g-f,.5*b+f]},{command:"L",values:[0,.5*b-f]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*b-f]},{command:"L",values:[.45*g-f,.5*b+f]},{command:"L",values:[.45*g,b]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",
values:[.45*g,b]},{command:"L",values:[g,.5*b-f]},{command:"L",values:[.45*g-f,.5*b+f]},{command:"Z",values:[]}]}]};b.getTetrahedronShapes=function(b){var g=b,g=22>g?g-1:g-2;return[{type:"path",path:[{command:"M",values:[.45*b,0]},{command:"L",values:[b,g]},{command:"L",values:[.45*b,.6*g]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*b,0]},{command:"L",values:[.45*b,.6*g]},{command:"L",values:[0,g]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,g]},
{command:"L",values:[.45*b,.6*g]},{command:"L",values:[b,g]},{command:"Z",values:[]}]}]}})},"esri/symbols/support/renderUtils":function(){define("require exports ../../kernel ../../request ../../core/colorUtils ../../core/Error ../../core/has ../../core/promiseUtils ../../libs/maquette/index ./svgUtils".split(" "),function(g,b,l,k,f,a,q,m,d,c){function e(b,c,e){return b?k(b,{responseType:"image"}).then(function(a){a=a.data;var b=a.width,d=a.height,h=b/d,f=c;e&&(f=Math.min(f,Math.max(b,d)));return{image:a,
width:1>=h?Math.ceil(f*h):f,height:1>=h?f:Math.ceil(f/h)}}):m.reject(new a("renderUtils: imageDataSize","href not provided."))}Object.defineProperty(b,"__esModule",{value:!0});var h=d.createProjector();b.renderSymbol=function(a,b,e){var d=Math.ceil(b[0]);b=Math.ceil(b[1]);if(!a.some(function(a){return!!a.length}))return null;var f=e&&e.node||document.createElement("div");null!=e.opacity&&(f.style.opacity=e.opacity.toString());h.append(f,c.renderSVG.bind(null,a,d,b,e));return f};b.tintImageWithColor=
function(a,b,c,d,h){return e(a,b,h).then(function(e){var h=e.width?e.width:b,n=e.height?e.height:b,g;if(g=e.image)g=c&&"ignore"!==d?"multiply"===d&&255===c.r&&255===c.g&&255===c.b&&1===c.a?!1:!0:!1;if(g){var m=e.image.width,p=e.image.height;(q("edge")||q("ie"))&&/\.svg$/i.test(a)&&(--m,--p);var k,u;k=Math.ceil(h);u=Math.ceil(n);g=document.createElement("canvas");g.width=k;g.height=u;g.style.width=k+"px";g.style.height=u+"px";g=g.getContext("2d");g.clearRect(0,0,k,u);g.drawImage(e.image,0,0,m,p,0,
0,h,n);e=g.getImageData(0,0,h,n);m=[c.r/255,c.g/255,c.b/255,c.a];p=f.toHSV(c);for(k=0;k<e.data.length;k+=4){u=e.data;var t=k,x=m,v=p;switch(d){case "multiply":u[t+0]*=x[0];u[t+1]*=x[1];u[t+2]*=x[2];u[t+3]*=x[3];break;default:var E=f.toHSV({r:u[t+0],g:u[t+1],b:u[t+2]});E.h=v.h;E.s=v.s;E.v=E.v/100*v.v;v=f.toRGB(E);u[t+0]=v.r;u[t+1]=v.g;u[t+2]=v.b;u[t+3]*=x[3]}}g.putImageData(e,0,0);a=g.canvas.toDataURL("image/png")}else(g=l.id&&l.id.findCredential(a))&&g.token&&(e=-1===a.indexOf("?")?"?":"\x26",a=""+
a+e+"token\x3d"+g.token);return{url:a,width:h,height:n}}).catch(function(){return{url:a,width:b,height:b}})}})},"esri/core/colorUtils":function(){define(["require","exports"],function(g,b){function l(a,b){var c=[],e,d;if(a[0].length!==b.length)throw"dimensions do not match";var h=a.length,f=a[0].length,g=0;for(e=0;e<h;e++){for(d=g=0;d<f;d++)g+=a[e][d]*b[d];c.push(g)}return c}function k(a){a=[a.r/255,a.g/255,a.b/255].map(function(a){return.04045>=a?a/12.92:Math.pow((a+.055)/1.055,2.4)});a=l(d,a);return{x:100*
a[0],y:100*a[1],z:100*a[2]}}function f(a){a=l(c,[a.x/100,a.y/100,a.z/100]).map(function(a){return Math.min(1,Math.max(.0031308>=a?12.92*a:1.055*Math.pow(a,1/2.4)-.055,0))});return{r:Math.round(255*a[0]),g:Math.round(255*a[1]),b:Math.round(255*a[2])}}function a(a){a=[a.x/95.047,a.y/100,a.z/108.883].map(function(a){return a>Math.pow(6/29,3)?Math.pow(a,1/3):1/3*Math.pow(29/6,2)*a+4/29});return{l:116*a[1]-16,a:500*(a[0]-a[1]),b:200*(a[1]-a[2])}}function q(a){var b=a.l;a=[(b+16)/116+a.a/500,(b+16)/116,
(b+16)/116-a.b/200].map(function(a){return a>6/29?Math.pow(a,3):3*Math.pow(6/29,2)*(a-4/29)});return{x:95.047*a[0],y:100*a[1],z:108.883*a[2]}}function m(a){if("r"in a&&"g"in a&&"b"in a)return a;if("l"in a&&"c"in a&&"h"in a){var b=a.c,c=a.h;return f(q({l:a.l,a:b*Math.cos(c),b:b*Math.sin(c)}))}if("l"in a&&"a"in a&&"b"in a)return f(q(a));if("x"in a&&"y"in a&&"z"in a)return f(a);if("h"in a&&"s"in a&&"v"in a){c=(a.h+360)%360/60;b=a.v/100*255;a=a.s/100*b;var e=a*(1-Math.abs(c%2-1));switch(Math.floor(c)){case 0:c=
{r:a,g:e,b:0};break;case 1:c={r:e,g:a,b:0};break;case 2:c={r:0,g:a,b:e};break;case 3:c={r:0,g:e,b:a};break;case 4:c={r:e,g:0,b:a};break;case 5:case 6:c={r:a,g:0,b:e};break;default:c={r:0,g:0,b:0}}c.r=Math.round(c.r+b-a);c.g=Math.round(c.g+b-a);c.b=Math.round(c.b+b-a);return c}}Object.defineProperty(b,"__esModule",{value:!0});var d=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],c=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];b.toRGB=m;b.toHSV=function(a){if("h"in
a&&"s"in a&&"v"in a)return a;var b=m(a);a=b.r;var c=b.g,b=b.b,e=Math.max(a,c,b),d=e-Math.min(a,c,b),f;0===d?f=0:e===a?f=(c-b)/d%6:e===c?f=(b-a)/d+2:e===b&&(f=(a-c)/d+4);0>f&&(f+=6);return{h:60*f,s:100*(0===d?0:d/e),v:100/255*e}};b.toLAB=function(b){return"l"in b&&"a"in b&&"b"in b?b:a(k(m(b)))};b.toLCH=function(b){if(!("l"in b&&"c"in b&&"h"in b)){var c=a(k(m(b)));b=c.l;var e=c.a,d=c.b,c=Math.sqrt(e*e+d*d),e=Math.atan2(d,e),e=0<e?e:e+2*Math.PI;b={l:b,c:c,h:e}}return b};b.toXYZ=function(a){return"x"in
a&&"y"in a&&"z"in a?a:k(m(a))};b.darken=function(b,c){b=a(k(b));b.l*=1-c;return f(q(b))}})},"esri/symbols/support/svgUtils":function(){define("require exports ../../Color ../../core/has ../../core/libs/gl-matrix-2/mat2df32 ../../core/libs/gl-matrix-2/math/mat2d ../../widgets/support/widget".split(" "),function(g,b,l,k,f,a,q){function m(a){return a.map(function(a){return a.command+" "+a.values.join(" ")}).join(" ").trim()}function d(a,b,c,e){if(a){if("circle"===a.type)return q.tsx("circle",{fill:b,
"fill-rule":"evenodd",stroke:c.color,"stroke-width":c.width,"stroke-linecap":c.cap,"stroke-linejoin":c.join,"stroke-dasharray":c.dashArray,"stroke-miterlimit":"4",cx:a.cx,cy:a.cy,r:a.r});if("ellipse"===a.type)return q.tsx("ellipse",{fill:b,"fill-rule":"evenodd",stroke:c.color,"stroke-width":c.width,"stroke-linecap":c.cap,"stroke-linejoin":c.join,"stroke-dasharray":c.dashArray,"stroke-miterlimit":"4",cx:a.cx,cy:a.cy,rx:a.rx,ry:a.ry});if("rect"===a.type)return q.tsx("rect",{fill:b,"fill-rule":"evenodd",
stroke:c.color,"stroke-width":c.width,"stroke-linecap":c.cap,"stroke-linejoin":c.join,"stroke-dasharray":c.dashArray,"stroke-miterlimit":"4",x:a.x,y:a.y,width:a.width,height:a.height});if("image"===a.type)return q.tsx("image",{href:a.src,x:a.x,y:a.y,width:a.width,height:a.height,preserveAspectRatio:"none"});if("path"===a.type)return a="string"!==typeof a.path?m(a.path):a.path,q.tsx("path",{fill:b,"fill-rule":"evenodd",stroke:c.color,"stroke-width":c.width,"stroke-linecap":c.cap,"stroke-linejoin":c.join,
"stroke-dasharray":c.dashArray,"stroke-miterlimit":"4",d:a});if("text"===a.type)return q.tsx("text",{fill:b,"fill-rule":"evenodd",stroke:c.color,"stroke-width":c.width,"stroke-linecap":c.cap,"stroke-linejoin":c.join,"stroke-dasharray":c.dashArray,"stroke-miterlimit":"4","text-anchor":e.align,"text-decoration":e.decoration,kerning:e.kerning,rotate:e.rotate,"text-rendering":C,"font-style":e.font.style,"font-variant":e.font.variant,"font-weight":e.font.weight,"font-size":e.font.size,"font-family":e.font.family,
x:a.x,y:a.y},a.text)}return null}function c(a){var b={fill:"none",pattern:null,linearGradient:null};if(a)if("type"in a&&"pattern"===a.type){var c="patternId-"+ ++z;b.fill="url(#"+c+")";b.pattern={id:c,x:a.x,y:a.y,width:a.width,height:a.height,image:{x:0,y:0,width:a.width,height:a.height,href:a.src}}}else"type"in a&&"linear"===a.type?(c="linearGradientId-"+ ++B,b.fill="url(#"+c+")",b.linearGradient={id:c,x1:a.x1,y1:a.y1,x2:a.x2,y2:a.y2,stops:a.colors.map(function(a){return{offset:a.offset,color:a.color&&
(new l(a.color)).toString()}})}):a&&(a=new l(a),b.fill=a.toString());return b}function e(a){var b={color:"none",width:1,cap:"butt",join:"4",dashArray:"none"};if(a&&(null!=a.width&&(b.width=a.width),a.cap&&(b.cap=a.cap),a.join&&(b.join=a.join.toString()),a.color&&(b.color=(new l(a.color)).toString()),a.style)){var c=null;a.style in G&&(c=G[a.style]);if(Array.isArray(c)){for(var c=c.slice(0),e=0;e<c.length;++e)c[e]*=a.width;if("butt"!==a.cap){for(e=0;e<c.length;e+=2)c[e]-=a.width,1>c[e]&&(c[e]=1);for(e=
1;e<c.length;e+=2)c[e]+=a.width}c=c.join(",")}b.dashArray=c}return b}function h(a,b){var c={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};a&&(c.align=a.align,c.decoration=a.decoration,c.kerning=a.kerning?"auto":"0",c.rotate=a.rotated?"90":"0",c.font.style=b.style||"normal",c.font.variant=b.variant||"normal",c.font.weight=b.weight||"normal",c.font.size=b.size&&b.size.toString()||"10pt",c.font.family=b.family||"serif");return c}
function p(a){var b=a.pattern;a=a.linearGradient;return b?q.tsx("pattern",{id:b.id,patternUnits:"userSpaceOnUse",x:b.x,y:b.y,width:b.width,height:b.height},q.tsx("image",{x:b.image.x,y:b.image.y,width:b.image.width,height:b.image.height,href:b.image.href})):a?(b=a.stops.map(function(a,b){return q.tsx("stop",{key:b+"-stop",offset:a.offset,"stop-color":a.color})}),q.tsx("linearGradient",{id:a.id,gradientUnits:"userSpaceOnUse",x1:a.x1,y1:a.y1,x2:a.x2,y2:a.y2},b)):null}function n(b,c,e){return a.translate(b,
a.identity(b),[c,e])}function u(b,c,e,d,h){a.scale(b,a.identity(b),[c,e]);b[4]=b[4]*c-d*c+d;b[5]=b[5]*e-h*e+h;return b}function x(b,c,e,d){var h=c%360*Math.PI/180;a.rotate(b,a.identity(b),h);c=Math.cos(h);var h=Math.sin(h),f=b[4],n=b[5];b[4]=f*c-n*h+d*h-e*c+e;b[5]=n*c+f*h-e*h-d*c+d;return b}function v(a,b){F&&"left"in F?(F.left>a&&(F.left=a),F.right<a&&(F.right=a),F.top>b&&(F.top=b),F.bottom<b&&(F.bottom=b)):F={left:a,bottom:b,right:a,top:b}}function t(a){var b=a.args,c=b.length;switch(a.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(a=
0;a<c;a+=2)v(b[a],b[a+1]);E.x=b[c-2];E.y=b[c-1];break;case "H":for(a=0;a<c;++a)v(b[a],E.y);E.x=b[c-1];break;case "V":for(a=0;a<c;++a)v(E.x,b[a]);E.y=b[c-1];break;case "m":a=0;"x"in E||(v(E.x=b[0],E.y=b[1]),a=2);for(;a<c;a+=2)v(E.x+=b[a],E.y+=b[a+1]);break;case "l":case "t":for(a=0;a<c;a+=2)v(E.x+=b[a],E.y+=b[a+1]);break;case "h":for(a=0;a<c;++a)v(E.x+=b[a],E.y);break;case "v":for(a=0;a<c;++a)v(E.x,E.y+=b[a]);break;case "c":for(a=0;a<c;a+=6)v(E.x+b[a],E.y+b[a+1]),v(E.x+b[a+2],E.y+b[a+3]),v(E.x+=b[a+
4],E.y+=b[a+5]);break;case "s":case "q":for(a=0;a<c;a+=4)v(E.x+b[a],E.y+b[a+1]),v(E.x+=b[a+2],E.y+=b[a+3]);break;case "A":for(a=0;a<c;a+=7)v(b[a+5],b[a+6]);E.x=b[c-2];E.y=b[c-1];break;case "a":for(a=0;a<c;a+=7)v(E.x+=b[a+5],E.y+=b[a+6])}}function w(a,b,c){var e=D[a.toLowerCase()];"number"===typeof e&&(e?b.length>=e&&(a={action:a,args:b.slice(0,b.length-b.length%e)},c.push(a),t(a)):(a={action:a,args:[]},c.push(a),t(a)))}function r(a){var b={x:0,y:0,width:0,height:0};if("circle"===a.type)b.x=a.cx-a.r,
b.y=a.cy-a.r,b.width=2*a.r,b.height=2*a.r;else if("ellipse"===a.type)b.x=a.cx-a.rx,b.y=a.cy-a.ry,b.width=2*a.rx,b.height=2*a.ry;else if("image"===a.type||"rect"===a.type)b.x=a.x,b.y=a.y,b.width=a.width,b.height=a.height;else if("path"===a.type){a=("string"!==typeof a.path?m(a.path):a.path).match(H);var c=[];F={};E={};if(a){for(var e="",d=[],h=a.length,f=0;f<h;++f){var n=a[f],g=parseFloat(n);isNaN(g)?(e&&w(e,d,c),d=[],e=n):d.push(g)}w(e,d,c);a={x:0,y:0,width:0,height:0};F&&"left"in F&&(a.x=F.left,
a.y=F.top,a.width=F.right-F.left,a.height=F.bottom-F.top)}else a=null;b.x=a.x;b.y=a.y;b.width=a.width;b.height=a.height}return b}function y(a){for(var b={x:0,y:0,width:0,height:0},c=null,e=Number.NEGATIVE_INFINITY,d=Number.NEGATIVE_INFINITY,h=0;h<a.length;h++){var f=a[h];c?(c.x=Math.min(c.x,f.x),c.y=Math.min(c.y,f.y),e=Math.max(e,f.x+f.width),d=Math.max(d,f.y+f.height)):(c=b,c.x=f.x,c.y=f.y,e=f.x+f.width,d=f.y+f.height)}c&&(c.width=e-c.x,c.height=d-c.y);return c}function A(b,c,e,d,h,g){var m=c/2,
p=e/2,k=b.width+d,l=b.height+d,q=f.mat2df32.create(),r=f.mat2df32.create(),t=!1;if(h&&0!==k&&0!==l){h=k/l;var t=c>e?c:e,v=1,w=1;isNaN(t)||(1<h?(v=t/k,w=t/h/l):(w=t/l,v=t*h/k));a.multiply(r,r,u(q,v,w,m,p));t=!0}h=b.x+(k-d)/2;b=b.y+(l-d)/2;a.multiply(r,r,n(q,m-h,p-b));!t&&(k>c||l>e)&&(m=k/c>l/e,c=(m?c:e)/(m?k:l),a.multiply(r,r,u(q,c,c,h,b)));g&&a.multiply(r,r,x(q,g,h,b));return"matrix("+r[0]+","+r[1]+","+r[2]+","+r[3]+","+r[4]+","+r[5]+")"}Object.defineProperty(b,"__esModule",{value:!0});var z=0,B=
0,C=k("chrome")?"auto":"optimizeLegibility",D={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},H=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g,F={},E={},G={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};b.renderShape=d;b.generateFillAttributes=c;b.generateStrokeAttributes=e;b.generateTextAttributes=h;b.renderDef=p;b.getBoundingBox=r;b.computeBBox=
y;b.getTransformMatrix=A;b.renderSVG=function(a,b,f,n){for(var g=[],m=[],k=0;k<a.length;k++){for(var l=[],u=[],t=0,x=0,v=a[k];x<v.length;x++){var w=v[x],z=w.shape,B=w.fill,C=w.stroke,w=w.font,t=t+(C&&C.width||0),B=c(B),C=e(C),w="text"===z.type?h(z,w):null;g.push(p(B));l.push(d(z,B.fill,C,w));u.push(r(z))}u=A(y(u),b,f,t,n&&n.scale,n&&n.rotation);m.push(q.tsx("g",{transform:u},l))}return q.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:b,height:f},q.tsx("defs",null,g),m)}})},"esri/core/libs/gl-matrix-2/mat2df32":function(){define(["require",
"exports","./factories/mat2df32"],function(g,b,l){Object.defineProperty(b,"__esModule",{value:!0});b.mat2df32=l})},"esri/core/libs/gl-matrix-2/factories/mat2df32":function(){define(["require","exports"],function(g,b){function l(b,f,a,g){var m=f[g];f=f[g+1];b[g]=a[0]*m+a[2]*f+a[4];b[g+1]=a[1]*m+a[3]*f+a[5]}Object.defineProperty(b,"__esModule",{value:!0});b.create=function(){var b=new Float32Array(6);b[0]=1;b[3]=1;return b};b.clone=function(b){var f=new Float32Array(6);f[0]=b[0];f[1]=b[1];f[2]=b[2];
f[3]=b[3];f[4]=b[4];f[5]=b[5];return f};b.fromValues=function(b,f,a,g,m,d){var c=new Float32Array(6);c[0]=b;c[1]=f;c[2]=a;c[3]=g;c[4]=m;c[5]=d;return c};b.createView=function(b,f){return new Float32Array(b,f,6)};b.transform=l;b.transformMany=function(b,f,a,g,m,d){void 0===g&&(g=0);void 0===m&&(m=0);void 0===d&&(d=2);for(m=m||f.length/d;g<m;g++)l(b,f,a,g*d)}})},"esri/core/libs/gl-matrix-2/math/mat2d":function(){define(["require","exports","./common"],function(g,b,l){function k(a,b,f){var d=b[0],c=
b[1],e=b[2],h=b[3],g=b[4];b=b[5];var n=f[0],m=f[1],k=f[2],l=f[3],q=f[4];f=f[5];a[0]=d*n+e*m;a[1]=c*n+h*m;a[2]=d*k+e*l;a[3]=c*k+h*l;a[4]=d*q+e*f+g;a[5]=c*q+h*f+b;return a}function f(a,b,f){a[0]=b[0]-f[0];a[1]=b[1]-f[1];a[2]=b[2]-f[2];a[3]=b[3]-f[3];a[4]=b[4]-f[4];a[5]=b[5]-f[5];return a}Object.defineProperty(b,"__esModule",{value:!0});b.copy=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];return a};b.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;return a};
b.set=function(a,b,f,d,c,e,h){a[0]=b;a[1]=f;a[2]=d;a[3]=c;a[4]=e;a[5]=h;return a};b.invert=function(a,b){var f=b[0],d=b[1],c=b[2],e=b[3],h=b[4];b=b[5];var g=f*e-d*c;if(!g)return null;g=1/g;a[0]=e*g;a[1]=-d*g;a[2]=-c*g;a[3]=f*g;a[4]=(c*b-e*h)*g;a[5]=(d*h-f*b)*g;return a};b.determinant=function(a){return a[0]*a[3]-a[1]*a[2]};b.multiply=k;b.rotate=function(a,b,f){var d=b[0],c=b[1],e=b[2],h=b[3],g=b[4];b=b[5];var n=Math.sin(f);f=Math.cos(f);a[0]=d*f+e*n;a[1]=c*f+h*n;a[2]=d*-n+e*f;a[3]=c*-n+h*f;a[4]=g;
a[5]=b;return a};b.scale=function(a,b,f){var d=b[1],c=b[2],e=b[3],h=b[4],g=b[5],n=f[0];f=f[1];a[0]=b[0]*n;a[1]=d*n;a[2]=c*f;a[3]=e*f;a[4]=h;a[5]=g;return a};b.translate=function(a,b,f){var d=b[0],c=b[1],e=b[2],h=b[3],g=b[4];b=b[5];var n=f[0];f=f[1];a[0]=d;a[1]=c;a[2]=e;a[3]=h;a[4]=d*n+e*f+g;a[5]=c*n+h*f+b;return a};b.fromRotation=function(a,b){var f=Math.sin(b);b=Math.cos(b);a[0]=b;a[1]=f;a[2]=-f;a[3]=b;a[4]=0;a[5]=0;return a};b.fromScaling=function(a,b){a[0]=b[0];a[1]=0;a[2]=0;a[3]=b[1];a[4]=0;a[5]=
0;return a};b.fromTranslation=function(a,b){a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=b[0];a[5]=b[1];return a};b.str=function(a){return"mat2d("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+")"};b.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+1)};b.add=function(a,b,f){a[0]=b[0]+f[0];a[1]=b[1]+f[1];a[2]=b[2]+f[2];a[3]=b[3]+f[3];a[4]=b[4]+f[4];a[5]=b[5]+f[5];return a};b.subtract=f;b.multiplyScalar=function(a,b,
f){a[0]=b[0]*f;a[1]=b[1]*f;a[2]=b[2]*f;a[3]=b[3]*f;a[4]=b[4]*f;a[5]=b[5]*f;return a};b.multiplyScalarAndAdd=function(a,b,f,d){a[0]=b[0]+f[0]*d;a[1]=b[1]+f[1]*d;a[2]=b[2]+f[2]*d;a[3]=b[3]+f[3]*d;a[4]=b[4]+f[4]*d;a[5]=b[5]+f[5]*d;return a};b.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]};b.equals=function(a,b){var f=a[0],d=a[1],c=a[2],e=a[3],h=a[4];a=a[5];var g=b[0],n=b[1],k=b[2],q=b[3],v=b[4];b=b[5];return Math.abs(f-g)<=l.EPSILON*Math.max(1,
Math.abs(f),Math.abs(g))&&Math.abs(d-n)<=l.EPSILON*Math.max(1,Math.abs(d),Math.abs(n))&&Math.abs(c-k)<=l.EPSILON*Math.max(1,Math.abs(c),Math.abs(k))&&Math.abs(e-q)<=l.EPSILON*Math.max(1,Math.abs(e),Math.abs(q))&&Math.abs(h-v)<=l.EPSILON*Math.max(1,Math.abs(h),Math.abs(v))&&Math.abs(a-b)<=l.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))};b.mul=k;b.sub=f})},"esri/symbols/support/previewSymbol3D":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/colorUtils ../../core/compilerUtils ../../core/Error ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/screenUtils ./gfxUtils ./IconSymbol3DLayerResource ./ObjectSymbol3DLayerResource ./previewUtils ./renderUtils ./styleUtils ./utils".split(" "),
function(g,b,l,k,f,a,q,m,d,c,e,h,p,n,u,x,v){function t(a){var b=a.outline,e=m.isSome(a.material)?a.material.color:null,e=m.isSome(e)?e.toRgba().toString():null;if(m.isNone(b))return"fill"===a.type&&"255,255,255,1"===e?{color:"#bdc3c7",width:.75}:null;a=c.pt2px(b.size)||0;return{color:"rgba("+(m.isSome(b.color)?b.color.toRgba():"255,255,255,1")+")",width:Math.min(a,80)}}function w(a,b){var c=b&&b.resource,c=c&&c.href;return a.thumbnail&&a.thumbnail.url?d.resolve(a.thumbnail.url):c&&"object"!==b.type?
d.resolve(v.getIconHref(a,b)):a.styleOrigin&&(a.styleOrigin.styleName||a.styleOrigin.styleUrl)?x.resolveWebStyleSymbol(a.styleOrigin,{portal:a.styleOrigin.portal},"webRef").catch(function(a){return a}).then(function(a){return a&&a.thumbnail&&a.thumbnail.url||K}):d.resolve(K)}function r(a,b){void 0===b&&(b=1);var c=a.a;a=k.toHSV(a);b=k.toRGB({h:a.h,s:a.s/b,v:100-(100-a.v)/b});return[b.r,b.g,b.b,c]}function y(a,b){return Math.round(Math.min(Math.max(a+191.25*b,0),255))}function A(a){return"water"===
a.type?m.isNone(a.color)?null:a.color:m.isNone(a.material)||m.isNone(a.material.color)?null:a.material.color}function z(a,b){void 0===b&&(b=0);a=A(a);if(!a)return b=y(e.defaultThematicColor.r,b),[b,b,b,100];a=a.toRgba();for(var c=0;3>c;c++)a[c]=y(a[c],b);return a}function B(a){return a.outline?t(a):{color:"rgba(0, 0, 0, 1)",width:1.5}}function C(a,b){a=A(a);if(!a)return null;var c;c="rgba("+(y(a.r,b)+",");c+=y(a.g,b)+",";c+=y(a.b,b)+",";return c+a.a+");"}function D(a,b){b=C(a,b);if(!b)return{};a=
Math.min(a.size?c.pt2px(a.size):.75,80);return{color:b,width:a}}function H(a,b,c){c*=.75;return{type:"linear",x1:c?.25*c:0,y1:c?.5*c:0,x2:c||4,y2:c?.5*c:4,colors:[{color:a,offset:0},{color:b,offset:1}]}}function F(a){var b=a.depth,c=a.height;return(a=a.width)&&b&&c&&a===b&&a<c}function E(a,b,c){var e=[];if(!a)return e;switch(a.type){case "icon":var d=a.resource&&a.resource.primitive||h.defaultPrimitive;switch(d){case "circle":e.push({shape:{type:"circle",cx:0,cy:0,r:.5*b},fill:z(a,0),stroke:t(a)});
break;case "square":e.push({shape:{type:"path",path:[{command:"M",values:[0,b]},{command:"L",values:[0,0]},{command:"L",values:[b,0]},{command:"L",values:[b,b]},{command:"Z",values:[]}]},fill:z(a,0),stroke:t(a)});break;case "triangle":e.push({shape:{type:"path",path:[{command:"M",values:[0,b]},{command:"L",values:[.5*b,0]},{command:"L",values:[b,b]},{command:"Z",values:[]}]},fill:z(a,0),stroke:t(a)});break;case "cross":e.push({shape:{type:"path",path:[{command:"M",values:[.5*b,0]},{command:"L",values:[.5*
b,b]},{command:"M",values:[0,.5*b]},{command:"L",values:[b,.5*b]}]},stroke:B(a)});break;case "x":e.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[b,b]},{command:"M",values:[b,0]},{command:"L",values:[0,b]}]},stroke:B(a)});break;case "kite":e.push({shape:{type:"path",path:[{command:"M",values:[0,.5*b]},{command:"L",values:[.5*b,0]},{command:"L",values:[b,.5*b]},{command:"L",values:[.5*b,b]},{command:"Z",values:[]}]},fill:z(a,0),stroke:t(a)});break;default:f.neverReached(d)}break;
case "object":switch(d=a.resource&&a.resource.primitive||p.defaultPrimitive,d){case "cone":d=z(a,0);a=z(a,-.6);a=H(d,a,c?20:b);b=n.getConeShapes(b,c);e.push({shape:b[0],fill:a});e.push({shape:b[1],fill:a});break;case "inverted-cone":c=z(a,0);a=z(a,-.6);a=H(c,a,b);b=n.getInvertedConeShapes(b);e.push({shape:b[0],fill:a});e.push({shape:b[1],fill:c});break;case "cube":b=n.getCubeShapes(b,c);e.push({shape:b[0],fill:z(a,0)});e.push({shape:b[1],fill:z(a,-.3)});e.push({shape:b[2],fill:z(a,-.5)});break;case "cylinder":var d=
z(a,0),g=z(a,-.6),d=H(d,g,c?20:b);b=n.getCylinderShapes(b,c);e.push({shape:b[0],fill:d});e.push({shape:b[1],fill:d});e.push({shape:b[2],fill:z(a,0)});break;case "diamond":b=n.getDiamondShapes(b);e.push({shape:b[0],fill:z(a,-.3)});e.push({shape:b[1],fill:z(a,0)});e.push({shape:b[2],fill:z(a,-.3)});e.push({shape:b[3],fill:z(a,-.7)});break;case "sphere":c=z(a,0);a=z(a,-.6);a=H(c,a);a.x1=0;a.y1=0;a.x2=.25*b;a.y2=.25*b;e.push({shape:{type:"circle",cx:0,cy:0,r:.5*b},fill:a});break;case "tetrahedron":b=
n.getTetrahedronShapes(b);e.push({shape:b[0],fill:z(a,-.3)});e.push({shape:b[1],fill:z(a,0)});e.push({shape:b[2],fill:z(a,-.6)});break;default:f.neverReached(d)}}return e}function G(a,b){var e=b&&b.size?c.pt2px(b.size):null,h=b&&b.maxSize?c.pt2px(b.maxSize):null,f=b&&b.disableUpsampling,n=a.symbolLayers,g=[],m=0,k=0,p=n.getItemAt(n.length-1),l;p&&"icon"===p.type&&(l=p.size&&c.pt2px(p.size));n.forEach(function(n){if("icon"===n.type||"object"===n.type){var p="icon"===n.type?n.size&&c.pt2px(n.size):
0,q=e||p?Math.ceil(Math.min(e||p,h||120)):22;if(n&&n.resource&&n.resource.href){var r=w(a,n).then(function(a){var b=n.get("material.color"),c;c="icon"===n.type?"multiply":"tint";return u.tintImageWithColor(a,q,b,c,f)}).then(function(a){var b=a.width,c=a.height;m=Math.max(m,b);k=Math.max(k,c);return[{shape:{type:"image",x:0,y:0,width:b,height:c,src:a.url},fill:null,stroke:null}]});g.push(r)}else r=q,"icon"===n.type&&l&&e&&(r=p/l*q),p=b&&"tall"===b.symbolConfig||("object"===n.type?F(n):!1),m=Math.max(m,
p?20:r),k=Math.max(k,r),g.push(d.resolve(E(n,r,p)))}});return d.eachAlways(g).then(function(a){var c=[];a.forEach(function(a){a.value?c.push(a.value):a.error&&I.warn("error while building swatchInfo!",a.error)});return u.renderSymbol(c,[m,k],{node:b&&b.node,scale:!1,opacity:b&&b.opacity})})}function J(a,b){var e=a.symbolLayers,h=[];a=v.isVolumetricSymbol(a);var f=b&&b.size?c.pt2px(b.size):null,g=(b&&b.maxSize?c.pt2px(b.maxSize):null)||80,m=0,p=0,k;e.forEach(function(a,b){if(a&&("line"===a.type||"path"===
a.type)){var c=[];switch(a.type){case "line":var e=D(a,0),d=e&&e.width||0;0===b&&(k=d);var q=Math.min(f||d,g);b=0===b?q:f?d/k*q:q;p=Math.max(p,b);m=Math.max(m,20<b?2*b:40);e.width=b;c.push({shape:{type:"path",path:[{command:"M",values:[0,.5*p]},{command:"L",values:[m,.5*p]}]},stroke:e});break;case "path":b=Math.min(f||22,g);d=z(a,0);q=z(a,-.2);e=(e=C(a,-.4))?{color:e,width:1}:{};if("quad"===a.profile){var r=a.width||a.size;a=a.height||a.size;a=n.getPathSymbolShapes(r&&a?r/a:1);e=l({},e,{join:"bevel"});
c.push({shape:a[0],fill:q,stroke:e});c.push({shape:a[1],fill:q,stroke:e});c.push({shape:a[2],fill:d,stroke:e})}else c.push({shape:n.shapes.pathSymbol3DLayer[0],fill:q,stroke:e}),c.push({shape:n.shapes.pathSymbol3DLayer[1],fill:d,stroke:e});m=p=Math.max(p,b)}h.push(c)}});return d.resolve(u.renderSymbol(h,[m,p],{node:b&&b.node,scale:a,opacity:b&&b.opacity}))}Object.defineProperty(b,"__esModule",{value:!0});var K=g.toUrl("../../images/Legend/legend3dsymboldefault.png"),I=q.getLogger("esri.symbols.support.previewSymbol3D");
b.getSymbolLayerFill=z;b.previewSymbol3D=function(b,e){if(0===b.symbolLayers.length)return d.reject(new a("symbolPreview: renderPreviewHTML3D","No symbolLayers in the symbol."));var h=null;switch(b.type){case "point-3d":h=G(b,e);break;case "line-3d":h=J(b,e);break;case "polygon-3d":case "mesh-3d":h="mesh-3d"===b.type;b=b.symbolLayers;for(var f=e&&e.size?c.pt2px(e.size):null,g=e&&e.maxSize?c.pt2px(e.maxSize):null,f=f||22,m=[],p=0,k=0,q=!1,x=0;x<b.length;x++){var v=b.getItemAt(x),w=[];if(!h||"fill"===
v.type){var y=n.shapes.fill[0];switch(v.type){case "fill":var B=t(v),C=Math.min(f,g||120),p=Math.max(p,C),k=Math.max(k,C),q=!0;w.push({shape:y,fill:z(v,0),stroke:B});break;case "line":y={stroke:D(v,0),shape:y};p=Math.max(p,22);k=Math.max(k,22);w.push(y);break;case "extrude":var B=l({join:"round"},D(v,-.4)),y=z(v,0),v=z(v,-.2),C=Math.min(f,g||120),F=n.getExtrudeSymbolShapes(C);B.width=1;w.push({shape:F[0],fill:v,stroke:B});w.push({shape:F[1],fill:v,stroke:B});w.push({shape:F[2],fill:y,stroke:B});y=
22*.7+.5*C;p=Math.max(p,22);k=Math.max(k,y);break;case "water":q=A(v),y=r(q),v=r(q,2),B=r(q,3),C=n.getWaterSymbolShapes(),q=!0,w.push({shape:C[0],fill:y}),w.push({shape:C[1],fill:v}),w.push({shape:C[2],fill:B}),C=Math.min(f,g||120),p=Math.max(p,C),k=Math.max(k,C)}m.push(w)}}h=d.resolve(u.renderSymbol(m,[p,k],{node:e&&e.node,scale:q,opacity:e&&e.opacity}))}return h?h:d.reject(new a("symbolPreview: swatchInfo3D","symbol not supported."))}})},"esri/symbols/support/utils":function(){define("require exports ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../Color ../../symbols ../../core/asyncUtils ../../core/compilerUtils ../../core/has ../../core/maybe ../../core/screenUtils ../../core/libs/gl-matrix-2/vec3f64 ./gfxUtils ./Symbol3DMaterial @dojo/framework/shim/Promise".split(" "),
function(g,b,l,k,f,a,q,m,d,c,e,h,p,n){function u(a,b){if(null==b)return a;a=a.toRgba();a[3]*=b;return new f(a)}function x(a,b,e){if(a=a.symbolLayers){var d=function(a){a=c.isSome(a)?a:null;b=b||a||null!=e&&B;return u(b,e)};a.forEach(function(a){if("object"!==a.type||null==a.resource.href||b)if("water"===a.type)a.color=d(a.color);else{var h=c.isSome(a.material)?a.material.color:null,h=d(h);c.isNone(a.material)?a.material=new n.default({color:h}):a.material.color=h;null!=e&&"outline"in a&&c.isSome(a.outline)&&
c.isSome(a.outline.color)&&(a.outline.color=u(a.outline.color,e))}})}}function v(a,b){return k(this,void 0,void 0,function(){var c,e=this;return l(this,function(d){switch(d.label){case 0:return(c=a.symbolLayers)?[4,q.forEach(c,function(a){return k(e,void 0,void 0,function(){return l(this,function(c){return[2,t(a,b)]})})})]:[2];case 1:return d.sent(),[2]}})})}function t(a,b){return k(this,void 0,void 0,function(){var c;return l(this,function(e){switch(e.label){case 0:c=a.type;switch(c){case "icon":return[3,
1];case "line":return[3,1];case "extrude":return[3,1];case "text":return[3,1];case "path":return[3,2];case "object":return[3,3];case "fill":return[3,5];case "water":return[3,5]}return[3,6];case 1:for(e=0;e<b.length;e++){var d=b[e];if("number"===typeof d){a.size=d;break}}return[3,7];case 2:return e=r(b,h.vec3f64.ONES,[a.width,void 0,a.height]),a.width=A(b[0],a.width,1,e),a.height=A(b[2],a.height,1,e),[3,7];case 3:return[4,w(a,b)];case 4:return e.sent(),[3,7];case 5:return[3,7];case 6:m.neverReached(a),
e.label=7;case 7:return[2]}})})}function w(a,b){return k(this,void 0,void 0,function(){var c,e,d,h;return l(this,function(f){switch(f.label){case 0:return[4,y(a)];case 1:return c=f.sent(),e=c.resourceSize,d=c.symbolSize,h=r(b,e,d),a.width=A(b[0],d[0],e[0],h),a.depth=A(b[1],d[1],e[1],h),a.height=A(b[2],d[2],e[2],h),[2]}})})}function r(a,b,c){for(var e=0;3>e;e++){var d=a[e];switch(d){case "symbol-value":return null!=c[e]?c[e]/b[e]:1;case "proportional":break;default:if(d&&b[e])return d/b[e]}}return 1}
function y(a){return k(this,void 0,void 0,function(){var b,c,e,d,h,f,n,m;return l(this,function(p){switch(p.label){case 0:return[4,new Promise(function(a,b){g(["./symbolLayerUtils"],a,b)})];case 1:return b=p.sent(),[4,b.computeObjectLayerResourceSize(a,10)];case 2:c=p.sent();e=a.width;d=a.height;h=a.depth;f=[e,h,d];n=1;for(m=0;3>m;m++)if(null!=f[m]){n=f[m]/c[m];break}for(m=0;3>m;m++)null==f[m]&&(f[m]=c[m]*n);return[2,{resourceSize:c,symbolSize:f}]}})})}function A(a,b,c,e){switch(a){case "proportional":return c*
e;case "symbol-value":return null!=b?b:c;default:return a}}Object.defineProperty(b,"__esModule",{value:!0});var z=/\/resource\/(.*?)\.svg$/,B=new f("white");b.getSymbolOutlineSize=function(b){if(!b)return 0;if(a.isSymbol3D(b)){var d=b.symbolLayers&&b.symbolLayers.length;d?(b=b.symbolLayers.getItemAt(d-1),b="outline"in b?c.get(b,"outline","size"):void 0):b=void 0;return c.isSome(b)?b:0}return(b=p.getStroke(b))&&e.px2pt(b.width)||0};b.isVolumetricSymbol=function(a){if(!a||!a.symbolLayers)return!1;switch(a.type){case "point-3d":return a.symbolLayers.some(function(a){return"object"===
a.type});case "line-3d":return a.symbolLayers.some(function(a){return"path"===a.type});case "polygon-3d":return a.symbolLayers.some(function(a){return"object"===a.type||"extrude"===a.type});default:return!1}};b.getIconHref=function(a,b){b=b.resource.href;return!d("esri-canvas-svg-support")&&a.styleOrigin&&z.test(b)?b.replace(z,"/resource/png/$1.png"):b};b.applyOpacityToColor=u;b.applyColorToSymbol=function(b,c,e){if(b&&(c||null!=e))if(c&&(c=new f(c)),a.isSymbol3D(b))x(b,c,e);else if(a.isSymbol2D(b)){if(c=
c||b.color)b.color=u(c,e);null!=e&&"outline"in b&&b.outline&&b.outline.color&&(b.outline.color=u(b.outline.color,e))}};b.applySizesToSymbol=function(b,c){return k(this,void 0,void 0,function(){return l(this,function(e){if(!b||!c)return[2];if(a.isSymbol3D(b))return[2,v(b,c)];if(a.isSymbol2D(b)&&(e=c[0],"number"===typeof e))switch(b.type){case "simple-marker":b.size=e;break;case "picture-marker":var d=b.width/b.height;1<d?(b.width=e,b.height=e*d):(b.width=e*d,b.height=e);break;case "simple-line":b.width=
e;break;case "text":b.font.size=e;break;case "simple-fill":case "picture-fill":break;case "cim":break;default:m.neverReached(b)}return[2]})})};b.applyRotationToSymbol=function(b,c,e){b&&null!=c&&(a.isSymbol3D(b)?(b=b.symbolLayers)&&b.forEach(function(a){if(a&&"object"===a.type)switch(e){case "tilt":a.tilt=c;break;case "roll":a.roll=c;break;default:a.heading=c}}):!a.isSymbol2D(b)||"simple-marker"!==b.type&&"picture-marker"!==b.type&&"text"!==b.type||(b.angle=c))}})},"esri/symbols/support/previewWebStyleSymbol":function(){define(["require",
"exports","../../request","../../core/screenUtils"],function(g,b,l,k){Object.defineProperty(b,"__esModule",{value:!0});b.previewWebStyleSymbol=function(b,a,g){var f=b.thumbnail&&b.thumbnail.url;return f?l(f,{responseType:"image"}).then(function(a){a=a.data;var b=!/\\.svg$/i.test(a.src)&&g&&g.disableUpsampling,e=Math.max(a.width,a.height),d=g&&null!=g.maxSize?k.pt2px(g.maxSize):120;b&&(d=Math.min(e,d));b=Math.min(d,g&&null!=g.size?k.pt2px(g.size):e);b!==e&&(e=0!==a.width&&0!==a.height?a.width/a.height:
1,1<=e?(a.width=b,a.height=b/e):(a.width=b*e,a.height=b));return g&&g.node?(g.node.appendChild(a),g.node):a}):b.fetchSymbol().then(function(b){return a(b,g)})}})},"esri/views/MapView":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/generatorHelper ../core/tsSupport/awaiterHelper ../core/Error ../core/has ../core/Logger ../core/promiseUtils ../core/screenUtils ../core/watchUtils ../core/workers ../core/accessorSupport/decorators ./BreakpointsOwner ./DOMContainer ./Magnifier ./MapViewBase ./2d/input/MapViewInputManager ./2d/support/HighlightOptions ./support/screenshotUtils ./support/WebGLRequirements ./ui/2d/DefaultUI2D @dojo/framework/shim/Promise".split(" "),
function(g,b,l,k,f,a,q,m,d,c,e,h,p,n,u,x,v,t,w,r,y,A,z){function B(){return a(this,void 0,void 0,function(){var a,b,c,e,d,h,n;return f(this,function(f){switch(f.label){case 0:return[4,Promise.all([new Promise(function(a,b){g(["./webgl"],a,b)}),new Promise(function(a,b){g(["./2d/mapViewDeps"],a,b)}),new Promise(function(a,b){g(["./2d/engine"],a,b)})])];case 1:return a=f.sent(),b=a[1],c=b.GraphicsView2D,e=b.LabelManager,d=b.MapViewNavigation,h=b.MagnifierView2D,n=a[2].Stage,F=c,E=e,G=d,J=h,H=n,[2]}})})}
function C(a){return!("layerViews"in a)&&null!=a.container}var D=d.getLogger("esri.views.MapView"),H,F,E,G,J;return function(a){function b(b){b=a.call(this,b)||this;b._magnifierView=null;b._stage=null;b._resolveWhenReady=[];b.graphicsView=null;b.highlightOptions=new r;b.magnifier=new v;b.inputManager=new w({view:b});b.mapViewNavigation=null;b.supersampleScreenhotsEnabled=!0;b.ui=new z;b.rendering=!1;p.initialize();return b}l(b,a);b.prototype.destroy=function(){this.inputManager.destroy();this._set("inputManager",
null)};Object.defineProperty(b.prototype,"background",{get:function(){return this.get("map.initialViewProperties.background")||null},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"navigating",{get:function(){return!(!this.mapViewNavigation||!this.mapViewNavigation.interacting)},enumerable:!0,configurable:!0});b.prototype.toMap=function(a){if(e.isSupportedScreenPointEvent(a)){var b=e.createScreenPointFromSupportedEvent(this,a);return this.inherited(arguments,[b])}return this.inherited(arguments)};
b.prototype.hitTest=function(a){var b=e.isSupportedScreenPointEvent(a)?e.createScreenPointFromSupportedEvent(this,a):a;if(!this.ready||isNaN(b.x)||isNaN(b.y))return c.resolve({screenPoint:b,results:[]});var d=this.toMap(b);a=[this.graphicsView];a.push.apply(a,this.allLayerViews.toArray().reverse());return c.all(a.map(function(a){return a&&a.hitTest?a.hitTest(b.x,b.y):null})).then(function(a){return{screenPoint:b,results:a.filter(function(a){return null!=a}).map(function(a){return{mapPoint:d,graphic:a}})}})};
b.prototype.takeScreenshot=function(a){return this.ready?this._stage.takeScreenshot(y.toRenderSettings(a,this),this.allLayerViews):c.reject("Map view cannot be used before it is ready")};b.prototype.on=function(a,b,c,e){var d=this.inputManager&&this.viewEvents.on(a,b,c,e);return d?d:this.inherited(arguments)};b.prototype.hasEventListener=function(a){return this.inherited(arguments)||this.viewEvents.hasHandler(a)};b.prototype.whenLayerView=function(a){return this.inherited(arguments)};b.prototype.graphicChanged=
function(a){this.graphicsView&&this.graphicsView.graphicUpdateHandler(a)};b.prototype.whenReady=function(){var a=this;return c.create(function(b){a.ready?b(a):a._resolveWhenReady.push(b)})};b.prototype.forceDOMReadyCycle=function(){this.forceReadyCycle()};b.prototype.validate=function(){var a=A.check({supportsMajorWebPerformanceCaveat:!0});m("safari")&&9>m("safari")&&(a=new q("mapview:browser-not-supported","This browser is not supported by MapView (Safari \x3c 9)",{type:"safari",requiredVersion:9,
detectedVersion:m("safari")}));return a?(D.warn("#validate()",a.message),c.reject(a)):B()};b.prototype._startup=function(){var a=this;this.timeline.begin("MapView Startup");this.inherited(arguments);this.graphics.owner=this;var b=new H(this.surface,{canvas:this.renderCanvas,supersampleScreenshots:this.supersampleScreenhotsEnabled,contextOptions:{deactivatedWebGLExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions},renderingOptions:this.renderingOptions,timeline:this.timeline}),
c=new F({view:this,graphics:this.graphics}),e=new G({view:this,animationManager:this.animationManager}),d=new E({view:this});this._magnifierView=new J;this._magnifierView.magnifier=this.magnifier;this._stage=b;this.frameTask.graphicsView=c;this._set("graphicsView",c);this._set("mapViewNavigation",e);this._set("labelManager",d);this.handles.add([this.allLayerViews.on("change",function(){return a._updateStageChildren()}),b.on("post-render",function(){return a._set("rendering",a.allLayerViews.some(function(a){return!("layerViews"in
a)&&!0===a.rendering}))}),b.on("webgl-error",function(b){return a.fatalError=b.error}),h.init(this,"stationary",function(a){return b.stationary=a},!0),h.init(this,"state.id",function(){return b.state=a.state},!0),h.init(this,"background",function(a){return b.background=a},!0),h.init(this,"magnifier",function(b){return a._magnifierView.magnifier=b},!0),h.init(this,"renderingOptions",function(a){return b.renderingOptions=a},!0),h.init(this,"highlightOptions",function(){return b.highlightOptions=a.highlightOptions},
!0)],"map-view");b.state=this.state;b.background=this.background;this._updateStageChildren();c=this._resolveWhenReady;this._resolveWhenReady=[];c.forEach(function(b){return b(a)});this.timeline.end("MapView Startup")};b.prototype._teardown=function(){this.handles.remove("map-view");this.layerViewManager.clear();this.labelManager.destroy();this._magnifierView.destroy();this._stage.destroy();this.graphicsView.destroy();this.mapViewNavigation.destroy();this._stage=null;this._set("graphicsView",null);
this._magnifierView=null;this._set("labelManager",null);this._set("mapViewNavigation",null);this.graphics.owner=null;this.inherited(arguments)};b.prototype._updateStageChildren=function(){var a=this;this._stage.removeAllChildren();this.allLayerViews.filter(C).forEach(function(b,c){a._stage.addChildAt(b.container,c)});this._stage.addChild(this.graphicsView.container);this._stage.addChild(this._magnifierView)};k([n.property({readOnly:!0,dependsOn:["map.initialViewProperties?.background"]})],b.prototype,
"background",null);k([n.property()],b.prototype,"graphicsView",void 0);k([n.property({type:r})],b.prototype,"highlightOptions",void 0);k([n.property({type:v})],b.prototype,"magnifier",void 0);k([n.property({readOnly:!0})],b.prototype,"inputManager",void 0);k([n.property({readOnly:!0})],b.prototype,"mapViewNavigation",void 0);k([n.property({dependsOn:["mapViewNavigation.interacting"],type:Boolean})],b.prototype,"navigating",null);k([n.property({type:Boolean,constructOnly:!0})],b.prototype,"supersampleScreenhotsEnabled",
void 0);k([n.property({type:z})],b.prototype,"ui",void 0);k([n.property({readOnly:!0})],b.prototype,"rendering",void 0);k([n.property({constructOnly:!0})],b.prototype,"renderCanvas",void 0);k([n.property({constructOnly:!0})],b.prototype,"deactivatedWebGLExtensions",void 0);k([n.property({constructOnly:!0})],b.prototype,"debugWebGLExtensions",void 0);return b=k([n.subclass("esri.views.MapView")],b)}(n.declared(u.BreakpointsOwner(x.DOMContainer(t))))})},"esri/views/BreakpointsOwner":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/assignHelper ../core/ArrayPool ../core/Handles ../core/watchUtils ../core/accessorSupport/decorators".split(" "),
function(g,b,l,k,f,a,q,m,d){function c(a,b){return b?e[a].valueToClassName[b].split(" "):[]}Object.defineProperty(b,"__esModule",{value:!0});var e={widthBreakpoint:{getValue:function(a){var b=a.viewSize[0];a=a.breakpoints;var c=this.values;return b<=a.xsmall?c.xsmall:b<=a.small?c.small:b<=a.medium?c.medium:b<=a.large?c.large:c.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",
small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",
xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue:function(a){var b=a.viewSize[1];a=a.breakpoints;var c=this.values;return b<=a.xsmall?c.xsmall:b<=a.small?c.small:b<=a.medium?c.medium:b<=a.large?c.large:c.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",
small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",
xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue:function(a){a=a.viewSize;var b=this.values;return a[1]>=a[0]?b.portrait:b.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},h={xsmall:544,small:768,medium:992,large:1200};b.BreakpointsOwner=
function(b){return function(b){function n(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];a=b.apply(this,a)||this;a._breakpointsHandles=new q;a.orientation=null;a.widthBreakpoint=null;a.heightBreakpoint=null;a.breakpoints=h;return a}l(n,b);n.prototype.initialize=function(){this._breakpointsHandles.add(m.init(this,["breakpoints","size"],this._updateClassNames))};n.prototype.destroy=function(){this.destroyed||(this._removeActiveClassNames(),this._breakpointsHandles.destroy(),this._breakpointsHandles=
null)};Object.defineProperty(n.prototype,"breakpoints",{set:function(a){var b=this._get("breakpoints");if(a!==b){b=(b=a)&&b.xsmall<b.small&&b.small<b.medium&&b.medium<b.large;if(!b){var c=JSON.stringify(h,null,2);console.warn("provided breakpoints are not valid, using defaults:"+c)}a=b?a:h;this._set("breakpoints",f({},a))}},enumerable:!0,configurable:!0});n.prototype._updateClassNames=function(){if(this.container){var b=a.acquire(),d=a.acquire(),h=!1,f;for(f in e){var n=this[f],g=e[f].getValue({viewSize:this.size,
breakpoints:this.breakpoints});n!==g&&(h=!0,this[f]=g,c(f,n).forEach(function(a){return d.push(a)}),c(f,g).forEach(function(a){return b.push(a)}))}h&&(this._applyClassNameChanges(b,d),a.release(b),a.release(d))}};n.prototype._applyClassNameChanges=function(a,b){var c=this.container;c&&(b.forEach(function(a){return c.classList.remove(a)}),a.forEach(function(a){return c.classList.add(a)}))};n.prototype._removeActiveClassNames=function(){var a=this.container;if(a)for(var b in e)c(b,this[b]).forEach(function(b){return a.classList.remove(b)})};
k([d.property()],n.prototype,"breakpoints",null);k([d.property()],n.prototype,"orientation",void 0);k([d.property()],n.prototype,"widthBreakpoint",void 0);k([d.property()],n.prototype,"heightBreakpoint",void 0);return n=k([d.subclass("esri.views.BreakpointsOwner")],n)}(d.declared(b))}})},"esri/views/Magnifier":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/Accessor ../core/accessorSupport/decorators".split(" "),function(g,b,l,k,f,
a){return function(b){function f(a){a=b.call(this,a)||this;a.factor=1.5;a.offsetX=0;a.offsetY=0;a.position=null;a.visible=!1;return a}l(f,b);Object.defineProperty(f.prototype,"version",{get:function(){return(this._get("version")||0)+1},enumerable:!0,configurable:!0});k([a.property({type:Number})],f.prototype,"factor",void 0);k([a.property({type:Number})],f.prototype,"offsetX",void 0);k([a.property({type:Number})],f.prototype,"offsetY",void 0);k([a.property()],f.prototype,"position",void 0);k([a.property({readOnly:!0,
dependsOn:["factor","offsetX","offsetY","position","visible"]})],f.prototype,"version",null);k([a.property({type:Boolean})],f.prototype,"visible",void 0);return f=k([a.subclass("esri.views.Magnifier")],f)}(a.declared(f))})},"esri/views/MapViewBase":function(){define("require exports ../core/tsSupport/assignHelper ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../geometry ../Viewpoint ../core/Error ../core/Logger ../core/now ../core/promiseUtils ../core/screenUtils ../core/watchUtils ../core/accessorSupport/decorators ../geometry/support/webMercatorUtils ../layers/support/TileInfo ./PopupView ./View ./ViewAnimation ./2d/AnimationManager ./2d/FrameTask ./2d/layerViewModuleImportUtils ./2d/MapViewConstraints ./2d/PaddedViewState ./2d/tiling ./2d/viewpointUtils ./2d/support/Timeline".split(" "),
function(g,b,l,k,f,a,q,m,d,c,e,h,p,n,u,x,v,t,w,r,y,A,z,B,C,D,H){var F=d.getLogger("esri.views.MapView");return function(b){function d(a){var e=b.call(this,a)||this;e._stationaryTimer=null;e.frameTask=new y.default(e);e.featuresTilingScheme=null;e.fullOpacity=1;e.initialExtent=null;e.labelManager=null;e.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0};e.resizeAlign="center";e.timeline=new H.Timeline;e.type="2d";e.constraints=new z;e.padding=
{top:0,right:0,bottom:0,left:0};var d=e.handles,h=function(){return e.notifyChange("updating")};d.add([e.watch("viewpoint",function(){e._lastStationaryEventTimestamp=c();e._flipStationary(160)},!0),e.on("resize",function(a){return e._resizeHandler(a)}),e.watch("animationManager.animation",function(a){e.animation=a}),e.allLayerViews.on("change",function(){h();d.remove("map-view-base-layerViewsUpdating");d.add(e.allLayerViews.map(function(a){return a.watch("updating",h)}),"map-view-base-layerViewsUpdating")})],
"map-view-base");return e}k(d,b);d.prototype.destroy=function(){this.destroyed||(this._set("preconditionsReady",!1),this._gotoTask=this.frameTask=null)};Object.defineProperty(d.prototype,"animation",{set:function(a){var b=this,c=this._get("animation");a!==c&&(c&&c.stop(),!a||a.isFulfilled()?this._set("animation",null):(this._set("animation",a),this.frameTask.animationInProgress=!0,c=function(){a===b._get("animation")&&(b._set("animation",null),b.frameTask.requestFrame());b.frameTask.animationInProgress=
!1},a.when(c,c)))},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"center",{get:function(){if(!this.ready)return this._get("center");var b=this.state.paddedViewState,c=b.center;return new a.Point({x:c[0],y:c[1],spatialReference:b.spatialReference})},set:function(a){if(null!=a)if(this._normalizeInput(a))if(this.ready){var b=this.viewpoint;D.centerAt(b,b,a);this.viewpoint=b}else this._set("center",a),this.notifyChange("initialExtentRequired");else F.error("#center","incompatible spatialReference "+
JSON.stringify(a.spatialReference)+" with view's spatialReference "+JSON.stringify(this.spatialReference))},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"constraints",{set:function(a){var b=this,c=this._get("constraints");c&&(this.handles.remove("map-view-base-constraints"),c.destroy());this._set("constraints",a);a&&(a.view=this,this.ready&&(this.state.viewpoint=a.fit(this.state.paddedViewState.viewpoint)),this.handles.add(a.on("update",function(){b.ready&&b.state&&(b.state.viewpoint=
a.fit(b.state.paddedViewState.viewpoint))}),"map-view-base-constraints"))},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"extent",{get:function(){return this.ready?this.state.paddedViewState.extent.clone():this._get("extent")},set:function(a){if(null!=a){var b=this._normalizeInput(a);b?b.width&&b.height?this.ready?(a=this.viewpoint,D.setExtent(a,a,b,this.size,{constraints:this.constraints}),this.viewpoint=a):(this._set("extent",b),this._set("center",null),this._set("viewpoint",
null),this._set("scale",0),this._set("zoom",-1),this.notifyChange("initialExtentRequired")):F.error("#extent","invalid extent size"):F.error("#center","incompatible spatialReference "+JSON.stringify(a.spatialReference)+" with view's spatialReference "+JSON.stringify(this.spatialReference))}},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"initialExtentRequired",{get:function(){var a=this.extent,b=this.center,c=this.scale,e=this.viewpoint,d=this.zoom;return this.get("map.initialViewProperties.viewpoint")||
a||b&&(0!==c||-1!==d)||e?!1:!0},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"padding",{get:function(){return this.ready?this.state.padding:this._get("padding")},set:function(a){this.ready?(this.state.padding=a,this._set("padding",this.state.padding)):this._set("padding",a)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"resolution",{get:function(){return this.state?this.state.resolution:0},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,
"rotation",{get:function(){return this.ready?this.state.rotation:this._get("rotation")},set:function(a){if(!isNaN(a))if(this.ready){var b=this.viewpoint;D.rotateTo(b,b,a);this.viewpoint=b}else this._set("rotation",a)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"scale",{get:function(){return this.ready?this.state.scale:this._get("scale")},set:function(a){if(a&&!isNaN(a))if(this.ready){var b=this.viewpoint;D.scaleTo(b,b,a);this.viewpoint=b}else{this._set("scale",a);this._set("zoom",
-1);if(a=this._get("extent"))this._set("extent",null),this._set("center",a.center);this.notifyChange("initialExtentRequired")}},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"stationary",{get:function(){return!this.animation&&!this.navigating&&!this._get("resizing")&&!this._stationaryTimer},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"updating",{get:function(){return!this.destroyed&&(!0===this.get("layerViewManager.updating")||!0===this.get("labelManager.updating")||
!0===this.get("graphicsView.updating")||this.allLayerViews.some(function(a){return!a.destroyed&&!("layerViews"in a)&&a.attached&&!0===a.updating}))},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"viewpoint",{get:function(){if(!this.ready)return this._get("viewpoint");var a=this.state.paddedViewState;return a&&a.viewpoint.clone()},set:function(b){if(null!=b){var c=this._normalizeInput(b);c?this.ready?(b=new q({targetGeometry:new a.Point,scale:0,rotation:0}),D.copy(b,c),this.constraints.constrain(b,
this.state.paddedViewState.viewpoint),this.state.viewpoint=b,this.frameTask.requestFrame(),this._set("viewpoint",b)):(this._set("viewpoint",c),this._set("extent",null),this._set("center",null),this._set("zoom",-1),this._set("scale",0),this.notifyChange("initialExtentRequired")):!b.scale||isNaN(b.scale)?F.error("#viewpoint","invalid scale value of "+b.scale):b.targetGeometry?F.error("#viewpoint","incompatible spatialReference "+JSON.stringify(b.targetGeometry.spatialReference)+" with view's spatialReference "+
JSON.stringify(this.spatialReference)):F.error("#viewpoint","geometry not defined")}},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"zoom",{get:function(){return this.ready?this.constraints.scaleToZoom(this.scale):this._get("zoom")},set:function(a){if(null!=a){if(!this.ready){this.notifyChange("initialExtentRequired");this._set("zoom",a);this._set("scale",0);var b=this._get("extent");b&&(this._set("extent",null),this._set("center",b.center))}this.constraints.effectiveLODs&&(b=
this.viewpoint,D.scaleTo(b,b,this.constraints.zoomToScale(a)),this.viewpoint=b,this._set("zoom",this.constraints.scaleToZoom(this.scale)))}},enumerable:!0,configurable:!0});d.prototype.goTo=function(a,b){var c=this;if(a)return p.whenTrueOnce(this,"ready",b&&b.signal).then(function(){c.animation&&(c.animation=null);var e=l({animate:!0},b),d=D.createAsync(a,c);c._gotoTask={};return e.animate?c._gotoAnimated(d,e):c._gotoImmediate(d,e)});F.error("#goTo()","target cannot be null or undefined")};d.prototype.hitTest=
function(a){return e.reject("Should be implemented by subclasses")};d.prototype.popupHitTest=function(a){var b=this;return this.hitTest(a).then(function(c){return l({},c,{mapPoint:b.toMap(a)})})};d.prototype.toMap=function(b){if(!this.ready)return null;b=this.state.toMap([0,0],[b.x,b.y]);return new a.Point({x:b[0],y:b[1],spatialReference:this.spatialReference})};d.prototype.isTileInfoRequired=function(){return!0};d.prototype.toScreen=function(a){if(!this.ready)return null;a=this._normalizeInput(a);
a=[a.x,a.y];a=this.state.toScreen(a,a);return h.createScreenPoint(a[0],a[1])};d.prototype.pixelSizeAt=function(){return this.ready?this.state.resolution:(F.error("#pixelSizeAt()","Map view cannot be used before it is ready"),null)};d.prototype.requestLayerViewUpdate=function(a){this.ready&&this.frameTask.requestLayerViewUpdate(a)};d.prototype.requestUpdate=function(a){this.ready&&this.frameTask.requestUpdate(a)};d.prototype.getDefaultSpatialReference=function(){return this.get("map.initialViewProperties.spatialReference")||
this.get("defaultsFromMap.spatialReference")||null};d.prototype.isSpatialReferenceSupported=function(a,b){return b||this._get("ready")?!0:null!==this._getDefaultViewpoint()};d.prototype.importLayerView=function(a){return A.layerView2DImporter.importLayerView(a)};d.prototype.hasLayerViewModule=function(a){return A.layerView2DImporter.hasLayerViewModule(a)};d.prototype._createOrReplaceAnimation=function(a){if(!this.animation||this.animation.done)this.animation=new w;this.animation.update(a);return this.animation};
d.prototype._cancellableGoTo=function(a,b,c){var d=this,h=c.then(function(){a===d._gotoTask&&(d.animation=null)}).catch(function(c){a===d._gotoTask&&(d.animation=null,b.done||(b.stop(),d.frameTask.animationInProgress=!1));throw c;}),f=e.create(function(a){return a(h)},function(){a!==d._gotoTask||b.done||(b.stop(),d.frameTask.animationInProgress=!1)});b.when().catch(function(){a===d._gotoTask&&f.cancel&&f.cancel()});return f};d.prototype._gotoImmediate=function(a,b){var c=this,d=this._gotoTask,h=this._createOrReplaceAnimation(a);
a=a.then(function(a){e.throwIfAborted(b);if(d!==c._gotoTask)throw new m("view:goto-interrupted","Goto was interrupted");c.viewpoint=h.target=a;h.finish()});return this._cancellableGoTo(d,h,a)};d.prototype._gotoAnimated=function(a,b){var c=this,e=this._gotoTask,d=this._createOrReplaceAnimation(a);a=a.then(function(a){if(e!==c._gotoTask)throw new m("view:goto-interrupted","Goto was interrupted");d.update(a);c.animationManager.animate(d,c.viewpoint,b);return d.when().then(function(){},function(){})});
return this._cancellableGoTo(e,d,a)};d.prototype._resizeHandler=function(a){var b=this.state;if(b){var c=this.state.paddedViewState.viewpoint,e=this.state.paddedViewState.size.concat();b.size=[a.width,a.height];D.resize(c,c,e,this.state.paddedViewState.size,this.resizeAlign);c=this.constraints.constrain(c,null);this.state.viewpoint=c}};d.prototype._startup=function(){var a=this._getDefaultViewpoint();this.constraints.view=this;this.constraints.fit(a);this._set("animationManager",new r.default({view:this}));
this._set("state",new B({padding:this._get("padding"),size:this.size,viewpoint:a}));this._set("featuresTilingScheme",new C.TileInfoView(x.create({spatialReference:this.spatialReference,size:512})));this._set("ready",!0);this.frameTask&&this.frameTask.start()};d.prototype._teardown=function(){this.frameTask&&this.frameTask.stop();this._set("ready",!1);this._stationaryTimer&&(clearTimeout(this._stationaryTimer),this._stationaryTimer=null);var b=this.state.paddedViewState,c=b.center,e=b.spatialReference,
d=b.rotation,b=b.scale,c=new a.Point({x:c[0],y:c[1],spatialReference:e});this._set("viewpoint",null);this._set("extent",null);this._set("center",c);this._set("zoom",-1);this._set("rotation",d);this._set("scale",b);this._set("spatialReference",e);this.constraints.view=null;this.animationManager.destroy();this._set("animationManager",null);this._set("state",null);this.animation=null};d.prototype._flipStationary=function(a){var b=this;return null!==this._stationaryTimer?this._stationaryTimer:this._stationaryTimer=
setTimeout(function(){b._stationaryTimer=null;var a=c()-b._lastStationaryEventTimestamp;160>a&&(b._stationaryTimer=b._flipStationary(a))},a)};d.prototype._normalizeInput=function(a,b){void 0===b&&(b=this.spatialReference);var c=a&&a.targetGeometry||a;return b?c?b.equals(c.spatialReference)?a:u.canProject(c,b)?a&&"esri.Viewpoint"===a.declaredClass?(a.targetGeometry=u.project(c,b),a):u.project(c,b):null:null:a};d.prototype._getDefaultViewpoint=function(){var a=this.constraints,b=this._get("zoom"),c=
this._get("scale"),e=this._normalizeInput(this._get("center")),d=this._normalizeInput(this._get("extent")),h=this._get("rotation"),f=this._normalizeInput(this._get("viewpoint"));a.effectiveLODs?-1!==b&&(c=a.zoomToScale(b)):b=-1;var n=null,g=null,b=0,a=f&&f.rotation,m=f&&f.targetGeometry;m&&("extent"===m.type?n=m:"point"===m.type&&(g=m,b=f.scale));f=this._normalizeInput(this.get("map.initialViewProperties.viewpoint.targetGeometry.extent"));m=this._normalizeInput(this.initialExtent);d=d||n||f||m;e=
e||g||d&&d.center;c=c||b||d&&D.extentToScale(d,this.size);return e&&c?new q({targetGeometry:e,scale:c,rotation:h||a||0}):null};f([n.property()],d.prototype,"_stationaryTimer",void 0);f([n.property()],d.prototype,"animation",null);f([n.property({readOnly:!0})],d.prototype,"animationManager",void 0);f([n.property({value:null,type:a.Point,dependsOn:["state.id","ready"]})],d.prototype,"center",null);f([n.property({type:z})],d.prototype,"constraints",null);f([n.property({value:null,type:a.Extent,dependsOn:["state.id",
"ready"]})],d.prototype,"extent",null);f([n.property({readOnly:!0})],d.prototype,"featuresTilingScheme",void 0);f([n.property()],d.prototype,"fullOpacity",void 0);f([n.property({type:a.Extent})],d.prototype,"initialExtent",void 0);f([n.property({dependsOn:["map.initialViewProperties?.viewpoint"]})],d.prototype,"initialExtentRequired",null);f([n.property()],d.prototype,"labelManager",void 0);f([n.property({value:{top:0,right:0,bottom:0,left:0},cast:function(a){return l({top:0,right:0,bottom:0,left:0},
a)}})],d.prototype,"padding",null);f([n.property({type:Object})],d.prototype,"renderingOptions",void 0);f([n.property()],d.prototype,"resizeAlign",void 0);f([n.property({readOnly:!0,dependsOn:["state.id"]})],d.prototype,"resolution",null);f([n.property({value:0,type:Number,dependsOn:["state.id","ready"]})],d.prototype,"rotation",null);f([n.property({value:0,type:Number,dependsOn:["state.id","ready"]})],d.prototype,"scale",null);f([n.property({type:a.SpatialReference,dependsOn:["map.initialViewProperties?.spatialReference",
"defaultsFromMap.isSpatialReferenceDone"]})],d.prototype,"spatialReference",void 0);f([n.property({readOnly:!0})],d.prototype,"state",void 0);f([n.property({dependsOn:["animation","navigating","resizing","_stationaryTimer"]})],d.prototype,"stationary",null);f([n.property({type:H.Timeline,readOnly:!0})],d.prototype,"timeline",void 0);f([n.property({readOnly:!0})],d.prototype,"type",void 0);f([n.property({readOnly:!0,dependsOn:["layerViewManager.updating","labelManager.updating","graphicsView?.updating"]})],
d.prototype,"updating",null);f([n.property({value:null,type:q,dependsOn:["state.id","ready"]})],d.prototype,"viewpoint",null);f([n.property({value:-1,dependsOn:["state.id"]})],d.prototype,"zoom",null);return d=f([n.subclass("esri.views.MapViewBase")],d)}(n.declared(v.PopupView(t)))})},"esri/layers/support/TileInfo":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../geometry ../../core/jsonMap ../../core/JSONSupport ../../core/unitUtils ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType ../../geometry/support/aaBoundingRect ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ./LOD".split(" "),
function(g,b,l,k,f,a,q,m,d,c,e,h,p,n,u){var x=new q.default({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});return function(b){function g(a){a=b.call(this,a)||this;a.dpi=96;a.format=null;a.origin=null;a.minScale=0;a.maxScale=0;a.size=null;a.spatialReference=null;return a}k(g,b);m=g;g.create=function(b){void 0===b&&(b=
{size:256,spatialReference:a.SpatialReference.WebMercator});var c=b.resolutionFactor||1,e=b.scales,h=b.size||256;b=b.spatialReference||a.SpatialReference.WebMercator;if(!p.isValid(b)){c=[];if(e)for(var f=0;f<e.length;f++){var n=e[f];c.push({level:f,scale:n,resolution:n})}else for(var g=5E-4,f=23;0<=f;f--)c.unshift({level:f,scale:g,resolution:g}),g*=2;return new m({dpi:96,lods:c,origin:new a.Point(0,0,b),size:[h,h],spatialReference:b})}var k=(f=p.getInfo(b))?new a.Point(f.origin[0],f.origin[1],b):
new a.Point(0,0,b),l=1/(39.37*d.getMetersPerUnitForSR(b)*96),q=[];if(e)for(f=0;f<e.length;f++)n=e[f],g=n*l,q.push({level:f,scale:n,resolution:g});else for(n=p.isGeographic(b)?512/h*5.916575275917094E8:256/h*5.91657527591555E8,e=Math.ceil(24/c),q.push({level:0,scale:n,resolution:n*l}),f=1;f<e;f++)n/=Math.pow(2,c),g=n*l,q.push({level:f,scale:n,resolution:g});return new m({dpi:96,lods:q,origin:k,size:[h,h],spatialReference:b})};Object.defineProperty(g.prototype,"isWrappable",{get:function(){var a=this.spatialReference,
b=this.origin;if(a&&b){var c=p.getInfo(a);return a.isWrappable&&Math.abs(c.origin[0]-b.x)<=c.dx}return!1},enumerable:!0,configurable:!0});g.prototype.readOrigin=function(b,c){return a.Point.fromJSON(l({spatialReference:c.spatialReference},b))};Object.defineProperty(g.prototype,"lods",{set:function(a){var b=this,c=0,e=0,d=[];this._levelToLOD={};a&&(c=-Infinity,e=Infinity,a.forEach(function(a){d.push(a.scale);c=a.scale>c?a.scale:c;e=a.scale<e?a.scale:e;b._levelToLOD[a.level]=a}));this._set("scales",
d);this._set("minScale",c);this._set("maxScale",e);this._set("lods",a);this._initializeUpsampleLevels()},enumerable:!0,configurable:!0});g.prototype.readSize=function(a,b){return[b.cols,b.rows]};g.prototype.writeSize=function(a,b){b.cols=a[0];b.rows=a[0]};g.prototype.zoomToScale=function(a){var b=this.scales;if(0>=a)return b[0];if(a>=b.length)return b[b.length-1];var c=Math.round(a);return b[c]+(c-a)*(b[Math.round(a-.5)]-b[c])};g.prototype.scaleToZoom=function(a){for(var b=this.scales,c=b.length-
1,e=0;e<c;e++){var d=b[e],h=b[e+1];if(d<=a)break;if(h===a)return e+1;if(d>a&&h<a)return e+1-(a-h)/(d-h)}return e};g.prototype.snapScale=function(a,b){void 0===b&&(b=.95);a=this.scaleToZoom(a);return a%Math.floor(a)>=b?this.zoomToScale(Math.ceil(a)):this.zoomToScale(Math.floor(a))};g.prototype.tileAt=function(a,b,c,e){var d=this.lodAt(a);if(!d)return null;var f;if("number"===typeof b)f=b,b=c;else{if(p.equals(b.spatialReference,this.spatialReference))f=b.x,b=b.y;else{e=n.project(b,this.spatialReference);
if(!e)return null;f=e.x;b=e.y}e=c}c=d.resolution*this.size[0];d=d.resolution*this.size[1];e||(e={id:null,level:0,row:0,col:0,extent:h.create()});e.level=a;e.row=Math.floor((this.origin.y-b)/d+.001);e.col=Math.floor((f-this.origin.x)/c+.001);this.updateTileInfo(e);return e};g.prototype.updateTileInfo=function(a){var b=this.lodAt(a.level);if(b){var c=b.resolution*this.size[0],b=b.resolution*this.size[1];a.id=a.level+"/"+a.row+"/"+a.col;a.extent||(a.extent=h.create());a.extent[0]=this.origin.x+a.col*
c;a.extent[1]=this.origin.y-(a.row+1)*b;a.extent[2]=a.extent[0]+c;a.extent[3]=a.extent[1]+b}};g.prototype.upsampleTile=function(a){var b=this._upsampleLevels[a.level];if(!b||-1===b.parentLevel)return!1;a.level=b.parentLevel;a.row=Math.floor(a.row/b.factor+.001);a.col=Math.floor(a.col/b.factor+.001);this.updateTileInfo(a);return!0};g.prototype.getTileBounds=function(a,b){var c=this.lodAt(b.level).resolution,e=c*this.size[0],c=c*this.size[1];a[0]=this.origin.x+b.col*e;a[1]=this.origin.y-(b.row+1)*c;
a[2]=a[0]+e;a[3]=a[1]+c;return a};g.prototype.lodAt=function(a){return this._levelToLOD&&this._levelToLOD[a]||null};g.prototype.clone=function(){return m.fromJSON(this.write({}))};g.prototype._initializeUpsampleLevels=function(){var a=this.lods;this._upsampleLevels=[];for(var b=null,c=0;c<a.length;c++){var e=a[c];this._upsampleLevels[e.level]={parentLevel:b?b.level:-1,factor:b?b.resolution/e.resolution:0};b=e}};var m;f([c.property({type:Number,json:{write:!0}})],g.prototype,"compressionQuality",void 0);
f([c.property({type:Number,json:{write:!0}})],g.prototype,"dpi",void 0);f([c.property({type:String,json:{read:x.read,write:x.write,origins:{"web-scene":{read:!1,write:!1}}}})],g.prototype,"format",void 0);f([c.property({readOnly:!0,dependsOn:["spatialReference","origin"]})],g.prototype,"isWrappable",null);f([c.property({type:a.Point,json:{write:!0}})],g.prototype,"origin",void 0);f([c.reader("origin")],g.prototype,"readOrigin",null);f([c.property({type:[u],value:null,json:{write:!0}})],g.prototype,
"lods",null);f([c.property({readOnly:!0})],g.prototype,"minScale",void 0);f([c.property({readOnly:!0})],g.prototype,"maxScale",void 0);f([c.property({readOnly:!0})],g.prototype,"scales",void 0);f([c.property({cast:function(a){return Array.isArray(a)?a:"number"===typeof a?[a,a]:[256,256]}})],g.prototype,"size",void 0);f([c.reader("size",["rows","cols"])],g.prototype,"readSize",null);f([c.writer("size",{cols:{type:e.Integer},rows:{type:e.Integer}})],g.prototype,"writeSize",null);f([c.property({type:a.SpatialReference,
json:{write:!0}})],g.prototype,"spatialReference",void 0);return g=m=f([c.subclass("esri.layers.support.TileInfo")],g)}(c.declared(m.JSONSupport))})},"esri/layers/support/LOD":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType".split(" "),function(g,b,l,k,f,a,q){return function(b){function d(a){a=b.call(this,a)||this;a.level=0;a.levelValue=
null;a.resolution=0;a.scale=0;return a}l(d,b);c=d;d.prototype.clone=function(){return new c({level:this.level,levelValue:this.levelValue,resolution:this.resolution,scale:this.scale})};var c;k([a.property({type:q.Integer,json:{write:!0}})],d.prototype,"level",void 0);k([a.property({type:String,json:{write:!0}})],d.prototype,"levelValue",void 0);k([a.property({type:Number,json:{write:!0}})],d.prototype,"resolution",void 0);k([a.property({type:Number,json:{write:!0}})],d.prototype,"scale",void 0);return d=
c=k([a.subclass("esri.layers.support.LOD")],d)}(a.declared(f.JSONSupport))})},"esri/views/PopupView":function(){define("require exports ../core/tsSupport/assignHelper ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/awaiterHelper ../core/tsSupport/generatorHelper ../core/arrayUtils ../core/maybe ../core/promiseUtils ../core/accessorSupport/decorators".split(" "),function(g,b,l,k,f,a,q,m,d,c,e){Object.defineProperty(b,"__esModule",{value:!0});b.PopupView=function(b){return function(b){function h(){return null!==
b&&b.apply(this,arguments)||this}k(h,b);h.prototype.fetchPopupFeatures=function(a,b){return this._fetchPopupFeaturesAsync(a,b)};h.prototype._fetchPopupFeaturesAsync=function(b,e){return a(this,void 0,void 0,function(){var a,d,h,f,n,g,k,p,l;return q(this,function(q){switch(q.label){case 0:return[4,this.when()];case 1:return q.sent(),[4,this._prepareFetchPopupFeatures(b,e)];case 2:return a=q.sent(),d=a.location,h=a.queryArea,f=a.layerViewsAndGraphics,n=a.clientOnlyGraphics,g=c.resolve(n),k=this._queryLayerPopupFeatures({queryArea:h,
layerViewsAndGraphics:f,options:e}),p=k.map(function(a){return a.promise}),l=c.eachAlwaysValues([g].concat(p)).then(m.flatten),[2,{location:d,clientOnlyGraphics:n,allGraphicsPromise:l,promisesPerLayerView:k}]}})})};h.prototype._queryLayerPopupFeatures=function(a){var b=a.queryArea,c=a.options;return a.layerViewsAndGraphics.map(function(a){var e=a.layerView;a={clientGraphics:a.graphics,event:d.isSome(c)?c.event:null,signal:d.isSome(c)?c.signal:null,defaultPopupTemplateEnabled:d.isSome(c)?!!c.defaultPopupTemplateEnabled:
!1};a=e.fetchPopupFeatures(b,a);return{layerView:e,promise:a}})};h.prototype._isValidPopupGraphic=function(a,b){return a&&!!a.getEffectivePopupTemplate(d.isSome(b)&&b.defaultPopupTemplateEnabled)};h.prototype._prepareFetchPopupFeatures=function(b,c){return a(this,void 0,void 0,function(){var a,e,d,h,f,n,g,m;return q(this,function(k){switch(k.label){case 0:return[4,this._popupHitTestGraphics(b,c)];case 1:return a=k.sent(),e=a.clientGraphics,d=a.queryArea,h=a.location,f=this._getFetchPopupLayerViews(),
n=this._graphicsPerFetchPopupLayerView(e,f),g=n.layerViewsAndGraphics,m=n.clientOnlyGraphics,[2,{clientOnlyGraphics:m,layerViewsAndGraphics:g,queryArea:d,location:h}]}})})};h.prototype._popupHitTestGraphics=function(b,c){return a(this,void 0,void 0,function(){var a,e,d,h,f,n,g=this;return q(this,function(m){switch(m.label){case 0:return[4,this.popupHitTest(b)];case 1:return a=m.sent(),e=a.results,d=a.mapPoint,h=e.filter(function(a){return g._isValidPopupGraphic(a.graphic,c)}),f=h.length?h[0].mapPoint:
null,n=h.map(function(a){return a.graphic}),[2,{clientGraphics:n,queryArea:d,location:d||f}]}})})};h.prototype._getFetchPopupLayerViews=function(){var a=this,b=[];this.allLayerViews.forEach(function(c){a._isValidPopupLayerView(c)&&b.push(c)});d.isSome(this.graphicsView)&&this._isValidPopupLayerView(this.graphicsView)&&b.push(this.graphicsView);return b.reverse()};h.prototype._isValidPopupLayerView=function(a){return d.isSome(a)&&(!("layer"in a)||!a.suspended)&&"fetchPopupFeatures"in a};h.prototype._graphicsPerFetchPopupLayerView=
function(a,b){var c=[],e=new Map;b=b.map(function(a){var b=[];"layer"in a?e.set(a.layer,b):e.set(a.graphics,b);return{layerView:a,graphics:b}});for(var d=0;d<a.length;d++){var h=a[d],f=e.get(h.layer)||null;f?f.push(h):c.push(h)}return{layerViewsAndGraphics:b,clientOnlyGraphics:c}};return h=f([e.subclass("esri.views.PopupView")],h)}(e.declared(b))}})},"esri/views/2d/AnimationManager":function(){define("require exports ../../core/tsSupport/decorateHelper ../../core/tsSupport/declareExtendsHelper ../../geometry ../../Viewpoint ../../core/Accessor ../../core/scheduling ../../core/accessorSupport/decorators ../ViewAnimation ./unitBezier ./viewpointUtils".split(" "),
function(g,b,l,k,f,a,q,m,d,c,e,h){Object.defineProperty(b,"__esModule",{value:!0});var p=function(){function a(a,b,c,d){var h=a.targetGeometry,f=b.targetGeometry;d?"string"===typeof d&&(d=e.parse(d)||e.easingFunctions.ease):d=e.easingFunctions.ease;this.easing=d;this.duration=c;this.sCenterX=h.x;this.sCenterY=h.y;this.sScale=a.scale;this.sRotation=a.rotation;this.tCenterX=f.x;this.tCenterY=f.y;this.tScale=b.scale;this.tRotation=b.rotation;this.dCenterX=this.tCenterX-this.sCenterX;this.dCenterY=this.tCenterY-
this.sCenterY;this.dScale=this.tScale-this.sScale;this.dRotation=this.tRotation-this.sRotation;180<this.dRotation?this.dRotation-=360:-180>this.dRotation&&(this.dRotation+=360)}a.prototype.applyRatio=function(a,b){var c=this.easing(b),e,d;1<=b?(b=this.tCenterX,e=this.tCenterY,d=this.tRotation,c=this.tScale):(b=this.sCenterX+c*this.dCenterX,e=this.sCenterY+c*this.dCenterY,d=this.sRotation+c*this.dRotation,c=this.sScale+c*this.dScale);a.targetGeometry.x=b;a.targetGeometry.y=e;a.scale=c;a.rotation=d};
return a}();g=function(b){function n(c){c=b.call(this,c)||this;c.duration=200;c.transition=null;c.easing=e.easingFunctions.ease;c.view=null;c.viewpoint=null;c.viewpoint=new a({targetGeometry:new f.Point,scale:0,rotation:0});c._updateTask=m.addFrameTask({postRender:c._postRender.bind(c)});c._updateTask.pause();return c}k(n,b);n.prototype.destroy=function(){this._updateTask.remove();this._updateTask=null};n.prototype.animate=function(a,b,c){var e=this;this.stop();h.copy(this.viewpoint,b);this.transition=
new p(this.viewpoint,a.target,c&&c.duration||this.duration,c&&c.easing||this.easing);b=function(){e.animation===a&&e._updateTask&&("finished"===a.state&&(e.transition.applyRatio(e.viewpoint,1),e.view.state&&(e.view.state.viewpoint=e.viewpoint.clone())),e.animation=null,e.updateFunction=null)};a.when(b,b);this._startTime=m.now();this._updateTask.resume();return this.animation=a};n.prototype.animateContinous=function(a,b){var e=this;this.stop();this.updateFunction=b;this.viewpoint=a;var d=new c({target:a.clone()});
a=function(){e.animation===d&&e._updateTask&&(e.animation=null,e.updateFunction=null)};d.when(a,a);this._startTime=m.now();this._updateTask.resume();return this.animation=d};n.prototype.stop=function(){this.animation&&(this.animation.stop(),this.updateFunction=this.animation=null)};n.prototype._postRender=function(a){var b=this.animation;b&&b.state!==c.State.STOPPED?(this.updateFunction?this.updateFunction(this.viewpoint,a.deltaTime):(a=(m.now()-this._startTime)/this.transition.duration,b=1<=a,this.transition.applyRatio(this.viewpoint,
a),b&&this.animation.finish()),this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())):this._updateTask.pause()};l([d.property()],n.prototype,"animation",void 0);l([d.property()],n.prototype,"duration",void 0);l([d.property()],n.prototype,"transition",void 0);l([d.property()],n.prototype,"easing",void 0);l([d.property()],n.prototype,"view",void 0);l([d.property()],n.prototype,"viewpoint",void 0);return n=l([d.subclass("esri.views.2d.AnimationManager")],n)}(d.declared(q));b.default=g})},
"esri/views/2d/unitBezier":function(){define(["require","exports"],function(g,b){function l(b,a,g,m){function d(a,b){var d,f,n,g;n=a;for(f=0;8>f;f++){g=((h*n+e)*n+c)*n-a;if(Math.abs(g)<b)return n;d=(3*h*n+2*e)*n+c;if(1E-6>Math.abs(d))break;n-=g/d}d=0;f=1;n=a;if(n<d)return d;if(n>f)return f;for(;d<f;){g=((h*n+e)*n+c)*n;if(Math.abs(g-a)<b)break;a>g?d=n:f=n;n=.5*(f-d)+d}return n}var c=3*b,e=3*(g-b)-c,h=1-c-e,f=3*a,n=3*(m-a)-f,k=1-f-n;return function(a,b){void 0===b&&(b=1E-6);a=d(a,b);return((k*a+n)*
a+f)*a}}Object.defineProperty(b,"__esModule",{value:!0});b.unitBezier=l;var k=/^cubic-bezier\((.*)\)/;b.easingFunctions={};b.parse=function(f){var a=b.easingFunctions[f]||null;!a&&(f=k.exec(f))&&(f=f[1].split(",").map(function(a){return parseFloat(a.trim())}),4!==f.length||f.some(function(a){return isNaN(a)})||(a=l.apply(l,f)));return a};b.easingFunctions.ease=l(.25,.1,.25,1);b.easingFunctions.linear=l(0,0,1,1);b.easingFunctions.easeIn=b.easingFunctions["ease-in"]=l(.42,0,1,1);b.easingFunctions.easeOut=
b.easingFunctions["ease-out"]=l(0,0,.58,1);b.easingFunctions.easeInOut=b.easingFunctions["ease-in-out"]=l(.42,0,.58,1)})},"esri/views/2d/viewpointUtils":function(){define("require exports ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../Viewpoint ../../core/Collection ../../core/maybe ../../core/promiseUtils ../../core/unitUtils ../../core/wgs84Constants ../../core/libs/gl-matrix-2/common ../../core/libs/gl-matrix-2/mat2d ../../core/libs/gl-matrix-2/mat2df64 ../../core/libs/gl-matrix-2/vec2 ../../core/libs/gl-matrix-2/vec2f64 ../../geometry/Extent ../../geometry/Geometry ../../geometry/Point ../../geometry/SpatialReference ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ../../geometry/support/webMercatorUtils".split(" "),
function(g,b,l,k,f,a,q,m,d,c,e,h,p,n,u,x,v,t,w,r,y,A){function z(a,b,c,d){return d&&c&&!d.equals(c)&&y.canProject(d,c)&&d.isWebMercator?(d.isWebMercator?(c=b[1],89.99999<c?c=89.99999:-89.99999>c&&(c=-89.99999),c=Math.sin(e.common.toRadian(c)),a=n.vec2.set(a,e.common.toRadian(b[0])*O,.5*O*Math.log((1+c)/(1-c)))):(c=e.common.toDegree(b[0]/O),a=n.vec2.set(a,c-360*Math.floor((c+180)/360),e.common.toDegree(.5*Math.PI-2*Math.atan(Math.exp(-1*b[1]/O))))),a):n.vec2.copy(a,b)}function B(a){return a.wkid?a:
a.spatialReference||w.WGS84}function C(a,b){return b.type?n.vec2.set(a,b.x,b.y):n.vec2.copy(a,b)}function D(a,b){return Math.max(a.width/b[0],a.height/b[1])*L(a.spatialReference)}function H(b,c,e,d){return k(this,void 0,void 0,function(){var h,f,n,g,k,p,r,u,w,A,B,z,C,D,F,E,U,G,T,P,J,R,K,I,L,N,M,O;return l(this,function(l){switch(l.label){case 0:if(!b||Array.isArray(b)&&!b.length)return[2,null];a.isCollection(b)&&(b=b.toArray());if(!Array.isArray(b)||!b.length||"object"!==typeof b[0])return[3,7];f=
b.every(function(a){return"attributes"in a});n=b.some(function(a){return!a.geometry});g=b;if(!(f&&n&&c&&c.allLayerViews))return[3,2];k=new Map;p=0;for(r=b;p<r.length;p++)u=r[p],w=u.layer,A=k.get(w)||[],B=u.attributes[w.objectIdField],null!=B&&A.push(B),k.set(w,A);z=[];k.forEach(function(a,b){var e=c.allLayerViews.find(function(a){return a.layer.id===b.id});if("queryFeatures"in e){var d=b.createQuery();d.objectIds=a;d.returnGeometry=!0;z.push(e.queryFeatures(d))}});return[4,m.all(z)];case 1:C=l.sent();
D=[];F=0;for(E=C;F<E.length;F++)if((U=E[F])&&U.features&&U.features.length)for(G=0,T=U.features;G<T.length;G++)u=T[G],q.isSome(u.geometry)&&D.push(u.geometry);g=D;l.label=2;case 2:P=0,J=g,l.label=3;case 3:if(!(P<J.length))return[3,6];R=J[P];return[4,H(R,c,e,d)];case 4:d=l.sent(),l.label=5;case 5:return P++,[3,3];case 6:return[2,d];case 7:if(!Array.isArray(b)||2!==b.length||"number"!==typeof b[0]||"number"!==typeof b[1])return[3,8];h=new t(b);return[3,12];case 8:if(!(b instanceof v))return[3,9];h=
b;return[3,12];case 9:if(!("geometry"in b))return[3,12];if(!b.geometry)return[3,10];h=b.geometry;return[3,12];case 10:if(!b.layer)return[3,12];K=b.layer;I=c.allLayerViews.find(function(a){return a.layer.id===K.id});if(!("queryFeatures"in I))return[3,12];L=K.createQuery();L.objectIds=[b.attributes[K.objectIdField]];L.returnGeometry=!0;return[4,I.queryFeatures(L)];case 11:N=l.sent(),h=q.get(N,"features",0,"geometry"),l.label=12;case 12:if(q.isNone(h))return[2,null];M="point"===h.type?new x({xmin:h.x,
ymin:h.y,xmax:h.x,ymax:h.y,spatialReference:h.spatialReference}):h.extent;if(!M)return[2,null];O=y.canProject(M,e);if(!M.spatialReference.equals(e)&&O)M=y.project(M,e);else if(!O)return[2,null];d=d?d.union(M):M.clone();return[2,d]}})})}function F(a){if(a&&(!Array.isArray(a)||"number"!==typeof a[0])&&("object"===typeof a||Array.isArray(a)&&"object"===typeof a[0])){if("layer"in a&&a.layer&&a.layer.minScale&&a.layer.maxScale){var b=a.layer;return{min:b.minScale,max:b.maxScale}}if(Array.isArray(a)&&a.length&&
a.every(function(a){return"layer"in a})){for(var c=0,e=0,d=0;d<a.length;d++)(b=a[d].layer)&&b.minScale&&b.maxScale&&(c=b.minScale<c?b.minScale:c,e=b.maxScale>e?b.maxScale:e);return c&&e?{min:c,max:e}:null}}}function E(a,b){return k(this,void 0,void 0,function(){var c,e,d,h,n,g,m,k,p,q,r,v,w,E,G,U,J,K,T,I;return l(this,function(l){switch(l.label){case 0:if(!a||!b)return[2,new f({targetGeometry:new t,scale:0,rotation:0})];c=b.spatialReference;e=b.constraints;d=b.padding;h=b.viewpoint;n=b.size;g=d?n[0]-
d.left-d.right:n[0];m=d?n[1]-d.top-d.bottom:n[1];k=[g,m];p=null;a instanceof f?p=a:a.viewpoint?p=a.viewpoint:a.target&&"esri.Viewpoint"===a.target.declaredClass&&(p=a.target);q=null;if(!p||!p.targetGeometry)return[3,1];q=p.targetGeometry;return[3,10];case 1:if(!(a instanceof x))return[3,2];q=a;return[3,10];case 2:return a||a&&("center"in a||"extent"in a||"target"in a)?[4,H(a.center,b,c)]:[3,10];case 3:return(w=l.sent())?[3,5]:[4,H(a.extent,b,c)];case 4:w=l.sent(),l.label=5;case 5:return(v=w)?[3,7]:
[4,H(a.target,b,c)];case 6:v=l.sent(),l.label=7;case 7:return(r=v)?[3,9]:[4,H(a,b,c)];case 8:r=l.sent(),l.label=9;case 9:q=r,l.label=10;case 10:!q&&h&&h.targetGeometry?q=h.targetGeometry:!q&&b.extent&&(q=b.extent);E=B(q);c||(c=B(b.spatialReference||b.extent||q));if(!A.canProject(q,c)&&E&&!E.equals(c))return[2,null];G=C(u.vec2f64.create(),q.center?q.center:q);U=new t(z(G,G,E,c),c);J=null;J=p&&p.targetGeometry&&"point"===p.targetGeometry.type?p.scale:a.hasOwnProperty("scale")&&a.scale?a.scale:a.hasOwnProperty("zoom")&&
-1!==a.zoom&&e&&e.effectiveLODs?e.zoomToScale(a.zoom):Array.isArray(q)||"point"===q.type||"extent"===q.type&&0===q.width&&0===q.height?b.extent&&y.canProject(b.extent,c)?D(y.project(b.extent,c),k):b.extent?D(b.extent,k):h.scale:y.canProject(q.extent,c)?D(y.project(q.extent,c),k):D(q.extent,k);if(K=F(a))K.min&&K.min>J?J=K.min:K.max&&K.max<J&&(J=K.max);T=0;p?T=p.rotation:a.hasOwnProperty("rotation")?T=a.rotation:h&&(T=h.rotation);I=new f({targetGeometry:U,scale:J,rotation:T});e&&(I=e.fit(I),e.rotationEnabled||
(I.rotation=T));return[2,I]}})})}function G(a,b){var c=a.targetGeometry,e=b.targetGeometry;c.x=e.x;c.y=e.y;c.spatialReference=e.spatialReference;a.scale=b.scale;a.rotation=b.rotation;return a}function J(a,b,c){return c?n.vec2.set(a,.5*(b[0]-c.right+c.left),.5*(b[1]-c.bottom+c.top)):n.vec2.scale(a,b,.5)}function K(a,c,e,d){b.getTransform(a,c,e,d);return h.mat2d.invert(a,a)}function I(a,b,c){var e=M(b);b=Math.abs(Math.cos(e));e=Math.abs(Math.sin(e));return n.vec2.set(a,Math.round(c[1]*e+c[0]*b),Math.round(c[1]*
b+c[0]*e))}function N(a){var b=a.scale;a=a.targetGeometry.spatialReference;a=r.isValid(a)?1/(39.37*d.getMetersPerUnitForSR(a)*96):1;return b*a}function M(a){return e.common.toRadian(a.rotation)||0}function L(a){return r.isValid(a)?39.37*d.getMetersPerUnitForSR(a)*96:1}function Q(a){return a.isWrappable?(a=r.getInfo(a),a.valid[1]-a.valid[0]):0}Object.defineProperty(b,"__esModule",{value:!0});var O=c.wgs84Radius,S=180/Math.PI;b.extentToScale=D;b.create=E;b.copy=G;b.getAnchor=J;b.getExtent=function(){var a=
u.vec2f64.create();return function(b,c,e){var d=c.targetGeometry;C(a,d);c=.5*N(c);b.xmin=a[0]-c*e[0];b.ymin=a[1]-c*e[1];b.xmax=a[0]+c*e[0];b.ymax=a[1]+c*e[1];b.spatialReference=d.spatialReference;return b}}();b.setExtent=function(a,c,e,d,h){b.centerAt(a,c,e.center);a.scale=D(e,d);h&&h.constraints&&h.constraints.constrain(a);return a};b.getOuterExtent=function(){var a=u.vec2f64.create(),b=u.vec2f64.create();return function(c,e,d){C(a,e.targetGeometry);I(b,e,d);d=.5*N(e);c.set({xmin:a[0]-d*b[0],ymin:a[1]-
d*b[1],xmax:a[0]+d*b[0],ymax:a[1]+d*b[1],spatialReference:e.targetGeometry.spatialReference});return c}}();b.getOuterSize=I;b.getPaddingScreenTranslation=function(){var a=u.vec2f64.create();return function(b,c,e){return n.vec2.sub(b,n.vec2.scale(b,c,.5),J(a,c,e))}}();b.getPaddingMapTranslation=function(){var a=p.mat2df64.create(),c=u.vec2f64.create();return function(e,d,f,g){var m=N(d);d=M(d);n.vec2.set(c,m,m);h.mat2d.fromScaling(a,c);h.mat2d.rotate(a,a,d);h.mat2d.translate(a,a,b.getPaddingScreenTranslation(c,
f,g));h.mat2d.translate(a,a,[0,g.top-g.bottom]);return n.vec2.set(e,a[4],a[5])}}();b.getResolution=N;b.getResolutionToScaleFactor=L;b.getMatrix=function(){var a=u.vec2f64.create(),b=u.vec2f64.create(),c=u.vec2f64.create();return function(e,d,f,g,m,k){n.vec2.negate(a,d);n.vec2.scale(b,f,.5*k);n.vec2.set(c,1/g*k,-1/g*k);h.mat2d.identity(e);h.mat2d.translate(e,e,b);m&&h.mat2d.rotate(e,e,m);h.mat2d.scale(e,e,c);h.mat2d.translate(e,e,a);return e}}();b.getTransform=function(){var a=u.vec2f64.create();return function(c,
e,d,h){var f=N(e),n=M(e);C(a,e.targetGeometry);return b.getMatrix(c,a,d,f,n,h)}}();b.getTransformNoRotation=function(){var a=u.vec2f64.create();return function(c,e,d,h){var f=N(e);C(a,e.targetGeometry);return b.getMatrix(c,a,d,f,0,h)}}();b.getWorldWidth=Q;b.getWorldScreenWidth=function(a,b){return Math.round(Q(a)/b)};b.createAsync=function(a,b){return E(a,b)};b.angleBetween=function(){var a=u.vec2f64.create(),b=u.vec2f64.create(),c=[0,0,0];return function(e,d,h){n.vec2.subtract(a,e,d);n.vec2.normalize(a,
a);n.vec2.subtract(b,e,h);n.vec2.normalize(b,b);n.vec2.cross(c,a,b);e=Math.acos(n.vec2.dot(a,b)/(n.vec2.length(a)*n.vec2.length(b)))*S;0>c[2]&&(e=-e);isNaN(e)&&(e=0);return e}}();b.addPadding=function(){var a=u.vec2f64.create();return function(c,e,d,h){var f=c.targetGeometry;G(c,e);b.getPaddingMapTranslation(a,e,d,h);f.x+=a[0];f.y+=a[1];return c}}();b.removePadding=function(){var a=u.vec2f64.create();return function(c,e,d,h){var f=c.targetGeometry;G(c,e);b.getPaddingMapTranslation(a,e,d,h);f.x-=a[0];
f.y-=a[1];return c}}();b.centerAt=function(){var a=u.vec2f64.create();return function(b,c,e){G(b,c);c=b.targetGeometry;var d=B(e),h=B(c);C(a,e);z(a,a,d,h);c.x=a[0];c.y=a[1];return b}}();b.pixelSize=function(a){return N(a)};b.resize=function(){var a=u.vec2f64.create();return function(c,e,d,h,f){f||(f="center");n.vec2.sub(a,d,h);n.vec2.scale(a,a,.5);d=a[0];h=a[1];switch(f){case "center":n.vec2.set(a,0,0);break;case "left":n.vec2.set(a,-d,0);break;case "top":n.vec2.set(a,0,h);break;case "right":n.vec2.set(a,
d,0);break;case "bottom":n.vec2.set(a,0,-h);break;case "top-left":n.vec2.set(a,-d,h);break;case "bottom-left":n.vec2.set(a,-d,-h);break;case "top-right":n.vec2.set(a,d,h);break;case "bottom-right":n.vec2.set(a,d,-h)}b.translateBy(c,e,a);return c}}();b.rotateBy=function(a,b,c){G(a,b);a.rotation+=c;return a};b.rotateTo=function(a,b,c){G(a,b);a.rotation=c;return a};b.scaleBy=function(){var a=u.vec2f64.create();return function(c,e,d,h,f){G(c,e);isNaN(d)||0===d||(b.toMap(a,h,e,f),c.scale=e.scale*d,b.toScreen(a,
a,c,f),b.translateBy(c,c,n.vec2.set(a,a[0]-h[0],h[1]-a[1])));return c}}();b.scaleTo=function(a,b,c){G(a,b);a.scale=c;return a};b.scaleAndRotateBy=function(){var a=u.vec2f64.create();return function(c,e,d,h,f,g){G(c,e);isNaN(d)||0===d||(b.toMap(a,f,e,g),c.scale=e.scale*d,c.rotation+=h,b.toScreen(a,a,c,g),b.translateBy(c,c,n.vec2.set(a,a[0]-f[0],f[1]-a[1])));return c}}();b.padAndScaleAndRotateBy=function(){var a=u.vec2f64.create(),c=u.vec2f64.create();return function(e,d,h,f,g,m,k){b.getPaddingScreenTranslation(c,
m,k);n.vec2.add(a,g,c);return f?b.scaleAndRotateBy(e,d,h,f,a,m):b.scaleBy(e,d,h,a,m)}}();b.toMap=function(){var a=p.mat2df64.create();return function(b,c,e,d){return n.vec2.transformMat2d(b,c,K(a,e,d,1))}}();b.toScreen=function(){var a=p.mat2df64.create();return function(c,e,d,h){return n.vec2.transformMat2d(c,e,b.getTransform(a,d,h,1))}}();b.translateBy=function(){var a=u.vec2f64.create(),b=p.mat2df64.create();return function(c,e,d){G(c,e);var f=N(e),g=c.targetGeometry;h.mat2d.fromRotation(b,M(e));
h.mat2d.scale(b,b,u.vec2f64.fromValues(f,f));n.vec2.transformMat2d(a,d,b);g.x+=a[0];g.y+=a[1];return c}}()})},"esri/core/libs/gl-matrix-2/common":function(){define(["require","exports","./math/common"],function(g,b,l){Object.defineProperty(b,"__esModule",{value:!0});b.common=l})},"esri/core/libs/gl-matrix-2/mat2d":function(){define(["require","exports","./math/mat2d"],function(g,b,l){Object.defineProperty(b,"__esModule",{value:!0});b.mat2d=l})},"esri/core/libs/gl-matrix-2/mat2df64":function(){define(["require",
"exports","./factories/mat2df64"],function(g,b,l){Object.defineProperty(b,"__esModule",{value:!0});b.mat2df64=l})},"esri/core/libs/gl-matrix-2/factories/mat2df64":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});b.create=function(){return[1,0,0,1,0,0]};b.clone=function(b){return[b[0],b[1],b[2],b[3],b[4],b[5]]};b.fromValues=function(b,g,f,a,q,m){return[b,g,f,a,q,m]};b.createView=function(b,g){return new Float64Array(b,g,6)}})},"esri/core/libs/gl-matrix-2/vec2":function(){define(["require",
"exports","./math/vec2"],function(g,b,l){Object.defineProperty(b,"__esModule",{value:!0});b.vec2=l})},"esri/core/libs/gl-matrix-2/math/vec2":function(){define(["require","exports","./common"],function(g,b,l){function k(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];return a}function f(a,b,c){a[0]=b[0]*c[0];a[1]=b[1]*c[1];return a}function a(a,b,c){a[0]=b[0]/c[0];a[1]=b[1]/c[1];return a}function q(a,b){var c=b[0]-a[0];a=b[1]-a[1];return Math.sqrt(c*c+a*a)}function m(a,b){var c=b[0]-a[0];a=b[1]-a[1];return c*
c+a*a}function d(a){var b=a[0];a=a[1];return Math.sqrt(b*b+a*a)}function c(a){var b=a[0];a=a[1];return b*b+a*a}Object.defineProperty(b,"__esModule",{value:!0});b.copy=function(a,b){a[0]=b[0];a[1]=b[1];return a};b.set=function(a,b,c){a[0]=b;a[1]=c;return a};b.add=function(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];return a};b.subtract=k;b.multiply=f;b.divide=a;b.ceil=function(a,b){a[0]=Math.ceil(b[0]);a[1]=Math.ceil(b[1]);return a};b.floor=function(a,b){a[0]=Math.floor(b[0]);a[1]=Math.floor(b[1]);return a};
b.min=function(a,b,c){a[0]=Math.min(b[0],c[0]);a[1]=Math.min(b[1],c[1]);return a};b.max=function(a,b,c){a[0]=Math.max(b[0],c[0]);a[1]=Math.max(b[1],c[1]);return a};b.round=function(a,b){a[0]=Math.round(b[0]);a[1]=Math.round(b[1]);return a};b.scale=function(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;return a};b.scaleAndAdd=function(a,b,c,d){a[0]=b[0]+c[0]*d;a[1]=b[1]+c[1]*d;return a};b.distance=q;b.squaredDistance=m;b.length=d;b.squaredLength=c;b.negate=function(a,b){a[0]=-b[0];a[1]=-b[1];return a};b.inverse=
function(a,b){a[0]=1/b[0];a[1]=1/b[1];return a};b.normalize=function(a,b){var c=b[0],e=b[1],c=c*c+e*e;0<c&&(c=1/Math.sqrt(c),a[0]=b[0]*c,a[1]=b[1]*c);return a};b.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]};b.cross=function(a,b,c){b=b[0]*c[1]-b[1]*c[0];a[0]=a[1]=0;a[2]=b;return a};b.lerp=function(a,b,c,d){var e=b[0];b=b[1];a[0]=e+d*(c[0]-e);a[1]=b+d*(c[1]-b);return a};b.random=function(a,b){b=b||1;var c=2*l.RANDOM()*Math.PI;a[0]=Math.cos(c)*b;a[1]=Math.sin(c)*b;return a};b.transformMat2=function(a,
b,c){var e=b[0];b=b[1];a[0]=c[0]*e+c[2]*b;a[1]=c[1]*e+c[3]*b;return a};b.transformMat2d=function(a,b,c){var e=b[0];b=b[1];a[0]=c[0]*e+c[2]*b+c[4];a[1]=c[1]*e+c[3]*b+c[5];return a};b.transformMat3=function(a,b,c){var e=b[0];b=b[1];a[0]=c[0]*e+c[3]*b+c[6];a[1]=c[1]*e+c[4]*b+c[7];return a};b.transformMat4=function(a,b,c){var e=b[0];b=b[1];a[0]=c[0]*e+c[4]*b+c[12];a[1]=c[1]*e+c[5]*b+c[13];return a};b.rotate=function(a,b,c,d){var e=b[0]-c[0];b=b[1]-c[1];var h=Math.sin(d);d=Math.cos(d);a[0]=e*d-b*h+c[0];
a[1]=e*h+b*d+c[1];return a};b.angle=function(a,b){var c=a[0];a=a[1];var e=b[0];b=b[1];var d=c*c+a*a;0<d&&(d=1/Math.sqrt(d));var h=e*e+b*b;0<h&&(h=1/Math.sqrt(h));c=(c*e+a*b)*d*h;return 1<c?0:-1>c?Math.PI:Math.acos(c)};b.str=function(a){return"vec2("+a[0]+", "+a[1]+")"};b.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]};b.equals=function(a,b){var c=a[0];a=a[1];var e=b[0];b=b[1];return Math.abs(c-e)<=l.EPSILON*Math.max(1,Math.abs(c),Math.abs(e))&&Math.abs(a-b)<=l.EPSILON*Math.max(1,Math.abs(a),
Math.abs(b))};b.len=d;b.sub=k;b.mul=f;b.div=a;b.dist=q;b.sqrDist=m;b.sqrLen=c})},"esri/core/libs/gl-matrix-2/vec2f64":function(){define(["require","exports","./factories/vec2f64"],function(g,b,l){Object.defineProperty(b,"__esModule",{value:!0});b.vec2f64=l})},"esri/core/libs/gl-matrix-2/factories/vec2f64":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});b.create=function(){return[0,0]};b.clone=function(b){return[b[0],b[1]]};b.fromValues=function(b,
g){return[b,g]};b.fromArray=function(b){for(var g=[0,0],f=Math.min(2,b.length),a=0;a<f;++a)g[a]=b[a];return g};b.createView=function(b,g){return new Float64Array(b,g,2)};b.zeros=function(){return[0,0]};b.ones=function(){return[1,1]};b.unitX=function(){return[1,0]};b.unitY=function(){return[0,1]};b.ZEROS=[0,0];b.ONES=[1,1];b.UNIT_X=[1,0];b.UNIT_Y=[0,1]})},"esri/views/2d/FrameTask":function(){define(["require","exports","../../core/scheduling"],function(g,b,l){Object.defineProperty(b,"__esModule",{value:!0});
g=function(){function b(b){var a=this;this.view=b;this._frameTaskHandle=null;this.updateEnabled=this.stationary=!0;this.animationInProgress=!1;this.prepare=function(){a._updateParameters.state=a.view.state;a._updateParameters.stationary=a.view.stationary;a._updateParameters.pixelRatio=window.devicePixelRatio;a._updateParameters.renderingOptions=a.view.renderingOptions};this.update=function(){if(a.updateEnabled){var b=a.view,f=b.labelManager,d=a.graphicsView,c=b.allLayerViews.toArray().filter(function(a){return!("layerViews"in
a)&&a.isFulfilled()}),e=c.length,h=b.state,g=0;for(;g<c.length;g++)if(b=c[g],b.attached){var n=b.lastUpdateId;if(null==n||!a.stationary&&!b.moving)b.moving=!0,b.moveStart();n!==h.id&&b.viewChange();a.stationary&&b.moving&&(b.moving=!1,b.moveEnd());b.lastUpdateId=h.id}f&&f.lastUpdateId!==h.id&&(f.viewChange(),f.lastUpdateId=h.id);d&&d.lastUpdateId!==h.id&&(d.viewChange(),d.lastUpdateId=h.id);f=a._layerViewsTrash;for(d=0;d<f.length;d++)b=f[d],a._detachLayerView(b);for(d=f.length=0;d<e;d++)b=c[d],b.isFulfilled()&&
!b.attached&&a._attachLayerView(b);c=a._updateParameters;e=a._layerViewsToUpdate;b=e.slice();d=e.length=0;for(h=b;d<h.length;d++)b=h[d],"layerViews"in b?e.push(b):b.processUpdate(c);e=a._updatablesToUpdate;b=e.slice();for(e=e.length=0;e<b.length;e++)b[e].processUpdate(c);a.animationInProgress||0!==a._layerViewsToUpdate.length||0!==a._updatablesToUpdate.length||0!==f.length||a._frameTaskHandle.pause()}}}b.prototype.destroy=function(){this.stop()};b.prototype.start=function(){var b=this;this.stationary=
this.view.stationary;this._updateParameters={state:this.view.state,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:this.view.renderingOptions};this._layerViewsTrash=[];this._layerViewsToUpdate=[];this._updatablesToUpdate=[];this._allLayerViewsChangeHandle=this.view.allLayerViews.on("change",function(a){Array.prototype.push.apply(b._layerViewsTrash,a.removed);b.requestFrame()});this._stationaryHandle=this.view.watch("stationary",function(a){b.stationary=a;b.requestFrame()});
this._frameTaskHandle=l.addFrameTask(this)};b.prototype.stop=function(){var b=this;this._frameTaskHandle&&(this.view.allLayerViews.forEach(function(a){"layerViews"in a||b._detachLayerView(a)}),this._stationaryHandle.remove(),this._allLayerViewsChangeHandle.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._allLayerViewsChangeHandle=this._frameTaskHandle=this._layerViewsTrash=this._layerViewsToUpdate=null,this.stationary=!0,this.animationInProgress=!1)};b.prototype.requestLayerViewUpdate=
function(b){this._layerViewsToUpdate.push(b);this.requestFrame()};b.prototype.requestUpdate=function(b){this._updatablesToUpdate.push(b);this.requestFrame()};b.prototype.requestFrame=function(){this._frameTaskHandle&&this._frameTaskHandle.resume()};b.prototype._attachLayerView=function(b){b.attached||(b.attached=!0,b.attach(),this._updateParameters.stationary?b.moving=!1:(b.moving=!0,b.moveStart()))};b.prototype._detachLayerView=function(b){b.attached&&(b.detach(),b.attached=!1,b.moving=!1)};return b}();
b.default=g})},"esri/views/2d/layerViewModuleImportUtils":function(){define(["require","exports","../../core/Error","../../core/maybe","@dojo/framework/shim/Promise"],function(g,b,l,k){function f(){return Promise.all([new Promise(function(a,b){g(["../webgl"],a,b)}),new Promise(function(a,b){g(["./engine"],a,b)})])}Object.defineProperty(b,"__esModule",{value:!0});var a=function(){return f().then(function(){return new Promise(function(a,b){g(["./layers/TileLayerView2D"],a,b)})})},q=function(){return f().then(function(){return new Promise(function(a,
b){g(["./layers/FeatureLayerView2D"],a,b)})})},m={"base-dynamic":function(){return f().then(function(){return new Promise(function(a,b){g(["./layers/BaseDynamicLayerView2D"],a,b)})})},"base-tile":a,"bing-maps":a,csv:q,"geo-rss":function(){return f().then(function(){return new Promise(function(a,b){g(["./layers/GeoRSSLayerView2D"],a,b)})})},feature:q,geojson:q,graphics:function(){return f().then(function(){return new Promise(function(a,b){g(["./layers/GraphicsLayerView2D"],a,b)})})},group:function(){return f().then(function(){return new Promise(function(a,
b){g(["../layers/GroupLayerView"],a,b)})})},imagery:function(){return f().then(function(){return new Promise(function(a,b){g(["./layers/ImageryLayerView2D"],a,b)})})},"imagery-tile":function(){return f().then(function(){return new Promise(function(a,b){g(["./layers/TileImageryLayerView2D"],a,b)})})},kml:function(){return f().then(function(){return new Promise(function(a,b){g(["./layers/KMLLayerView2D"],a,b)})})},"map-image":function(){return f().then(function(){return new Promise(function(a,b){g(["./layers/MapImageLayerView2D"],
a,b)})})},"map-notes":function(){return f().then(function(){return new Promise(function(a,b){g(["./layers/MapNotesLayerView2D"],a,b)})})},"open-street-map":a,route:function(){return f().then(function(){return new Promise(function(a,b){g(["./layers/RouteLayerView2D"],a,b)})})},stream:function(){return f().then(function(){return new Promise(function(a,b){g(["./layers/StreamLayerView2D"],a,b)})})},tile:a,"vector-tile":function(){return f().then(function(){return new Promise(function(a,b){g(["./layers/VectorTileLayerView2D"],
a,b)})})},"web-tile":a,wms:function(){return f().then(function(){return new Promise(function(a,b){g(["./layers/WMSLayerView2D"],a,b)})})},wmts:function(){return f().then(function(){return new Promise(function(a,b){g(["./layers/WMTSLayerView2D"],a,b)})})},"base-elevation":null,"building-scene":null,elevation:null,"integrated-mesh":null,"point-cloud":null,scene:null,unknown:null,unsupported:null};b.layerView2DImporter={hasLayerViewModule:function(a){return k.isSome(m[a.type])},importLayerView:function(a){var b=
m[a.type];if(!k.isSome(b))throw a=a.declaredClass?a.declaredClass.slice(a.declaredClass.lastIndexOf(".")+1):"Unknown",b=a.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),new l(b+":view-not-supported",a+" is not supported in 2D");return b(a)}}})},"esri/views/2d/MapViewConstraints":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Evented ../../core/accessorSupport/decorators ../../layers/support/LOD ./constraints/RotationConstraint ./constraints/ZoomConstraint".split(" "),
function(g,b,l,k,f,a,q,m,d){return function(b){function c(){var a=null!==b&&b.apply(this,arguments)||this;a.lods=null;a.minScale=0;a.maxScale=0;a.minZoom=-1;a.maxZoom=-1;a.rotationEnabled=!0;a.snapToZoom=!0;return a}l(c,b);c.prototype.initialize=function(){this.watch("_zoom, _rotation",this.emit.bind(this,"update"),!0)};c.prototype.destroy=function(){this.view=null;this._set("_zoom",null);this._set("_rotation",null)};Object.defineProperty(c.prototype,"_rotation",{get:function(){return new m({rotationEnabled:this.rotationEnabled})},
enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"_defaultLODs",{get:function(){var a=this.get("view.defaultsFromMap.tileInfo"),b=this.get("view.spatialReference");return a&&b&&a.spatialReference.equals(b)?a.lods:null},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"_zoom",{get:function(){return new d({lods:this.lods||this._defaultLODs,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale,snapToZoom:this.snapToZoom})},enumerable:!0,
configurable:!0});c.prototype.canZoomInTo=function(a){var b=this.effectiveMaxScale;return 0===b||a>=b};c.prototype.canZoomOutTo=function(a){var b=this.effectiveMinScale;return 0===b||a<=b};c.prototype.constrain=function(a,b){this._zoom.constrain(a,b);this._rotation.constrain(a,b);return a};c.prototype.fit=function(a){return this._zoom.fit(a)};c.prototype.zoomToScale=function(a){return this._zoom.zoomToScale(a)};c.prototype.scaleToZoom=function(a){return this._zoom.scaleToZoom(a)};c.prototype.snapScale=
function(a){return this._zoom.snapToClosestScale(a)};c.prototype.snapToNextScale=function(a){return this._zoom.snapToNextScale(a)};c.prototype.snapToPreviousScale=function(a){return this._zoom.snapToPreviousScale(a)};k([a.property({readOnly:!0,aliasOf:"_zoom.effectiveLODs"})],c.prototype,"effectiveLODs",void 0);k([a.property({readOnly:!0,aliasOf:"_zoom.effectiveMinScale"})],c.prototype,"effectiveMinScale",void 0);k([a.property({readOnly:!0,aliasOf:"_zoom.effectiveMaxScale"})],c.prototype,"effectiveMaxScale",
void 0);k([a.property({readOnly:!0,aliasOf:"_zoom.effectiveMinZoom"})],c.prototype,"effectiveMinZoom",void 0);k([a.property({readOnly:!0,aliasOf:"_zoom.effectiveMaxZoom"})],c.prototype,"effectiveMaxZoom",void 0);k([a.property({type:[q]})],c.prototype,"lods",void 0);k([a.property()],c.prototype,"minScale",void 0);k([a.property()],c.prototype,"maxScale",void 0);k([a.property()],c.prototype,"minZoom",void 0);k([a.property()],c.prototype,"maxZoom",void 0);k([a.property()],c.prototype,"rotationEnabled",
void 0);k([a.property()],c.prototype,"snapToZoom",void 0);k([a.property()],c.prototype,"view",void 0);k([a.property({type:m,dependsOn:["rotationEnabled"]})],c.prototype,"_rotation",null);k([a.property({dependsOn:["view.spatialReference","view.defaultsFromMap.tileInfo"]})],c.prototype,"_defaultLODs",null);k([a.property({readOnly:!0,type:d,dependsOn:"lods minZoom maxZoom minScale maxScale snapToZoom _defaultLODs".split(" ")})],c.prototype,"_zoom",null);return c=k([a.subclass("esri.views.2d.MapViewConstraints")],
c)}(a.declared(f.EventedAccessor))})},"esri/views/2d/constraints/RotationConstraint":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/Accessor ../../../core/accessorSupport/decorators".split(" "),function(g,b,l,k,f,a){return function(b){function f(){var a=null!==b&&b.apply(this,arguments)||this;a.enabled=!0;a.rotationEnabled=!0;return a}l(f,b);d=f;f.prototype.constrain=function(a,b){if(!this.enabled||!b)return a;this.rotationEnabled||
(a.rotation=b.rotation);return a};f.prototype.clone=function(){return new d({enabled:this.enabled,rotationEnabled:this.rotationEnabled})};var d;k([a.property()],f.prototype,"enabled",void 0);k([a.property()],f.prototype,"rotationEnabled",void 0);return f=d=k([a.subclass("esri.views.2d.constraints.RotationConstraint")],f)}(a.declared(f))})},"esri/views/2d/constraints/ZoomConstraint":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/Accessor ../../../core/accessorSupport/decorators ../../../layers/support/LOD".split(" "),
function(g,b,l,k,f,a,q){return function(b){function d(a){a=b.call(this,a)||this;a._lodByScale={};a._scales=[];a.effectiveLODs=null;a.effectiveMinZoom=-1;a.effectiveMaxZoom=-1;a.effectiveMinScale=0;a.effectiveMaxScale=0;a.lods=null;a.minZoom=-1;a.maxZoom=-1;a.minScale=0;a.maxScale=0;a.snapToZoom=!0;return a}l(d,b);c=d;d.prototype.initialize=function(){var a=this,b,c,d=this.lods;c=this.minScale;b=this.maxScale;var f=this.minZoom,g=this.maxZoom,m=-1,k=-1,l=!1,q=!1;0!==c&&0!==b&&c<b&&(b=[b,c],c=b[0],
b=b[1]);if(d&&d.length){d=d.map(function(a){return a.clone()});d.sort(function(a,b){return b.scale-a.scale});d.forEach(function(a,b){return a.level=b});for(var y,A=0,z=d;A<z.length;A++){var B=z[A];!l&&0<c&&c>=B.scale&&(m=B.level,l=!0);!q&&0<b&&b>=B.scale&&(k=y?y.level:-1,q=!0);y=B}-1===f&&(f=0===c?0:m);-1===g&&(g=0===b?d.length-1:k);f=Math.max(f,0);f=Math.min(f,d.length-1);g=Math.max(g,0);g=Math.min(g,d.length-1);f>g&&(c=[g,f],f=c[0],g=c[1]);c=d[f].scale;b=d[g].scale;d.splice(0,f);d.splice(g-f+1,
d.length);d.forEach(function(b,c){a._lodByScale[b.scale]=b;a._scales[c]=b.scale});this._set("effectiveLODs",d);this._set("effectiveMinZoom",f);this._set("effectiveMaxZoom",g)}this._set("effectiveMinScale",c);this._set("effectiveMaxScale",b)};d.prototype.constrain=function(a,b){if(b&&a.scale===b.scale)return a;var c=this.effectiveMinScale,e=this.effectiveMaxScale,d=a.targetGeometry,f=b&&b.targetGeometry,h=0!==c&&a.scale>c;if(0!==e&&a.scale<e||h)c=h?c:e,f&&(b=(c-b.scale)/(a.scale-b.scale),d.x=f.x+(d.x-
f.x)*b,d.y=f.y+(d.y-f.y)*b),a.scale=c;this.snapToZoom&&this.effectiveLODs&&(a.scale=this._getClosestScale(a.scale));return a};d.prototype.fit=function(a){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(a,null);var b=this.scaleToZoom(a.scale);a.scale=this.zoomToScale(.99<Math.abs(b-Math.floor(b))?Math.round(b):Math.floor(b));return a};d.prototype.zoomToScale=function(a){if(!this.effectiveLODs)return 0;a-=this.effectiveMinZoom;a=Math.max(0,a);var b=this._scales;if(0>=a)return b[0];if(a>=
b.length)return b[b.length-1];var c=Math.round(a);return b[c]+(c-a)*(b[Math.round(a-.5)]-b[c])};d.prototype.scaleToZoom=function(a){if(!this.effectiveLODs)return-1;var b=this._scales,c,e;if(a>=b[0])return this.effectiveMinZoom;if(a<=b[b.length-1])return this.effectiveMaxZoom;for(var d=0;d<b.length-1;d++){c=b[d];e=b[d+1];if(e===a)return b=d+this.effectiveMinZoom,b+1;if(c>a&&e<a)return b=d+this.effectiveMinZoom,b+1-(a-e)/(c-e)}};d.prototype.snapToClosestScale=function(a){if(!this.effectiveLODs)return a;
a=this.scaleToZoom(a);return this.zoomToScale(Math.round(a))};d.prototype.snapToNextScale=function(a,b){void 0===b&&(b=.5);if(!this.effectiveLODs)return a*b;a=Math.round(this.scaleToZoom(a));return this.zoomToScale(a+1)};d.prototype.snapToPreviousScale=function(a,b){void 0===b&&(b=2);if(!this.effectiveLODs)return a*b;a=Math.round(this.scaleToZoom(a));return this.zoomToScale(a-1)};d.prototype.clone=function(){return new c({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,
maxScale:this.maxScale})};d.prototype._getClosestScale=function(a){if(this._lodByScale[a])return this._lodByScale[a].scale;a=this._scales.reduce(function(b,c){return Math.abs(c-a)<=Math.abs(b-a)?c:b},this._scales[0]);return this._lodByScale[a].scale};var c;k([a.property({readOnly:!0})],d.prototype,"effectiveLODs",void 0);k([a.property({readOnly:!0})],d.prototype,"effectiveMinZoom",void 0);k([a.property({readOnly:!0})],d.prototype,"effectiveMaxZoom",void 0);k([a.property({readOnly:!0})],d.prototype,
"effectiveMinScale",void 0);k([a.property({readOnly:!0})],d.prototype,"effectiveMaxScale",void 0);k([a.property({type:[q]})],d.prototype,"lods",void 0);k([a.property()],d.prototype,"minZoom",void 0);k([a.property()],d.prototype,"maxZoom",void 0);k([a.property()],d.prototype,"minScale",void 0);k([a.property()],d.prototype,"maxScale",void 0);k([a.property()],d.prototype,"snapToZoom",void 0);return d=c=k([a.subclass("esri.views.2d.constraints.ZoomConstraint")],d)}(a.declared(f))})},"esri/views/2d/PaddedViewState":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators ../../core/libs/gl-matrix-2/vec2 ../../core/libs/gl-matrix-2/vec2f64 ./viewpointUtils ./ViewState".split(" "),
function(g,b,l,k,f,a,q,m,d,c){var e=function(b){function c(){var a=null!==b&&b.apply(this,arguments)||this;a.left=0;a.top=0;a.right=0;a.bottom=0;return a}l(c,b);k([a.property()],c.prototype,"left",void 0);k([a.property()],c.prototype,"top",void 0);k([a.property()],c.prototype,"right",void 0);k([a.property()],c.prototype,"bottom",void 0);return c=k([a.subclass("esri.views.2d.PaddedViewState.Padding")],c)}(a.declared(f));return function(b){function f(){for(var a=[],d=0;d<arguments.length;d++)a[d]=arguments[d];
var f=b.apply(this,a)||this;f.paddedViewState=new c;f._updateContent=function(){var a=m.vec2f64.create();return function(){var b=f._get("size"),c=f._get("padding");if(b&&c){var e=f.paddedViewState;q.vec2.set(a,c.left+c.right,c.top+c.bottom);q.vec2.subtract(a,b,a);q.vec2.copy(e.size,a);if(b=e.viewpoint)f.viewpoint=b}}}();f.watch(["size","padding"],f._updateContent,!0);f.padding=new e;f.size=[0,0];return f}l(f,b);Object.defineProperty(f.prototype,"padding",{set:function(a){this._set("padding",a||new e)},
enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"viewpoint",{set:function(a){if(a){var b=a.clone();this.paddedViewState.viewpoint=a;d.addPadding(b,a,this._get("size"),this._get("padding"));a=this._viewpoint2D;var c=b.targetGeometry;a.center[0]=c.x;a.center[1]=c.y;a.rotation=b.rotation;a.scale=b.scale;a.spatialReference=c.spatialReference;this._update()}},enumerable:!0,configurable:!0});k([a.property()],f.prototype,"paddedViewState",void 0);k([a.property({type:e})],f.prototype,"padding",
null);k([a.property()],f.prototype,"viewpoint",null);return f=k([a.subclass("esri.views.2d.PaddedViewState")],f)}(a.declared(c))})},"esri/views/2d/ViewState":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../geometry ../../Viewpoint ../../core/JSONSupport ../../core/accessorSupport/decorators ../../core/libs/gl-matrix-2/common ../../core/libs/gl-matrix-2/mat2d ../../core/libs/gl-matrix-2/mat2df32 ../../core/libs/gl-matrix-2/mat2df64 ../../core/libs/gl-matrix-2/mat3 ../../core/libs/gl-matrix-2/mat3f32 ../../core/libs/gl-matrix-2/vec2 ../../core/libs/gl-matrix-2/vec2f32 ../../core/libs/gl-matrix-2/vec2f64 ../../core/libs/gl-matrix-2/types/vec2 ./viewpointUtils".split(" "),
function(g,b,l,k,f,a,q,m,d,c,e,h,p,n,u,x,v,t,w){var r=[0,0];return function(b){function g(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];a=b.apply(this,a)||this;a._viewpoint2D={center:v.vec2f64.create(),rotation:0,scale:0,spatialReference:null};a.center=[0,0];a.extent=new f.Extent;a.id=0;a.inverseTransform=h.mat2df64.create();a.resolution=0;a.rotation=0;a.scale=0;a.transform=h.mat2df64.create();a.transformNoRotation=h.mat2df64.create();a.displayMat3=n.mat3f32.create();a.displayViewMat3=
n.mat3f32.create();a.viewMat3=n.mat3f32.create();a.viewMat2d=e.mat2df32.create();a.worldScreenWidth=0;a.size=[0,0];return a}l(g,b);q=g;Object.defineProperty(g.prototype,"pixelRatio",{set:function(a){this._set("pixelRatio",a);this._update()},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"size",{set:function(a){this._set("size",a);this._update()},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"viewpoint",{set:function(a){if(a){var b=this._viewpoint2D,c=a.targetGeometry;
b.center[0]=c.x;b.center[1]=c.y;b.rotation=a.rotation;b.scale=a.scale;b.spatialReference=c.spatialReference}this._update()},enumerable:!0,configurable:!0});g.prototype.copy=function(a){var b=this.size,c=this.viewpoint;c&&b?(this.viewpoint=w.copy(c,a.viewpoint),this._set("size",u.vec2.copy(b,a.size))):(this.viewpoint=a.viewpoint.clone(),this._set("size",[a.size[0],a.size[1]]));this._set("pixelRatio",a.pixelRatio);return this};g.prototype.clone=function(){return new q({size:this.size,viewpoint:this.viewpoint.clone(),
pixelRatio:this.pixelRatio})};g.prototype.toMap=function(a,b,c){if(t.isVec2(b))return u.vec2.transformMat2d(a,b,this.inverseTransform);r[0]=b;r[1]=c;return u.vec2.transformMat2d(a,r,this.inverseTransform)};g.prototype.toScreen=function(a,b,c){if(t.isVec2(b))return u.vec2.transformMat2d(a,b,this.transform);r[0]=b;r[1]=c;return u.vec2.transformMat2d(a,r,this.transform)};g.prototype.toScreenNoRotation=function(a,b,c){if(t.isVec2(b))return u.vec2.transformMat2d(a,b,this.transformNoRotation);r[0]=b;r[1]=
c;return u.vec2.transformMat2d(a,r,this.transformNoRotation)};g.prototype.getScreenTransform=function(a,b){var c=this._viewpoint2D.center,e=this._get("pixelRatio")||1,d=this._get("size");w.getMatrix(a,c,d,b,0,e);return a};g.prototype._update=function(){var b=this._viewpoint2D,e=b.center,h=b.spatialReference,g=b.scale,n=b.rotation,b=this._get("pixelRatio")||1,m=this._get("size"),k=new a({targetGeometry:new f.Point(e[0],e[1],h),scale:g,rotation:n});this._set("viewpoint",k);if(m&&h&&g)return this.resolution=
w.getResolution(k),this.rotation=n,this.scale=g,this.spatialReference=h,u.vec2.copy(this.center,e),p.mat3.set(this.displayMat3,0!==m[0]?2/m[0]:0,0,0,0,0!==m[1]?-2/m[1]:0,0,-1,1,1),g=p.mat3.identity(this.viewMat3),e=x.vec2f32.fromValues(m[0]/2,m[1]/2),h=x.vec2f32.fromValues(-m[0]/2,-m[1]/2),n=d.common.toRadian(n),p.mat3.translate(g,g,e),p.mat3.rotate(g,g,n),p.mat3.translate(g,g,h),p.mat3.multiply(this.displayViewMat3,this.displayMat3,g),g=c.mat2d.identity(this.viewMat2d),c.mat2d.translate(g,g,e),c.mat2d.rotate(g,
g,n),c.mat2d.translate(g,g,h),w.getExtent(this.extent,k,m),w.getTransform(this.transform,k,m,b),c.mat2d.invert(this.inverseTransform,this.transform),w.getTransformNoRotation(this.transformNoRotation,k,m,b),this.worldScreenWidth=w.getWorldScreenWidth(this.spatialReference,this.resolution),this._set("id",this.id+1),this};var q;k([m.property({readOnly:!0})],g.prototype,"id",void 0);k([m.property({value:1,json:{write:!0}})],g.prototype,"pixelRatio",null);k([m.property({json:{write:!0}})],g.prototype,
"size",null);k([m.property({type:a,json:{write:!0}})],g.prototype,"viewpoint",null);return g=q=k([m.subclass("esri.views.2d.ViewState")],g)}(m.declared(q.JSONSupport))})},"esri/core/libs/gl-matrix-2/mat3":function(){define(["require","exports","./math/mat3"],function(g,b,l){Object.defineProperty(b,"__esModule",{value:!0});b.mat3=l})},"esri/core/libs/gl-matrix-2/math/mat3":function(){define(["require","exports","./common"],function(g,b,l){function k(a,b,f){var d=b[0],c=b[1],e=b[2],h=b[3],g=b[4],n=
b[5],m=b[6],k=b[7];b=b[8];var l=f[0],q=f[1],w=f[2],r=f[3],y=f[4],A=f[5],z=f[6],B=f[7];f=f[8];a[0]=l*d+q*h+w*m;a[1]=l*c+q*g+w*k;a[2]=l*e+q*n+w*b;a[3]=r*d+y*h+A*m;a[4]=r*c+y*g+A*k;a[5]=r*e+y*n+A*b;a[6]=z*d+B*h+f*m;a[7]=z*c+B*g+f*k;a[8]=z*e+B*n+f*b;return a}function f(a,b,f){a[0]=b[0]-f[0];a[1]=b[1]-f[1];a[2]=b[2]-f[2];a[3]=b[3]-f[3];a[4]=b[4]-f[4];a[5]=b[5]-f[5];a[6]=b[6]-f[6];a[7]=b[7]-f[7];a[8]=b[8]-f[8];return a}Object.defineProperty(b,"__esModule",{value:!0});b.fromMat4=function(a,b){a[0]=b[0];
a[1]=b[1];a[2]=b[2];a[3]=b[4];a[4]=b[5];a[5]=b[6];a[6]=b[8];a[7]=b[9];a[8]=b[10];return a};b.copy=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];return a};b.set=function(a,b,f,d,c,e,h,g,n,k){a[0]=b;a[1]=f;a[2]=d;a[3]=c;a[4]=e;a[5]=h;a[6]=g;a[7]=n;a[8]=k;return a};b.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};b.transpose=function(a,b){if(a===b){var f=b[1],d=b[2],c=b[5];a[1]=b[3];a[2]=b[6];a[3]=
f;a[5]=b[7];a[6]=d;a[7]=c}else a[0]=b[0],a[1]=b[3],a[2]=b[6],a[3]=b[1],a[4]=b[4],a[5]=b[7],a[6]=b[2],a[7]=b[5],a[8]=b[8];return a};b.invert=function(a,b){var f=b[0],d=b[1],c=b[2],e=b[3],h=b[4],g=b[5],n=b[6],k=b[7];b=b[8];var l=b*h-g*k,q=-b*e+g*n,t=k*e-h*n,w=f*l+d*q+c*t;if(!w)return null;w=1/w;a[0]=l*w;a[1]=(-b*d+c*k)*w;a[2]=(g*d-c*h)*w;a[3]=q*w;a[4]=(b*f-c*n)*w;a[5]=(-g*f+c*e)*w;a[6]=t*w;a[7]=(-k*f+d*n)*w;a[8]=(h*f-d*e)*w;return a};b.adjoint=function(a,b){var f=b[0],d=b[1],c=b[2],e=b[3],h=b[4],g=
b[5],n=b[6],k=b[7];b=b[8];a[0]=h*b-g*k;a[1]=c*k-d*b;a[2]=d*g-c*h;a[3]=g*n-e*b;a[4]=f*b-c*n;a[5]=c*e-f*g;a[6]=e*k-h*n;a[7]=d*n-f*k;a[8]=f*h-d*e;return a};b.determinant=function(a){var b=a[3],f=a[4],d=a[5],c=a[6],e=a[7],h=a[8];return a[0]*(h*f-d*e)+a[1]*(-h*b+d*c)+a[2]*(e*b-f*c)};b.multiply=k;b.translate=function(a,b,f){var d=b[0],c=b[1],e=b[2],h=b[3],g=b[4],n=b[5],m=b[6],k=b[7];b=b[8];var l=f[0];f=f[1];a[0]=d;a[1]=c;a[2]=e;a[3]=h;a[4]=g;a[5]=n;a[6]=l*d+f*h+m;a[7]=l*c+f*g+k;a[8]=l*e+f*n+b;return a};
b.rotate=function(a,b,f){var d=b[0],c=b[1],e=b[2],h=b[3],g=b[4],n=b[5],m=b[6],k=b[7];b=b[8];var l=Math.sin(f);f=Math.cos(f);a[0]=f*d+l*h;a[1]=f*c+l*g;a[2]=f*e+l*n;a[3]=f*h-l*d;a[4]=f*g-l*c;a[5]=f*n-l*e;a[6]=m;a[7]=k;a[8]=b;return a};b.scale=function(a,b,f){var d=f[0],c=f[1];f=f[2];a[0]=d*b[0];a[1]=d*b[1];a[2]=d*b[2];a[3]=c*b[3];a[4]=c*b[4];a[5]=c*b[5];a[6]=f*b[6];a[7]=f*b[7];a[8]=f*b[8];return a};b.scaleByVec2=function(a,b,f){var d=f[0];f=f[1];a[0]=d*b[0];a[1]=d*b[1];a[2]=d*b[2];a[3]=f*b[3];a[4]=
f*b[4];a[5]=f*b[5];return a};b.fromTranslation=function(a,b){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=b[0];a[7]=b[1];a[8]=1;return a};b.fromRotation=function(a,b){var f=Math.sin(b);b=Math.cos(b);a[0]=b;a[1]=f;a[2]=0;a[3]=-f;a[4]=b;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};b.fromScaling=function(a,b){a[0]=b[0];a[1]=0;a[2]=0;a[3]=0;a[4]=b[1];a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};b.fromMat2d=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=0;a[3]=b[2];a[4]=b[3];a[5]=0;a[6]=b[4];a[7]=b[5];a[8]=1;return a};b.fromQuat=
function(a,b){var f=b[0],d=b[1],c=b[2];b=b[3];var e=f+f,h=d+d,g=c+c,f=f*e,n=d*e,d=d*h,k=c*e,l=c*h,c=c*g,e=b*e,h=b*h;b*=g;a[0]=1-d-c;a[3]=n-b;a[6]=k+h;a[1]=n+b;a[4]=1-f-c;a[7]=l-e;a[2]=k-h;a[5]=l+e;a[8]=1-f-d;return a};b.normalFromMat4Legacy=function(a,b){var f=b[0],d=b[1],c=b[2],e=b[4],h=b[5],g=b[6],n=b[8],k=b[9];b=b[10];var l=b*h-g*k,q=-b*e+g*n,t=k*e-h*n,w=f*l+d*q+c*t;if(!w)return null;w=1/w;a[0]=l*w;a[1]=(-b*d+c*k)*w;a[2]=(g*d-c*h)*w;a[3]=q*w;a[4]=(b*f-c*n)*w;a[5]=(-g*f+c*e)*w;a[6]=t*w;a[7]=(-k*
f+d*n)*w;a[8]=(h*f-d*e)*w;return a};b.normalFromMat4=function(a,b){var f=b[0],d=b[1],c=b[2],e=b[3],h=b[4],g=b[5],n=b[6],k=b[7],l=b[8],q=b[9],t=b[10],w=b[11],r=b[12],y=b[13],A=b[14];b=b[15];var z=f*g-d*h,B=f*n-c*h,C=f*k-e*h,D=d*n-c*g,H=d*k-e*g,F=c*k-e*n,E=l*y-q*r,G=l*A-t*r,l=l*b-w*r,J=q*A-t*y,q=q*b-w*y,t=t*b-w*A,w=z*t-B*q+C*J+D*l-H*G+F*E;if(!w)return null;w=1/w;a[0]=(g*t-n*q+k*J)*w;a[1]=(n*l-h*t-k*G)*w;a[2]=(h*q-g*l+k*E)*w;a[3]=(c*q-d*t-e*J)*w;a[4]=(f*t-c*l+e*G)*w;a[5]=(d*l-f*q-e*E)*w;a[6]=(y*F-A*
H+b*D)*w;a[7]=(A*C-r*F-b*B)*w;a[8]=(r*H-y*C+b*z)*w;return a};b.projection=function(a,b,f){a[0]=2/b;a[1]=0;a[2]=0;a[3]=0;a[4]=-2/f;a[5]=0;a[6]=-1;a[7]=1;a[8]=1;return a};b.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"};b.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))};b.add=function(a,b,
f){a[0]=b[0]+f[0];a[1]=b[1]+f[1];a[2]=b[2]+f[2];a[3]=b[3]+f[3];a[4]=b[4]+f[4];a[5]=b[5]+f[5];a[6]=b[6]+f[6];a[7]=b[7]+f[7];a[8]=b[8]+f[8];return a};b.subtract=f;b.multiplyScalar=function(a,b,f){a[0]=b[0]*f;a[1]=b[1]*f;a[2]=b[2]*f;a[3]=b[3]*f;a[4]=b[4]*f;a[5]=b[5]*f;a[6]=b[6]*f;a[7]=b[7]*f;a[8]=b[8]*f;return a};b.multiplyScalarAndAdd=function(a,b,f,d){a[0]=b[0]+f[0]*d;a[1]=b[1]+f[1]*d;a[2]=b[2]+f[2]*d;a[3]=b[3]+f[3]*d;a[4]=b[4]+f[4]*d;a[5]=b[5]+f[5]*d;a[6]=b[6]+f[6]*d;a[7]=b[7]+f[7]*d;a[8]=b[8]+f[8]*
d;return a};b.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]&&a[6]===b[6]&&a[7]===b[7]&&a[8]===b[8]};b.equals=function(a,b){var f=a[0],d=a[1],c=a[2],e=a[3],h=a[4],g=a[5],n=a[6],k=a[7];a=a[8];var q=b[0],v=b[1],t=b[2],w=b[3],r=b[4],y=b[5],A=b[6],z=b[7];b=b[8];return Math.abs(f-q)<=l.EPSILON*Math.max(1,Math.abs(f),Math.abs(q))&&Math.abs(d-v)<=l.EPSILON*Math.max(1,Math.abs(d),Math.abs(v))&&Math.abs(c-t)<=l.EPSILON*Math.max(1,Math.abs(c),Math.abs(t))&&
Math.abs(e-w)<=l.EPSILON*Math.max(1,Math.abs(e),Math.abs(w))&&Math.abs(h-r)<=l.EPSILON*Math.max(1,Math.abs(h),Math.abs(r))&&Math.abs(g-y)<=l.EPSILON*Math.max(1,Math.abs(g),Math.abs(y))&&Math.abs(n-A)<=l.EPSILON*Math.max(1,Math.abs(n),Math.abs(A))&&Math.abs(k-z)<=l.EPSILON*Math.max(1,Math.abs(k),Math.abs(z))&&Math.abs(a-b)<=l.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))};b.mul=k;b.sub=f})},"esri/core/libs/gl-matrix-2/mat3f32":function(){define(["require","exports","./factories/mat3f32"],function(g,
b,l){Object.defineProperty(b,"__esModule",{value:!0});b.mat3f32=l})},"esri/core/libs/gl-matrix-2/factories/mat3f32":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});b.create=function(){var b=new Float32Array(9);b[0]=1;b[4]=1;b[8]=1;return b};b.clone=function(b){var g=new Float32Array(9);g[0]=b[0];g[1]=b[1];g[2]=b[2];g[3]=b[3];g[4]=b[4];g[5]=b[5];g[6]=b[6];g[7]=b[7];g[8]=b[8];return g};b.fromValues=function(b,g,f,a,q,m,d,c,e){var h=new Float32Array(9);
h[0]=b;h[1]=g;h[2]=f;h[3]=a;h[4]=q;h[5]=m;h[6]=d;h[7]=c;h[8]=e;return h};b.createView=function(b,g){return new Float32Array(b,g,9)}})},"esri/core/libs/gl-matrix-2/vec2f32":function(){define(["require","exports","./factories/vec2f32"],function(g,b,l){Object.defineProperty(b,"__esModule",{value:!0});b.vec2f32=l})},"esri/core/libs/gl-matrix-2/factories/vec2f32":function(){define(["require","exports"],function(g,b){function l(){return new Float32Array(2)}function k(a,b){var c=new Float32Array(2);c[0]=
a;c[1]=b;return c}function f(){return k(1,1)}function a(){return k(1,0)}function q(){return k(0,1)}Object.defineProperty(b,"__esModule",{value:!0});b.create=l;b.clone=function(a){var b=new Float32Array(2);b[0]=a[0];b[1]=a[1];return b};b.fromValues=k;b.createView=function(a,b){return new Float32Array(a,b,2)};b.zeros=function(){return l()};b.ones=f;b.unitX=a;b.unitY=q;b.ZEROS=l();b.ONES=f();b.UNIT_X=a();b.UNIT_Y=q()})},"esri/core/libs/gl-matrix-2/types/vec2":function(){define(["require","exports"],
function(g,b){function l(b){return b instanceof Float32Array&&2<=b.length}function k(b){return Array.isArray(b)&&2<=b.length}Object.defineProperty(b,"__esModule",{value:!0});b.isVec2f32=l;b.isVec2f64=k;b.isVec2=function(b){return l(b)||k(b)}})},"esri/views/2d/tiling":function(){define("require exports ./tiling/TileInfoView ./tiling/TileKey ./tiling/TileQueue ./tiling/TileStrategy".split(" "),function(g,b,l,k,f,a){Object.defineProperty(b,"__esModule",{value:!0});b.TileInfoView=l;b.TileKey=k;b.TileQueue=
f;b.TileStrategy=a})},"esri/views/2d/tiling/TileInfoView":function(){define("require exports ../../../geometry/support/spatialReferenceUtils ./LODInfo ./TileCoverage ./TileKey ./TileSpan".split(" "),function(g,b,l,k,f,a,q){var m=new a("0/0/0/0"),d=function(){function a(a,b,c,e,d,f,g,k){this.x=a;this.ymin=b;this.ymax=c;this.invM=e;this.leftAdjust=d;this.rightAdjust=f;this.leftBound=g;this.rightBound=k}a.create=function(b,c){var e;b[1]>c[1]&&(e=[c,b],b=e[0],c=e[1]);e=b[0];b=b[1];var d=c[0];c=c[1];var f=
d-e,h=c-b,h=0!==h?f/h:0,g=(Math.ceil(b)-b)*h,k=(Math.floor(b)-b)*h;return new a(e,Math.floor(b),Math.ceil(c),h,0>f?g:k,0>f?k:g,0>f?d:e,0>f?e:d)};a.prototype.incrRow=function(){this.x+=this.invM};a.prototype.getLeftCol=function(){return Math.max(this.x+this.leftAdjust,this.leftBound)};a.prototype.getRightCol=function(){return Math.min(this.x+this.rightAdjust,this.rightBound)};return a}(),c=[[0,0],[0,0],[0,0],[0,0]];return function(){function a(a,b){var c=this;this.tileInfo=a;this.fullExtent=b;this.scales=
[];this._lodInfos=null;this._infoByScale={};this._infoByLevel={};var e=a.lods.slice();e.sort(function(a,b){return b.scale-a.scale});var d=this._lodInfos=e.map(function(c){return k.create(a,c,b)});e.forEach(function(a,b){c._infoByLevel[a.level]=d[b];c._infoByScale[a.scale]=d[b];c.scales[b]=a.scale},this);this._wrap=a.isWrappable}Object.defineProperty(a.prototype,"spatialReference",{get:function(){return this.tileInfo.spatialReference},enumerable:!0,configurable:!0});a.prototype.getLODInfoAt=function(a){return this._infoByLevel["number"===
typeof a?a:a.level]};a.prototype.getTileBounds=function(a,b,c){void 0===c&&(c=!1);m.set(b);return(b=this._infoByLevel[m.level])?b.getTileBounds(a,m,c):a};a.prototype.getTileCoords=function(a,b,c){void 0===c&&(c=!1);m.set(b);return(b=this._infoByLevel[m.level])?b.getTileCoords(a,m,c):a};a.prototype.getTileCoverage=function(a,b,e){void 0===b&&(b=192);void 0===e&&(e="closest");e="closest"===e?this.getClosestInfoForScale(a.scale):this.getSmallestInfoForScale(a.scale);var h=f.pool.acquire(e),g=this._wrap,
n;n=Infinity;var k=-Infinity,m,l,p=h.spans;c[0][0]=c[0][1]=c[1][1]=c[3][0]=-b;c[1][0]=c[2][0]=a.size[0]+b;c[2][1]=c[3][1]=a.size[1]+b;for(b=0;b<c.length;b++){var A=c[b];a.toMap(A,A);A[0]=e.getColumnForX(A[0]);A[1]=e.getRowForY(A[1])}a=[];A=3;for(b=0;4>b;b++){if(c[b][1]!==c[A][1]){var z=d.create(c[b],c[A]);n=Math.min(z.ymin,n);k=Math.max(z.ymax,k);void 0===a[z.ymin]&&(a[z.ymin]=[]);a[z.ymin].push(z)}A=b}if(null==n||null==k||100<k-n)return null;for(A=[];n<k;){null!=a[n]&&(A=A.concat(a[n]));m=Infinity;
l=-Infinity;for(b=A.length-1;0<=b;b--)z=A[b],m=Math.min(m,z.getLeftCol()),l=Math.max(l,z.getRightCol());m=Math.floor(m);l=Math.floor(l);if(n>=e.first[1]&&n<=e.last[1])if(g)if(e.size[0]<e.worldSize[0])for(z=Math.floor(l/e.worldSize[0]),b=Math.floor(m/e.worldSize[0]);b<=z;b++)p.push(new q(n,Math.max(e.getFirstColumnForWorld(b),m),Math.min(e.getLastColumnForWorld(b),l)));else p.push(new q(n,m,l));else m>e.last[0]||l<e.first[0]||(m=Math.max(m,e.first[0]),l=Math.min(l,e.last[0]),p.push(new q(n,m,l)));
n+=1;for(b=A.length-1;0<=b;b--)z=A[b],z.ymax>=n?z.incrRow():A.splice(b,1)}return h};a.prototype.getTileParentId=function(a){m.set(a);a=this._lodInfos.indexOf(this._infoByLevel[m.level])-1;if(0>a)return null;this._getTileIdAtLOD(m,this._lodInfos[a],m);return m.id};a.prototype.getTileResolution=function(a){return(a=this._infoByLevel["object"===typeof a?a.level:a])?a.resolution:-1};a.prototype.getTileScale=function(a){return(a=this._infoByLevel[a.level])?a.scale:-1};a.prototype.intersects=function(a,
b){m.set(b);b=this._infoByLevel[m.level];var c=a.lodInfo;if(c.resolution>b.resolution){this._getTileIdAtLOD(m,c,m);for(var e=c.denormalizeCol(m.col,m.world),d=0,f=a.spans;d<f.length;d++){var h=f[d];if(h.row===m.row&&h.colFrom<=e&&h.colTo>=e)return!0}}if(c.resolution<b.resolution){f=a.spans.reduce(function(a,b){a[0]=Math.min(a[0],b.row);a[1]=Math.max(a[1],b.row);a[2]=Math.min(a[2],b.colFrom);a[3]=Math.max(a[3],b.colTo);return a},[Infinity,-Infinity,Infinity,-Infinity]);a=f[0];var e=f[1],d=f[2],f=f[3],
g=b.denormalizeCol(m.col,m.world),h=c.getColumnForX(b.getXForColumn(g)),k=c.getRowForY(b.getYForRow(m.row)),g=c.getColumnForX(b.getXForColumn(g+1))-1;b=c.getRowForY(b.getYForRow(m.row+1))-1;return!(h>f||g<d||k>e||b<a)}var l=c.denormalizeCol(m.col,m.world);return a.spans.some(function(a){return a.row===m.row&&a.colFrom<=l&&a.colTo>=l})};a.prototype.normalizeBounds=function(a,b,c){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];this._wrap&&(b=l.getInfo(this.tileInfo.spatialReference),c=-c*(b.valid[1]-b.valid[0]),
a[0]+=c,a[2]+=c);return a};a.prototype.getSmallestInfoForScale=function(a){var b=this.scales;if(this._infoByScale[a])return this._infoByScale[a];if(a>b[0])return this._infoByScale[b[0]];for(var c=1;c<b.length-1;c++)if(a>b[c]+1E-6)return this._infoByScale[b[c-1]];return this._infoByScale[b[b.length-1]]};a.prototype.getClosestInfoForScale=function(a){var b=this.scales;if(this._infoByScale[a])return this._infoByScale[a];a=b.reduce(function(b,c){return Math.abs(c-a)<Math.abs(b-a)?c:b},b[0]);return this._infoByScale[a]};
a.prototype.scaleToLevel=function(a){var b=this.scales;if(this._infoByScale[a])return this._infoByScale[a].level;for(var c=b.length-1;0<=c;c--)if(a<b[c])return c===b.length-1?this._infoByScale[b[b.length-1]].level:this._infoByScale[b[c]].level+(b[c]-a)/(b[c]-b[c+1]);return this._infoByScale[b[0]].level};a.prototype.scaleToZoom=function(a){return this.tileInfo.scaleToZoom(a)};a.prototype._getTileIdAtLOD=function(a,b,c){var e=this._infoByLevel[c.level];a.set(c);if(b.resolution<e.resolution)return null;
if(b.resolution===e.resolution)return a;a.level=b.level;a.col=Math.floor(c.col*e.resolution/b.resolution+.01);a.row=Math.floor(c.row*e.resolution/b.resolution+.01);return a};return a}()})},"esri/views/2d/tiling/LODInfo":function(){define(["require","exports","../../../geometry/support/spatialReferenceUtils","./TileKey"],function(g,b,l,k){function f(a,b,d){a[0]=b;a[1]=d;return a}var a=new k("0/0/0/0");return function(){function b(a,b,c,e,f,g,n,k,l,q,t,w){this.level=a;this.resolution=b;this.scale=c;
this.origin=e;this.first=f;this.last=g;this.size=n;this.norm=k;this.worldStart=l;this.worldEnd=q;this.worldSize=t;this.wrap=w}b.create=function(a,d,c){var e=l.getInfo(a.spatialReference),h=[a.origin.x,a.origin.y],g=[a.size[0]*d.resolution,a.size[1]*d.resolution],n=[-Infinity,-Infinity],k=[Infinity,Infinity],m=[Infinity,Infinity];c&&(f(n,Math.max(0,Math.floor((c.xmin-h[0])/g[0])),Math.max(0,Math.floor((h[1]-c.ymax)/g[1]))),f(k,Math.max(0,Math.floor((c.xmax-h[0])/g[0])),Math.max(0,Math.floor((h[1]-
c.ymin)/g[1]))),f(m,k[0]-n[0]+1,k[1]-n[1]+1));var q;a.isWrappable?(a=[Math.ceil(Math.round(2*e.origin[1]/d.resolution)/a.size[0]),m[1]],e=[Math.floor((e.origin[0]-h[0])/g[0]),n[1]],c=[a[0]+e[0]-1,k[1]],q=!0):(e=n,c=k,a=m,q=!1);return new b(d.level,d.resolution,d.scale,h,n,k,m,g,e,c,a,q)};b.prototype.normalizeCol=function(a){if(!this.wrap)return a;var b=this.worldSize[0];return 0>a?b-1-Math.abs((a+1)%b):a%b};b.prototype.denormalizeCol=function(a,b){return this.wrap?this.worldSize[0]*b+a:a};b.prototype.getWorldForColumn=
function(a){return this.wrap?Math.floor(a/this.worldSize[0]):0};b.prototype.getFirstColumnForWorld=function(a){return a*this.worldSize[0]+this.first[0]};b.prototype.getLastColumnForWorld=function(a){return a*this.worldSize[0]+this.first[0]+this.size[0]-1};b.prototype.getColumnForX=function(a){return(a-this.origin[0])/this.norm[0]};b.prototype.getXForColumn=function(a){return this.origin[0]+a*this.norm[0]};b.prototype.getRowForY=function(a){return(this.origin[1]-a)/this.norm[1]};b.prototype.getYForRow=
function(a){return this.origin[1]-a*this.norm[1]};b.prototype.getTileBounds=function(b,d,c){void 0===c&&(c=!1);a.set(d);var e=c?a.col:this.denormalizeCol(a.col,a.world),f=a.row;d=this.getXForColumn(e);c=this.getYForRow(f+1);e=this.getXForColumn(e+1);f=this.getYForRow(f);b[0]=d;b[1]=c;b[2]=e;b[3]=f;return b};b.prototype.getTileCoords=function(b,d,c){void 0===c&&(c=!1);a.set(d);d=c?a.col:this.denormalizeCol(a.col,a.world);Array.isArray(b)?f(b,this.getXForColumn(d),this.getYForRow(a.row)):(b.x=this.getXForColumn(d),
b.y=this.getYForRow(a.row));return b};return b}()})},"esri/views/2d/tiling/TileKey":function(){define(["require","exports","../../../core/ObjectPool"],function(g,b,l){return function(){function b(b,a,g,k){this.set(b,a,g,k)}b.getId=function(b,a,g,k){return"object"===typeof b?b.level+"/"+b.row+"/"+b.col+"/"+b.world:b+"/"+a+"/"+g+"/"+k};Object.defineProperty(b.prototype,"key",{get:function(){return this},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"id",{get:function(){return this.toString()},
enumerable:!0,configurable:!0});b.prototype.equals=function(b){return this.level===b.level&&this.row===b.row&&this.col===b.col&&this.world===b.world};b.prototype.release=function(){this.world=this.col=this.row=this.level=0};b.prototype.set=function(b,a,g,k){null==b?this.world=this.col=this.row=this.level=0:"object"===typeof b?(this.level=b.level||0,this.row=b.row||0,this.col=b.col||0,this.world=b.world||0):"string"===typeof b?(b=b.split("/"),a=b[1],g=b[2],k=b[3],this.level=parseFloat(b[0]),this.row=
parseFloat(a),this.col=parseFloat(g),this.world=parseFloat(k)):(this.level=+b,this.row=+a,this.col=+g,this.world=+k||0);return this};b.prototype.toString=function(){return this.level+"/"+this.row+"/"+this.col+"/"+this.world};b.prototype.getChildKeys=function(){var f=this.level+1,a=this.row<<1,g=this.col<<1,k=this.world;return[new b(f,a,g,k),new b(f,a,g+1,k),new b(f,a+1,g,k),new b(f,a+1,g+1,k)]};b.prototype.compareRowMajor=function(b){return this.row<b.row?-1:this.row>b.row?1:this.col<b.col?-1:this.col>
b.col?1:0};b.pool=new l(b,!0,null,25,50);return b}()})},"esri/views/2d/tiling/TileCoverage":function(){define(["require","exports","../../../core/ObjectPool"],function(g,b,l){return function(){function b(b){this.lodInfo=b;this.spans=[]}b.prototype.release=function(){};b.prototype.forEach=function(b,a){var f=this.spans,g=this.lodInfo,d=g.level;if(0!==f.length)for(var c=0;c<f.length;c++)for(var e=f[c],h=e.row,k=e.colTo,e=e.colFrom;e<=k;e++)b.call(a,d,h,g.normalizeCol(e),g.getWorldForColumn(e))};b.pool=
new l(b,!0);return b}()})},"esri/views/2d/tiling/TileSpan":function(){define(["require","exports","../../../core/ObjectPool"],function(g,b,l){return function(){function b(b,a,g){this.row=b;this.colFrom=a;this.colTo=g}b.pool=new l(b,!0);return b}()})},"esri/views/2d/tiling/TileQueue":function(){define("require exports ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/Accessor ../../../core/SetUtils ../../../core/accessorSupport/decorators ../../../core/libs/gl-matrix-2/vec2 ../../support/QueueProcessor".split(" "),
function(g,b,l,k,f,a,q,m,d){function c(a,b){a.length=0;b.forEach(function(b){return a.push(b)});return a}var e=new Set,h=[],p=new Map,n=[0,0];return function(b){function f(a){a=b.call(this,a)||this;a._keyToItem=new Map;a.concurrency=6;a.strategy="scale-first";a.tileInfoView=null;return a}k(f,b);f.prototype.initialize=function(){var a=this,b=this.process;this._queue=new d.QueueProcessor({concurrency:this.concurrency,process:function(c,e){c=a._keyToItem.get(c);return b(c,{signal:e})},peeker:"scale-first"===
this.strategy?function(b){return a._peekByScaleFirst(b)}:function(b){return a._peekByCenterFirst(b)}})};f.prototype.destroy=function(){this.clear();this._queue.destroy();this._queue=null};Object.defineProperty(f.prototype,"length",{get:function(){return this._queue?this._queue.length:0},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"onGoingCount",{get:function(){return this._keyToItem.size},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"updating",{get:function(){return 0<
this.length||0<this.onGoingCount},enumerable:!0,configurable:!0});f.prototype.abort=function(a){this._queue.abort("string"===typeof a?a:a.id)};f.prototype.clear=function(){this._queue.clear();this._keyToItem.clear();this.notifyChange("updating")};f.prototype.has=function(a){return"string"===typeof a?this._keyToItem.has(a):this._keyToItem.has(a.id)};f.prototype.isOngoing=function(a){a="string"===typeof a?a:a.id;return this.has(a)&&this._queue.isOngoing(a)};f.prototype.pause=function(){this._queue.pause()};
f.prototype.push=function(a){var b=this,c=a.key.id;if(this.has(c))return this.get(c);var e=this._queue.push(c),d=function(){b._keyToItem.delete(c);b.notifyChange("updating")};this._keyToItem.set(c,a);e.then(d,d);this.notifyChange("updating");return e};f.prototype.reset=function(){this._queue.reset();this.notifyChange("updating")};f.prototype.resume=function(){this._queue.resume()};f.prototype._peekByScaleFirst=function(b){var d=this;if(!this.state)return a.firstOfSet(b);var f=this.tileInfoView,g=
Number.NEGATIVE_INFINITY,n=Number.POSITIVE_INFINITY;b.forEach(function(a){a=d._keyToItem.get(a);var b=d.tileInfoView.getTileScale(a.key);p.has(b)||(p.set(b,[]),g=Math.max(b,g),n=Math.min(b,n));p.get(b).push(a.key);e.add(b)});var k=this.state.scale;p.has(k)||(c(h,e),h.sort(),k=h.reduce(function(a,b){return Math.abs(b-k)<Math.abs(a-k)?b:a},h[0]));k=Math.min(k,g);k=Math.max(k,n);b=p.get(k);var m=f.getClosestInfoForScale(k),l=m.getColumnForX(this.state.center[0]),q=m.getRowForY(this.state.center[1]);
b.sort(function(a,b){var c=m.denormalizeCol(a.col,a.world),e=m.denormalizeCol(b.col,b.world);return Math.sqrt((l-c)*(l-c)+(q-a.row)*(q-a.row))-Math.sqrt((l-e)*(l-e)+(q-b.row)*(q-b.row))});e.clear();p.clear();return b[0].id};f.prototype._peekByCenterFirst=function(b){var c=this;if(!this.state)return a.firstOfSet(b);var e=this.tileInfoView,d=this.state.center,f=Number.POSITIVE_INFINITY,h=null;b.forEach(function(a){a=c._keyToItem.get(a);e.getTileCoords(n,a.key);var b=m.vec2.distance(n,d);b<f&&(f=b,h=
a.key)});return h.id};l([q.property({constructOnly:!0})],f.prototype,"concurrency",void 0);l([q.property({constructOnly:!0})],f.prototype,"process",void 0);l([q.property()],f.prototype,"state",void 0);l([q.property({constructOnly:!0})],f.prototype,"strategy",void 0);l([q.property({constructOnly:!0})],f.prototype,"tileInfoView",void 0);l([q.property({readOnly:!0})],f.prototype,"updating",null);return f=l([q.subclass("esri.views.2d.tiling.TileQueue")],f)}(q.declared(f))})},"esri/views/support/QueueProcessor":function(){define("require exports ../../core/maybe ../../core/promiseUtils ../../core/Queue ../../core/scheduling".split(" "),
function(g,b,l,k,f,a){Object.defineProperty(b,"__esModule",{value:!0});var q=function(){return function(a,b){this.item=a;this.controller=b;this.promise=null}}();g=function(){function b(a){var b=this;this._deferreds=new Map;this._controllers=new Map;this._processingItems=new Map;this._isPaused=!1;this._task=this._schedule=null;this.concurrency=1;a.concurrency&&(this.concurrency=a.concurrency);this._queue=new f.default(a.peeker);this.process=a.process;var e=a.scheduler;a.task&&l.isSome(e)&&(this._task=
e.registerTask(a.task,function(a){return b.update(a)},function(){return b.needsUpdate()}))}b.prototype.destroy=function(){this.clear();this._schedule&&(this._schedule.remove(),this._schedule=null);this._task&&(this._task.remove(),this._task=null)};Object.defineProperty(b.prototype,"length",{get:function(){return this._processingItems.size+this._queue.length},enumerable:!0,configurable:!0});b.prototype.abort=function(a){(a=this._controllers.get(a))&&a.abort()};b.prototype.clear=function(){this._queue.clear();
var a=[];this._controllers.forEach(function(b){return a.push(b)});this._controllers.clear();a.forEach(function(a){return a.abort()});this._processingItems.clear();this._cancelNext()};b.prototype.get=function(a){return(a=this._deferreds.get(a))?a.promise:void 0};b.prototype.isOngoing=function(a){return this._processingItems.has(a)};b.prototype.has=function(a){return this._deferreds.has(a)};b.prototype.pause=function(){this._isPaused||(this._isPaused=!0,this._cancelNext())};b.prototype.push=function(a){var b=
this,e=this.get(a);if(e)return e;var d,e=k.createAbortController(),f=function(){g.remove();b._deferreds.delete(a);b._controllers.delete(a);b._queue.remove(a);b._processingItems.delete(a);b._scheduleNext()},g=k.onAbortOrThrow(e.signal,function(){var c=b._processingItems.get(a);c&&c.controller.abort();f();d.reject(k.createAbortError())});d=k.createDeferred();this._deferreds.set(a,d);this._controllers.set(a,e);d.promise.then(f,f);this._queue.push(a);this._scheduleNext();return d.promise};b.prototype.reset=
function(){var a=[];this._processingItems.forEach(function(b){return a.push(b)});this._processingItems.clear();for(var b=0;b<a.length;b++){var e=a[b];this._queue.push(e.item);e.controller.abort()}this._scheduleNext()};b.prototype.resume=function(){this._isPaused&&(this._isPaused=!1,this._scheduleNext())};b.prototype.needsUpdate=function(){return!this._isPaused&&0<this._queue.length&&this._processingItems.size<this.concurrency};b.prototype.update=function(a){for(;!a.done&&0<this._queue.length&&this._processingItems.size<
this.concurrency;)this._process(this._queue.pop()),a.madeProgress()};b.prototype._scheduleNext=function(){var b=this;this._task||this._isPaused||this._schedule||(this._schedule=a.schedule(function(){b._schedule=null;b._next()}))};b.prototype._next=function(){for(;0<this._queue.length&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())};b.prototype._cancelNext=function(){this._schedule&&(this._schedule.remove(),this._schedule=null)};b.prototype._processResult=function(a,
b){this._canProcessFulfillment(a)&&(this._scheduleNext(),this._deferreds.get(a.item).resolve(b))};b.prototype._processError=function(a,b){this._canProcessFulfillment(a)&&(this._scheduleNext(),this._deferreds.get(a.item).reject(b))};b.prototype._canProcessFulfillment=function(a){return this._deferreds.get(a.item)&&this._processingItems.get(a.item)===a?!0:!1};b.prototype._process=function(a){var b=this;if(!l.isNone(a)){var e,d=k.createAbortController(),f=new q(a,d);this._processingItems.set(a,f);try{e=
this.process(a,d.signal)}catch(n){this._processError(f,n)}e&&"function"===typeof e.then?(f.promise=e,e.then(function(a){return b._processResult(f,a)},function(a){return b._processError(f,a)})):this._processResult(f,e)}};Object.defineProperty(b.prototype,"test",{get:function(){var a=this;return{update:function(b){return a.update(b)}}},enumerable:!0,configurable:!0});return b}();b.QueueProcessor=g})},"esri/core/Queue":function(){define(["require","exports","./SetUtils"],function(g,b,l){Object.defineProperty(b,
"__esModule",{value:!0});g=function(){function b(b){void 0===b&&(b=function(a){return l.firstOfSet(a)});this._peeker=b;this._items=new Set}Object.defineProperty(b.prototype,"length",{get:function(){return this._items.size},enumerable:!0,configurable:!0});b.prototype.clear=function(){this._items.clear()};b.prototype.peek=function(){if(0!==this._items.size)return this._peeker(this._items)};b.prototype.push=function(b){this.contains(b)||this._items.add(b)};b.prototype.contains=function(b){return this._items.has(b)};
b.prototype.pop=function(){if(0!==this.length){var b=this.peek();this._items.delete(b);return b}};b.prototype.remove=function(b){this._items.delete(b)};return b}();b.default=g})},"esri/views/2d/tiling/TileStrategy":function(){define("require exports ../../../core/tsSupport/extendsHelper ./TileCache ./TileCoverage ./TileKey".split(" "),function(g,b,l,k,f,a){var q=new a(0,0,0,0),m=new Map,d=[],c=[];return function(){function a(a){var b=this;this._previousScale=Number.POSITIVE_INFINITY;this.cachePolicy=
"keep";this.coveragePolicy="closest";this.resampling=!0;this.tileIndex=new Map;this.tiles=[];this.buffer=192;this.acquireTile=a.acquireTile;this.releaseTile=a.releaseTile;this.tileInfoView=a.tileInfoView;this.resampling=null==a.resampling||!!a.resampling;a.cachePolicy&&(this.cachePolicy=a.cachePolicy);a.coveragePolicy&&(this.coveragePolicy=a.coveragePolicy);null!=a.buffer&&(this.buffer=a.buffer);a.cacheSize&&(this._tileCache=new k.default(a.cacheSize,this.tileInfoView,function(a){b.releaseTile(a)}))}
a.prototype.destroy=function(){this.tileIndex.clear()};a.prototype.update=function(a){var b=this,e=this.resampling,h=this.tileIndex,g=this.tileInfoView.getTileCoverage(a.state,this.buffer,this.coveragePolicy);c.length=0;d.length=0;m.clear();if(g){var k=this.tileInfoView.tileInfo,l=k.minScale,w=k.maxScale,r=g.spans,y=g.lodInfo,A=y.level,z=a.state,B=z.scale,k=z.center,z=z.resolution,C=!a.stationary&&B>this._previousScale;this._previousScale=B;this.tiles.length=0;if(!e&&(B>l||B<w))return this.tiles.length=
0,m.clear(),h.forEach(function(a){b.releaseTile(a)}),h.clear(),c.length=0,d.length=0,m.clear(),f.pool.release(g),!0;h.forEach(function(a){return a.visible=!0});w=l=0;if(0<r.length)for(B=0;B<r.length;B++){a=r[B];for(var D=a.row,H=a.colTo,F=a.colFrom;F<=H;F++)if(l++,a=q.set(A,D,y.normalizeCol(F),y.getWorldForColumn(F)).id,h.has(a))e=h.get(a),e.isReady?(m.set(a,e),w++):C||this._addParentTile(a,m);else{e=void 0;if(this._tileCache&&this._tileCache.has(a)){if(e=this._tileCache.pop(a),this.tileIndex.set(a,
e),e.isReady){m.set(a,e);w++;continue}}else e=this.acquireTile(q),this.tileIndex.set(a,e);C||this._addParentTile(a,m)}}var E=w===l;h.forEach(function(a,e){q.set(e);if(!m.has(e)){var f=b.tileInfoView.intersects(g,q);!f||!C&&E?"purge"===b.cachePolicy?q.level===A&&f||d.push(e):(q.level>A||!f)&&d.push(e):a.isReady?c.push(e):q.level>A&&d.push(e)}});for(r=0;r<c.length;r++)a=c[r],(e=h.get(a))&&e.isReady&&m.set(a,e);for(r=0;r<d.length;r++)a=d[r],e=h.get(a),this._tileCache?this._tileCache.add(e):this.releaseTile(e),
h["delete"](a);m.forEach(function(a){return b.tiles.push(a)});h.forEach(function(a){m.has(a.key.id)||(a.visible=!1)});this._tileCache&&this._tileCache.prune(A,k,z);f.pool.release(g);return E}};a.prototype.clear=function(a){var b=this;void 0===a&&(a=!0);var c=this.tileIndex;a&&c.forEach(function(a){b.releaseTile(a)});c.clear()};a.prototype._addParentTile=function(a,b){for(var c=null;;){a=this.tileInfoView.getTileParentId(a);if(!a)break;if(this.tileIndex.has(a)){if((c=this.tileIndex.get(a))&&c.isReady){b.has(c.key.id)||
b.set(c.key.id,c);break}}else if(this._tileCache&&this._tileCache.has(a)&&(c=this._tileCache.pop(a),this.tileIndex.set(a,c),c&&c.isReady)){b.has(c.key.id)||b.set(c.key.id,c);break}}};return a}()})},"esri/views/2d/tiling/TileCache":function(){define(["require","exports","../../../core/libs/gl-matrix-2/vec2"],function(g,b,l){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(b,a,g){this.maxSize=b;this.tileInfoView=a;this.removedFunc=g;this._tilePerId=new Map;this._tileKeysPerLevel=
[]}b.prototype.has=function(b){return this._tilePerId.has(b)};b.prototype.get=function(b){return this._tilePerId.get(b)};b.prototype.pop=function(b){var a=this._tilePerId.get(b);if(!a)return null;var f=this._tileKeysPerLevel[a.key.level];this._tilePerId["delete"](b);for(var g=0;g<f.length;g++)if(f[g].id===b){f.splice(g,1);break}a.visible=!0;return a};b.prototype.add=function(b){b.visible=!1;var a=b.key,f=a.id;this._tilePerId.has(f)||(this._tilePerId.set(f,b),b=a.level,this._tileKeysPerLevel[b]||(this._tileKeysPerLevel[b]=
[]),this._tileKeysPerLevel[b].push(a))};b.prototype.prune=function(b,a,g){var f=this._tilePerId.size;if(!(f<=this.maxSize)){for(var d=this._tileKeysPerLevel.length-1;f>this.maxSize&&0<=d;)d!==b&&(f=this._pruneAroundCenterTile(f,a,g,d)),d--;f>this.maxSize&&(f=this._pruneAroundCenterTile(f,a,g,b))}};b.prototype._pruneAroundCenterTile=function(b,a,g,k){k=this._tileKeysPerLevel[k];if(!k||0===k.length)return b;var d=this.tileInfoView.tileInfo,c=d.size,e=d.origin,f=g*c[0],m=g*c[1],n=[0,0],q=[0,0];for(k.sort(function(b,
c){n[0]=e.x+f*(b.col+.5);n[1]=e.y-m*(b.row+.5);q[0]=e.x+f*(c.col+.5);q[1]=e.y-m*(c.row+.5);return l.vec2.squaredDistance(n,a)-l.vec2.squaredDistance(q,a)});0<k.length&&(g=k.pop(),this._removeTile(g.id),b--,b!==this.maxSize););return b};b.prototype._removeTile=function(b){var a=this._tilePerId.get(b);this.removedFunc&&this.removedFunc(a);this._tilePerId["delete"](b)};return b}();b.default=g})},"esri/views/2d/support/Timeline":function(){define(["require","exports","../../../core/tsSupport/decorateHelper",
"../../../core/tsSupport/declareExtendsHelper","../../../core/accessorSupport/decorators"],function(g,b,l,k,f){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function a(){this._names=new Map}a.prototype.begin=function(a){this._names.has(a)||(this._names.set(a,!1),-1!==a.indexOf("Brush")&&this.record("Esri.FirstDraw"),performance.mark("Esri."+a+".Start"))};a.prototype.end=function(a){this._names.has(a)&&!this._names.get(a)&&(this._names.set(a,!0),performance.mark("Esri."+a+".End"))};
a.prototype.record=function(a){this._names.has(a)||(this._names.set(a,!0),performance.mark("Esri."+a))};return a=l([f.subclass("esri.views.2d.support.Timeline")],a)}();b.Timeline=g})},"esri/views/2d/input/MapViewInputManager":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/Accessor ../../../core/Handles ../../../core/watchUtils ../../../core/accessorSupport/decorators ./handlers/DoubleClickZoom ./handlers/DoubleTapDragZoom ./handlers/DragPan ./handlers/DragRotate ./handlers/GamepadNavigation ./handlers/KeyPan ./handlers/KeyRotate ./handlers/KeyZoom ./handlers/MouseWheelZoom ./handlers/PinchAction ../../input/BrowserEventSource ../../input/InputManager ../../input/handlers/PreventContextMenu ../../input/recognizers/DoubleTapDrag ../../input/recognizers/Drag ../../input/recognizers/ImmediateDoubleClick ../../input/recognizers/PointerClickHoldAndDrag ../../input/recognizers/SingleAndDoubleClick".split(" "),
function(g,b,l,k,f,a,q,m,d,c,e,h,p,n,u,x,v,t,w,r,y,A,z,B,C,D){var H={left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},F={zoomIn:["\x3d","+"],zoomOut:["-","_"]},E={clockwiseOption1:"a",clockwiseOption2:"A",counterClockwiseOption1:"d",counterClockwiseOption2:"D",resetOption1:"n",resetOption2:"N"};return function(b){function f(){var c=null!==b&&b.apply(this,arguments)||this;c._handles=new a;return c}l(f,b);f.prototype.initialize=function(){var a=this;this._handles.add([q.whenNot(this.view,
"ready",function(){return a._disconnect()}),q.when(this.view,"ready",function(){return a._connect()})])};f.prototype.destroy=function(){this._handles&&(this._handles.removeAll(),this._handles=null);this._disconnect()};f.prototype._disconnect=function(){this._inputManager&&(this.view.viewEvents.disconnect(),this._inputManager.destroy(),this._inputManager=null,this._source.destroy(),this._source=null)};f.prototype._connect=function(){var a=this,b=new w.BrowserEventSource(this.view.surface,this.view.input),
f=[new B.ImmediateDoubleClick,new C.PointerClickHoldAndDrag,new D.SingleAndDoubleClick,new z.Drag(this.view.navigation),new A.DoubleTapDrag],f=new r.InputManager({eventSource:b,recognizers:f});f.installHandlers("prevent-context-menu",[new y.PreventContextMenu],r.ViewEventPriorities.INTERNAL);f.installHandlers("navigation",[new t.PinchRotateAndZoom(this.view),new p.GamepadNavigation(this.view),new v.MouseWheelZoom(this.view),new d.DoubleClickZoom(this.view),new d.DoubleClickZoom(this.view,["Ctrl"]),
new e.DragPan(this.view,"primary"),new n.KeyPan(this.view,H),new x.KeyZoom(this.view,F),new u.KeyRotate(this.view,E),new h.DragRotate(this.view,"secondary"),new c.DoubleTapDragZoom(this.view,"touch")],r.ViewEventPriorities.INTERNAL);this.view.viewEvents.connect(f);this._source=b;this._inputManager=f;q.init(this.view.navigation,"browserTouchPanEnabled",function(b){a._source.browserTouchPanningEnabled=!b})};Object.defineProperty(f.prototype,"test",{get:function(){return{inputManager:this._inputManager}},
enumerable:!0,configurable:!0});k([m.property()],f.prototype,"view",void 0);return f=k([m.subclass("esri.views.2d.input.MapViewInputManager")],f)}(m.declared(f))})},"esri/views/2d/input/handlers/DoubleClickZoom":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler","../../../input/handlers/support"],function(g,b,l,k,f){Object.defineProperty(b,"__esModule",{value:!0});g=function(a){function b(b,d){var c=a.call(this,!0)||this;c.view=b;c.registerIncoming("double-click",
d,function(a){return c._handleDoubleClick(a,d)});return c}l(b,a);b.prototype._handleDoubleClick=function(a,b){f.eventMatchesPointerAction(a.data,"primary")&&(a.stopPropagation(),b?this.view.mapViewNavigation.zoomOut([a.data.x,a.data.y]):this.view.mapViewNavigation.zoomIn([a.data.x,a.data.y]))};return b}(k.InputHandler);b.DoubleClickZoom=g})},"esri/views/input/handlers/support":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});b.eventMatchesPointerAction=
function(b,g){switch(g){case "primary":return"touch"===b.pointerType||0===b.button;case "secondary":return"touch"!==b.pointerType&&2===b.button;case "tertiary":return"touch"!==b.pointerType&&1===b.button}};b.eventMatchesMousePointerAction=function(b,g){if("touch"===b.pointerType)return!1;switch(g){case "primary":return 0===b.button;case "secondary":return 2===b.button;case "tertiary":return 1===b.button}}})},"esri/views/2d/input/handlers/DoubleTapDragZoom":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper",
"../../../../core/compilerUtils","../../../input/InputHandler"],function(g,b,l,k,f){Object.defineProperty(b,"__esModule",{value:!0});g=function(a){function b(b,d,c){var e=a.call(this,!0)||this;e.view=b;e.pointerType=d;e.registerIncoming("double-tap-drag",c,function(a){return e._handleDoubleTapDrag(a)});return e}l(b,a);b.prototype._handleDoubleTapDrag=function(a){var b=a.data;if(b.pointerType===this.pointerType){a.stopPropagation();var c=b.action;a=b.delta;var e=this.view,b=e.mapViewNavigation;switch(c){case "begin":this._currentScale=
this._startScale=c=e.scale;this._previousDelta=a;b.begin();break;case "update":if(this._previousDelta.y===a.y)break;this._previousDelta=a;a=this._startScale*Math.pow(1.015,a.y);b.setViewpointImmediate(a/this._currentScale);this._currentScale=a;break;case "end":c=e.constraints;e=c.effectiveLODs;if(!c.snapToZoom||!e){b.end();break}e=c.snapScale(this._currentScale);a=(0<a.y?Math.max(e,c.snapToPreviousScale(this._startScale)):Math.min(e,c.snapToNextScale(this._startScale)))/this._currentScale;b.zoom(a);
break;default:k.neverReached(c)}}};return b}(f.InputHandler);b.DoubleTapDragZoom=g})},"esri/views/2d/input/handlers/DragPan":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../input/DragEventSeparator ../../../input/InputHandler ../../../input/handlers/support".split(" "),function(g,b,l,k,f,a){Object.defineProperty(b,"__esModule",{value:!0});g=function(b){function f(d,c,e){var f=b.call(this,!0)||this;f.view=d;f.pointerAction=c;f.registerIncoming("drag",e,function(a){return f._handleDrag(a)});
f.registerIncoming("pointer-down",function(){return f.stopMomentumNavigation()});var g=f.view.mapViewNavigation;f.dragEventSeparator=new k.DragEventSeparator({start:function(a,b){g.pan.begin(f.view,b.data);b.stopPropagation()},update:function(a,b){g.pan.update(f.view,b.data);b.stopPropagation()},end:function(a,b){g.pan.end(f.view,b.data);b.stopPropagation()},condition:function(b,c){return 1===b&&a.eventMatchesPointerAction(c.data,f.pointerAction)}});return f}l(f,b);f.prototype._handleDrag=function(a){var b=
this.view.mapViewNavigation;b.pinch.zoomMomentum||b.pinch.rotateMomentum?this.stopMomentumNavigation():this.dragEventSeparator.handle(a)};f.prototype.stopMomentumNavigation=function(){this.view.mapViewNavigation.pan.stopMomentumNavigation()};return f}(f.InputHandler);b.DragPan=g})},"esri/views/input/DragEventSeparator":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(b){this.callbacks=b;this.currentCount=0;this.callbacks.condition||
(this.callbacks.condition=function(){return!0})}b.prototype.handle=function(b){var f=b.data,a=f.pointers.size;switch(f.action){case "start":this.currentCount=a;this.emitStart(b);break;case "added":this.emitEnd(this.previousEvent);this.currentCount=a;this.emitStart(b);break;case "update":this.emitUpdate(b);break;case "removed":this.startEvent&&this.emitEnd(this.previousEvent);this.currentCount=a;this.emitStart(b);break;case "end":this.emitEnd(b),this.currentCount=0}this.previousEvent=b};b.prototype.emitStart=
function(b){this.startEvent=b;this.callbacks.condition(this.currentCount,b)&&this.callbacks.start(this.currentCount,b,this.startEvent)};b.prototype.emitUpdate=function(b){this.callbacks.condition(this.currentCount,b)&&this.callbacks.update(this.currentCount,b,this.startEvent)};b.prototype.emitEnd=function(b){this.callbacks.condition(this.currentCount,b)&&this.callbacks.end(this.currentCount,b,this.startEvent);this.startEvent=null};return b}();b.DragEventSeparator=g})},"esri/views/2d/input/handlers/DragRotate":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../input/DragEventSeparator ../../../input/InputHandler ../../../input/handlers/support".split(" "),
function(g,b,l,k,f,a){Object.defineProperty(b,"__esModule",{value:!0});g=function(b){function f(d,c,e){var f=b.call(this,!0)||this;f.view=d;f.pointerAction=c;var g=f.view.mapViewNavigation;f.dragEventSeparator=new k.DragEventSeparator({start:function(a,b){g.rotate.begin(f.view,b.data);b.stopPropagation()},update:function(a,b){g.rotate.update(f.view,b.data);b.stopPropagation()},end:function(a,b){g.rotate.end();b.stopPropagation()},condition:function(b,c){return 1===b&&a.eventMatchesPointerAction(c.data,
f.pointerAction)}});f.registerIncoming("drag",e,function(a){return f.dragEventSeparator.handle(a)});return f}l(f,b);return f}(f.InputHandler);b.DragRotate=g})},"esri/views/2d/input/handlers/GamepadNavigation":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/Handles ../../../../core/scheduling ../../../../core/watchUtils ../../viewpointUtils ../../../input/InputHandler ../../../navigation/gamepadAndKeyboardUtils".split(" "),function(g,b,l,k,f,a,q,m,d){Object.defineProperty(b,
"__esModule",{value:!0});g=function(b){function g(a){var c=b.call(this,!0)||this;c.view=a;c.frameTask=null;c.watchHandles=new k;c.currentDevice=null;c.transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0};c.handle=c.registerIncoming("gamepad",function(a){return c.handleEvent(a)});c.handle.pause();return c}l(g,b);g.prototype.onInstall=function(c){var e=this;b.prototype.onInstall.call(this,c);this.watchHandles.add([a.init(this.view.navigation.gamepad,"enabled",function(a){a?(e.handle.resume(),
e.frameTask||(e.frameTask=f.addFrameTask({update:function(a){return e.frameUpdate(a.deltaTime)}}))):(e.handle.pause(),e.frameTask&&(e.frameTask.remove(),e.frameTask=null))})])};g.prototype.onUninstall=function(){this.watchHandles.removeAll();this.frameTask&&(this.frameTask.remove(),this.frameTask=null);b.prototype.onUninstall.call(this)};g.prototype.handleEvent=function(a){var b=this.view.navigation.gamepad.device;b&&a.data.device!==b||this.currentDevice&&this.currentDevice!==a.data.device||("end"===
a.data.action?(this.currentDevice=null,d.resetTransformation(this.transformation)):(this.currentDevice=a.data.device,d.extractTransformation(a.data,this.view.navigation.gamepad,this.transformation)))};g.prototype.frameUpdate=function(a){var b=this.transformation;if(!d.isZeroTransformation(b)){var f=this.view.viewpoint.clone(),g=e*this.view.navigation.gamepad.velocityFactor*a;q.translateBy(f,f,[b.translation[0]*g,-b.translation[1]*g]);g=this.view.size;q.scaleAndRotateBy(f,f,1+b.translation[2]*h*a,
this.view.constraints.rotationEnabled?-b.heading*c*a:0,[g[0]/2,g[1]],g);a=this.view.constraints.constrain(f,this.view.viewpoint);this.view.viewpoint=a}};return g}(m.InputHandler);b.GamepadNavigation=g;var c=.06,e=.7,h=6E-4})},"esri/views/navigation/gamepadAndKeyboardUtils":function(){define(["require","exports","../../core/libs/gl-matrix-2/vec3"],function(g,b,l){function k(b){var a=b*b;0>b&&(a*=-1);return a}Object.defineProperty(b,"__esModule",{value:!0});b.quadraticAccentuation=k;b.resetTransformation=
function(b){b.translation[0]=0;b.translation[1]=0;b.translation[2]=0;b.heading=0;b.tilt=0;return b};b.extractTransformation=function(b,a,g){var f=b.state;b=b.device;a="forward-down"===a.tiltDirection?1:-1;"standard"===b.deviceType?(g.translation[0]=k(f.axes[0]),g.translation[1]=k(f.axes[1]),g.translation[2]=k(f.buttons[7])-k(f.buttons[6]),g.heading=k(f.axes[2]),g.tilt=k(f.axes[3])):"spacemouse"===b.deviceType&&(g.translation[0]=1.2*k(f.axes[0]),g.translation[1]=1.2*k(f.axes[1]),g.translation[2]=2*
-k(f.axes[2]),g.heading=1.2*k(f.axes[5]),g.tilt=1.2*k(f.axes[3]));g.tilt*=a;l.vec3.scale(g.translation,g.translation,1);return g};b.extractTransformationKeyboard=function(b,a){a.translation[0]=b[1]-b[0];a.translation[1]=b[3]-b[2];a.translation[2]=b[4]-b[5];a.heading=b[7]-b[6];a.tilt=b[8]-b[9];a.zoom=b[10]-b[11];return a};b.isZeroTransformation=function(b){return 0===b.translation[0]&&0===b.translation[1]&&0===b.translation[2]&&0===b.heading&&0===b.tilt&&0===b.zoom}})},"esri/views/2d/input/handlers/KeyPan":function(){define(["require",
"exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler"],function(g,b,l,k){Object.defineProperty(b,"__esModule",{value:!0});g=function(b){function a(a,f,d){var c,e=b.call(this,!0)||this;e.view=a;e.keys=f;e._pressed=!1;e._keyMap=(c={},c[f.left]="left",c[f.right]="right",c[f.up]="up",c[f.down]="down",c);e.registerIncoming("key-down",d,function(a){return e._handleKeyDown(a)});e.registerIncoming("key-up",d,function(a){return e._handleKeyUp(a)});e.registerIncoming("blur",d,function(){return e._handleBlur()});
return e}l(a,b);a.prototype._handleKeyDown=function(a){a.data.repeat||this._handleKey(a,!0)};a.prototype._handleKeyUp=function(a){this._handleKey(a,!1)};a.prototype._handleBlur=function(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())};a.prototype._handleKey=function(a,b){var d=this._keyMap[a.data.key];if(this._pressed=null!=d){if(b)switch(this.view.mapViewNavigation.begin(),d){case "left":this.view.mapViewNavigation.continousPanLeft();break;case "right":this.view.mapViewNavigation.continousPanRight();
break;case "up":this.view.mapViewNavigation.continousPanUp();break;case "down":this.view.mapViewNavigation.continousPanDown()}else this._pressed=!1,this.view.mapViewNavigation.stop();a.stopPropagation()}};return a}(k.InputHandler);b.KeyPan=g})},"esri/views/2d/input/handlers/KeyRotate":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler"],function(g,b,l,k){Object.defineProperty(b,"__esModule",{value:!0});g=function(b){function a(a,f,d){var c,
e=b.call(this,!0)||this;e.view=a;e.keys=f;e._pressed=!1;e._keyToDirection=(c={},c[f.clockwiseOption1]="clockwise",c[f.clockwiseOption2]="clockwise",c[f.counterClockwiseOption1]="counterClockwise",c[f.counterClockwiseOption2]="counterClockwise",c[f.resetOption1]="reset",c[f.resetOption2]="reset",c);e.registerIncoming("key-down",d,function(a){return e._handleKeyDown(a)});e.registerIncoming("key-up",d,function(a){return e._handleKeyUp(a)});e.registerIncoming("blur",d,function(){return e._handleBlur()});
return e}l(a,b);a.prototype._handleKeyDown=function(a){a.data.repeat||this._handleKey(a,!0)};a.prototype._handleKeyUp=function(a){this._handleKey(a,!1)};a.prototype._handleBlur=function(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())};a.prototype._handleKey=function(a,b){var d=a.modifiers;if(!(0<d.size&&!d.has("Shift")||!this.view.constraints.rotationEnabled)&&(d=this._keyToDirection[a.data.key],this._pressed=null!=d)){if(b)switch(this.view.mapViewNavigation.begin(),d){case "clockwise":this.view.mapViewNavigation.continousRotateClockwise();
break;case "counterClockwise":this.view.mapViewNavigation.continousRotateCounterclockwise();break;case "reset":this.view.mapViewNavigation.resetRotation()}else this._pressed=!1,this.view.mapViewNavigation.stop();a.stopPropagation()}};return a}(k.InputHandler);b.KeyRotate=g})},"esri/views/2d/input/handlers/KeyZoom":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../../core/compilerUtils","../../../input/InputHandler"],function(g,b,l,k,f){Object.defineProperty(b,
"__esModule",{value:!0});g=function(a){function b(b,d,c){var e=a.call(this,!0)||this;e.view=b;e.keys=d;e._keysToZoomAction={};e.registerIncoming("key-down",c,function(a){return e._handleKeyDown(a)});d.zoomIn.forEach(function(a){return e._keysToZoomAction[a]=0});d.zoomOut.forEach(function(a){return e._keysToZoomAction[a]=1});return e}l(b,a);b.prototype._handleKeyDown=function(a){this._handleKey(a)};b.prototype._handleKey=function(a){var b=a.modifiers;if(!(0<b.size)||b.has("Shift"))if(b=a.data.key,
b in this._keysToZoomAction){var b=this._keysToZoomAction[b],c=this.view.mapViewNavigation,e=null;switch(b){case 0:e=c.zoomIn();break;case 1:e=c.zoomOut();break;default:k.neverReached(b);return}c.begin();e.then(function(){return c.end()});a.stopPropagation()}};return b}(f.InputHandler);b.KeyZoom=g})},"esri/views/2d/input/handlers/MouseWheelZoom":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler"],function(g,b,l,k){Object.defineProperty(b,
"__esModule",{value:!0});g=function(b){function a(a,f){var d=b.call(this,!0)||this;d.view=a;d._canZoom=!0;d.registerIncoming("mouse-wheel",f,function(a){return d._handleMouseWheel(a)});return d}l(a,b);a.prototype._handleMouseWheel=function(a){var b=this;if(this.view.navigation.mouseWheelZoomEnabled&&(a.preventDefault(),a.stopPropagation(),this._canZoom)){var d=this.view.mapViewNavigation;a=a.data;if(a=d.zoom(1/Math.pow(.6,1/60*a.deltaY),[a.x,a.y]))this._canZoom=!1,a.catch(function(){}).then(function(){b._canZoom=
!0;d.end()})}};return a}(k.InputHandler);b.MouseWheelZoom=g})},"esri/views/2d/input/handlers/PinchAction":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/DragEventSeparator","../../../input/InputHandler"],function(g,b,l,k,f){Object.defineProperty(b,"__esModule",{value:!0});g=function(a){function b(b){var d=a.call(this,!0)||this;d.view=b;d.registerIncoming("drag",function(a){return d._handleDrag(a)});d.registerIncoming("pointer-down",function(){return d.stopMomentumNavigation()});
var c=d.view.mapViewNavigation;d.dragEventSeparator=new k.DragEventSeparator({start:function(a,b){c.pinch.begin(d.view,b.data);b.stopPropagation()},update:function(a,b){c.pinch.update(d.view,b.data);b.stopPropagation()},end:function(a,b){c.pinch.end(d.view);b.stopPropagation()},condition:function(a){return 2<=a}});return d}l(b,a);b.prototype._handleDrag=function(a){this.dragEventSeparator.handle(a)};b.prototype.stopMomentumNavigation=function(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()};
return b}(f.InputHandler);b.PinchRotateAndZoom=g})},"esri/views/input/BrowserEventSource":function(){define("require exports ../../core/has ../../core/screenUtils ../../core/libs/pep/pep ./keys ./gamepad/GamepadSource".split(" "),function(g,b,l,k,f,a,q){Object.defineProperty(b,"__esModule",{value:!0});var m=l("trident"),d=l("edge"),c=l("chrome"),e=l("ff"),h=l("safari");g=function(){function b(a,b){var c=this;this.input=b;this._active={};this._activePointerCaptures=new Set;this._keyDownState=new Set;
this._eventId=1;this._browserTouchPanningEnabled=!1;this._element=a;f.applyLocal(a);a.getAttribute("tabindex")||a.setAttribute("tabindex","0");this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost};
this._updateTouchAction();this._element.addEventListener("keydown",this._preventAltKeyDefault);this._gamepadSource=new q.GamepadSource(a,this.input);this._gamepadSource.onEvent=function(a){return c._callback("gamepad",a)}}b.prototype.destroy=function(){var a=this;this.activeEvents=this._callback=null;this._activePointerCaptures.forEach(function(b){a._releasePointerCaptureSafe(b)});this._gamepadSource&&(this._gamepadSource.destroy(),this._gamepadSource=null);this._activePointerCaptures=null;this._removeTouchAction();
this._element.removeEventListener("keydown",this._preventAltKeyDefault)};Object.defineProperty(b.prototype,"browserTouchPanningEnabled",{get:function(){return this._browserTouchPanningEnabled},set:function(a){this._browserTouchPanningEnabled=a;this._updateTouchAction();this._updateTouchEventHandling()},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"onEventReceived",{set:function(a){this._callback=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"activeEvents",
{set:function(a){var b=this,c;for(c in this._active)a&&a.has(c)||(this._element.removeEventListener(p[c],this._active[c]),delete this._active[c]);a&&a.forEach(function(a){if(!b._active[a]&&p[a]){var c=(b._eventHandlers[a]||b._handleDefault).bind(b,a);b._element.addEventListener(p[a],c);b._active[a]=c}});this._gamepadSource.pollingEnabled=a&&a.has("gamepad")},enumerable:!0,configurable:!0});b.prototype.setPointerCapture=function(a,b){b?(this._element.setPointerCapture(a.pointerId),this._activePointerCaptures.add(a.pointerId)):
(this._releasePointerCaptureSafe(a.pointerId),this._activePointerCaptures.delete(a.pointerId))};b.prototype._updateTouchAction=function(){this._element.classList.remove(this._browserTouchPanningEnabled?"esri-view-surface--touch-none":"esri-view-surface--touch-pan");this._element.classList.add(this._browserTouchPanningEnabled?"esri-view-surface--touch-pan":"esri-view-surface--touch-none")};b.prototype._updateTouchEventHandling=function(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",
this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)};b.prototype._removeTouchAction=function(){this._element.classList.remove("esri-view-surface--touch-none");this._element.classList.remove("esri-view-surface--touch-pan");this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)};b.prototype._releasePointerCaptureSafe=function(a){try{this._element.hasPointerCapture&&!this._element.hasPointerCapture(a)||this._element.releasePointerCapture(a)}catch(x){}};
b.prototype._updateNormalizedPointerLikeEvent=function(a,c){a=k.createScreenPointFromNativeEvent(this._element,a);b.test.disableSubpixelCoordinates&&(a.x=Math.round(a.x),a.y=Math.round(a.y));c.x=a.x;c.y=a.y;return c};b.prototype._handleKey=function(b,c){var e=a.eventKey(c);e&&"key-up"===b&&this._keyDownState.delete(e);c={native:c,key:e,repeat:e&&this._keyDownState.has(e)};e&&"key-down"===b&&this._keyDownState.add(c.key);this._callback(b,c)};b.prototype._handlePointer=function(a,b){b=this._updateNormalizedPointerLikeEvent(b,
{native:b,x:0,y:0,pointerType:b.pointerType,button:b.button,buttons:b.buttons,eventId:this._eventId++});this._callback(a,b)};b.prototype._handlePointerPreventDefault=function(a,b){var c=this._updateNormalizedPointerLikeEvent(b,{native:b,x:0,y:0,pointerType:b.pointerType,button:b.button,buttons:b.buttons,eventId:this._eventId++});b.preventDefault();this._callback(a,c)};b.prototype._handleMouseWheel=function(a,b){var f=b.deltaY;switch(b.deltaMode){case 0:if(m||d)f=f/document.documentElement.clientHeight*
600;break;case 1:f*=30;break;case 2:f*=900}m||d?f*=.7:c||h?f*=.6:e&&(f*=1.375);var g=Math.abs(f);100<g&&(f=f/g*200/(1+Math.exp(-.02*(g-100))));b=this._updateNormalizedPointerLikeEvent(b,{native:b,x:0,y:0,deltaY:f});this._callback(a,b)};b.prototype._handlePointerCaptureLost=function(a,b){this._activePointerCaptures.delete(b.pointerId);this._handleDefault(a,b)};b.prototype._handleDefault=function(a,b){var c={native:b};b.preventDefault();this._callback(a,c)};b.prototype._preventAltKeyDefault=function(a){"Alt"===
a.key&&a.preventDefault()};b.prototype._preventMultiTouchPanning=function(a){1<a.touches.length&&a.preventDefault()};b.test={disableSubpixelCoordinates:!1};return b}();b.BrowserEventSource=g;var p={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave",
"pointer-cancel":"pointercancel",focus:"focus",blur:"blur"}})},"esri/core/libs/pep/pep":function(){define(function(){function g(a,b){b=b||Object.create(null);var d=document.createEvent("Event");d.initEvent(a,b.bubbles||!1,b.cancelable||!1);a=2;for(var f;a<c.length;a++)f=c[a],d[f]=b[f]||e[a];d.buttons=b.buttons||0;a=0;a=b.pressure&&d.buttons?b.pressure:d.buttons?.5:0;d.x=d.clientX;d.y=d.clientY;d.pointerId=b.pointerId||0;d.width=b.width||0;d.height=b.height||0;d.pressure=a;d.tiltX=b.tiltX||0;d.tiltY=
b.tiltY||0;d.twist=b.twist||0;d.tangentialPressure=b.tangentialPressure||0;d.pointerType=b.pointerType||"";d.hwTimestamp=b.hwTimestamp||0;d.isPrimary=b.isPrimary||!1;return d}function b(){this.array=[];this.size=0}function l(a,b,c,e){this.addCallback=a.bind(e);this.removeCallback=b.bind(e);this.changedCallback=c.bind(e);z&&(this.observer=new z(this.mutationWatcher.bind(this)))}function k(a){return"body /shadow-deep/ "+f(a)}function f(a){return'[touch-action\x3d"'+a+'"]'}function a(a){return"{ -ms-touch-action: "+
a+"; touch-action: "+a+"; }"}function q(){if(H){C.forEach(function(b){String(b)===b?(D+=f(b)+a(b)+"\n",F&&(D+=k(b)+a(b)+"\n")):(D+=b.selectors.map(f)+a(b.rule)+"\n",F&&(D+=b.selectors.map(k)+a(b.rule)+"\n"))});var b=document.createElement("style");b.textContent=D;document.head.appendChild(b)}}function m(a){if(!v.pointermap.has(a))throw a=Error("NotFoundError"),a.name="NotFoundError",a;}function d(a){for(var b=a.parentNode;b&&b!==a.ownerDocument;)b=b.parentNode;if(!b)throw a=Error("InvalidStateError"),
a.name="InvalidStateError",a;}var c="bubbles cancelable view detail screenX screenY clientX clientY ctrlKey altKey shiftKey metaKey button relatedTarget pageX pageY".split(" "),e=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0],h=window.Map&&window.Map.prototype.forEach?Map:b;b.prototype={set:function(a,b){if(void 0===b)return this.delete(a);this.has(a)||this.size++;this.array[a]=b},has:function(a){return void 0!==this.array[a]},delete:function(a){this.has(a)&&(delete this.array[a],this.size--)},
get:function(a){return this.array[a]},clear:function(){this.size=this.array.length=0},forEach:function(a,b){return this.array.forEach(function(c,e){a.call(b,c,e,this)},this)}};var p="bubbles cancelable view detail screenX screenY clientX clientY ctrlKey altKey shiftKey metaKey button relatedTarget buttons pointerId width height pressure tiltX tiltY pointerType hwTimestamp isPrimary type target currentTarget which pageX pageY timeStamp".split(" "),n=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,
0,0,0,0,0,"",0,!1,"",null,null,0,0,0,0],u={pointerover:1,pointerout:1,pointerenter:1,pointerleave:1},x="undefined"!==typeof SVGElementInstance,v={pointermap:new h,eventMap:Object.create(null),captureInfo:Object.create(null),eventSources:Object.create(null),eventSourceList:[],registerSource:function(a,b){var c=b.events;c&&(c.forEach(function(a){b[a]&&(this.eventMap[a]=b[a].bind(b))},this),this.eventSources[a]=b,this.eventSourceList.push(b))},register:function(a){for(var b=this.eventSourceList.length,
c=0,e;c<b&&(e=this.eventSourceList[c]);c++)e.register.call(e,a)},unregister:function(a){for(var b=this.eventSourceList.length,c=0,e;c<b&&(e=this.eventSourceList[c]);c++)e.unregister.call(e,a)},contains:function(a,b){try{return a.contains(b)}catch(Y){return!1}},down:function(a){a.bubbles=!0;this.fireEvent("pointerdown",a)},move:function(a){a.bubbles=!0;this.fireEvent("pointermove",a)},up:function(a){a.bubbles=!0;this.fireEvent("pointerup",a)},enter:function(a){a.bubbles=!1;this.fireEvent("pointerenter",
a)},leave:function(a){a.bubbles=!1;this.fireEvent("pointerleave",a)},over:function(a){a.bubbles=!0;this.fireEvent("pointerover",a)},out:function(a){a.bubbles=!0;this.fireEvent("pointerout",a)},cancel:function(a){a.bubbles=!0;this.fireEvent("pointercancel",a)},leaveOut:function(a){this.out(a);this.propagate(a,this.leave,!1)},enterOver:function(a){this.over(a);this.propagate(a,this.enter,!0)},eventHandler:function(a){if(!a._handledByPE){var b=a.type;(b=this.eventMap&&this.eventMap[b])&&b(a);a._handledByPE=
!0}},listen:function(a,b){b.forEach(function(b){this.addEvent(a,b)},this)},unlisten:function(a,b){b.forEach(function(b){this.removeEvent(a,b)},this)},addEvent:function(a,b){a.addEventListener(b,this.boundHandler)},removeEvent:function(a,b){a.removeEventListener(b,this.boundHandler)},makeEvent:function(a,b){this.captureInfo[b.pointerId]&&(b.relatedTarget=null);a=new g(a,b);b.preventDefault&&(a.preventDefault=b.preventDefault);a._target=a._target||b.target;return a},fireEvent:function(a,b){a=this.makeEvent(a,
b);return this.dispatchEvent(a)},cloneEvent:function(a){for(var b=Object.create(null),c,e=0;e<p.length;e++)c=p[e],b[c]=a[c]||n[e],x&&("target"===c||"relatedTarget"===c)&&b[c]instanceof SVGElementInstance&&(b[c]=b[c].correspondingUseElement);a.preventDefault&&(b.preventDefault=function(){a.preventDefault()});return b},getTarget:function(a){var b=this.captureInfo[a.pointerId];if(!b)return a._target;if(a._target===b||!(a.type in u))return b},propagate:function(a,b,c){for(var e=a.target,d=[];null!=e&&
e!==document&&!e.contains(a.relatedTarget);)if(d.push(e),e=e.parentNode,!e)return;c&&d.reverse();d.forEach(function(c){a.target=c;b.call(this,a)},this)},setCapture:function(a,b,c){this.captureInfo[a]&&this.releaseCapture(a,c);this.captureInfo[a]=b;this.implicitRelease=this.releaseCapture.bind(this,a,c);document.addEventListener("pointerup",this.implicitRelease);document.addEventListener("pointercancel",this.implicitRelease);var e=new g("gotpointercapture");e.pointerId=a;e._target=b;c||this.asyncDispatchEvent(e)},
releaseCapture:function(a,b){var c=this.captureInfo[a];if(c){this.captureInfo[a]=void 0;document.removeEventListener("pointerup",this.implicitRelease);document.removeEventListener("pointercancel",this.implicitRelease);var e=new g("lostpointercapture");e.pointerId=a;e._target=c;b||this.asyncDispatchEvent(e)}},dispatchEvent:function(a){var b=this.getTarget(a);if(b)return b.dispatchEvent(a)},asyncDispatchEvent:function(a){requestAnimationFrame(this.dispatchEvent.bind(this,a))}};v.boundHandler=v.eventHandler.bind(v);
var t={shadow:function(a){if(a)return a.shadowRoot||a.webkitShadowRoot},canTarget:function(a){return a&&!!a.elementFromPoint},targetingShadow:function(a){a=this.shadow(a);if(this.canTarget(a))return a},olderShadow:function(a){var b=a.olderShadowRoot;!b&&(a=a.querySelector("shadow"))&&(b=a.olderShadowRoot);return b},allShadows:function(a){var b=[];for(a=this.shadow(a);a;)b.push(a),a=this.olderShadow(a);return b},searchRoot:function(a,b,c){if(a){var e=a.elementFromPoint(b,c),d;for(d=this.targetingShadow(e);d;){if(a=
d.elementFromPoint(b,c))return e=this.targetingShadow(a),this.searchRoot(e,b,c)||a;d=this.olderShadow(d)}return e}},owner:function(a){for(;a.parentNode;)a=a.parentNode;a.nodeType!==Node.DOCUMENT_NODE&&a.nodeType!==Node.DOCUMENT_FRAGMENT_NODE&&(a=document);return a},findTarget:function(a){var b=a.clientX,c=a.clientY;a=this.owner(a.target);a.elementFromPoint(b,c)||(a=document);return this.searchRoot(a,b,c)}},w=Array.prototype.forEach.call.bind(Array.prototype.forEach),r=Array.prototype.map.call.bind(Array.prototype.map),
y=Array.prototype.slice.call.bind(Array.prototype.slice),A=Array.prototype.filter.call.bind(Array.prototype.filter),z=window.MutationObserver||window.WebKitMutationObserver,B={subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["touch-action"]};l.prototype={watchSubtree:function(a){this.observer&&t.canTarget(a)&&this.observer.observe(a,B)},enableOnSubtree:function(a){this.watchSubtree(a);a===document&&"complete"!==document.readyState?this.installOnLoad():this.installNewSubtree(a)},
installNewSubtree:function(a){w(this.findElements(a),this.addElement,this)},findElements:function(a){return a.querySelectorAll?a.querySelectorAll("[touch-action]"):[]},removeElement:function(a){this.removeCallback(a)},addElement:function(a){this.addCallback(a)},elementChanged:function(a,b){this.changedCallback(a,b)},concatLists:function(a,b){return a.concat(y(b))},installOnLoad:function(){document.addEventListener("readystatechange",function(){"complete"===document.readyState&&this.installNewSubtree(document)}.bind(this))},
isElement:function(a){return a.nodeType===Node.ELEMENT_NODE},flattenMutationTree:function(a){var b=r(a,this.findElements,this);b.push(A(a,this.isElement));return b.reduce(this.concatLists,[])},mutationWatcher:function(a){a.forEach(this.mutationHandler,this)},mutationHandler:function(a){"childList"===a.type?(this.flattenMutationTree(a.addedNodes).forEach(this.addElement,this),this.flattenMutationTree(a.removedNodes).forEach(this.removeElement,this)):"attributes"===a.type&&this.elementChanged(a.target,
a.oldValue)}};var C=["none","auto","pan-x","pan-y",{rule:"pan-x pan-y",selectors:["pan-x pan-y","pan-y pan-x"]}],D="",H=window.PointerEvent||window.MSPointerEvent,F=!window.ShadowDOMPolyfill&&document.head.createShadowRoot,E=v.pointermap,G=[1,4,2,8,16],J=!1;try{J=1===(new MouseEvent("test",{buttons:1})).buttons}catch(W){}var K={POINTER_ID:1,POINTER_TYPE:"mouse",events:["mousedown","mousemove","mouseup","mouseover","mouseout"],register:function(a){v.listen(a,this.events)},unregister:function(a){v.unlisten(a,
this.events)},lastTouches:[],isEventSimulatedFromTouch:function(a){var b=this.lastTouches,c=a.clientX;a=a.clientY;for(var e=0,d=b.length,f;e<d&&(f=b[e]);e++){var g=Math.abs(a-f.y);if(25>=Math.abs(c-f.x)&&25>=g)return!0}},prepareEvent:function(a){var b=v.cloneEvent(a),c=b.preventDefault;b.preventDefault=function(){a.preventDefault();c()};b.pointerId=this.POINTER_ID;b.isPrimary=!0;b.pointerType=this.POINTER_TYPE;return b},prepareButtonsForMove:function(a,b){var c=E.get(this.POINTER_ID);a.buttons=0!==
b.which&&c?c.buttons:0;b.buttons=a.buttons},mousedown:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=E.get(this.POINTER_ID),c=this.prepareEvent(a);J||(c.buttons=G[c.button],b&&(c.buttons|=b.buttons),a.buttons=c.buttons);E.set(this.POINTER_ID,a);b&&0!==b.buttons?v.move(c):v.down(c)}},mousemove:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=this.prepareEvent(a);J||this.prepareButtonsForMove(b,a);b.button=-1;E.set(this.POINTER_ID,a);v.move(b)}},mouseup:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=
E.get(this.POINTER_ID),c=this.prepareEvent(a);if(!J){var e=G[c.button];c.buttons=b?b.buttons&~e:0;a.buttons=c.buttons}E.set(this.POINTER_ID,a);c.buttons&=~G[c.button];0===c.buttons?v.up(c):v.move(c)}},mouseover:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=this.prepareEvent(a);J||this.prepareButtonsForMove(b,a);b.button=-1;E.set(this.POINTER_ID,a);v.enterOver(b)}},mouseout:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=this.prepareEvent(a);J||this.prepareButtonsForMove(b,a);b.button=
-1;v.leaveOut(b)}},cancel:function(a){a=this.prepareEvent(a);v.cancel(a);this.deactivateMouse()},deactivateMouse:function(){E.delete(this.POINTER_ID)}},I=v.captureInfo,N=t.findTarget.bind(t),M=t.allShadows.bind(t),L=v.pointermap,Q,O={events:["touchstart","touchmove","touchend","touchcancel"],register:function(a){Q.enableOnSubtree(a)},unregister:function(){},elementAdded:function(a){var b=a.getAttribute("touch-action"),c=this.touchActionToScrollType(b);c&&(a._scrollType=c,v.listen(a,this.events),M(a).forEach(function(a){a._scrollType=
c;v.listen(a,this.events)},this))},elementRemoved:function(a){a._scrollType=void 0;v.unlisten(a,this.events);M(a).forEach(function(a){a._scrollType=void 0;v.unlisten(a,this.events)},this)},elementChanged:function(a,b){var c=a.getAttribute("touch-action"),e=this.touchActionToScrollType(c);b=this.touchActionToScrollType(b);e&&b?(a._scrollType=e,M(a).forEach(function(a){a._scrollType=e},this)):b?this.elementRemoved(a):e&&this.elementAdded(a)},scrollTypes:{EMITTER:"none",XSCROLLER:"pan-x",YSCROLLER:"pan-y",
SCROLLER:/^(?:pan-x pan-y)|(?:pan-y pan-x)|auto$/},touchActionToScrollType:function(a){var b=this.scrollTypes;if("none"===a)return"none";if(a===b.XSCROLLER)return"X";if(a===b.YSCROLLER)return"Y";if(b.SCROLLER.exec(a))return"XY"},POINTER_TYPE:"touch",firstTouch:null,isPrimaryTouch:function(a){return this.firstTouch===a.identifier},setPrimaryTouch:function(a){if(0===L.size||1===L.size&&L.has(1))this.firstTouch=a.identifier,this.firstXY={X:a.clientX,Y:a.clientY},this.scrolling=!1,this.cancelResetClickCount()},
removePrimaryPointer:function(a){a.isPrimary&&(this.firstXY=this.firstTouch=null,this.resetClickCount())},clickCount:0,resetId:null,resetClickCount:function(){var a=function(){this.clickCount=0;this.resetId=null}.bind(this);this.resetId=setTimeout(a,200)},cancelResetClickCount:function(){this.resetId&&clearTimeout(this.resetId)},typeToButtons:function(a){var b=0;if("touchstart"===a||"touchmove"===a)b=1;return b},touchToPointer:function(a){var b=this.currentTouchEvent,c=v.cloneEvent(a),e=c.pointerId=
a.identifier+2;c.target=I[e]||N(c);c.bubbles=!0;c.cancelable=!0;c.detail=this.clickCount;c.button=0;c.buttons=this.typeToButtons(b.type);c.width=2*(a.radiusX||a.webkitRadiusX||0);c.height=2*(a.radiusY||a.webkitRadiusY||0);c.pressure=a.force||a.webkitForce||.5;c.isPrimary=this.isPrimaryTouch(a);c.pointerType=this.POINTER_TYPE;c.altKey=b.altKey;c.ctrlKey=b.ctrlKey;c.metaKey=b.metaKey;c.shiftKey=b.shiftKey;var d=this;c.preventDefault=function(){d.scrolling=!1;d.firstXY=null;b.preventDefault()};return c},
processTouches:function(a,b){var c=a.changedTouches;this.currentTouchEvent=a;a=0;for(var e;a<c.length;a++)e=c[a],b.call(this,this.touchToPointer(e))},shouldScroll:function(a){if(this.firstXY){var b;b=a.currentTarget._scrollType;if("none"===b)b=!1;else if("XY"===b)b=!0;else{a=a.changedTouches[0];var c="Y"===b?"X":"Y";b=Math.abs(a["client"+b]-this.firstXY[b])>=Math.abs(a["client"+c]-this.firstXY[c])}this.firstXY=null;return b}},findTouch:function(a,b){for(var c=0,e=a.length,d;c<e&&(d=a[c]);c++)if(d.identifier===
b)return!0},vacuumTouches:function(a){var b=a.touches;if(L.size>=b.length){var c=[];L.forEach(function(a,e){1===e||this.findTouch(b,e-2)||c.push(a.out)},this);c.forEach(this.cancelOut,this)}},touchstart:function(a){this.vacuumTouches(a);this.setPrimaryTouch(a.changedTouches[0]);this.dedupSynthMouse(a);this.scrolling||(this.clickCount++,this.processTouches(a,this.overDown))},overDown:function(a){L.set(a.pointerId,{target:a.target,out:a,outTarget:a.target});v.enterOver(a);v.down(a)},touchmove:function(a){this.scrolling||
(this.shouldScroll(a)?(this.scrolling=!0,this.touchcancel(a)):(a.preventDefault(),this.processTouches(a,this.moveOverOut)))},moveOverOut:function(a){var b=L.get(a.pointerId);if(b){var c=b.out,e=b.outTarget;v.move(a);c&&e!==a.target&&(c.relatedTarget=a.target,a.relatedTarget=e,c.target=e,a.target?(v.leaveOut(c),v.enterOver(a)):(a.target=e,a.relatedTarget=null,this.cancelOut(a)));b.out=a;b.outTarget=a.target}},touchend:function(a){this.dedupSynthMouse(a);this.processTouches(a,this.upOut)},upOut:function(a){this.scrolling||
(v.up(a),v.leaveOut(a));this.cleanUpPointer(a)},touchcancel:function(a){this.processTouches(a,this.cancelOut)},cancelOut:function(a){v.cancel(a);v.leaveOut(a);this.cleanUpPointer(a)},cleanUpPointer:function(a){L.delete(a.pointerId);this.removePrimaryPointer(a)},dedupSynthMouse:function(a){var b=K.lastTouches;a=a.changedTouches[0];this.isPrimaryTouch(a)&&(a={x:a.clientX,y:a.clientY},b.push(a),b=function(a,b){b=a.indexOf(b);-1<b&&a.splice(b,1)}.bind(null,b,a),setTimeout(b,2500))}};Q=new l(O.elementAdded,
O.elementRemoved,O.elementChanged,O);var S=v.pointermap,U=window.MSPointerEvent&&"number"===typeof window.MSPointerEvent.MSPOINTER_TYPE_MOUSE,T={events:"MSPointerDown MSPointerMove MSPointerUp MSPointerOut MSPointerOver MSPointerCancel MSGotPointerCapture MSLostPointerCapture".split(" "),register:function(a){v.listen(a,this.events)},unregister:function(a){v.unlisten(a,this.events)},POINTER_TYPES:["","unavailable","touch","pen","mouse"],prepareEvent:function(a){var b=a;U&&(b=v.cloneEvent(a),b.pointerType=
this.POINTER_TYPES[a.pointerType]);return b},cleanup:function(a){S.delete(a)},MSPointerDown:function(a){S.set(a.pointerId,a);a=this.prepareEvent(a);v.down(a)},MSPointerMove:function(a){a=this.prepareEvent(a);v.move(a)},MSPointerUp:function(a){var b=this.prepareEvent(a);v.up(b);this.cleanup(a.pointerId)},MSPointerOut:function(a){a=this.prepareEvent(a);v.leaveOut(a)},MSPointerOver:function(a){a=this.prepareEvent(a);v.enterOver(a)},MSPointerCancel:function(a){var b=this.prepareEvent(a);v.cancel(b);this.cleanup(a.pointerId)},
MSLostPointerCapture:function(a){a=v.makeEvent("lostpointercapture",a);v.dispatchEvent(a)},MSGotPointerCapture:function(a){a=v.makeEvent("gotpointercapture",a);v.dispatchEvent(a)}},R,P,V;window.navigator.msPointerEnabled?(R=function(a){m(a);d(this);0!==v.pointermap.get(a).buttons&&(v.setCapture(a,this,!0),this.msSetPointerCapture(a))},P=function(a){m(a);v.releaseCapture(a,!0);this.msReleasePointerCapture(a)}):(R=function(a){m(a);d(this);0!==v.pointermap.get(a).buttons&&v.setCapture(a,this)},P=function(a){m(a);
v.releaseCapture(a)});V=function(a){return!!v.captureInfo[a]};var X=window.PointerEvent||window.MSPointerEvent;return{dispatcher:v,Installer:l,PointerEvent:g,PointerMap:h,targetFinding:t,applyGlobal:function(){q();window.PointerEvent||(window.PointerEvent=g,window.navigator.msPointerEnabled?(Object.defineProperty(window.navigator,"maxTouchPoints",{value:window.navigator.msMaxTouchPoints,enumerable:!0}),v.registerSource("ms",T)):(Object.defineProperty(window.navigator,"maxTouchPoints",{value:0,enumerable:!0}),
v.registerSource("mouse",K),void 0!==window.ontouchstart&&v.registerSource("touch",O)),v.register(document));window.Element&&!Element.prototype.setPointerCapture&&Object.defineProperties(Element.prototype,{setPointerCapture:{value:R},releasePointerCapture:{value:P},hasPointerCapture:{value:V}})},applyLocal:function(a){X||(window.PointerEvent||(window.navigator.msPointerEnabled?v.registerSource("ms",T):(v.registerSource("mouse",K),void 0!==window.ontouchstart&&v.registerSource("touch",O)),v.register(document)),
window.Element&&!Element.prototype.setPointerCapture&&(a.setPointerCapture=R.bind(a),a.releasePointerCapture=P.bind(a),a.hasPointerCapture=V.bind(a)),a.getAttribute("touch-action")||a.setAttribute("touch-action","none"))}}})},"esri/views/input/gamepad/GamepadSource":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/scheduling ./GamepadInputDevice ./GamepadState".split(" "),function(g,b,l,k,f,a){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(b,
d){var c=this;this.element=b;this.input=d;this.handleGamepadConnectedEvent=function(a){c.handleGamepadConnected(a.gamepad)};this.handleGamepadDisconnectedEvent=function(b){b=b.gamepad;var e=c.inputDevices[b.index];e&&(c.emitGamepadEvent(b,a.extractState(e),!1),c.inputDevices[b.index]=void 0,c.latestUpdate[b.index]=void 0,c.input.gamepad.devices.remove(e))};this.frameTask=null;this.latestUpdate=[];this.inputDevices=[];this.callback=null;if(this.supported="getGamepads"in window.navigator)this.forEachGamepad(function(a){return c.handleGamepadConnected(a)}),
window.addEventListener("gamepadconnected",this.handleGamepadConnectedEvent),window.addEventListener("gamepaddisconnected",this.handleGamepadDisconnectedEvent)}b.prototype.destroy=function(){this.pollingEnabled=!1;this.supported&&(window.removeEventListener("gamepadconnected",this.handleGamepadConnectedEvent),window.removeEventListener("gamepaddisconnected",this.handleGamepadDisconnectedEvent))};Object.defineProperty(b.prototype,"onEvent",{set:function(a){this.callback=a},enumerable:!0,configurable:!0});
Object.defineProperty(b.prototype,"pollingEnabled",{set:function(a){this.supported&&(a?this.startPolling():this.stopPolling())},enumerable:!0,configurable:!0});b.prototype.handleGamepadConnected=function(a){var b=new f(a);"unknown"!==b.deviceType&&(this.inputDevices[a.index]=b,this.input.gamepad.devices.add(b))};b.prototype.startPolling=function(){var a=this;null==this.frameTask&&(this.frameTask=k.addFrameTask({update:function(){return a.readGamepadState()}}))};b.prototype.stopPolling=function(){null!=
this.frameTask&&(this.frameTask.remove(),this.frameTask=null,this.latestUpdate=[])};b.prototype.readGamepadState=function(){var b=this,d=document.hasFocus(),c=this.element.contains(document.activeElement),e="document"===this.input.gamepad.enabledFocusMode&&!d||"view"===this.input.gamepad.enabledFocusMode&&!c;this.forEachGamepad(function(c){var d=b.inputDevices[c.index];if(d){var f=b.latestUpdate[c.index],d=a.extractState(d),g=e||a.stateIdle(d);f&&(f.timestamp===c.timestamp||!f.active&&g||a.stateEqual(f.state,
d))||b.emitGamepadEvent(c,d,!g)}})};b.prototype.forEachGamepad=function(a){for(var b=window.navigator.getGamepads(),c=0;c<b.length;c++){var e=b[c];this.validate(e)&&a(e)}};b.prototype.emitGamepadEvent=function(a,b,c){var e=this.latestUpdate[a.index];if((e=e&&e.active)||c)this.latestUpdate[a.index]={timestamp:a.timestamp,state:b,active:c},this.callback&&this.callback({device:this.inputDevices[a.index],state:b,action:!e&&c?"start":e&&c?"update":"end"})};b.prototype.validate=function(a){if(!a||!a.connected)return!1;
for(var b=0;b<a.axes.length;b++)if(isNaN(a.axes[b]))return!1;return!0};return b}();b.GamepadSource=g})},"esri/views/input/gamepad/GamepadState":function(){define(["require","exports","../../../core/mathUtils"],function(g,b,l){Object.defineProperty(b,"__esModule",{value:!0});b.extractState=function(b){var f=b.native;return{buttons:f.buttons.map(function(a){return a.pressed?a.value?a.value:1:0}),axes:f.axes.map(function(a){var f=b.axisThreshold,g=Math.abs(a);a=g<f?0:l.sign(a)*(g-f)/(1-f);return a})}};
b.stateEqual=function(b,f){if(b.axes.length!==f.axes.length||b.buttons.length!==f.buttons.length)return!1;for(var a=0;a<b.axes.length;a++)if(b.axes[a]!==f.axes[a])return!1;for(a=0;a<b.buttons.length;a++)if(b.buttons[a]!==f.buttons[a])return!1;return!0};b.stateIdle=function(b){for(var f=0;f<b.axes.length;f++)if(0!==b.axes[f])return!1;for(f=0;f<b.buttons.length;f++)if(0!==b.buttons[f])return!1;return!0}})},"esri/views/input/handlers/PreventContextMenu":function(){define(["require","exports","../../../core/tsSupport/extendsHelper",
"../InputHandler"],function(g,b,l,k){Object.defineProperty(b,"__esModule",{value:!0});g=function(b){function a(){var a=b.call(this,!0)||this;a.registerIncoming("context-menu",function(a){a.data.native.preventDefault()});return a}l(a,b);return a}(k.InputHandler);b.PreventContextMenu=g;b.default=g})},"esri/views/input/recognizers/DoubleTapDrag":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/clock ../../../core/MapUtils ../../../core/screenUtils ../DragEventSeparator ../InputHandler ./SingleAndDoubleClick ./support".split(" "),
function(g,b,l,k,f,a,q,m,d,c){Object.defineProperty(b,"__esModule",{value:!0});g=function(b){function e(c,e,f,g,h){void 0===c&&(c=d.DefaultParameters.maximumDoubleClickDelay);void 0===e&&(e=d.DefaultParameters.maximumDoubleClickDistance);void 0===f&&(f=d.DefaultParameters.maximumDoubleTouchDelay);void 0===g&&(g=d.DefaultParameters.maximumDoubleTouchDistance);void 0===h&&(h=k.default);var n=b.call(this,!1)||this;n.maximumDoubleClickDelay=c;n.maximumDoubleClickDistance=e;n.maximumDoubleTouchDelay=f;
n.maximumDoubleTouchDistance=g;n._clock=h;n._doubleTapDragReady=!1;n._doubleTapDragActive=!1;n._dragStartCenter=a.createScreenPoint(0,0);n._pointerState=new Map;n._doubleTapDrag=n.registerOutgoing("double-tap-drag");n._dragEventSeparator=new q.DragEventSeparator({start:function(a,b){return n._dragStart(a,b)},update:function(a,b){return n._dragUpdate(b)},end:function(a,b){return n._dragEnd(b)}});n.registerIncoming("drag",function(a){return n._dragEventSeparator.handle(a)});n.registerIncoming("pointer-down",
function(a){return n._handlePointerDown(a)});n.registerIncoming("pointer-up",function(){return n._handlePointerUp()});return n}l(e,b);e.prototype.onUninstall=function(){this._pointerState.forEach(function(a){null!=a.doubleTapTimeout&&(a.doubleTapTimeout.remove(),a.doubleTapTimeout=null)})};Object.defineProperty(e.prototype,"hasPendingInputs",{get:function(){return f.someMap(this._pointerState,function(a){return null!=a.doubleTapTimeout})},enumerable:!0,configurable:!0});e.prototype._clearPointerDown=
function(a){var b=this._pointerState.get(a);b&&(b.doubleTapTimeout.remove(),b.doubleTapTimeout=null,this._pointerState.delete(a),this.refreshHasPendingInputs())};e.prototype._createDoubleTapDragData=function(a,b,c){return{action:a,delta:b,button:c.button,buttons:c.buttons,pointer:c.pointer,pointers:c.pointers,pointerType:c.pointerType,timestamp:c.timestamp}};e.prototype._dragStart=function(b,c){if(this._doubleTapDragReady&&1===b){this._doubleTapDragReady=!1;this._doubleTapDragActive=!0;var e=c.data;
b=c.modifiers;this._dragStartCenter=e.center;e=this._createDoubleTapDragData("begin",a.createScreenPoint(0,0),e);this._doubleTapDrag.emit(e,void 0,b);c.stopPropagation()}};e.prototype._dragUpdate=function(b){if(this._doubleTapDragActive){var c=b.data,e=b.modifiers,d=c.center,d=a.createScreenPoint(d.x-this._dragStartCenter.x,d.y-this._dragStartCenter.y),c=this._createDoubleTapDragData("update",d,c);this._doubleTapDrag.emit(c,void 0,e);b.stopPropagation()}};e.prototype._dragEnd=function(b){if(this._doubleTapDragActive){var c=
b.data,e=b.modifiers,d=c.center,d=a.createScreenPoint(d.x-this._dragStartCenter.x,d.y-this._dragStartCenter.y),c=this._createDoubleTapDragData("end",d,c);this._doubleTapDrag.emit(c,void 0,e);this._doubleTapDragActive=!1;b.stopPropagation()}};e.prototype._handlePointerDown=function(a){var b=a.data,e=this._pointerId(b),d=this._pointerState.get(e),f=b.native.pointerType;d?(f="touch"===f?this.maximumDoubleTouchDistance:this.maximumDoubleClickDistance,this._clearPointerDown(e),c.manhattanDistance(d.event.data,
b)>f?this._storePointerDown(a):this._doubleTapDragReady=!0):this._storePointerDown(a)};e.prototype._handlePointerUp=function(){this._doubleTapDragReady=!1};e.prototype._pointerId=function(a){var b=a.native;a=b.pointerId;var c=b.button,b=b.pointerType;return"mouse"===b?a+":"+c:""+b};e.prototype._storePointerDown=function(a){var b=this,c=a.data,e=c.native.pointerType,d=this._pointerId(c),c=this._clock.setTimeout(function(){return b._clearPointerDown(d)},"touch"===e?this.maximumDoubleTouchDelay:this.maximumDoubleClickDelay);
this._pointerState.set(d,{event:a,doubleTapTimeout:c});this.refreshHasPendingInputs()};return e}(m.InputHandler);b.DoubleTapDrag=g})},"esri/views/input/recognizers/SingleAndDoubleClick":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/clock ../../../core/MapUtils ../InputHandler ./support".split(" "),function(g,b,l,k,f,a,q){Object.defineProperty(b,"__esModule",{value:!0});b.DefaultParameters={maximumDoubleClickDelay:250,maximumDoubleClickDistance:10,maximumDoubleTouchDelay:350,
maximumDoubleTouchDistance:35};g=function(a){function d(c,e,d,f,g){void 0===c&&(c=b.DefaultParameters.maximumDoubleClickDelay);void 0===e&&(e=b.DefaultParameters.maximumDoubleClickDistance);void 0===d&&(d=b.DefaultParameters.maximumDoubleTouchDelay);void 0===f&&(f=b.DefaultParameters.maximumDoubleTouchDistance);void 0===g&&(g=k.default);var h=a.call(this,!1)||this;h.maximumDoubleClickDelay=c;h.maximumDoubleClickDistance=e;h.maximumDoubleTouchDelay=d;h.maximumDoubleTouchDistance=f;h._clock=g;h._pointerState=
new Map;h._click=h.registerOutgoing("click");h._doubleClick=h.registerOutgoing("double-click");h.registerIncoming("immediate-click",h._handleImmediateClick.bind(h));h.registerIncoming("pointer-drag",h._handlePointerDrag.bind(h));h.registerIncoming("drag",h._handleDrag.bind(h));return h}l(d,a);d.prototype.onUninstall=function(){this._pointerState.forEach(function(a){null!=a.doubleClickTimeout&&(a.doubleClickTimeout.remove(),a.doubleClickTimeout=null)})};Object.defineProperty(d.prototype,"hasPendingInputs",
{get:function(){return f.someMap(this._pointerState,function(a){return null!=a.doubleClickTimeout})},enumerable:!0,configurable:!0});d.prototype._pointerId=function(a){a=a.native;return"mouse"===a.pointerType?a.pointerId+":"+a.button:""+a.pointerType};d.prototype._handleImmediateClick=function(a){var b=a.data,c=this._pointerId(b),d=this._pointerState.get(c);if(d){var f="touch"===b.native.pointerType?this.maximumDoubleTouchDistance:this.maximumDoubleClickDistance;q.manhattanDistance(d.event.data,b)>
f?(this._clearDoubleClickTimeout(c,!0),this._startClick(a)):(this._clearDoubleClickTimeout(c,!1),this._doubleClick.emit(d.event.data,void 0,d.event.modifiers))}else this._startClick(a)};d.prototype._startClick=function(a){var b=this,c=this._pointerId(a.data);this._pointerState.set(c,{event:a,doubleClickTimeout:this._clock.setTimeout(function(){return b._doubleClickTimeoutExceeded(c)},"touch"===a.data.native.pointerType?this.maximumDoubleTouchDelay:this.maximumDoubleClickDelay)});this.refreshHasPendingInputs()};
d.prototype._handlePointerDrag=function(a){a=this._pointerId(a.data.currentEvent);this._clearDoubleClickTimeout(a,!0)};d.prototype._handleDrag=function(a){a=this._pointerId(a.data.pointer);this._clearDoubleClickTimeout(a,!0)};d.prototype._clearDoubleClickTimeout=function(a,b){var c=this._pointerState.get(a);c&&(c.doubleClickTimeout.remove(),c.doubleClickTimeout=null,b&&this._doubleClickTimeoutExceeded(a),this._pointerState.delete(a),this.refreshHasPendingInputs())};d.prototype._doubleClickTimeoutExceeded=
function(a){var b=this._pointerState.get(a);this._click.emit(b.event.data,void 0,b.event.modifiers);b.doubleClickTimeout=null;this._pointerState.delete(a);this.refreshHasPendingInputs()};return d}(a.InputHandler);b.SingleAndDoubleClick=g})},"esri/views/input/recognizers/support":function(){define(["require","exports","../../../core/screenUtils"],function(g,b,l){Object.defineProperty(b,"__esModule",{value:!0});b.manhattanDistance=function(b,f){return Math.abs(f.x-b.x)+Math.abs(f.y-b.y)};b.euclideanDistance=
function(b,f){var a=f.x-b.x;b=f.y-b.y;return Math.sqrt(a*a+b*b)};b.fitCircleLSQ=function(b,f){f?(f.radius=0,f.center.x=0,f.center.y=0):f={radius:0,center:l.createScreenPoint()};if(0===b.length)return f;if(1===b.length)return f.center.x=b[0].x,f.center.y=b[0].y,f;if(2===b.length){var a=b[0];b=b[1];var g=[b.x-a.x,b.y-a.y],k=g[0],g=g[1];f.radius=Math.sqrt(k*k+g*g)/2;f.center.x=(a.x+b.x)/2;f.center.y=(a.y+b.y)/2;return f}for(var d=0,c=0,e=0;e<b.length;e++)d+=b[e].x,c+=b[e].y;for(var d=d/b.length,c=c/
b.length,h=b.map(function(a){return a.x-d}),p=b.map(function(a){return a.y-c}),n=a=f=0,u=0,x=k=0,e=g=0;e<h.length;e++){var v=h[e],t=p[e],w=v*v,r=t*t;f+=w;a+=r;n+=v*t;u+=w*v;k+=r*t;x+=v*r;g+=t*w}e=f;h=n;p=a;u=.5*(u+x);k=.5*(k+g);g=e*p-n*h;x=(u*p-k*h)/g;k=(e*k-n*u)/g;g=l.createScreenPoint(x+d,k+c);return{radius:Math.sqrt(x*x+k*k+(f+a)/b.length),center:g}}})},"esri/views/input/recognizers/Drag":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/screenUtils ../../../layers/support/timeUtils ../InputHandler ./support".split(" "),
function(g,b,l,k,f,a,q){function m(a){var b=[];a.forEach(function(a){b.push(k.createScreenPoint(a.event.x,a.event.y))});return q.fitCircleLSQ(b)}function d(a){var b=m(a),c=0;a.forEach(function(a){for(var d=e(a,b),d=d-a.lastAngle;d>Math.PI;)d-=2*Math.PI;for(;d<-Math.PI;)d+=2*Math.PI;d=a.lastAngle+d;a.lastAngle=d;c+=d-a.initialAngle});c/=a.size||1;return{angle:c,radius:b.radius,center:b.center}}function c(a){var b=new Map;a.forEach(function(a,c){return b.set(c,a.event)});return b}function e(a,b){a=
a.event;return Math.atan2(a.y-b.center.y,a.x-b.center.x)}Object.defineProperty(b,"__esModule",{value:!0});g=function(a){function b(b){var c=a.call(this,!1)||this;c.navigationTouch=b;c.startStateModifiers=new Set;c.activePointerMap=new Map;c.isDragging=!1;c.isCurrentDragSuppressed=!1;c.drag=c.registerOutgoing("drag");c.registerIncoming("pointer-drag",c.handlePointerDrag.bind(c));c.registerIncoming("pointer-up",c.handlePointerUpAndPointerLost.bind(c));c.registerIncoming("pointer-capture-lost",c.handlePointerUpAndPointerLost.bind(c));
c.registerIncoming("pointer-cancel",c.handlePointerUpAndPointerLost.bind(c));return c}l(b,a);b.prototype.createPayload=function(a,b,e,d){return{action:a,pointerType:this.pointerType,button:this.mouseButton,buttons:b.buttons,timestamp:d,pointers:c(this.activePointerMap),pointer:b,angle:e.angle,radius:e.radius,center:e.center}};b.prototype.addPointer=function(a){var b=a.native.pointerId,c=d(this.activePointerMap).angle;a={event:a,initialAngle:0,lastAngle:0};this.activePointerMap.set(b,a);b=e(a,m(this.activePointerMap));
a.initialAngle=b;a.lastAngle=b;this.updatePointerAngles(c)};b.prototype.updatePointer=function(a){if(!a||null!=a.x||null!=a.y){var b=this.activePointerMap.get(a.native.pointerId);b?b.event=a:this.addPointer(a)}};b.prototype.removePointer=function(a){var b=d(this.activePointerMap).angle;this.activePointerMap.delete(a);this.updatePointerAngles(b)};b.prototype.updatePointerAngles=function(a){var b=d(this.activePointerMap);this.activePointerMap.forEach(function(c){c.initialAngle=e(c,b)-a;c.lastAngle=
e(c,b)-a})};b.prototype.emitEvent=function(a,b,c){var e=d(this.activePointerMap);this.drag.emit(this.createPayload(a,b,e,c),void 0,this.startStateModifiers)};b.prototype.handlePointerUpAndPointerLost=function(a){var b=a.data.native.pointerId,c=f.Milliseconds(a.timestamp);this.activePointerMap.get(b)&&(1===this.activePointerMap.size?(this.updatePointer(a.data),!this.isCurrentDragSuppressed&&this.emitEvent("end",a.data,c),this.isCurrentDragSuppressed=this.isDragging=!1,this.removePointer(b)):(this.removePointer(b),
this.emitEvent("removed",a.data,f.Milliseconds(a.timestamp))))};b.prototype.handlePointerDrag=function(a){var b=a.data,c=b.currentEvent,e=f.Milliseconds(a.timestamp);switch(b.action){case "start":case "update":this.isDragging?this.activePointerMap.has(c.native.pointerId)?(this.updatePointer(c),!this.isCurrentDragSuppressed&&this.emitEvent("update",c,e)):(this.addPointer(c),this.emitEvent("added",c,e),this.isCurrentDragSuppressed=this.isSuppressed):(this.updatePointer(c),this.pointerType=a.data.startEvent.pointerType,
this.mouseButton=a.data.startEvent.button,this.startStateModifiers=a.modifiers,this.isDragging=!0,this.isCurrentDragSuppressed=this.isSuppressed,!this.isCurrentDragSuppressed&&this.emitEvent("start",c,e))}};Object.defineProperty(b.prototype,"isSuppressed",{get:function(){return this.navigationTouch&&!this.navigationTouch.browserTouchPanEnabled&&"touch"===this.pointerType&&1===this.activePointerMap.size},enumerable:!0,configurable:!0});return b}(a.InputHandler);b.Drag=g;(function(a){a[a.Left=0]="Left";
a[a.Middle=1]="Middle";a[a.Right=2]="Right";a[a.Back=3]="Back";a[a.Forward=4]="Forward";a[a.Undefined=-1]="Undefined"})(b.Button||(b.Button={}))})},"esri/views/input/recognizers/ImmediateDoubleClick":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/clock ../InputHandler ./SingleAndDoubleClick ./support".split(" "),function(g,b,l,k,f,a,q){Object.defineProperty(b,"__esModule",{value:!0});g=function(b){function d(c,e,d,f,g){void 0===c&&(c=a.DefaultParameters.maximumDoubleClickDelay);
void 0===e&&(e=a.DefaultParameters.maximumDoubleClickDistance);void 0===d&&(d=a.DefaultParameters.maximumDoubleTouchDelay);void 0===f&&(f=a.DefaultParameters.maximumDoubleTouchDistance);void 0===g&&(g=k.default);var h=b.call(this,!1)||this;h.maximumDoubleClickDelay=c;h.maximumDoubleClickDistance=e;h.maximumDoubleTouchDelay=d;h.maximumDoubleTouchDistance=f;h._clock=g;h._pointerState=new Map;h._immediateDoubleClick=h.registerOutgoing("immediate-double-click");h.registerIncoming("pointer-down",h._handlePointerDown.bind(h));
h.registerIncoming("pointer-up",function(a){h._handlePointerLoss(a,"pointer-up")});h.registerIncoming("pointer-capture-lost",function(a){h._handlePointerLoss(a,"pointer-capture-lost")});h.registerIncoming("pointer-cancel",function(a){h._handlePointerLoss(a,"pointer-cancel")});return h}l(d,b);d.prototype.onUninstall=function(){this._pointerState.forEach(function(a){a.immediateDoubleClick&&a.immediateDoubleClick.timeoutHandle.remove()});b.prototype.onUninstall.call(this)};d.prototype._handlePointerDown=
function(a){a=a.data;var b=a.native.pointerId;this._pointerState.has(b)||(this._pointerState.set(b,{downButton:a.native.button,immediateDoubleClick:null}),this.startCapturingPointer(a.native))};d.prototype._handlePointerLoss=function(a,b){var c=a.data,e=this._pointerState.get(c.native.pointerId);if(e&&"pointer-up"===b&&e.downButton===c.native.button)if(b=e.immediateDoubleClick){b.timeoutHandle.remove();var d="touch"===a.data.native.pointerType?this.maximumDoubleTouchDistance:this.maximumDoubleClickDistance;
q.manhattanDistance(b,a.data)>d?this._startImmediateDoubleClick(a,e):(this._immediateDoubleClick.emit(a.data,void 0,b.modifiers),this._removeState(c.native))}else this._startImmediateDoubleClick(a,e)};d.prototype._startImmediateDoubleClick=function(a,b){var c=this;b.immediateDoubleClick={x:a.data.x,y:a.data.y,modifiers:a.modifiers,timeoutHandle:this._clock.setTimeout(function(){return c._removeState(a.data.native)},"touch"===a.data.native.pointerType?this.maximumDoubleTouchDelay:this.maximumDoubleClickDelay)}};
d.prototype._removeState=function(a){this._pointerState.delete(a.pointerId);this.stopCapturingPointer(a);this.refreshHasPendingInputs()};return d}(f.InputHandler);b.ImmediateDoubleClick=g})},"esri/views/input/recognizers/PointerClickHoldAndDrag":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/clock ../InputHandler ./support".split(" "),function(g,b,l,k,f,a){Object.defineProperty(b,"__esModule",{value:!0});b.DefaultParameters={maximumClickDelay:300,movementUntilMouseDrag:1.5,
movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500};g=function(f){function g(a,c,e,g,l,n){void 0===a&&(a=b.DefaultParameters.maximumClickDelay);void 0===c&&(c=b.DefaultParameters.movementUntilMouseDrag);void 0===e&&(e=b.DefaultParameters.movementUntilPenDrag);void 0===g&&(g=b.DefaultParameters.movementUntilTouchDrag);void 0===l&&(l=b.DefaultParameters.holdDelay);void 0===n&&(n=k.default);var d=f.call(this,!1)||this;d.maximumClickDelay=a;d.movementUntilMouseDrag=c;d.movementUntilPenDrag=
e;d.movementUntilTouchDrag=g;d.holdDelay=l;d._clock=n;d._pointerState=new Map;d._pointerDrag=d.registerOutgoing("pointer-drag");d._immediateClick=d.registerOutgoing("immediate-click");d._pointerHold=d.registerOutgoing("hold");d.registerIncoming("pointer-down",d._handlePointerDown.bind(d));d.registerIncoming("pointer-up",function(a){d._handlePointerLoss(a,"pointer-up")});d.registerIncoming("pointer-capture-lost",function(a){d._handlePointerLoss(a,"pointer-capture-lost")});d.registerIncoming("pointer-cancel",
function(a){d._handlePointerLoss(a,"pointer-cancel")});d._moveHandle=d.registerIncoming("pointer-move",d._handlePointerMove.bind(d));d._moveHandle.pause();return d}l(g,f);g.prototype.onUninstall=function(){this._pointerState.forEach(function(a){null!=a.holdTimeout&&(a.holdTimeout.remove(),a.holdTimeout=null)});f.prototype.onUninstall.call(this)};g.prototype._handlePointerDown=function(a){var b=this,e=a.data,d=e.native.pointerId,f=null;0===this._pointerState.size&&(f=this._clock.setTimeout(function(){var c=
b._pointerState.get(d);c&&(c.isDragging||(b._pointerHold.emit(c.previousEvent,void 0,a.modifiers),c.holdEmitted=!0),c.holdTimeout=null)},this.holdDelay));f={startEvent:e,previousEvent:e,startTimestamp:a.timestamp,isDragging:!1,downButton:e.native.button,holdTimeout:f,modifiers:new Set};this._pointerState.set(d,f);this.startCapturingPointer(e.native);this._moveHandle.resume();1<this._pointerState.size&&this.startDragging(a)};g.prototype._createPointerDragData=function(a,b,e){return{action:a,startEvent:b.startEvent,
previousEvent:b.previousEvent,currentEvent:e}};g.prototype._handlePointerMove=function(b){var c=b.data,e=this._pointerState.get(c.native.pointerId);if(e){if(e.isDragging)this._pointerDrag.emit(this._createPointerDragData("update",e,c),void 0,e.modifiers);else{var d=a.euclideanDistance(c,e.startEvent),f=this._getDragThreshold(c.native.pointerType);d>f&&this.startDragging(b)}e.previousEvent=c}};g.prototype._getDragThreshold=function(a){switch(a){case "touch":return this.movementUntilTouchDrag;case "pen":return this.movementUntilPenDrag;
default:return this.movementUntilMouseDrag}};g.prototype.startDragging=function(a){var b=this,e=a.data,d=e.native.pointerId;this._pointerState.forEach(function(c){null!=c.holdTimeout&&(c.holdTimeout.remove(),c.holdTimeout=null);c.isDragging||(c.modifiers=a.modifiers,c.isDragging=!0,d===c.startEvent.native.pointerId?b._pointerDrag.emit(b._createPointerDragData("start",c,e)):b._pointerDrag.emit(b._createPointerDragData("start",c,c.previousEvent),a.timestamp))})};g.prototype._handlePointerLoss=function(a,
b){var c=a.data,d=c.native.pointerId,f=this._pointerState.get(d);f&&(null!=f.holdTimeout&&(f.holdTimeout.remove(),f.holdTimeout=null),f.isDragging?this._pointerDrag.emit(this._createPointerDragData("end",f,"pointer-up"===b?c:f.previousEvent),void 0,f.modifiers):"pointer-up"===b&&f.downButton===c.native.button&&a.timestamp-f.startTimestamp<=this.maximumClickDelay&&!f.holdEmitted&&this._immediateClick.emit(c),this._pointerState.delete(d),this.stopCapturingPointer(c.native),0===this._pointerState.size&&
this._moveHandle.pause())};return g}(f.InputHandler);b.PointerClickHoldAndDrag=g})},"esri/views/2d/support/HighlightOptions":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../Color ../../../core/Accessor ../../../core/accessorSupport/decorators".split(" "),function(g,b,l,k,f,a,q){var m=0;return function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b.color=new f([0,255,255]);b.haloOpacity=1;b.fillOpacity=
.25;return b}l(b,a);Object.defineProperty(b.prototype,"version",{get:function(){return m++},enumerable:!0,configurable:!0});k([q.property({readOnly:!0,dependsOn:["color","haloColor","haloOpacity","fillOpacity"]})],b.prototype,"version",null);k([q.property({type:f})],b.prototype,"color",void 0);k([q.property({type:f})],b.prototype,"haloColor",void 0);k([q.property()],b.prototype,"haloOpacity",void 0);k([q.property()],b.prototype,"fillOpacity",void 0);return b=k([q.subclass("esri.views.2d.support.HighlightOptions")],
b)}(q.declared(a))})},"esri/views/support/screenshotUtils":function(){define(["require","exports","../../core/tsSupport/assignHelper","../../core/compilerUtils","../../core/mathUtils"],function(g,b,l,k,f){function a(a,b){var g=a||{},h=g.format,n=g.quality,l=g.rotation,g=g.disableSlice,m=e(a,b.padding),p;p=b.width-m.left-m.right;b=b.height-m.top-m.bottom;m={x:0,y:0,width:p,height:b};if(a&&a.area){null!=a.area.x&&(m.x=Math.floor(a.area.x));null!=a.area.y&&(m.y=Math.floor(a.area.y));var q=null!=a.area.width?
Math.floor(a.area.width):null,t=null!=a.area.height?Math.floor(a.area.height):null;m.width=p-m.x;m.height=b-m.y;null!=q&&null!=t?(m.width=Math.min(m.width,q),m.height=Math.min(m.height,t)):null==q&&null!=t?(q=Math.min(m.width,q),m.height*=q/m.width,m.width=q):null!=q&&null==t&&(q=Math.min(m.height,t),m.width*=q/m.height,m.height=q)}m=c(m,a);q=Math.floor(Math.max(m.x,0));t=Math.floor(Math.max(m.y,0));p={x:q,y:t,width:Math.floor(Math.min(m.width,p-q)),height:Math.floor(Math.min(m.height,b-t))};b=p.width/
p.height;m=m.width/m.height;m!==b&&(m>b?(b=Math.floor(p.width/m),p={x:p.x,y:Math.floor(p.y+(p.height-b)/2),width:p.width,height:b}):(b=Math.floor(p.height*m),p={x:Math.floor(p.x+(p.width-b)/2),y:p.y,width:b,height:p.height}));m=d(a,p);b=m.width;m=m.height;a:switch(h){case "png":case "jpg":case "jpeg":break a;case null:case void 0:h=u;break a;default:k.neverReached(h),h=u}q=x[h];n=f.clamp(null!=n?n:q,0,100);return{format:h,quality:n,area:p,width:b,height:m,rotation:l,disableSlice:!!g,ignoreBackground:!(!a||
!a.ignoreBackground),ignorePadding:!(!a||!a.ignorePadding)}}function q(a,b){return a.toDataURL(n[b.format],b.quality/100)}function m(a,b,c){c||(h||(h=document.createElement("canvas"),h.width=1,h.height=1),c=h);return c.getContext("2d").createImageData(a,b)}function d(a,b){if(!a)return b;var c=a.width;a=a.height;if(null!=c&&null!=a)return{width:Math.floor(c),height:Math.floor(a)};if(null==c&&null==a)return b;b=b.width/b.height;return null==a?{width:Math.floor(c),height:Math.floor(c/b)}:{width:Math.floor(a*
b),height:Math.floor(a)}}function c(a,b){if(!b||null==b.width||null==b.height)return a;b=b.width/b.height;var c=a.width/a.height;if(c===b)return a;if(c<b)return b=Math.floor(a.height*b),a.x-=(b-a.width)/2,a.width=b,a;b=Math.floor(a.width/b);a.y-=(b-a.height)/2;a.height=b;return a}function e(a,b){return!b||a&&a.ignorePadding?v:b}Object.defineProperty(b,"__esModule",{value:!0});b.completeUserSettings=a;b.toRenderSettings=function(b,c){var d=a(b,c),f=d.area,g=d.width/f.width,h=e(d,c.padding),n=h.left+
h.right,k=h.top+h.bottom;return{framebufferWidth:Math.floor((c.width-n)*g+n),framebufferHeight:Math.floor((c.height-k)*g+k),region:{x:Math.floor(f.x*g)+h.left,y:Math.floor(f.y*g)+h.top,width:d.width,height:d.height},format:d.format,quality:d.quality,rotation:d.rotation,pixelRatio:g,layers:b&&b.layers?b.layers:[],disableSlice:d.disableSlice,ignoreBackground:d.ignoreBackground,ignorePadding:d.ignorePadding}};b.encodeResult=function(a,b,c,e){if(e.premultipliedAlpha)for(var d=a.data,f=d.length,g=0;g<
f;g+=4){var h=d[g+3];0<h&&(h/=255,d[g+0]/=h,d[g+1]/=h,d[g+2]/=h)}c.width=a.width;c.height=a.height;d=c.getContext("2d");d.putImageData(a,0,0);e.flipY&&(d.save(),d.globalCompositeOperation="copy",d.scale(1,-1),d.translate(0,-d.canvas.height),d.drawImage(d.canvas,0,0),d.restore());a=d.getImageData(0,0,a.width,a.height);b=q(c,b);c.width=0;c.height=0;return{dataUrl:b,data:a}};b.toDataUrl=q;b.createEmptyImageData=function(a,b,c){if(!a||!b)throw Error("Cannot construct image data without dimensions");if(p)try{return new ImageData(a,
b)}catch(y){p=!1}return m(a,b,c)};b.wrapImageData=function(a,b,c,e){if(!b||!c)throw Error("Cannot construct image data without dimensions");if(p)try{return new ImageData(a,b,c)}catch(A){p=!1}b=m(b,c,e);b.data.set(a,0);return b};b.resampleHermite=function(a,b,c,e,d,f,g,h){void 0===e&&(e=0);void 0===d&&(d=0);void 0===f&&(f=a.width-e);void 0===g&&(g=a.height-d);void 0===h&&(h=!1);var n=a.data,k=b.width,l=b.height,m=b.data;f/=k;g/=l;var p=Math.ceil(f/2),q=Math.ceil(g/2);a=a.width;for(var r=0;r<l;r++)for(var t=
0;t<k;t++){for(var u=4*(t+(h?l-r-1:r)*k),w=0,v=0,x=0,y=0,A=0,z=0,B=(r+.5)*g,C=Math.floor(r*g);C<(r+1)*g;C++)for(var P=Math.abs(B-(C+.5))/q,V=(t+.5)*f,P=P*P,X=Math.floor(t*f);X<(t+1)*f;X++){var W=Math.abs(V-(X+.5))/p,W=Math.sqrt(P+W*W);if(!(1<=W)){var W=2*W*W*W-3*W*W+1,Z=4*(e+X+(d+C)*a),z=z+W*n[Z+3],v=v+W;!c&&255>n[Z+3]&&(W=W*n[Z+3]/255);x+=W*n[Z];y+=W*n[Z+1];A+=W*n[Z+2];w+=W}}m[u]=x/w;m[u+1]=y/w;m[u+2]=A/w;m[u+3]=z/v}return b};b.screenshotSuperSampleSettings=function(a,b,c){if(!b)return a;b=a.framebufferWidth;
var d=a.framebufferHeight,f=a.pixelRatio,g=a.region;c=e(a,c);var h=c.left+c.right,n=c.top+c.bottom,k=b-h,m=d-n,p=Math.min(8,Math.min((2048-h)/k,(2048-n)/m));return 1.5>p?a:l({},a,{framebufferWidth:Math.round(k*p)+h,framebufferHeight:Math.round(m*p)+n,pixelRatio:f*p,resample:{region:{x:Math.round((g.x-c.left)*p)+c.left,y:Math.round((g.y-c.top)*p)+c.top,width:Math.round(g.width*p),height:Math.round(g.height*p)},width:b,height:d}})};var h=null,p=!0,n={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},
u="jpg",x={png:100,jpg:98,jpeg:98},v={top:0,right:0,bottom:0,left:0}})},"esri/views/support/WebGLRequirements":function(){define(["require","exports","../../core/tsSupport/assignHelper","../../core/Error","../../core/has"],function(g,b,l,k,f){Object.defineProperty(b,"__esModule",{value:!0});var a={supportsMajorWebPerformanceCaveat:!1};b.check=function(b){b=l({},a,b);return f("esri-webgl")?!b.supportsMajorWebPerformanceCaveat&&f("esri-webgl-major-performance-caveat")?new k("webgl:major-performance-caveat-detected",
"Your WebGL implementation doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is blacklisted."):f("esri-webgl-high-precision-fragment")?f("esri-webgl-vertex-shader-samplers")?f("esri-webgl-element-index-uint")?f("esri-webgl-standard-derivatives")?f("esri-webgl-instanced-arrays")?null:new k("webgl:instanced-arrays-required","WebGL support for instanced rendering is required but not supported."):new k("webgl:standard-derivatives-required","WebGL support for standard derivatives is required but not supported."):
new k("webgl:element-index-uint-required","WebGL support for uint vertex indices is required but not supported."):new k("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported."):new k("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported."):new k("webgl:required","WebGL is required but not supported.")}})},"esri/views/ui/2d/DefaultUI2D":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../DefaultUI".split(" "),
function(g,b,l,k,f,a){return function(a){function b(b){b=a.call(this,b)||this;b.components=["attribution","zoom"];return b}l(b,a);k([f.property()],b.prototype,"components",void 0);return b=k([f.subclass("esri.views.ui.2d.DefaultUI2D")],b)}(f.declared(a))})},"esri/views/ui/DefaultUI":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/watchUtils ../../core/accessorSupport/decorators ./Component ./UI ../../widgets/Attribution ../../widgets/Compass ../../widgets/NavigationToggle ../../widgets/Zoom".split(" "),
function(g,b,l,k,f,a,q,m,d,c,e,h){return function(b){function g(a){a=b.call(this,a)||this;a._defaultPositionLookup={attribution:"manual",compass:"top-leading","navigation-toggle":"top-leading",zoom:"top-leading"};a.components=[];return a}l(g,b);g.prototype.initialize=function(){this._handles.add([f.init(this,"components",this._componentsWatcher.bind(this)),f.init(this,"view",this._updateViewAwareWidgets.bind(this))])};g.prototype._removeComponents=function(a){var b=this;a.forEach(function(a){if(a=
b._find(a))b.remove(a),a.destroy()})};g.prototype._updateViewAwareWidgets=function(a){var b=this;this.components.forEach(function(c){(c=(c=b._find(c))&&c.widget)&&void 0!==c.view&&(c.view=a)})};g.prototype._componentsWatcher=function(a,b){this._removeComponents(b);this._addComponents(a);this._adjustPadding(a)};g.prototype._adjustPadding=function(a){-1!==a.indexOf("attribution")||this._isOverridden("padding")||(this.padding=this.padding.top)};g.prototype._addComponents=function(a){var b=this;this.initialized&&
a.forEach(function(a){return b.add(b._createComponent(a),b._defaultPositionLookup[a])})};g.prototype._createComponent=function(a){var b=this._createWidget(a);if(b)return new q({id:a,node:b})};g.prototype._createWidget=function(a){if("attribution"===a)return this._createAttribution();if("compass"===a)return this._createCompass();if("navigation-toggle"===a)return this._createNavigationToggle();if("zoom"===a)return this._createZoom()};g.prototype._createAttribution=function(){return new d({view:this.view})};
g.prototype._createCompass=function(){return new c({view:this.view})};g.prototype._createNavigationToggle=function(){return new e({view:this.view})};g.prototype._createZoom=function(){return new h({view:this.view})};k([a.property()],g.prototype,"components",void 0);return g=k([a.subclass("esri.views.ui.DefaultUI")],g)}(a.declared(m))})},"esri/views/ui/Component":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/domUtils ../../core/accessorSupport/decorators".split(" "),
function(g,b,l,k,f,a,q){return function(b){function d(){var a=null!==b&&b.apply(this,arguments)||this;a.widget=null;return a}l(d,b);d.prototype.destroy=function(){this.widget&&this.widget.destroy();this.node=null};Object.defineProperty(d.prototype,"id",{get:function(){return this.get("widget.id")||this.get("node.id")},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"node",{set:function(a){var b=this._get("node");a!==b&&(a&&a.classList.add("esri-component"),b&&b.classList.remove("esri-component"),
this._set("node",a))},enumerable:!0,configurable:!0});d.prototype.castNode=function(b){if(!b)return this._set("widget",null),null;if("string"===typeof b||b&&"nodeType"in b)return this._set("widget",null),a.byId(b);b&&"function"===typeof b.render&&!b.domNode&&(b.domNode=document.createElement("div"));this._set("widget",b);return b.domNode};k([q.property()],d.prototype,"id",null);k([q.property()],d.prototype,"node",null);k([q.cast("node")],d.prototype,"castNode",null);k([q.property({readOnly:!0})],
d.prototype,"widget",void 0);return d=k([q.subclass("esri.views.ui.Component")],d)}(q.declared(f))})},"esri/views/ui/UI":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/domUtils ../../core/Evented ../../core/Handles ../../core/watchUtils ../../core/accessorSupport/decorators ./Component ../../widgets/support/widgetUtils".split(" "),function(g,b,l,k,f,a,q,m,d,c,e,h){function p(a){return"object"!==
typeof a||a instanceof e||"declaredClass"in a||!("component"in a||"index"in a||"position"in a)?null:a}function n(a,b){var c=b.bottom,e=b.left,d=b.right;a.style.top=b.top;a.style.bottom=c;a.style.left=e;a.style.right=d}var u={left:0,top:0,bottom:0,right:0},x={bottom:30,top:15,right:15,left:15};return function(b){function g(a){a=b.call(this,a)||this;a._cornerNameToContainerLookup={};a._positionNameToContainerLookup={};a._components=[];a._componentToKey=new Map;a._handles=new m;a.view=null;a._initContainers();
return a}k(g,b);g.prototype.initialize=function(){this._handles.add([d.init(this,"view.padding, container",this._applyViewPadding.bind(this)),d.init(this,"padding",this._applyUIPadding.bind(this))])};g.prototype.destroy=function(){this.container=null;for(var a=0,b=this._components;a<b.length;a++)b[a].destroy();this._components.length=0;this._handles.destroy();this._componentToKey.clear()};Object.defineProperty(g.prototype,"container",{set:function(b){var c=this._get("container");b!==c&&(b&&(b.classList.add("esri-ui"),
this._attachContainers(b)),c&&(c.classList.remove("esri-ui"),n(c,{top:"",bottom:"",left:"",right:""}),a.empty(c)),this._set("container",b))},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"height",{get:function(){var a=this.get("view.height")||0;if(0===a)return a;var b=this._getViewPadding();return Math.max(a-(b.top+b.bottom),0)},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"padding",{get:function(){return this._get("padding")},set:function(a){a?this._override("padding",
a):this._clearOverride("padding")},enumerable:!0,configurable:!0});g.prototype.castPadding=function(a){return"number"===typeof a?{bottom:a,top:a,right:a,left:a}:l({},x,a)};Object.defineProperty(g.prototype,"width",{get:function(){var a=this.get("view.width")||0;if(0===a)return a;var b=this._getViewPadding();return Math.max(a-(b.left+b.right),0)},enumerable:!0,configurable:!0});g.prototype.add=function(a,b){var c=this,d,f;if(Array.isArray(a))a.forEach(function(a){return c.add(a,b)});else{var g=p(a);
g&&(d=g.index,b=g.position,a=g.component,f=g.key);b&&"object"===typeof b&&(d=b.index,f=b.key,b=b.position);!a||b&&!this._isValidPosition(b)||(a instanceof e||(a=new e({node:a})),this._place({component:a,position:b,index:d}),this._components.push(a),f&&this._componentToKey.set(a,f))}};g.prototype.remove=function(a,b){var c=this;if(a){if(Array.isArray(a))return a.map(function(a){return c.remove(a,b)});var e=this._find(a);if(e){var d=this._componentToKey;if(!d.has(a)||d.get(a)===b)return d=this._components.indexOf(e),
e.node.parentNode&&e.node.parentNode.removeChild(e.node),this._componentToKey.delete(a),this._components.splice(d,1)[0]}}};g.prototype.empty=function(a){var b=this;if(Array.isArray(a))return a.map(function(a){return b.empty(a)}).reduce(function(a,b){return a.concat(b)});a=a||"manual";return"manual"===a?Array.prototype.slice.call(this._manualContainer.children).filter(function(a){return!a.classList.contains("esri-ui-corner")}).map(function(a){return b.remove(a)}):this._isValidPosition(a)?Array.prototype.slice.call(this._cornerNameToContainerLookup[a].children).map(this.remove,
this):null};g.prototype.move=function(a,b){var c=this;Array.isArray(a)&&a.forEach(function(a){return c.move(a,b)});if(a){var e,d=p(a)||p(b);d&&(e=d.index,b=d.position,a=d.component||a);(!b||this._isValidPosition(b))&&(a=this.remove(a))&&this.add(a,{position:b,index:e})}};g.prototype.find=function(a){return a?(a=this._findById(a))&&(a.widget||a.node):null};g.prototype._find=function(a){return a?a instanceof e?this._findByComponent(a):"string"===typeof a?this._findById(a):this._findByNode(a.domNode||
a):null};g.prototype._getViewPadding=function(){return this.get("view.padding")||u};g.prototype._attachContainers=function(a){a.appendChild(this._innerContainer);a.appendChild(this._manualContainer)};g.prototype._initContainers=function(){var a=document.createElement("div");a.classList.add("esri-ui-inner-container");a.classList.add("esri-ui-corner-container");var b=document.createElement("div");b.classList.add("esri-ui-inner-container");b.classList.add("esri-ui-manual-container");var c=document.createElement("div");
c.classList.add("esri-ui-top-left");c.classList.add("esri-ui-corner");a.appendChild(c);var e=document.createElement("div");e.classList.add("esri-ui-top-right");e.classList.add("esri-ui-corner");a.appendChild(e);var d=document.createElement("div");d.classList.add("esri-ui-bottom-left");d.classList.add("esri-ui-corner");a.appendChild(d);var f=document.createElement("div");f.classList.add("esri-ui-bottom-right");f.classList.add("esri-ui-corner");a.appendChild(f);this._innerContainer=a;this._manualContainer=
b;a=h.isRTL();this._cornerNameToContainerLookup={"top-left":c,"top-right":e,"bottom-left":d,"bottom-right":f,"top-leading":a?e:c,"top-trailing":a?c:e,"bottom-leading":a?f:d,"bottom-trailing":a?d:f};this._positionNameToContainerLookup=l({manual:b},this._cornerNameToContainerLookup)};g.prototype._isValidPosition=function(a){return!!this._positionNameToContainerLookup[a]};g.prototype._place=function(b){var c=b.component,e=b.index;b=this._positionNameToContainerLookup[b.position||"manual"];var d=-1<e,
f=c.widget;f&&!f._started&&"function"===typeof f.postMixInProperties&&"function"===typeof f.buildRendering&&"function"===typeof f.postCreate&&"function"===typeof f.startup&&c.widget.startup();d?(d=Array.prototype.slice.call(b.children),0===e?b.firstChild?a.insertBefore(c.node,b.firstChild):b.appendChild(c.node):e>=d.length?b.appendChild(c.node):a.insertBefore(c.node,d[e])):b.appendChild(c.node)};g.prototype._applyViewPadding=function(){var a=this.container;a&&n(a,this._toPxPosition(this._getViewPadding()))};
g.prototype._applyUIPadding=function(){var a=this._innerContainer;a&&n(a,this._toPxPosition(this.padding))};g.prototype._toPxPosition=function(a){return{top:this._toPxUnit(a.top),left:this._toPxUnit(a.left),right:this._toPxUnit(a.right),bottom:this._toPxUnit(a.bottom)}};g.prototype._toPxUnit=function(a){return 0===a?"0":a+"px"};g.prototype._findByComponent=function(a){var b=null,c;this._components.some(function(e){(c=e===a)&&(b=e);return c});return b};g.prototype._findById=function(a){var b=null,
c;this._components.some(function(e){(c=e.id===a)&&(b=e);return c});return b};g.prototype._findByNode=function(a){var b=null,c;this._components.some(function(e){(c=e.node===a)&&(b=e);return c});return b};f([c.property()],g.prototype,"container",null);f([c.property({dependsOn:["view.height"]})],g.prototype,"height",null);f([c.property({value:x})],g.prototype,"padding",null);f([c.cast("padding")],g.prototype,"castPadding",null);f([c.property()],g.prototype,"view",void 0);f([c.property({dependsOn:["view.width"]})],
g.prototype,"width",null);return g=f([c.subclass("esri.views.ui.UI")],g)}(c.declared(q.EventedAccessor))})},"esri/widgets/Attribution":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/i18n!./Attribution/nls/Attribution ../core/watchUtils ../core/accessorSupport/decorators ./Widget ./Attribution/AttributionViewModel ./support/widget".split(" "),function(g,b,l,k,f,a,q,m,d,c){return function(b){function e(a){a=b.call(this,a)||this;a._isOpen=
!1;a._attributionTextOverflowed=!1;a._prevSourceNodeHeight=0;a.iconClass="esri-icon-description";a.itemDelimiter=" | ";a.label=f.widgetLabel;a.view=null;a.viewModel=new d;return a}l(e,b);e.prototype.postInitialize=function(){var b=this;this.own(a.on(this,"viewModel.items","change",function(){return b.scheduleRender()}))};Object.defineProperty(e.prototype,"attributionText",{get:function(){return this.viewModel.items.reduce(function(a,b){-1===a.indexOf(b.text)&&a.push(b.text);return a},[]).join(this.itemDelimiter)},
enumerable:!0,configurable:!0});e.prototype.render=function(){var a,b=(a={},a["esri-attribution--open"]=this._isOpen,a);return c.tsx("div",{bind:this,class:this.classes("esri-attribution esri-widget",b),onclick:this._toggleState,onkeydown:this._toggleState},this._renderSourcesNode(),c.tsx("div",{class:"esri-attribution__powered-by"},"Powered by"," ",c.tsx("a",{class:this.classes("esri-attribution__link","esri-widget__anchor"),href:"http://www.esri.com/",target:"_blank",rel:"noreferrer"},"Esri")))};
e.prototype._renderSourcesNode=function(){var a,b=this._isOpen,e=this._isInteractive(),d=e?0:-1,f=this.attributionText,g=e?"button":void 0,b=(a={},a["esri-attribution__sources--open"]=b,a["esri-interactive"]=e,a);return c.tsx("div",{afterCreate:this._afterSourcesNodeCreate,afterUpdate:this._afterSourcesNodeUpdate,bind:this,class:this.classes("esri-attribution__sources",b),innerHTML:f,role:g,tabIndex:d})};e.prototype._afterSourcesNodeCreate=function(a){this._prevSourceNodeHeight=a.clientWidth};e.prototype._afterSourcesNodeUpdate=
function(a){var b=!1,c=a.clientHeight;a=a.scrollWidth>=a.clientWidth;var e=this._attributionTextOverflowed!==a;this._attributionTextOverflowed=a;e&&(b=!0);this._isOpen&&(a=c<this._prevSourceNodeHeight,this._prevSourceNodeHeight=c,a&&(this._isOpen=!1,b=!0));b&&this.scheduleRender()};e.prototype._toggleState=function(){this._isInteractive()&&(this._isOpen=!this._isOpen)};e.prototype._isInteractive=function(){return this._isOpen||this._attributionTextOverflowed};k([q.property({dependsOn:["viewModel.items.length",
"itemDelimiter"],readOnly:!0}),c.renderable()],e.prototype,"attributionText",null);k([q.property()],e.prototype,"iconClass",void 0);k([q.property(),c.renderable()],e.prototype,"itemDelimiter",void 0);k([q.property()],e.prototype,"label",void 0);k([q.aliasOf("viewModel.view")],e.prototype,"view",void 0);k([q.property({type:d}),c.renderable(["state","view.size"])],e.prototype,"viewModel",void 0);k([c.accessibleHandler()],e.prototype,"_toggleState",null);return e=k([q.subclass("esri.widgets.Attribution")],
e)}(q.declared(m))})},"esri/widgets/Attribution/AttributionViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/awaiterHelper ../../core/tsSupport/generatorHelper ../../geometry ../../core/arrayUtils ../../core/asyncUtils ../../core/Collection ../../core/HandleOwner ../../core/watchUtils ../../core/accessorSupport/decorators ../../geometry/support/contains ../../geometry/support/webMercatorUtils".split(" "),
function(g,b,l,k,f,a,q,m,d,c,e,h,p,n,u){function x(a,b){return a.length!==b.length||a.some(function(a,c){return a.text!==b[c].text})}function v(a,b,c){c&&b&&(m.find(a,function(a){return a.layerView===b&&a.text===c})||a.push({text:c,layerView:b}))}var t=[];return function(b){function e(a){var e=b.call(this,a)||this;e.clear=function(){e._fetchedAttributionData.clear();e._pendingAttributions.clear();e.handles.remove("suspension");e.notifyChange("state")};e._pendingAttributions=new Set;e._fetchedAttributionData=
new Map;e.items=new c;e.view=null;e._allLayerViewsChange=function(a){e.handles.remove("suspension");var b=e.get("view.allLayerViews");b&&e.handles.add(b.map(function(a){return a.watch(["suspended","attributionVisible"],e._updateAttributionItems)}),"suspension");a&&a.removed&&a.removed.forEach(function(a){e._pendingAttributions.delete(a);e._fetchedAttributionData.delete(a)});e._updateAttributionItems()};e._updateAttributionItems=function(){var a=e.get("view.allLayerViews");t.length=0;a?(a.forEach(function(a){if(!a.suspended&&
a.get("layer.attributionVisible")){var b=a.layer;if(b&&"copyright"in b&&"function"===typeof b.originOf&&"user"===b.originOf("copyright"))v(t,a,b.copyright);else if(b.hasAttributionData)if(e._fetchedAttributionData.has(a)){var c=e._fetchedAttributionData.get(a);c&&v(t,a,e._getDynamicAttribution(c,e.view,b))}else e._fetchAttributionData(a);else(c=b.get("portalItem.accessInformation"))?v(t,a,c):v(t,a,b.copyright)}}),x(e.items,t)&&(e.items.removeAll(),e.items.addMany(t)),e.notifyChange("state")):e.clear()};
e.handles.add([h.on(e,"view.allLayerViews","change",e._allLayerViewsChange,e._allLayerViewsChange,e.clear),h.whenTrue(e,"view.stationary",function(){return e._updateAttributionItems()})]);return e}l(e,b);e.prototype.destroy=function(){this.view=null;this._fetchedAttributionData.clear();this._pendingAttributions.clear()};Object.defineProperty(e.prototype,"state",{get:function(){return this.get("view.ready")?0<this._pendingAttributions.size?"loading":"ready":"disabled"},enumerable:!0,configurable:!0});
e.prototype._fetchAttributionData=function(b){return f(this,void 0,void 0,function(){var c,e;return a(this,function(a){switch(a.label){case 0:if(this._pendingAttributions.has(b))return[2];this._pendingAttributions.add(b);return[4,d.result(b.layer.fetchAttributionData())];case 1:return c=a.sent(),this._pendingAttributions.has(b)&&(e=c.ok?this._createContributionIndex(c.value,"bing-maps"===b.layer.type):null,this._pendingAttributions.delete(b),this._fetchedAttributionData.set(b,e)),this._updateAttributionItems(),
[2]}})})};e.prototype._createContributionIndex=function(a,b){a=a.contributors;var c={};if(!a)return c;for(var e=0;e<a.length;e++){var d=a[e],f=d.coverageAreas;if(!f)return;for(var g=0;g<f.length;g++)for(var h=f[g],n=h.bbox,k=h.zoomMin-(b&&h.zoomMin?1:0),l=h.zoomMax-(b&&h.zoomMax?1:0),h={extent:u.geographicToWebMercator({xmin:n[1],ymin:n[0],xmax:n[3],ymax:n[2],spatialReference:q.SpatialReference.WGS84}),attribution:d.attribution||"",score:null!=h.score?h.score:100,id:e};k<=l;k++)c[k]=c[k]||[],c[k].push(h)}c.maxKey=
Math.max.apply(null,Object.keys(c));return c};e.prototype._getDynamicAttribution=function(a,b,c){var e=b.extent;c=c.tileInfo.scaleToZoom(b.scale);c=Math.min(a.maxKey,Math.round(c));if(!e||null==c||-1>=c)return"";a=a[c];var d=u.project(e.center.clone().normalize(),b.spatialReference),f={};return a?a.filter(function(a){var b=!f[a.id]&&d&&n.extentContainsPoint(a.extent,d);b&&(f[a.id]=!0);return b}).sort(function(a,b){return b.score-a.score||a.objectId-b.objectId}).map(function(a){return a.attribution}).join(", "):
""};k([p.property({readOnly:!0,type:c})],e.prototype,"items",void 0);k([p.property({dependsOn:["view.ready"],readOnly:!0})],e.prototype,"state",null);k([p.property()],e.prototype,"view",void 0);return e=k([p.subclass("esri.widgets.Attribution.AttributionViewModel")],e)}(p.declared(e.HandleOwner))})},"esri/widgets/Compass":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/i18n!./Compass/nls/Compass ../core/accessorSupport/decorators ./Widget ./Compass/CompassViewModel ./support/widget".split(" "),
function(g,b,l,k,f,a,q,m,d){return function(b){function c(a){a=b.call(this,a)||this;a.goToOverride=null;a.iconClass="esri-icon-locate-circled";a.label=f.widgetLabel;a.view=null;a.viewModel=new m;return a}l(c,b);c.prototype.reset=function(){};c.prototype.render=function(){var a,b,c=this.viewModel,e=c.orientation,c=c.state,g="disabled"===c,k="compass"===("rotation"===c?"rotation":"compass"),c=g?-1:0,g=(a={},a["esri-disabled"]=g,a["esri-interactive"]=!g,a);a=(b={},b["esri-icon-compass"]=k,b["esri-icon-dial"]=
!k,b);return d.tsx("div",{bind:this,class:this.classes("esri-compass esri-widget--button esri-widget",g),onclick:this._reset,onkeydown:this._reset,role:"button",tabIndex:c,"aria-label":f.reset,title:f.reset},d.tsx("span",{"aria-hidden":"true",class:this.classes("esri-compass__icon",a),styles:this._toRotationTransform(e)}),d.tsx("span",{class:"esri-icon-font-fallback-text"},f.reset))};c.prototype._reset=function(){this.viewModel.reset()};c.prototype._toRotationTransform=function(a){return{transform:"rotateZ("+
a.z+"deg)"}};k([a.aliasOf("viewModel.goToOverride")],c.prototype,"goToOverride",void 0);k([a.property()],c.prototype,"iconClass",void 0);k([a.property()],c.prototype,"label",void 0);k([a.aliasOf("viewModel.view")],c.prototype,"view",void 0);k([a.property({type:m}),d.renderable(["viewModel.orientation","viewModel.state"])],c.prototype,"viewModel",void 0);k([a.aliasOf("viewModel.reset")],c.prototype,"reset",null);k([d.accessibleHandler()],c.prototype,"_reset",null);return c=k([a.subclass("esri.widgets.Compass")],
c)}(a.declared(q))})},"esri/widgets/Compass/CompassViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/Handles ../../core/watchUtils ../../core/accessorSupport/decorators ../support/GoTo".split(" "),function(g,b,l,k,f,a,q,m,d){return function(b){function c(c){c=b.call(this,c)||this;c._handles=new a;c.orientation={x:0,y:0,z:0};c.view=null;c._updateForCamera=c._updateForCamera.bind(c);c._updateForRotation=
c._updateForRotation.bind(c);c._updateRotationWatcher=c._updateRotationWatcher.bind(c);c.view;return c}l(c,b);c.prototype.initialize=function(){this._handles.add(q.init(this,"view",this._updateRotationWatcher))};c.prototype.destroy=function(){this._handles.destroy();this.view=this._handles=null};Object.defineProperty(c.prototype,"canShowNorth",{get:function(){var a=this.get("view.spatialReference");return!(!a||!a.isWebMercator&&!a.isGeographic)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,
"state",{get:function(){return this.get("view.ready")?this.canShowNorth?"compass":"rotation":"disabled"},enumerable:!0,configurable:!0});c.prototype.reset=function(){if(this.get("view.ready")){var a={};"2d"===this.view.type?a.rotation=0:a.heading=0;this.callGoTo({target:a})}};c.prototype._updateForRotation=function(a){void 0!==a&&null!==a&&(this.orientation={z:a})};c.prototype._updateForCamera=function(a){a&&(this.orientation={x:0,y:0,z:-a.heading})};c.prototype._updateRotationWatcher=function(a){this._handles.removeAll();
a&&("2d"===a.type?this._handles.add(q.init(this,"view.rotation",this._updateForRotation)):this._handles.add(q.init(this,"view.camera",this._updateForCamera)))};k([m.property({dependsOn:["view.spatialReference.isWebMercator","view.spatialReference.wkid"],readOnly:!0})],c.prototype,"canShowNorth",null);k([m.property()],c.prototype,"orientation",void 0);k([m.property({dependsOn:["view.ready","canShowNorth"],readOnly:!0})],c.prototype,"state",null);k([m.property()],c.prototype,"view",void 0);k([m.property()],
c.prototype,"reset",null);return c=k([m.subclass("esri.widgets.CompassViewModel")],c)}(m.declared(d.GoToMixin(f)))})},"esri/widgets/NavigationToggle":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/i18n!./NavigationToggle/nls/NavigationToggle ../core/accessorSupport/decorators ./Widget ./NavigationToggle/NavigationToggleViewModel ./support/widget".split(" "),function(g,b,l,k,f,a,q,m,d){return function(b){function c(a){a=b.call(this,a)||
this;a.iconClass="esri-icon-pan2";a.label=f.widgetLabel;a.view=null;a.viewModel=new m;return a}l(c,b);Object.defineProperty(c.prototype,"layout",{set:function(a){"horizontal"!==a&&(a="vertical");this._set("layout",a)},enumerable:!0,configurable:!0});c.prototype.toggle=function(){};c.prototype.render=function(){var a,b,c,e="disabled"===this.get("viewModel.state"),g="pan"===this.get("viewModel.navigationMode"),k=(a={},a["esri-disabled"]=e,a["esri-navigation-toggle--horizontal"]="horizontal"===this.layout,
a);a=(b={},b["esri-navigation-toggle__button--active"]=g,b);b=(c={},c["esri-navigation-toggle__button--active"]=!g,c);c=e?-1:0;return d.tsx("div",{bind:this,class:this.classes("esri-navigation-toggle esri-widget",k),onclick:this._toggle,onkeydown:this._toggle,tabIndex:c,"aria-label":f.toggle,title:f.toggle},d.tsx("div",{class:this.classes("esri-navigation-toggle__button esri-widget--button","esri-navigation-toggle__button--pan",a)},d.tsx("span",{class:"esri-icon-pan"})),d.tsx("div",{class:this.classes("esri-navigation-toggle__button esri-widget--button",
"esri-navigation-toggle__button--rotate",b)},d.tsx("span",{class:"esri-icon-rotate"})))};c.prototype._toggle=function(){this.toggle()};k([a.property()],c.prototype,"iconClass",void 0);k([a.property()],c.prototype,"label",void 0);k([a.property({value:"vertical"}),d.renderable()],c.prototype,"layout",null);k([a.aliasOf("viewModel.view"),d.renderable()],c.prototype,"view",void 0);k([a.property({type:m}),d.renderable(["viewModel.state","viewModel.navigationMode"])],c.prototype,"viewModel",void 0);k([a.aliasOf("viewModel.toggle")],
c.prototype,"toggle",null);k([d.accessibleHandler()],c.prototype,"_toggle",null);return c=k([a.subclass("esri.widgets.NavigationToggle")],c)}(a.declared(q))})},"esri/widgets/NavigationToggle/NavigationToggleViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/Handles ../../core/watchUtils ../../core/accessorSupport/decorators".split(" "),function(g,b,l,k,f,a,q,m){return function(b){function c(c){c=
b.call(this,c)||this;c._handles=new a;c.navigationMode="pan";c.view=null;c.toggle=c.toggle.bind(c);return c}l(c,b);c.prototype.initialize=function(){this._handles.add(q.when(this,"view.inputManager",this._setNavigationMode.bind(this)))};c.prototype.destroy=function(){this._handles.destroy();this.view=this._handles=null};Object.defineProperty(c.prototype,"state",{get:function(){return this.get("view.ready")&&"3d"===this.view.type?"ready":"disabled"},enumerable:!0,configurable:!0});c.prototype.toggle=
function(){"disabled"!==this.state&&(this.navigationMode="pan"!==this.navigationMode?"pan":"rotate",this._setNavigationMode())};c.prototype._setNavigationMode=function(){this.get("view.inputManager").primaryDragAction="pan"===this.navigationMode?"pan":"rotate"};k([m.property({dependsOn:["view.ready"],readOnly:!0})],c.prototype,"state",null);k([m.property()],c.prototype,"navigationMode",void 0);k([m.property()],c.prototype,"view",void 0);k([m.property()],c.prototype,"toggle",null);return c=k([m.subclass("esri.widgets.NavigationToggleViewModel")],
c)}(m.declared(f))})},"esri/widgets/Zoom":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/i18n!./Zoom/nls/Zoom ../core/accessorSupport/decorators ./Widget ./Zoom/IconButton ./Zoom/ZoomViewModel ./support/widget".split(" "),function(g,b,l,k,f,a,q,m,d,c){return function(b){function e(a){a=b.call(this,a)||this;a.iconClass="esri-icon-zoom-in-magnifying-glass";a.label=f.widgetLabel;a.view=null;a.viewModel=new d;return a}l(e,b);e.prototype.postInitialize=
function(){this._zoomInButton=new m({action:this.zoomIn,iconClass:"esri-icon-plus",title:f.zoomIn});this._zoomOutButton=new m({action:this.zoomOut,iconClass:"esri-icon-minus",title:f.zoomOut})};Object.defineProperty(e.prototype,"layout",{set:function(a){"horizontal"!==a&&(a="vertical");this._set("layout",a)},enumerable:!0,configurable:!0});e.prototype.render=function(){var a,b=this.viewModel,e=(a={},a["esri-zoom--horizontal"]="horizontal"===this.layout,a);this._zoomInButton.enabled="ready"===b.state&&
b.canZoomIn;this._zoomOutButton.enabled="ready"===b.state&&b.canZoomOut;return c.tsx("div",{class:this.classes("esri-zoom esri-widget",e)},this._zoomInButton.render(),this._zoomOutButton.render())};e.prototype.zoomIn=function(){};e.prototype.zoomOut=function(){};k([a.property()],e.prototype,"iconClass",void 0);k([a.property()],e.prototype,"label",void 0);k([a.property({value:"vertical"}),c.renderable()],e.prototype,"layout",null);k([a.aliasOf("viewModel.view"),c.renderable()],e.prototype,"view",void 0);
k([a.property({type:d}),c.renderable(["viewModel.canZoomIn","viewModel.canZoomOut","viewModel.state"])],e.prototype,"viewModel",void 0);k([a.aliasOf("viewModel.zoomIn")],e.prototype,"zoomIn",null);k([a.aliasOf("viewModel.zoomOut")],e.prototype,"zoomOut",null);return e=k([a.subclass("esri.widgets.Zoom")],e)}(a.declared(q))})},"esri/widgets/Zoom/IconButton":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../Widget ../support/widget".split(" "),
function(g,b,l,k,f,a,q){return function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b.enabled=!0;b.iconClass="";b.title="";return b}l(b,a);b.prototype.render=function(){var a,b,d=this.enabled?0:-1,f=(a={},a["esri-disabled"]=!this.enabled,a["esri-interactive"]=this.enabled,a);a=(b={},b[this.iconClass]=!!this.iconClass,b);return q.tsx("div",{bind:this,class:this.classes("esri-widget--button esri-widget",f),onclick:this._triggerAction,onkeydown:this._triggerAction,role:"button",tabIndex:d,
title:this.title},q.tsx("span",{"aria-hidden":"true",role:"presentation",class:this.classes("esri-icon",a)}),q.tsx("span",{class:"esri-icon-font-fallback-text"},this.title))};b.prototype._triggerAction=function(){this.action.call(this)};k([f.property()],b.prototype,"action",void 0);k([f.property(),q.renderable()],b.prototype,"enabled",void 0);k([f.property(),q.renderable()],b.prototype,"iconClass",void 0);k([f.property(),q.renderable()],b.prototype,"title",void 0);k([q.accessibleHandler()],b.prototype,
"_triggerAction",null);return b=k([f.subclass("esri.widgets.IconButton")],b)}(f.declared(a))})},"esri/widgets/Zoom/ZoomViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/promiseUtils ../../core/accessorSupport/decorators ./ZoomConditions2D ./ZoomConditions3D".split(" "),function(g,b,l,k,f,a,q,m,d){return function(b){function c(a){a=b.call(this,a)||this;a.canZoomIn=!1;a.canZoomOut=!1;a.zoomIn=a.zoomIn.bind(a);
a.zoomOut=a.zoomOut.bind(a);return a}l(c,b);c.prototype.destroy=function(){this.view=null};Object.defineProperty(c.prototype,"state",{get:function(){return this.get("view.ready")?"ready":"disabled"},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"view",{set:function(a){a?"2d"===a.type?this._zoomConditions=new m({view:a}):"3d"===a.type&&(this._zoomConditions=new d({view:a})):this._zoomConditions=null;this._set("view",a)},enumerable:!0,configurable:!0});c.prototype.zoomIn=function(){if(this.canZoomIn){var b=
this.view;"2d"===b.type?b.mapViewNavigation.zoomIn():a.ignoreAbortErrors(b.goTo({zoomFactor:2}))}};c.prototype.zoomOut=function(){if(this.canZoomOut){var b=this.view;"2d"===b.type?b.mapViewNavigation.zoomOut():a.ignoreAbortErrors(b.goTo({zoomFactor:.5}))}};k([q.property()],c.prototype,"_zoomConditions",void 0);k([q.property({aliasOf:"_zoomConditions.canZoomIn",readOnly:!0})],c.prototype,"canZoomIn",void 0);k([q.property({aliasOf:"_zoomConditions.canZoomOut",readOnly:!0})],c.prototype,"canZoomOut",
void 0);k([q.property({dependsOn:["view.ready"],readOnly:!0})],c.prototype,"state",null);k([q.property()],c.prototype,"view",null);k([q.property()],c.prototype,"zoomIn",null);k([q.property()],c.prototype,"zoomOut",null);return c=k([q.subclass("esri.widgets.Zoom.ZoomViewModel")],c)}(q.declared(f))})},"esri/widgets/Zoom/ZoomConditions2D":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators".split(" "),
function(g,b,l,k,f,a){return function(b){function f(){return null!==b&&b.apply(this,arguments)||this}l(f,b);Object.defineProperty(f.prototype,"canZoomIn",{get:function(){if(!this.get("view.ready"))return!1;var a=this.get("view.animation.target.scale")||this.get("view.scale"),b=this.get("view.constraints.effectiveMaxScale");return 0===b||a>b},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"canZoomOut",{get:function(){if(!this.get("view.ready"))return!1;var a=this.get("view.animation.target.scale")||
this.get("view.scale"),b=this.get("view.constraints.effectiveMinScale");return 0===b||a<b},enumerable:!0,configurable:!0});k([a.property({dependsOn:["view.ready","view.scale","view.animation.target.scale","view.constraints.effectiveMaxScale"],readOnly:!0})],f.prototype,"canZoomIn",null);k([a.property({dependsOn:["view.ready","view.scale","view.animation.target.scale","view.constraints.effectiveMinScale"],readOnly:!0})],f.prototype,"canZoomOut",null);k([a.property()],f.prototype,"view",void 0);return f=
k([a.subclass("esri.widgets.Zoom.ZoomConditions2D")],f)}(a.declared(f))})},"esri/widgets/Zoom/ZoomConditions3D":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators".split(" "),function(g,b,l,k,f,a){return function(b){function f(){return null!==b&&b.apply(this,arguments)||this}l(f,b);Object.defineProperty(f.prototype,"canZoomIn",{get:function(){return!!this.get("view.ready")},enumerable:!0,
configurable:!0});Object.defineProperty(f.prototype,"canZoomOut",{get:function(){return!!this.get("view.ready")},enumerable:!0,configurable:!0});k([a.property({dependsOn:["view.ready"],readOnly:!0})],f.prototype,"canZoomIn",null);k([a.property({dependsOn:["view.ready"],readOnly:!0})],f.prototype,"canZoomOut",null);k([a.property()],f.prototype,"view",void 0);return f=k([a.subclass("esri.widgets.Zoom.ZoomConditions3D")],f)}(a.declared(f))})},"esri/core/libs/gl-matrix-2/mat4":function(){define(["require",
"exports","./math/mat4"],function(g,b,l){Object.defineProperty(b,"__esModule",{value:!0});b.mat4=l})},"esri/core/libs/gl-matrix-2/math/mat4":function(){define(["require","exports","../factories/vec3f64","./common"],function(g,b,l,k){function f(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}function a(a,b,d){var c=b[0],e=b[1],f=b[2],g=b[3],h=b[4],k=b[5],l=b[6],m=b[7],q=b[8],A=b[9],z=b[10],B=b[11],C=b[12],D=b[13],H=b[14];
b=b[15];var F=d[0],E=d[1],G=d[2],J=d[3];a[0]=F*c+E*h+G*q+J*C;a[1]=F*e+E*k+G*A+J*D;a[2]=F*f+E*l+G*z+J*H;a[3]=F*g+E*m+G*B+J*b;F=d[4];E=d[5];G=d[6];J=d[7];a[4]=F*c+E*h+G*q+J*C;a[5]=F*e+E*k+G*A+J*D;a[6]=F*f+E*l+G*z+J*H;a[7]=F*g+E*m+G*B+J*b;F=d[8];E=d[9];G=d[10];J=d[11];a[8]=F*c+E*h+G*q+J*C;a[9]=F*e+E*k+G*A+J*D;a[10]=F*f+E*l+G*z+J*H;a[11]=F*g+E*m+G*B+J*b;F=d[12];E=d[13];G=d[14];J=d[15];a[12]=F*c+E*h+G*q+J*C;a[13]=F*e+E*k+G*A+J*D;a[14]=F*f+E*l+G*z+J*H;a[15]=F*g+E*m+G*B+J*b;return a}function q(a,b,d){var c=
b[0],e=b[1],f=b[2],g=b[3],h=c+c,k=e+e,l=f+f;b=c*h;var m=c*k,c=c*l,q=e*k,e=e*l,f=f*l,h=g*h,k=g*k,g=g*l;a[0]=1-(q+f);a[1]=m+g;a[2]=c-k;a[3]=0;a[4]=m-g;a[5]=1-(b+f);a[6]=e+h;a[7]=0;a[8]=c+k;a[9]=e-h;a[10]=1-(b+q);a[11]=0;a[12]=d[0];a[13]=d[1];a[14]=d[2];a[15]=1;return a}function m(a,b,d){a[0]=b[0]-d[0];a[1]=b[1]-d[1];a[2]=b[2]-d[2];a[3]=b[3]-d[3];a[4]=b[4]-d[4];a[5]=b[5]-d[5];a[6]=b[6]-d[6];a[7]=b[7]-d[7];a[8]=b[8]-d[8];a[9]=b[9]-d[9];a[10]=b[10]-d[10];a[11]=b[11]-d[11];a[12]=b[12]-d[12];a[13]=b[13]-
d[13];a[14]=b[14]-d[14];a[15]=b[15]-d[15];return a}Object.defineProperty(b,"__esModule",{value:!0});b.copy=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];a[9]=b[9];a[10]=b[10];a[11]=b[11];a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a};b.set=function(a,b,d,f,g,k,l,m,q,w,r,y,A,z,B,C,D){a[0]=b;a[1]=d;a[2]=f;a[3]=g;a[4]=k;a[5]=l;a[6]=m;a[7]=q;a[8]=w;a[9]=r;a[10]=y;a[11]=A;a[12]=z;a[13]=B;a[14]=C;a[15]=D;return a};b.identity=f;b.transpose=
function(a,b){if(a===b){var c=b[1],e=b[2],d=b[3],f=b[6],g=b[7],k=b[11];a[1]=b[4];a[2]=b[8];a[3]=b[12];a[4]=c;a[6]=b[9];a[7]=b[13];a[8]=e;a[9]=f;a[11]=b[14];a[12]=d;a[13]=g;a[14]=k}else a[0]=b[0],a[1]=b[4],a[2]=b[8],a[3]=b[12],a[4]=b[1],a[5]=b[5],a[6]=b[9],a[7]=b[13],a[8]=b[2],a[9]=b[6],a[10]=b[10],a[11]=b[14],a[12]=b[3],a[13]=b[7],a[14]=b[11],a[15]=b[15];return a};b.invert=function(a,b){var c=b[0],e=b[1],d=b[2],f=b[3],g=b[4],k=b[5],l=b[6],m=b[7],q=b[8],y=b[9],A=b[10],z=b[11],B=b[12],C=b[13],D=b[14];
b=b[15];var H=c*k-e*g,F=c*l-d*g,E=c*m-f*g,G=e*l-d*k,J=e*m-f*k,K=d*m-f*l,I=q*C-y*B,N=q*D-A*B,M=q*b-z*B,L=y*D-A*C,Q=y*b-z*C,O=A*b-z*D,S=H*O-F*Q+E*L+G*M-J*N+K*I;if(!S)return null;S=1/S;a[0]=(k*O-l*Q+m*L)*S;a[1]=(d*Q-e*O-f*L)*S;a[2]=(C*K-D*J+b*G)*S;a[3]=(A*J-y*K-z*G)*S;a[4]=(l*M-g*O-m*N)*S;a[5]=(c*O-d*M+f*N)*S;a[6]=(D*E-B*K-b*F)*S;a[7]=(q*K-A*E+z*F)*S;a[8]=(g*Q-k*M+m*I)*S;a[9]=(e*M-c*Q-f*I)*S;a[10]=(B*J-C*E+b*H)*S;a[11]=(y*E-q*J-z*H)*S;a[12]=(k*N-g*L-l*I)*S;a[13]=(c*L-e*N+d*I)*S;a[14]=(C*F-B*G-D*H)*S;
a[15]=(q*G-y*F+A*H)*S;return a};b.adjoint=function(a,b){var c=b[0],e=b[1],d=b[2],f=b[3],g=b[4],k=b[5],l=b[6],m=b[7],q=b[8],y=b[9],A=b[10],z=b[11],B=b[12],C=b[13],D=b[14];b=b[15];a[0]=k*(A*b-z*D)-y*(l*b-m*D)+C*(l*z-m*A);a[1]=-(e*(A*b-z*D)-y*(d*b-f*D)+C*(d*z-f*A));a[2]=e*(l*b-m*D)-k*(d*b-f*D)+C*(d*m-f*l);a[3]=-(e*(l*z-m*A)-k*(d*z-f*A)+y*(d*m-f*l));a[4]=-(g*(A*b-z*D)-q*(l*b-m*D)+B*(l*z-m*A));a[5]=c*(A*b-z*D)-q*(d*b-f*D)+B*(d*z-f*A);a[6]=-(c*(l*b-m*D)-g*(d*b-f*D)+B*(d*m-f*l));a[7]=c*(l*z-m*A)-g*(d*z-
f*A)+q*(d*m-f*l);a[8]=g*(y*b-z*C)-q*(k*b-m*C)+B*(k*z-m*y);a[9]=-(c*(y*b-z*C)-q*(e*b-f*C)+B*(e*z-f*y));a[10]=c*(k*b-m*C)-g*(e*b-f*C)+B*(e*m-f*k);a[11]=-(c*(k*z-m*y)-g*(e*z-f*y)+q*(e*m-f*k));a[12]=-(g*(y*D-A*C)-q*(k*D-l*C)+B*(k*A-l*y));a[13]=c*(y*D-A*C)-q*(e*D-d*C)+B*(e*A-d*y);a[14]=-(c*(k*D-l*C)-g*(e*D-d*C)+B*(e*l-d*k));a[15]=c*(k*A-l*y)-g*(e*A-d*y)+q*(e*l-d*k);return a};b.determinant=function(a){var b=a[0],c=a[1],d=a[2],f=a[3],g=a[4],k=a[5],l=a[6],m=a[7],q=a[8],r=a[9],y=a[10],A=a[11],z=a[12],B=a[13],
C=a[14];a=a[15];return(b*k-c*g)*(y*a-A*C)-(b*l-d*g)*(r*a-A*B)+(b*m-f*g)*(r*C-y*B)+(c*l-d*k)*(q*a-A*z)-(c*m-f*k)*(q*C-y*z)+(d*m-f*l)*(q*B-r*z)};b.multiply=a;b.translate=function(a,b,d){var c=d[0],e=d[1];d=d[2];var f=void 0,g=void 0,h=void 0,k=void 0,l=void 0,m=void 0,q=void 0,A=void 0,z=void 0,B=void 0,C=void 0,D=void 0;b===a?(a[12]=b[0]*c+b[4]*e+b[8]*d+b[12],a[13]=b[1]*c+b[5]*e+b[9]*d+b[13],a[14]=b[2]*c+b[6]*e+b[10]*d+b[14],a[15]=b[3]*c+b[7]*e+b[11]*d+b[15]):(f=b[0],g=b[1],h=b[2],k=b[3],l=b[4],m=
b[5],q=b[6],A=b[7],z=b[8],B=b[9],C=b[10],D=b[11],a[0]=f,a[1]=g,a[2]=h,a[3]=k,a[4]=l,a[5]=m,a[6]=q,a[7]=A,a[8]=z,a[9]=B,a[10]=C,a[11]=D,a[12]=f*c+l*e+z*d+b[12],a[13]=g*c+m*e+B*d+b[13],a[14]=h*c+q*e+C*d+b[14],a[15]=k*c+A*e+D*d+b[15]);return a};b.scale=function(a,b,d){var c=d[0],e=d[1];d=d[2];a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;a[3]=b[3]*c;a[4]=b[4]*e;a[5]=b[5]*e;a[6]=b[6]*e;a[7]=b[7]*e;a[8]=b[8]*d;a[9]=b[9]*d;a[10]=b[10]*d;a[11]=b[11]*d;a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a};b.rotate=
function(a,b,d,f){var c=f[0],e=f[1];f=f[2];var g=Math.sqrt(c*c+e*e+f*f),h=void 0,l=void 0,m=void 0,p=void 0,q=void 0,A=void 0,z=void 0,B=void 0,C=void 0,D=void 0,H=void 0,F=void 0,E=void 0,G=void 0,J=void 0,K=void 0,I=void 0,N=void 0,M=void 0,L=void 0,Q=void 0,O=void 0,l=h=void 0;if(g<k.EPSILON)return null;g=1/g;c*=g;e*=g;f*=g;h=Math.sin(d);l=Math.cos(d);m=1-l;p=b[0];q=b[1];A=b[2];z=b[3];B=b[4];C=b[5];D=b[6];H=b[7];F=b[8];E=b[9];G=b[10];J=b[11];K=c*c*m+l;I=e*c*m+f*h;N=f*c*m-e*h;M=c*e*m-f*h;L=e*e*
m+l;Q=f*e*m+c*h;O=c*f*m+e*h;h=e*f*m-c*h;l=f*f*m+l;a[0]=p*K+B*I+F*N;a[1]=q*K+C*I+E*N;a[2]=A*K+D*I+G*N;a[3]=z*K+H*I+J*N;a[4]=p*M+B*L+F*Q;a[5]=q*M+C*L+E*Q;a[6]=A*M+D*L+G*Q;a[7]=z*M+H*L+J*Q;a[8]=p*O+B*h+F*l;a[9]=q*O+C*h+E*l;a[10]=A*O+D*h+G*l;a[11]=z*O+H*h+J*l;b!==a&&(a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);return a};b.rotateX=function(a,b,d){var c=Math.sin(d);d=Math.cos(d);var e=b[4],f=b[5],g=b[6],h=b[7],k=b[8],l=b[9],m=b[10],q=b[11];b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],
a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[4]=e*d+k*c;a[5]=f*d+l*c;a[6]=g*d+m*c;a[7]=h*d+q*c;a[8]=k*d-e*c;a[9]=l*d-f*c;a[10]=m*d-g*c;a[11]=q*d-h*c;return a};b.rotateY=function(a,b,d){var c=Math.sin(d);d=Math.cos(d);var e=b[0],f=b[1],g=b[2],h=b[3],k=b[8],l=b[9],m=b[10],q=b[11];b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=e*d-k*c;a[1]=f*d-l*c;a[2]=g*d-m*c;a[3]=h*d-q*c;a[8]=e*c+k*d;a[9]=f*c+l*d;a[10]=g*c+m*d;a[11]=h*c+q*d;return a};b.rotateZ=function(a,
b,d){var c=Math.sin(d);d=Math.cos(d);var e=b[0],f=b[1],g=b[2],h=b[3],k=b[4],l=b[5],m=b[6],q=b[7];b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=e*d+k*c;a[1]=f*d+l*c;a[2]=g*d+m*c;a[3]=h*d+q*c;a[4]=k*d-e*c;a[5]=l*d-f*c;a[6]=m*d-g*c;a[7]=q*d-h*c;return a};b.fromTranslation=function(a,b){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=b[0];a[13]=b[1];a[14]=b[2];a[15]=1;return a};b.fromScaling=function(a,
b){a[0]=b[0];a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b[1];a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=b[2];a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};b.fromRotation=function(a,b,d){var c=d[0],e=d[1];d=d[2];var f=Math.sqrt(c*c+e*e+d*d),g=void 0,h=void 0,l=void 0;if(f<k.EPSILON)return null;f=1/f;c*=f;e*=f;d*=f;g=Math.sin(b);h=Math.cos(b);l=1-h;a[0]=c*c*l+h;a[1]=e*c*l+d*g;a[2]=d*c*l-e*g;a[3]=0;a[4]=c*e*l-d*g;a[5]=e*e*l+h;a[6]=d*e*l+c*g;a[7]=0;a[8]=c*d*l+e*g;a[9]=e*d*l-c*g;a[10]=d*d*l+h;a[11]=0;a[12]=0;a[13]=0;
a[14]=0;a[15]=1;return a};b.fromXRotation=function(a,b){var c=Math.sin(b);b=Math.cos(b);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b;a[6]=c;a[7]=0;a[8]=0;a[9]=-c;a[10]=b;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};b.fromYRotation=function(a,b){var c=Math.sin(b);b=Math.cos(b);a[0]=b;a[1]=0;a[2]=-c;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=c;a[9]=0;a[10]=b;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};b.fromZRotation=function(a,b){var c=Math.sin(b);b=Math.cos(b);a[0]=b;a[1]=c;a[2]=0;a[3]=0;a[4]=
-c;a[5]=b;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};b.fromRotationTranslation=q;b.fromQuat2=function(a,b){var c=d,e=-b[0],f=-b[1],g=-b[2],k=b[3],l=b[4],m=b[5],w=b[6],r=b[7],y=e*e+f*f+g*g+k*k;0<y?(c[0]=2*(l*k+r*e+m*g-w*f)/y,c[1]=2*(m*k+r*f+w*e-l*g)/y,c[2]=2*(w*k+r*g+l*f-m*e)/y):(c[0]=2*(l*k+r*e+m*g-w*f),c[1]=2*(m*k+r*f+w*e-l*g),c[2]=2*(w*k+r*g+l*f-m*e));q(a,b,c);return a};var d=l.create();b.getTranslation=function(a,b){a[0]=b[12];a[1]=b[13];a[2]=b[14];return a};
b.getScaling=function(a,b){var c=b[0],e=b[1],d=b[2],f=b[4],g=b[5],k=b[6],l=b[8],m=b[9];b=b[10];a[0]=Math.sqrt(c*c+e*e+d*d);a[1]=Math.sqrt(f*f+g*g+k*k);a[2]=Math.sqrt(l*l+m*m+b*b);return a};b.getRotation=function(a,b){var c=b[0]+b[5]+b[10],e=0;0<c?(e=2*Math.sqrt(c+1),a[3]=.25*e,a[0]=(b[6]-b[9])/e,a[1]=(b[8]-b[2])/e,a[2]=(b[1]-b[4])/e):b[0]>b[5]&&b[0]>b[10]?(e=2*Math.sqrt(1+b[0]-b[5]-b[10]),a[3]=(b[6]-b[9])/e,a[0]=.25*e,a[1]=(b[1]+b[4])/e,a[2]=(b[8]+b[2])/e):b[5]>b[10]?(e=2*Math.sqrt(1+b[5]-b[0]-b[10]),
a[3]=(b[8]-b[2])/e,a[0]=(b[1]+b[4])/e,a[1]=.25*e,a[2]=(b[6]+b[9])/e):(e=2*Math.sqrt(1+b[10]-b[0]-b[5]),a[3]=(b[1]-b[4])/e,a[0]=(b[8]+b[2])/e,a[1]=(b[6]+b[9])/e,a[2]=.25*e);return a};b.fromRotationTranslationScale=function(a,b,d,f){var c=b[0],e=b[1],g=b[2],h=b[3],k=c+c,l=e+e,m=g+g;b=c*k;var p=c*l,c=c*m,q=e*l,e=e*m,g=g*m,k=h*k,l=h*l,h=h*m,m=f[0],z=f[1];f=f[2];a[0]=(1-(q+g))*m;a[1]=(p+h)*m;a[2]=(c-l)*m;a[3]=0;a[4]=(p-h)*z;a[5]=(1-(b+g))*z;a[6]=(e+k)*z;a[7]=0;a[8]=(c+l)*f;a[9]=(e-k)*f;a[10]=(1-(b+q))*
f;a[11]=0;a[12]=d[0];a[13]=d[1];a[14]=d[2];a[15]=1;return a};b.fromRotationTranslationScaleOrigin=function(a,b,d,f,g){var c=b[0],e=b[1],h=b[2],k=b[3],n=c+c,l=e+e,m=h+h;b=c*n;var p=c*l,q=c*m,c=e*l,e=e*m,B=h*m,h=k*n,l=k*l,C=k*m,D=f[0],H=f[1],m=f[2];f=g[0];k=g[1];g=g[2];var n=(1-(c+B))*D,F=(p+C)*D,D=(q-l)*D,p=(p-C)*H,B=(1-(b+B))*H,H=(e+h)*H,q=(q+l)*m,e=(e-h)*m;b=(1-(b+c))*m;a[0]=n;a[1]=F;a[2]=D;a[3]=0;a[4]=p;a[5]=B;a[6]=H;a[7]=0;a[8]=q;a[9]=e;a[10]=b;a[11]=0;a[12]=d[0]+f-(n*f+p*k+q*g);a[13]=d[1]+k-(F*
f+B*k+e*g);a[14]=d[2]+g-(D*f+H*k+b*g);a[15]=1;return a};b.fromQuat=function(a,b){var c=b[0],e=b[1],d=b[2];b=b[3];var f=c+c,g=e+e,k=d+d,c=c*f,l=e*f,e=e*g,m=d*f,q=d*g,d=d*k,f=b*f,g=b*g;b*=k;a[0]=1-e-d;a[1]=l+b;a[2]=m-g;a[3]=0;a[4]=l-b;a[5]=1-c-d;a[6]=q+f;a[7]=0;a[8]=m+g;a[9]=q-f;a[10]=1-c-e;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};b.frustum=function(a,b,d,f,g,k,l){var c=1/(d-b),e=1/(g-f),h=1/(k-l);a[0]=2*k*c;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=2*k*e;a[6]=0;a[7]=0;a[8]=(d+b)*c;a[9]=(g+f)*e;a[10]=
(l+k)*h;a[11]=-1;a[12]=0;a[13]=0;a[14]=l*k*2*h;a[15]=0;return a};b.perspective=function(a,b,d,f,g){b=1/Math.tan(b/2);var c=void 0;a[0]=b/d;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[11]=-1;a[12]=0;a[13]=0;a[15]=0;null!=g&&Infinity!==g?(c=1/(f-g),a[10]=(g+f)*c,a[14]=2*g*f*c):(a[10]=-1,a[14]=-2*f);return a};b.perspectiveFromFieldOfView=function(a,b,d,f){var c=Math.tan(b.upDegrees*Math.PI/180),e=Math.tan(b.downDegrees*Math.PI/180),g=Math.tan(b.leftDegrees*Math.PI/180);b=Math.tan(b.rightDegrees*
Math.PI/180);var h=2/(g+b),k=2/(c+e);a[0]=h;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=k;a[6]=0;a[7]=0;a[8]=-((g-b)*h*.5);a[9]=(c-e)*k*.5;a[10]=f/(d-f);a[11]=-1;a[12]=0;a[13]=0;a[14]=f*d/(d-f);a[15]=0;return a};b.ortho=function(a,b,d,f,g,k,l){var c=1/(b-d),e=1/(f-g),h=1/(k-l);a[0]=-2*c;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=-2*e;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=2*h;a[11]=0;a[12]=(b+d)*c;a[13]=(g+f)*e;a[14]=(l+k)*h;a[15]=1;return a};b.lookAt=function(a,b,d,g){var c=void 0,e=void 0,h=void 0,l=void 0,m=void 0,p=void 0,
q=void 0,y=void 0,A=void 0,z=void 0,B=b[0],C=b[1];b=b[2];h=g[0];l=g[1];g=g[2];q=d[0];y=d[1];d=d[2];if(Math.abs(B-q)<k.EPSILON&&Math.abs(C-y)<k.EPSILON&&Math.abs(b-d)<k.EPSILON)return f(a);q=B-q;y=C-y;A=b-d;z=1/Math.sqrt(q*q+y*y+A*A);q*=z;y*=z;A*=z;c=l*A-g*y;e=g*q-h*A;h=h*y-l*q;(z=Math.sqrt(c*c+e*e+h*h))?(z=1/z,c*=z,e*=z,h*=z):h=e=c=0;l=y*h-A*e;m=A*c-q*h;p=q*e-y*c;(z=Math.sqrt(l*l+m*m+p*p))?(z=1/z,l*=z,m*=z,p*=z):p=m=l=0;a[0]=c;a[1]=l;a[2]=q;a[3]=0;a[4]=e;a[5]=m;a[6]=y;a[7]=0;a[8]=h;a[9]=p;a[10]=A;
a[11]=0;a[12]=-(c*B+e*C+h*b);a[13]=-(l*B+m*C+p*b);a[14]=-(q*B+y*C+A*b);a[15]=1;return a};b.targetTo=function(a,b,d,f){var c=b[0],e=b[1];b=b[2];var g=f[0],h=f[1],k=f[2];f=c-d[0];var l=e-d[1];d=b-d[2];var m=f*f+l*l+d*d;0<m&&(m=1/Math.sqrt(m),f*=m,l*=m,d*=m);var p=h*d-k*l,k=k*f-g*d,g=g*l-h*f,m=p*p+k*k+g*g;0<m&&(m=1/Math.sqrt(m),p*=m,k*=m,g*=m);a[0]=p;a[1]=k;a[2]=g;a[3]=0;a[4]=l*g-d*k;a[5]=d*p-f*g;a[6]=f*k-l*p;a[7]=0;a[8]=f;a[9]=l;a[10]=d;a[11]=0;a[12]=c;a[13]=e;a[14]=b;a[15]=1;return a};b.str=function(a){return"mat4("+
a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};b.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))};b.add=function(a,b,
d){a[0]=b[0]+d[0];a[1]=b[1]+d[1];a[2]=b[2]+d[2];a[3]=b[3]+d[3];a[4]=b[4]+d[4];a[5]=b[5]+d[5];a[6]=b[6]+d[6];a[7]=b[7]+d[7];a[8]=b[8]+d[8];a[9]=b[9]+d[9];a[10]=b[10]+d[10];a[11]=b[11]+d[11];a[12]=b[12]+d[12];a[13]=b[13]+d[13];a[14]=b[14]+d[14];a[15]=b[15]+d[15];return a};b.subtract=m;b.multiplyScalar=function(a,b,d){a[0]=b[0]*d;a[1]=b[1]*d;a[2]=b[2]*d;a[3]=b[3]*d;a[4]=b[4]*d;a[5]=b[5]*d;a[6]=b[6]*d;a[7]=b[7]*d;a[8]=b[8]*d;a[9]=b[9]*d;a[10]=b[10]*d;a[11]=b[11]*d;a[12]=b[12]*d;a[13]=b[13]*d;a[14]=b[14]*
d;a[15]=b[15]*d;return a};b.multiplyScalarAndAdd=function(a,b,d,f){a[0]=b[0]+d[0]*f;a[1]=b[1]+d[1]*f;a[2]=b[2]+d[2]*f;a[3]=b[3]+d[3]*f;a[4]=b[4]+d[4]*f;a[5]=b[5]+d[5]*f;a[6]=b[6]+d[6]*f;a[7]=b[7]+d[7]*f;a[8]=b[8]+d[8]*f;a[9]=b[9]+d[9]*f;a[10]=b[10]+d[10]*f;a[11]=b[11]+d[11]*f;a[12]=b[12]+d[12]*f;a[13]=b[13]+d[13]*f;a[14]=b[14]+d[14]*f;a[15]=b[15]+d[15]*f;return a};b.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]&&a[6]===b[6]&&a[7]===b[7]&&
a[8]===b[8]&&a[9]===b[9]&&a[10]===b[10]&&a[11]===b[11]&&a[12]===b[12]&&a[13]===b[13]&&a[14]===b[14]&&a[15]===b[15]};b.equals=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],l=a[5],m=a[6],q=a[7],r=a[8],y=a[9],A=a[10],z=a[11],B=a[12],C=a[13],D=a[14];a=a[15];var H=b[0],F=b[1],E=b[2],G=b[3],J=b[4],K=b[5],I=b[6],N=b[7],M=b[8],L=b[9],Q=b[10],O=b[11],S=b[12],U=b[13],T=b[14];b=b[15];return Math.abs(c-H)<=k.EPSILON*Math.max(1,Math.abs(c),Math.abs(H))&&Math.abs(d-F)<=k.EPSILON*Math.max(1,Math.abs(d),Math.abs(F))&&
Math.abs(e-E)<=k.EPSILON*Math.max(1,Math.abs(e),Math.abs(E))&&Math.abs(f-G)<=k.EPSILON*Math.max(1,Math.abs(f),Math.abs(G))&&Math.abs(g-J)<=k.EPSILON*Math.max(1,Math.abs(g),Math.abs(J))&&Math.abs(l-K)<=k.EPSILON*Math.max(1,Math.abs(l),Math.abs(K))&&Math.abs(m-I)<=k.EPSILON*Math.max(1,Math.abs(m),Math.abs(I))&&Math.abs(q-N)<=k.EPSILON*Math.max(1,Math.abs(q),Math.abs(N))&&Math.abs(r-M)<=k.EPSILON*Math.max(1,Math.abs(r),Math.abs(M))&&Math.abs(y-L)<=k.EPSILON*Math.max(1,Math.abs(y),Math.abs(L))&&Math.abs(A-
Q)<=k.EPSILON*Math.max(1,Math.abs(A),Math.abs(Q))&&Math.abs(z-O)<=k.EPSILON*Math.max(1,Math.abs(z),Math.abs(O))&&Math.abs(B-S)<=k.EPSILON*Math.max(1,Math.abs(B),Math.abs(S))&&Math.abs(C-U)<=k.EPSILON*Math.max(1,Math.abs(C),Math.abs(U))&&Math.abs(D-T)<=k.EPSILON*Math.max(1,Math.abs(D),Math.abs(T))&&Math.abs(a-b)<=k.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))};b.mul=a;b.sub=m})},"esri/core/libs/gl-matrix-2/mat4f32":function(){define(["require","exports","./factories/mat4f32"],function(g,b,l){Object.defineProperty(b,
"__esModule",{value:!0});b.mat4f32=l})},"esri/core/libs/gl-matrix-2/factories/mat4f32":function(){define(["require","exports"],function(g,b){function l(){var b=new Float32Array(16);b[0]=1;b[5]=1;b[10]=1;b[15]=1;return b}Object.defineProperty(b,"__esModule",{value:!0});b.create=l;b.clone=function(b){var f=new Float32Array(16);f[0]=b[0];f[1]=b[1];f[2]=b[2];f[3]=b[3];f[4]=b[4];f[5]=b[5];f[6]=b[6];f[7]=b[7];f[8]=b[8];f[9]=b[9];f[10]=b[10];f[11]=b[11];f[12]=b[12];f[13]=b[13];f[14]=b[14];f[15]=b[15];return f};
b.fromValues=function(b,f,a,g,l,d,c,e,h,p,n,u,x,v,t,w){var k=new Float32Array(16);k[0]=b;k[1]=f;k[2]=a;k[3]=g;k[4]=l;k[5]=d;k[6]=c;k[7]=e;k[8]=h;k[9]=p;k[10]=n;k[11]=u;k[12]=x;k[13]=v;k[14]=t;k[15]=w;return k};b.createView=function(b,f){return new Float32Array(b,f,16)};b.IDENTITY=l()})},"esri/core/libs/gl-matrix-2/vec3f32":function(){define(["require","exports","./factories/vec3f32"],function(g,b,l){Object.defineProperty(b,"__esModule",{value:!0});b.vec3f32=l})},"esri/core/libs/gl-matrix-2/factories/vec3f32":function(){define(["require",
"exports"],function(g,b){function l(){return new Float32Array(3)}function k(a,b,e){var c=new Float32Array(3);c[0]=a;c[1]=b;c[2]=e;return c}function f(){return k(1,1,1)}function a(){return k(1,0,0)}function q(){return k(0,1,0)}function m(){return k(0,0,1)}Object.defineProperty(b,"__esModule",{value:!0});b.create=l;b.clone=function(a){var b=new Float32Array(3);b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};b.fromValues=k;b.createView=function(a,b){return new Float32Array(a,b,3)};b.zeros=function(){return l()};
b.ones=f;b.unitX=a;b.unitY=q;b.unitZ=m;b.ZEROS=l();b.ONES=f();b.UNIT_X=a();b.UNIT_Y=q();b.UNIT_Z=m()})},"esri/core/libs/gl-matrix-2/vec4f32":function(){define(["require","exports","./factories/vec4f32"],function(g,b,l){Object.defineProperty(b,"__esModule",{value:!0});b.vec4f32=l})},"esri/core/libs/gl-matrix-2/factories/vec4f32":function(){define(["require","exports"],function(g,b){function l(){return new Float32Array(4)}function k(a,b,d,f){var c=new Float32Array(4);c[0]=a;c[1]=b;c[2]=d;c[3]=f;return c}
function f(){return k(1,1,1,1)}function a(){return k(1,0,0,0)}function q(){return k(0,1,0,0)}function m(){return k(0,0,1,0)}function d(){return k(0,0,0,1)}Object.defineProperty(b,"__esModule",{value:!0});b.create=l;b.clone=function(a){var b=new Float32Array(4);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};b.fromValues=k;b.createView=function(a,b){return new Float32Array(a,b,4)};b.zeros=function(){return l()};b.ones=f;b.unitX=a;b.unitY=q;b.unitZ=m;b.unitW=d;b.ZEROS=l();b.ONES=f();b.UNIT_X=a();
b.UNIT_Y=q();b.UNIT_Z=m();b.UNIT_W=d()})},"esri/widgets/Legend/support/colorRampUtils":function(){define("require exports ../../../core/tsSupport/awaiterHelper ../../../core/tsSupport/generatorHelper ../../../Color ../../../core/promiseUtils ./utils @dojo/framework/shim/Promise".split(" "),function(g,b,l,k,f,a,q){function m(a,b){var c=[],d=a.length-1;5===a.length?c.push(0,2,4):c.push(0,d);return a.map(function(a,e){return-1<c.indexOf(e)?q.createStopLabel(a,e,d,b):null})}function d(a,b,c){void 0===
c&&(c=h);return l(this,void 0,void 0,function(){var d,e;return k(this,function(h){switch(h.label){case 0:return d=new f(c),[4,new Promise(function(a,b){g(["../../../renderers/visualVariables/support/visualVariableUtils"],a,b)})];case 1:return e=h.sent().getOpacity(b,a),null!=e&&(d.a=e),[2,d]}})})}function c(a,b){a=e(a,b);var c=a.startIndex,d=a.endIndex;if(c===d)return b[c].color;b=f.blendColors(b[c].color,b[d].color,a.weight);return new f(b)}function e(a,b){var c=0,d=b.length-1;b.some(function(b,
e){if(a<b.value)return d=e,!0;c=e;return!1});return{startIndex:c,endIndex:d,weight:(a-b[c].value)/(b[d].value-b[c].value)}}Object.defineProperty(b,"__esModule",{value:!0});var h=new f([64,64,64]);b.getRampStops=function(b,c,e){return l(this,void 0,void 0,function(){var f,h,n,p,q,u,A,z,B=this;return k(this,function(r){switch(r.label){case 0:f=!1;h=[];n=[];b.stops&&(p=b.stops,h=p.map(function(a){return a.value}),(f=p.some(function(a){return!!a.label}))&&(n=p.map(function(a){return a.label})));q=h[0];
u=h[h.length-1];if(null==q&&null==u)return[2,null];A=f?null:m(h,e);return[4,a.all(h.map(function(a,e){return l(B,void 0,void 0,function(){var h,l,m;return k(this,function(k){switch(k.label){case 0:return"opacity"!==b.type?[3,2]:[4,d(a,b,c)];case 1:return l=k.sent(),[3,4];case 2:return[4,new Promise(function(a,b){g(["../../../renderers/visualVariables/support/visualVariableUtils"],a,b)})];case 3:l=k.sent().getColor(b,a),k.label=4;case 4:return h=l,m=f?n[e]:A[e],[2,{value:a,color:h,label:m}]}})})}))];
case 1:return z=r.sent(),[2,z.reverse()]}})})};b.getRampStopsForPointCloud=function(a){var b=!1,d=[],e=[],d=a.map(function(a){return a.value});(b=a.some(function(a){return!!a.label}))&&(e=a.map(function(a){return a.label}));var f=d[d.length-1];if(null==d[0]&&null==f)return null;var g=b?null:m(d,!1);return d.map(function(d,f){var h=c(d,a);return{value:d,color:h,label:b?e[f]:g[f]}}).reverse()};b.getColorFromPointCloudStops=c;b.getStrectchRampStops=function(a,b){var c=[];if(a&&"multipart"===a.type)a.colorRamps.reverse().forEach(function(d,
e){0===e?c.push({value:b.max,color:new f(d.toColor),label:"high"}):c.push({value:null,color:new f(d.toColor),label:""});e===a.colorRamps.length-1?c.push({value:b.min,color:new f(d.fromColor),label:"low"}):c.push({value:null,color:new f(d.fromColor),label:""})});else{var d=void 0,e=void 0;a&&"algorithmic"===a.type?(d=a.fromColor,e=a.toColor):(d=[0,0,0,1],e=[255,255,255,1]);c=[{value:b.max,color:new f(e),label:"high"},{value:b.min,color:new f(d),label:"low"}]}return c}})},"esri/widgets/Legend/support/utils":function(){define(["require",
"exports","../../../intl/date","../../../renderers/support/numberUtils"],function(g,b,l,k){Object.defineProperty(b,"__esModule",{value:!0});var f=l.convertDateFormatToIntlOptions("short-date");b.createStopLabel=function(a,b,g,d){var c="";0===b?c="\x3c ":b===g&&(c="\x3e ");b=null;b=d?l.formatDate(a,f):k.format(a);return c+b};b.RGB_IMG_SOURCE=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII\x3d",
"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII\x3d","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII\x3d"]})},"esri/widgets/Legend/support/heatmapRampUtils":function(){define(["require","exports","../../../renderers/support/HeatmapColorStop"],
function(g,b,l){Object.defineProperty(b,"__esModule",{value:!0});b.getHeatmapRampStops=function(b){b=b.colorStops;var f=b.length-1;if(b&&b[0]){var a=b[f];a&&1!==a.ratio&&(b=b.slice(0),b.push(new l.HeatmapColorStop({ratio:1,color:a.color})),f++)}return b.map(function(a,b){var d="";0===b?d="low":b===f&&(d="high");return{color:a.color,label:d,ratio:a.ratio}}).reverse()}})},"esri/widgets/Legend/support/relationshipRampUtils":function(){define(["require","exports","../../../symbols/support/gfxUtils","../../../symbols/support/previewSymbol3D"],
function(g,b,l,k){function f(a){if(a){var b=a.type;return-1<b.indexOf("3d")?k.getSymbolLayerFill(a.symbolLayers.getItemAt(0)):"simple-line"===b||"simple-marker"===a.type&&("x"===a.style||"cross"===a.style)?(a=l.getStroke(a))&&a.color:l.getFill(a)}}function a(a,b){var c=b.HH.label,d=b.LL.label,e=b.HL.label;b=b.LH.label;switch(a){case "HH":return{top:c,bottom:d,left:e,right:b};case "HL":return{top:e,bottom:b,left:d,right:c};case "LL":return{top:d,bottom:c,left:b,right:e};case "LH":return{top:b,bottom:e,
left:c,right:d};default:return{top:c,bottom:d,left:e,right:b}}}function q(a){var b=m[a];a&&null==b&&(b=m.HH);return b||0}Object.defineProperty(b,"__esModule",{value:!0});var m={HH:315,HL:45,LL:135,LH:225},d={2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};b.getRelationshipRampElement=function(b){var c=b.focus,g=b.numClasses,k=d[g],l={};b.infos.forEach(function(a){l[a.value]=
{label:a.label,fill:f(a.symbol)}});b=[];for(var m=0;m<g;m++){for(var x=[],v=0;v<g;v++)x.push(l[k[m][v]].fill);b.push(x)}k=a(c,l);return{type:"relationship-ramp",numClasses:g,focus:c,colors:b,labels:k,rotation:q(c)}};b.getRotationAngleForFocus=q})},"esri/widgets/Legend/support/sizeRampUtils":function(){define("require exports ../../../core/tsSupport/awaiterHelper ../../../core/tsSupport/generatorHelper ../../../symbols ../../../core/promiseUtils ../../../renderers/support/numberUtils ../../../symbols/support/utils ./utils @dojo/framework/shim/Promise".split(" "),
function(g,b,l,k,f,a,q,m,d){function c(a,b){var c=a.length-1;return a.map(function(a,e){return d.createStopLabel(a,e,c,b)})}function e(a,b){var c=null,d=null;"simple"===a.type?c=a.symbol:"class-breaks"===a.type?(c=(a=a.classBreakInfos)&&a[0]&&a[0].symbol,d=1<a.length):"unique-value"===a.type&&(c=(a=a.uniqueValueInfos)&&a[0]&&a[0].symbol,d=1<a.length);if(!c||h(c))return null;c=c.clone();if(b||d)-1<c.type.indexOf("3d")?p(c):(b=c,-1!==b.type.indexOf("line")?b.color=y:(b.color=w,"simple-marker"===b.type&&
(b.outline={color:y,width:1.5})));return c}function h(a){return a?f.isSymbol3D(a)?a.symbolLayers?a.symbolLayers.some(function(a){return a&&"fill"===a.type}):!1:-1!==a.type.indexOf("fill"):!1}function p(a){m.isVolumetricSymbol(a)||("line-3d"===a.type?a.symbolLayers.forEach(function(a){a.material={color:y}}):a.symbolLayers.forEach(function(a){"icon"!==a.type||a.resource&&a.resource.href?a.material={color:r}:(a.material={color:w},a.outline={color:y,size:1.5})}))}function n(a,b,c,d){return l(this,void 0,
void 0,function(){var e,f,h,l,n;return k(this,function(k){switch(k.label){case 0:return[4,new Promise(function(a,b){g(["../../../renderers/visualVariables/support/visualVariableUtils"],a,b)})];case 1:f=(e=k.sent().getSizeRangeAtScale(a,c,d))&&u(e);if(!e&&!f)return[2,void 0];h=f.map(function(b){var c=e.minSize,d=e.maxSize,f=a.minDataValue,g=a.maxDataValue;return b<=c?f:b>=d?g:(b-c)/(d-c)*(g-f)+f});h=q.round(h);l=1;k.label=2;case 2:return l<h.length-1?[4,x(a,b,h[l],h[l-1],c,d)]:[3,5];case 3:if(n=k.sent())h[l]=
n[0],f[l]=n[1];k.label=4;case 4:return l++,[3,2];case 5:return[2,h]}})})}function u(a){var b=a.minSize;a=(a.maxSize-b)/4;for(var c=[],d=0;5>d;d++)c.push(b+a*d);return c}function x(a,b,c,d,e,f){return l(this,void 0,void 0,function(){var g,h,l,n,m,p,r,t,u,y,w,z,A,x,B,C,D,H,W,Z,Y,aa;return k(this,function(k){switch(k.label){case 0:return[4,v(a,b,c,e,f)];case 1:return h=k.sent(),[4,v(a,b,d,e,f)];case 2:l=k.sent(),n=q.numDigits(c),m=n.fractional,p=20,r=n.integer,u=t=null,0<c&&1>c&&(t=Math.pow(10,m),c*=
t,r=q.numDigits(c).integer),y=r-1,k.label=3;case 3:if(!(0<=y))return[3,8];w=Math.pow(10,y);z=Math.floor(c/w)*w;A=Math.ceil(c/w)*w;null!=t&&(z/=t,A/=t);x=(z+A)/2;g=q.round([z,x,A],{indexes:[1]});x=g[1];return[4,v(a,b,z,e,f)];case 4:return B=k.sent(),[4,v(a,b,A,e,f)];case 5:return C=k.sent(),[4,v(a,b,x,e,f)];case 6:D=k.sent();H=q.percentChange(h,B,l,null);W=q.percentChange(h,C,l,null);Z=q.percentChange(h,D,l,null);Y=H.previous<=p;aa=W.previous<=p;Y&&aa&&(H.previous<=W.previous?(Y=!0,aa=!1):(aa=!0,Y=
!1));Y?u=[z,B]:aa?u=[A,C]:Z.previous<=p&&(u=[x,D]);if(u)return[3,8];k.label=7;case 7:return y--,[3,3];case 8:return[2,u]}})})}function v(a,b,c,d,e){return l(this,void 0,void 0,function(){var f;return k(this,function(h){switch(h.label){case 0:return[4,new Promise(function(a,b){g(["../../../renderers/visualVariables/support/visualVariableUtils"],a,b)})];case 1:return f=h.sent().getSize,[2,f(a,c,{scale:d,view:e,shape:"simple-marker"===b.type?b.style:null})]}})})}function t(a,b){a=a.clone();if(f.isSymbol3D(a))m.isVolumetricSymbol(a)||
a.symbolLayers.forEach(function(a){"fill"!==a.type&&(a.size=b)});else if("esri.symbols.SimpleMarkerSymbol"===a.declaredClass)a.size=b;else if("esri.symbols.PictureMarkerSymbol"===a.declaredClass){var c=a.width,d=a.height;a.height=b;a.width=c/d*b}else"esri.symbols.SimpleLineSymbol"===a.declaredClass?a.width=b:"esri.symbols.TextSymbol"===a.declaredClass&&a.font&&(a.font.size=b);return a}Object.defineProperty(b,"__esModule",{value:!0});b.REAL_WORLD_MAX_SIZE=30;b.REAL_WORLD_MIN_SIZE=12;var w=[255,255,
255],r=[200,200,200],y=[128,128,128];b.getRampStops=function(d,f,g,h,p,r){return l(this,void 0,void 0,function(){var u,y,w,z,x,A,B,C,D,H,O,S,U,T,R,P,V,X=this;return k(this,function(F){switch(F.label){case 0:y=(u=f.legendOptions)&&u.customValues;w=e(d,g);z=!!w;x=!!y;A=null!=f.minSize&&null!=f.maxSize;B=f.stops&&1<f.stops.length;C=!!f.target;if(!z||!(x||A||B&&!C))return[2,void 0];D=m.isVolumetricSymbol(w);S=O=H=null;if(!D||B)return[3,1];O=q.round([f.minDataValue,f.maxDataValue]);return[3,4];case 1:return(U=
y)?[3,3]:[4,n(f,w,h,p)];case 2:U=F.sent(),F.label=3;case 3:O=U,F.label=4;case 4:!O&&B&&(O=f.stops.map(function(a){return a.value}),(H=f.stops.some(function(a){return!!a.label}))&&(S=f.stops.map(function(a){return a.label})));D&&O&&2<O.length&&(O=[O[0],O[O.length-1]]);if(!O)return[2,null];T=[b.REAL_WORLD_MIN_SIZE,b.REAL_WORLD_MAX_SIZE];R=m.getSymbolOutlineSize(w);P=H?null:c(O,r);return[4,a.all(O.map(function(a,b){return l(X,void 0,void 0,function(){var c,d,e,g;return k(this,function(k){switch(k.label){case 0:if(!D)return[3,
1];e=T[b];return[3,3];case 1:return[4,v(f,w,a,h,p)];case 2:e=k.sent(),k.label=3;case 3:return c=e,d=t(w,c),g=H?S[b]:P[b],[2,{value:a,symbol:d,label:g,size:c,outlineSize:R}]}})})}))];case 5:return V=F.sent(),[2,V.reverse()]}})})}})},"esri/widgets/Legend/styles/Card":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/assignHelper dojo/i18n!../../../nls/common dojo/i18n!../../Legend/nls/Legend ../../../intl ../../../core/Handles ../../../core/screenUtils ../../../core/accessorSupport/decorators ../../../symbols/support/svgUtils ../../Widget ./support/utils ../support/styleUtils ../../support/colorUtils ../../support/widget".split(" "),
function(g,b,l,k,f,a,q,m,d,c,e,h,p,n,u,x,v){var t=window.devicePixelRatio;return function(b){function f(a){a=b.call(this,a)||this;a._handles=new d;a._hasIndicators=!1;a._selectedSectionName=null;a._sectionNames=[];a._sectionMap=new Map;a.activeLayerInfos=null;a.layout="stack";a.type="card";a.view=null;return a}l(f,b);f.prototype.postInitialize=function(){var a=this;this.own([this.watch("activeLayerInfos",function(b){a._handles.removeAll();a._watchForSectionChanges(b)})])};f.prototype.destroy=function(){this._handles.destroy();
this._handles=null};f.prototype.render=function(){var b=this,c;this._hasIndicators="auto"===this.layout&&768>=this.view.container.clientWidth||"stack"===this.layout;var d=this.activeLayerInfos,e=d&&d.toArray().map(function(a){return b._renderLegendForLayer(a)}).filter(function(a){return!!a});this._hasIndicators?this._selectedSectionName&&-1!==this._sectionNames.indexOf(this._selectedSectionName)||(this._selectedSectionName=this._sectionNames&&this._sectionNames[0]):this._selectedSectionName=null;
var f=this._sectionNames.length,d=this._sectionNames.map(function(c,d){var e;d=m.substitute(a.pagination.pageText,{index:d+1,total:f});return v.tsx("div",{key:c,"aria-label":d,title:d,tabIndex:0,onclick:b._selectSection,onkeydown:b._selectSection,bind:b,class:b.classes("esri-legend--card__carousel-indicator",(e={},e["esri-legend--card__carousel-indicator--activated"]=b._selectedSectionName===c,e)),"data-section-name":c})}),d=this._hasIndicators&&1<f?v.tsx("div",{class:"esri-legend--card__carousel-indicator-container",
key:"carousel-navigation"},d):null,e=this._hasIndicators?this._sectionMap.get(this._selectedSectionName):e&&e.length?e:null,g=(c={},c["esri-legend--stacked"]=this._hasIndicators,c);return v.tsx("div",{class:this.classes("esri-legend--card esri-widget",g)},d,e?e:v.tsx("div",{class:"esri-legend--card__message"},q.noLegend))};f.prototype._selectSection=function(a){if(a=a.target.getAttribute("data-section-name"))this._selectedSectionName=a};f.prototype._watchForSectionChanges=function(a){var b=this;this._generateSectionNames();
a&&(a.forEach(function(a){var c="activeLayerInfo-"+a.layer.uid+"-version-change";b._handles.remove(c);b._watchForSectionChanges(a.children);b._handles.add(a.watch("version",function(){return b._generateSectionNames()}),c)}),this._handles.remove("activeLayerInfos-collection-change"),this._handles.add(a.on("change",function(){return b._watchForSectionChanges(a)}),"activeLayerInfos-collection-change"))};f.prototype._generateSectionNames=function(){this._sectionNames.length=0;this.activeLayerInfos&&this.activeLayerInfos.forEach(this._generateSectionNamesForActiveLayerInfo,
this)};f.prototype._generateSectionNamesForActiveLayerInfo=function(a){var b=this;a.children.forEach(this._generateSectionNamesForActiveLayerInfo,this);a.legendElements&&a.legendElements.forEach(function(c,d){b._sectionNames.push("esri-legend--card__"+a.layer.uid+"-type-"+c.type+"-"+d)})};f.prototype._renderLegendForLayer=function(a){var b=this,c;if(!a.ready)return null;if(a.children.length)return c=a.children.map(function(a){return b._renderLegendForLayer(a)}).toArray(),v.tsx("div",{key:a.layer.uid,
class:this.classes("esri-legend--card__service","esri-legend--card__group-layer")},v.tsx("div",{class:"esri-legend--card__service-caption-container"},a.title),c);var d=a.legendElements;if(d&&!d.length)return null;var e=d.some(function(a){return"relationship-ramp"===a.type}),d=d.map(function(c,d){return b._renderLegendForElement(c,a,d,e)}).filter(function(a){return!!a});if(!d.length)return null;var f=(c={},c["esri-legend--card__group-layer-child"]=!!a.parent,c);return v.tsx("div",{key:a.layer.uid,
class:this.classes("esri-legend--card__service",f)},v.tsx("div",{class:"esri-legend--card__service-caption-container"},v.tsx("div",{class:"esri-legend--card__service-caption-text"},a.title)),v.tsx("div",{class:"esri-legend--card__service-content"},d))};f.prototype._renderLegendForElement=function(a,b,c,d){var e=this;void 0===d&&(d=!1);var f,g="color-ramp"===a.type,h="opacity-ramp"===a.type,k="size-ramp"===a.type,l=b.layer,m=a.title,p=null;"string"===typeof m?p=m:m&&(p=u.getTitle(m,g||h),p=m.title?
m.title+" ("+p+")":p);c="esri-legend--card__"+l.uid+"-type-"+a.type+"-"+c;m=this._hasIndicators?v.tsx("div",null,v.tsx("h3",{class:this.classes("esri-widget__heading","esri-legend--card__carousel-title")},b.title),v.tsx("h4",{class:this.classes("esri-widget__heading","esri-legend--card__layer-caption")},p)):p?v.tsx("h4",{class:this.classes("esri-widget__heading","esri-legend--card__layer-caption")},p):null;p=null;"symbol-table"===a.type?(k=a.infos.map(function(c,d){return e._renderLegendForElementInfo(c,
b,a.legendType,d)}).filter(function(a){return!!a}),k.length&&(l=k[0].properties.classes&&k[0].properties.classes["esri-legend--card__symbol-row"],d=(f={},f["esri-legend--card__label-container"]=!l&&!d,f["esri-legend--card__relationship-label-container"]=d,f),p=v.tsx("div",{key:c,class:"esri-legend--card__section"},m,v.tsx("div",{class:this.classes(d)},k)))):"color-ramp"===a.type||"opacity-ramp"===a.type||"heatmap-ramp"===a.type?p=v.tsx("div",{key:c,class:"esri-legend--card__section"},m,this._renderLegendForRamp(a,
l.opacity)):k?p=v.tsx("div",{key:c,class:"esri-legend--card__section"},m,this._renderSizeRamps(a,l.opacity)):"relationship-ramp"===a.type&&(p=v.tsx("div",{key:c,class:this.classes("esri-legend--card__section","esri-legend--card__relationship-section")},m,n.renderRelationshipRamp(a,this.id,l.opacity)));if(!p)return null;this._sectionMap.set(c,p);return p};f.prototype._renderLegendForElementInfo=function(a,b,c,d){var e,f,g,h=b.layer;if(a.type)return this._renderLegendForElement(a,b,d);b=u.isImageryStretchedLegend(h,
c);if(a.symbol&&a.preview){if(-1===a.symbol.type.indexOf("simple-fill")){if(!a.label)return v.tsx("div",{key:d,bind:a.preview,afterCreate:u.attachToNode});h=(e={},e["esri-legend--card__symbol-cell"]=this._hasIndicators,e);return v.tsx("div",{key:d,class:this.classes("esri-legend--card__layer-row",(f={},f["esri-legend--card__symbol-row"]=this._hasIndicators,f))},v.tsx("div",{class:this.classes(h),bind:a.preview,afterCreate:u.attachToNode}),v.tsx("div",{class:this.classes("esri-legend--card__image-label",
(g={},g["esri-legend--card__label-cell"]=this._hasIndicators,g))},u.getTitle(a.label,!1)||""))}g=f=e=255;b=0;var k=c=255,l=255,n=0,m=a.symbol.color&&a.symbol.color.a,p=a.symbol.outline&&a.symbol.outline.color&&a.symbol.outline.color.a;m&&(e=a.symbol.color.r,f=a.symbol.color.g,g=a.symbol.color.b,b=a.symbol.color.a*h.opacity);p&&(c=a.symbol.outline.color.r,k=a.symbol.outline.color.g,l=a.symbol.outline.color.b,n=a.symbol.outline.color.a*h.opacity);var q=(h=a.symbol.color?x.isBright(a.symbol.color):!0)?
"rgba(255, 255, 255, .6)":"rgba(0, 0, 0, .6)";return v.tsx("div",{key:d,class:"esri-legend--card__layer-row"},v.tsx("div",{class:"esri-legend--card__label-element",styles:{background:m?"rgba("+e+", "+f+", "+g+", "+b+")":"none",color:h?"black":"white",textShadow:"-1px -1px 0 "+q+",\n                                              1px -1px 0 "+q+",\n                                              -1px 1px 0 "+q+",\n                                              1px 1px 0 "+q,border:p?"1px solid rgba("+c+
", "+k+", "+l+", "+n+")":"none"}}," ",a.label," "))}if(a.src)return h=this._renderImage(a,h,b),v.tsx("div",{key:d,class:"esri-legend--card__layer-row"},h,v.tsx("div",{class:"esri-legend--card__image-label"},a.label||""))};f.prototype._renderImage=function(a,b,c){var d,e=a.label,f=a.src,g=a.opacity;c=(d={},d["esri-legend--card__imagery-layer-image--stretched"]=c,d["esri-legend--card__symbol"]=!c,d);b={opacity:""+(null!=g?g:b.opacity)};return v.tsx("img",{alt:u.getTitle(e,!1),src:f,border:0,width:a.width,
height:a.height,class:this.classes(c),styles:b})};f.prototype._drawImageOnSizeRamp=function(a,b,c){var d=c.x,e=c.y,f=c.width,g=c.height,h=new Image;h.src=b;h.onload=function(){a.drawImage(h,d,e,f,g);URL.revokeObjectURL(b)}};f.prototype._attachSizeRampToNode=function(a){var b=a["data-layer-opacity"];null!=b&&(a.style.opacity=b.toString());var b=a["data-legend-element"].infos,d=b[0],e=b[b.length-1],f=d.symbol,g=e.symbol,h="picture-marker"===f.type;f?-1<f.type.indexOf("3d")?(b=f.symbolLayers&&f.symbolLayers.length)?
(b=f.symbolLayers.getItemAt(b-1).get("resource.primitive"),b="triangle"===b||"cone"===b||"tetrahedron"===b):b=void 0:b="triangle"===f.style:b=void 0;var k;f?-1<f.type.indexOf("3d")?(k=f.symbolLayers&&f.symbolLayers.length)?(k=f.symbolLayers.getItemAt(k-1),k=k.resource&&k.resource.primitive,k="circle"===k||"cross"===k||"kite"===k||"sphere"===k||"cube"===k||"diamond"===k):k=void 0:(k=f.style,k="circle"===k||"diamond"===k||"cross"===k):k=void 0;var l,n;h?(l=f.url,n=g.url):(d.preview&&(l=new Blob([d.preview.innerHTML],
{type:"image/svg+xml"}),l=URL.createObjectURL(l)),e.preview&&(n=new Blob([e.preview.innerHTML],{type:"image/svg+xml"}),n=URL.createObjectURL(n)));var m=c.pt2px(d.size+d.outlineSize)*t,f=c.pt2px(e.size+e.outlineSize)*t,g=this._hasIndicators?m:m+100*t,h=this._hasIndicators?g+50*t:m,d=document.createElement("canvas");d.width=g;d.height=h;d.style.width=d.width/t+"px";d.style.height=d.height/t+"px";e=d.getContext("2d");this._hasIndicators?(this._drawImageOnSizeRamp(e,l,{x:0,y:0,width:m,height:m}),this._drawImageOnSizeRamp(e,
n,{x:g/2-f/2,y:h-f,width:f,height:f}),e.beginPath(),l=g/2-f/2,n=h-(b?0:k?f/2:f),e.moveTo(0,k?g/2:g),e.lineTo(l,n),l=g/2+f/2,b=h-(b?0:k?f/2:f),e.moveTo(g,k?g/2:g),e.lineTo(l,b)):(this._drawImageOnSizeRamp(e,l,{x:g-m,y:0,width:m,height:m}),this._drawImageOnSizeRamp(e,n,{x:0,y:h/2-f/2,width:f,height:f}),e.beginPath(),l=g-(k||b?m/2:m),e.moveTo(f-(k||b?f/2:0),h/2-f/2),e.lineTo(l,0),b=g-(k?m/2:m),e.moveTo(f-(k?f/2:0),h/2+f/2),e.lineTo(b,h));e.strokeStyle="#ddd";e.stroke();a.appendChild(d)};f.prototype._renderSizeRamps=
function(a,b){var c,d=a.infos,e=d[0].label,d=d[d.length-1].label;return v.tsx("div",{class:this.classes("esri-legend--card__layer-row",(c={},c["esri-legend--card__size-ramp-row"]=this._hasIndicators,c))},v.tsx("div",{class:"esri-legend--card__ramp-label"},this._hasIndicators?e:d),v.tsx("div",{class:"esri-legend--card__size-ramp-container"},v.tsx("div",{bind:this,"data-layer-opacity":b,"data-legend-element":a,afterCreate:this._attachSizeRampToNode})),v.tsx("div",{class:"esri-legend--card__ramp-label"},
this._hasIndicators?d:e))};f.prototype._renderLegendForRamp=function(a,b){var c=a.infos,d="heatmap-ramp"===a.type,e=c.length-1;a=2<e&&!d?25*e:100;var f=a+20,g=c.slice(0).reverse();g.forEach(function(a,b){a.offset=d?a.ratio:b/e});var k=g.length-1,l=0!==g.length%2&&g[g.length/2|0],l=l&&v.tsx("div",{class:"esri-legend--card__interval-separators-container"},v.tsx("div",{class:"esri-legend--card__interval-separator"},"|"),v.tsx("div",{class:"esri-legend--card__ramp-label"},l.label)),n=c[c.length-1].label,
c=c[0].label,m=null;null!=b&&(m="opacity: "+b);b=h.renderSVG([[{shape:{type:"path",path:"M0 12.5 L10 0 L10 25 Z"},fill:g[0].color,stroke:{width:0}},{shape:{type:"rect",x:10,y:0,width:a,height:25},fill:{type:"linear",x1:10,y1:0,x2:a+10,y2:0,colors:g},stroke:{width:0}},{shape:{type:"path",path:"M"+(a+10)+" 0 L"+f+" 12.5 L"+(a+10)+" 25 Z"},fill:g[k].color,stroke:{width:0}}]],f,25);return v.tsx("div",{class:"esri-legend--card__layer-row"},v.tsx("div",{class:"esri-legend--card__ramp-label"},d?q[n]:n),
v.tsx("div",{class:"esri-legend--card__symbol-container"},v.tsx("div",{style:m},b),l),v.tsx("div",{class:"esri-legend--card__ramp-label"},d?q[c]:c))};k([v.renderable(),e.property()],f.prototype,"activeLayerInfos",void 0);k([e.property()],f.prototype,"layout",void 0);k([e.property({readOnly:!0})],f.prototype,"type",void 0);k([e.property()],f.prototype,"view",void 0);k([v.accessibleHandler()],f.prototype,"_selectSection",null);return f=k([e.subclass("esri.widgets.Legend.styles.Card")],f)}(e.declared(p))})},
"esri/widgets/Legend/styles/support/utils":function(){define(["require","exports","../../../../symbols/support/svgUtils","../../../support/widget"],function(g,b,l,k){function f(a,b,f){var d=f+"_arrowStart";f+="_arrowEnd";a="left"===a;var c={markerStart:null,markerEnd:null};switch(b){case "HL":a?c.markerStart="url(#"+f+")":c.markerEnd="url(#"+d+")";break;case "LL":c.markerStart="url(#"+f+")";break;case "LH":a?c.markerEnd="url(#"+d+")":c.markerStart="url(#"+f+")";break;default:c.markerEnd="url(#"+d+
")"}return c}Object.defineProperty(b,"__esModule",{value:!0});b.renderRelationshipRamp=function(a,b,g){var d=a.labels,c=!!a.focus,e=void 0;void 0===e&&(e=60);var h=a.focus,m=a.numClasses,n=a.colors,q=a.rotation;a=!!h;var x=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))+(a?0:5),v=null;null!=g&&(v="opacity: "+g);g=[];for(var t=[],w=[],r=(e||75)/m,y=0;y<m;y++)for(var A=y*r,z=0;z<m;z++){var B=z*r,C=l.generateFillAttributes(n[y][z]),D=l.generateStrokeAttributes(null),B={type:"rect",x:B,y:A,width:r,height:r};g.push(l.renderDef(C));
t.push(l.renderShape(B,C.fill,D,null));w.push(l.getBoundingBox(B))}m=null;a||(m="margin: -15px -15px -18px -15px");n=f("left",h,b);h=f("right",h,b);w=l.computeBBox(w);q=l.getTransformMatrix(w,x,x,0,!1,q);w=l.getTransformMatrix(w,x,x,0,!1,a?-45:null);b=k.tsx("div",{style:v,class:a?"esri-relationship-ramp--diamond__middle-column--ramp":"esri-relationship-ramp--square__table-cell"},k.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:x,height:x,style:m},k.tsx("defs",null,k.tsx("marker",{id:b+"_arrowStart",
markerWidth:"10",markerHeight:"10",refX:"5",refY:"5",markerUnits:"strokeWidth",orient:"auto"},k.tsx("polyline",{points:"0,0 5,5 0,10",fill:"none",stroke:"#555555","stroke-width":"1"})),k.tsx("marker",{id:b+"_arrowEnd",markerWidth:"10",markerHeight:"10",refX:"0",refY:"5",markerUnits:"strokeWidth",orient:"auto"},k.tsx("polyline",{points:"5,0 0,5 5,10",fill:"none",stroke:"#555555","stroke-width":"1"})),g),k.tsx("g",{transform:q},t),k.tsx("g",{transform:w},k.tsx("line",{fill:"none",stroke:"#555555","stroke-width":"1",
"marker-start":n.markerStart,"marker-end":n.markerEnd,x1:-10,y1:e-15,x2:-10,y2:15}),k.tsx("line",{fill:"none",stroke:"#555555","stroke-width":"1","marker-start":h.markerStart,"marker-end":h.markerEnd,x1:15,y1:e+10,x2:e-15,y2:e+10}))));return c?k.tsx("div",{class:"esri-relationship-ramp--diamond__container"},k.tsx("div",{class:"esri-relationship-ramp--diamond__left-column"},d.left),k.tsx("div",{class:"esri-relationship-ramp--diamond__middle-column"},k.tsx("div",{class:"esri-relationship-ramp--diamond__middle-column--label"},
d.top),b,k.tsx("div",{class:"esri-relationship-ramp--diamond__middle-column--label"},d.bottom)),k.tsx("div",{class:"esri-relationship-ramp--diamond__right-column"},d.right)):k.tsx("div",{class:"esri-relationship-ramp--square__table"},k.tsx("div",{class:"esri-relationship-ramp--square__table-row"},k.tsx("div",{class:k.classes("esri-relationship-ramp--square__table-cell","esri-relationship-ramp--square__table-label","esri-relationship-ramp--square__table-label--right-bottom")},d.left),k.tsx("div",{class:"esri-relationship-ramp--square__table-cell"}),
k.tsx("div",{class:k.classes("esri-relationship-ramp--square__table-cell","esri-relationship-ramp--square__table-label","esri-relationship-ramp--square__table-label--left-bottom")},d.top)),k.tsx("div",{class:"esri-relationship-ramp--square__table-row"},k.tsx("div",{class:"esri-relationship-ramp--square__table-cell"}),b,k.tsx("div",{class:"esri-relationship-ramp--square__table-cell"})),k.tsx("div",{class:"esri-relationship-ramp--square__table-row"},k.tsx("div",{class:k.classes("esri-relationship-ramp--square__table-cell",
"esri-relationship-ramp--square__table-label","esri-relationship-ramp--square__table-label--right-top")},d.bottom),k.tsx("div",{class:"esri-relationship-ramp--square__table-cell"}),k.tsx("div",{class:k.classes("esri-relationship-ramp--square__table-cell","esri-relationship-ramp--square__table-label","esri-relationship-ramp--square__table-label--left-top")},d.right)))}})},"esri/widgets/Legend/support/styleUtils":function(){define(["require","exports","dojo/i18n!../../Legend/nls/Legend","../../../intl"],
function(g,b,l,k){Object.defineProperty(b,"__esModule",{value:!0});b.attachToNode=function(b){b.appendChild(this)};b.getTitle=function(b,a){if(b){if("string"===typeof b)return b;if("value"in b||"unit"in b)return k.substitute(l.dotValue,b);if("colorName"in b||"bandName"in b)return l[b.colorName]+": "+(l[b.bandName]||b.bandName);var f=null;a?f=b.ratioPercentTotal?"showRatioPercentTotal":b.ratioPercent?"showRatioPercent":b.ratio?"showRatio":b.normField?"showNormField":b.field?"showField":null:a||(f=
b.normField?"showNormField":b.normByPct?"showNormPct":b.field?"showField":null);return f?k.substitute("showField"===f?"{field}":l[f],{field:b.field,normField:b.normField}):null}};b.isRendererTitle=function(b,a){return!a};b.isImageryStretchedLegend=function(b,a){return!!(a&&"Stretched"===a&&10.3<=b.version&&"esri.layers.ImageryLayer"===b.declaredClass)}})},"esri/widgets/support/colorUtils":function(){define(["require","exports","../../Color"],function(g,b,l){function k(a){return new l(a)}function f(a){return!!a&&
4===a.length&&e.test(a)}function a(a){return!!a&&7===a.length&&h.test(a)}function q(a){return 127<=.299*a.r+.587*a.g+.114*a.b}function m(a,b){void 0===b&&(b=1);b=Math.pow(.7,b);return new l([Math.round(a.r*b),Math.round(a.g*b),Math.round(a.b*b),a.a])}function d(a,b){void 0===b&&(b=1);b=Math.pow(.7,b);var c=a.r,d=a.g,e=a.b;30>c&&(c=30);30>d&&(d=30);30>e&&(e=30);return new l([Math.min(255,Math.round(c/b)),Math.min(255,Math.round(d/b)),Math.min(255,Math.round(e/b)),a.a])}function c(a,b){var c=a.r,d=
a.g,e=a.b;a=a.a;1>a&&(c=Math.round(a*c+(1-a)*b.r),d=Math.round(a*d+(1-a)*b.g),e=Math.round(a*e+(1-a)*b.b));return new l({r:c,g:d,b:e})}Object.defineProperty(b,"__esModule",{value:!0});var e=/^#[0-9A-F]{3}$/i,h=/^#[0-9A-F]{6}$/i,p=new l({r:255,g:255,b:255});b.equal=function(a,b){return a&&b&&a.r===b.r&&a.g===b.g&&a.b===b.b&&a.a===b.a};b.normalizeHex=function(a){return a?"#"+a.trim().replace(/#/g,"").substr(0,6):""};b.normalizeColor=k;b.isValidHex=function(b){return f(b)||a(b)};b.isShorthandHex=f;b.isLonghandHex=
a;b.toHex=function(a){return k(a).toHex()};b.getContrastingColor=function(a){return q(a)?m(a):d(a,3)};b.isBright=q;b.darker=m;b.brighter=d;b.blendWithBackground=c;b.getColorTheme=function(a,b){void 0===b&&(b=p);a=c(a,b);return q(a)?"light":"dark"}})},"esri/widgets/Legend/styles/Classic":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper dojo/i18n!../../Legend/nls/Legend ../../../intl ../../../core/accessorSupport/decorators ../../Widget ./support/utils ../support/styleUtils ../../support/widget".split(" "),
function(g,b,l,k,f,a,q,m,d,c,e){return function(b){function g(a){a=b.call(this,a)||this;a.activeLayerInfos=null;a.type="classic";return a}l(g,b);g.prototype.render=function(){var a=this,b=this.activeLayerInfos,c=this.classes("esri-legend esri-widget--panel","esri-widget"),b=b&&b.toArray().map(function(b){return a._renderLegendForLayer(b)}).filter(function(a){return!!a});return e.tsx("div",{class:c},b&&b.length?b:e.tsx("div",{class:"esri-legend__message"},f.noLegend))};g.prototype._renderLegendForLayer=
function(a){var b=this,c;if(!a.ready)return null;var d=!!a.children.length,f="esri-legend__"+a.layer.uid+"-version-"+a.version,g=a.title?e.tsx("h3",{class:this.classes("esri-widget__heading","esri-legend__service-label")},a.title):null;if(d)return c=a.children.map(function(a){return b._renderLegendForLayer(a)}).toArray(),e.tsx("div",{key:f,class:this.classes("esri-legend__service","esri-legend__group-layer")},g,c);if((d=a.legendElements)&&!d.length)return null;d=d.map(function(c){return b._renderLegendForElement(c,
a.layer)}).filter(function(a){return!!a});if(!d.length)return null;var h=(c={},c["esri-legend__group-layer-child"]=!!a.parent,c);return e.tsx("div",{key:f,class:this.classes("esri-legend__service",h)},g,e.tsx("div",{class:"esri-legend__layer"},d))};g.prototype._renderLegendForElement=function(a,b,f){var g=this,h,k="color-ramp"===a.type,l="opacity-ramp"===a.type,m="size-ramp"===a.type,n=null;if("symbol-table"===a.type||m){var p=a.infos.map(function(c){return g._renderLegendForElementInfo(c,b,m,a.legendType)}).filter(function(a){return!!a});
p.length&&(n=e.tsx("div",{class:"esri-legend__layer-body"},p))}else"color-ramp"===a.type||"opacity-ramp"===a.type||"heatmap-ramp"===a.type||"stretch-ramp"===a.type?n=this._renderLegendForRamp(a,b.opacity):"relationship-ramp"===a.type&&(n=d.renderRelationshipRamp(a,this.id,b.opacity));if(!n)return null;var p=a.title,q=null;"string"===typeof p?q=p:p&&(q=c.getTitle(p,k||l),q=c.isRendererTitle(p,k||l)&&p.title?p.title+" ("+q+")":q);k=f?"esri-legend__layer-child-table":"esri-legend__layer-table";l=q?e.tsx("div",
{class:"esri-legend__layer-caption"},q):null;f=(h={},h["esri-legend__layer-table--size-ramp"]=m||!f,h);return e.tsx("div",{class:this.classes(k,f)},l,n)};g.prototype._renderLegendForRamp=function(a,b){var d=this,g=a.infos,h="heatmap-ramp"===a.type,k="stretch-ramp"===a.type,l=a.preview;l.className="esri-legend__color-ramp "+("opacity-ramp"===a.type?"esri-legend__opacity-ramp":"");null!=b&&(l.style.opacity=b.toString());a=g.map(function(a){return e.tsx("div",{class:a.label?"esri-legend__ramp-label":
null},h?f[a.label]:k?d._getStretchStopLabel(a):a.label)});b={height:l.style.height};return e.tsx("div",{class:"esri-legend__layer-row"},e.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--symbols",styles:{width:"24px"}},e.tsx("div",{class:"esri-legend__ramps",bind:l,afterCreate:c.attachToNode})),e.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info"},e.tsx("div",{class:"esri-legend__ramp-labels",styles:b},a)))};g.prototype._getStretchStopLabel=function(b){return b.label?
f[b.label]+": "+a.formatNumber(b.value,{style:"decimal"}):""};g.prototype._renderLegendForElementInfo=function(a,b,d,f){var g,h;if(a.type)return this._renderLegendForElement(a,b,!0);var k=null;f=c.isImageryStretchedLegend(b,f);a.symbol&&a.preview?k=e.tsx("div",{class:"esri-legend__symbol",bind:a.preview,afterCreate:c.attachToNode}):a.src&&(k=this._renderImage(a,b,f));if(!k)return null;b=(g={},g["esri-legend__imagery-layer-info--stretched"]=f,g);d=(h={},h["esri-legend__imagery-layer-info--stretched"]=
f,h["esri-legend__size-ramp"]=!f&&d,h);return e.tsx("div",{class:"esri-legend__layer-row"},e.tsx("div",{class:this.classes("esri-legend__layer-cell esri-legend__layer-cell--symbols",d)},k),e.tsx("div",{class:this.classes("esri-legend__layer-cell esri-legend__layer-cell--info",b)},c.getTitle(a.label,!1)||""))};g.prototype._renderImage=function(a,b,d){var f,g=a.label,h=a.src,k=a.opacity;d=(f={},f["esri-legend__imagery-layer-image--stretched"]=d,f["esri-legend__symbol"]=!d,f);b={opacity:""+(null!=k?
k:b.opacity)};return e.tsx("img",{alt:c.getTitle(g,!1),src:h,border:0,width:a.width,height:a.height,class:this.classes(d),styles:b})};k([e.renderable(),q.property()],g.prototype,"activeLayerInfos",void 0);k([q.property({readOnly:!0})],g.prototype,"type",void 0);return g=k([q.subclass("esri.widgets.Legend.styles.Classic")],g)}(q.declared(m))})},"*now":function(g){g(['dojo/i18n!*preload*esri/widgets/nls/Legend*["ar","bs","ca","cs","da","de","de-ch","el","en-au","en-ca","en-gb","en-us","es","es-mx","et","fi","fr","fr-ch","he","hr","hu","id","it","it-ch","ja","ko","lt","lv","nl","nb","pl","pt","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","uk","vi","zh-cn","zh-hk","zh-tw","ROOT"]'])},
"*noref":1}});
define("require exports ../core/tsSupport/assignHelper ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/i18n!./Legend/nls/Legend ../core/Handles ../core/watchUtils ../core/accessorSupport/decorators ../core/accessorSupport/decorators/cast ./Widget ./Legend/LegendViewModel ./Legend/styles/Card ./Legend/styles/Classic ./support/widget".split(" "),function(g,b,l,k,f,a,q,m,d,c,e,h,p,n,u){return function(b){function e(c){c=b.call(this,c)||this;c._handles=new q;c.activeLayerInfos=
null;c.basemapLegendVisible=!1;c.groundLegendVisible=!1;c.respectLayerVisibility=!0;c.iconClass="esri-icon-layer-list";c.label=a.widgetLabel;c.layerInfos=null;c.style=new n;c.view=null;c.viewModel=new h;return c}k(e,b);e.prototype.postInitialize=function(){var a=this;this.own(m.on(this,"activeLayerInfos","change",function(){return a._refreshActiveLayerInfos(a.activeLayerInfos)}),m.init(this,"style",function(b,c){c&&b!==c&&c.destroy();b&&(b.activeLayerInfos=a.activeLayerInfos,"card"===b.type&&(b.view=
a.view))}))};e.prototype.destroy=function(){this._handles.destroy();this._handles=null};e.prototype.castStyle=function(a){if(a instanceof p||a instanceof n)return a;if("string"===typeof a)return"card"===a?new p:new n;if(a&&"string"===typeof a.type){var b=l({},a);delete b.type;return new ("card"===a.type?p:n)(b)}return new n};e.prototype.render=function(){return this.style.render()};e.prototype._refreshActiveLayerInfos=function(a){var b=this;this._handles.removeAll();a.forEach(function(a){return b._renderOnActiveLayerInfoChange(a)});
this.scheduleRender()};e.prototype._renderOnActiveLayerInfoChange=function(a){var b=this,c=m.init(a,"version",function(){return b.scheduleRender()});this._handles.add(c,"version_"+a.layer.uid);a.children.forEach(function(a){return b._renderOnActiveLayerInfoChange(a)})};f([d.aliasOf("viewModel.activeLayerInfos"),u.renderable()],e.prototype,"activeLayerInfos",void 0);f([d.aliasOf("viewModel.basemapLegendVisible"),u.renderable()],e.prototype,"basemapLegendVisible",void 0);f([d.aliasOf("viewModel.groundLegendVisible"),
u.renderable()],e.prototype,"groundLegendVisible",void 0);f([d.aliasOf("viewModel.respectLayerVisibility"),u.renderable()],e.prototype,"respectLayerVisibility",void 0);f([d.property()],e.prototype,"iconClass",void 0);f([d.property()],e.prototype,"label",void 0);f([d.aliasOf("viewModel.layerInfos"),u.renderable()],e.prototype,"layerInfos",void 0);f([d.property(),u.renderable()],e.prototype,"style",void 0);f([c.cast("style")],e.prototype,"castStyle",null);f([d.aliasOf("viewModel.view"),u.renderable()],
e.prototype,"view",void 0);f([d.property(),u.renderable(["view.size"])],e.prototype,"viewModel",void 0);return e=f([d.subclass("esri.widgets.Legend")],e)}(d.declared(e))});