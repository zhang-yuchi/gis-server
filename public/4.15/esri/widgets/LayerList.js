// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.15/esri/copyright.txt for details.
//>>built
/*
 MIT
*/
require({cache:{"esri/libs/sortablejs/Sortable":function(){(function(M,F){"object"===typeof exports&&"undefined"!==typeof module?module.exports=F():"function"===typeof define&&define.amd?define(F):(M=M||self,M.Sortable=F())})(this,function(){function M(a){M="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};return M(a)}function F(){F=Object.assign||
function(a){for(var d=1;d<arguments.length;d++){var e=arguments[d],m;for(m in e)Object.prototype.hasOwnProperty.call(e,m)&&(a[m]=e[m])}return a};return F.apply(this,arguments)}function L(a){for(var d=1;d<arguments.length;d++){var e=null!=arguments[d]?arguments[d]:{},m=Object.keys(e);"function"===typeof Object.getOwnPropertySymbols&&(m=m.concat(Object.getOwnPropertySymbols(e).filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})));m.forEach(function(d){var m=e[d];d in a?Object.defineProperty(a,
d,{value:m,enumerable:!0,configurable:!0,writable:!0}):a[d]=m})}return a}function f(a,d){if(null==a)return{};var e;if(null==a)e={};else{e={};var m=Object.keys(a),B,b;for(b=0;b<m.length;b++)B=m[b],0<=d.indexOf(B)||(e[B]=a[B])}if(Object.getOwnPropertySymbols)for(b=Object.getOwnPropertySymbols(a),B=0;B<b.length;B++)m=b[B],0<=d.indexOf(m)||Object.prototype.propertyIsEnumerable.call(a,m)&&(e[m]=a[m]);return e}function N(a){var d;if(Array.isArray(a)){d=0;for(var e=Array(a.length);d<a.length;d++)e[d]=a[d];
d=e}else d=void 0;d||(d=Symbol.iterator in Object(a)||"[object Arguments]"===Object.prototype.toString.call(a)?Array.from(a):void 0);if(!(a=d))throw new TypeError("Invalid attempt to spread non-iterable instance");return a}function v(a){return!!navigator.userAgent.match(a)}function r(a,d,e){a.addEventListener(d,e,!O&&ob)}function p(a,d,e){a.removeEventListener(d,e,!O&&ob)}function H(a,d){if(d){"\x3e"===d[0]&&(d=d.substring(1));if(a)try{if(a.matches)return a.matches(d);if(a.msMatchesSelector)return a.msMatchesSelector(d);
if(a.webkitMatchesSelector)return a.webkitMatchesSelector(d)}catch(e){}return!1}}function T(a,d,e,m){if(a){e=e||document;do{if(null!=d&&("\x3e"===d[0]?a.parentNode===e&&H(a,d):H(a,d))||m&&a===e)return a;if(a===e)break}while(a=a.host&&a!==document&&a.host.nodeType?a.host:a.parentNode)}return null}function y(a,d,e){if(a&&d)if(a.classList)a.classList[e?"add":"remove"](d);else{var m=(" "+a.className+" ").replace(pb," ").replace(" "+d+" "," ");a.className=(m+(e?" "+d:"")).replace(pb," ")}}function l(a,
d,e){var m=a&&a.style;if(m){if(void 0===e)return document.defaultView&&document.defaultView.getComputedStyle?e=document.defaultView.getComputedStyle(a,""):a.currentStyle&&(e=a.currentStyle),void 0===d?e:e[d];d in m||-1!==d.indexOf("webkit")||(d="-webkit-"+d);m[d]=e+("string"===typeof e?"":"px")}}function I(a,d){var e="";if("string"===typeof a)e=a;else{do{var m=l(a,"transform");m&&"none"!==m&&(e=m+" "+e)}while(!d&&(a=a.parentNode))}return(a=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix)&&
new a(e)}function c(a,d,e){if(a){a=a.getElementsByTagName(d);d=0;var m=a.length;if(e)for(;d<m;d++)e(a[d],d);return a}return[]}function g(){return O?document.documentElement:document.scrollingElement}function E(a,d,e,m,b){if(a.getBoundingClientRect||a===window){var B,k,h,q,f,n,c;a!==window&&a!==g()?(B=a.getBoundingClientRect(),k=B.top,h=B.left,q=B.bottom,f=B.right,n=B.height,c=B.width):(h=k=0,q=window.innerHeight,f=window.innerWidth,n=window.innerHeight,c=window.innerWidth);if((d||e)&&a!==window&&
(b=b||a.parentNode,!O)){do if(b&&b.getBoundingClientRect&&("none"!==l(b,"transform")||e&&"static"!==l(b,"position"))){q=b.getBoundingClientRect();k-=q.top+parseInt(l(b,"border-top-width"));h-=q.left+parseInt(l(b,"border-left-width"));q=k+B.height;f=h+B.width;break}while(b=b.parentNode)}m&&a!==window&&(m=(a=I(b||a))&&a.a,b=a&&a.d,a&&(k/=b,h/=m,c/=m,n/=b,q=k+n,f=h+c));return{top:k,left:h,bottom:q,right:f,width:c,height:n}}}function ka(a,d,e){var m=x(a,!0);for(a=E(a)[d];m;){d=E(m)[e];var b=void 0,b=
"top"===e||"left"===e?a>=d:a<=d;if(!b)return m;if(m===g())break;m=x(m,!1)}return!1}function ga(a,d,e){for(var m=0,b=0,k=a.children;b<k.length;){if("none"!==k[b].style.display&&k[b]!==z.ghost&&k[b]!==z.dragged&&T(k[b],e.draggable,a,!1)){if(m===d)return k[b];m++}b++}return null}function ba(a,d){for(a=a.lastElementChild;a&&(a===z.ghost||"none"===l(a,"display")||d&&!H(a,d));)a=a.previousElementSibling;return a||null}function t(a,d){var e=0;if(!a||!a.parentNode)return-1;for(;a=a.previousElementSibling;)"TEMPLATE"===
a.nodeName.toUpperCase()||a===z.clone||d&&!H(a,d)||e++;return e}function na(a){var d=0,e=0,m=g();if(a){do var b=I(a),k=b.d,d=d+a.scrollLeft*b.a,e=e+a.scrollTop*k;while(a!==m&&(a=a.parentNode))}return[d,e]}function qa(a,d){for(var e in a)if(a.hasOwnProperty(e))for(var m in d)if(d.hasOwnProperty(m)&&d[m]===a[e][m])return Number(e);return-1}function x(a,d){if(!a||!a.getBoundingClientRect)return g();var e=!1;do if(a.clientWidth<a.scrollWidth||a.clientHeight<a.scrollHeight){var m=l(a);if(a.clientWidth<
a.scrollWidth&&("auto"==m.overflowX||"scroll"==m.overflowX)||a.clientHeight<a.scrollHeight&&("auto"==m.overflowY||"scroll"==m.overflowY)){if(!a.getBoundingClientRect||a===document.body)break;if(e||d)return a;e=!0}}while(a=a.parentNode);return g()}function C(a,d){return Math.round(a.top)===Math.round(d.top)&&Math.round(a.left)===Math.round(d.left)&&Math.round(a.height)===Math.round(d.height)&&Math.round(a.width)===Math.round(d.width)}function Ra(a,d){return function(){if(!Da){var e=arguments;1===e.length?
a.call(this,e[0]):a.apply(this,e);Da=setTimeout(function(){Da=void 0},d)}}}function w(a,d,e){a.scrollLeft+=d;a.scrollTop+=e}function b(a){var d=window.Polymer,e=window.jQuery||window.Zepto;return d&&d.dom?d.dom(a).cloneNode(!0):e?e(a).clone(!0)[0]:a.cloneNode(!0)}function h(a,d){l(a,"position","absolute");l(a,"top",d.top);l(a,"left",d.left);l(a,"width",d.width);l(a,"height",d.height)}function X(a){l(a,"position","");l(a,"top","");l(a,"left","");l(a,"width","");l(a,"height","")}function G(){var a=
[],d;return{captureAnimationState:function(){a=[];this.options.animation&&[].slice.call(this.el.children).forEach(function(d){if("none"!==l(d,"display")&&d!==z.ghost){a.push({target:d,rect:E(d)});var e=L({},a[a.length-1].rect);if(d.thisAnimationDuration){var b=I(d,!0);b&&(e.top-=b.f,e.left-=b.e)}d.fromRect=e}})},addAnimationState:function(d){a.push(d)},removeAnimationState:function(d){a.splice(qa(a,{target:d}),1)},animateAll:function(e){var m=this;if(this.options.animation){var b=!1,k=0;a.forEach(function(a){var d=
0,e=a.target,B=e.fromRect,h=E(e),q=e.prevFromRect,g=e.prevToRect;a=a.rect;var wa=I(e,!0);wa&&(h.top-=wa.f,h.left-=wa.e);e.toRect=h;e.thisAnimationDuration&&C(q,h)&&!C(B,h)&&(a.top-h.top)/(a.left-h.left)===(B.top-h.top)/(B.left-h.left)&&(d=Math.sqrt(Math.pow(q.top-a.top,2)+Math.pow(q.left-a.left,2))/Math.sqrt(Math.pow(q.top-g.top,2)+Math.pow(q.left-g.left,2))*m.options.animation);C(h,B)||(e.prevFromRect=B,e.prevToRect=h,d||(d=m.options.animation),m.animate(e,a,h,d));d&&(b=!0,k=Math.max(k,d),clearTimeout(e.animationResetTimer),
e.animationResetTimer=setTimeout(function(){e.animationTime=0;e.prevFromRect=null;e.fromRect=null;e.prevToRect=null;e.thisAnimationDuration=null},d),e.thisAnimationDuration=d)});clearTimeout(d);b?d=setTimeout(function(){"function"===typeof e&&e()},k):"function"===typeof e&&e();a=[]}else clearTimeout(d),"function"===typeof e&&e()},animate:function(a,d,b,k){if(k){l(a,"transition","");l(a,"transform","");var e=I(this.el),m=(d.left-b.left)/(e&&e.a||1);d=(d.top-b.top)/(e&&e.d||1);a.animatingX=!!m;a.animatingY=
!!d;l(a,"transform","translate3d("+m+"px,"+d+"px,0)");l(a,"transition","transform "+k+"ms"+(this.options.easing?" "+this.options.easing:""));l(a,"transform","translate3d(0,0,0)");"number"===typeof a.animated&&clearTimeout(a.animated);a.animated=setTimeout(function(){l(a,"transition","");l(a,"transform","");a.animated=!1;a.animatingX=!1;a.animatingY=!1},k)}}}}function J(a){var d=a.sortable,e=a.rootEl,m=a.name,b=a.targetEl,k=a.cloneEl,h=a.toEl,q=a.fromEl,g=a.oldIndex,f=a.newIndex,n=a.oldDraggableIndex,
c=a.newDraggableIndex,l=a.originalEvent,C=a.putSortable,w=a.extraEventProperties;if(d=d||e&&e[Z]){var u=d.options,X="on"+m.charAt(0).toUpperCase()+m.substr(1);!window.CustomEvent||O||R?(a=document.createEvent("Event"),a.initEvent(m,!0,!0)):a=new CustomEvent(m,{bubbles:!0,cancelable:!0});a.to=h||e;a.from=q||e;a.item=b||e;a.clone=k;a.oldIndex=g;a.newIndex=f;a.oldDraggableIndex=n;a.newDraggableIndex=c;a.originalEvent=l;a.pullMode=C?C.lastPutMode:void 0;var m=L({},w,Ea.getEventProperties(m,d)),J;for(J in m)a[J]=
m[J];e&&e.dispatchEvent(a);u[X]&&u[X].call(d,a)}}function K(a){J(L({putSortable:Y,cloneEl:U,targetEl:u,rootEl:S,oldIndex:xa,oldDraggableIndex:Fa,newIndex:da,newDraggableIndex:oa},a))}function z(a,d){if(!a||!a.nodeType||1!==a.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(a));this.el=a;this.options=d=F({},d);a[Z]=this;var e={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(a.nodeName)?"\x3eli":"\x3e*",swapThreshold:1,invertSwap:!1,
invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return qb(a,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(a,d){a.setData("Text",d.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",
fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==z.supportPointer&&"PointerEvent"in window,emptyInsertThreshold:5};Ea.initializePlugins(this,a,e);for(var m in e)m in d||(d[m]=e[m]);rb(d);for(var b in this)"_"===b.charAt(0)&&"function"===typeof this[b]&&(this[b]=this[b].bind(this));if(this.nativeDraggable=d.forceFallback?!1:Ab)this.options.touchStartThreshold=1;d.supportPointer?r(a,"pointerdown",this._onTapStart):(r(a,"mousedown",this._onTapStart),r(a,"touchstart",
this._onTapStart));this.nativeDraggable&&(r(a,"dragover",this),r(a,"dragenter",this));Sa.push(this.el);d.store&&d.store.get&&this.sort(d.store.get(this)||[]);F(this,G())}function Ga(a,d,e,m,b,k,h,q){var B,g=a[Z],wa=g.options.onMove,f;!window.CustomEvent||O||R?(B=document.createEvent("Event"),B.initEvent("move",!0,!0)):B=new CustomEvent("move",{bubbles:!0,cancelable:!0});B.to=d;B.from=a;B.dragged=e;B.draggedRect=m;B.related=b||d;B.relatedRect=k||E(d);B.willInsertAfter=q;B.originalEvent=h;a.dispatchEvent(B);
wa&&(f=wa.call(g,B,h));return f}function ya(a){a.draggable=!1}function Ha(){bb=!1}function ha(a,d,e){e=E(ba(e.el,e.options.draggable));return d?a.clientX>e.right+10||a.clientX<=e.right&&a.clientY>e.bottom&&a.clientX>=e.left:a.clientX>e.right&&a.clientY>e.top||a.clientX<=e.right&&a.clientY>e.bottom+10}function ra(a,d,e,m,b,k,h,q){a=m?a.clientY:a.clientX;var B=m?e.height:e.width,g=m?e.top:e.left;e=m?e.bottom:e.right;m=!1;if(!h)if(q&&Ta<B*b)if(!Ia&&(1===Ja?a>g+B*k/2:a<e-B*k/2)&&(Ia=!0),Ia)m=!0;else{if(1===
Ja?a<g+Ta:a>e-Ta)return-Ja}else if(a>g+B*(1-b)/2&&a<e-B*(1-b)/2)return d=t(u)<t(d)?1:-1,d;if(m||h)if(a<g+B*k/2||a>e-B*k/2)return a>g+B/2?1:-1;return 0}function za(a){a=a.tagName+a.className+a.src+a.href+a.textContent;for(var d=a.length,e=0;d--;)e+=a.charCodeAt(d);return e.toString(36)}function cb(a){Ua.length=0;a=a.getElementsByTagName("input");for(var d=a.length;d--;){var e=a[d];e.checked&&Ua.push(e)}}function ia(a){return setTimeout(a,0)}function Va(){V.forEach(function(a){clearInterval(a.pid)});
V=[]}function n(){}function db(){}function k(a,d){A.forEach(function(e,m){(m=d.children[e.sortableIndex+(a?Number(m):0)])?d.insertBefore(e,m):d.appendChild(e)})}function q(a,d){ea.forEach(function(e,m){(m=d.children[e.sortableIndex+(a?Number(m):0)])?d.insertBefore(e,m):d.appendChild(e)})}function P(){A.forEach(function(a){a!==Q&&a.parentNode&&a.parentNode.removeChild(a)})}var O=v(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),R=v(/Edge/i),sb=v(/firefox/i),eb=v(/safari/i)&&!v(/chrome/i)&&
!v(/android/i),Ka=v(/iP(ad|od|hone)/i),Bb=v(/chrome/i)&&v(/android/i),ob={capture:!1,passive:!1},pb=/\s+/g,Da,Z="Sortable"+(new Date).getTime(),La=[],fb={initializeByDefault:!0},Ea={mount:function(a){for(var d in fb)!fb.hasOwnProperty(d)||d in a||(a[d]=fb[d]);La.push(a)},pluginEvent:function(a,d,e){var m=this;this.eventCanceled=!1;e.cancel=function(){m.eventCanceled=!0};var b=a+"Global";La.forEach(function(m){if(d[m.pluginName]){if(d[m.pluginName][b])d[m.pluginName][b](L({sortable:d},e));if(d.options[m.pluginName]&&
d[m.pluginName][a])d[m.pluginName][a](L({sortable:d},e))}})},initializePlugins:function(a,d,e,m){La.forEach(function(m){var b=m.pluginName;if(a.options[b]||m.initializeByDefault)m=new m(a,d,a.options),m.sortable=a,m.options=a.options,a[b]=m,F(e,m.defaults)});for(var b in a.options)a.options.hasOwnProperty(b)&&(m=this.modifyOption(a,b,a.options[b]),"undefined"!==typeof m&&(a.options[b]=m))},getEventProperties:function(a,d){var e={};La.forEach(function(m){"function"===typeof m.eventProperties&&F(e,
m.eventProperties.call(d[m.pluginName],a))});return e},modifyOption:function(a,d,e){var m;La.forEach(function(b){a[b.pluginName]&&b.optionListeners&&"function"===typeof b.optionListeners[d]&&(m=b.optionListeners[d].call(a[b.pluginName],e))});return m}},ca=function(a,d){var e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},m=e.evt,e=f(e,["evt"]);Ea.pluginEvent.bind(z)(a,d,L({dragEl:u,parentEl:W,ghostEl:D,rootEl:S,nextEl:sa,lastDownEl:Wa,cloneEl:U,cloneHidden:pa,dragStarted:Ma,putSortable:Y,
activeSortable:z.active,originalEvent:m,oldIndex:xa,oldDraggableIndex:Fa,newIndex:da,newDraggableIndex:oa,hideGhostForTarget:tb,unhideGhostForTarget:ub,cloneNowHidden:function(){pa=!0},cloneNowShown:function(){pa=!1},dispatchSortableEvent:function(a){K({sortable:d,name:a,originalEvent:m})}},e))};if("undefined"===typeof window||!window.document)throw Error("Sortable.js requires a window with a document");var u,W,D,S,sa,Wa,U,pa,xa,da,Fa,oa,Xa,Y,Aa=!1,Ya=!1,Sa=[],ta,la,gb,hb,vb,wb,Ma,Ba,Ja,Ia=!1,Za=
!1,Ta,aa,ib=[],bb=!1,Ua=[],xb=R||O?"cssFloat":"float",Ab=!Bb&&!Ka&&"draggable"in document.createElement("div"),yb=function(){if(O)return!1;var a=document.createElement("x");a.style.cssText="pointer-events:auto";return"auto"===a.style.pointerEvents}(),qb=function(a,d){var e=l(a),m=parseInt(e.width)-parseInt(e.paddingLeft)-parseInt(e.paddingRight)-parseInt(e.borderLeftWidth)-parseInt(e.borderRightWidth),b=ga(a,0,d);a=ga(a,1,d);var k=b&&l(b);d=a&&l(a);var h=k&&parseInt(k.marginLeft)+parseInt(k.marginRight)+
E(b).width,q=d&&parseInt(d.marginLeft)+parseInt(d.marginRight)+E(a).width;return"flex"===e.display?"column"===e.flexDirection||"column-reverse"===e.flexDirection?"vertical":"horizontal":"grid"===e.display?1>=e.gridTemplateColumns.split(" ").length?"vertical":"horizontal":b&&k["float"]&&"none"!==k["float"]?(e="left"===k["float"]?"left":"right",!a||"both"!==d.clear&&d.clear!==e?"horizontal":"vertical"):b&&("block"===k.display||"flex"===k.display||"table"===k.display||"grid"===k.display||h>=m&&"none"===
e[xb]||a&&"none"===e[xb]&&h+q>m)?"vertical":"horizontal"},Cb=function(a,d,e){var m=e?a.left:a.top,b=e?a.right:a.bottom;a=e?a.width:a.height;var k=e?d.left:d.top,h=e?d.right:d.bottom;d=e?d.width:d.height;return m===k||b===h||m+a/2===k+d/2},Db=function(a,d){var e;Sa.some(function(m){if(!ba(m)){var b=E(m),k=m[Z].options.emptyInsertThreshold,h=a>=b.left-k&&a<=b.right+k,b=d>=b.top-k&&d<=b.bottom+k;if(k&&h&&b)return e=m}});return e},rb=function(a){function d(a,e){return function(b,m,k,h){var q=b.options.group.name&&
m.options.group.name&&b.options.group.name===m.options.group.name;if(null==a&&(e||q))return!0;if(null==a||!1===a)return!1;if(e&&"clone"===a)return a;if("function"===typeof a)return d(a(b,m,k,h),e)(b,m,k,h);b=(e?b:m).options.group.name;return!0===a||"string"===typeof a&&a===b||a.join&&-1<a.indexOf(b)}}var e={},b=a.group;b&&"object"==M(b)||(b={name:b});e.name=b.name;e.checkPull=d(b.pull,!0);e.checkPut=d(b.put);e.revertClone=b.revertClone;a.group=e},tb=function(){!yb&&D&&l(D,"display","none")},ub=function(){!yb&&
D&&l(D,"display","")};document.addEventListener("click",function(a){if(Ya)return a.preventDefault(),a.stopPropagation&&a.stopPropagation(),a.stopImmediatePropagation&&a.stopImmediatePropagation(),Ya=!1},!0);var ua=function(a){if(u){a=a.touches?a.touches[0]:a;var d=Db(a.clientX,a.clientY);if(d){var e={},b;for(b in a)a.hasOwnProperty(b)&&(e[b]=a[b]);e.target=e.rootEl=d;e.preventDefault=void 0;e.stopPropagation=void 0;d[Z]._onDragOver(e)}}},Eb=function(a){u&&u.parentNode[Z]._isOutsideThisEl(a.target)};
z.prototype={constructor:z,_isOutsideThisEl:function(a){this.el.contains(a)||a===this.el||(Ba=null)},_getDirection:function(a,d){return"function"===typeof this.options.direction?this.options.direction.call(this,a,d,u):this.options.direction},_onTapStart:function(a){if(a.cancelable){var d=this,e=this.el,b=this.options,k=b.preventOnFilter,h=a.type,q=a.touches&&a.touches[0]||a.pointerType&&"touch"===a.pointerType&&a,g=(q||a).target,f=a.target.shadowRoot&&(a.path&&a.path[0]||a.composedPath&&a.composedPath()[0])||
g,n=b.filter;cb(e);if(!(u||/mousedown|pointerdown/.test(h)&&0!==a.button||b.disabled||f.isContentEditable||(g=T(g,b.draggable,e,!1),g&&g.animated||Wa===g))){xa=t(g);Fa=t(g,b.draggable);if("function"===typeof n){if(n.call(this,a,g,this)){K({sortable:d,rootEl:f,name:"filter",targetEl:g,toEl:e,fromEl:e});ca("filter",d,{evt:a});k&&a.cancelable&&a.preventDefault();return}}else if(n&&(n=n.split(",").some(function(b){if(b=T(f,b.trim(),e,!1))return K({sortable:d,rootEl:b,name:"filter",targetEl:g,fromEl:e,
toEl:e}),ca("filter",d,{evt:a}),!0}))){k&&a.cancelable&&a.preventDefault();return}b.handle&&!T(f,b.handle,e,!1)||this._prepareDragStart(a,q,g)}}},_prepareDragStart:function(a,d,e){var b=this,k=b.el,h=b.options,q=k.ownerDocument;if(e&&!u&&e.parentNode===k){var g=E(e);S=k;u=e;W=u.parentNode;sa=u.nextSibling;Wa=e;Xa=h.group;z.dragged=u;ta={target:u,clientX:(d||a).clientX,clientY:(d||a).clientY};vb=ta.clientX-g.left;wb=ta.clientY-g.top;this._lastX=(d||a).clientX;this._lastY=(d||a).clientY;u.style["will-change"]=
"all";e=function(){ca("delayEnded",b,{evt:a});z.eventCanceled?b._onDrop():(b._disableDelayedDragEvents(),!sb&&b.nativeDraggable&&(u.draggable=!0),b._triggerDragStart(a,d),K({sortable:b,name:"choose",originalEvent:a}),y(u,h.chosenClass,!0))};h.ignore.split(",").forEach(function(a){c(u,a.trim(),ya)});r(q,"dragover",ua);r(q,"mousemove",ua);r(q,"touchmove",ua);r(q,"mouseup",b._onDrop);r(q,"touchend",b._onDrop);r(q,"touchcancel",b._onDrop);sb&&this.nativeDraggable&&(this.options.touchStartThreshold=4,
u.draggable=!0);ca("delayStart",this,{evt:a});!h.delay||h.delayOnTouchOnly&&!d||this.nativeDraggable&&(R||O)?e():z.eventCanceled?this._onDrop():(r(q,"mouseup",b._disableDelayedDrag),r(q,"touchend",b._disableDelayedDrag),r(q,"touchcancel",b._disableDelayedDrag),r(q,"mousemove",b._delayedDragTouchMoveHandler),r(q,"touchmove",b._delayedDragTouchMoveHandler),h.supportPointer&&r(q,"pointermove",b._delayedDragTouchMoveHandler),b._dragStartTimer=setTimeout(e,h.delay))}},_delayedDragTouchMoveHandler:function(a){a=
a.touches?a.touches[0]:a;Math.max(Math.abs(a.clientX-this._lastX),Math.abs(a.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){u&&ya(u);clearTimeout(this._dragStartTimer);this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var a=this.el.ownerDocument;p(a,"mouseup",this._disableDelayedDrag);p(a,"touchend",this._disableDelayedDrag);p(a,"touchcancel",this._disableDelayedDrag);
p(a,"mousemove",this._delayedDragTouchMoveHandler);p(a,"touchmove",this._delayedDragTouchMoveHandler);p(a,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(a,d){d=d||"touch"==a.pointerType&&a;!this.nativeDraggable||d?this.options.supportPointer?r(document,"pointermove",this._onTouchMove):d?r(document,"touchmove",this._onTouchMove):r(document,"mousemove",this._onTouchMove):(r(u,"dragend",this),r(S,"dragstart",this._onDragStart));try{document.selection?ia(function(){document.selection.empty()}):
window.getSelection().removeAllRanges()}catch(e){}},_dragStarted:function(a,d){Aa=!1;if(S&&u){ca("dragStarted",this,{evt:d});this.nativeDraggable&&r(document,"dragover",Eb);var e=this.options;!a&&y(u,e.dragClass,!1);y(u,e.ghostClass,!0);z.active=this;a&&this._appendGhost();K({sortable:this,name:"start",originalEvent:d})}else this._nulling()},_emulateDragOver:function(){if(la){this._lastX=la.clientX;this._lastY=la.clientY;tb();for(var a=document.elementFromPoint(la.clientX,la.clientY),d=a;a&&a.shadowRoot;){a=
a.shadowRoot.elementFromPoint(la.clientX,la.clientY);if(a===d)break;d=a}u.parentNode[Z]._isOutsideThisEl(a);if(d){do{if(d[Z]){var e=void 0;if((e=d[Z]._onDragOver({clientX:la.clientX,clientY:la.clientY,target:a,rootEl:d}))&&!this.options.dragoverBubble)break}a=d}while(d=d.parentNode)}ub()}},_onTouchMove:function(a){if(ta){var d=this.options,e=d.fallbackTolerance,b=d.fallbackOffset,d=a.touches?a.touches[0]:a,k=D&&I(D),h=D&&k&&k.a,q=D&&k&&k.d,g=Ka&&aa&&na(aa),h=(d.clientX-ta.clientX+b.x)/(h||1)+(g?g[0]-
ib[0]:0)/(h||1),b=(d.clientY-ta.clientY+b.y)/(q||1)+(g?g[1]-ib[1]:0)/(q||1);if(!z.active&&!Aa){if(e&&Math.max(Math.abs(d.clientX-this._lastX),Math.abs(d.clientY-this._lastY))<e)return;this._onDragStart(a,!0)}D&&(k?(k.e+=h-(gb||0),k.f+=b-(hb||0)):k={a:1,b:0,c:0,d:1,e:h,f:b},e="matrix(".concat(k.a,",").concat(k.b,",").concat(k.c,",").concat(k.d,",").concat(k.e,",").concat(k.f,")"),l(D,"webkitTransform",e),l(D,"mozTransform",e),l(D,"msTransform",e),l(D,"transform",e),gb=h,hb=b,la=d);a.cancelable&&a.preventDefault()}},
_appendGhost:function(){if(!D){var a=this.options.fallbackOnBody?document.body:S,d=E(u,!0,Ka,!0,a),e=this.options;if(Ka){for(aa=a;"static"===l(aa,"position")&&"none"===l(aa,"transform")&&aa!==document;)aa=aa.parentNode;aa!==document.body&&aa!==document.documentElement?(aa===document&&(aa=g()),d.top+=aa.scrollTop,d.left+=aa.scrollLeft):aa=g();ib=na(aa)}D=u.cloneNode(!0);y(D,e.ghostClass,!1);y(D,e.fallbackClass,!0);y(D,e.dragClass,!0);l(D,"transition","");l(D,"transform","");l(D,"box-sizing","border-box");
l(D,"margin",0);l(D,"top",d.top);l(D,"left",d.left);l(D,"width",d.width);l(D,"height",d.height);l(D,"opacity","0.8");l(D,"position",Ka?"absolute":"fixed");l(D,"zIndex","100000");l(D,"pointerEvents","none");z.ghost=D;a.appendChild(D);l(D,"transform-origin",vb/parseInt(D.style.width)*100+"% "+wb/parseInt(D.style.height)*100+"%")}},_onDragStart:function(a,d){var e=this,k=a.dataTransfer,h=e.options;ca("dragStart",this,{evt:a});z.eventCanceled?this._onDrop():(ca("setupClone",this),z.eventCanceled||(U=
b(u),U.draggable=!1,U.style["will-change"]="",this._hideClone(),y(U,this.options.chosenClass,!1),z.clone=U),e.cloneId=ia(function(){ca("clone",e);z.eventCanceled||(e.options.removeCloneOnHide||S.insertBefore(U,u),e._hideClone(),K({sortable:e,name:"clone"}))}),!d&&y(u,h.dragClass,!0),d?(Ya=!0,e._loopId=setInterval(e._emulateDragOver,50)):(p(document,"mouseup",e._onDrop),p(document,"touchend",e._onDrop),p(document,"touchcancel",e._onDrop),k&&(k.effectAllowed="move",h.setData&&h.setData.call(e,k,u)),
r(document,"drop",e),l(u,"transform","translateZ(0)")),Aa=!0,e._dragStartId=ia(e._dragStarted.bind(e,d,a)),r(document,"selectstart",e),Ma=!0,eb&&l(document.body,"user-select","none"))},_onDragOver:function(a){function d(d,e){ca(d,G,L({evt:a,isOwner:X,axis:r?"vertical":"horizontal",revert:n,dragRect:g,targetRect:f,canSort:O,fromSortable:p,target:q,completed:b,onMove:function(d,e){return Ga(S,h,u,g,d,E(d),a,e)},changed:k},e))}function e(){d("dragOverAnimationCapture");G.captureAnimationState();G!==
p&&p.captureAnimationState()}function b(e){d("dragOverCompleted",{insertion:e});e&&(X?J._hideClone():J._showClone(G),G!==p&&(y(u,Y?Y.options.ghostClass:J.options.ghostClass,!1),y(u,c.ghostClass,!0)),Y!==G&&G!==z.active?Y=G:G===z.active&&Y&&(Y=null),p===G&&(G._ignoreWhileAnimating=q),G.animateAll(function(){d("dragOverAnimationComplete");G._ignoreWhileAnimating=null}),G!==p&&(p.animateAll(),p._ignoreWhileAnimating=null));if(q===u&&!u.animated||q===h&&!q.animated)Ba=null;c.dragoverBubble||a.rootEl||
q===document||(u.parentNode[Z]._isOutsideThisEl(a.target),!e&&ua(a));!c.dragoverBubble&&a.stopPropagation&&a.stopPropagation();return x=!0}function k(){da=t(u);oa=t(u,c.draggable);K({sortable:G,name:"change",toEl:h,newIndex:da,newDraggableIndex:oa,originalEvent:a})}var h=this.el,q=a.target,g,f,n,c=this.options,C=c.group,J=z.active,X=Xa===C,O=c.sort,p=Y||J,r,G=this,x=!1;if(!bb){void 0!==a.preventDefault&&a.cancelable&&a.preventDefault();q=T(q,c.draggable,h,!0);d("dragOver");if(z.eventCanceled)return x;
if(u.contains(a.target)||q.animated&&q.animatingX&&q.animatingY||G._ignoreWhileAnimating===q)return b(!1);Ya=!1;if(J&&!c.disabled&&(X?O||(n=!S.contains(u)):Y===this||(this.lastPutMode=Xa.checkPull(this,J,u,a))&&C.checkPut(this,J,u,a))){r="vertical"===this._getDirection(a,q);g=E(u);d("dragOverValid");if(z.eventCanceled)return x;if(n)return W=S,e(),this._hideClone(),d("revert"),z.eventCanceled||(sa?S.insertBefore(u,sa):S.appendChild(u)),b(!0);C=ba(h,c.draggable);if(!C||ha(a,r,this)&&!C.animated){if(C===
u)return b(!1);C&&h===a.target&&(q=C);q&&(f=E(q));if(!1!==Ga(S,h,u,g,q,f,a,!!q))return e(),h.appendChild(u),W=h,k(),b(!0)}else if(q.parentNode===h){f=E(q);var P=0,v,P=u.parentNode!==h,R=!Cb(u.animated&&u.toRect||g,q.animated&&q.toRect||f,r),C=r?"top":"left",A=ka(q,"top","top")||ka(u,"top","top"),qa=A?A.scrollTop:void 0;Ba!==q&&(v=f[C],Ia=!1,Za=!R&&c.invertSwap||P);var P=ra(a,q,f,r,R?1:c.swapThreshold,null==c.invertedSwapThreshold?c.swapThreshold:c.invertedSwapThreshold,Za,Ba===q),I;if(0!==P){R=t(u);
do R-=P,I=W.children[R];while(I&&("none"===l(I,"display")||I===D))}if(0===P||I===q)return b(!1);Ba=q;Ja=P;I=q.nextElementSibling;R=!1;R=1===P;P=Ga(S,h,u,g,q,f,a,R);if(!1!==P){if(1===P||-1===P)R=1===P;bb=!0;setTimeout(Ha,30);e();R&&!I?h.appendChild(u):q.parentNode.insertBefore(u,R?I:q);A&&w(A,0,qa-A.scrollTop);W=u.parentNode;void 0===v||Za||(Ta=Math.abs(v-E(q)[C]));k();return b(!0)}}if(h.contains(u))return b(!1)}return!1}},_ignoreWhileAnimating:null,_offMoveEvents:function(){p(document,"mousemove",
this._onTouchMove);p(document,"touchmove",this._onTouchMove);p(document,"pointermove",this._onTouchMove);p(document,"dragover",ua);p(document,"mousemove",ua);p(document,"touchmove",ua)},_offUpEvents:function(){var a=this.el.ownerDocument;p(a,"mouseup",this._onDrop);p(a,"touchend",this._onDrop);p(a,"pointerup",this._onDrop);p(a,"touchcancel",this._onDrop);p(document,"selectstart",this)},_onDrop:function(a){var d=this.el,e=this.options;da=t(u);oa=t(u,e.draggable);ca("drop",this,{evt:a});W=u&&u.parentNode;
da=t(u);oa=t(u,e.draggable);if(!z.eventCanceled&&(Ia=Za=Aa=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),clearTimeout(this.cloneId),clearTimeout(this._dragStartId),this.nativeDraggable&&(p(document,"drop",this),p(d,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),eb&&l(document.body,"user-select",""),a&&(Ma&&(a.cancelable&&a.preventDefault(),!e.dropBubble&&a.stopPropagation()),D&&D.parentNode&&D.parentNode.removeChild(D),(S===W||Y&&"clone"!==Y.lastPutMode)&&
U&&U.parentNode&&U.parentNode.removeChild(U),u&&(this.nativeDraggable&&p(u,"dragend",this),ya(u),u.style["will-change"]="",Ma&&!Aa&&y(u,Y?Y.options.ghostClass:this.options.ghostClass,!1),y(u,this.options.chosenClass,!1),K({sortable:this,name:"unchoose",toEl:W,newIndex:null,newDraggableIndex:null,originalEvent:a}),S!==W?(0<=da&&(K({rootEl:W,name:"add",toEl:W,fromEl:S,originalEvent:a}),K({sortable:this,name:"remove",toEl:W,originalEvent:a}),K({rootEl:W,name:"sort",toEl:W,fromEl:S,originalEvent:a}),
K({sortable:this,name:"sort",toEl:W,originalEvent:a})),Y&&Y.save()):da!==xa&&0<=da&&(K({sortable:this,name:"update",toEl:W,originalEvent:a}),K({sortable:this,name:"sort",toEl:W,originalEvent:a})),z.active)))){if(null==da||-1===da)da=xa,oa=Fa;K({sortable:this,name:"end",toEl:W,originalEvent:a});this.save()}this._nulling()},_nulling:function(){ca("nulling",this);S=u=W=D=sa=U=Wa=pa=ta=la=Ma=da=oa=xa=Fa=Ba=Ja=Y=Xa=z.dragged=z.ghost=z.clone=z.active=null;Ua.forEach(function(a){a.checked=!0});Ua.length=
gb=hb=0},handleEvent:function(a){switch(a.type){case "drop":case "dragend":this._onDrop(a);break;case "dragenter":case "dragover":u&&(this._onDragOver(a),a.dataTransfer&&(a.dataTransfer.dropEffect="move"),a.cancelable&&a.preventDefault());break;case "selectstart":a.preventDefault()}},toArray:function(){for(var a=[],d,e=this.el.children,b=0,k=e.length,h=this.options;b<k;b++)d=e[b],T(d,h.draggable,this.el,!1)&&a.push(d.getAttribute(h.dataIdAttr)||za(d));return a},sort:function(a){var d={},e=this.el;
this.toArray().forEach(function(a,b){b=e.children[b];T(b,this.options.draggable,e,!1)&&(d[a]=b)},this);a.forEach(function(a){d[a]&&(e.removeChild(d[a]),e.appendChild(d[a]))})},save:function(){var a=this.options.store;a&&a.set&&a.set(this)},closest:function(a,d){return T(a,d||this.options.draggable,this.el,!1)},option:function(a,d){var e=this.options;if(void 0===d)return e[a];var b=Ea.modifyOption(this,a,d);e[a]="undefined"!==typeof b?b:d;"group"===a&&rb(e)},destroy:function(){ca("destroy",this);var a=
this.el;a[Z]=null;p(a,"mousedown",this._onTapStart);p(a,"touchstart",this._onTapStart);p(a,"pointerdown",this._onTapStart);this.nativeDraggable&&(p(a,"dragover",this),p(a,"dragenter",this));Array.prototype.forEach.call(a.querySelectorAll("[draggable]"),function(a){a.removeAttribute("draggable")});this._onDrop();Sa.splice(Sa.indexOf(this.el),1);this.el=a=null},_hideClone:function(){pa||(ca("hideClone",this),z.eventCanceled||(l(U,"display","none"),this.options.removeCloneOnHide&&U.parentNode&&U.parentNode.removeChild(U),
pa=!0))},_showClone:function(a){"clone"!==a.lastPutMode?this._hideClone():pa&&(ca("showClone",this),z.eventCanceled||(S.contains(u)&&!this.options.group.revertClone?S.insertBefore(U,u):sa?S.insertBefore(U,sa):S.appendChild(U),this.options.group.revertClone&&this.animate(u,U),l(U,"display",""),pa=!1))}};r(document,"touchmove",function(a){(z.active||Aa)&&a.cancelable&&a.preventDefault()});z.utils={on:r,off:p,css:l,find:c,is:function(a,d){return!!T(a,d,a,!1)},extend:function(a,d){if(a&&d)for(var e in d)d.hasOwnProperty(e)&&
(a[e]=d[e]);return a},throttle:Ra,closest:T,toggleClass:y,clone:b,index:t,nextTick:ia,cancelNextTick:function(a){return clearTimeout(a)},detectDirection:qb,getChild:ga};z.get=function(a){return a[Z]};z.mount=function(){for(var a=arguments.length,d=Array(a),e=0;e<a;e++)d[e]=arguments[e];d[0].constructor===Array&&(d=d[0]);d.forEach(function(a){if(!a.prototype||!a.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(a));a.utils&&(z.utils=
L({},z.utils,a.utils));Ea.mount(a)})};z.create=function(a,d){return new z(a,d)};z.version="1.10.0";var V=[],Na,jb,kb=!1,lb,mb,$a,Ca,nb=Ra(function(a,d,e,b){if(d.scroll){var k=(a.touches?a.touches[0]:a).clientX,h=(a.touches?a.touches[0]:a).clientY,q=d.scrollSensitivity,m=d.scrollSpeed,f=g(),n=!1,c;jb!==e&&(jb=e,Va(),Na=d.scroll,c=d.scrollFn,!0===Na&&(Na=x(e,!0)));e=0;var C=Na;do{var J=C,G=E(J),X=G.top,O=G.bottom,p=G.left,u=G.right,P=G.width,G=G.height,r=void 0,t=void 0,R=J.scrollWidth,v=J.scrollHeight,
t=l(J),K=J.scrollLeft,I=J.scrollTop;J===f?(r=P<R&&("auto"===t.overflowX||"scroll"===t.overflowX||"visible"===t.overflowX),t=G<v&&("auto"===t.overflowY||"scroll"===t.overflowY||"visible"===t.overflowY)):(r=P<R&&("auto"===t.overflowX||"scroll"===t.overflowX),t=G<v&&("auto"===t.overflowY||"scroll"===t.overflowY));p=r&&(Math.abs(u-k)<=q&&K+P<R)-(Math.abs(p-k)<=q&&!!K);X=t&&(Math.abs(O-h)<=q&&I+G<v)-(Math.abs(X-h)<=q&&!!I);if(!V[e])for(O=0;O<=e;O++)V[O]||(V[O]={});if(V[e].vx!=p||V[e].vy!=X||V[e].el!==
J)if(V[e].el=J,V[e].vx=p,V[e].vy=X,clearInterval(V[e].pid),0!=p||0!=X)n=!0,V[e].pid=setInterval(function(){b&&0===this.layer&&z.active._onTouchMove($a);var d=V[this.layer].vy?V[this.layer].vy*m:0,e=V[this.layer].vx?V[this.layer].vx*m:0;"function"===typeof c&&"continue"!==c.call(z.dragged.parentNode[Z],e,d,a,$a,V[this.layer].el)||w(V[this.layer].el,e,d)}.bind({layer:e}),24);e++}while(d.bubbleScroll&&C!==f&&(C=x(C,!1)));kb=n}},30),zb=function(a){var d=a.originalEvent,e=a.putSortable,b=a.dragEl,k=a.activeSortable,
h=a.dispatchSortableEvent,q=a.hideGhostForTarget;a=a.unhideGhostForTarget;k=e||k;q();d=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:d;d=document.elementFromPoint(d.clientX,d.clientY);a();k&&!k.el.contains(d)&&(h("spill"),this.onSpill({dragEl:b,putSortable:e}))};n.prototype={startIndex:null,dragStart:function(a){this.startIndex=a.oldDraggableIndex},onSpill:function(a){var d=a.dragEl;a=a.putSortable;this.sortable.captureAnimationState();a&&a.captureAnimationState();var e=ga(this.sortable.el,
this.startIndex,this.options);e?this.sortable.el.insertBefore(d,e):this.sortable.el.appendChild(d);this.sortable.animateAll();a&&a.animateAll()},drop:zb};F(n,{pluginName:"revertOnSpill"});db.prototype={onSpill:function(a){var d=a.dragEl;a=a.putSortable||this.sortable;a.captureAnimationState();d.parentNode&&d.parentNode.removeChild(d);a.animateAll()},drop:zb};F(db,{pluginName:"removeOnSpill"});var ja,A=[],ea=[],Oa,ma,Pa=!1,fa=!1,Qa=!1,Q,va,ab;z.mount(new function(){function a(){this.defaults={scroll:!0,
scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var a in this)"_"===a.charAt(0)&&"function"===typeof this[a]&&(this[a]=this[a].bind(this))}a.prototype={dragStarted:function(a){a=a.originalEvent;this.sortable.nativeDraggable?r(document,"dragover",this._handleAutoScroll):this.options.supportPointer?r(document,"pointermove",this._handleFallbackAutoScroll):a.touches?r(document,"touchmove",this._handleFallbackAutoScroll):r(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(a){a=
a.originalEvent;this.options.dragOverBubble||a.rootEl||this._handleAutoScroll(a)},drop:function(){this.sortable.nativeDraggable?p(document,"dragover",this._handleAutoScroll):(p(document,"pointermove",this._handleFallbackAutoScroll),p(document,"touchmove",this._handleFallbackAutoScroll),p(document,"mousemove",this._handleFallbackAutoScroll));clearInterval(Ca);Va();clearTimeout(Da);Da=void 0},nulling:function(){$a=jb=Na=kb=Ca=lb=mb=null;V.length=0},_handleFallbackAutoScroll:function(a){this._handleAutoScroll(a,
!0)},_handleAutoScroll:function(a,e){var d=this,b=(a.touches?a.touches[0]:a).clientX,k=(a.touches?a.touches[0]:a).clientY,h=document.elementFromPoint(b,k);$a=a;if(e||R||O||eb){nb(a,this.options,h,e);var q=x(h,!0);!kb||Ca&&b===lb&&k===mb||(Ca&&clearInterval(Ca),Ca=setInterval(function(){var h=x(document.elementFromPoint(b,k),!0);h!==q&&(q=h,Va());nb(a,d.options,h,e)},10),lb=b,mb=k)}else this.options.bubbleScroll&&x(h,!0)!==g()?nb(a,this.options,x(h,!1),!1):Va()}};return F(a,{pluginName:"scroll",initializeByDefault:!0})});
z.mount(db,n);z.mount(new function(){function a(){this.defaults={swapClass:"sortable-swap-highlight"}}a.prototype={dragStart:function(a){ja=a.dragEl},dragOverValid:function(a){var d=a.completed,b=a.target,k=a.onMove,h=a.changed,q=a.cancel;if(a.activeSortable.options.swap){var g=this.sortable.el;a=this.options;b&&b!==g&&(g=ja,!1!==k(b)?(y(b,a.swapClass,!0),ja=b):ja=null,g&&g!==ja&&y(g,a.swapClass,!1));h();d(!0);q()}},drop:function(a){var d=a.activeSortable,b=a.putSortable;a=a.dragEl;var k=b||this.sortable,
h=this.options;ja&&y(ja,h.swapClass,!1);if(ja&&(h.swap||b&&b.options.swap)&&a!==ja){k.captureAnimationState();k!==d&&d.captureAnimationState();var b=ja,h=a.parentNode,q=b.parentNode,g,f;h&&q&&!h.isEqualNode(b)&&!q.isEqualNode(a)&&(g=t(a),f=t(b),h.isEqualNode(q)&&g<f&&f++,h.insertBefore(b,h.children[g]),q.insertBefore(a,q.children[f]));k.animateAll();k!==d&&d.animateAll()}},nulling:function(){ja=null}};return F(a,{pluginName:"swap",eventProperties:function(){return{swapItem:ja}}})});z.mount(new function(){function a(a){for(var d in this)"_"===
d.charAt(0)&&"function"===typeof this[d]&&(this[d]=this[d].bind(this));a.options.supportPointer?r(document,"pointerup",this._deselectMultiDrag):(r(document,"mouseup",this._deselectMultiDrag),r(document,"touchend",this._deselectMultiDrag));r(document,"keydown",this._checkKeyDown);r(document,"keyup",this._checkKeyUp);this.defaults={selectedClass:"sortable-selected",multiDragKey:null,setData:function(d,b){var e="";A.length&&ma===a?A.forEach(function(a,d){e+=(d?", ":"")+a.textContent}):e=b.textContent;
d.setData("Text",e)}}}a.prototype={multiDragKeyDown:!1,isMultiDrag:!1,delayStartGlobal:function(a){Q=a.dragEl},delayEnded:function(){this.isMultiDrag=~A.indexOf(Q)},setupClone:function(a){var d=a.sortable;a=a.cancel;if(this.isMultiDrag){for(var k=0;k<A.length;k++)ea.push(b(A[k])),ea[k].sortableIndex=A[k].sortableIndex,ea[k].draggable=!1,ea[k].style["will-change"]="",y(ea[k],this.options.selectedClass,!1),A[k]===Q&&y(ea[k],this.options.chosenClass,!1);d._hideClone();a()}},clone:function(a){var d=a.sortable,
b=a.rootEl,k=a.dispatchSortableEvent;a=a.cancel;this.isMultiDrag&&!this.options.removeCloneOnHide&&A.length&&ma===d&&(q(!0,b),k("clone"),a())},showClone:function(a){var d=a.cloneNowShown,b=a.cancel;this.isMultiDrag&&(q(!1,a.rootEl),ea.forEach(function(a){l(a,"display","")}),d(),ab=!1,b())},hideClone:function(a){var d=this,b=a.cloneNowHidden;a=a.cancel;this.isMultiDrag&&(ea.forEach(function(a){l(a,"display","none");d.options.removeCloneOnHide&&a.parentNode&&a.parentNode.removeChild(a)}),b(),ab=!0,
a())},dragStartGlobal:function(a){!this.isMultiDrag&&ma&&ma.multiDrag._deselectMultiDrag();A.forEach(function(a){a.sortableIndex=t(a)});A=A.sort(function(a,d){return a.sortableIndex-d.sortableIndex});Qa=!0},dragStarted:function(a){var d=this;a=a.sortable;if(this.isMultiDrag){if(this.options.sort&&(a.captureAnimationState(),this.options.animation)){A.forEach(function(a){a!==Q&&l(a,"position","absolute")});var b=E(Q,!1,!0,!0);A.forEach(function(a){a!==Q&&h(a,b)});Pa=fa=!0}a.animateAll(function(){Pa=
fa=!1;d.options.animation&&A.forEach(function(a){X(a)});d.options.sort&&P()})}},dragOver:function(a){var d=a.target,b=a.completed;a=a.cancel;fa&&~A.indexOf(d)&&(b(!1),a())},revert:function(a){var d=a.fromSortable,b=a.rootEl,h=a.sortable,q=a.dragRect;1<A.length&&(A.forEach(function(a){h.addAnimationState({target:a,rect:fa?E(a):q});X(a);a.fromRect=q;d.removeAnimationState(a)}),fa=!1,k(!this.options.removeCloneOnHide,b))},dragOverCompleted:function(a){var d=a.sortable,b=a.isOwner,k=a.activeSortable,
q=a.parentEl,g=a.putSortable,f=this.options;if(a.insertion){b&&k._hideClone();Pa=!1;if(f.animation&&1<A.length&&(fa||!b&&!k.options.sort&&!g)){var n=E(Q,!1,!0,!0);A.forEach(function(a){a!==Q&&(h(a,n),q.appendChild(a))});fa=!0}b||(fa||P(),1<A.length?(a=ab,k._showClone(d),k.options.animation&&!ab&&a&&ea.forEach(function(a){k.addAnimationState({target:a,rect:va});a.fromRect=va;a.thisAnimationDuration=null})):k._showClone(d))}},dragOverAnimationCapture:function(a){var d=a.dragRect,b=a.isOwner;a=a.activeSortable;
A.forEach(function(a){a.thisAnimationDuration=null});a.options.animation&&!b&&a.multiDrag.isMultiDrag&&(va=F({},d),d=I(Q,!0),va.top-=d.f,va.left-=d.e)},dragOverAnimationComplete:function(){fa&&(fa=!1,P())},drop:function(a){var d=a.originalEvent,b=a.rootEl,k=a.parentEl,h=a.sortable,q=a.dispatchSortableEvent,g=a.oldIndex,f=(a=a.putSortable)||this.sortable;if(d){var n=this.options,c=k.children;if(!Qa)if(n.multiDragKey&&!this.multiDragKeyDown&&this._deselectMultiDrag(),y(Q,n.selectedClass,!~A.indexOf(Q)),
~A.indexOf(Q))A.splice(A.indexOf(Q),1),Oa=null,J({sortable:h,rootEl:b,name:"deselect",targetEl:Q,originalEvt:d});else{A.push(Q);J({sortable:h,rootEl:b,name:"select",targetEl:Q,originalEvt:d});if(d.shiftKey&&Oa&&h.el.contains(Oa)){var C=t(Oa),G=t(Q);if(~C&&~G&&C!==G){var l;G>C?(l=C,C=G):(l=G,C+=1);for(;l<C;l++)~A.indexOf(c[l])||(y(c[l],n.selectedClass,!0),A.push(c[l]),J({sortable:h,rootEl:b,name:"select",targetEl:c[l],originalEvt:d}))}}else Oa=Q;ma=f}if(Qa&&this.isMultiDrag){if((k[Z].options.sort||
k!==b)&&1<A.length){var O=E(Q),p=t(Q,":not(."+this.options.selectedClass+")");!Pa&&n.animation&&(Q.thisAnimationDuration=null);f.captureAnimationState();if(!Pa&&(n.animation&&(Q.fromRect=O,A.forEach(function(a){a.thisAnimationDuration=null;if(a!==Q){var d=fa?E(a):O;a.fromRect=d;f.addAnimationState({target:a,rect:d})}})),P(),A.forEach(function(a){c[p]?k.insertBefore(a,c[p]):k.appendChild(a);p++}),g===t(Q))){var u=!1;A.forEach(function(a){a.sortableIndex!==t(a)&&(u=!0)});u&&q("update")}A.forEach(function(a){X(a)});
f.animateAll()}ma=f}(b===k||a&&"clone"!==a.lastPutMode)&&ea.forEach(function(a){a.parentNode&&a.parentNode.removeChild(a)})}},nullingGlobal:function(){this.isMultiDrag=Qa=!1;ea.length=0},destroyGlobal:function(){this._deselectMultiDrag();p(document,"pointerup",this._deselectMultiDrag);p(document,"mouseup",this._deselectMultiDrag);p(document,"touchend",this._deselectMultiDrag);p(document,"keydown",this._checkKeyDown);p(document,"keyup",this._checkKeyUp)},_deselectMultiDrag:function(a){if(!(Qa||ma!==
this.sortable||a&&T(a.target,this.options.draggable,this.sortable.el,!1)||a&&0!==a.button))for(;A.length;){var d=A[0];y(d,this.options.selectedClass,!1);A.shift();J({sortable:this.sortable,rootEl:this.sortable.el,name:"deselect",targetEl:d,originalEvt:a})}},_checkKeyDown:function(a){a.key===this.options.multiDragKey&&(this.multiDragKeyDown=!0)},_checkKeyUp:function(a){a.key===this.options.multiDragKey&&(this.multiDragKeyDown=!1)}};return F(a,{pluginName:"multiDrag",utils:{select:function(a){var d=
a.parentNode[Z];d&&d.options.multiDrag&&!~A.indexOf(a)&&(ma&&ma!==d&&(ma.multiDrag._deselectMultiDrag(),ma=d),y(a,d.options.selectedClass,!0),A.push(a))},deselect:function(a){var d=a.parentNode[Z],b=A.indexOf(a);d&&d.options.multiDrag&&~b&&(y(a,d.options.selectedClass,!1),A.splice(b,1))}},eventProperties:function(){var a=this,b=[],k=[];A.forEach(function(d){b.push({multiDragElement:d,index:d.sortableIndex});var e;e=fa&&d!==Q?-1:fa?t(d,":not(."+a.options.selectedClass+")"):t(d);k.push({multiDragElement:d,
index:e})});return{items:N(A),clones:[].concat(ea),oldIndicies:b,newIndicies:k}},optionListeners:{multiDragKey:function(a){a=a.toLowerCase();"ctrl"===a?a="Control":1<a.length&&(a=a.charAt(0).toUpperCase()+a.substr(1));return a}}})});return z})},"esri/widgets/LayerList/LayerListViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Collection ../../core/Evented ../../core/Handles ../../core/watchUtils ../../core/accessorSupport/decorators ./ListItem ./support/layerListUtils".split(" "),
function(M,F,L,f,N,v,r,p,H,T,y){var l=N.ofType(T);return function(v){function c(g){g=v.call(this,g)||this;g._handles=new r;g.listItemCreatedFunction=null;g.operationalItems=new l;g.view=null;return g}L(c,v);c.prototype.initialize=function(){var g=this;this._handles.add(p.init(this,["view","view.ready"],function(){return g._viewHandles()}),"view")};c.prototype.destroy=function(){this._handles.destroy();this.view=this._handles=null;this.operationalItems.removeAll()};Object.defineProperty(c.prototype,
"state",{get:function(){var g=this.get("view");return this.get("view.ready")?"ready":g?"loading":"disabled"},enumerable:!0,configurable:!0});c.prototype.triggerAction=function(g,f){g&&this.emit("trigger-action",{action:g,item:f})};c.prototype._createLayerViewHandles=function(g){var f=this,c=this._handles;c.remove("layer-views");this._compileList();g&&c.add(g.on("change",function(){return f._compileList()}),"layer-views")};c.prototype._createMapLayerHandles=function(g){var f=this,c=this._handles;c.remove("map-layers");
this._compileList();g&&c.add(g.on("change",function(){return f._compileList()}),"map-layers")};c.prototype._watchItemProperties=function(g){var f=this;this._handles.add([g.children.on("change",function(){f._modifyListItemChildren(g.children)})],"children-change-"+g.uid)};c.prototype._modifyListItemChildren=function(g){var f=this;g.forEach(function(g){return f._modifyListItem(g)})};c.prototype._modifyListItem=function(g){"function"===typeof this.listItemCreatedFunction&&this.listItemCreatedFunction.call(null,
{item:g});this._modifyListItemChildren(g.children)};c.prototype._createListItem=function(g){g=new T({layer:g,view:this.view});this._watchItemProperties(g);return g};c.prototype._removeAllItems=function(){var g=this._handles,f=this.operationalItems;f.forEach(function(f){g.remove("children-change-"+f.uid)});f.removeAll()};c.prototype._getViewableLayers=function(g){if(g)return g.filter(function(g){return"hide"!==y.findLayerListMode(g)})};c.prototype._watchLayersListMode=function(g){var f=this,c=this._handles;
c.remove("layer-list-mode");g&&g.forEach(function(g){c.add(p.watch(g,"listMode",function(){return f._compileList()}),"layer-list-mode")})};c.prototype._compileList=function(){var g=this.get("view.map.layers");this._watchLayersListMode(g);(g=this._getViewableLayers(g))&&g.length?(this._createNewItems(g),this._modifyOrRemoveItems(g),this._sortItems(g)):this._removeAllItems()};c.prototype._createNewItems=function(g){var f=this,c=this.operationalItems;g.forEach(function(g){c.find(function(f){return f.layer===
g})||c.add(f._createListItem(g))})};c.prototype._modifyOrRemoveItems=function(g){var f=this,c=this._handles,l=this.operationalItems;l.forEach(function(p){p&&(g&&g.find(function(g){return p.layer===g})?f._modifyListItem(p):(c.remove("children-change-"+p.uid),l.remove(p)))})};c.prototype._sortItems=function(g){this.operationalItems.sort(function(f,c){f=g.indexOf(f.layer);c=g.indexOf(c.layer);return f>c?-1:f<c?1:0})};c.prototype._viewHandles=function(){var g=this,f=this._handles,c=this.view;f.remove(["map-layers",
"layer-views","view-layers"]);this._compileList();c&&c.ready&&f.add([p.init(this,"view.map.layers",function(f){return g._createMapLayerHandles(f)}),p.init(this,"view.layerViews",function(f){return g._createLayerViewHandles(f)}),p.init(this,"listItemCreatedFunction",function(){return g._compileList()})],"view-layers")};f([H.property()],c.prototype,"listItemCreatedFunction",void 0);f([H.property({type:l})],c.prototype,"operationalItems",void 0);f([H.property({dependsOn:["view.ready"],readOnly:!0})],
c.prototype,"state",null);f([H.property()],c.prototype,"view",void 0);return c=f([H.subclass("esri.widgets.LayerList.LayerListViewModel")],c)}(H.declared(v.EventedAccessor))})},"esri/widgets/LayerList/ListItem":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../core/Accessor ../../core/Collection ../../core/Handles ../../core/Identifiable ../../core/watchUtils ../../core/accessorSupport/decorators ../../layers/support/Sublayer ../../support/actions/ActionBase ../../support/actions/ActionButton ../../support/actions/ActionSlider ../../support/actions/ActionToggle ./ListItemPanel ./support/layerListUtils".split(" "),
function(M,F,L,f,N,v,r,p,H,T,y,l,I,c,g,E,ka,ga,ba){M=p.ofType({key:"type",defaultKeyValue:"button",base:c,typeMap:{button:g,toggle:ka,slider:E}});var t=p.ofType(M);return function(g){function c(c){c=g.call(this,c)||this;c._handles=new H;c.actionsSections=new t;c.actionsOpen=!1;c.children=new (p.ofType(r));c.error=null;c.layer=null;c.layerView=null;c.open=!1;c.panel=null;c.parent=null;c.view=null;c.visible=null;return c}L(c,g);r=c;c.prototype.initialize=function(){var c=this;this._handles.add([y.init(this,
"layer",function(g){return c._watchLayerProperties(g)}),y.init(this,"view",function(g){return c._updateChildren(g)}),y.init(this,"panel",function(g){return c._setListItemOnPanel(g)}),y.init(this,["layer","view"],function(){return c._getLayerView()})])};c.prototype.destroy=function(){this._handles.destroy();this.view=this._handles=null};c.prototype.castPanel=function(c){this.get("panel.open")&&!c.hasOwnProperty("open")&&(c.open=!0);return c?new ga(c):null};Object.defineProperty(c.prototype,"title",
{get:function(){var c=this.get("layer.layer");return(!c||c&&this.get("layer.layer.loaded"))&&this.get("layer.title")||""},set:function(c){void 0===c?this._clearOverride("title"):this._override("title",c)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"updating",{get:function(){var c=this.layerView;return c?c.updating:this._isLayerUpdating(this.layer)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"visibleAtCurrentScale",{get:function(){return!ba.isLayerOutsideScaleRange(this.layer,
this.get("view.scale"))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"visibilityMode",{get:function(){return ba.findLayerVisibilityMode(this.layer)},enumerable:!0,configurable:!0});c.prototype.clone=function(){return new r({actionsSections:this.actionsSections.clone(),actionsOpen:this.actionsOpen,children:this.children.clone(),layer:this.layer,open:this.open,panel:this.panel,title:this.title,view:this.view,visible:this.visible})};c.prototype._setListItemOnPanel=function(c){c&&
(c.listItem=this)};c.prototype._updateChildren=function(c){var g=this.children;g&&g.forEach(function(g){return g.view=c})};c.prototype._addChildren=function(c){var g=this;this.children.removeAll();if(c){this._handles.remove("child-list-mode");c.forEach(function(b){g._handles.add(y.watch(b,"listMode",function(){return g._addChildren(c)}),"child-list-mode")});var f=[];c.filter(function(b){return"hide"!==ba.findLayerListMode(b)}).forEach(function(b){ba.canDisplayLayer(b)&&(b=new r({layer:b,parent:g,
view:g.view}),f.unshift(b))});this.children.addMany(f)}};c.prototype._watchSublayerChanges=function(c){var g=this;c&&this._handles.add(c.on("change",function(){g._addChildren(c)}),"layer")};c.prototype._initializeChildLayers=function(c){this._addChildren(c);this._watchSublayerChanges(c)};c.prototype._watchLayerProperties=function(c){var g=this;if(this._handles&&(this._handles.remove("layer"),c))if(this._handles.add(y.watch(c,"listMode",function(){return g._watchLayerProperties(c)}),"layer"),"hide-children"===
ba.findLayerListMode(c))this.children.removeAll();else{var f=ba.getNormalizedChildLayerProperty(c);f&&this._handles.add(y.init(c,f,function(){c.hasOwnProperty(f)&&g._initializeChildLayers(c[f])}),"layer")}};c.prototype._getLayerView=function(){return v(this,void 0,void 0,function(){var c,g,f,b;return N(this,function(h){switch(h.label){case 0:c=this;g=c.layer;f=c.view;if(!g||!f)return[2];h.label=1;case 1:return h.trys.push([1,3,,4]),[4,f.whenLayerView(g)];case 2:b=h.sent();if(b.layer!==this.layer)return[2];
this._set("layerView",b);return[3,4];case 3:return h.sent(),[3,4];case 4:return[2]}})})};c.prototype._isLayerUpdating=function(c){return c instanceof I?!1:c&&"loading"===c.loadStatus};var r;f([l.property({type:t})],c.prototype,"actionsSections",void 0);f([l.property()],c.prototype,"actionsOpen",void 0);f([l.property({type:p})],c.prototype,"children",void 0);f([l.aliasOf("layer.loadError?")],c.prototype,"error",void 0);f([l.property()],c.prototype,"layer",void 0);f([l.property({readOnly:!0})],c.prototype,
"layerView",void 0);f([l.property()],c.prototype,"open",void 0);f([l.property({type:ga})],c.prototype,"panel",void 0);f([l.cast("panel")],c.prototype,"castPanel",null);f([l.property()],c.prototype,"parent",void 0);f([l.property({dependsOn:["layer.layer?.loaded","layer.title"]})],c.prototype,"title",null);f([l.property({dependsOn:["layer.loadStatus?","layerView.updating"],readOnly:!0})],c.prototype,"updating",null);f([l.property({value:null})],c.prototype,"view",void 0);f([l.aliasOf("layer.visible")],
c.prototype,"visible",void 0);f([l.property({dependsOn:["layer.minScale?","layer.maxScale?","view.scale"],readOnly:!0})],c.prototype,"visibleAtCurrentScale",null);f([l.property({dependsOn:["layer.visibilityMode?","layer.capabilities?.exportMap?.supportsSublayerVisibility","layer.layer?.capabilities?.exportMap?.supportsSublayerVisibility"],readOnly:!0})],c.prototype,"visibilityMode",null);return c=r=f([l.subclass("esri.widgets.LayerList.ListItem")],c)}(l.declared(T.IdentifiableMixin(r)))})},"esri/layers/support/Sublayer":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/paramHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../core/tsSupport/assignHelper ../../geometry ../../PopupTemplate ../../renderers ../../request ../../symbols ../../core/Collection ../../core/Error ../../core/HandleOwner ../../core/lang ../../core/Loadable ../../core/Logger ../../core/MultiOriginJSONSupport ../../core/promiseUtils ../../core/urlUtils ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType ../../core/accessorSupport/PropertyOrigin ../../core/accessorSupport/utils ./FeatureType ./Field ./FieldsIndex ./fieldUtils ./LabelClass ./layerSourceUtils ../../renderers/support/jsonUtils ../../support/popupUtils ../../tasks/support/Query".split(" "),
function(M,F,L,f,N,v,r,p,H,T,y,l,I,c,g,E,ka,ga,ba,t,na,qa,x,C,Ra,w,b,h,X,G,J,K,z,Ga,ya){function Ha(b){return b&&"esriSMS"===b.type}function ha(b,c,h){return{ignoreOrigin:!0,enabled:h&&h.writeSublayerStructure||!1}}function ra(b,c,h){return{ignoreOrigin:!0,enabled:h?h.writeSublayerStructure||this.originIdOf(c)>=Ra.nameToId(h.origin):!1}}var za=ba.getLogger("esri.layers.support.Sublayer"),cb=0,ia=new Set;ia.add("layer");ia.add("parent");ia.add("loaded");ia.add("loadStatus");ia.add("loadError");ia.add("loadWarnings");
return function(t){function n(b){b=t.call(this,b)||this;b.capabilities=void 0;b.fields=null;b.fullExtent=null;b.globalIdField=null;b.legendEnabled=!0;b.objectIdField=null;b.popupEnabled=!0;b.popupTemplate=null;b.sourceJSON=null;b.title=null;b.typeIdField=null;b.types=null;return b}L(n,t);E=n;n.prototype.load=function(b){return r(this,void 0,void 0,function(){var k=this;return v(this,function(c){this.addResolvingPromise(function(){return r(k,void 0,void 0,function(){var k,c,h;return v(this,function(q){switch(q.label){case 0:if(!this.layer)throw new g("sublayer:missing-layer",
"Sublayer can't be loaded without being part of a layer",{sublayer:this});k=null;return 2<this.originIdOf("url")||K.isDataLayerSource(this.source)?[4,l(this.url,p({responseType:"json",query:{f:"json"}},b))]:[3,2];case 1:return c=q.sent(),k=c.data,[3,4];case 2:return h=this.id,this.source&&null!=this.source.mapLayerId&&(h=this.source.mapLayerId),[4,this.layer.fetchSublayerInfo(h,b)];case 3:k=q.sent(),q.label=4;case 4:return k&&(this.sourceJSON=k,this.read({layerDefinition:k},{origin:"service"})),[2]}})})}());
return[2,this]})})};n.prototype.readCapabilities=function(b,c){return{exportMap:{supportsModification:!!c.layerDefinition.canModifyLayer}}};Object.defineProperty(n.prototype,"definitionExpression",{set:function(b){this._setAndNotifyLayer("definitionExpression",b)},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"fieldsIndex",{get:function(){return new X(this.fields||[])},enumerable:!0,configurable:!0});n.prototype.readGlobalIdFieldFromService=function(b,c){c=c.layerDefinition||c;
if(c.globalIdField)return c.globalIdField;if(c.fields)for(b=0,c=c.fields;b<c.length;b++){var k=c[b];if("esriFieldTypeGlobalID"===k.type)return k.name}};Object.defineProperty(n.prototype,"id",{get:function(){var b=this._get("id");return null==b?cb++:b},set:function(b){this._get("id")!==b&&(!1===this.get("layer.capabilities.exportMap.supportsDynamicLayers")?this._logLockedError("id","capability not available 'layer.capabilities.exportMap.supportsDynamicLayers'"):this._set("id",b))},enumerable:!0,configurable:!0});
Object.defineProperty(n.prototype,"labelingInfo",{set:function(b){this._setAndNotifyLayer("labelingInfo",b)},enumerable:!0,configurable:!0});n.prototype.writeLabelingInfo=function(b,c,h,g){b&&b.length&&(c.layerDefinition={drawingInfo:{labelingInfo:b.map(function(b){return b.write({},g)})}})};Object.defineProperty(n.prototype,"labelsVisible",{set:function(b){this._setAndNotifyLayer("labelsVisible",b)},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"layer",{set:function(b){this._set("layer",
b);this.sublayers&&this.sublayers.forEach(function(c){return c.layer=b})},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"listMode",{set:function(b){this._set("listMode",b)},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"minScale",{set:function(b){this._setAndNotifyLayer("minScale",b)},enumerable:!0,configurable:!0});n.prototype.readMinScale=function(b,c){return c.minScale||c.layerDefinition&&c.layerDefinition.minScale||0};Object.defineProperty(n.prototype,"maxScale",
{set:function(b){this._setAndNotifyLayer("maxScale",b)},enumerable:!0,configurable:!0});n.prototype.readMaxScale=function(b,c){return c.maxScale||c.layerDefinition&&c.layerDefinition.maxScale||0};n.prototype.readObjectIdFieldFromService=function(b,c){c=c.layerDefinition||c;if(c.objectIdField)return c.objectIdField;if(c.fields)for(b=0,c=c.fields;b<c.length;b++){var k=c[b];if("esriFieldTypeOID"===k.type)return k.name}};Object.defineProperty(n.prototype,"opacity",{set:function(b){this._setAndNotifyLayer("opacity",
b)},enumerable:!0,configurable:!0});n.prototype.readOpacity=function(b,c){b=c.layerDefinition;return 1-.01*(null!=b.transparency?b.transparency:b.drawingInfo.transparency)};n.prototype.writeOpacity=function(b,c,h,g){c.layerDefinition={drawingInfo:{transparency:100-100*b}}};n.prototype.writeParent=function(b,c){c.parentLayerId=this.parent&&this.parent!==this.layer?this.parent.id:-1};Object.defineProperty(n.prototype,"defaultPopupTemplate",{get:function(){return this.createPopupTemplate()},enumerable:!0,
configurable:!0});Object.defineProperty(n.prototype,"renderer",{set:function(b){if(b)for(var c=0,h=b.getSymbols();c<h.length;c++)if(I.isSymbol3D(h[c])){za.warn("Sublayer renderer should use 2D symbols");break}this._setAndNotifyLayer("renderer",b)},enumerable:!0,configurable:!0});n.prototype.readRenderer=function(b,c,h){if(b=c.layerDefinition.drawingInfo.renderer||void 0)(b=z.read(b,c,h)||void 0)||za.error("Failed to create renderer",{rendererDefinition:c.drawingInfo.renderer,layer:this,context:h});
return b};n.prototype.writeRenderer=function(b,c,h,g){c.layerDefinition={drawingInfo:{renderer:b.write({},g)}}};n.prototype.writeWebSceneRenderer=function(b,c,h,g){c.layerDefinition={drawingInfo:{renderer:b.write({},g)}}};Object.defineProperty(n.prototype,"source",{get:function(){return this._get("source")||{mapLayerId:this.id,type:K.MAPLAYER}},set:function(b){this._setAndNotifyLayer("source",b)},enumerable:!0,configurable:!0});n.prototype.writeSource=function(b,c){c.layerDefinition={source:K.sourceToJSON(b)}};
Object.defineProperty(n.prototype,"sublayers",{set:function(b){this._handleSublayersChange(b,this._get("sublayers"));this._set("sublayers",b)},enumerable:!0,configurable:!0});n.prototype.castSublayers=function(b){return C.default(c.ofType(E),b)};n.prototype.writeSublayers=function(b,c,h){this.get("sublayers.length")&&(c[h]=this.sublayers.map(function(b){return b.id}).toArray().reverse())};n.prototype.readTypeIdField=function(b,c){c=c.layerDefinition||c;if(b=c.typeIdField)if(c=G.getField(c.fields,
b))return c.name;return null};Object.defineProperty(n.prototype,"url",{get:function(){var b=this.layer,c=this.source;if(!b)return null;if(K.isMapLayerSource(c))return b.parsedUrl.path+"/"+c.mapLayerId;c={layer:JSON.stringify({source:K.sourceToJSON(this.source)})};return b.parsedUrl.path+"/dynamicLayer?"+qa.objectToQuery(c)},set:function(b){b?this._override("url",b):this._clearOverride("url")},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"visible",{set:function(b){this._setAndNotifyLayer("visible",
b)},enumerable:!0,configurable:!0});n.prototype.writeVisible=function(b,c,h,g){c[h]=this.getAtOrigin("defaultVisibility","service")||b};n.prototype.clone=function(){var b=w.getProperties(this).store,c=new E;w.getProperties(c).store=b.clone(ia);return c};n.prototype.createPopupTemplate=function(b){return Ga.createPopupTemplate(this,b)};n.prototype.createQuery=function(){return new ya({returnGeometry:!0,where:this.definitionExpression||"1\x3d1"})};n.prototype.createFeatureLayer=function(){return r(this,
void 0,void 0,function(){var b,c,h,g,f;return v(this,function(k){switch(k.label){case 0:if(this.hasOwnProperty("sublayers"))return[2,null];b=this.layer&&this.layer.parsedUrl;c=this.source;h=null;b&&(h=K.isMapLayerSource(c)?b.path+"/"+c.mapLayerId:b.path+"/dynamicLayer");return[4,na.create(function(b){return M(["../FeatureLayer"],b)})];case 1:return g=k.sent(),f=new g({url:h}),this.definitionExpression&&(f.definitionExpression=this.definitionExpression),2<this.originIdOf("labelingInfo")&&(f.labelingInfo=
ka.clone(this.labelingInfo)),0<this.originIdOf("labelsVisible")&&(f.labelsVisible=this.labelsVisible),0<this.originIdOf("legendEnabled")&&(f.legendEnabled=this.legendEnabled),0<this.originIdOf("visible")&&(f.visible=this.visible),0<this.originIdOf("minScale")&&(f.minScale=this.minScale),0<this.originIdOf("maxScale")&&(f.maxScale=this.maxScale),0<this.originIdOf("opacity")&&(f.opacity=this.opacity),0<this.originIdOf("popupTemplate")&&(f.popupTemplate=ka.clone(this.popupTemplate)),2<this.originIdOf("renderer")&&
(f.renderer=ka.clone(this.renderer)),K.isDataLayerSource(this.source)&&(f.dynamicDataSource=ka.clone(this.source)),0<this.originIdOf("title")&&(f.title=this.title),[2,f]}})})};n.prototype.getFeatureType=function(b){var c=this.typeIdField;if(!c||!b)return null;var h=b.attributes?b.attributes[c]:void 0;if(null==h)return null;var g=null;this.types.some(function(b){var c=b.id;if(null==c)return!1;c.toString()===h.toString()&&(g=b);return!!g});return g};n.prototype.getFieldDomain=function(b,c){return(c=
this.getFeatureType(c&&c.feature))&&(c=c.domains&&c.domains[b])&&"inherited"!==c.type?c:this._getLayerDomain(b)};n.prototype.queryFeatures=function(b,c){var h=this;void 0===b&&(b=this.createQuery());return na.all([na.create(function(b){return M(["../../tasks/operations/query"],b)}),na.create(function(b){return M(["../../tasks/support/FeatureSet"],b)})]).then(function(g){var f=g[0].executeQuery,k=g[1];return f(h.url,ya.from(b),h.layer.spatialReference,c).then(function(b){return k.fromJSON(b.data)})}).then(function(b){b&&
b.features&&b.features.forEach(function(b){b.sourceLayer=h});return b})};n.prototype.toExportImageJSON=function(){var b=this,c={id:this.id,source:K.sourceToJSON(this.source)};this.definitionExpression&&(c.definitionExpression=this.definitionExpression);var h=["renderer","labelingInfo","opacity","labelsVisible"].reduce(function(c,h){c[h]=b.originIdOf(h);return c},{});if(Object.keys(h).some(function(b){return 2<=h[b]})){var g=c.drawingInfo={};2<=h.renderer&&(g.renderer=this.renderer?this.renderer.toJSON():
null);2<=h.labelsVisible&&(g.showLabels=this.labelsVisible);this.labelsVisible&&2<=h.labelingInfo&&(g.labelingInfo=this.labelingInfo?this.labelingInfo.map(function(b){return b.write({},{origin:"service"})}):null,g.showLabels=!0);2<=h.opacity&&(g.transparency=100-100*this.opacity);this._assignDefaultSymbolColors(g.renderer)}return c};n.prototype._assignDefaultSymbolColors=function(b){this._forEachSimpleMarkerSymbols(b,function(b){b.color||"esriSMSX"!==b.style&&"esriSMSCross"!==b.style||(b.color=b.outline&&
b.outline.color?b.outline.color:[0,0,0,0])})};n.prototype._forEachSimpleMarkerSymbols=function(b,c){if(b){var h=0,g="uniqueValueInfos"in b?b.uniqueValueInfos:"classBreakInfos"in b?b.classBreakInfos:[];for(;h<g.length;h++){var f=g[h];Ha(f.symbol)&&c(f.symbol)}"symbol"in b&&Ha(b.symbol)&&c(b.symbol);"defaultSymbol"in b&&Ha(b.defaultSymbol)&&c(b.defaultSymbol)}};n.prototype._setAndNotifyLayer=function(b,c){var h=this.layer,g=this._get(b),f,k;switch(b){case "definitionExpression":f="supportsSublayerDefinitionExpression";
case "minScale":case "maxScale":case "visible":f="supportsSublayerVisibility";break;case "labelingInfo":case "labelsVisible":case "opacity":case "renderer":case "source":f="supportsDynamicLayers",k="supportsModification"}var n=w.getProperties(this).getDefaultOrigin();if("service"!==n){if(f&&!1===this.get("layer.capabilities.exportMap."+f)){this._logLockedError(b,"capability not available 'layer.capabilities.exportMap."+f+"'");return}if(k&&!1===this.get("capabilities.exportMap."+k)){this._logLockedError(b,
"capability not available 'capabilities.exportMap."+k+"'");return}}"source"===b&&"not-loaded"!==this.loadStatus?this._logLockedError(b,"'source' can't be changed after calling sublayer.load()"):(this._set(b,c),"service"!==n&&g!==c&&h&&h.emit&&h.emit("sublayer-update",{propertyName:b}))};n.prototype._handleSublayersChange=function(b,c){var h=this;c&&(c.forEach(function(b){b.parent=null;b.layer=null}),this.handles.removeAll());b&&(b.forEach(function(b){b.parent=h;b.layer=h.layer}),this.handles.add([b.on("after-add",
function(b){b=b.item;b.parent=h;b.layer=h.layer}),b.on("after-remove",function(b){b=b.item;b.parent=null;b.layer=null}),b.on("before-changes",function(b){var c=h.get("layer.capabilities.exportMap.supportsSublayersChanges");null==c||c||(za.error(new g("sublayer:sublayers-non-modifiable","Sublayer can't be added, moved, or removed from the layer's sublayers",{sublayer:h,layer:h.layer})),b.preventDefault())})]))};n.prototype._logLockedError=function(b,c){za.error(new g("sublayer:locked","Property '"+
b+"' can't be changed on Sublayer from the layer '"+this.layer.id+"'",{reason:c,sublayer:this,layer:this.layer}))};n.prototype._getLayerDomain=function(b){return(b=this.fieldsIndex.get(b))?b.domain:null};var E;f([x.property({readOnly:!0})],n.prototype,"capabilities",void 0);f([x.reader("service","capabilities",["layerDefinition.canModifyLayer"])],n.prototype,"readCapabilities",null);f([x.property({type:String,value:null,json:{read:{source:"layerDefinition.definitionExpression"},write:{target:"layerDefinition.definitionExpression",
overridePolicy:ra}}})],n.prototype,"definitionExpression",null);f([x.property({type:[h],json:{origins:{service:{read:{source:"layerDefinition.fields"}}}}})],n.prototype,"fields",void 0);f([x.property({readOnly:!0,dependsOn:["fields"]})],n.prototype,"fieldsIndex",null);f([x.property({type:H.Extent,json:{read:{source:"layerDefinition.extent"}}})],n.prototype,"fullExtent",void 0);f([x.property({type:String})],n.prototype,"globalIdField",void 0);f([x.reader("service","globalIdField",["layerDefinition.globalIdField",
"layerDefinition.fields"])],n.prototype,"readGlobalIdFieldFromService",null);f([x.property({type:Number,json:{write:{ignoreOrigin:!0}}})],n.prototype,"id",null);f([x.property({value:null,type:[J],json:{read:{source:"layerDefinition.drawingInfo.labelingInfo"},write:{target:"layerDefinition.drawingInfo.labelingInfo",overridePolicy:ha}}})],n.prototype,"labelingInfo",null);f([x.writer("labelingInfo")],n.prototype,"writeLabelingInfo",null);f([x.property({type:Boolean,value:!0,json:{read:{source:"layerDefinition.drawingInfo.showLabels"},
write:{target:"layerDefinition.drawingInfo.showLabels",overridePolicy:ha}}})],n.prototype,"labelsVisible",null);f([x.property({value:null})],n.prototype,"layer",null);f([x.property({type:Boolean,value:!0,json:{origins:{service:{read:{enabled:!1}}},read:{source:"showLegend"},write:{target:"showLegend",overridePolicy:ra}}})],n.prototype,"legendEnabled",void 0);f([x.property({type:["show","hide","hide-children"],value:"show",json:{read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],n.prototype,
"listMode",null);f([x.property({type:Number,value:0,json:{write:{enabled:!1,overridePolicy:ha}}})],n.prototype,"minScale",null);f([x.reader("minScale",["minScale","layerDefinition.minScale"])],n.prototype,"readMinScale",null);f([x.property({type:Number,value:0,json:{write:{enabled:!1,overridePolicy:ha}}})],n.prototype,"maxScale",null);f([x.reader("maxScale",["maxScale","layerDefinition.maxScale"])],n.prototype,"readMaxScale",null);f([x.property({type:String})],n.prototype,"objectIdField",void 0);
f([x.reader("service","objectIdField",["layerDefinition.objectIdField","layerDefinition.fields"])],n.prototype,"readObjectIdFieldFromService",null);f([x.property({type:Number,value:1,json:{write:{target:"layerDefinition.drawingInfo.transparency",overridePolicy:ha}}})],n.prototype,"opacity",null);f([x.reader("opacity",["layerDefinition.drawingInfo.transparency","layerDefinition.transparency"])],n.prototype,"readOpacity",null);f([x.writer("opacity")],n.prototype,"writeOpacity",null);f([x.property({json:{type:Number,
write:{target:"parentLayerId",allowNull:!0,overridePolicy:ha}}})],n.prototype,"parent",void 0);f([x.writer("parent")],n.prototype,"writeParent",null);f([x.property({type:Boolean,value:!0,json:{read:{source:"disablePopup",reader:function(b,c){return!c.disablePopup}},write:{target:"disablePopup",overridePolicy:ra,writer:function(b,c,h){c[h]=!b}}}})],n.prototype,"popupEnabled",void 0);f([x.property({type:T,json:{read:{source:"popupInfo"},write:{target:"popupInfo",overridePolicy:ra}}})],n.prototype,"popupTemplate",
void 0);f([x.property({readOnly:!0,dependsOn:["fields","title"]})],n.prototype,"defaultPopupTemplate",null);f([x.property({types:y.rendererTypes,value:null,json:{write:{target:"layerDefinition.drawingInfo.renderer",overridePolicy:ha}}})],n.prototype,"renderer",null);f([x.reader("renderer",["layerDefinition.drawingInfo.renderer"])],n.prototype,"readRenderer",null);f([x.writer("renderer")],n.prototype,"writeRenderer",null);f([x.writer("web-scene","renderer",{"layerDefinition.drawingInfo.renderer":{types:y.webSceneRendererTypes}})],
n.prototype,"writeWebSceneRenderer",null);f([x.property({cast:K.castSource,json:{read:{source:"layerDefinition.source",reader:K.sourceFromJSON},write:{target:"layerDefinition.source",overridePolicy:ha}}})],n.prototype,"source",null);f([x.writer("source")],n.prototype,"writeSource",null);f([x.property()],n.prototype,"sourceJSON",void 0);f([x.property({value:null,json:{type:[C.Integer],write:{target:"subLayerIds",allowNull:!0,overridePolicy:ha}}})],n.prototype,"sublayers",null);f([x.cast("sublayers")],
n.prototype,"castSublayers",null);f([x.writer("sublayers")],n.prototype,"writeSublayers",null);f([x.property({type:String,json:{read:{source:"name"},write:{target:"name",allowNull:!0,overridePolicy:ra}}})],n.prototype,"title",void 0);f([x.property({type:String})],n.prototype,"typeIdField",void 0);f([x.reader("typeIdField",["layerDefinition.typeIdField"])],n.prototype,"readTypeIdField",null);f([x.property({type:[b],json:{origins:{service:{read:{source:"layerDefinition.types"}}}}})],n.prototype,"types",
void 0);f([x.property({type:String,dependsOn:["layer","source"],json:{read:{source:"layerUrl"},write:{target:"layerUrl",overridePolicy:function(){return{enabled:this._isOverridden("url")}}}}})],n.prototype,"url",null);f([x.property({type:Boolean,value:!0,json:{read:{source:"defaultVisibility"},write:{target:"defaultVisibility",overridePolicy:ha}}})],n.prototype,"visible",null);f([x.writer("visible")],n.prototype,"writeVisible",null);return n=E=f([x.subclass("esri.layers.support.Sublayer")],n)}(x.declared(E.HandleOwnerMixin(t.MultiOriginJSONMixin(ga))))})},
"esri/support/actions/ActionSlider":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ./ActionBase".split(" "),function(M,F,L,f,N,v){return function(r){function p(f){f=r.call(this,f)||this;f.displayValueEnabled=!1;f.max=1;f.min=0;f.step=.1;f.type="slider";f.value=null;return f}L(p,r);v=p;p.prototype.clone=function(){return new v({active:this.active,className:this.className,disabled:this.disabled,id:this.id,
indicator:this.indicator,title:this.title,visible:this.visible,displayValueEnabled:this.displayValueEnabled,max:this.max,min:this.min,step:this.step,value:this.value})};var v;f([N.property()],p.prototype,"displayValueEnabled",void 0);f([N.property()],p.prototype,"max",void 0);f([N.property()],p.prototype,"min",void 0);f([N.property()],p.prototype,"step",void 0);f([N.property()],p.prototype,"value",void 0);return p=v=f([N.subclass("esri.support.Action.ActionSlider")],p)}(N.declared(v))})},"esri/widgets/LayerList/ListItemPanel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Handles ../../core/Identifiable ../../core/promiseUtils ../../core/watchUtils ../../core/accessorSupport/decorators ../Widget ../support/widget".split(" "),
function(M,F,L,f,N,v,r,p,H,T,y){return function(l){function v(c){c=l.call(this,c)||this;c._legend=null;c._handles=new N;c.content=null;c.image=null;c.listItem=null;c.open=!1;c.visible=!0;return c}L(v,l);v.prototype.postInitialize=function(){var c=this;this.own([p.init(this,"content",function(g){return c._createLegend(g)})])};v.prototype.destroy=function(){var c=this._legend;c&&c.destroy();this._legend=null};Object.defineProperty(v.prototype,"className",{get:function(){var c=this.image,g=this._getFirstWidget();
return this._get("className")||!c&&g?g.iconClass:""},set:function(c){void 0===c?this._clearOverride("className"):this._override("className",c)},enumerable:!0,configurable:!0});Object.defineProperty(v.prototype,"title",{get:function(){var c=this._getFirstWidget();return this._get("title")||c?c.label:""},set:function(c){void 0===c?this._clearOverride("title"):this._override("title",c)},enumerable:!0,configurable:!0});v.prototype.render=function(){return y.tsx("div",{class:"esri-layer-list-panel"},this._renderContents())};
v.prototype._renderContent=function(c){var g=this._legend,f=this.listItem;return c?"legend"===c?f&&f.view&&f.layer&&g?y.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--legend"),key:g},g.render()):null:"string"===typeof c?y.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--string"),key:c,innerHTML:c}):y.isWidget(c)?y.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--widget"),
key:c},c.render()):c instanceof HTMLElement?y.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--html-element"),key:c,bind:c,afterCreate:this._attachToNode}):null:null};v.prototype._renderContents=function(){var c=this,g=this.content;return Array.isArray(g)?g.map(function(g){return c._renderContent(g)}):this._renderContent(g)};v.prototype._getLegendOptions=function(c){if(c){var g=c.layer;c=c.view;if(g&&c)return{view:c,layerInfos:[{layer:g,title:""}]}}};
v.prototype._createLegend=function(c){var g=this;this._hasLegend(c)&&!this._legend&&r.create(function(c){M(["../Legend"],c)}).then(function(c){var f=g._handles,l=new c(g._getLegendOptions(g.listItem));g._legend=l;g.notifyChange("className");g.notifyChange("title");c=p.init(g,["listItem.view","listItem.layer"],function(){return g._updateLegend(l)});f.add(c,"legends");g.scheduleRender()})};v.prototype._hasLegend=function(c){return"legend"===c?!0:Array.isArray(c)?c.some(function(c){return"legend"===
c}):!1};v.prototype._attachToNode=function(c){c.appendChild(this)};v.prototype._updateLegend=function(c){var g=this.listItem;if(g){var f=g.layer;c.view=g.view;c.layerInfos=[{layer:f,title:null}];this.scheduleRender()}};v.prototype._getWidget=function(c){return"legend"===c?this._legend:y.isWidget(c)?c:null};v.prototype._getFirstWidget=function(){var c=this,g=this.content;if(Array.isArray(g)){var f=null;g.some(function(g){(g=c._getWidget(g))&&(f=g);return!!g});return f}return this._getWidget(g)};f([H.property({dependsOn:["content",
"image"]})],v.prototype,"className",null);f([H.property(),y.renderable()],v.prototype,"content",void 0);f([H.property()],v.prototype,"image",void 0);f([H.property()],v.prototype,"listItem",void 0);f([H.property({dependsOn:["content"]})],v.prototype,"title",null);f([H.property(),y.renderable()],v.prototype,"open",void 0);f([H.property()],v.prototype,"visible",void 0);return v=f([H.subclass("esri.widgets.LayerList.ListItemPanel")],v)}(H.declared(v.IdentifiableMixin(T)))})},"esri/widgets/LayerList/support/layerListUtils":function(){define(["require",
"exports"],function(M,F){function L(f){if(f)return null!=f.listMode?f.listMode:void 0}function f(f){if(f)return null!=f.minScale?f.minScale:void 0}function N(f){if(f)return null!=f.maxScale?f.maxScale:void 0}Object.defineProperty(F,"__esModule",{value:!0});F.findLayerListMode=L;F.findLayerMinScale=f;F.findLayerMaxScale=N;F.findLayerVisibilityMode=function(f){if(!f)return"inherited";var r=f.get("layer.capabilities.exportMap.supportsSublayerVisibility");if("boolean"===typeof r)return r?"independent":
"inherited";r=f.get("capabilities.exportMap.supportsSublayerVisibility");return"boolean"===typeof r?r?"independent":"inherited":null!=f.visibilityMode?f.visibilityMode:"independent"};F.getNormalizedChildLayerProperty=function(f){if(f&&"hide-children"!==f.listMode&&"wmts"!==f.type)return"group"===f.type?"layers":"sublayers"};F.canDisplayLayer=function(f){return"hide"!==L(f)};F.isLayerOutsideScaleRange=function(v,r){if(!v||isNaN(r))return!1;var p=f(v);v=N(v);p=!isNaN(p)&&0<p&&r>=p;r=!isNaN(v)&&0<v&&
r<=v;return p||r}})},"*now":function(M){M(['dojo/i18n!*preload*esri/widgets/nls/LayerList*["ar","bs","ca","cs","da","de","de-ch","el","en-au","en-ca","en-gb","en-us","es","es-mx","et","fi","fr","fr-ch","he","hr","hu","id","it","it-ch","ja","ko","lt","lv","nl","nb","pl","pt","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","uk","vi","zh-cn","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/assignHelper dojo/i18n!../nls/common dojo/i18n!./LayerList/nls/LayerList ../core/Collection ../core/deprecate ../core/events ../core/Handles ../core/has ../core/Logger ../core/watchUtils ../core/accessorSupport/decorators ../libs/sortablejs/Sortable ./Widget ./LayerList/LayerListViewModel ./LayerList/ListItem ./support/widget".split(" "),function(M,F,L,f,N,v,r,p,H,T,y,l,I,c,g,E,ka,ga,
ba,t){function na(c){var f=c.children;c.actionsOpen&&(c.actionsOpen=!1);f.forEach(function(b){return na(b)})}var qa=p.ofType(ba),x=I.getLogger("esri.widgets.LayerList"),C={statusIndicators:!0};return function(p){function w(b){b=p.call(this,b)||this;b._handles=new y;b._sortable=null;b._sortableNode=null;b._focusSortUid=null;b._newUI=l("esri-layerlist-new-ui");b.iconClass="esri-icon-layers";b.label=r.widgetLabel;b.listItemCreatedFunction=null;b.multipleSelectionEnabled=!1;b.operationalItems=null;b.selectionEnabled=
!1;b.selectedItems=new qa;b.view=null;b.viewModel=new ga;b.visibleElements=N({},C);return b}L(w,p);w.prototype.postInitialize=function(){var b=this,h=this.operationalItems;this.own(c.on(this,"operationalItems","change",function(){return b._itemsChanged(h)}),c.init(this,"selectionEnabled",function(){return b._toggleSorting()}))};w.prototype.destroy=function(){this._destroySortable();this._handles.destroy();this._handles=null};Object.defineProperty(w.prototype,"statusIndicatorsVisible",{set:function(b){H.deprecatedProperty(x,
"statusIndicatorsVisible",{replacement:"visibleElements.statusIndicators",version:"4.15"});this.visibleElements=N({},this.visibleElements,{statusIndicators:b})},enumerable:!0,configurable:!0});w.prototype.castVisibleElements=function(b){return N({},C,b)};w.prototype.triggerAction=function(b,c){this.viewModel.triggerAction(b,c)};w.prototype.render=function(){var b=this,c,f=this._getItems(),g=this.get("viewModel.state"),f=0===f.length?t.tsx("div",{class:"esri-layer-list__no-items"},r.noItemsToDisplay):
t.tsx("ul",{"aria-label":r.widgetLabel,role:this.selectionEnabled?"listbox":void 0,afterCreate:this._sortNodeCreated,afterRemoved:this._destroySortable,"data-node-ref":"_sortableNode",bind:this,class:this.classes("esri-layer-list__list","esri-layer-list__list--root","esri-layer-list__list--independent")},f.map(function(c){return b._renderItem(c,null)})),g=(c={},c["esri-layer-list--new-ui"]=this._newUI,c["esri-hidden"]="loading"===g,c["esri-disabled"]="disabled"===g,c);return t.tsx("div",{class:this.classes("esri-layer-list esri-widget esri-widget--panel",
g)},f)};w.prototype._destroySortable=function(){var b=this._sortable;b&&b.destroy();this._sortable=null};w.prototype._toggleSorting=function(){var b=this,c=this._sortable,f=this._sortableNode,g=this.selectionEnabled;if(f)if(c)c.option("disabled",!g);else{var l=E.create(f,{dataIdAttr:"data-layer-uid",group:"root-layers",fallbackTolerance:4,disabled:!g,onSort:function(){return b._sortLayersToItems(l.toArray())}});this._sortable=l}};w.prototype._sortNodeCreated=function(b){this._sortableNode=b;this._toggleSorting()};
w.prototype._sortLayersToItems=function(b){var c=this.get("view.map.layers");c&&c.sort(function(c,h){c=b.indexOf(c.uid);h=b.indexOf(h.uid);return c>h?-1:c<h?1:0})};w.prototype._getItems=function(){var b=this;return this.operationalItems.toArray().filter(function(c){return b.errorsVisible||!c.error})};w.prototype._getSingleActionButton=function(b){return b.actionsSections.reduce(function(b){return b}).filter(function(b){return b&&"button"===b.type}).getItemAt(0)};w.prototype._renderItem=function(b,
c){var h=this,f,g,l,p,w,x,y=this.id+"_"+b.uid,C=y+"_actions",E=y+"__list",y=y+"__title",F=this._newUI,H=!!b.error,I=!!b.children.length&&!H,L=H?r.layerError:"",n=b.visibilityMode,M=b.children&&b.children.toArray(),k=(f={},f["esri-layer-list__list--exclusive"]="exclusive"===n,f["esri-layer-list__list--inherited"]="inherited"===n,f["esri-layer-list__list--independent"]="inherited"!==n&&"exclusive"!==n,f);f=(g={},g["esri-layer-list__item--has-children"]=I,g["esri-layer-list__item--error"]=!!H,g["esri-layer-list__item--updating"]=
b.updating&&!c&&this.visibleElements.statusIndicators,g["esri-layer-list__item--invisible"]=F&&!b.visible,g["esri-layer-list__item--invisible-at-scale"]=!b.visibleAtCurrentScale,g["esri-layer-list__item--selectable"]=this.selectionEnabled,g);var F=this._countActions(b.actionsSections),q=b.panel;g=q&&q.open?q.render():null;var q=q&&q.visible?this._renderPanelButton(q):null,P=(l={},l["esri-layer-list__item-actions-menu-item--active"]=b.actionsOpen,l),O=b.actionsOpen?v.close:v.open,R=1===F&&this._getSingleActionButton(b);
l=R?this._renderAction({item:b,action:R,singleAction:!0}):null;l=(P=!R&&F?t.tsx("div",{key:"actions-menu-toggle","data-item":b,bind:this,onclick:this._toggleActionsOpen,onkeydown:this._toggleActionsOpen,class:this.classes("esri-layer-list__item-actions-menu-item",P),tabindex:"0",role:"button","aria-controls":C,"aria-label":O,title:O},t.tsx("span",{"aria-hidden":"true",class:"esri-icon-handle-horizontal"})):null)||q||l?t.tsx("div",{key:"esri-layer-list__actions-menu",class:"esri-layer-list__item-actions-menu"},
q,l,P):null;C=F?this._renderActionsSections(b,b.actionsSections,C):null;n=I?t.tsx("ul",{key:"esri-layer-list__list-items",id:E,class:this.classes("esri-layer-list__list",k),"aria-expanded":b.open?"true":"false",role:"exclusive"===n?"radiogroup":"group",hidden:b.open?null:!0},M.map(function(c){return h._renderItem(c,b)})):null;M=(p={},p["esri-layer-list__child-toggle--open"]=b.open,p);p=b.open?v.collapse:v.expand;E=I?t.tsx("span",{onclick:this._toggleChildrenClick,onkeydown:this._toggleChildrenClick,
"data-item":b,key:"esri-layer-list__toggle-children",class:this.classes("esri-layer-list__child-toggle",M),tabindex:"0",role:"button","aria-controls":E,"aria-label":p,title:p},t.tsx("span",{"aria-hidden":"true",class:this.classes("esri-layer-list__child-toggle-icon--closed","esri-icon-right-triangle-arrow")}),t.tsx("span",{"aria-hidden":"true",class:this.classes("esri-layer-list__child-toggle-icon--opened","esri-icon-down-arrow")}),t.tsx("span",{"aria-hidden":"true",class:this.classes("esri-layer-list__child-toggle-icon--closed-rtl",
"esri-icon-left-triangle-arrow")})):null;p=this._createLabelNode(b,c,y);H=H?t.tsx("div",{key:"esri-layer-list__error",class:"esri-layer-list__item-error-message",role:"alert"},t.tsx("span",null,L)):null;L=-1<this.selectedItems.indexOf(b);c=c?null:b.get("layer.uid");c=this.selectionEnabled?(w={bind:this,onclick:this._toggleSelection,onkeydown:this._selectionKeydown,"data-item":b,tabIndex:0,"aria-selected":L?"true":"false",role:"option","aria-labelledby":y},w["data-layer-uid"]=c,w):(x={bind:void 0,
onclick:void 0,onkeydown:void 0,"data-item":void 0,tabIndex:void 0,"aria-selected":void 0,role:void 0,"aria-labelledby":void 0},x["data-layer-uid"]=void 0,x);return t.tsx("li",N({key:b,bind:this,afterCreate:this._focusListItem,afterUpdate:this._focusListItem,class:this.classes("esri-layer-list__item",f),"aria-labelledby":y},c),t.tsx("div",{key:"esri-layer-list__list-item-container",class:"esri-layer-list__item-container"},E,p,l),H,C,g,n)};w.prototype._focusListItem=function(b){var c=this._focusSortUid;
b&&c&&b.dataset.layerUid===c&&(b.focus(),this._focusSortUid=null)};w.prototype._createLabelNode=function(b,c,f){var g,h=this.selectionEnabled,l=this._newUI;c=c&&c.visibilityMode;var p=(g={},g["esri-layer-list__item-toggle-icon"]=l,g["esri-layer-list__item-toggle-icon"]=l&&"exclusive"!==c,g["esri-layer-list__item-radio-icon"]=l&&"exclusive"===c,g["esri-icon-radio-checked"]="exclusive"===c&&b.visible,g["esri-icon-radio-unchecked"]="exclusive"===c&&!b.visible,g["esri-icon-visible"]="exclusive"!==c&&
!l&&b.visible,g["esri-icon-non-visible"]="exclusive"!==c&&(l||!b.visible),g),v="exclusive"===c?"radio":"switch";g=b.title||r.untitledLayer;var w=b.visibleAtCurrentScale?g:g+" ("+r.layerInvisibleAtScale+")";g=t.tsx("span",{key:"layer-title-container",id:f,title:w,"aria-label":w,class:"esri-layer-list__item-title"},g);p=t.tsx("span",{class:this.classes(p),"aria-hidden":"true"});v={bind:this,onclick:this._toggleVisibility,onkeydown:this._toggleVisibility,"data-item":b,"data-parent-visibility":c,tabIndex:0,
"aria-checked":b.visible?"true":"false",role:v,"aria-labelledby":f};w={bind:void 0,onclick:void 0,onkeydown:void 0,"data-item":void 0,"data-parent-visibility":void 0,tabIndex:void 0,"aria-checked":void 0,role:void 0,"aria-labelledby":void 0};f=h?w:v;h=[t.tsx("span",N({class:"esri-layer-list__item-toggle"},h?v:w),p),g];l&&h.reverse();l=t.tsx("div",N({key:b,class:"esri-layer-list__item-label"},f),h);f=(h=!!b.error)?t.tsx("span",{key:"notice-triangle","aria-hidden":"true",class:"esri-icon-notice-triangle"}):
null;return"inherited"===c||h?t.tsx("div",{key:b,class:"esri-layer-list__item-label"},f,g):l};w.prototype._renderPanelButton=function(b){var c,f,g=b.className,l=b.open,p=b.title,g=b.image||g?g:"esri-icon-default-action",r=this._getIconImageStyles(b),l=(c={},c["esri-layer-list__item-actions-menu-item--active"]=l,c);c=(f={},f["esri-layer-list__item-action-image"]=!!r["background-image"],f);g&&(c[g]=!!g);return t.tsx("div",{key:b,bind:this,"data-panel":b,onclick:this._triggerPanel,onkeydown:this._triggerPanel,
class:this.classes("esri-layer-list__item-actions-menu-item",l),role:"button",tabindex:"0",title:p,"aria-label":p},t.tsx("span",{class:this.classes(c),styles:r}))};w.prototype._watchActionSectionChanges=function(b,c){var f=this,g="action-section"+c;this._handles.add(b.on("change",this.scheduleRender.bind(this)),g);b.forEach(function(b){return f._renderOnActionChanges(b,c)})};w.prototype._renderOnActionChanges=function(b,f){var g=this;f="actions"+f;"toggle"===b.type?this._handles.add([c.init(b,"className image id title visible value".split(" "),
function(){return g.scheduleRender()})],f):"slider"===b.type?this._handles.add([c.init(b,"className id title visible value displayValueEnabled max min step".split(" "),function(){return g.scheduleRender()})],f):this._handles.add([c.init(b,["className","image","id","title","visible"],function(){return g.scheduleRender()})],f)};w.prototype._renderOnItemChanges=function(b){var f=this,g=b.uid,l="items"+g;this._handles.add([c.init(b,"actionsOpen visible open updating title visibleAtCurrentScale error visibilityMode panel panel.title panel.content panel.className".split(" "),
function(){return f.scheduleRender()}),b.actionsSections.on("change",function(){return f.scheduleRender()}),b.children.on("change",function(){return f.scheduleRender()})],l);b.children.forEach(function(b){return f._renderOnItemChanges(b)});b.actionsSections.forEach(function(b){return f._watchActionSectionChanges(b,g)})};w.prototype._itemsChanged=function(b){var c=this;this._handles.removeAll();b.forEach(function(b){return c._renderOnItemChanges(b)});this.scheduleRender()};w.prototype._renderActionsSections=
function(b,c,f){var g=this;c=c.toArray().map(function(c){return t.tsx("ul",{key:c,class:"esri-layer-list__item-actions-list"},g._renderActionSection(b,c))});return t.tsx("div",{role:"group","aria-expanded":b.actionsOpen?"true":"false",key:"esri-layer-list__actions-section",id:f,class:"esri-layer-list__item-actions",hidden:b.actionsOpen?null:!0},c)};w.prototype._renderActionSection=function(b,c){var f=this;return(c&&c.toArray()).map(function(c){return f._renderAction({item:b,action:c})})};w.prototype._renderAction=
function(b){var c,f,g=b.item,l=b.action;b=b.singleAction;var p=this._getIconImageStyles(l),r=l.active,v=l.className,w=l.disabled,x=l.title,v="button"!==l.type||l.image||v?v:"esri-icon-default-action",w=(c={},c["esri-layer-list__item-actions-menu-item"]=b&&"button"===l.type,c["esri-layer-list__item-action"]=!b&&"toggle"!==l.type,c["esri-layer-list__action-toggle"]="toggle"===l.type,c["esri-layer-list__action-toggle--on"]="toggle"===l.type&&l.value,c["esri-disabled-element"]=w,c);c=(f={},f["esri-layer-list__item-action-image"]=
!r&&!!p["background-image"],f["esri-icon-loading-indicator"]=r,f["esri-rotating"]=r,f);v&&(c[v]=!0);f=t.tsx("span",{key:"action-icon","aria-hidden":"true",class:this.classes("esri-layer-list__item-action-icon",c),styles:p});c=b?null:t.tsx("span",{key:"action-title",class:"esri-layer-list__item-action-title"},x);f=[f,c];return b?t.tsx("div",{bind:this,"data-item":g,"data-action":l,role:"button",key:l,onclick:this._triggerAction,onkeydown:this._triggerAction,classes:w,tabindex:"0",title:x,"aria-label":x},
f):t.tsx("li",{bind:this,"data-item":g,"data-action":l,key:l,onclick:this._triggerAction,onkeydown:this._triggerAction,classes:w,tabindex:"0",role:"button",title:x,"aria-label":x},f)};w.prototype._countActions=function(b){return b.reduce(function(b,c){return b+c.length},0)};w.prototype._getIconImageStyles=function(b){b="esri.widgets.LayerList.ListItemPanel"===b.declaredClass||"esri.support.Action.ActionButton"===b.declaredClass||"esri.support.Action.ActionToggle"===b.declaredClass?b.image:null;return{"background-image":b?
'url("'+b+'")':null}};w.prototype._selectionKeydown=function(b){var c=T.eventKey(b);if(-1===["ArrowDown","ArrowUp"].indexOf(c))this._toggleSelection(b);else{b.stopPropagation();var f=this._sortable,g=-1<this.selectedItems.indexOf(b.currentTarget["data-item"]),l=f.toArray();b=l.indexOf(b.target.dataset.layerUid);if(-1!==b){if("ArrowDown"===c){var p=b+1;if(p>=l.length)return;g?(l.splice(p,0,l.splice(b,1)[0]),f.sort(l),this._sortLayersToItems(f.toArray()),this._focusSortUid=l[p]):(this._focusSortUid=
l[p],this.scheduleRender())}"ArrowUp"===c&&(p=b-1,-1>=p||(g?(l.splice(p,0,l.splice(b,1)[0]),f.sort(l),this._sortLayersToItems(f.toArray()),this._focusSortUid=l[p]):(this._focusSortUid=l[p],this.scheduleRender())))}}};w.prototype._toggleActionsOpen=function(b){var c=b.currentTarget["data-item"],f=!c.actionsOpen;f&&this.operationalItems.forEach(function(b){return na(b)});c.actionsOpen=f;b.stopPropagation()};w.prototype._triggerPanel=function(b){var c=b.currentTarget["data-panel"];c&&(c.open=!c.open);
b.stopPropagation()};w.prototype._triggerAction=function(b){var c=b.currentTarget,f=c["data-action"],c=c["data-item"];"toggle"===f.type&&(f.value=!f.value);this.triggerAction(f,c);b.stopPropagation()};w.prototype._toggleVisibility=function(b){var c=b.currentTarget,f=c.getAttribute("data-parent-visibility"),c=c["data-item"];"exclusive"===f&&c.visible||(c.visible=!c.visible);b.stopPropagation()};w.prototype._toggleChildrenClick=function(b){var c=b.currentTarget["data-item"];c.open=!c.open;b.stopPropagation()};
w.prototype._toggleSelection=function(b){b.stopPropagation();var c=this.selectedItems,f=this.multipleSelectionEnabled&&(b.metaKey||b.ctrlKey);b=b.currentTarget["data-item"];var g=-1<c.indexOf(b),l=c.length,p=g&&1===l;f?g?c.remove(b):c.add(b):l&&!p?(c.removeAll(),c.add(b)):g?c.remove(b):c.add(b)};f([g.property()],w.prototype,"iconClass",void 0);f([g.property(),t.renderable()],w.prototype,"errorsVisible",void 0);f([g.property()],w.prototype,"label",void 0);f([g.aliasOf("viewModel.listItemCreatedFunction"),
t.renderable()],w.prototype,"listItemCreatedFunction",void 0);f([g.property()],w.prototype,"multipleSelectionEnabled",void 0);f([g.aliasOf("viewModel.operationalItems"),t.renderable()],w.prototype,"operationalItems",void 0);f([g.property(),t.renderable()],w.prototype,"selectionEnabled",void 0);f([g.property(),t.renderable()],w.prototype,"selectedItems",void 0);f([g.property(),t.renderable()],w.prototype,"statusIndicatorsVisible",null);f([g.aliasOf("viewModel.view"),t.renderable()],w.prototype,"view",
void 0);f([t.vmEvent("trigger-action"),g.property({type:ga}),t.renderable("viewModel.state")],w.prototype,"viewModel",void 0);f([g.property(),t.renderable()],w.prototype,"visibleElements",void 0);f([g.cast("visibleElements")],w.prototype,"castVisibleElements",null);f([g.aliasOf("viewModel.triggerAction")],w.prototype,"triggerAction",null);f([t.accessibleHandler()],w.prototype,"_toggleActionsOpen",null);f([t.accessibleHandler()],w.prototype,"_triggerPanel",null);f([t.accessibleHandler()],w.prototype,
"_triggerAction",null);f([t.accessibleHandler()],w.prototype,"_toggleVisibility",null);f([t.accessibleHandler()],w.prototype,"_toggleChildrenClick",null);f([t.accessibleHandler()],w.prototype,"_toggleSelection",null);return w=f([g.subclass("esri.widgets.LayerList")],w)}(g.declared(ka))});