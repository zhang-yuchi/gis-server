// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.15/esri/copyright.txt for details.
//>>built
require({cache:{"@dojo/framework/shim/Map":function(){(function(z){"object"===typeof module&&"object"===typeof module.exports?(z=z(require,exports),void 0!==z&&(module.exports=z)):"function"===typeof define&&define.amd&&define("require exports tslib ./iterator ./global ./object ../has/has ./Symbol".split(" "),z)})(function(z,d){Object.defineProperty(d,"__esModule",{value:!0});var t=z("tslib"),l=z("./iterator"),q=z("./global"),b=z("./object"),f=z("../has/has");z("./Symbol");d.Map=q.default.Map;f.default("es6-map")||
(d.Map=(h=function(){function h(c){this._keys=[];this._values=[];this[Symbol.toStringTag]="Map";if(c)if(l.isArrayLike(c))for(var a=0;a<c.length;a++){var m=c[a];this.set(m[0],m[1])}else try{for(var a=t.__values(c),b=a.next();!b.done;b=a.next())m=b.value,this.set(m[0],m[1])}catch(v){h={error:v}}finally{try{b&&!b.done&&(f=a.return)&&f.call(a)}finally{if(h)throw h.error;}}var h,f}h.prototype._indexOfKey=function(c,a){for(var m=0,h=c.length;m<h;m++)if(b.is(c[m],a))return m;return-1};Object.defineProperty(h.prototype,
"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0});h.prototype.clear=function(){this._keys.length=this._values.length=0};h.prototype.delete=function(c){c=this._indexOfKey(this._keys,c);if(0>c)return!1;this._keys.splice(c,1);this._values.splice(c,1);return!0};h.prototype.entries=function(){var c=this,a=this._keys.map(function(a,b){return[a,c._values[b]]});return new l.ShimIterator(a)};h.prototype.forEach=function(c,a){for(var m=this._keys,b=this._values,h=0,f=m.length;h<
f;h++)c.call(a,b[h],m[h],this)};h.prototype.get=function(c){c=this._indexOfKey(this._keys,c);return 0>c?void 0:this._values[c]};h.prototype.has=function(c){return-1<this._indexOfKey(this._keys,c)};h.prototype.keys=function(){return new l.ShimIterator(this._keys)};h.prototype.set=function(c,a){var m=this._indexOfKey(this._keys,c),m=0>m?this._keys.length:m;this._keys[m]=c;this._values[m]=a;return this};h.prototype.values=function(){return new l.ShimIterator(this._values)};h.prototype[Symbol.iterator]=
function(){return this.entries()};return h}(),h[Symbol.species]=h,h));d.default=d.Map;var h})},"@dojo/framework/shim/object":function(){(function(z){"object"===typeof module&&"object"===typeof module.exports?(z=z(require,exports),void 0!==z&&(module.exports=z)):"function"===typeof define&&define.amd&&define(["require","exports","./global","../has/has","./Symbol"],z)})(function(z,d){Object.defineProperty(d,"__esModule",{value:!0});var t=z("./global"),l=z("../has/has"),q=z("./Symbol");l.default("es6-object")?
(z=t.default.Object,d.assign=z.assign,d.getOwnPropertyDescriptor=z.getOwnPropertyDescriptor,d.getOwnPropertyNames=z.getOwnPropertyNames,d.getOwnPropertySymbols=z.getOwnPropertySymbols,d.is=z.is,d.keys=z.keys):(d.keys=function(b){return Object.keys(b).filter(function(b){return!b.match(/^@@.+/)})},d.assign=function(b){for(var f=[],h=1;h<arguments.length;h++)f[h-1]=arguments[h];if(null==b)throw new TypeError("Cannot convert undefined or null to object");var r=Object(b);f.forEach(function(c){c&&d.keys(c).forEach(function(a){r[a]=
c[a]})});return r},d.getOwnPropertyDescriptor=function(b,f){q.isSymbol(f);return Object.getOwnPropertyDescriptor(b,f)},d.getOwnPropertyNames=function(b){return Object.getOwnPropertyNames(b).filter(function(b){return!b.match(/^@@.+/)})},d.getOwnPropertySymbols=function(b){return Object.getOwnPropertyNames(b).filter(function(b){return!!b.match(/^@@.+/)}).map(function(b){return Symbol.for(b.substring(2))})},d.is=function(b,f){return b===f?0!==b||1/b===1/f:b!==b&&f!==f});l.default("es2017-object")?(z=
t.default.Object,d.getOwnPropertyDescriptors=z.getOwnPropertyDescriptors,d.entries=z.entries,d.values=z.values):(d.getOwnPropertyDescriptors=function(b){return d.getOwnPropertyNames(b).reduce(function(f,h){f[h]=d.getOwnPropertyDescriptor(b,h);return f},{})},d.entries=function(b){return d.keys(b).map(function(f){return[f,b[f]]})},d.values=function(b){return d.keys(b).map(function(f){return b[f]})})})},"esri/widgets/Attachments":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/generatorHelper ../core/tsSupport/awaiterHelper ../core/tsSupport/assignHelper dojo/i18n!./Attachments/nls/Attachments ../core/Error ../core/unitFormatUtils ../core/watchUtils ../core/accessorSupport/decorators ./Widget ./Attachments/AttachmentsViewModel ./Attachments/support/attachmentUtils ./support/widget".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u,D,w,v){var E={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},C=window.CSS;return function(b){function u(a){a=b.call(this,a)||this;a.abilities=null;a.displayType="list";a.graphic=null;a.label=h.widgetLabel;a.selectedFile=null;a.submitting=!1;a.viewModel=new D;a.visibleElements=f({},E);a._supportsImageOrientation=C&&C.supports&&C.supports("image-orientation","from-image");a._addAttachmentForm=
null;a._updateAttachmentForm=null;return a}t(u,b);u.prototype.postInitialize=function(){var c=this;this.own(a.on(this,"viewModel.attachmentInfos","change",function(){return c.scheduleRender()}),a.init(this,"viewModel.mode",function(){return c._modeChanged()}))};u.prototype.castVisibleElements=function(a){return f({},E,a)};u.prototype.addAttachment=function(){var a=this,c=this._addAttachmentForm,m=this.viewModel;this._set("submitting",!0);this._set("error",null);return m.addAttachment(c).then(function(c){a._set("submitting",
!1);a._set("error",null);m.mode="view";return c}).catch(function(c){a._set("submitting",!1);a._set("error",new r("attachments:add-attachment",h.addErrorMessage,c));throw c;})};u.prototype.deleteAttachment=function(a){var c=this,m=this.viewModel;this._set("submitting",!0);this._set("error",null);return m.deleteAttachment(a).then(function(a){c._set("submitting",!1);c._set("error",null);m.mode="view";return a}).catch(function(a){c._set("submitting",!1);c._set("error",new r("attachments:delete-attachment",
h.deleteErrorMessage,a));throw a;})};u.prototype.updateAttachment=function(){var a=this,c=this.viewModel,m=this._updateAttachmentForm;this._set("submitting",!0);this._set("error",null);return c.updateAttachment(m).then(function(m){a._set("submitting",!1);a._set("error",null);c.mode="view";return m}).catch(function(c){a._set("submitting",!1);a._set("error",new r("attachments:update-attachment",h.updateErrorMessage,c));throw c;})};u.prototype.render=function(){var a=this.submitting,c=this.viewModel.state;
return v.tsx("div",{class:this.classes("esri-attachments","esri-widget")},a?this._renderProgressBar():null,"loading"===c?this._renderLoading():this._renderAttachments(),this._renderErrorMessage())};u.prototype._renderErrorMessage=function(){var a=this.error,c=this.visibleElements;return a&&c.errorMessage?v.tsx("div",{key:"error-message",class:"esri-attachments__error-message"},a.message):null};u.prototype._renderAttachments=function(){var a=this.viewModel,c=a.mode,a=a.activeAttachmentInfo;return"add"===
c?this._renderAddForm():"edit"===c?this._renderDetailsForm(a):this._renderAttachmentContainer()};u.prototype._renderLoading=function(){return v.tsx("div",{class:"esri-attachments__loader-container",key:"loader"},v.tsx("div",{class:"esri-attachments__loader"}))};u.prototype._renderProgressBar=function(){return this.visibleElements.progressBar?v.tsx("div",{class:"esri-attachments__progress-bar",key:"progress-bar"}):null};u.prototype._renderAddForm=function(){var a,c=this.submitting,m=this.selectedFile,
b=c||!m,c=this.visibleElements.cancelAddButton?v.tsx("button",{type:"button",bind:this,disabled:c,onclick:this._cancelForm,class:this.classes("esri-button","esri-button--tertiary","esri-button--small","esri-button--half",c&&"esri-button--disabled")},h.cancel):null,b=this.visibleElements.addSubmitButton?v.tsx("button",{type:"submit",disabled:b,class:this.classes("esri-button","esri-button--secondary","esri-button--small","esri-button--half",(a={},a["esri-button--disabled"]=b,a))},h.add):null;a=m?v.tsx("span",
{key:"file-name",class:"esri-attachments__file-name"},m.name):null;m=v.tsx("form",{bind:this,afterCreate:v.storeNode,afterRemoved:v.discardNode,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},v.tsx("fieldset",{class:"esri-attachments__file-fieldset"},a,v.tsx("label",{class:this.classes("esri-attachments__file-label","esri-button","esri-button--secondary")},m?h.changeFile:h.selectFile,v.tsx("input",{class:"esri-attachments__file-input",type:"file",name:"attachment",bind:this,
onchange:this._handleFileInputChange}))),b,c);return v.tsx("div",{key:"add-form-container",class:"esri-attachments__form-node"},m)};u.prototype._renderDetailsForm=function(a){var m=this,b,f,u,C=this.visibleElements,r=this.selectedFile,w=this.submitting,l=a.contentType,d=a.size,E=a.url,D=this.viewModel.abilities,q=w||!r,K=D.editing&&D.operations.delete&&C.deleteButton?v.tsx("button",{key:"delete-button",type:"button",disabled:w,bind:this,onclick:function(c){return m._submitDeleteAttachment(c,a)},class:this.classes("esri-button",
"esri-button--small","esri-button--tertiary","esri-attachments__delete-button",(b={},b["esri-button--disabled"]=w,b))},h.delete):null;b=D.editing&&D.operations.update&&C.updateButton?v.tsx("button",{disabled:q,key:"update-button",type:"submit",class:this.classes("esri-button","esri-button--small","esri-button--third",(f={},f["esri-button--disabled"]=q,f))},h.update):null;f=this.visibleElements.cancelUpdateButton?v.tsx("button",{disabled:w,key:"cancel-button",type:"button",bind:this,onclick:this._cancelForm,
class:this.classes("esri-button","esri-button--small","esri-button--tertiary","esri-button--third",(u={},u["esri-button--disabled"]=w,u))},h.cancel):null;u=r?v.tsx("span",{key:"file-name",class:"esri-attachments__file-name"},r.name):null;D=D.editing&&D.operations.update?v.tsx("fieldset",{key:"file",class:"esri-attachments__file-fieldset"},u,v.tsx("label",{class:this.classes("esri-attachments__file-label","esri-button","esri-button--secondary")},h.changeFile,v.tsx("input",{class:"esri-attachments__file-input",
type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))):null;d=v.tsx("fieldset",{key:"size",class:"esri-attachments__metadata-fieldset"},v.tsx("label",null,c.formatFileSize(d)));l=v.tsx("fieldset",{key:"content-type",class:"esri-attachments__metadata-fieldset"},v.tsx("label",null,l));K=v.tsx("form",{bind:this,afterCreate:v.storeNode,afterRemoved:v.discardNode,"data-node-ref":"_updateAttachmentForm",onsubmit:this._submitUpdateAttachment},v.tsx("div",{class:"esri-attachments__metadata"},
d,l),D,v.tsx("div",{class:"esri-attachments__actions"},K,f,b));return v.tsx("div",{key:"edit-form-container",class:"esri-attachments__form-node"},v.tsx("a",{class:"esri-attachments__item-link",href:E,rel:"noreferrer",target:"_blank",alt:name},this._renderImageMask({attachmentInfo:a,size:400}),v.tsx("div",{class:"esri-attachments__item-link-overlay"},v.tsx("span",{class:"esri-attachments__item-link-overlay-icon"},v.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32"},
v.tsx("path",{d:"M28 13h1v16H3V3h16v1H4v24h24zm-5-9h4.293L15.646 15.638l.707.707L28 4.707V9h1V3h-6z"}),v.tsx("path",{fill:"none",d:"M0 0h32v32H0z"}))))),K)};u.prototype._renderImageMask=function(a){var c=a.attachmentInfo,m=a.size,b,h;a=this.viewModel.supportsResizeAttachments;var f=c.contentType,u=c.url,C=a&&w.isSupportedImage(f),c=(c=this._getCSSTransform(c,C))?{transform:c,"image-orientation":"none"}:{},r=-1===u.indexOf("?")?"?":"\x26",m=C?""+u+r+"w\x3d"+m:w.getIconPath(f),C=(b={},b["esri-attachments__item-mask--icon"]=
!C,b);b=(h={},h["esri-attachments__image--resizable"]=a,h);return v.tsx("div",{class:this.classes(C,"esri-attachments__item-mask")},v.tsx("img",{styles:c,alt:"",src:m,class:this.classes(b,"esri-attachments__image")}))};u.prototype._renderAttachmentInfo=function(a){var c=this,m=a.attachmentInfo,b=this.viewModel.abilities,f=m.name,u=m.url;a=this._renderImageMask({attachmentInfo:m,size:"list"===a.displayType?48:400});var C=b.editing?v.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-chevron-icon",
v.isRTL()?"esri-icon-left":"esri-icon-right")}):null,f=v.tsx("label",{class:"esri-attachments__label"},v.tsx("span",{class:"esri-attachments__filename"},f||h.noTitle),C),f=[a,f],b=b.editing?v.tsx("button",{key:"details-button",bind:this,class:"esri-attachments__item-button",title:h.attachmentDetails,"aria-label":h.attachmentDetails,"data-attachment-info-id":m.id,onclick:function(){return c._startEditAttachment(m)}},f):v.tsx("a",{key:"details-link",class:"esri-attachments__item-button",href:u,target:"_blank"},
f);return v.tsx("li",{class:"esri-attachments__item",key:m},b)};u.prototype._renderAttachmentContainer=function(){var a=this,c,m=this.displayType,b=this.viewModel,f=this.visibleElements,u=b.attachmentInfos,C=b.abilities,r=u&&u.length,b=(c={},c["esri-attachments__container--list"]="preview"!==m,c["esri-attachments__container--preview"]="preview"===m,c);c=C.editing&&C.operations.add&&f.addButton?v.tsx("button",{bind:this,onclick:function(){return a._startAddAttachment()},class:this.classes("esri-button",
"esri-button--tertiary","esri-attachments__add-attachment-button")},v.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-add-icon","esri-icon-plus")}),h.add):null;u=r?v.tsx("ul",{class:"esri-attachments__items"},u.toArray().map(function(c){return a._renderAttachmentInfo({attachmentInfo:c,displayType:m})})):v.tsx("div",{class:"esri-widget__content--empty"},h.noAttachments);return v.tsx("div",{key:"attachments-container",class:this.classes("esri-attachments__container",b)},
u,c)};u.prototype._modeChanged=function(){this._set("error",null);this._set("selectedFile",null)};u.prototype._handleFileInputChange=function(a){a=(a=a.target)&&a.files&&a.files.item(0);this._set("selectedFile",a)};u.prototype._submitDeleteAttachment=function(a,c){a.preventDefault();this.deleteAttachment(c)};u.prototype._submitAddAttachment=function(a){a.preventDefault();this.addAttachment()};u.prototype._submitUpdateAttachment=function(a){a.preventDefault();this.updateAttachment()};u.prototype._startEditAttachment=
function(a){var c=this.viewModel;c.activeAttachmentInfo=a;c.mode="edit"};u.prototype._startAddAttachment=function(){this.viewModel.mode="add"};u.prototype._cancelForm=function(a){a.preventDefault();this.viewModel.mode="view"};u.prototype._getCSSTransform=function(a,c){a=a.orientationInfo;return!this._supportsImageOrientation&&c&&a?[a.rotation?"rotate("+a.rotation+"deg)":"",a.mirrored?"scaleX(-1)":""].join(" "):""};l([m.aliasOf("viewModel.abilities")],u.prototype,"abilities",void 0);l([m.property(),
v.renderable()],u.prototype,"displayType",void 0);l([m.aliasOf("viewModel.graphic")],u.prototype,"graphic",void 0);l([m.property()],u.prototype,"label",void 0);l([m.property({readOnly:!0})],u.prototype,"selectedFile",void 0);l([v.renderable(),m.property({readOnly:!0})],u.prototype,"submitting",void 0);l([v.renderable(),m.property({readOnly:!0})],u.prototype,"error",void 0);l([m.property({type:D}),v.renderable("viewModel.activeAttachmentInfo viewModel.mode viewModel.state viewModel.supportsResizeAttachments viewModel.attachmentInfos viewModel.graphic viewModel.abilities viewModel.abilities.editing viewModel.abilities.operations".split(" "))],
u.prototype,"viewModel",void 0);l([m.property(),v.renderable()],u.prototype,"visibleElements",void 0);l([m.cast("visibleElements")],u.prototype,"castVisibleElements",null);return u=l([m.subclass("esri.widgets.Attachments")],u)}(m.declared(u))})},"esri/core/unitFormatUtils":function(){define("require exports dojo/i18n!./nls/Units ./string ./unitUtils ../intl/number".split(" "),function(z,d,t,l,q,b){function f(c,a){return t.units[c][a]}function h(c,a,m,h){void 0===m&&(m=2);void 0===h&&(h="abbr");return b.formatNumber(c,
{minimumFractionDigits:m,maximumFractionDigits:m})+" "+f(a,h)}Object.defineProperty(d,"__esModule",{value:!0});d.unitName=f;d.formatDecimal=h;d.formatMetricLength=function(c,a,m,b){void 0===m&&(m=2);void 0===b&&(b="abbr");var f=q.preferredMetricLengthUnit(c,a);return h(q.convertUnit(c,a,f),f,m,b)};d.formatMetricVerticalLength=function(c,a,m,b){void 0===m&&(m=2);void 0===b&&(b="abbr");var f=q.preferredMetricVerticalLengthUnit(c,a);return h(q.convertUnit(c,a,f),f,m,b)};d.formatImperialLength=function(c,
a,m,b){void 0===m&&(m=2);void 0===b&&(b="abbr");var f=q.preferredImperialLengthUnit(c,a);return h(q.convertUnit(c,a,f),f,m,b)};d.formatImperialVerticalLength=function(c,a,m,b){void 0===m&&(m=2);void 0===b&&(b="abbr");var f=q.preferredImperialVerticalLengthUnit(c,a);return h(q.convertUnit(c,a,f),f,m,b)};d.formatMetricArea=function(c,a,m,b){void 0===m&&(m=2);void 0===b&&(b="abbr");var f=q.preferredMetricAreaUnit(c,a);return h(q.convertUnit(c,a,f),f,m,b)};d.formatImperialArea=function(c,a,m,b){void 0===
m&&(m=2);void 0===b&&(b="abbr");var f=q.preferredImperialAreaUnit(c,a);return h(q.convertUnit(c,a,f),f,m,b)};d.formatDMS=function(c,a,m){void 0===m&&(m=2);c=q.convertUnit(c,a,"degrees");a=c-Math.floor(c);c-=a;a*=60;var b=a-Math.floor(a);a-=b;b*=60;return c.toFixed()+"\u00b0 "+a.toFixed()+"' "+b.toFixed(m)+'"'};z=t.units.bytes;var r=[z.B,z.kB,z.MB,z.GB,z.TB];d.formatFileSize=function(c){var a=0===c?0:Math.floor(Math.log(c)/Math.log(1024));c=b.formatNumber(c/Math.pow(1024,a),{maximumFractionDigits:2});
return l.replace(r[a],{fileSize:c})}})},"esri/widgets/Attachments/AttachmentsViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/awaiterHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/assignHelper ../../Graphic ../../core/Collection ../../core/Error ../../core/HandleOwner ../../core/watchUtils ../../core/accessorSupport/decorators ../../layers/support/AttachmentInfo ../../tasks/support/AttachmentQuery ../Feature/support/featureUtils".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u,D,w,v){var E={editing:!1,operations:{add:!0,update:!0,delete:!0}},C=r.ofType(D);return function(a){function r(c){var b=a.call(this,c)||this;b._getAttachmentsPromise=null;b._attachmentLayer=null;b.abilities=f({},E);b.activeAttachmentInfo=null;b.attachmentInfos=new C;b.graphic=null;b.mode="view";b.handles.add([m.init(b,"graphic",function(){return b._graphicChanged()})]);return b}t(r,a);r.prototype.destroy=function(){this.graphic=this._attachmentLayer=null};r.prototype.castAbilities=
function(a){return f({},E,a)};Object.defineProperty(r.prototype,"state",{get:function(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"supportsResizeAttachments",{get:function(){return this.get("graphic.layer.capabilities.operations.supportsResizeAttachments")||!1},enumerable:!0,configurable:!0});r.prototype.getAttachments=function(){return q(this,void 0,void 0,function(){var a,m,h,f,v,C,u,r;return b(this,
function(b){switch(b.label){case 0:a=this;m=a._attachmentLayer;h=a.attachmentInfos;if(!m||"function"!==typeof m.queryAttachments)throw new c("invalid-layer","getAttachments(): A valid layer is required.");f=this._getFeatureId();v=new w({objectIds:[f],returnMetadata:!0});C=[];this._getAttachmentsPromise=u=m.queryAttachments(v).then(function(a){return a[f]||C}).catch(function(){return C});this.notifyChange("state");return[4,u];case 1:return r=b.sent(),h.removeAll(),r.length&&h.addMany(r),this._getAttachmentsPromise=
null,this.notifyChange("state"),[2,r]}})})};r.prototype.addAttachment=function(a){return q(this,void 0,void 0,function(){var m,h,f,v,C,u,r,w=this;return b(this,function(b){switch(b.label){case 0:m=this;h=m._attachmentLayer;f=m.attachmentInfos;v=m.graphic;C=m.abilities;if(!a)throw new c("invalid-attachment","addAttachment(): An attachment is required.",{attachment:a});if(!C.operations.add)throw new c("invalid-abilities","addAttachment(): add abilities are required.");if(!h||"function"!==typeof h.addAttachment)throw new c("invalid-layer",
"addAttachment(): A valid layer is required.");u=h.addAttachment(v,a).then(function(a){return w._queryAttachment(a.objectId)});return[4,u];case 1:return r=b.sent(),f.add(r),[2,r]}})})};r.prototype.deleteAttachment=function(a){return q(this,void 0,void 0,function(){var m,h,f,v,C,u,r;return b(this,function(b){switch(b.label){case 0:m=this;h=m._attachmentLayer;f=m.attachmentInfos;v=m.graphic;C=m.abilities;if(!a)throw new c("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",
{attachmentInfo:a});if(!C.operations.delete)throw new c("invalid-abilities","deleteAttachment(): delete abilities are required.");if(!h||"function"!==typeof h.deleteAttachments)throw new c("invalid-layer","deleteAttachment(): A valid layer is required.");u=h.deleteAttachments(v,[a.id]).then(function(){return a});return[4,u];case 1:return r=b.sent(),f.remove(r),[2,r]}})})};r.prototype.updateAttachment=function(a,m){void 0===m&&(m=this.activeAttachmentInfo);return q(this,void 0,void 0,function(){var h,
f,v,C,u,r,w,l,d=this;return b(this,function(b){switch(b.label){case 0:h=this;f=h._attachmentLayer;v=h.attachmentInfos;C=h.graphic;u=h.abilities;if(!a)throw new c("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:a});if(!m)throw new c("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:m});if(!u.operations.update)throw new c("invalid-abilities","updateAttachment(): Update abilities are required.");r=v.findIndex(function(a){return a===
m});if(!f||"function"!==typeof f.updateAttachment)throw new c("invalid-layer","updateAttachment(): A valid layer is required.");w=f.updateAttachment(C,m.id,a).then(function(a){return d._queryAttachment(a.objectId)});return[4,w];case 1:return l=b.sent(),v.splice(r,1,l),[2,l]}})})};r.prototype._queryAttachment=function(a){return q(this,void 0,void 0,function(){var m,h,f;return b(this,function(b){if(!a)throw new c("invalid-attachment-id","Could not query attachment.");m=this._attachmentLayer;h=this._getFeatureId();
f=new w({objectIds:[h],attachmentsWhere:"AttachmentId\x3d"+a,returnMetadata:!0});return[2,m.queryAttachments(f).then(function(a){return a[h][0]})]})})};r.prototype._getFeatureId=function(){var a=this._attachmentLayer,c=this.graphic;if(!a||!c)return null;a=a.objectIdField;return(c=c.attributes)&&c[a]};r.prototype._graphicChanged=function(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch(function(){}))};r.prototype._setAttachmentLayer=function(){var a=v.getSourceLayer(this.graphic);
this._attachmentLayer=a?"scene"===a.type&&a.associatedLayer?a.associatedLayer:a:null};l([u.property()],r.prototype,"abilities",void 0);l([u.cast("abilities")],r.prototype,"castAbilities",null);l([u.property()],r.prototype,"activeAttachmentInfo",void 0);l([u.property({readOnly:!0,type:C})],r.prototype,"attachmentInfos",void 0);l([u.property({type:h})],r.prototype,"graphic",void 0);l([u.property()],r.prototype,"mode",void 0);l([u.property({dependsOn:["graphic"],readOnly:!0})],r.prototype,"state",null);
l([u.property({readOnly:!0,dependsOn:["graphic","graphic.layer","graphic.layer.loaded","graphic.layer.capabilities.operations.supportsResizeAttachments"]})],r.prototype,"supportsResizeAttachments",null);return r=l([u.subclass("esri.widgets.Attachments.AttachmentsViewModel")],r)}(u.declared(a.HandleOwner))})},"esri/widgets/Feature/support/featureUtils":function(){define(["require","exports"],function(z,d){Object.defineProperty(d,"__esModule",{value:!0});d.getSourceLayer=function(d){if(d)return d.get("sourceLayer")||
d.get("layer")}})},"esri/widgets/Attachments/support/attachmentUtils":function(){define(["require","exports"],function(z,d){Object.defineProperty(d,"__esModule",{value:!0});var t=z.toUrl("../../../themes/base/images/files/");d.isSupportedImage=function(l){l=l.toLowerCase();return"image/bmp"===l||"image/emf"===l||"image/exif"===l||"image/gif"===l||"image/x-icon"===l||"image/jpeg"===l||"image/png"===l||"image/tiff"===l||"image/x-wmf"===l};d.getIconPath=function(l){return l?"text/plain"===l?t+"text-32.svg":
"application/pdf"===l?t+"pdf-32.svg":"text/csv"===l?t+"csv-32.svg":"application/gpx+xml"===l?t+"gpx-32.svg":"application/x-dwf"===l?t+"cad-32.svg":"application/postscript"===l||"application/json"===l||"text/xml"===l||"model/vrml"===l?t+"code-32.svg":"application/x-zip-compressed"===l||"application/x-7z-compressed"===l||"application/x-gzip"===l||"application/x-tar"===l||"application/x-gtar"===l||"application/x-bzip2"===l||"application/gzip"===l||"application/x-compress"===l||"application/x-apple-diskimage"===
l||"application/x-rar-compressed"===l||"application/zip"===l?t+"zip-32.svg":-1!==l.indexOf("image/")?t+"image-32.svg":-1!==l.indexOf("audio/")?t+"sound-32.svg":-1!==l.indexOf("video/")?t+"video-32.svg":-1!==l.indexOf("msexcel")||-1!==l.indexOf("ms-excel")||-1!==l.indexOf("spreadsheetml")?t+"excel-32.svg":-1!==l.indexOf("msword")||-1!==l.indexOf("ms-word")||-1!==l.indexOf("wordprocessingml")?t+"word-32.svg":-1!==l.indexOf("powerpoint")||-1!==l.indexOf("presentationml")?t+"report-32.svg":t+"generic-32.svg":
t+"generic-32.svg"}})},"esri/widgets/FeatureForm":function(){define("require exports ../core/tsSupport/assignHelper ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/i18n!./FeatureForm/nls/FeatureForm dojo/date/locale ../moment ../core/accessorSupport/decorators ../layers/support/domains ../layers/support/fieldUtils ./Widget ./FeatureForm/FeatureFormViewModel ./support/widget".split(" "),function(z,d,t,l,q,b,f,h,r,c,a,m,u,D){var w={datePattern:"M/d/y",timePattern:"h:mm:ss a"};
return function(m){function v(a){a=m.call(this,a)||this;a._fieldFocusNeeded=!1;a._activeDateEdit=null;a._activeInputName=null;a.feature=null;a.fieldConfig=null;a.groupDisplay="all";a.label=b.widgetLabel;a.layer=null;a.strict=null;a.viewModel=new u;a._handleFormKeyDown=a._handleFormKeyDown.bind(a);a._handleInputBlur=a._handleInputBlur.bind(a);a._handleInputFocus=a._handleInputFocus.bind(a);a._handleNumberInputMouseDown=a._handleNumberInputMouseDown.bind(a);a._handleInputKeyDown=a._handleInputKeyDown.bind(a);
a._handleOptionChange=a._handleOptionChange.bind(a);a._handleGroupClick=a._handleGroupClick.bind(a);a._handleSubmit=a._handleSubmit.bind(a);a._afterScrollerCreateOrUpdate=a._afterScrollerCreateOrUpdate.bind(a);return a}l(v,m);v.prototype.postInitialize=function(){var a=this;this.own(this.watch("feature",function(){var c=a._getFocusableInput("forward");a._activeInputName=c&&c.name;a._fieldFocusNeeded=!0}),this.on("submit",function(c){0<c.invalid.length&&(a._activeInputName=c.invalid[0],a._fieldFocusNeeded=
!0,a.scheduleRender())}))};v.prototype.getValues=function(){return null};v.prototype.submit=function(){return null};v.prototype.render=function(){var a=this.viewModel.state;return D.tsx("div",{class:this.classes("esri-feature-form","esri-widget","esri-widget--panel")},"ready"===a?this.renderForm():null)};v.prototype.renderForm=function(){return D.tsx("form",{class:"esri-feature-form__form",novalidate:!0,onsubmit:this._handleSubmit,onkeydown:this._handleFormKeyDown},this.renderFields())};v.prototype.renderFields=
function(){var a=this;return this.viewModel.inputFields.map(function(c,m){return c&&c.inputFields?a.renderGroup(c,m):a.renderLabeledField(c)})};v.prototype.renderGroup=function(a,c){var m=this,b=a.description,h=a.label,v=a.inputFields,f=this.viewModel.findField(this._activeInputName),f=f&&f.group===a,u=this.id+"_group_"+c,r=this.id+"_group-label_"+c,C=this.id+"_group-description_"+c,w=b?D.tsx("p",{class:this.classes("esri-feature-form__group-description","esri-feature-form__description-text"),id:C},
b):null,l="sequential"===this.groupDisplay,d=l?f?"true":"false":void 0;return D.tsx("fieldset",{class:this.classes("esri-feature-form__group",l?"esri-feature-form__group--sequential":null,!l||f?null:"esri-feature-form__group--collapsed",f?"esri-feature-form__group--active":null),"aria-expanded":d,"aria-labelledby":r,"aria-describedby":b?C:"","data-group":a,id:u,key:c,onclick:this._handleGroupClick},D.tsx("div",{class:"esri-feature-form__group-label",id:r},h),w,v.map(function(a){return m.renderLabeledField(a)}))};
v.prototype._getFocusableInput=function(a,c){var m=this.viewModel._allInputFields;a="forward"===a?m:m.slice().reverse();for(c=c?a.indexOf(c)+1:0;c<a.length;c++)if(m=a[c],m.visible&&m.editable)return m;return null};v.prototype.renderLabeledField=function(a){return D.tsx("label",{key:a.layer.id+"-"+a.name,class:"esri-feature-form__label"},[a.label,"unsupported"!==a.type?this.renderInputField(a):this.renderUnsupportedField(a),this.renderAuxiliaryText(a)])};v.prototype.renderInputField=function(a){var c=
a.domain,m=a.editable,b=a.type,h=this.viewModel.getValue(a.name),m=!m,v=this.getCommonInputProps(a);return c&&"coded-value"===c.type&&!m?this.renderSelectInputField(h,c.codedValues.map(function(a){return{value:a.code,name:a.name}}),v):"text"===b&&"text-area"===a.editorType||"rich-text"===a.editorType?D.tsx("textarea",t({},v)):"date"===b?this.renderDateInputField(h,v):D.tsx("input",t({type:"text"===b?"text":"number"},v))};v.prototype.renderDateInputField=function(a,c){var m=this._formatDate(0),b=m.date,
m=m.time,h=this.id+"-"+c.key,v=h+"-date",h=h+"-time",f=c["data-field"];return D.tsx("div",{key:c.key+"-date",class:"esri-feature-form__date-input-container"},D.tsx("div",{class:"esri-feature-form__date-input-part"},D.tsx("input",t({"aria-label":f.label,"aria-describedby":v,type:"text"},c,{"data-date-part":"date",class:this.classes(c.class,"esri-feature-form__input--date"),value:this._formatDate(a).date})),D.tsx("div",{class:"esri-feature-form__date-format-hint",id:v},b)),D.tsx("div",{class:"esri-feature-form__date-input-part"},
D.tsx("input",t({"aria-describedby":h,"aria-label":f.label,type:"text"},c,{"data-date-part":"time",class:this.classes(c.class,"esri-feature-form__input--time"),value:this._formatDate(a).time})),D.tsx("div",{class:"esri-feature-form__date-format-hint",id:h},m)))};v.prototype.renderUnsupportedField=function(a){a=this.viewModel.getValue(a.name);return D.tsx("input",{class:this.classes("esri-input","esri-feature-form__input","esri-feature-form__input--disabled"),disabled:!0,type:"text",value:""+a})};
v.prototype.renderSelectInputField=function(a,c,m){var b=!1;c=c.map(function(c){c.value===a&&(b=!0);return D.tsx("option",{value:""+c.value,key:c.name},c.name)});null==a||""===a||b||c.unshift(D.tsx("option",{value:""+a,key:"outlier-option"},a));var h=m["data-field"];h.required||null!=h.value||c.unshift(D.tsx("option",{value:"",key:"empty-option"}));return D.tsx("select",t({},m,{class:this.classes(m.class,"esri-select"),onchange:this._handleOptionChange}),c)};v.prototype.renderAuxiliaryText=function(a){if(!a.valid)return D.tsx("div",
{key:"error-message"},D.tsx("span",{class:this.classes("esri-feature-form__input-icon--invalid","esri-icon-notice-triangle")}),D.tsx("div",{class:"esri-feature-form__field-error-message"},a.errorMessage));if(a.valid&&a.description)return D.tsx("div",{key:"description",class:"esri-feature-form__description-text"},a.description)};v.prototype.getCommonInputProps=function(a){var c=a.editable,m=a.name,b=a.required,h=a.maxLength,v=a.hint,f=a.type,u=a.valid,r=this.viewModel.getValue(m),c=!c;return t({afterCreate:this._afterScrollerCreateOrUpdate,
afterUpdate:this._afterScrollerCreateOrUpdate,"aria-invalid":u?"false":"true",class:this.classes("esri-input","esri-feature-form__input",c?"esri-feature-form__input--disabled":null,u?null:"esri-feature-form__input--invalid"),key:m,maxlength:-1<h?""+h:""},this._getNumberFieldConstraints(a),{disabled:c,value:null==r?"":""+r,"data-field":a,onfocus:this._handleInputFocus,onblur:this._handleInputBlur,onkeydown:this._handleInputKeyDown,onmousedown:"number"===f?this._handleNumberInputMouseDown:null,required:b,
title:v})};v.prototype._handleNumberInputMouseDown=function(a){a=a.target;a.disabled||a.focus();this.scheduleRender()};v.prototype._getNumberFieldConstraints=function(m){return(m=c.getDomainRange(m.domain)||a.getFieldRange(m.field))&&m.max!==Number.MAX_VALUE&&m.min!==Number.MIN_VALUE?m:{min:null,max:null}};v.prototype._afterScrollerCreateOrUpdate=function(a){var c=a["data-field"],m=this.viewModel.findField(this._activeInputName);c.editable&&this._fieldFocusNeeded&&m===c&&(this._fieldFocusNeeded=!1,
a.focus())};v.prototype._handleInputFocus=function(a){this._activeInputName=a.target["data-field"].name};v.prototype._handleInputBlur=function(a){var c,m=a.target,b=m["data-field"],h=(a=a.relatedTarget)&&a["data-field"];if("date"===b.type){var v=m.getAttribute("data-date-part");this._activeDateEdit=t({},this._activeDateEdit,(c={},c[v]={value:m.value,input:m},c))}h&&"date"===b.type&&"date"===h.type&&b.field===h.field?""!==m.value&&""===a.value&&(v=a.getAttribute("data-date-part"),a.value=this._formatDate(Date.now())[v]):
(this._commitValue(m),this.scheduleRender())};v.prototype._commitValue=function(a){var c=a["data-field"];if(this._activeDateEdit){var m=this._activeDateEdit;a=m.date;var m=m.time,b=this._getDateEditValue(c,"date"),c=this._getDateEditValue(c,"time"),h=""===b||""===c;a&&(a=a.input,a.value=h?"":b,this._updateFieldValue(a));m&&(a=m.input,a.value=h?"":c,this._updateFieldValue(a));this._activeDateEdit=null}else this._updateFieldValue(a)};v.prototype._getDateEditValue=function(a,c){var m=this._activeDateEdit[c];
if(m)return""===m.value?"":(m=this._parseDate(m.value,c))?this._formatDate(m.getTime())[c]:this._formatDate(a.value)[c]};v.prototype._handleInputKeyDown=function(a){var c=a.key,m=a.altKey,b=a.ctrlKey,h=a.metaKey,v=a.shiftKey;if("Tab"===c){var f=a.target,u=f["data-field"],c=v?"backward":"forward",m=f.getAttribute("data-date-part");"backward"===c&&"time"===m||"forward"===c&&"date"===m||(this._commitValue(f),m=this.viewModel.findField(u.name),this._activeInputName=(c=this._getFocusableInput(c,m))&&c.name,
c?(a.preventDefault(),this._fieldFocusNeeded=!0):this.renderNow())}else"Enter"!==c?(f=a.target,u=f["data-field"],u=u.field.type,f="single"===u||"double"===u,"integer"!==u&&"small-integer"!==u&&!f||m||b||h||1!==c.length||(m=Number(c),b=["-","+"],h=["e","."],b=f?b.concat(h):b,isNaN(m)&&-1===b.indexOf(c)&&a.preventDefault())):(this._updateFieldValue(a.target),this.scheduleRender())};v.prototype._updateFieldValue=function(a){this.viewModel.setValue(a["data-field"].name,this._parseValue(a))};v.prototype._parseValue=
function(a){var c=a["data-field"],m=a.value,b=c.type;if(!c.required&&""===m)return null;if("number"===b)return parseFloat(m);if("date"===b){if(!m)return null;a=a.getAttribute("data-date-part");b=Number(m);if(!isNaN(b))return b;m=this._parseDate(m,a);if(!m)return null;var m=h(m),v=c.domain,f=h(),b=f;v&&"range"===v.type&&(v=h(v.maxValue),f.isAfter(v)||(b=v));c=this.viewModel.getValue(c.name);c=h(null!=c?c:b);"date"===a?(m.hour(c.hour()),m.minutes(c.minutes()),m.seconds(c.seconds())):(m.date(c.date()),
m.month(c.month()),m.year(c.year()));return m.valueOf()}return m};v.prototype._handleOptionChange=function(a){this._updateFieldValue(a.target);this.scheduleRender()};v.prototype._handleGroupClick=function(a){a=a.currentTarget;"false"===a.getAttribute("aria-expanded")&&(this._activeInputName=a["data-group"].inputFields[0].name,this._fieldFocusNeeded=!0,this.scheduleRender())};v.prototype._handleSubmit=function(a){a.preventDefault()};v.prototype._handleFormKeyDown=function(a){"Enter"===a.key&&this.viewModel.submit()};
v.prototype._formatDate=function(a){if(null==a)return{date:"",time:""};a=new Date(a);return{date:f.format(a,t({selector:"date"},w)),time:f.format(a,t({selector:"time"},w))}};v.prototype._parseDate=function(a,c){return null==a||""===a?null:f.parse(a,t({selector:c},w))};q([r.aliasOf("viewModel.feature")],v.prototype,"feature",void 0);q([r.aliasOf("viewModel.fieldConfig")],v.prototype,"fieldConfig",void 0);q([r.property(),D.renderable()],v.prototype,"groupDisplay",void 0);q([r.property()],v.prototype,
"label",void 0);q([r.aliasOf("viewModel.layer")],v.prototype,"layer",void 0);q([r.aliasOf("viewModel.strict")],v.prototype,"strict",void 0);q([r.property(),D.renderable(["viewModel.inputFields","viewModel.state"]),D.vmEvent(["value-change","submit"])],v.prototype,"viewModel",void 0);q([r.aliasOf("viewModel.getValues")],v.prototype,"getValues",null);q([r.aliasOf("viewModel.submit")],v.prototype,"submit",null);return v=q([r.subclass("esri.widgets.FeatureForm")],v)}(r.declared(m))})},"dojo/date/locale":function(){define("../_base/lang ../_base/array ../date ../cldr/supplemental ../i18n ../regexp ../string ../i18n!../cldr/nls/gregorian module".split(" "),
function(z,d,t,l,q,b,f,h,r){function c(a,c,m,b){return b.replace(/([a-z])\1*/ig,function(h){var v,r,w=h.charAt(0);h=h.length;var C=["abbr","wide","narrow"];switch(w){case "G":v=c[4>h?"eraAbbr":"eraNames"][0>a.getFullYear()?0:1];break;case "y":v=a.getFullYear();switch(h){case 1:break;case 2:if(!m.fullYear){v=String(v);v=v.substr(v.length-2);break}default:r=!0}break;case "Q":case "q":v=Math.ceil((a.getMonth()+1)/3);r=!0;break;case "M":case "L":v=a.getMonth();3>h?(v+=1,r=!0):(w=["months","L"==w?"standAlone":
"format",C[h-3]].join("-"),v=c[w][v]);break;case "w":v=u._getWeekOfYear(a,0);r=!0;break;case "d":v=a.getDate();r=!0;break;case "D":v=u._getDayOfYear(a);r=!0;break;case "e":case "c":if(v=a.getDay(),2>h){v=(v-l.getFirstDayOfWeek(m.locale)+8)%7;break}case "E":v=a.getDay();3>h?(v+=1,r=!0):(w=["days","c"==w?"standAlone":"format",C[h-3]].join("-"),v=c[w][v]);break;case "a":w=12>a.getHours()?"am":"pm";v=m[w]||c["dayPeriods-format-wide-"+w];break;case "h":case "H":case "K":case "k":r=a.getHours();switch(w){case "h":v=
r%12||12;break;case "H":v=r;break;case "K":v=r%12;break;case "k":v=r||24}r=!0;break;case "m":v=a.getMinutes();r=!0;break;case "s":v=a.getSeconds();r=!0;break;case "S":v=Math.round(a.getMilliseconds()*Math.pow(10,h-3));r=!0;break;case "v":case "z":if(v=u._getZone(a,!0,m))break;h=4;case "Z":w=u._getZone(a,!1,m);w=[0>=w?"+":"-",f.pad(Math.floor(Math.abs(w)/60),2),f.pad(Math.abs(w)%60,2)];4==h&&(w.splice(0,0,"GMT"),w.splice(3,0,":"));v=w.join("");break;default:throw Error("dojo.date.locale.format: invalid pattern char: "+
b);}r&&(v=f.pad(v,h));return v})}function a(a,c,m,b){var h=function(a){return a};c=c||h;m=m||h;b=b||h;var v=a.match(/(''|[^'])+/g),f="'"==a.charAt(0);d.forEach(v,function(a,b){a?(v[b]=(f?m:c)(a.replace(/''/g,"'")),f=!f):v[b]=""});return b(v.join(""))}function m(a,c,m,h){h=b.escapeString(h);m.strict||(h=h.replace(" a"," ?a"));return h.replace(/([a-z])\1*/ig,function(b){var h;h=b.charAt(0);var v=b.length,f="",u="";m.strict?(1<v&&(f="0{"+(v-1)+"}"),2<v&&(u="0{"+(v-2)+"}")):(f="0?",u="0{0,2}");switch(h){case "y":h=
"\\d{2,4}";break;case "M":case "L":2<v?(h=c["months-"+("L"==h?"standAlone":"format")+"-"+D[v-3]].slice(0).join("|"),m.strict||(h=h.replace(/\./g,""),h="(?:"+h+")\\.?")):h="1[0-2]|"+f+"[1-9]";break;case "D":h="[12][0-9][0-9]|3[0-5][0-9]|36[0-6]|"+f+"[1-9][0-9]|"+u+"[1-9]";break;case "d":h="3[01]|[12]\\d|"+f+"[1-9]";break;case "w":h="[1-4][0-9]|5[0-3]|"+f+"[1-9]";break;case "E":case "e":case "c":h=".+?";break;case "h":h="1[0-2]|"+f+"[1-9]";break;case "k":h="1[01]|"+f+"\\d";break;case "H":h="1\\d|2[0-3]|"+
f+"\\d";break;case "K":h="1\\d|2[0-4]|"+f+"[1-9]";break;case "m":case "s":h="[0-5]\\d";break;case "S":h="\\d{"+v+"}";break;case "a":v=m.am||c["dayPeriods-format-wide-am"];f=m.pm||c["dayPeriods-format-wide-pm"];h=v+"|"+f;m.strict||(v!=v.toLowerCase()&&(h+="|"+v.toLowerCase()),f!=f.toLowerCase()&&(h+="|"+f.toLowerCase()),-1!=h.indexOf(".")&&(h+="|"+h.replace(/\./g,"")));h=h.replace(/\./g,"\\.");break;default:h=".*"}a&&a.push(b);return"("+h+")"}).replace(/[\xa0 ]/g,"[\\s\\xa0]")}var u={};z.setObject(r.id.replace(/\//g,
"."),u);u._getZone=function(a,c,m){return c?t.getTimezoneName(a):a.getTimezoneOffset()};u.format=function(m,b){b=b||{};var h=q.normalizeLocale(b.locale),v=b.formatLength||"short",h=u._getGregorianBundle(h),f=[];m=z.hitch(this,c,m,h,b);if("year"==b.selector)return a(h["dateFormatItem-yyyy"]||"yyyy",m);var r;"date"!=b.selector&&(r=b.timePattern||h["timeFormat-"+v])&&f.push(a(r,m));"time"!=b.selector&&(r=b.datePattern||h["dateFormat-"+v])&&f.push(a(r,m));return 1==f.length?f[0]:h["dateTimeFormat-"+v].replace(/\'/g,
"").replace(/\{(\d+)\}/g,function(a,c){return f[c]})};u.regexp=function(a){return u._parseInfo(a).regexp};u._parseInfo=function(c){c=c||{};var b=q.normalizeLocale(c.locale),b=u._getGregorianBundle(b),h=c.formatLength||"short",v=c.datePattern||b["dateFormat-"+h],f=c.timePattern||b["timeFormat-"+h],h="date"==c.selector?v:"time"==c.selector?f:b["dateTimeFormat-"+h].replace(/\{(\d+)\}/g,function(a,c){return[f,v][c]}),r=[];return{regexp:a(h,z.hitch(this,m,r,b,c)),tokens:r,bundle:b}};u.parse=function(a,
c){var m=/[\u200E\u200F\u202A\u202E]/g,b=u._parseInfo(c),h=b.tokens,v=b.bundle;a=(new RegExp("^"+b.regexp.replace(m,"")+"$",b.strict?"":"i")).exec(a&&a.replace(m,""));if(!a)return null;var f=["abbr","wide","narrow"],r=[1970,0,1,0,0,0,0],w="";a=d.every(a,function(a,m){if(!m)return!0;var b=h[m-1];m=b.length;b=b.charAt(0);switch(b){case "y":if(2!=m&&c.strict)r[0]=a;else if(100>a)a=Number(a),b=""+(new Date).getFullYear(),m=100*b.substring(0,2),b=Math.min(Number(b.substring(2,4))+20,99),r[0]=a<b?m+a:m-
100+a;else{if(c.strict)return!1;r[0]=a}break;case "M":case "L":if(2<m){if(m=v["months-"+("L"==b?"standAlone":"format")+"-"+f[m-3]].concat(),c.strict||(a=a.replace(".","").toLowerCase(),m=d.map(m,function(a){return a.replace(".","").toLowerCase()})),a=d.indexOf(m,a),-1==a)return!1}else a--;r[1]=a;break;case "E":case "e":case "c":m=v["days-"+("c"==b?"standAlone":"format")+"-"+f[m-3]].concat();c.strict||(a=a.toLowerCase(),m=d.map(m,function(a){return a.toLowerCase()}));a=d.indexOf(m,a);if(-1==a)return!1;
break;case "D":r[1]=0;case "d":r[2]=a;break;case "a":m=c.am||v["dayPeriods-format-wide-am"];b=c.pm||v["dayPeriods-format-wide-pm"];if(!c.strict){var u=/\./g;a=a.replace(u,"").toLowerCase();m=m.replace(u,"").toLowerCase();b=b.replace(u,"").toLowerCase()}if(c.strict&&a!=m&&a!=b)return!1;w=a==b?"p":a==m?"a":"";break;case "K":24==a&&(a=0);case "h":case "H":case "k":if(23<a)return!1;r[3]=a;break;case "m":r[4]=a;break;case "s":r[5]=a;break;case "S":r[6]=a}return!0});m=+r[3];"p"===w&&12>m?r[3]=m+12:"a"===
w&&12==m&&(r[3]=0);m=new Date(r[0],r[1],r[2],r[3],r[4],r[5],r[6]);c.strict&&m.setFullYear(r[0]);var C=h.join(""),b=-1!=C.indexOf("d"),C=-1!=C.indexOf("M");if(!a||C&&m.getMonth()>r[1]||b&&m.getDate()>r[2])return null;if(C&&m.getMonth()<r[1]||b&&m.getDate()<r[2])m=t.add(m,"hour",1);return m};var D=["abbr","wide","narrow"],w=[],v={};u.addCustomFormats=function(a,c){w.push({pkg:a,name:c});v={}};u._getGregorianBundle=function(a){if(v[a])return v[a];var c={};d.forEach(w,function(m){m=q.getLocalization(m.pkg,
m.name,a);c=z.mixin(c,m)},this);return v[a]=c};u.addCustomFormats(r.id.replace(/\/date\/locale$/,".cldr"),"gregorian");u.getNames=function(a,c,m,b){var h;b=u._getGregorianBundle(b);a=[a,m,c];"standAlone"==m&&(m=a.join("-"),h=b[m],1==h[0]&&(h=void 0));a[1]="format";return(h||b[a.join("-")]).concat()};u.isWeekend=function(a,c){c=l.getWeekend(c);a=(a||new Date).getDay();c.end<c.start&&(c.end+=7,a<c.start&&(a+=7));return a>=c.start&&a<=c.end};u._getDayOfYear=function(a){return t.difference(new Date(a.getFullYear(),
0,1,a.getHours()),a)+1};u._getWeekOfYear=function(a,c){1==arguments.length&&(c=0);var m=(new Date(a.getFullYear(),0,1)).getDay(),b=(m-c+7)%7,b=Math.floor((u._getDayOfYear(a)+b-1)/7);m==c&&b++;return b};return u})},"dojo/date":function(){define(["./has","./_base/lang"],function(z,d){var t={getDaysInMonth:function(l){var d=l.getMonth();return 1==d&&t.isLeapYear(l)?29:[31,28,31,30,31,30,31,31,30,31,30,31][d]},isLeapYear:function(l){l=l.getFullYear();return!(l%400)||!(l%4)&&!!(l%100)},getTimezoneName:function(l){var d=
l.toString(),b="",f=d.indexOf("(");if(-1<f)b=d.substring(++f,d.indexOf(")"));else if(f=/([A-Z\/]+) \d{4}$/,d=d.match(f))b=d[1];else if(d=l.toLocaleString(),f=/ ([A-Z\/]+)$/,d=d.match(f))b=d[1];return"AM"==b||"PM"==b?"":b},compare:function(l,d,b){l=new Date(+l);d=new Date(+(d||new Date));"date"==b?(l.setHours(0,0,0,0),d.setHours(0,0,0,0)):"time"==b&&(l.setFullYear(0,0,0),d.setFullYear(0,0,0));return l>d?1:l<d?-1:0},add:function(l,d,b){var f=new Date(+l),h=!1,r="Date";switch(d){case "day":break;case "weekday":var c;
(d=b%5)?c=parseInt(b/5):(d=0<b?5:-5,c=0<b?(b-5)/5:(b+5)/5);var a=l.getDay(),m=0;6==a&&0<b?m=1:0==a&&0>b&&(m=-1);a+=d;if(0==a||6==a)m=0<b?2:-2;b=7*c+d+m;break;case "year":r="FullYear";h=!0;break;case "week":b*=7;break;case "quarter":b*=3;case "month":h=!0;r="Month";break;default:r="UTC"+d.charAt(0).toUpperCase()+d.substring(1)+"s"}if(r)f["set"+r](f["get"+r]()+b);h&&f.getDate()<l.getDate()&&f.setDate(0);return f},difference:function(l,d,b){d=d||new Date;b=b||"day";var f=d.getFullYear()-l.getFullYear(),
h=1;switch(b){case "quarter":l=l.getMonth();d=d.getMonth();h=Math.floor(d/3)+1+4*f-(Math.floor(l/3)+1);break;case "weekday":f=Math.round(t.difference(l,d,"day"));b=parseInt(t.difference(l,d,"week"));if(0==f%7)f=5*b;else{var h=0,r=l.getDay(),c=d.getDay();b=parseInt(f/7);d=f%7;l=new Date(l);l.setDate(l.getDate()+7*b);l=l.getDay();if(0<f)switch(!0){case 6==r:h=-1;break;case 0==r:h=0;break;case 6==c:h=-1;break;case 0==c:h=-2;break;case 5<l+d:h=-2}else if(0>f)switch(!0){case 6==r:h=0;break;case 0==r:h=
1;break;case 6==c:h=2;break;case 0==c:h=1;break;case 0>l+d:h=2}f=f+h-2*b}h=f;break;case "year":h=f;break;case "month":h=d.getMonth()-l.getMonth()+12*f;break;case "week":h=parseInt(t.difference(l,d,"day")/7);break;case "day":h/=24;case "hour":h/=60;case "minute":h/=60;case "second":h/=1E3;case "millisecond":h*=d.getTime()-l.getTime()}return Math.round(h)}};d.mixin(d.getObject("dojo.date",!0),t);return t})},"dojo/cldr/supplemental":function(){define(["../_base/lang","../i18n"],function(z,d){var t={};
z.setObject("dojo.cldr.supplemental",t);t.getFirstDayOfWeek=function(l){l={bd:5,mv:5,ae:6,af:6,bh:6,dj:6,dz:6,eg:6,iq:6,ir:6,jo:6,kw:6,ly:6,ma:6,om:6,qa:6,sa:6,sd:6,sy:6,ye:6,ag:0,ar:0,as:0,au:0,br:0,bs:0,bt:0,bw:0,by:0,bz:0,ca:0,cn:0,co:0,dm:0,"do":0,et:0,gt:0,gu:0,hk:0,hn:0,id:0,ie:0,il:0,"in":0,jm:0,jp:0,ke:0,kh:0,kr:0,la:0,mh:0,mm:0,mo:0,mt:0,mx:0,mz:0,ni:0,np:0,nz:0,pa:0,pe:0,ph:0,pk:0,pr:0,py:0,sg:0,sv:0,th:0,tn:0,tt:0,tw:0,um:0,us:0,ve:0,vi:0,ws:0,za:0,zw:0}[t._region(l)];return void 0===l?
1:l};t._region=function(l){l=d.normalizeLocale(l);l=l.split("-");var q=l[1];q?4==q.length&&(q=l[2]):q={aa:"et",ab:"ge",af:"za",ak:"gh",am:"et",ar:"eg",as:"in",av:"ru",ay:"bo",az:"az",ba:"ru",be:"by",bg:"bg",bi:"vu",bm:"ml",bn:"bd",bo:"cn",br:"fr",bs:"ba",ca:"es",ce:"ru",ch:"gu",co:"fr",cr:"ca",cs:"cz",cv:"ru",cy:"gb",da:"dk",de:"de",dv:"mv",dz:"bt",ee:"gh",el:"gr",en:"us",es:"es",et:"ee",eu:"es",fa:"ir",ff:"sn",fi:"fi",fj:"fj",fo:"fo",fr:"fr",fy:"nl",ga:"ie",gd:"gb",gl:"es",gn:"py",gu:"in",gv:"gb",
ha:"ng",he:"il",hi:"in",ho:"pg",hr:"hr",ht:"ht",hu:"hu",hy:"am",ia:"fr",id:"id",ig:"ng",ii:"cn",ik:"us","in":"id",is:"is",it:"it",iu:"ca",iw:"il",ja:"jp",ji:"ua",jv:"id",jw:"id",ka:"ge",kg:"cd",ki:"ke",kj:"na",kk:"kz",kl:"gl",km:"kh",kn:"in",ko:"kr",ks:"in",ku:"tr",kv:"ru",kw:"gb",ky:"kg",la:"va",lb:"lu",lg:"ug",li:"nl",ln:"cd",lo:"la",lt:"lt",lu:"cd",lv:"lv",mg:"mg",mh:"mh",mi:"nz",mk:"mk",ml:"in",mn:"mn",mo:"ro",mr:"in",ms:"my",mt:"mt",my:"mm",na:"nr",nb:"no",nd:"zw",ne:"np",ng:"na",nl:"nl",nn:"no",
no:"no",nr:"za",nv:"us",ny:"mw",oc:"fr",om:"et",or:"in",os:"ge",pa:"in",pl:"pl",ps:"af",pt:"br",qu:"pe",rm:"ch",rn:"bi",ro:"ro",ru:"ru",rw:"rw",sa:"in",sd:"in",se:"no",sg:"cf",si:"lk",sk:"sk",sl:"si",sm:"ws",sn:"zw",so:"so",sq:"al",sr:"rs",ss:"za",st:"za",su:"id",sv:"se",sw:"tz",ta:"in",te:"in",tg:"tj",th:"th",ti:"et",tk:"tm",tl:"ph",tn:"za",to:"to",tr:"tr",ts:"za",tt:"ru",ty:"pf",ug:"cn",uk:"ua",ur:"pk",uz:"uz",ve:"za",vi:"vn",wa:"be",wo:"sn",xh:"za",yi:"il",yo:"ng",za:"cn",zh:"cn",zu:"za",ace:"id",
ady:"ru",agq:"cm",alt:"ru",amo:"ng",asa:"tz",ast:"es",awa:"in",bal:"pk",ban:"id",bas:"cm",bax:"cm",bbc:"id",bem:"zm",bez:"tz",bfq:"in",bft:"pk",bfy:"in",bhb:"in",bho:"in",bik:"ph",bin:"ng",bjj:"in",bku:"ph",bqv:"ci",bra:"in",brx:"in",bss:"cm",btv:"pk",bua:"ru",buc:"yt",bug:"id",bya:"id",byn:"er",cch:"ng",ccp:"in",ceb:"ph",cgg:"ug",chk:"fm",chm:"ru",chp:"ca",chr:"us",cja:"kh",cjm:"vn",ckb:"iq",crk:"ca",csb:"pl",dar:"ru",dav:"ke",den:"ca",dgr:"ca",dje:"ne",doi:"in",dsb:"de",dua:"cm",dyo:"sn",dyu:"bf",
ebu:"ke",efi:"ng",ewo:"cm",fan:"gq",fil:"ph",fon:"bj",fur:"it",gaa:"gh",gag:"md",gbm:"in",gcr:"gf",gez:"et",gil:"ki",gon:"in",gor:"id",grt:"in",gsw:"ch",guz:"ke",gwi:"ca",haw:"us",hil:"ph",hne:"in",hnn:"ph",hoc:"in",hoj:"in",ibb:"ng",ilo:"ph",inh:"ru",jgo:"cm",jmc:"tz",kaa:"uz",kab:"dz",kaj:"ng",kam:"ke",kbd:"ru",kcg:"ng",kde:"tz",kdt:"th",kea:"cv",ken:"cm",kfo:"ci",kfr:"in",kha:"in",khb:"cn",khq:"ml",kht:"in",kkj:"cm",kln:"ke",kmb:"ao",koi:"ru",kok:"in",kos:"fm",kpe:"lr",krc:"ru",kri:"sl",krl:"ru",
kru:"in",ksb:"tz",ksf:"cm",ksh:"de",kum:"ru",lag:"tz",lah:"pk",lbe:"ru",lcp:"cn",lep:"in",lez:"ru",lif:"np",lis:"cn",lki:"ir",lmn:"in",lol:"cd",lua:"cd",luo:"ke",luy:"ke",lwl:"th",mad:"id",mag:"in",mai:"in",mak:"id",man:"gn",mas:"ke",mdf:"ru",mdh:"ph",mdr:"id",men:"sl",mer:"ke",mfe:"mu",mgh:"mz",mgo:"cm",min:"id",mni:"in",mnk:"gm",mnw:"mm",mos:"bf",mua:"cm",mwr:"in",myv:"ru",nap:"it",naq:"na",nds:"de","new":"np",niu:"nu",nmg:"cm",nnh:"cm",nod:"th",nso:"za",nus:"sd",nym:"tz",nyn:"ug",pag:"ph",pam:"ph",
pap:"bq",pau:"pw",pon:"fm",prd:"ir",raj:"in",rcf:"re",rej:"id",rjs:"np",rkt:"in",rof:"tz",rwk:"tz",saf:"gh",sah:"ru",saq:"ke",sas:"id",sat:"in",saz:"in",sbp:"tz",scn:"it",sco:"gb",sdh:"ir",seh:"mz",ses:"ml",shi:"ma",shn:"mm",sid:"et",sma:"se",smj:"se",smn:"fi",sms:"fi",snk:"ml",srn:"sr",srr:"sn",ssy:"er",suk:"tz",sus:"gn",swb:"yt",swc:"cd",syl:"bd",syr:"sy",tbw:"ph",tcy:"in",tdd:"cn",tem:"sl",teo:"ug",tet:"tl",tig:"er",tiv:"ng",tkl:"tk",tmh:"ne",tpi:"pg",trv:"tw",tsg:"ph",tts:"th",tum:"mw",tvl:"tv",
twq:"ne",tyv:"ru",tzm:"ma",udm:"ru",uli:"fm",umb:"ao",unr:"in",unx:"in",vai:"lr",vun:"tz",wae:"ch",wal:"et",war:"ph",xog:"ug",xsr:"np",yao:"mz",yap:"fm",yav:"cm",zza:"tr"}[l[0]];return q};t.getWeekend=function(l){var d=t._region(l);l={"in":0,af:4,dz:4,ir:4,om:4,sa:4,ye:4,ae:5,bh:5,eg:5,il:5,iq:5,jo:5,kw:5,ly:5,ma:5,qa:5,sd:5,sy:5,tn:5}[d];d={af:5,dz:5,ir:5,om:5,sa:5,ye:5,ae:6,bh:5,eg:6,il:6,iq:6,jo:6,kw:6,ly:6,ma:6,qa:6,sd:6,sy:6,tn:6}[d];void 0===l&&(l=6);void 0===d&&(d=0);return{start:l,end:d}};
return t})},"dojo/regexp":function(){define(["./_base/kernel","./_base/lang"],function(z,d){var t={};d.setObject("dojo.regexp",t);t.escapeString=function(l,d){return l.replace(/([\.$?*|{}\(\)\[\]\\\/\+\-^])/g,function(b){return d&&-1!=d.indexOf(b)?b:"\\"+b})};t.buildGroupRE=function(l,d,b){if(!(l instanceof Array))return d(l);for(var f=[],h=0;h<l.length;h++)f.push(d(l[h]));return t.group(f.join("|"),b)};t.group=function(d,q){return"("+(q?"?:":"")+d+")"};return t})},"dojo/string":function(){define(["./_base/kernel",
"./_base/lang"],function(z,d){var t=/[&<>'"\/]/g,l={"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#x27;","/":"\x26#x2F;"},q={};d.setObject("dojo.string",q);q.escape=function(b){return b?b.replace(t,function(b){return l[b]}):""};q.rep=function(b,f){if(0>=f||!b)return"";for(var h=[];;){f&1&&h.push(b);if(!(f>>=1))break;b+=b}return h.join("")};q.pad=function(b,f,h,r){h||(h="0");b=String(b);f=q.rep(h,Math.ceil((f-b.length)/h.length));return r?b+f:f+b};q.substitute=function(b,
f,h,r){r=r||z.global;h=h?d.hitch(r,h):function(c){return c};return b.replace(/\$\{([^\s\:\}]*)(?:\:([^\s\:\}]+))?\}/g,function(c,a,m){if(""==a)return"$";c=d.getObject(a,!1,f);m&&(c=d.getObject(m,!1,r).call(r,c,a));m=h(c,a);if("undefined"===typeof m)throw Error('string.substitute could not find key "'+a+'" in template');return m.toString()})};q.trim=String.prototype.trim?d.trim:function(b){b=b.replace(/^\s+/,"");for(var f=b.length-1;0<=f;f--)if(/\S/.test(b.charAt(f))){b=b.substring(0,f+1);break}return b};
return q})},"esri/moment":function(){define(["require","exports","./plugins/moment!"],function(z,d,t){return t})},"esri/plugins/moment":function(){define(["require","exports","../intl/moment"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});d.load=function(d,q,b){t.loadMoment().then(function(f){b(f)})}})},"esri/intl/moment":function(){define("require exports ../core/tsSupport/awaiterHelper ../core/tsSupport/generatorHelper ../core/MapUtils ./locale @dojo/framework/shim/Promise".split(" "),
function(z,d,t,l,q,b){Object.defineProperty(d,"__esModule",{value:!0});var f=q.MapFromValues([["ar",function(){return new Promise(function(b,f){z(["moment/locale/ar"],b,f)})}],["ar-dz",function(){return new Promise(function(b,f){z(["moment/locale/ar-dz"],b,f)})}],["ar-kw",function(){return new Promise(function(b,f){z(["moment/locale/ar-kw"],b,f)})}],["ar-ly",function(){return new Promise(function(b,f){z(["moment/locale/ar-ly"],b,f)})}],["ar-ma",function(){return new Promise(function(b,f){z(["moment/locale/ar-ma"],
b,f)})}],["ar-sa",function(){return new Promise(function(b,f){z(["moment/locale/ar-sa"],b,f)})}],["ar-tn",function(){return new Promise(function(b,f){z(["moment/locale/ar-tn"],b,f)})}],["bs",function(){return new Promise(function(b,f){z(["moment/locale/bs"],b,f)})}],["ca",function(){return new Promise(function(b,f){z(["moment/locale/ca"],b,f)})}],["cs",function(){return new Promise(function(b,f){z(["moment/locale/cs"],b,f)})}],["da",function(){return new Promise(function(b,f){z(["moment/locale/da"],
b,f)})}],["de",function(){return new Promise(function(b,f){z(["moment/locale/de"],b,f)})}],["de-at",function(){return new Promise(function(b,f){z(["moment/locale/de-at"],b,f)})}],["de-ch",function(){return new Promise(function(b,f){z(["moment/locale/de-ch"],b,f)})}],["el",function(){return new Promise(function(b,f){z(["moment/locale/el"],b,f)})}],["en-au",function(){return new Promise(function(b,f){z(["moment/locale/en-au"],b,f)})}],["en-ca",function(){return new Promise(function(b,f){z(["moment/locale/en-ca"],
b,f)})}],["en-gb",function(){return new Promise(function(b,f){z(["moment/locale/en-gb"],b,f)})}],["en-ie",function(){return new Promise(function(b,f){z(["moment/locale/en-ie"],b,f)})}],["en-il",function(){return new Promise(function(b,f){z(["moment/locale/en-il"],b,f)})}],["en-nz",function(){return new Promise(function(b,f){z(["moment/locale/en-nz"],b,f)})}],["es",function(){return new Promise(function(b,f){z(["moment/locale/es"],b,f)})}],["es-do",function(){return new Promise(function(b,f){z(["moment/locale/es-do"],
b,f)})}],["es-us",function(){return new Promise(function(b,f){z(["moment/locale/es-us"],b,f)})}],["et",function(){return new Promise(function(b,f){z(["moment/locale/et"],b,f)})}],["fi",function(){return new Promise(function(b,f){z(["moment/locale/fi"],b,f)})}],["fr",function(){return new Promise(function(b,f){z(["moment/locale/fr"],b,f)})}],["fr-ca",function(){return new Promise(function(b,f){z(["moment/locale/fr-ca"],b,f)})}],["fr-ch",function(){return new Promise(function(b,f){z(["moment/locale/fr-ch"],
b,f)})}],["he",function(){return new Promise(function(b,f){z(["moment/locale/he"],b,f)})}],["hr",function(){return new Promise(function(b,f){z(["moment/locale/hr"],b,f)})}],["hu",function(){return new Promise(function(b,f){z(["moment/locale/hu"],b,f)})}],["id",function(){return new Promise(function(b,f){z(["moment/locale/id"],b,f)})}],["it",function(){return new Promise(function(b,f){z(["moment/locale/it"],b,f)})}],["it-ch",function(){return new Promise(function(b,f){z(["moment/locale/it-ch"],b,f)})}],
["ja",function(){return new Promise(function(b,f){z(["moment/locale/ja"],b,f)})}],["ko",function(){return new Promise(function(b,f){z(["moment/locale/ko"],b,f)})}],["lt",function(){return new Promise(function(b,f){z(["moment/locale/lt"],b,f)})}],["lv",function(){return new Promise(function(b,f){z(["moment/locale/lv"],b,f)})}],["nb",function(){return new Promise(function(b,f){z(["moment/locale/nb"],b,f)})}],["nl",function(){return new Promise(function(b,f){z(["moment/locale/nl"],b,f)})}],["nl-be",
function(){return new Promise(function(b,f){z(["moment/locale/nl-be"],b,f)})}],["pl",function(){return new Promise(function(b,f){z(["moment/locale/pl"],b,f)})}],["pt",function(){return new Promise(function(b,f){z(["moment/locale/pt"],b,f)})}],["pt-br",function(){return new Promise(function(b,f){z(["moment/locale/pt-br"],b,f)})}],["ro",function(){return new Promise(function(b,f){z(["moment/locale/ro"],b,f)})}],["ru",function(){return new Promise(function(b,f){z(["moment/locale/ru"],b,f)})}],["sl",
function(){return new Promise(function(b,f){z(["moment/locale/sl"],b,f)})}],["sr",function(){return new Promise(function(b,f){z(["moment/locale/sr"],b,f)})}],["sr-cyrl",function(){return new Promise(function(b,f){z(["moment/locale/sr-cyrl"],b,f)})}],["sv",function(){return new Promise(function(b,f){z(["moment/locale/sv"],b,f)})}],["th",function(){return new Promise(function(b,f){z(["moment/locale/th"],b,f)})}],["tr",function(){return new Promise(function(b,f){z(["moment/locale/tr"],b,f)})}],["uk",
function(){return new Promise(function(b,f){z(["moment/locale/uk"],b,f)})}],["vi",function(){return new Promise(function(b,f){z(["moment/locale/vi"],b,f)})}],["zh-cn",function(){return new Promise(function(b,f){z(["moment/locale/zh-cn"],b,f)})}],["zh-hk",function(){return new Promise(function(b,f){z(["moment/locale/zh-hk"],b,f)})}],["zh-tw",function(){return new Promise(function(b,f){z(["moment/locale/zh-tw"],b,f)})}]]);d.loadMoment=function(h){void 0===h&&(h=b.getLocale());return t(this,void 0,void 0,
function(){var b,c,a;return l(this,function(m){switch(m.label){case 0:return[4,new Promise(function(a,c){z(["moment/moment"],a,c)})];case 1:return b=m.sent(),c=f.has(h),c||(a=h.split("-"),1<a.length&&f.has(a[0])&&(h=a[0],c=!0)),c?[4,f.get(h)()]:[3,3];case 2:return m.sent(),[3,4];case 3:h="en",m.label=4;case 4:return h!==b.locale()&&b.locale(h),[2,b]}})})}})},"esri/widgets/FeatureForm/FeatureFormViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../core/arrayUtils ../../core/Evented ../../core/HandleOwner ../../core/lang ../../core/ReentrantObjectPool ../../core/watchUtils ../../core/accessorSupport/decorators ../../core/accessorSupport/decorators/cast ../../support/arcadeOnDemand ./FieldConfig ./FieldGroupConfig ./InputField ./InputFieldGroup".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u,D,w,v,E,C,J){function K(a){return!!a.fieldConfig}return function(h){function r(c){c=h.call(this,c)||this;c._arcade=null;c._fieldPool=new a.ReentrantObjectPool(C);c._fieldGroupPool=new a.ReentrantObjectPool(J);c._featureClone=null;c._needsArcade=!1;c.fieldConfig=null;c.strict=!1;return c}t(r,h);r.prototype.initialize=function(){var a=this,c=m.init(this,"fieldConfig",function(m){return b(a,void 0,void 0,function(){var a,b,f,v,h;return q(this,function(u){switch(u.label){case 0:return a=
[],m&&m.forEach(function(c){c.visibilityExpression&&a.push(c.visibilityExpression);c.fieldConfig&&c.fieldConfig.forEach(function(c){(c=c.visibilityExpression)&&a.push(c)})}),(b=0<a.length)?[4,w.loadArcade()]:[3,4];case 1:return f=u.sent(),v=f.arcadeUtils,(h=a.some(function(a){return v.hasGeometryOperations(a)}))?[4,v.enableGeometryOperations()]:[3,3];case 2:u.sent(),c.remove(),u.label=3;case 3:this._arcade=f,this.notifyChange("inputFields"),u.label=4;case 4:return this._needsArcade=b,[2]}})})});this.handles.add(c)};
r.prototype.destroy=function(){this.layer=this.feature=this.fieldConfig=null;this._fieldPool.destroy();this._fieldGroupPool.destroy()};Object.defineProperty(r.prototype,"_allInputFields",{get:function(){return this.inputFields.reduce(function(a,c){return c.inputFields?a.concat(c.inputFields):a.concat([c])},[])},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"_inputFieldCache",{get:function(){var a=this,c=this._get("_inputFieldCache")||new Map;c.forEach(function(c){return a._disposeInputOrGroup(c)});
c.clear();(this.get("layer.fields")||[]).forEach(function(b){return c.set(b,a._fieldPool.acquire())});return c},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"_inputFieldGroupCache",{get:function(){var a=this,c=this._get("_inputFieldGroupCache")||new Map;c.forEach(function(c){return a._disposeInputOrGroup(c)});c.clear();(this.fieldConfig||[]).filter(K).forEach(function(b){return c.set(b,a._fieldGroupPool.acquire())});return c},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,
"feature",{get:function(){return this._get("feature")},set:function(a){this._featureClone=a?a.clone():null;this._set("feature",a)},enumerable:!0,configurable:!0});r.prototype.castFieldConfig=function(a){return a?a.map(function(a){return a instanceof v||a instanceof E?a:a.fieldConfig?new E(a):new v(a)}):null};Object.defineProperty(r.prototype,"inputFields",{get:function(){var a=this,c=this._arcade,b=this._inputFieldCache,m=this._inputFieldGroupCache,v=this._featureClone,h=this._needsArcade,u=this.layer,
r=this.state,w=v&&v.clone();if("ready"!==r||h&&!c)return[];var C=this.get("layer.fields")||[],v=this.fieldConfig||[];return(0!==v.length?v.map(function(v){if(v.fieldConfig){var h=m.get(v),r=v.fieldConfig.map(function(p){var A=f.find(C,function(e){return e.name===p.name}),k=b.get(A);k.set({arcade:c,field:A,config:p,feature:w,group:h,layer:u,value:a.getValue(A.name)});return k}).filter(function(p){return p.visible});h.set({arcade:c,config:v,feature:w,inputFields:r});return h}var r=f.find(C,function(p){return p.name===
v.name}),p=b.get(r);p.set({arcade:c,field:r,config:v,feature:w,group:null,layer:u,value:a.getValue(r.name)});return p}):C.map(function(m){var f=b.get(m);f.set({arcade:c,config:null,field:m,feature:w,group:null,layer:u,value:a.getValue(m.name)});return f})).filter(function(a){return a.visible})},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"layer",{get:function(){return this.get("feature.layer")},set:function(a){a?this._override("layer",a):this._clearOverride("layer")},enumerable:!0,
configurable:!0});Object.defineProperty(r.prototype,"state",{get:function(){return this.get("layer.loaded")&&this.feature?"ready":"disabled"},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"valid",{get:function(){var a=this._allInputFields;return 0<a.length&&a.every(function(a){return a.valid})},enumerable:!0,configurable:!0});r.prototype.findField=function(a){return f.find(this._allInputFields,function(c){return c.name===a})};r.prototype.getValue=function(a){var c=this._featureClone;
return c&&c.get("attributes."+a)};r.prototype.setValue=function(a,c){var b=this,m=this._featureClone,f=this.strict;if(m&&m.attributes){var v=this.findField(a);if(v&&m.attributes[a]!==c){v.value=c;if(this.get("layer.typeIdField")===v.name){var h=new Set;this.layer.types.forEach(function(a){return Object.keys(a.domains).forEach(function(a){return h.add(a)})});h.forEach(function(a){(a=b.findField(a))&&a.notifyChange("domain")})}if(!f||v.valid)m.attributes[a]=c,this.notifyChange("inputFields"),this._emitChangeEvent(v)}}};
r.prototype.getValues=function(){var a=this._featureClone;return a&&c.clone(a.attributes)||null};r.prototype.submit=function(){var a=this._allInputFields,c=a.filter(function(a){return a.valid}).map(function(a){return a.name}),a=a.filter(function(a){return!a.valid}).map(function(a){return a.name}),b=this.getValues();this.emit("submit",{valid:c,invalid:a,values:b})};r.prototype._disposeInputOrGroup=function(a){a.inputFields?this._disposeGroup(a):this._disposeInput(a)};r.prototype._disposeGroup=function(a){var c=
this;a.inputFields.forEach(function(a){return c._disposeInput(a)});this._fieldGroupPool.release(a)};r.prototype._disposeInput=function(a){this._fieldPool.release(a)};r.prototype._emitChangeEvent=function(a){this.emit("value-change",{layer:this.layer,feature:this.feature,fieldName:a.name,value:a.value,valid:a.valid})};l([u.property({readOnly:!0,dependsOn:["inputFields"]})],r.prototype,"_allInputFields",null);l([u.property({dependsOn:["layer.fields"],readOnly:!0})],r.prototype,"_inputFieldCache",null);
l([u.property({dependsOn:["fieldConfig"],readOnly:!0})],r.prototype,"_inputFieldGroupCache",null);l([u.property()],r.prototype,"feature",null);l([u.property()],r.prototype,"fieldConfig",void 0);l([D.cast("fieldConfig")],r.prototype,"castFieldConfig",null);l([u.property({readOnly:!0,dependsOn:["feature","fieldConfig","layer.fields","layer.loaded"]})],r.prototype,"inputFields",null);l([u.property({dependsOn:["feature.layer"]})],r.prototype,"layer",null);l([u.property({dependsOn:["layer.loaded","feature"]})],
r.prototype,"state",null);l([u.property()],r.prototype,"strict",void 0);l([u.property({dependsOn:["_allInputFields"]})],r.prototype,"valid",null);l([u.property()],r.prototype,"getValues",null);l([u.property()],r.prototype,"submit",null);return r=l([u.subclass("esri.widgets.FeatureForm.FeatureFormViewModel")],r)}(u.declared(r.HandleOwnerMixin(h.EventedAccessor)))})},"esri/widgets/FeatureForm/FieldConfig":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators ./Format".split(" "),
function(z,d,t,l,q,b,f){return function(h){function r(c){c=h.call(this,c)||this;c.description=null;c.domain=null;c.editable=!0;c.editorType=null;c.format=null;c.hint=null;c.label=null;c.maxLength=-1;c.name=null;c.required=!1;c.visibilityExpression=null;return c}t(r,h);l([b.property()],r.prototype,"description",void 0);l([b.property()],r.prototype,"domain",void 0);l([b.property()],r.prototype,"editable",void 0);l([b.property()],r.prototype,"editorType",void 0);l([b.property({type:f})],r.prototype,
"format",void 0);l([b.property()],r.prototype,"hint",void 0);l([b.property()],r.prototype,"label",void 0);l([b.property()],r.prototype,"maxLength",void 0);l([b.property()],r.prototype,"name",void 0);l([b.property()],r.prototype,"required",void 0);l([b.property()],r.prototype,"visibilityExpression",void 0);return r=l([b.subclass("esri.widgets.FeatureForm.FieldConfig")],r)}(b.declared(q))})},"esri/widgets/FeatureForm/Format":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/date ../../core/JSONSupport ../../core/accessorSupport/decorators".split(" "),
function(z,d,t,l,q,b,f){return function(b){function h(c){c=b.call(this,c)||this;c.digitSeparator=!1;c.format=null;c.places=null;return c}t(h,b);l([f.property()],h.prototype,"digitSeparator",void 0);l([f.property({json:{read:{source:"dateFormat",reader:q.fromJSON}}})],h.prototype,"format",void 0);l([f.property()],h.prototype,"places",void 0);return h=l([f.subclass("esri.widgets.FeatureForm.Format")],h)}(f.declared(b.JSONSupport))})},"esri/widgets/FeatureForm/FieldGroupConfig":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators ../../core/accessorSupport/decorators/cast ./FieldConfig".split(" "),
function(z,d,t,l,q,b,f,h){return function(r){function c(a){a=r.call(this,a)||this;a.description=null;a.fieldConfig=null;a.label=null;a.visibilityExpression=null;return a}t(c,r);c.prototype.castFieldConfig=function(a){return a?a.map(function(a){return a.declaredClass?a:new h(a)}):null};l([b.property()],c.prototype,"description",void 0);l([b.property()],c.prototype,"fieldConfig",void 0);l([f.cast("fieldConfig")],c.prototype,"castFieldConfig",null);l([b.property()],c.prototype,"label",void 0);l([b.property()],
c.prototype,"visibilityExpression",void 0);return c=l([b.subclass("esri.widgets.FeatureForm.FieldGroupConfig")],c)}(b.declared(q))})},"esri/widgets/FeatureForm/InputField":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper dojo/i18n!./nls/FeatureForm ../../intl ../../core/Accessor ../../core/accessorSupport/decorators ../../layers/support/CodedValueDomain ../../layers/support/domains ../../layers/support/fieldUtils".split(" "),function(z,
d,t,l,q,b,f,h,r,c,a){var m={type:"number"},u={type:"date",intlOptions:{day:"2-digit",month:"2-digit",year:"2-digit",hour:"numeric",minute:"numeric",second:"numeric"}};return function(f){function w(a){a=f.call(this,a)||this;a.arcade=null;a.config=null;a.feature=null;a.field=null;a.layer=null;a.description=null;a.editorType=null;a.error=null;a.format=null;a.group=null;a.hint=null;a.name=null;return a}t(w,f);Object.defineProperty(w.prototype,"compiledFunc",{get:function(){var a=this.arcade;return a&&
a.arcadeUtils.createFunction(this.get("config.visibilityExpression"))},enumerable:!0,configurable:!0});Object.defineProperty(w.prototype,"evaluatedVisibility",{get:function(){var a=this.compiledFunc;if(a){var c=this.arcade;return c.arcadeUtils.executeFunction(a,c.arcadeUtils.createExecContext(this.feature))}},enumerable:!0,configurable:!0});Object.defineProperty(w.prototype,"domain",{get:function(){var a=this.layer.typeIdField,c=a===this.name,b=this.get("field.domain");if(c&&!b)return new r({name:"__internal-type-based-coded-value-domain__",
codedValues:this.layer.types.map(function(a){return{code:a.id,name:a.name}})});c=this.feature;a=a&&this.layer.getFieldDomain(this.name,{feature:c})||b;b=this.get("config.domain");return this._isDomainCompatible(b)?b:a},enumerable:!0,configurable:!0});Object.defineProperty(w.prototype,"editable",{get:function(){return this.layer.capabilities.operations.supportsEditing&&this.field.editable&&!1!==this.get("config.editable")},enumerable:!0,configurable:!0});Object.defineProperty(w.prototype,"errorMessage",
{get:function(){return this._toErrorMessage()},enumerable:!0,configurable:!0});Object.defineProperty(w.prototype,"label",{get:function(){return this.get("config.label")||this.field.alias||this.field.name},enumerable:!0,configurable:!0});Object.defineProperty(w.prototype,"maxLength",{get:function(){if("date"===this.type)return-1;var a=this.get("field.length"),c=this.get("config.maxLength");return!isNaN(c)&&-1<=c&&(-1===a||c<=a)?c:a},enumerable:!0,configurable:!0});Object.defineProperty(w.prototype,
"required",{get:function(){var a=this.get("field.nullable"),c=this.get("config.required");return this.editable&&(!a||!0===c)},enumerable:!0,configurable:!0});Object.defineProperty(w.prototype,"type",{get:function(){var c=this.field;return a.isNumericField(c)?"number":a.isStringField(c)?"text":a.isDateField(c)?"date":"unsupported"},enumerable:!0,configurable:!0});Object.defineProperty(w.prototype,"valid",{get:function(){var a=this.editable?this._validate():null;this._set("error",a);return null===a},
enumerable:!0,configurable:!0});Object.defineProperty(w.prototype,"value",{get:function(){return this._get("value")},set:function(a){this.notifyChange("evaluatedVisibility");this._set("value",a)},enumerable:!0,configurable:!0});Object.defineProperty(w.prototype,"visible",{get:function(){return this._isEditorField()?!1:"boolean"===typeof this.evaluatedVisibility?this.evaluatedVisibility:!!this.config||this._shownByDefault()},enumerable:!0,configurable:!0});w.prototype._isDomainCompatible=function(c){var b=
this.field;if(c&&"coded-value"===c.type){var m=typeof c.codedValues[0].code;if("string"===m&&a.isStringField(b)||"number"===m&&a.isNumericField(b))return!0}return c&&"range"===c.type&&a.isNumericField(b)?!0:!1};w.prototype._validate=function(){var b=this.domain,m=this.field,f=this.value;return b?null!==f||this.required?c.validateDomainValue(b,f):null:a.validateFieldValue(m,f)};w.prototype._shownByDefault=function(){var a=this.get("field.type");return"oid"!==a&&"global-id"!==a&&!this._isGeometryField()};
w.prototype._isEditorField=function(){return-1<a.getFeatureEditFields(this.layer).indexOf(this.name)};w.prototype._isGeometryField=function(){return-1<a.getFeatureGeometryFields(this.layer).indexOf(this.name)};w.prototype._toErrorMessage=function(){var f=this.domain,h=this.field,r=this.value,w=this.type,d=this.error;return this.required&&null===r?q.validationErrors.cannotBeNull:d===c.DomainValidationError.VALUE_OUT_OF_RANGE||d===a.NumericRangeValidationError.OUT_OF_RANGE?(f=c.getDomainRange(f)||a.getFieldRange(h),
b.substitute(q.validationErrors.outsideRange,{min:f.min,max:f.max},{format:{max:"date"===w?u:m,min:"date"===w?u:m}})):d===c.DomainValidationError.INVALID_CODED_VALUE?q.validationErrors.invalidCodedValue:d===a.TypeValidationError.INVALID_TYPE?q.validationErrors.invalidType:null};l([h.property()],w.prototype,"arcade",void 0);l([h.property({dependsOn:["arcade","config.visibilityExpression"]})],w.prototype,"compiledFunc",null);l([h.property({dependsOn:["compiledFunc","feature"]})],w.prototype,"evaluatedVisibility",
null);l([h.property()],w.prototype,"config",void 0);l([h.property()],w.prototype,"feature",void 0);l([h.property()],w.prototype,"field",void 0);l([h.property()],w.prototype,"layer",void 0);l([h.property({aliasOf:"config.description"})],w.prototype,"description",void 0);l([h.property({dependsOn:["config","feature","field","layer"]})],w.prototype,"domain",null);l([h.property({dependsOn:["config","field","layer"]})],w.prototype,"editable",null);l([h.property({aliasOf:"config.editorType"})],w.prototype,
"editorType",void 0);l([h.property({readOnly:!0})],w.prototype,"error",void 0);l([h.property({dependsOn:["error","value"]})],w.prototype,"errorMessage",null);l([h.property({aliasOf:"config.format"})],w.prototype,"format",void 0);l([h.property()],w.prototype,"group",void 0);l([h.property({aliasOf:"config.hint"})],w.prototype,"hint",void 0);l([h.property({dependsOn:["field","config"]})],w.prototype,"label",null);l([h.property({dependsOn:["field.length","config"]})],w.prototype,"maxLength",null);l([h.property({aliasOf:"field.name"})],
w.prototype,"name",void 0);l([h.property({dependsOn:["field","config"]})],w.prototype,"required",null);l([h.property({dependsOn:["field"]})],w.prototype,"type",null);l([h.property({dependsOn:["config","domain","field","layer","value"]})],w.prototype,"valid",null);l([h.property({value:null})],w.prototype,"value",null);l([h.property({dependsOn:["config","evaluatedVisibility","field","layer"]})],w.prototype,"visible",null);return w=l([h.subclass("esri.widgets.FeatureForm.InputField")],w)}(h.declared(f))})},
"esri/widgets/FeatureForm/InputFieldGroup":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/HandleOwner ../../core/accessorSupport/decorators".split(" "),function(z,d,t,l,q,b,f){return function(b){function h(c){c=b.call(this,c)||this;c.arcade=null;c.config=null;c.description=null;c.feature=null;c.label=null;c.visibilityExpression=null;return c}t(h,b);Object.defineProperty(h.prototype,"compiledFunc",{get:function(){var c=
this.arcade;return c&&c.arcadeUtils.createFunction(this.visibilityExpression)},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"evaluatedVisibility",{get:function(){var c=this.compiledFunc;if(c){var a=this.arcade;return a.arcadeUtils.executeFunction(c,a.arcadeUtils.createExecContext(this.feature))}},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"inputFields",{get:function(){return this._get("inputFields")},set:function(c){var a=this;this.handles.removeAll();c&&
this.handles.add(c.map(function(c){return c.watch("visible",a._dirtyEvaluatedVisibility)}));this._set("inputFields",c)},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"visible",{get:function(){return!1!==this.evaluatedVisibility&&this.inputFields&&this.inputFields.some(function(c){return c.visible})},enumerable:!0,configurable:!0});h.prototype._dirtyEvaluatedVisibility=function(){this.visibilityExpression&&this.notifyChange("evaluatedVisibility")};l([f.property()],h.prototype,"arcade",
void 0);l([f.property({dependsOn:["arcade","visibilityExpression"]})],h.prototype,"compiledFunc",null);l([f.property()],h.prototype,"config",void 0);l([f.property({dependsOn:["compiledFunc","feature"]})],h.prototype,"evaluatedVisibility",null);l([f.property({aliasOf:"config.description"})],h.prototype,"description",void 0);l([f.property()],h.prototype,"feature",void 0);l([f.property()],h.prototype,"inputFields",null);l([f.property({aliasOf:"config.label"})],h.prototype,"label",void 0);l([f.property({aliasOf:"config.visibilityExpression"})],
h.prototype,"visibilityExpression",void 0);l([f.property({dependsOn:["evaluatedVisibility","inputFields"]})],h.prototype,"visible",null);return h=l([f.subclass("esri.widgets.FeatureForm.InputFieldGroup")],h)}(f.declared(b.HandleOwnerMixin(q)))})},"esri/widgets/FeatureTemplates":function(){define("require exports ../core/tsSupport/assignHelper ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper @dojo/framework/shim/IntersectionObserver dojo/i18n!./FeatureTemplates/nls/FeatureTemplates ../core/deprecate ../core/HandleOwner ../core/Logger ../core/watchUtils ../core/accessorSupport/decorators ./Widget ./FeatureTemplates/FeatureTemplatesViewModel ./FeatureTemplates/ItemList ./support/widget".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u,D,w,v){function E(a){return a.items?a.uid:a.layer.id}var C=c.getLogger("esri.widgets.FeatureTemplates"),J={filter:!0};return function(c){function u(a){a=c.call(this,a)||this;a._iconIntersectionObserver=new b.default(function(a,c){a.forEach(function(a){if(a.isIntersecting){var b=a.target;if(!b["data-has-icon"]){b["data-has-icon"]=!0;var m=b["data-item"];m.fetchThumbnail().then(function(){m.thumbnail&&b.appendChild(m.thumbnail)})}c.unobserve(b)}})});a.filterFunction=
null;a.filterText="";a.groupBy=null;a.label=f.widgetLabel;a.layers=null;a.viewModel=new D;a.visibleElements=t({},J);a.renderItemIcon=a.renderItemIcon.bind(a);a._afterItemCreateOrUpdate=a._afterItemCreateOrUpdate.bind(a);a._afterItemRemoved=a._afterItemRemoved.bind(a);return a}l(u,c);u.prototype.postInitialize=function(){var c=this,b=function(a){a=a.label;return!c.filterText||-1<a.toLowerCase().indexOf(c.filterText.toLowerCase())};this.own(a.init(this,"viewModel",function(a,m){a&&!a.filterFunction&&
(c.filterFunction=b);m&&m!==a&&m.filterFunction===b&&(m.filterFunction=null)}))};u.prototype.destroy=function(){this._iconIntersectionObserver&&(this._iconIntersectionObserver.disconnect(),this._iconIntersectionObserver=null)};Object.defineProperty(u.prototype,"filterEnabled",{set:function(a){h.deprecatedProperty(C,"filterEnabled",{replacement:"visibleElements.filter",version:"4.15"});this.visibleElements=t({},this.visibleElements,{filter:a})},enumerable:!0,configurable:!0});u.prototype.castVisibleElements=
function(a){return t({},J,a)};u.prototype.render=function(){var a=this,c=this.filterText,b=this.viewModel,m=b.items,b=b.state,h=this.visibleElements.filter;return v.tsx("div",{class:this.classes("esri-feature-templates","esri-widget"),"aria-label":f.widgetLabel},"loading"===b?this.renderLoader():"ready"===b?w.ItemList({id:this.id,identify:E,filterText:c,items:m,messages:{filterPlaceholder:f.filterPlaceholder,noItems:f.noItems,noMatches:f.noMatches},filterEnabled:h,onItemSelect:function(c){a.viewModel.select(c)},
onFilterChange:function(c){a.filterText=c;a.viewModel.refresh()},renderIcon:this.renderItemIcon}):null)};u.prototype.renderItemIcon=function(a){return v.tsx("span",{key:"icon",class:"esri-feature-templates__list-item-icon",afterCreate:this._afterItemCreateOrUpdate,afterUpdate:this._afterItemCreateOrUpdate,afterRemoved:this._afterItemRemoved,"data-item":a.item,"data-has-icon":!1})};u.prototype.renderLoader=function(){return v.tsx("div",{class:"esri-feature-templates__loader",key:"loader"})};u.prototype._afterItemCreateOrUpdate=
function(a){this._iconIntersectionObserver.observe(a)};u.prototype._afterItemRemoved=function(a){this._iconIntersectionObserver.unobserve(a)};q([m.property(),v.renderable()],u.prototype,"filterEnabled",null);q([m.aliasOf("viewModel.filterFunction")],u.prototype,"filterFunction",void 0);q([m.property(),v.renderable()],u.prototype,"filterText",void 0);q([m.aliasOf("viewModel.groupBy")],u.prototype,"groupBy",void 0);q([m.property()],u.prototype,"label",void 0);q([m.aliasOf("viewModel.layers")],u.prototype,
"layers",void 0);q([m.property(),v.renderable(["viewModel.items","viewModel.state"]),v.vmEvent("select")],u.prototype,"viewModel",void 0);q([m.property(),v.renderable()],u.prototype,"visibleElements",void 0);q([m.cast("visibleElements")],u.prototype,"castVisibleElements",null);return u=q([m.subclass("esri.widgets.FeatureTemplates")],u)}(m.declared(r.HandleOwnerMixin(u)))})},"@dojo/framework/shim/IntersectionObserver":function(){(function(z){"object"===typeof module&&"object"===typeof module.exports?
(z=z(require,exports),void 0!==z&&(module.exports=z)):"function"===typeof define&&define.amd&&define(["require","exports","./global","intersection-observer"],z)})(function(z,d){Object.defineProperty(d,"__esModule",{value:!0});var t=z("./global");"!has('build-elide')";z("intersection-observer");d.default=t.default.IntersectionObserver})},"intersection-observer/intersection-observer":function(){define(["dojo","dijit","dojox"],function(z,d,t){(function(d,q){function b(a){this.time=a.time;this.target=
a.target;this.rootBounds=a.rootBounds;this.boundingClientRect=a.boundingClientRect;this.intersectionRect=a.intersectionRect||m();this.isIntersecting=!!a.intersectionRect;a=this.boundingClientRect;a=a.width*a.height;var c=this.intersectionRect,c=c.width*c.height;this.intersectionRatio=a?Number((c/a).toFixed(4)):this.isIntersecting?1:0}function f(a,c){c=c||{};if("function"!=typeof a)throw Error("callback must be a function");if(c.root&&1!=c.root.nodeType)throw Error("root must be an Element");this._checkForIntersections=
h(this._checkForIntersections.bind(this),this.THROTTLE_TIMEOUT);this._callback=a;this._observationTargets=[];this._queuedEntries=[];this._rootMarginValues=this._parseRootMargin(c.rootMargin);this.thresholds=this._initThresholds(c.threshold);this.root=c.root||null;this.rootMargin=this._rootMarginValues.map(function(a){return a.value+a.unit}).join(" ")}function h(a,c){var b=null;return function(){b||(b=setTimeout(function(){a();b=null},c))}}function r(a,c,b,m){"function"==typeof a.addEventListener?
a.addEventListener(c,b,m||!1):"function"==typeof a.attachEvent&&a.attachEvent("on"+c,b)}function c(a,c,b,m){"function"==typeof a.removeEventListener?a.removeEventListener(c,b,m||!1):"function"==typeof a.detatchEvent&&a.detatchEvent("on"+c,b)}function a(a){var c;try{c=a.getBoundingClientRect()}catch(C){}if(!c)return m();c.width&&c.height||(c={top:c.top,right:c.right,bottom:c.bottom,left:c.left,width:c.right-c.left,height:c.bottom-c.top});return c}function m(){return{top:0,bottom:0,left:0,right:0,width:0,
height:0}}function u(a,c){for(;c;){if(c==a)return!0;c=l(c)}return!1}function l(a){return(a=a.parentNode)&&11==a.nodeType&&a.host?a.host:a}if("IntersectionObserver"in d&&"IntersectionObserverEntry"in d&&"intersectionRatio"in d.IntersectionObserverEntry.prototype)"isIntersecting"in d.IntersectionObserverEntry.prototype||Object.defineProperty(d.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return 0<this.intersectionRatio}});else{var w=[];f.prototype.THROTTLE_TIMEOUT=100;f.prototype.POLL_INTERVAL=
null;f.prototype.USE_MUTATION_OBSERVER=!0;f.prototype.observe=function(a){if(!this._observationTargets.some(function(c){return c.element==a})){if(!a||1!=a.nodeType)throw Error("target must be an Element");this._registerInstance();this._observationTargets.push({element:a,entry:null});this._monitorIntersections();this._checkForIntersections()}};f.prototype.unobserve=function(a){this._observationTargets=this._observationTargets.filter(function(c){return c.element!=a});this._observationTargets.length||
(this._unmonitorIntersections(),this._unregisterInstance())};f.prototype.disconnect=function(){this._observationTargets=[];this._unmonitorIntersections();this._unregisterInstance()};f.prototype.takeRecords=function(){var a=this._queuedEntries.slice();this._queuedEntries=[];return a};f.prototype._initThresholds=function(a){a=a||[0];Array.isArray(a)||(a=[a]);return a.sort().filter(function(a,c,b){if("number"!=typeof a||isNaN(a)||0>a||1<a)throw Error("threshold must be a number between 0 and 1 inclusively");
return a!==b[c-1]})};f.prototype._parseRootMargin=function(a){a=(a||"0px").split(/\s+/).map(function(a){a=/^(-?\d*\.?\d+)(px|%)$/.exec(a);if(!a)throw Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(a[1]),unit:a[2]}});a[1]=a[1]||a[0];a[2]=a[2]||a[0];a[3]=a[3]||a[1];return a};f.prototype._monitorIntersections=function(){this._monitoringIntersections||(this._monitoringIntersections=!0,this.POLL_INTERVAL?this._monitoringInterval=setInterval(this._checkForIntersections,
this.POLL_INTERVAL):(r(d,"resize",this._checkForIntersections,!0),r(q,"scroll",this._checkForIntersections,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in d&&(this._domObserver=new MutationObserver(this._checkForIntersections),this._domObserver.observe(q,{attributes:!0,childList:!0,characterData:!0,subtree:!0}))))};f.prototype._unmonitorIntersections=function(){this._monitoringIntersections&&(this._monitoringIntersections=!1,clearInterval(this._monitoringInterval),this._monitoringInterval=null,
c(d,"resize",this._checkForIntersections,!0),c(q,"scroll",this._checkForIntersections,!0),this._domObserver&&(this._domObserver.disconnect(),this._domObserver=null))};f.prototype._checkForIntersections=function(){var c=this._rootIsInDom(),f=c?this._getRootRect():m();this._observationTargets.forEach(function(m){var h=m.element,v=a(h),u=this._rootContainsTarget(h),w=m.entry,r=c&&u&&this._computeTargetAndRootIntersection(h,f);m=m.entry=new b({time:d.performance&&performance.now&&performance.now(),target:h,
boundingClientRect:v,rootBounds:f,intersectionRect:r});w?c&&u?this._hasCrossedThreshold(w,m)&&this._queuedEntries.push(m):w&&w.isIntersecting&&this._queuedEntries.push(m):this._queuedEntries.push(m)},this);this._queuedEntries.length&&this._callback(this.takeRecords(),this)};f.prototype._computeTargetAndRootIntersection=function(c,b){if("none"!=d.getComputedStyle(c).display){var m=a(c);c=l(c);for(var f=!1;!f;){var h=null,v=1==c.nodeType?d.getComputedStyle(c):{};if("none"==v.display)return;c==this.root||
c==q?(f=!0,h=b):c!=q.body&&c!=q.documentElement&&"visible"!=v.overflow&&(h=a(c));if(h){var v=Math.max(h.top,m.top),u=Math.min(h.bottom,m.bottom),w=Math.max(h.left,m.left),m=Math.min(h.right,m.right),h=m-w,r=u-v,m=0<=h&&0<=r&&{top:v,bottom:u,left:w,right:m,width:h,height:r};if(!m)break}c=l(c)}return m}};f.prototype._getRootRect=function(){var c;if(this.root)c=a(this.root);else{c=q.documentElement;var b=q.body;c={top:0,left:0,right:c.clientWidth||b.clientWidth,width:c.clientWidth||b.clientWidth,bottom:c.clientHeight||
b.clientHeight,height:c.clientHeight||b.clientHeight}}return this._expandRectByRootMargin(c)};f.prototype._expandRectByRootMargin=function(a){var c=this._rootMarginValues.map(function(c,b){return"px"==c.unit?c.value:c.value*(b%2?a.width:a.height)/100}),c={top:a.top-c[0],right:a.right+c[1],bottom:a.bottom+c[2],left:a.left-c[3]};c.width=c.right-c.left;c.height=c.bottom-c.top;return c};f.prototype._hasCrossedThreshold=function(a,c){a=a&&a.isIntersecting?a.intersectionRatio||0:-1;c=c.isIntersecting?c.intersectionRatio||
0:-1;if(a!==c)for(var b=0;b<this.thresholds.length;b++){var m=this.thresholds[b];if(m==a||m==c||m<a!==m<c)return!0}};f.prototype._rootIsInDom=function(){return!this.root||u(q,this.root)};f.prototype._rootContainsTarget=function(a){return u(this.root||q,a)};f.prototype._registerInstance=function(){0>w.indexOf(this)&&w.push(this)};f.prototype._unregisterInstance=function(){var a=w.indexOf(this);-1!=a&&w.splice(a,1)};d.IntersectionObserver=f;d.IntersectionObserverEntry=b}})(window,document)})},"dojo/main":function(){define("./_base/kernel ./has require ./sniff ./_base/lang ./_base/array ./_base/config ./ready ./_base/declare ./_base/connect ./_base/Deferred ./_base/json ./_base/Color require ./has!host-browser?./_base/browser require".split(" "),
function(z,d,t,l,q,b,f,h){f.isDebug&&t(["./_firebug/firebug"]);return z})},"dijit/main":function(){define(["dojo/_base/kernel"],function(z){return z.dijit})},"dojox/main":function(){define(["dojo/_base/kernel"],function(z){return z.dojox})},"esri/widgets/FeatureTemplates/FeatureTemplatesViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Evented ../../core/HandleOwner ../../core/ObjectPool ../../core/watchUtils ../../core/accessorSupport/decorators ./TemplateItem ./TemplateItemGroup".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a){var m=function(a){a=a.layer;return{key:a,label:a.title}},u=function(a){return a.layer.geometryType};return function(b){function w(m){m=b.call(this,m)||this;m._templateToLayer=new Map;m._itemPool=new f(c);m._groupPool=new f(a);m.filterFunction=null;m.groupBy="layer";return m}t(w,b);w.prototype.destroy=function(){this._templateToLayer.clear();this._templateToLayer=null};Object.defineProperty(w.prototype,"layers",{get:function(){return this._get("layers")},set:function(a){var c=
this;this.handles.removeAll();if(a){var b=function(){return c.notifyChange("state")};this.handles.add(a.map(function(a){return h.when(a,"loadStatus",b)}))}this._set("layers",a)},enumerable:!0,configurable:!0});Object.defineProperty(w.prototype,"state",{get:function(){var a=this.layers;return a&&0!==a.length?a.some(function(a){return"loading"===a.loadStatus||"not-loaded"===a.loadStatus})?"loading":"ready":"disabled"},enumerable:!0,configurable:!0});Object.defineProperty(w.prototype,"items",{get:function(){var a=
this,c=this.layers;this._destroyItems(this._get("items"));if(!c||0===c.length)return[];this._templateToLayer.clear();var c=c.filter(function(a){var c=a.capabilities;return a.loaded&&c.operations.supportsEditing&&c.operations.supportsAdd}).map(function(c){var b=a._getTemplatesForLayer(c);if(0<b.length)return b.forEach(function(b){return a._templateToLayer.set(b,c)}),b}).filter(function(a){return null!=a}),b=this.groupBy;if("none"===b)return c.map(function(c){return c.filter(function(c){c=c.name;return!a.filterFunction||
a.filterFunction({label:c})})}).map(function(c){return c.map(function(c){return a._createItem(c)})}).reduce(function(a,c){return a.concat(c)},[]);c=c.reduce(function(c,f){f.forEach(function(f){var h=("layer"===b?m:"geometry"===b?u:b)({template:f,layer:a._templateToLayer.get(f)});if(h){var v="string"===typeof h?h:h.key,h="string"===typeof h?h:h.label;c.has(v)||c.set(v,{label:h,templates:[]});c.get(v).templates.push(f)}});return c},new Map);if(0===c.size)return[];var f=[],h=this.filterFunction;c.forEach(function(c){var b=
c.label,m=c.templates;!h||a.filterFunction(c)?f.push(a._createGroup(b,m.map(function(c){return a._createItem(c)}))):(c=m.filter(function(c){return a.filterFunction({label:c.name})}).map(function(c){return a._createItem(c)}),0<c.length&&f.push(a._createGroup(b,c)))});return f},enumerable:!0,configurable:!0});w.prototype.refresh=function(){this.notifyChange("items")};w.prototype.select=function(a){a=a.clone();this.emit("select",{item:a,template:a.template})};w.prototype._getTemplatesForLayer=function(a){var c=
a.templates||[];a=(a.types||[]).map(function(a){return a.templates}).reduce(function(a,c){return a.concat(c)},[]);return c.concat(a)};w.prototype._createItem=function(a){var c=this._itemPool.acquire();c.set({template:a,layer:this._templateToLayer.get(a)});return c};w.prototype._createGroup=function(a,c){var b=this._groupPool.acquire();b.set("label",a);b.items=c;return b};w.prototype._destroyItems=function(a){var b=this;a&&(a[0]instanceof c?a.forEach(function(a){return b._destroyItem(a)}):a.forEach(function(a){return b._destroyGroup(a)}))};
w.prototype._destroyGroup=function(a){var c=this;a.items.forEach(function(a){return c._itemPool.release(a)});a.items.length=0;this._groupPool.release(a)};w.prototype._destroyItem=function(a){this._itemPool.release(a)};l([r.property()],w.prototype,"filterFunction",void 0);l([r.property()],w.prototype,"groupBy",void 0);l([r.property()],w.prototype,"layers",null);l([r.property({dependsOn:["layers"]})],w.prototype,"state",null);l([r.property({dependsOn:["filterFunction","groupBy","layers","state"],readOnly:!0})],
w.prototype,"items",null);return w=l([r.subclass("esri.widgets.FeatureTemplates.FeatureTemplatesViewModel")],w)}(r.declared(b.HandleOwnerMixin(q.EventedAccessor)))})},"esri/widgets/FeatureTemplates/TemplateItem":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../Graphic ../../core/Accessor ../../core/HandleOwner ../../core/promiseUtils ../../core/watchUtils ../../core/accessorSupport/decorators ../../symbols/support/symbolUtils".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u){return function(h){function w(a){a=h.call(this,a)||this;a.description=null;a.label=null;a.layer=null;a.template=null;a.thumbnail=null;return a}t(w,h);v=w;w.prototype.initialize=function(){var c=this;this.handles.add(a.init(this,["layer.renderer","template"],function(){return c._set("thumbnail",null)}))};w.prototype.clone=function(){var a=this.thumbnail?this.thumbnail.cloneNode(!0):null,c=new v({layer:this.layer,template:this.template});c._set("thumbnail",a);return c};
w.prototype.fetchThumbnail=function(){return b(this,void 0,void 0,function(){var a,b;return q(this,function(m){switch(m.label){case 0:return this._get("thumbnail")?[2,c.resolve()]:[4,this._getPreviewSymbol()];case 1:return a=m.sent(),[4,u.renderPreviewHTML(a,{maxSize:36})];case 2:return b=m.sent(),this._set("thumbnail",b),[2]}})})};w.prototype._getPreviewSymbol=function(){return b(this,void 0,void 0,function(){var a,c,b,m,h,u;return q(this,function(v){switch(v.label){case 0:a=this;c=a.layer;b=a.template;
m=a.layer.renderer;if(!m)return[3,2];h=new f({attributes:b.prototype.attributes});return[4,m.getSymbolAsync(h)];case 1:if(u=v.sent())return[2,u];v.label=2;case 2:return[2,this._getFallbackSymbolFromGeometry(c)]}})})};w.prototype._getFallbackSymbolFromGeometry=function(a){a=a.geometryType;if("point"===a||"multipoint"===a)return c.create(function(a){return z(["../../symbols/SimpleMarkerSymbol"],a)}).then(function(a){return new a});if("polyline"===a)return c.create(function(a){return z(["../../symbols/SimpleLineSymbol"],
a)}).then(function(a){return new a});if("polygon"===a||"mesh"===a||"multipatch"===a)return c.create(function(a){return z(["../../symbols/SimpleFillSymbol"],a)}).then(function(a){return new a})};var v;l([m.property({aliasOf:"template.description"})],w.prototype,"description",void 0);l([m.property({aliasOf:"template.name"})],w.prototype,"label",void 0);l([m.property()],w.prototype,"layer",void 0);l([m.property()],w.prototype,"template",void 0);l([m.property({readOnly:!0})],w.prototype,"thumbnail",void 0);
return w=v=l([m.subclass("esri.widgets.FeatureTemplates.TemplateItem")],w)}(m.declared(r.HandleOwnerMixin(h)))})},"esri/symbols/support/symbolUtils":function(){define("require exports ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../core/tsSupport/assignHelper ../../core/compilerUtils ../../core/maybe ../../core/promiseUtils ../../support/arcadeOnDemand ./previewCIMSymbol ./previewSymbol2D ./previewSymbol3D ./previewWebStyleSymbol ./utils".split(" "),function(z,d,t,l,
q,b,f,h,r,c,a,m,u,D){function w(f,h){switch(f.type){case "web-style":return u.previewWebStyleSymbol(f,w,h);case "label-3d":case "line-3d":case "mesh-3d":case "point-3d":case "polygon-3d":return m.previewSymbol3D(f,h);case "simple-marker":case "simple-line":case "simple-fill":case "picture-marker":case "picture-fill":case "text":return a.previewSymbol2D(f,h);case "cim":return c.previewCIMSymbol(f,h);default:b.neverReached(f)}}function v(a){return a&&"opacity"in a?a.opacity*v(a.parent):1}Object.defineProperty(d,
"__esModule",{value:!0});var E=null;d.renderDotDensityPreviewHTML=function(a,c,b){var m=a.backgroundColor,f=a.outline;a=a.dotSize;var h=b&&b.swatchSize||22,u=Math.round(h*h/Math.pow(a,2)*.8),v=window.devicePixelRatio;b=document.createElement("canvas");var w=h*v;b.width=w;b.height=w;b.style.width=b.width/v+"px";b.style.height=b.height/v+"px";var r=b.getContext("2d");m&&(r.fillStyle=m.toCss(!0),r.fillRect(0,0,w,w),r.fill());r.fillStyle=c.toCss(!0);if(E&&E.length/2===u)for(c=0;c<2*u;c+=2){var m=E[c],
d=E[c+1];r.fillRect(m,d,a*v,a*v);r.fill()}else for(E=[],c=0;c<2*u;c+=2)m=Math.floor(Math.random()*(w-0+1)+0),d=Math.floor(Math.random()*(w-0+1)+0),E.push(m,d),r.fillRect(m,d,a*v,a*v),r.fill();f&&(f.color&&(r.strokeStyle=f.color.toCss(!0)),r.lineWidth=f.width,r.strokeRect(0,0,w,w));f=new Image(h,h);f.src=b.toDataURL();return f};d.renderColorRampPreviewHTML=function(a,c){void 0===c&&(c={});var b="horizontal"===c.align,m=c.width,m=void 0===m?b?75:24:m,f=c.height,f=void 0===f?b?24:75:f;c=c.gradient;var h=
void 0===c?!0:c;c=window.devicePixelRatio;var u=m*c,v=f*c;c=document.createElement("canvas");c.width=u;c.height=v;c.style.width=m+"px";c.style.height=f+"px";var w=c.getContext("2d"),r=b?u:0,d=b?0:v;if(h){var l=w.createLinearGradient(0,0,r,d),C=1/(a.length-1);a.forEach(function(a,c){return l.addColorStop(c*C,a.toString())});w.fillStyle=l;w.fillRect(0,0,u,v)}else for(h=b?u/a.length:u,u=b?v:v/a.length,d=r=v=0;d<a.length;d++)w.fillStyle=a[d].toString(),w.fillRect(v,r,h,u),v=b?v+h:0,r=b?0:r+u;a=document.createElement("div");
a.style.width=m+"px";a.style.height=f+"px";a.appendChild(c);return a};d.renderPreviewHTML=w;d.getDisplayedSymbol=function(a,c){return l(this,void 0,void 0,function(){var b,m,u,w,d,l,C,E,J,Q,U,V,Y,T,aa,W,p,L,A,k,e,g,n;return t(this,function(y){switch(y.label){case 0:if(!a)return[2,void 0];b=v(a.layer||a.sourceLayer);return!f.isSome(a.symbol)||f.isSome(c)&&!0===c.ignoreGraphicSymbol?[3,4]:"web-style"!==a.symbol.type?[3,2]:[4,a.symbol.fetchSymbol(f.isSome(c)?c.abortOptions:null)];case 1:return u=y.sent(),
[3,3];case 2:u=a.symbol.clone(),y.label=3;case 3:return m=u,D.applyColorToSymbol(m,null,b),[2,m];case 4:return w=a.get("layer.renderer")||a.get("sourceLayer.renderer"),[4,w.getSymbolAsync(a)];case 5:return(d=y.sent())?"web-style"!==d.type?[3,7]:[4,d.fetchSymbol(f.isSome(c)?c.abortOptions:null)]:[2,void 0];case 6:return d=y.sent(),[3,8];case 7:d=d.clone(),y.label=8;case 8:if(!("visualVariables"in w)||"visualVariables"in w&&!w.visualVariables||"visualVariables"in w&&w.visualVariables&&!w.visualVariables.length)return[2,
d];if(!w.arcadeRequiredForVisualVariables||!f.isNone(c)&&!f.isNone(c.arcade))return[3,10];C=l=q({},f.unwrap(c));return[4,r.loadArcade()];case 9:C.arcade=y.sent(),c=l,y.label=10;case 10:return[4,h.create(function(e){return z(["../../renderers/visualVariables/support/visualVariableUtils"],e)})];case 11:E=y.sent();J=[];Q=[];U=[];V=[];Y=0;for(T=w.visualVariables;Y<T.length;Y++)switch(aa=T[Y],aa.type){case "color":J.push(aa);break;case "opacity":Q.push(aa);break;case "rotation":V.push(aa);break;case "size":aa.target||
U.push(aa)}p=(W=!!J.length&&J[J.length-1])?E.getColor(W,a,c):null;A=(L=!!Q.length&&Q[Q.length-1])?E.getOpacity(L,a,c):null;null!=b&&(A=null!=A?A*b:b);D.applyColorToSymbol(d,p,A);if(!U.length)return[3,13];k=E.getAllSizes(U,a,c);return[4,D.applySizesToSymbol(d,k)];case 12:y.sent(),y.label=13;case 13:e=0;for(g=V;e<g.length;e++)n=g[e],D.applyRotationToSymbol(d,E.getRotationAngle(n,a,c),n.axis);return[2,d]}})})}})},"esri/symbols/support/previewCIMSymbol":function(){define(["require","exports","../../core/tsSupport/generatorHelper",
"../../core/tsSupport/awaiterHelper","../cim/CIMSymbolRasterizer"],function(z,d,t,l,q){Object.defineProperty(d,"__esModule",{value:!0});var b=new q(null,!0);d.previewCIMSymbol=function(f,h){void 0===h&&(h={});return l(this,void 0,void 0,function(){var r,c,a,m,u,d,w,v,l,C;return t(this,function(D){switch(D.label){case 0:return r=h.size,c=h.maxSize,a=h.feature,m=h.fieldMap,u=Math.min(r||22,c||120),d=3,[4,b.rasterizeCIMSymbolAsync(f,a,m,{targetSize:u*d})];case 1:return w=D.sent(),v=document.createElement("canvas"),
v.width=w.imageData.width,v.height=w.imageData.height,l=v.getContext("2d"),l.putImageData(w.imageData,0,0),C=new Image(v.width/d,v.height/d),C.src=v.toDataURL(),[2,C]}})})}})},"esri/symbols/cim/CIMSymbolRasterizer":function(){define("require exports ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../request ../../core/promiseUtils ../../core/screenUtils ../../geometry/support/jsonUtils ./cimAnalyzer ./Rasterizer ./TextRasterizer ./utils ../support/cimSymbolUtils ../support/Symbol3DAnchorPosition2D".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u,D){function w(a){return(a?Object.keys(a):[]).map(function(c){return{name:c,alias:c,type:"string"===typeof a[c]?"esriFieldTypeString":"esriFieldTypeDouble"}})}var v=function(a,c){return a&&a.targetSize?a.targetSize/c.referenceSize:a&&a.scaleFactor?a.scaleFactor:1};return function(){function d(b,m){this._spatialReference=b;this._avoidSDF=m;this._resourceCache=new Map;this._rasterizer=new c.default;this._textRasterizer=new a.default;this._pictureMarkerCache=new Map}
d.prototype.rasterizeCIMSymbolAsync=function(a,c,b,m,f,u,v){return l(this,void 0,void 0,function(){var r,d;return t(this,function(l){switch(l.label){case 0:return r=c?null!==c.centroid?"esriGeometryPolygon":h.getJsonType(c.geometry):null,[4,this.analyzeCIMSymbol(a,c?w(c.attributes):null,b,r,v)];case 1:return d=l.sent(),[2,this.rasterizeCIMSymbol(d,c,m,f,u)]}})})};d.prototype.analyzeCIMSymbol=function(a,c,m,f,h){return l(this,void 0,void 0,function(){var v,w,d,l,D,C,q;return t(this,function(x){switch(x.label){case 0:return[4,
u.fetchSymbol(a,h)];case 1:return v=x.sent(),w=[],c?d={geometryType:f,spatialReference:this._spatialReference,fields:c}:(v=v.clone(),v.data.primitiveOverrides=[],d=null),[4,r.analyzeCIMSymbol(v.data,m,d,w,this._avoidSDF)];case 2:x.sent();b.throwIfAborted(h);D=0;for(C=w;D<C.length;D++)q=C[D],"CIMPictureMarker"===q.cim.type&&(l||(l=[]),l.push(this.fetchPictureMarkerResource(q,h)));return l?[4,b.all(l)]:[3,4];case 3:x.sent(),x.label=4;case 4:return[2,w]}})})};d.prototype.fetchPictureMarkerResource=function(a,
c){return l(this,void 0,void 0,function(){var b,m,f;return t(this,function(h){switch(h.label){case 0:return b=a.materialHash,this._pictureMarkerCache.get(b)?[3,2]:[4,q(a.cim.url,{responseType:"image",signal:c&&c.signal})];case 1:m=h.sent(),f=m.data,this._pictureMarkerCache.set(b,f),h.label=2;case 2:return[2]}})})};d.prototype.rasterizeCIMSymbol=function(a,c,b,m,f){for(var h=[],u=0;u<a.length;u++){var v=a[u];!b||"function"!==typeof b.scaleFactor||"marker"!==v.type&&"text"!==v.type||(b.scaleFactor=
b.scaleFactor(c,m,f));var w=this._getRasterizedResource(v,c,b,m,f);null!=w&&h.push({cimLayer:v,rasterizedResource:w})}return this.getSymbolImage(h,c,b,m,f)};d.prototype.getSymbolImage=function(a,c,b,h,u){for(var w=document.createElement("canvas"),r=w.getContext("2d"),d=0,l=0,C=0,q=0,E=[],K=0;K<a.length;K++){var t=a[K],J=t.rasterizedResource;if(J){var G=t.cimLayer;if("line"!==G.type&&"fill"!==G.type){var I=v(b,G),W=J.size,p=m.evaluateValueOrFunction(G.offsetX,c,h,u)*I,I=m.evaluateValueOrFunction(G.offsetY,
c,h,u)*I,p=p?p:0,I=I?I:0,L=t.rasterizedResource.anchorX,t=t.rasterizedResource.anchorY,A=!1,k=G.type,e=void 0;"marker"===G.type&&(e=m.evaluateValueOrFunction(G.rotation,c,h,u),A=G.rotateClockwise?G.rotateClockwise:!1);if("text"===G.type){e=m.evaluateValueOrFunction(G.angle,c,h,u);if(void 0!==G.horizontalAlignment)switch(G.horizontalAlignment){case "left":L=-.5;break;case "right":L=.5;break;default:L=0}if(void 0!==G.verticalAlignment)switch(G.verticalAlignment){case "top":t=.5;break;case "bottom":t=
-.5;break;case "baseline":t=-.25;break;default:t=0}}var G=f.pt2px(p)-W[0]*(.5+L),g=f.pt2px(I)-W[1]*(.5+t),n=G+W[0],y=g+W[1];if(e){A&&(e=-e);var B=Math.sin(e*Math.PI/180),F=Math.cos(e*Math.PI/180),W=G*F-g*B,H=G*B+g*F,M=G*F-y*B,X=G*B+y*F,Z=n*F-y*B,y=n*B+y*F,ca=n*F-g*B,B=n*B+g*F,G=Math.min(W,M,Z,ca),g=Math.min(H,X,y,B),n=Math.max(W,M,Z,ca),y=Math.max(H,X,y,B)}d=G<d?G:d;l=g<l?g:l;C=n>C?n:C;q=y>q?y:q;G=r.createImageData(J.size[0],J.size[1]);G.data.set(new Uint8ClampedArray(J.image.buffer));J={offsetX:p,
offsetY:I,rotateClockwise:A,type:k,angle:e,rasterizedImage:G,anchorX:L,anchorY:t};E.push(J)}}}w.width=C-d;w.height=q-l;a=-d;for(K=0;K<E.length;K++)J=E[K],c=this._imageDataToCanvas(J.rasterizedImage),b=a-J.rasterizedImage.width*(.5+J.anchorX),h=q-J.rasterizedImage.height*(.5-J.anchorY),J.angle?(u=(360-J.angle)*Math.PI/180,r.save(),r.translate(f.pt2px(J.offsetX),-f.pt2px(J.offsetY)),r.translate(a,q),r.rotate(u),r.translate(-a,-q),r.drawImage(c,b,h),r.restore()):r.drawImage(c,b+f.pt2px(J.offsetX),h-
f.pt2px(J.offsetY));E=new D.default({x:a/w.width-.5,y:q/w.height-.5});return{imageData:0!==w.width&&0!==w.height?r.getImageData(0,0,w.width,w.height):r.createImageData(1,1),anchorPosition:E}};d.prototype._imageDataToCanvas=function(a){this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas"));var c=this._imageDataCanvas,b=c.getContext("2d");c.width=a.width;c.height=a.height;b.putImageData(a,0,0);return c};d.prototype._imageTo32Array=function(a,c,b){this._imageDataCanvas||(this._imageDataCanvas=
document.createElement("canvas"));var m=this._imageDataCanvas,f=m.getContext("2d");m.width=c;m.height=b;f.drawImage(a,0,0,c,b);return new Uint32Array(f.getImageData(0,0,c,b).data.buffer)};d.prototype._getRasterizedResource=function(a,c,b,h,u){var w;if("text"===a.type)w=a.cim,a=this._rasterizeTextResource(a,c,b,h,u);else{var d=this._resourceCache,l=void 0;"function"===typeof a.materialHash?(l=a.materialHash,l=l(c,h,u),w=r.analyzeCIMResource(a.cim,a.materialOverrides)):(l=a.materialHash,b&&(l+=JSON.stringify(b)),
w=a.cim);if(d.has(l))return d.get(l);b=v(b,a);if("CIMPictureMarker"===a.cim.type){u=m.evaluateValueOrFunction(a.cim.size,c,h,u)*b;c=this._pictureMarkerCache.get(a.materialHash);if(!c)return null;b=c.height/c.width;h=1<b?f.pt2px(u):f.pt2px(u)/b;u=1<b?f.pt2px(u)*b:f.pt2px(u);a={image:this._imageTo32Array(c,h,u),size:[h,u],sdf:!1,simplePattern:!1,anchorX:a.anchorPoint?a.anchorPoint.x:0,anchorY:a.anchorPoint?a.anchorPoint.y:0}}else w.size*=b,a=this._rasterizer.rasterizeJSONResource(w,this._avoidSDF);
d.set(l,a)}return a};d.prototype._rasterizeTextResource=function(a,c,b,f,h){var u=v(b,a);b=m.evaluateValueOrFunction(a.text,c,f,h);if(!b||0===b.length)return null;var w=m.evaluateValueOrFunction(a.fontName,c,f,h),r=m.evaluateValueOrFunction(a.style,c,f,h),d=m.evaluateValueOrFunction(a.weight,c,f,h),l=m.evaluateValueOrFunction(a.decoration,c,f,h),u=m.evaluateValueOrFunction(a.size,c,f,h)*u,D=m.evaluateValueOrFunction(a.horizontalAlignment,c,f,h),q=m.evaluateValueOrFunction(a.verticalAlignment,c,f,
h),C=m.colorToArray(m.evaluateValueOrFunction(a.color,c,f,h)),E=m.colorToArray(m.evaluateValueOrFunction(a.outlineColor,c,f,h));a=m.evaluateValueOrFunction(a.outlineSize,c,f,h);return this._textRasterizer.rasterizeText(b,{color:C,size:u,horizontalAlignment:D,verticalAlignment:q,font:{family:w,style:r,weight:d,decoration:l},halo:{size:a||0,color:E,style:r},pixelRatio:1,premultiplyColors:!this._avoidSDF})};return d}()})},"esri/symbols/cim/Rasterizer":function(){define(["require","exports","./CIMSymbolHelper",
"./SDFHelper","./utils"],function(z,d,t,l,q){Object.defineProperty(d,"__esModule",{value:!0});z=function(){function b(){}b.prototype.dispose=function(){this._rasterizationCanvas=null};b.prototype.rasterizeJSONResource=function(b,h){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));if("simple-fill"===b.type||"esriSFS"===b.type)return h=t.SymbolHelper.rasterizeSimpleFill(this._rasterizationCanvas,b.style),{size:[h[1],h[2]],image:new Uint32Array(h[0].buffer),sdf:!1,
simplePattern:!0,anchorX:0,anchorY:0};if("simple-line"===b.type||"esriSLS"===b.type)return h=t.SymbolHelper.rasterizeSimpleLine(b.style,b.cap),{size:[h[1],h[2]],image:new Uint32Array(h[0].buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0};var f;b="simple-marker"===b.type||"esriSMS"===b.type?t.CIMSymbolHelper.fromSimpleMarker(b):b;if((f=l.getSDFInfo(b))&&!h)return h=l.buildSDF(f),(b=h[0])?{size:[h[1],h[2]],image:new Uint32Array(b.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}:null;h=t.CIMSymbolHelper.rasterize(this._rasterizationCanvas,
b,!h);b=h[0];f=h[3];var c=h[4];return b?{size:[h[1],h[2]],image:new Uint32Array(b.buffer),sdf:!1,simplePattern:!1,anchorX:f,anchorY:c}:null};b.prototype.rasterizeImageResource=function(b,h){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));this._rasterizationCanvas.width=b.width;this._rasterizationCanvas.height=b.height;var f=this._rasterizationCanvas.getContext("2d");b instanceof ImageData?f.putImageData(b,0,0):(b.setAttribute("width",b.width.toString()),b.setAttribute("height",
b.height.toString()),f.drawImage(b,0,0,b.width,b.height));f=f.getImageData(0,0,b.width,b.height);f=new Uint8Array(f.data);if(h)for(var c=0;c<h.length;c++){var a=h[c];if(a&&a.oldColor&&4===a.oldColor.length&&a.newColor&&4===a.newColor.length){var m=a.oldColor,u=m[0],d=m[1],w=m[2],m=m[3],v=a.newColor,a=v[0],l=v[1],C=v[2],t=v[3];if(u!==a||d!==l||w!==C||m!==t)for(v=0;v<f.length;v+=4)u===f[v]&&d===f[v+1]&&w===f[v+2]&&m===f[v+3]&&(f[v]=a,f[v+1]=l,f[v+2]=C,f[v+3]=t)}}for(v=0;v<f.length;v+=4)h=f[v+3]/255,
f[v]*=h,f[v+1]*=h,f[v+2]*=h;h=b.width;c=b.height;u=f;if(512<=h||512<=c)u=b.width/b.height,1<u?(h=512,c=Math.round(512/u)):(c=512,h=Math.round(512*u)),u=new Uint8Array(4*h*c),q.resampleHermite(f,b.width,b.height,new Uint8ClampedArray(u.buffer),h,c,!1);return{size:[h,c],image:new Uint32Array(u.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}};return b}();d.default=z})},"esri/symbols/cim/utils":function(){define(["require","exports"],function(z,d){Object.defineProperty(d,"__esModule",{value:!0});
d.evaluateValueOrFunction=function(d,l,q,b){return"function"===typeof d?d(l,q,b):d};d.colorToArray=function(d){return[d.r,d.g,d.b,d.a]};d.resampleHermite=function(d,l,q,b,f,h,r){void 0===r&&(r=!0);var c=l/f;q/=h;for(var a=Math.ceil(c/2),m=Math.ceil(q/2),u=0;u<h;u++)for(var D=0;D<f;D++){for(var w=4*(D+(r?h-u-1:u)*f),v=0,E=0,C=0,t=0,K=0,G=0,I=0,x=(u+.5)*q,N=Math.floor(u*q);N<(u+1)*q;N++)for(var O=Math.abs(x-(N+.5))/m,P=(D+.5)*c,O=O*O,S=Math.floor(D*c);S<(D+1)*c;S++){var R=Math.abs(P-(S+.5))/a,v=Math.sqrt(O+
R*R);-1<=v&&1>=v&&(v=2*v*v*v-3*v*v+1,0<v&&(R=4*(S+N*l),I+=v*d[R+3],C+=v,255>d[R+3]&&(v=v*d[R+3]/250),t+=v*d[R],K+=v*d[R+1],G+=v*d[R+2],E+=v))}b[w]=t/E;b[w+1]=K/E;b[w+2]=G/E;b[w+3]=I/C}}})},"esri/symbols/cim/TextRasterizer":function(){define(["require","exports","../../core/screenUtils"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});z=function(){function b(){}b.prototype.rasterizeText=function(b,h){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));
var f=this._textRasterizationCanvas,c=f.getContext("2d");this.setFontProperties(c,h);this.parameters=h;this.textLines=b.split(/\r?\n/);this.lineHeight=this.computeLineHeight();b=this.computeTextWidth(c,h);var a=this.lineHeight*this.textLines.length;f.width=b;f.height=a;this.renderedLineHeight=Math.round(this.lineHeight*h.pixelRatio);this.renderedHaloSize=h.halo.size*h.pixelRatio;this.renderedWidth=b*h.pixelRatio;this.renderedHeight=a*h.pixelRatio;f=h.color;this.fillStyle="rgba("+f.slice(0,3).toString()+
","+f[3]+")";this.haloStyle="rgb("+h.halo.color.slice(0,3).toString()+")";var f=this.renderedLineHeight,m=this.renderedHaloSize;this.setFontProperties(c,h);b=c.textAlign;var a=this.renderedWidth,u=("center"===b?.5*a:"right"===b?a:0)+m,a=b=0;0<m&&this.renderHalo(c,u,m,b,a,h);a+=m;b+=u;m=0;for(u=this.textLines;m<u.length;m++){var d=u[m];c.globalCompositeOperation="destination-out";c.fillStyle="rgb(0, 0, 0)";c.fillText(d,b,a);c.globalCompositeOperation="source-over";c.fillStyle=this.fillStyle;c.fillText(d,
b,a);a+=f}c=c.getImageData(0,0,this.renderedWidth,this.renderedHeight);c=new Uint8Array(c.data);if(h.premultiplyColors)for(h=void 0,f=0;f<c.length;f+=4)h=c[f+3]/255,c[f]*=h,c[f+1]*=h,c[f+2]*=h;return{size:[this.renderedWidth,this.renderedHeight],image:new Uint32Array(c.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}};b.prototype.renderHalo=function(b,h,r,c,a,m){var f=this.renderedWidth,d=this.renderedHeight;this._haloRasterizationCanvas||(this._haloRasterizationCanvas=document.createElement("canvas"));
this._haloRasterizationCanvas.width=f;this._haloRasterizationCanvas.height=d;var w=this._haloRasterizationCanvas,v=w.getContext("2d");v.clearRect(0,0,f,d);this.setFontProperties(v,m);v.fillStyle=this.haloStyle;v.strokeStyle=this.haloStyle;m=3>this.renderedHaloSize;v.lineJoin=m?"miter":"round";m?this.renderHaloEmulated(v,h,r):this.renderHaloNative(v,h,r);b.globalAlpha=this.parameters.halo.color[3];b.drawImage(w,0,0,f,d,c,a,f,d);b.globalAlpha=1};b.prototype.renderHaloEmulated=function(b,h,r){for(var c=
this.renderedLineHeight,a=this.renderedHaloSize,m=0,f=this.textLines;m<f.length;m++){for(var d=f[m],w=0,v=l;w<v.length;w++){var q=v[w];b.fillText(d,h+a*q[0],r+a*q[1])}r+=c}};b.prototype.renderHaloNative=function(b,h,r){for(var c=this.renderedLineHeight,a=this.renderedHaloSize,m=0,f=this.textLines;m<f.length;m++){for(var d=f[m],w=2*a,v=0;5>v;v++)b.lineWidth=(.6+.1*v)*w,b.strokeText(d,h,r);r+=c}};b.prototype.setFontProperties=function(b,h){var f=h.font;h=f.style+" "+f.weight+" "+t.pt2px(h.size*h.pixelRatio)+
"px "+f.family+", sans-serif";b.font=h;b.textAlign="left";b.textBaseline="top"};b.prototype.computeTextWidth=function(b,h){for(var f=0,c=0,a=this.textLines;c<a.length;c++)f=Math.max(f,b.measureText(a[c]).width);h=h.font;if("italic"===h.style||"oblique"===h.style||"string"===typeof h.weight&&("bold"===h.weight||"bolder"===h.weight)||"number"===typeof h.weight&&600<h.weight)f+=.3*b.measureText("A").width;f+=2*this.parameters.halo.size;return Math.round(f)};b.prototype.computeLineHeight=function(){return Math.round(1.275*
this.parameters.size+2*this.parameters.halo.size)};return b}();d.TextRasterizer=z;for(var l=[],q=0;360>q;q+=22.5)l.push([Math.cos(Math.PI*q/180),Math.sin(Math.PI*q/180)]);d.default=z})},"esri/symbols/support/previewSymbol2D":function(){define("require exports ../../core/Error ../../core/promiseUtils ../../core/screenUtils ./gfxUtils ./previewUtils ./renderUtils".split(" "),function(z,d,t,l,q,b,f,h){function r(c,b){var m=a.getContext("2d"),f=[];b&&(b.weight&&f.push(b.weight),b.size&&f.push(b.size+
"px"),b.family&&f.push(b.family));m.font=f.join(" ");return m.measureText(c).width}function c(a){if(0===a.length)return 0;if(2<a.length){var c=q.px2pt(1),b=parseFloat(a);switch(a.slice(-2)){case "px":return b;case "pt":return b*c;case "in":return 72*b*c;case "pc":return 12*b*c;case "mm":return b*m*c;case "cm":return b*u*c}}return parseFloat(a)}Object.defineProperty(d,"__esModule",{value:!0});var a=document.createElement("canvas"),m=7.2/2.54,u=72/2.54;d.previewSymbol2D=function(a,m){var u=m&&m.size?
q.pt2px(m.size):null,w=m&&m.maxSize?q.pt2px(m.maxSize):null,d=m&&null!=m.opacity?m.opacity:null,D=m&&null!=m.rotation?m.rotation:null,K=b.getStroke(a),G={shape:null,fill:null,stroke:K};K&&K.width&&(K.width=Math.min(K.width,80));var I=0,x=0;switch(a.type){case "simple-marker":var K=a.style,N=q.pt2px(a.size),I=Math.min(u||N||22,w||120),x=Math.min(u||N||22,w||120);switch(K){case "circle":G.shape={type:"circle",cx:.5*N,cy:.5*N,r:.5*N};break;case "cross":G.shape={type:"path",path:[{command:"M",values:[0,
.5*x]},{command:"L",values:[I,.5*x]},{command:"M",values:[.5*I,0]},{command:"L",values:[.5*I,x]}]};break;case "diamond":G.shape={type:"path",path:[{command:"M",values:[0,.5*x]},{command:"L",values:[.5*I,0]},{command:"L",values:[I,.5*x]},{command:"L",values:[.5*I,x]},{command:"Z",values:[]}]};break;case "square":G.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[I,0]},{command:"L",values:[I,x]},{command:"L",values:[0,x]},{command:"Z",values:[]}]};break;case "triangle":G.shape=
{type:"path",path:[{command:"M",values:[.5*I,0]},{command:"L",values:[I,x]},{command:"L",values:[0,x]},{command:"Z",values:[]}]};break;case "x":G.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[I,x]},{command:"M",values:[I,0]},{command:"L",values:[0,x]}]};break;case "path":G.shape={type:"path",path:a.path||""}}break;case "simple-line":u=Math.min(u||K&&K.width||22,w||80);K.width=u;I=22<u?2*u:40;x=u;G.shape={type:"path",path:[{command:"M",values:[0,x]},{command:"L",values:[I,
x]}]};break;case "picture-fill":case "simple-fill":I=Math.min(u||22,w||120);x=Math.min(u||22,w||120);G.shape=f.shapes.fill[0];break;case "picture-marker":var K=q.pt2px(a.width),O=q.pt2px(a.height),N=Math.max(K,O),O=K/O,K=1>=O?Math.ceil(N*O):N,O=1>=O?N:Math.ceil(N/O),I=Math.min(u||K||22,w||120),x=Math.min(u||O||22,w||120);G.shape={type:"image",x:-Math.round(I/2),y:-Math.round(x/2),width:I,height:x,src:a.url||""};break;case "text":K=a.text||"Aa",N=a.font,u=Math.min(u||q.pt2px(N.size),w||120),O=r(K,
{weight:N.weight,size:u,family:N.family}),I=(w=/[\uE600-\uE6FF]/.test(K))?u:O,x=u,O=.25*c((N?u:0).toString()),w&&(O+=5),G.shape={type:"text",text:K,x:0,y:O,align:"middle",decoration:N&&N.decoration,rotated:a.rotated,kerning:a.kerning},G.font=N&&{size:u,style:N.style,decoration:N.decoration,weight:N.weight,family:N.family}}if(!G.shape)return l.reject(new t("symbolPreview: renderPreviewHTML2D","symbol not supported."));var P=b.getFill(a),u=a.color,w=null;P&&"pattern"===P.type&&u&&"picture-fill"!==a.type?
w=b.getPatternUrlWithColor(P.src,u.toCss(!0)).then(function(a){P.src=a;G.fill=P;return G}):(G.fill=P,w=l.resolve(G));return w.then(function(a){return h.renderSymbol([[a]],[I,x],{node:m&&m.node,scale:!0,opacity:d,rotation:D})})}})},"esri/symbols/support/gfxUtils":function(){define("require exports ../../core/tsSupport/assignHelper ../../Color ../../request ../../core/ItemCache ../../core/promiseUtils ../../core/screenUtils".split(" "),function(z,d,t,l,q,b,f,h){function r(a){if(!a)return null;var c;
switch(a.type){case "simple-fill":case "picture-fill":case "simple-marker":c=r(a.outline);break;case "simple-line":var b=h.pt2px(a.width);"none"!==a.style&&0!==b&&(c={color:a.color,style:D(a.style),width:b,cap:a.cap,join:"miter"===a.join?h.pt2px(a.miterLimit):a.join});break;default:c=null}return c}Object.defineProperty(d,"__esModule",{value:!0});var c=z.toUrl("../../symbols/patterns/"),a={left:"start",center:"middle",right:"end",justify:"start"},m={top:"text-before-edge",middle:"central",baseline:"alphabetic",
bottom:"text-after-edge"},u=new b(1E3);d.getSVGAlign=function(c){return c=(c=c.horizontalAlignment)&&a[c.toLowerCase()]||"middle"};d.getSVGBaseline=function(a){return(a=a.verticalAlignment)&&m[a.toLowerCase()]||"alphabetic"};d.getSVGBaselineShift=function(a){return"bottom"===a.verticalAlignment?"super":null};d.getFill=function(a){var b=a.style,m=null;if(a)switch(a.type){case "simple-marker":"cross"!==b&&"x"!==b&&(m=a.color);break;case "simple-fill":"solid"===b?m=a.color:"none"!==b&&(m={type:"pattern",
x:0,y:0,src:c+b+".png",width:8,height:8});break;case "picture-fill":m={type:"pattern",src:a.url,width:h.pt2px(a.width)*a.xscale,height:h.pt2px(a.height)*a.yscale,x:h.pt2px(a.xoffset),y:h.pt2px(a.yoffset)};break;case "text":m=a.color}return m};d.getPatternUrlWithColor=function(a,c){var b=a+"-"+c;return void 0!==u.get(b)?f.resolve(u.get(b)):q(a,{responseType:"image"}).then(function(a){a=a.data;var m=a.naturalWidth,f=a.naturalHeight,h=document.createElement("canvas");h.width=m;h.height=f;var v=h.getContext("2d");
v.fillStyle=c;v.fillRect(0,0,m,f);v.globalCompositeOperation="destination-in";v.drawImage(a,0,0);a=h.toDataURL();u.put(b,a);return a})};d.getStroke=r;var D=function(){var a={};return function(c){if(a[c])return a[c];var b=c.replace(/-/g,"");return a[c]=b}}();d.defaultThematicColor=new l([128,128,128])})},"esri/core/ItemCache":function(){define(["require","exports","./MemCache"],function(z,d,t){return function(){function d(d,b){this._storage=new t.MemCacheStorage;this._storage.maxSize=d;b&&this._storage.registerRemoveFunc("",
b)}d.prototype.put=function(d,b){this._storage.put(d,b,1,1)};d.prototype.pop=function(d){return this._storage.pop(d)};d.prototype.get=function(d){return this._storage.get(d)};d.prototype.clear=function(){this._storage.clearAll()};d.prototype.destroy=function(){this._storage.clearAll()};return d}()})},"esri/symbols/support/previewUtils":function(){define(["require","exports"],function(z,d){Object.defineProperty(d,"__esModule",{value:!0});d.shapes={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],
pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],
invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",
path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],
tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};d.getPathSymbolShapes=function(d){var l=22,q=22;1>d?l*=.75:1<d&&(q*=1.25);return[{type:"path",path:[{command:"M",values:[22,0]},{command:"L",values:[19.25,0]},{command:"L",values:[0,q-11]},{command:"L",values:[l-11,q-11]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[22,0]},{command:"L",values:[22,2.75]},{command:"L",
values:[l-11,22]},{command:"L",values:[l-11,q-11]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[l-11,q-11]},{command:"L",values:[0,q-11]},{command:"L",values:[0,22]},{command:"L",values:[l-11,22]},{command:"Z",values:[]}]}]};d.getExtrudeSymbolShapes=function(d){d*=.5;return[{type:"path",path:[{command:"M",values:[0,.7*11]},{command:"L",values:[6.6,22*.7]},{command:"L",values:[6.6,22*.7+d]},{command:"L",values:[0,22*.7+d-.7*11]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",
values:[6.6,22*.7]},{command:"L",values:[6.6,22*.7+d]},{command:"L",values:[22,d]},{command:"L",values:[22,0]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[6.6,0]},{command:"L",values:[22,0]},{command:"L",values:[6.6,22*.7]},{command:"L",values:[0,.7*11]},{command:"Z",values:[]}]}]};d.getWaterSymbolShapes=function(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},
{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},
{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]};
d.getCubeShapes=function(d,l){var q=l?20:d,b=l?4:6,b=q=22>=q?q-.5*b:q-b;l=l?.35*q:.5*q;return[{type:"path",path:[{command:"M",values:[.5*b,0]},{command:"L",values:[b,.5*l]},{command:"L",values:[.5*b,l]},{command:"L",values:[0,.5*l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*l]},{command:"L",values:[.5*b,l]},{command:"L",values:[.5*b,d]},{command:"L",values:[0,d-.5*l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*b,l]},{command:"L",values:[.5*b,
d]},{command:"L",values:[b,d-.5*l]},{command:"L",values:[b,.5*l]},{command:"Z",values:[]}]}]};d.getCylinderShapes=function(d,l){var q=l?20:d;l=l?4:6;q=22>=q?q-.5*l:q-l;l=.5*q;var b=.15*q;d-=b;return[{type:"ellipse",cx:.5*q,cy:d,rx:l,ry:b},{type:"path",path:[{command:"M",values:[0,b]},{command:"L",values:[0,d]},{command:"L",values:[q,d]},{command:"L",values:[q,b]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*q,cy:b,rx:l,ry:b}]};d.getConeShapes=function(d,l){var q=l?20:d;l=l?4:6;q=22>=q?q-.5*l:q-
l;l=.15*q;var b=q;d-=l;return[{type:"ellipse",cx:.5*q,cy:d,rx:.5*q,ry:l},{type:"path",path:[{command:"M",values:[.5*b,0]},{command:"L",values:[b,d]},{command:"L",values:[0,d]},{command:"Z",values:[]}]}]};d.getInvertedConeShapes=function(d){var l=d,l=22>l?l-3:l-6,q=.15*l,b=l;return[{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[b,0]},{command:"L",values:[.5*b,d-q]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*l,cy:0,rx:.5*l,ry:q}]};d.getDiamondShapes=function(d){var l=d,l=22>
l?l-2:l-4,q=Math.floor(d/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*l,0]},{command:"L",values:[l,.5*d-q]},{command:"L",values:[.45*l-q,.5*d+q]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*l,0]},{command:"L",values:[.45*l-q,.5*d+q]},{command:"L",values:[0,.5*d-q]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*d-q]},{command:"L",values:[.45*l-q,.5*d+q]},{command:"L",values:[.45*l,d]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",
values:[.45*l,d]},{command:"L",values:[l,.5*d-q]},{command:"L",values:[.45*l-q,.5*d+q]},{command:"Z",values:[]}]}]};d.getTetrahedronShapes=function(d){var l=d,l=22>l?l-1:l-2;return[{type:"path",path:[{command:"M",values:[.45*d,0]},{command:"L",values:[d,l]},{command:"L",values:[.45*d,.6*l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*d,0]},{command:"L",values:[.45*d,.6*l]},{command:"L",values:[0,l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,l]},
{command:"L",values:[.45*d,.6*l]},{command:"L",values:[d,l]},{command:"Z",values:[]}]}]}})},"esri/symbols/support/renderUtils":function(){define("require exports ../../kernel ../../request ../../core/colorUtils ../../core/Error ../../core/has ../../core/promiseUtils ../../libs/maquette/index ./svgUtils".split(" "),function(z,d,t,l,q,b,f,h,r,c){function a(a,c,m){return a?l(a,{responseType:"image"}).then(function(a){a=a.data;var b=a.width,f=a.height,h=b/f,u=c;m&&(u=Math.min(u,Math.max(b,f)));return{image:a,
width:1>=h?Math.ceil(u*h):u,height:1>=h?u:Math.ceil(u/h)}}):h.reject(new b("renderUtils: imageDataSize","href not provided."))}Object.defineProperty(d,"__esModule",{value:!0});var m=r.createProjector();d.renderSymbol=function(a,b,f){var h=Math.ceil(b[0]);b=Math.ceil(b[1]);if(!a.some(function(a){return!!a.length}))return null;var u=f&&f.node||document.createElement("div");null!=f.opacity&&(u.style.opacity=f.opacity.toString());m.append(u,c.renderSVG.bind(null,a,h,b,f));return u};d.tintImageWithColor=
function(c,b,m,h,d){return a(c,b,d).then(function(a){var u=a.width?a.width:b,v=a.height?a.height:b,d;if(d=a.image)d=m&&"ignore"!==h?"multiply"===h&&255===m.r&&255===m.g&&255===m.b&&1===m.a?!1:!0:!1;if(d){var w=a.image.width,r=a.image.height;(f("edge")||f("ie"))&&/\.svg$/i.test(c)&&(--w,--r);var l,D;l=Math.ceil(u);D=Math.ceil(v);d=document.createElement("canvas");d.width=l;d.height=D;d.style.width=l+"px";d.style.height=D+"px";d=d.getContext("2d");d.clearRect(0,0,l,D);d.drawImage(a.image,0,0,w,r,0,
0,u,v);a=d.getImageData(0,0,u,v);w=[m.r/255,m.g/255,m.b/255,m.a];r=q.toHSV(m);for(l=0;l<a.data.length;l+=4){D=a.data;var C=l,E=w,R=r;switch(h){case "multiply":D[C+0]*=E[0];D[C+1]*=E[1];D[C+2]*=E[2];D[C+3]*=E[3];break;default:var Q=q.toHSV({r:D[C+0],g:D[C+1],b:D[C+2]});Q.h=R.h;Q.s=R.s;Q.v=Q.v/100*R.v;R=q.toRGB(Q);D[C+0]=R.r;D[C+1]=R.g;D[C+2]=R.b;D[C+3]*=E[3]}}d.putImageData(a,0,0);c=d.canvas.toDataURL("image/png")}else(d=t.id&&t.id.findCredential(c))&&d.token&&(a=-1===c.indexOf("?")?"?":"\x26",c=""+
c+a+"token\x3d"+d.token);return{url:c,width:u,height:v}}).catch(function(){return{url:c,width:b,height:b}})}})},"esri/core/colorUtils":function(){define(["require","exports"],function(z,d){function t(a,c){var b=[],m,f;if(a[0].length!==c.length)throw"dimensions do not match";var h=a.length,d=a[0].length,r=0;for(m=0;m<h;m++){for(f=r=0;f<d;f++)r+=a[m][f]*c[f];b.push(r)}return b}function l(a){a=[a.r/255,a.g/255,a.b/255].map(function(a){return.04045>=a?a/12.92:Math.pow((a+.055)/1.055,2.4)});a=t(r,a);return{x:100*
a[0],y:100*a[1],z:100*a[2]}}function q(a){a=t(c,[a.x/100,a.y/100,a.z/100]).map(function(a){return Math.min(1,Math.max(.0031308>=a?12.92*a:1.055*Math.pow(a,1/2.4)-.055,0))});return{r:Math.round(255*a[0]),g:Math.round(255*a[1]),b:Math.round(255*a[2])}}function b(a){a=[a.x/95.047,a.y/100,a.z/108.883].map(function(a){return a>Math.pow(6/29,3)?Math.pow(a,1/3):1/3*Math.pow(29/6,2)*a+4/29});return{l:116*a[1]-16,a:500*(a[0]-a[1]),b:200*(a[1]-a[2])}}function f(a){var c=a.l;a=[(c+16)/116+a.a/500,(c+16)/116,
(c+16)/116-a.b/200].map(function(a){return a>6/29?Math.pow(a,3):3*Math.pow(6/29,2)*(a-4/29)});return{x:95.047*a[0],y:100*a[1],z:108.883*a[2]}}function h(a){if("r"in a&&"g"in a&&"b"in a)return a;if("l"in a&&"c"in a&&"h"in a){var c=a.c,b=a.h;return q(f({l:a.l,a:c*Math.cos(b),b:c*Math.sin(b)}))}if("l"in a&&"a"in a&&"b"in a)return q(f(a));if("x"in a&&"y"in a&&"z"in a)return q(a);if("h"in a&&"s"in a&&"v"in a){b=(a.h+360)%360/60;c=a.v/100*255;a=a.s/100*c;var h=a*(1-Math.abs(b%2-1));switch(Math.floor(b)){case 0:b=
{r:a,g:h,b:0};break;case 1:b={r:h,g:a,b:0};break;case 2:b={r:0,g:a,b:h};break;case 3:b={r:0,g:h,b:a};break;case 4:b={r:h,g:0,b:a};break;case 5:case 6:b={r:a,g:0,b:h};break;default:b={r:0,g:0,b:0}}b.r=Math.round(b.r+c-a);b.g=Math.round(b.g+c-a);b.b=Math.round(b.b+c-a);return b}}Object.defineProperty(d,"__esModule",{value:!0});var r=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],c=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];d.toRGB=h;d.toHSV=function(a){if("h"in
a&&"s"in a&&"v"in a)return a;var c=h(a);a=c.r;var b=c.g,c=c.b,f=Math.max(a,b,c),d=f-Math.min(a,b,c),v;0===d?v=0:f===a?v=(b-c)/d%6:f===b?v=(c-a)/d+2:f===c&&(v=(a-b)/d+4);0>v&&(v+=6);return{h:60*v,s:100*(0===d?0:d/f),v:100/255*f}};d.toLAB=function(a){return"l"in a&&"a"in a&&"b"in a?a:b(l(h(a)))};d.toLCH=function(a){if(!("l"in a&&"c"in a&&"h"in a)){var c=b(l(h(a)));a=c.l;var f=c.a,d=c.b,c=Math.sqrt(f*f+d*d),f=Math.atan2(d,f),f=0<f?f:f+2*Math.PI;a={l:a,c:c,h:f}}return a};d.toXYZ=function(a){return"x"in
a&&"y"in a&&"z"in a?a:l(h(a))};d.darken=function(a,c){a=b(l(a));a.l*=1-c;return q(f(a))}})},"esri/symbols/support/svgUtils":function(){define("require exports ../../Color ../../core/has ../../core/libs/gl-matrix-2/mat2df32 ../../core/libs/gl-matrix-2/math/mat2d ../../widgets/support/widget".split(" "),function(z,d,t,l,q,b,f){function h(a){return a.map(function(a){return a.command+" "+a.values.join(" ")}).join(" ").trim()}function r(a,c,b,m){if(a){if("circle"===a.type)return f.tsx("circle",{fill:c,
"fill-rule":"evenodd",stroke:b.color,"stroke-width":b.width,"stroke-linecap":b.cap,"stroke-linejoin":b.join,"stroke-dasharray":b.dashArray,"stroke-miterlimit":"4",cx:a.cx,cy:a.cy,r:a.r});if("ellipse"===a.type)return f.tsx("ellipse",{fill:c,"fill-rule":"evenodd",stroke:b.color,"stroke-width":b.width,"stroke-linecap":b.cap,"stroke-linejoin":b.join,"stroke-dasharray":b.dashArray,"stroke-miterlimit":"4",cx:a.cx,cy:a.cy,rx:a.rx,ry:a.ry});if("rect"===a.type)return f.tsx("rect",{fill:c,"fill-rule":"evenodd",
stroke:b.color,"stroke-width":b.width,"stroke-linecap":b.cap,"stroke-linejoin":b.join,"stroke-dasharray":b.dashArray,"stroke-miterlimit":"4",x:a.x,y:a.y,width:a.width,height:a.height});if("image"===a.type)return f.tsx("image",{href:a.src,x:a.x,y:a.y,width:a.width,height:a.height,preserveAspectRatio:"none"});if("path"===a.type)return a="string"!==typeof a.path?h(a.path):a.path,f.tsx("path",{fill:c,"fill-rule":"evenodd",stroke:b.color,"stroke-width":b.width,"stroke-linecap":b.cap,"stroke-linejoin":b.join,
"stroke-dasharray":b.dashArray,"stroke-miterlimit":"4",d:a});if("text"===a.type)return f.tsx("text",{fill:c,"fill-rule":"evenodd",stroke:b.color,"stroke-width":b.width,"stroke-linecap":b.cap,"stroke-linejoin":b.join,"stroke-dasharray":b.dashArray,"stroke-miterlimit":"4","text-anchor":m.align,"text-decoration":m.decoration,kerning:m.kerning,rotate:m.rotate,"text-rendering":O,"font-style":m.font.style,"font-variant":m.font.variant,"font-weight":m.font.weight,"font-size":m.font.size,"font-family":m.font.family,
x:a.x,y:a.y},a.text)}return null}function c(a){var c={fill:"none",pattern:null,linearGradient:null};if(a)if("type"in a&&"pattern"===a.type){var b="patternId-"+ ++x;c.fill="url(#"+b+")";c.pattern={id:b,x:a.x,y:a.y,width:a.width,height:a.height,image:{x:0,y:0,width:a.width,height:a.height,href:a.src}}}else"type"in a&&"linear"===a.type?(b="linearGradientId-"+ ++N,c.fill="url(#"+b+")",c.linearGradient={id:b,x1:a.x1,y1:a.y1,x2:a.x2,y2:a.y2,stops:a.colors.map(function(a){return{offset:a.offset,color:a.color&&
(new t(a.color)).toString()}})}):a&&(a=new t(a),c.fill=a.toString());return c}function a(a){var c={color:"none",width:1,cap:"butt",join:"4",dashArray:"none"};if(a&&(null!=a.width&&(c.width=a.width),a.cap&&(c.cap=a.cap),a.join&&(c.join=a.join.toString()),a.color&&(c.color=(new t(a.color)).toString()),a.style)){var b=null;a.style in U&&(b=U[a.style]);if(Array.isArray(b)){for(var b=b.slice(0),m=0;m<b.length;++m)b[m]*=a.width;if("butt"!==a.cap){for(m=0;m<b.length;m+=2)b[m]-=a.width,1>b[m]&&(b[m]=1);for(m=
1;m<b.length;m+=2)b[m]+=a.width}b=b.join(",")}c.dashArray=b}return c}function m(a,c){var b={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};a&&(b.align=a.align,b.decoration=a.decoration,b.kerning=a.kerning?"auto":"0",b.rotate=a.rotated?"90":"0",b.font.style=c.style||"normal",b.font.variant=c.variant||"normal",b.font.weight=c.weight||"normal",b.font.size=c.size&&c.size.toString()||"10pt",b.font.family=c.family||"serif");return b}
function u(a){var c=a.pattern;a=a.linearGradient;return c?f.tsx("pattern",{id:c.id,patternUnits:"userSpaceOnUse",x:c.x,y:c.y,width:c.width,height:c.height},f.tsx("image",{x:c.image.x,y:c.image.y,width:c.image.width,height:c.image.height,href:c.image.href})):a?(c=a.stops.map(function(a,c){return f.tsx("stop",{key:c+"-stop",offset:a.offset,"stop-color":a.color})}),f.tsx("linearGradient",{id:a.id,gradientUnits:"userSpaceOnUse",x1:a.x1,y1:a.y1,x2:a.x2,y2:a.y2},c)):null}function D(a,c,m){return b.translate(a,
b.identity(a),[c,m])}function w(a,c,m,f,h){b.scale(a,b.identity(a),[c,m]);a[4]=a[4]*c-f*c+f;a[5]=a[5]*m-h*m+h;return a}function v(a,c,m,f){var h=c%360*Math.PI/180;b.rotate(a,b.identity(a),h);c=Math.cos(h);var h=Math.sin(h),p=a[4],u=a[5];a[4]=p*c-u*h+f*h-m*c+m;a[5]=u*c+p*h-m*h-f*c+f;return a}function E(a,c){R&&"left"in R?(R.left>a&&(R.left=a),R.right<a&&(R.right=a),R.top>c&&(R.top=c),R.bottom<c&&(R.bottom=c)):R={left:a,bottom:c,right:a,top:c}}function C(a){var c=a.args,b=c.length;switch(a.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(a=
0;a<b;a+=2)E(c[a],c[a+1]);Q.x=c[b-2];Q.y=c[b-1];break;case "H":for(a=0;a<b;++a)E(c[a],Q.y);Q.x=c[b-1];break;case "V":for(a=0;a<b;++a)E(Q.x,c[a]);Q.y=c[b-1];break;case "m":a=0;"x"in Q||(E(Q.x=c[0],Q.y=c[1]),a=2);for(;a<b;a+=2)E(Q.x+=c[a],Q.y+=c[a+1]);break;case "l":case "t":for(a=0;a<b;a+=2)E(Q.x+=c[a],Q.y+=c[a+1]);break;case "h":for(a=0;a<b;++a)E(Q.x+=c[a],Q.y);break;case "v":for(a=0;a<b;++a)E(Q.x,Q.y+=c[a]);break;case "c":for(a=0;a<b;a+=6)E(Q.x+c[a],Q.y+c[a+1]),E(Q.x+c[a+2],Q.y+c[a+3]),E(Q.x+=c[a+
4],Q.y+=c[a+5]);break;case "s":case "q":for(a=0;a<b;a+=4)E(Q.x+c[a],Q.y+c[a+1]),E(Q.x+=c[a+2],Q.y+=c[a+3]);break;case "A":for(a=0;a<b;a+=7)E(c[a+5],c[a+6]);Q.x=c[b-2];Q.y=c[b-1];break;case "a":for(a=0;a<b;a+=7)E(Q.x+=c[a+5],Q.y+=c[a+6])}}function J(a,c,b){var m=P[a.toLowerCase()];"number"===typeof m&&(m?c.length>=m&&(a={action:a,args:c.slice(0,c.length-c.length%m)},b.push(a),C(a)):(a={action:a,args:[]},b.push(a),C(a)))}function K(a){var c={x:0,y:0,width:0,height:0};if("circle"===a.type)c.x=a.cx-a.r,
c.y=a.cy-a.r,c.width=2*a.r,c.height=2*a.r;else if("ellipse"===a.type)c.x=a.cx-a.rx,c.y=a.cy-a.ry,c.width=2*a.rx,c.height=2*a.ry;else if("image"===a.type||"rect"===a.type)c.x=a.x,c.y=a.y,c.width=a.width,c.height=a.height;else if("path"===a.type){a=("string"!==typeof a.path?h(a.path):a.path).match(S);var b=[];R={};Q={};if(a){for(var m="",f=[],p=a.length,u=0;u<p;++u){var A=a[u],k=parseFloat(A);isNaN(k)?(m&&J(m,f,b),f=[],m=A):f.push(k)}J(m,f,b);a={x:0,y:0,width:0,height:0};R&&"left"in R&&(a.x=R.left,
a.y=R.top,a.width=R.right-R.left,a.height=R.bottom-R.top)}else a=null;c.x=a.x;c.y=a.y;c.width=a.width;c.height=a.height}return c}function G(a){for(var c={x:0,y:0,width:0,height:0},b=null,m=Number.NEGATIVE_INFINITY,f=Number.NEGATIVE_INFINITY,p=0;p<a.length;p++){var h=a[p];b?(b.x=Math.min(b.x,h.x),b.y=Math.min(b.y,h.y),m=Math.max(m,h.x+h.width),f=Math.max(f,h.y+h.height)):(b=c,b.x=h.x,b.y=h.y,m=h.x+h.width,f=h.y+h.height)}b&&(b.width=m-b.x,b.height=f-b.y);return b}function I(a,c,m,f,h,p){var u=c/2,
A=m/2,k=a.width+f,e=a.height+f,g=q.mat2df32.create(),n=q.mat2df32.create(),y=!1;if(h&&0!==k&&0!==e){h=k/e;var y=c>m?c:m,B=1,F=1;isNaN(y)||(1<h?(B=y/k,F=y/h/e):(F=y/e,B=y*h/k));b.multiply(n,n,w(g,B,F,u,A));y=!0}h=a.x+(k-f)/2;a=a.y+(e-f)/2;b.multiply(n,n,D(g,u-h,A-a));!y&&(k>c||e>m)&&(u=k/c>e/m,c=(u?c:m)/(u?k:e),b.multiply(n,n,w(g,c,c,h,a)));p&&b.multiply(n,n,v(g,p,h,a));return"matrix("+n[0]+","+n[1]+","+n[2]+","+n[3]+","+n[4]+","+n[5]+")"}Object.defineProperty(d,"__esModule",{value:!0});var x=0,N=
0,O=l("chrome")?"auto":"optimizeLegibility",P={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},S=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g,R={},Q={},U={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};d.renderShape=r;d.generateFillAttributes=c;d.generateStrokeAttributes=a;d.generateTextAttributes=m;d.renderDef=u;d.getBoundingBox=K;d.computeBBox=
G;d.getTransformMatrix=I;d.renderSVG=function(b,h,v,d){for(var w=[],p=[],l=0;l<b.length;l++){for(var A=[],k=[],e=0,g=0,n=b[l];g<n.length;g++){var y=n[g],B=y.shape,F=y.fill,H=y.stroke,y=y.font,e=e+(H&&H.width||0),F=c(F),H=a(H),y="text"===B.type?m(B,y):null;w.push(u(F));A.push(r(B,F.fill,H,y));k.push(K(B))}k=I(G(k),h,v,e,d&&d.scale,d&&d.rotation);p.push(f.tsx("g",{transform:k},A))}return f.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:h,height:v},f.tsx("defs",null,w),p)}})},"esri/core/libs/gl-matrix-2/mat2df32":function(){define(["require",
"exports","./factories/mat2df32"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});d.mat2df32=t})},"esri/core/libs/gl-matrix-2/factories/mat2df32":function(){define(["require","exports"],function(z,d){function t(d,q,b,f){var h=q[f];q=q[f+1];d[f]=b[0]*h+b[2]*q+b[4];d[f+1]=b[1]*h+b[3]*q+b[5]}Object.defineProperty(d,"__esModule",{value:!0});d.create=function(){var d=new Float32Array(6);d[0]=1;d[3]=1;return d};d.clone=function(d){var l=new Float32Array(6);l[0]=d[0];l[1]=d[1];l[2]=d[2];
l[3]=d[3];l[4]=d[4];l[5]=d[5];return l};d.fromValues=function(d,q,b,f,h,r){var c=new Float32Array(6);c[0]=d;c[1]=q;c[2]=b;c[3]=f;c[4]=h;c[5]=r;return c};d.createView=function(d,q){return new Float32Array(d,q,6)};d.transform=t;d.transformMany=function(d,q,b,f,h,r){void 0===f&&(f=0);void 0===h&&(h=0);void 0===r&&(r=2);for(h=h||q.length/r;f<h;f++)t(d,q,b,f*r)}})},"esri/core/libs/gl-matrix-2/math/mat2d":function(){define(["require","exports","./common"],function(z,d,t){function l(b,f,h){var d=f[0],c=
f[1],a=f[2],m=f[3],u=f[4];f=f[5];var l=h[0],w=h[1],v=h[2],q=h[3],C=h[4];h=h[5];b[0]=d*l+a*w;b[1]=c*l+m*w;b[2]=d*v+a*q;b[3]=c*v+m*q;b[4]=d*C+a*h+u;b[5]=c*C+m*h+f;return b}function q(b,f,h){b[0]=f[0]-h[0];b[1]=f[1]-h[1];b[2]=f[2]-h[2];b[3]=f[3]-h[3];b[4]=f[4]-h[4];b[5]=f[5]-h[5];return b}Object.defineProperty(d,"__esModule",{value:!0});d.copy=function(b,f){b[0]=f[0];b[1]=f[1];b[2]=f[2];b[3]=f[3];b[4]=f[4];b[5]=f[5];return b};d.identity=function(b){b[0]=1;b[1]=0;b[2]=0;b[3]=1;b[4]=0;b[5]=0;return b};
d.set=function(b,f,h,d,c,a,m){b[0]=f;b[1]=h;b[2]=d;b[3]=c;b[4]=a;b[5]=m;return b};d.invert=function(b,f){var h=f[0],d=f[1],c=f[2],a=f[3],m=f[4];f=f[5];var u=h*a-d*c;if(!u)return null;u=1/u;b[0]=a*u;b[1]=-d*u;b[2]=-c*u;b[3]=h*u;b[4]=(c*f-a*m)*u;b[5]=(d*m-h*f)*u;return b};d.determinant=function(b){return b[0]*b[3]-b[1]*b[2]};d.multiply=l;d.rotate=function(b,f,h){var d=f[0],c=f[1],a=f[2],m=f[3],u=f[4];f=f[5];var l=Math.sin(h);h=Math.cos(h);b[0]=d*h+a*l;b[1]=c*h+m*l;b[2]=d*-l+a*h;b[3]=c*-l+m*h;b[4]=u;
b[5]=f;return b};d.scale=function(b,f,h){var d=f[1],c=f[2],a=f[3],m=f[4],u=f[5],l=h[0];h=h[1];b[0]=f[0]*l;b[1]=d*l;b[2]=c*h;b[3]=a*h;b[4]=m;b[5]=u;return b};d.translate=function(b,f,h){var d=f[0],c=f[1],a=f[2],m=f[3],u=f[4];f=f[5];var l=h[0];h=h[1];b[0]=d;b[1]=c;b[2]=a;b[3]=m;b[4]=d*l+a*h+u;b[5]=c*l+m*h+f;return b};d.fromRotation=function(b,f){var h=Math.sin(f);f=Math.cos(f);b[0]=f;b[1]=h;b[2]=-h;b[3]=f;b[4]=0;b[5]=0;return b};d.fromScaling=function(b,f){b[0]=f[0];b[1]=0;b[2]=0;b[3]=f[1];b[4]=0;b[5]=
0;return b};d.fromTranslation=function(b,f){b[0]=1;b[1]=0;b[2]=0;b[3]=1;b[4]=f[0];b[5]=f[1];return b};d.str=function(b){return"mat2d("+b[0]+", "+b[1]+", "+b[2]+", "+b[3]+", "+b[4]+", "+b[5]+")"};d.frob=function(b){return Math.sqrt(Math.pow(b[0],2)+Math.pow(b[1],2)+Math.pow(b[2],2)+Math.pow(b[3],2)+Math.pow(b[4],2)+Math.pow(b[5],2)+1)};d.add=function(b,f,h){b[0]=f[0]+h[0];b[1]=f[1]+h[1];b[2]=f[2]+h[2];b[3]=f[3]+h[3];b[4]=f[4]+h[4];b[5]=f[5]+h[5];return b};d.subtract=q;d.multiplyScalar=function(b,f,
h){b[0]=f[0]*h;b[1]=f[1]*h;b[2]=f[2]*h;b[3]=f[3]*h;b[4]=f[4]*h;b[5]=f[5]*h;return b};d.multiplyScalarAndAdd=function(b,f,h,d){b[0]=f[0]+h[0]*d;b[1]=f[1]+h[1]*d;b[2]=f[2]+h[2]*d;b[3]=f[3]+h[3]*d;b[4]=f[4]+h[4]*d;b[5]=f[5]+h[5]*d;return b};d.exactEquals=function(b,f){return b[0]===f[0]&&b[1]===f[1]&&b[2]===f[2]&&b[3]===f[3]&&b[4]===f[4]&&b[5]===f[5]};d.equals=function(b,f){var h=b[0],d=b[1],c=b[2],a=b[3],m=b[4];b=b[5];var u=f[0],l=f[1],w=f[2],v=f[3],q=f[4];f=f[5];return Math.abs(h-u)<=t.EPSILON*Math.max(1,
Math.abs(h),Math.abs(u))&&Math.abs(d-l)<=t.EPSILON*Math.max(1,Math.abs(d),Math.abs(l))&&Math.abs(c-w)<=t.EPSILON*Math.max(1,Math.abs(c),Math.abs(w))&&Math.abs(a-v)<=t.EPSILON*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(m-q)<=t.EPSILON*Math.max(1,Math.abs(m),Math.abs(q))&&Math.abs(b-f)<=t.EPSILON*Math.max(1,Math.abs(b),Math.abs(f))};d.mul=l;d.sub=q})},"esri/symbols/support/previewSymbol3D":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/colorUtils ../../core/compilerUtils ../../core/Error ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/screenUtils ./gfxUtils ./IconSymbol3DLayerResource ./ObjectSymbol3DLayerResource ./previewUtils ./renderUtils ./styleUtils ./utils".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u,D,w,v,E){function C(a){var b=a.outline,p=h.isSome(a.material)?a.material.color:null,p=h.isSome(p)?p.toRgba().toString():null;if(h.isNone(b))return"fill"===a.type&&"255,255,255,1"===p?{color:"#bdc3c7",width:.75}:null;a=c.pt2px(b.size)||0;return{color:"rgba("+(h.isSome(b.color)?b.color.toRgba():"255,255,255,1")+")",width:Math.min(a,80)}}function J(a,c){var p=c&&c.resource,p=p&&p.href;return a.thumbnail&&a.thumbnail.url?r.resolve(a.thumbnail.url):p&&"object"!==c.type?
r.resolve(E.getIconHref(a,c)):a.styleOrigin&&(a.styleOrigin.styleName||a.styleOrigin.styleUrl)?v.resolveWebStyleSymbol(a.styleOrigin,{portal:a.styleOrigin.portal},"webRef").catch(function(p){return p}).then(function(p){return p&&p.thumbnail&&p.thumbnail.url||Y}):r.resolve(Y)}function K(a,c){void 0===c&&(c=1);var p=a.a;a=l.toHSV(a);c=l.toRGB({h:a.h,s:a.s/c,v:100-(100-a.v)/c});return[c.r,c.g,c.b,p]}function G(a,c){return Math.round(Math.min(Math.max(a+191.25*c,0),255))}function I(a){return"water"===
a.type?h.isNone(a.color)?null:a.color:h.isNone(a.material)||h.isNone(a.material.color)?null:a.material.color}function x(c,b){void 0===b&&(b=0);c=I(c);if(!c)return b=G(a.defaultThematicColor.r,b),[b,b,b,100];c=c.toRgba();for(var p=0;3>p;p++)c[p]=G(c[p],b);return c}function N(a){return a.outline?C(a):{color:"rgba(0, 0, 0, 1)",width:1.5}}function O(a,c){a=I(a);if(!a)return null;var p;p="rgba("+(G(a.r,c)+",");p+=G(a.g,c)+",";p+=G(a.b,c)+",";return p+a.a+");"}function P(a,b){b=O(a,b);if(!b)return{};a=
Math.min(a.size?c.pt2px(a.size):.75,80);return{color:b,width:a}}function S(a,c,p){p*=.75;return{type:"linear",x1:p?.25*p:0,y1:p?.5*p:0,x2:p||4,y2:p?.5*p:4,colors:[{color:a,offset:0},{color:c,offset:1}]}}function R(a){var c=a.depth,p=a.height;return(a=a.width)&&c&&p&&a===c&&a<p}function Q(a,c,p){var b=[];if(!a)return b;switch(a.type){case "icon":var A=a.resource&&a.resource.primitive||m.defaultPrimitive;switch(A){case "circle":b.push({shape:{type:"circle",cx:0,cy:0,r:.5*c},fill:x(a,0),stroke:C(a)});
break;case "square":b.push({shape:{type:"path",path:[{command:"M",values:[0,c]},{command:"L",values:[0,0]},{command:"L",values:[c,0]},{command:"L",values:[c,c]},{command:"Z",values:[]}]},fill:x(a,0),stroke:C(a)});break;case "triangle":b.push({shape:{type:"path",path:[{command:"M",values:[0,c]},{command:"L",values:[.5*c,0]},{command:"L",values:[c,c]},{command:"Z",values:[]}]},fill:x(a,0),stroke:C(a)});break;case "cross":b.push({shape:{type:"path",path:[{command:"M",values:[.5*c,0]},{command:"L",values:[.5*
c,c]},{command:"M",values:[0,.5*c]},{command:"L",values:[c,.5*c]}]},stroke:N(a)});break;case "x":b.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[c,c]},{command:"M",values:[c,0]},{command:"L",values:[0,c]}]},stroke:N(a)});break;case "kite":b.push({shape:{type:"path",path:[{command:"M",values:[0,.5*c]},{command:"L",values:[.5*c,0]},{command:"L",values:[c,.5*c]},{command:"L",values:[.5*c,c]},{command:"Z",values:[]}]},fill:x(a,0),stroke:C(a)});break;default:q.neverReached(A)}break;
case "object":switch(A=a.resource&&a.resource.primitive||u.defaultPrimitive,A){case "cone":A=x(a,0);a=x(a,-.6);a=S(A,a,p?20:c);c=D.getConeShapes(c,p);b.push({shape:c[0],fill:a});b.push({shape:c[1],fill:a});break;case "inverted-cone":p=x(a,0);a=x(a,-.6);a=S(p,a,c);c=D.getInvertedConeShapes(c);b.push({shape:c[0],fill:a});b.push({shape:c[1],fill:p});break;case "cube":c=D.getCubeShapes(c,p);b.push({shape:c[0],fill:x(a,0)});b.push({shape:c[1],fill:x(a,-.3)});b.push({shape:c[2],fill:x(a,-.5)});break;case "cylinder":var A=
x(a,0),k=x(a,-.6),A=S(A,k,p?20:c);c=D.getCylinderShapes(c,p);b.push({shape:c[0],fill:A});b.push({shape:c[1],fill:A});b.push({shape:c[2],fill:x(a,0)});break;case "diamond":c=D.getDiamondShapes(c);b.push({shape:c[0],fill:x(a,-.3)});b.push({shape:c[1],fill:x(a,0)});b.push({shape:c[2],fill:x(a,-.3)});b.push({shape:c[3],fill:x(a,-.7)});break;case "sphere":p=x(a,0);a=x(a,-.6);a=S(p,a);a.x1=0;a.y1=0;a.x2=.25*c;a.y2=.25*c;b.push({shape:{type:"circle",cx:0,cy:0,r:.5*c},fill:a});break;case "tetrahedron":c=
D.getTetrahedronShapes(c);b.push({shape:c[0],fill:x(a,-.3)});b.push({shape:c[1],fill:x(a,0)});b.push({shape:c[2],fill:x(a,-.6)});break;default:q.neverReached(A)}}return b}function U(a,b){var p=b&&b.size?c.pt2px(b.size):null,m=b&&b.maxSize?c.pt2px(b.maxSize):null,A=b&&b.disableUpsampling,k=a.symbolLayers,e=[],g=0,n=0,y=k.getItemAt(k.length-1),B;y&&"icon"===y.type&&(B=y.size&&c.pt2px(y.size));k.forEach(function(k){if("icon"===k.type||"object"===k.type){var y="icon"===k.type?k.size&&c.pt2px(k.size):
0,F=p||y?Math.ceil(Math.min(p||y,m||120)):22;if(k&&k.resource&&k.resource.href){var f=J(a,k).then(function(e){var g=k.get("material.color"),n;n="icon"===k.type?"multiply":"tint";return w.tintImageWithColor(e,F,g,n,A)}).then(function(e){var k=e.width,y=e.height;g=Math.max(g,k);n=Math.max(n,y);return[{shape:{type:"image",x:0,y:0,width:k,height:y,src:e.url},fill:null,stroke:null}]});e.push(f)}else f=F,"icon"===k.type&&B&&p&&(f=y/B*F),y=b&&"tall"===b.symbolConfig||("object"===k.type?R(k):!1),g=Math.max(g,
y?20:f),n=Math.max(n,f),e.push(r.resolve(Q(k,f,y)))}});return r.eachAlways(e).then(function(e){var k=[];e.forEach(function(e){e.value?k.push(e.value):e.error&&T.warn("error while building swatchInfo!",e.error)});return w.renderSymbol(k,[g,n],{node:b&&b.node,scale:!1,opacity:b&&b.opacity})})}function V(a,b){var p=a.symbolLayers,m=[];a=E.isVolumetricSymbol(a);var A=b&&b.size?c.pt2px(b.size):null,k=(b&&b.maxSize?c.pt2px(b.maxSize):null)||80,e=0,g=0,n;p.forEach(function(y,B){if(y&&("line"===y.type||"path"===
y.type)){var p=[];switch(y.type){case "line":var a=P(y,0),c=a&&a.width||0;0===B&&(n=c);var b=Math.min(A||c,k);B=0===B?b:A?c/n*b:b;g=Math.max(g,B);e=Math.max(e,20<B?2*B:40);a.width=B;p.push({shape:{type:"path",path:[{command:"M",values:[0,.5*g]},{command:"L",values:[e,.5*g]}]},stroke:a});break;case "path":B=Math.min(A||22,k);c=x(y,0);b=x(y,-.2);a=(a=O(y,-.4))?{color:a,width:1}:{};if("quad"===y.profile){var f=y.width||y.size;y=y.height||y.size;y=D.getPathSymbolShapes(f&&y?f/y:1);a=t({},a,{join:"bevel"});
p.push({shape:y[0],fill:b,stroke:a});p.push({shape:y[1],fill:b,stroke:a});p.push({shape:y[2],fill:c,stroke:a})}else p.push({shape:D.shapes.pathSymbol3DLayer[0],fill:b,stroke:a}),p.push({shape:D.shapes.pathSymbol3DLayer[1],fill:c,stroke:a});e=g=Math.max(g,B)}m.push(p)}});return r.resolve(w.renderSymbol(m,[e,g],{node:b&&b.node,scale:a,opacity:b&&b.opacity}))}Object.defineProperty(d,"__esModule",{value:!0});var Y=z.toUrl("../../images/Legend/legend3dsymboldefault.png"),T=f.getLogger("esri.symbols.support.previewSymbol3D");
d.getSymbolLayerFill=x;d.previewSymbol3D=function(a,m){if(0===a.symbolLayers.length)return r.reject(new b("symbolPreview: renderPreviewHTML3D","No symbolLayers in the symbol."));var p=null;switch(a.type){case "point-3d":p=U(a,m);break;case "line-3d":p=V(a,m);break;case "polygon-3d":case "mesh-3d":p="mesh-3d"===a.type;a=a.symbolLayers;for(var f=m&&m.size?c.pt2px(m.size):null,A=m&&m.maxSize?c.pt2px(m.maxSize):null,f=f||22,k=[],e=0,g=0,n=!1,y=0;y<a.length;y++){var B=a.getItemAt(y),F=[];if(!p||"fill"===
B.type){var H=D.shapes.fill[0];switch(B.type){case "fill":var M=C(B),X=Math.min(f,A||120),e=Math.max(e,X),g=Math.max(g,X),n=!0;F.push({shape:H,fill:x(B,0),stroke:M});break;case "line":H={stroke:P(B,0),shape:H};e=Math.max(e,22);g=Math.max(g,22);F.push(H);break;case "extrude":var M=t({join:"round"},P(B,-.4)),H=x(B,0),B=x(B,-.2),X=Math.min(f,A||120),h=D.getExtrudeSymbolShapes(X);M.width=1;F.push({shape:h[0],fill:B,stroke:M});F.push({shape:h[1],fill:B,stroke:M});F.push({shape:h[2],fill:H,stroke:M});H=
22*.7+.5*X;e=Math.max(e,22);g=Math.max(g,H);break;case "water":n=I(B),H=K(n),B=K(n,2),M=K(n,3),X=D.getWaterSymbolShapes(),n=!0,F.push({shape:X[0],fill:H}),F.push({shape:X[1],fill:B}),F.push({shape:X[2],fill:M}),X=Math.min(f,A||120),e=Math.max(e,X),g=Math.max(g,X)}k.push(F)}}p=r.resolve(w.renderSymbol(k,[e,g],{node:m&&m.node,scale:n,opacity:m&&m.opacity}))}return p?p:r.reject(new b("symbolPreview: swatchInfo3D","symbol not supported."))}})},"esri/symbols/support/utils":function(){define("require exports ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../Color ../../symbols ../../core/asyncUtils ../../core/compilerUtils ../../core/has ../../core/maybe ../../core/screenUtils ../../core/libs/gl-matrix-2/vec3f64 ./gfxUtils ./Symbol3DMaterial @dojo/framework/shim/Promise".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u,D){function w(a,c){if(null==c)return a;a=a.toRgba();a[3]*=c;return new q(a)}function v(a,b,m){if(a=a.symbolLayers){var f=function(a){a=c.isSome(a)?a:null;b=b||a||null!=m&&N;return w(b,m)};a.forEach(function(a){if("object"!==a.type||null==a.resource.href||b)if("water"===a.type)a.color=f(a.color);else{var h=c.isSome(a.material)?a.material.color:null,h=f(h);c.isNone(a.material)?a.material=new D.default({color:h}):a.material.color=h;null!=m&&"outline"in a&&c.isSome(a.outline)&&
c.isSome(a.outline.color)&&(a.outline.color=w(a.outline.color,m))}})}}function E(a,c){return l(this,void 0,void 0,function(){var b,m=this;return t(this,function(h){switch(h.label){case 0:return(b=a.symbolLayers)?[4,f.forEach(b,function(a){return l(m,void 0,void 0,function(){return t(this,function(b){return[2,C(a,c)]})})})]:[2];case 1:return h.sent(),[2]}})})}function C(a,c){return l(this,void 0,void 0,function(){var b;return t(this,function(f){switch(f.label){case 0:b=a.type;switch(b){case "icon":return[3,
1];case "line":return[3,1];case "extrude":return[3,1];case "text":return[3,1];case "path":return[3,2];case "object":return[3,3];case "fill":return[3,5];case "water":return[3,5]}return[3,6];case 1:for(f=0;f<c.length;f++){var u=c[f];if("number"===typeof u){a.size=u;break}}return[3,7];case 2:return f=K(c,m.vec3f64.ONES,[a.width,void 0,a.height]),a.width=I(c[0],a.width,1,f),a.height=I(c[2],a.height,1,f),[3,7];case 3:return[4,J(a,c)];case 4:return f.sent(),[3,7];case 5:return[3,7];case 6:h.neverReached(a),
f.label=7;case 7:return[2]}})})}function J(a,c){return l(this,void 0,void 0,function(){var b,m,f,h;return t(this,function(u){switch(u.label){case 0:return[4,G(a)];case 1:return b=u.sent(),m=b.resourceSize,f=b.symbolSize,h=K(c,m,f),a.width=I(c[0],f[0],m[0],h),a.depth=I(c[1],f[1],m[1],h),a.height=I(c[2],f[2],m[2],h),[2]}})})}function K(a,c,b){for(var m=0;3>m;m++){var f=a[m];switch(f){case "symbol-value":return null!=b[m]?b[m]/c[m]:1;case "proportional":break;default:if(f&&c[m])return f/c[m]}}return 1}
function G(a){return l(this,void 0,void 0,function(){var c,b,m,f,h,u,d,v;return t(this,function(w){switch(w.label){case 0:return[4,new Promise(function(a,p){z(["./symbolLayerUtils"],a,p)})];case 1:return c=w.sent(),[4,c.computeObjectLayerResourceSize(a,10)];case 2:b=w.sent();m=a.width;f=a.height;h=a.depth;u=[m,h,f];d=1;for(v=0;3>v;v++)if(null!=u[v]){d=u[v]/b[v];break}for(v=0;3>v;v++)null==u[v]&&(u[v]=b[v]*d);return[2,{resourceSize:b,symbolSize:u}]}})})}function I(a,c,b,m){switch(a){case "proportional":return b*
m;case "symbol-value":return null!=c?c:b;default:return a}}Object.defineProperty(d,"__esModule",{value:!0});var x=/\/resource\/(.*?)\.svg$/,N=new q("white");d.getSymbolOutlineSize=function(m){if(!m)return 0;if(b.isSymbol3D(m)){var f=m.symbolLayers&&m.symbolLayers.length;f?(m=m.symbolLayers.getItemAt(f-1),m="outline"in m?c.get(m,"outline","size"):void 0):m=void 0;return c.isSome(m)?m:0}return(m=u.getStroke(m))&&a.px2pt(m.width)||0};d.isVolumetricSymbol=function(a){if(!a||!a.symbolLayers)return!1;switch(a.type){case "point-3d":return a.symbolLayers.some(function(a){return"object"===
a.type});case "line-3d":return a.symbolLayers.some(function(a){return"path"===a.type});case "polygon-3d":return a.symbolLayers.some(function(a){return"object"===a.type||"extrude"===a.type});default:return!1}};d.getIconHref=function(a,c){c=c.resource.href;return!r("esri-canvas-svg-support")&&a.styleOrigin&&x.test(c)?c.replace(x,"/resource/png/$1.png"):c};d.applyOpacityToColor=w;d.applyColorToSymbol=function(a,c,m){if(a&&(c||null!=m))if(c&&(c=new q(c)),b.isSymbol3D(a))v(a,c,m);else if(b.isSymbol2D(a)){if(c=
c||a.color)a.color=w(c,m);null!=m&&"outline"in a&&a.outline&&a.outline.color&&(a.outline.color=w(a.outline.color,m))}};d.applySizesToSymbol=function(a,c){return l(this,void 0,void 0,function(){return t(this,function(m){if(!a||!c)return[2];if(b.isSymbol3D(a))return[2,E(a,c)];if(b.isSymbol2D(a)&&(m=c[0],"number"===typeof m))switch(a.type){case "simple-marker":a.size=m;break;case "picture-marker":var f=a.width/a.height;1<f?(a.width=m,a.height=m*f):(a.width=m*f,a.height=m);break;case "simple-line":a.width=
m;break;case "text":a.font.size=m;break;case "simple-fill":case "picture-fill":break;case "cim":break;default:h.neverReached(a)}return[2]})})};d.applyRotationToSymbol=function(a,c,m){a&&null!=c&&(b.isSymbol3D(a)?(a=a.symbolLayers)&&a.forEach(function(a){if(a&&"object"===a.type)switch(m){case "tilt":a.tilt=c;break;case "roll":a.roll=c;break;default:a.heading=c}}):!b.isSymbol2D(a)||"simple-marker"!==a.type&&"picture-marker"!==a.type&&"text"!==a.type||(a.angle=c))}})},"esri/symbols/support/previewWebStyleSymbol":function(){define(["require",
"exports","../../request","../../core/screenUtils"],function(z,d,t,l){Object.defineProperty(d,"__esModule",{value:!0});d.previewWebStyleSymbol=function(d,b,f){var h=d.thumbnail&&d.thumbnail.url;return h?t(h,{responseType:"image"}).then(function(b){b=b.data;var c=!/\\.svg$/i.test(b.src)&&f&&f.disableUpsampling,a=Math.max(b.width,b.height),m=f&&null!=f.maxSize?l.pt2px(f.maxSize):120;c&&(m=Math.min(a,m));c=Math.min(m,f&&null!=f.size?l.pt2px(f.size):a);c!==a&&(a=0!==b.width&&0!==b.height?b.width/b.height:
1,1<=a?(b.width=c,b.height=c/a):(b.width=c*a,b.height=c));return f&&f.node?(f.node.appendChild(b),f.node):b}):d.fetchSymbol().then(function(h){return b(h,f)})}})},"esri/widgets/FeatureTemplates/TemplateItemGroup":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/Identifiable ../../core/accessorSupport/decorators".split(" "),function(z,d,t,l,q,b,f){return function(b){function h(c){c=b.call(this,c)||this;c.items=
null;c.label=null;return c}t(h,b);l([f.property()],h.prototype,"items",void 0);l([f.property()],h.prototype,"label",void 0);return h=l([f.subclass("esri.widgets.FeatureTemplates.TemplateItemGroup")],h)}(f.declared(b.IdentifiableMixin(q)))})},"esri/widgets/FeatureTemplates/ItemList":function(){define(["require","exports","../../core/tsSupport/assignHelper","../support/jsxFactory","../support/widgetUtils"],function(z,d,t,l,q){function b(c){var b=c.identify,m=c.items,f=c.renderIcon,d=c.filterText,E=
c.onItemMouseLeave,C=c.onItemMouseEnter,t=c.onItemSelect;return 0===m.length?l.tsx("div",{class:a.noMatchesMessage,key:"no-matches"},c.messages.noMatches):m[0].items?l.tsx("div",{class:a.scroller,key:"item-container"},m.map(function(a){return r({group:a,filterText:d,identify:b,renderIcon:f,onItemMouseLeave:E,onItemMouseEnter:C,onItemSelect:t})})):l.tsx("ul",{class:q.classes(a.list,a.scroller),key:"item-container"},m.map(function(a){return h({item:a,identify:b,grouped:!0,onItemMouseLeave:E,onItemMouseEnter:C,
onItemSelect:t,renderIcon:f,filterText:d})}))}function f(c){var b=c.id+"-placeholder";return l.tsx("div",{class:a.filterContainer,key:"filter"},l.tsx("input",{"aria-labelledby":b,class:q.classes(a.input,a.filterInput),oninput:function(a){a=a.currentTarget;c.onFilterChange&&c.onFilterChange(a.value)},value:c.filterText,type:"search"}),c.filterText?null:l.tsx("div",{class:a.filterPlaceholder,id:b,key:"placeholder"},l.tsx("span",{class:a.searchIcon,"aria-hidden":"true"}),l.tsx("div",{class:a.filterPlaceholderText},
c.messages.filterPlaceholder)))}function h(b){var m=b.identify,f=b.item,h=b.grouped,d=b.filterText,r=b.onItemSelect,q=b.onItemMouseEnter,t=b.onItemMouseLeave;b=b.renderIcon;m=(m&&m(f)||f.id)+"__"+f.label;return l.tsx("li",{"aria-level":h?"2":"",class:a.item,"data-item":f,key:m,onclick:function(a){a=a.currentTarget["data-item"];r&&r(a)},onmouseenter:function(a){a=a.currentTarget["data-item"];q&&q(a)},onkeydown:function(a){if("Enter"===a.key||"Space"===a.key)a=a.currentTarget["data-item"],r&&r(a)},
onmouseleave:function(a){a=a.currentTarget["data-item"];t&&t(a)},tabIndex:0},l.tsx("div",{class:a.itemContainer},b&&b({item:f}),c({text:f.label,match:d})))}function r(b){var m=b.group,f=b.identify,d=b.onItemMouseLeave,v=b.onItemMouseEnter,r=b.onItemSelect,C=b.filterText,t=b.renderIcon;b=(f&&f(m)||m.id)+"-heading";return l.tsx("section",{"aria-labelledby":b,class:a.group,key:m.label},l.tsx("h4",{"aria-level":"1",id:b,class:q.classes(a.groupHeader)},c({text:m.label,match:C})),l.tsx("ul",{class:a.list},
m.items.map(function(a){return h({item:a,identify:f,grouped:!0,onItemMouseLeave:d,onItemMouseEnter:v,onItemSelect:r,renderIcon:t,filterText:C})})))}function c(c){var b=c.match;c=c.text;var m=null;if(b){var m=c.toLowerCase(),f=b.toLowerCase(),h=m.indexOf(f);-1===h?m=c:(m=c.substring(0,h),f=c.substr(h,b.length),b=c.substring(h+b.length),m=l.tsx("span",null,m,l.tsx("strong",null,f),b))}else m=c;return l.tsx("span",{class:a.itemLabel},m)}Object.defineProperty(d,"__esModule",{value:!0});var a={base:"esri-item-list",
list:"esri-item-list__list",group:"esri-item-list__group",scroller:"esri-item-list__scroller",groupHeader:"esri-item-list__group-header",item:"esri-item-list__list-item",itemSelected:"esri-item-list__list-item--selected",itemContainer:"esri-item-list__list-item-container",itemLabel:"esri-item-list__list-item-label",noMatchesMessage:"esri-item-list__no-matches-message",noItemsMessage:"esri-item-list__no-items-message",filterContainer:"esri-item-list__filter-container",filterPlaceholder:"esri-item-list__filter-placeholder",
filterInput:"esri-item-list__filter-input",filterPlaceholderText:"esri-item-list__filter-placeholder-text",searchIcon:"esri-icon-search",widget:"esri-widget",heading:"esri-widget__heading",input:"esri-input"};d.ItemList=function(c){var m=c.id,h=c.identify,d=c.filterEnabled,d=void 0===d?!0:d,v=c.items,r=c.messages,C=c.filterText,C=void 0===C?"":C,t=c.onFilterChange,K=c.renderIcon,G=c.onItemMouseLeave,I=c.onItemMouseEnter;c=c.onItemSelect;return l.tsx("div",{class:q.classes(a.base,a.widget)},d?f({filterText:C,
messages:r,onFilterChange:t,id:m}):null,b({identify:h,items:v,messages:r,filterText:C,renderIcon:K,onItemMouseLeave:G,onItemMouseEnter:I,onItemSelect:c}))};d.renderItem=h;d.renderGroup=r;d.renderLabel=c})},"esri/widgets/Editor/EditorViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/assignHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../core/arrayUtils ../../core/Collection ../../core/Error ../../core/Evented ../../core/HandleOwner ../../core/Logger ../../core/watchUtils ../../core/accessorSupport/decorators ../../layers/GraphicsLayer ../../layers/graphics/editingSupport ../Attachments/AttachmentsViewModel ./CreateWorkflow ./UpdateWorkflow ../FeatureForm/FeatureFormViewModel ../FeatureTemplates/FeatureTemplatesViewModel ../Sketch/SketchViewModel ../Spinner/SpinnerViewModel".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u,D,w,v,E,C,J,K,G,I,x,N){function O(a,b,m){R.error(new c(a,b,m))}function P(a){return a&&E.isEditableLayer(a.layer)}function S(a,c){return a&&h.find(a,function(a){return a.layer===c})}var R=u.getLogger("esri.widgets.Editor.EditorViewModel"),Q=["create","update"];return function(a){function c(c){c=a.call(this,c)||this;c._sketchGraphicsLayer=new v({listMode:"hide"});c.activeWorkflow=null;c.activityQueue=[];c.failures=[];c.attachmentsViewModel=new C({abilities:{editing:!0}});
c.featureFormViewModel=new G;c.featureTemplatesViewModel=new I;c.layerInfos=null;c.sketchViewModel=new x({layer:c._sketchGraphicsLayer});c.spinnerViewModel=new N;return c}t(c,a);c.prototype.initialize=function(){var a=this;this.handles.add([D.on(this,"activeWorkflow","cancel",function(){return a.emit("workflow-cancel")}),D.on(this,"activeWorkflow","commit",function(){return a.emit("workflow-commit")}),D.on(this,"view.allLayerViews","change",function(){return a.notifyChange("editableItems")}),D.watch(this,
"editableItems",function(){var c=a.activeWorkflow;if(c){var b=c.stepId;"create"===c.type?(a.refreshCreationTemplates(),"awaiting-feature-creation-info"!==b||a.canCreate||a._cancelWorkflow()):"update"===c.type&&("awaiting-feature-to-update"===b&&!a.canUpdate||"awaiting-update-feature-candidate"===b&&!c.data.candidates.some(function(c){var p=a.editableItems.find(function(p){return p.layer===c.layer});return p&&-1<p.supports.indexOf("update")}))&&a._cancelWorkflow()}})])};c.prototype.destroy=function(){this.view=
null;this._cancelWorkflow()};Object.defineProperty(c.prototype,"allowedWorkflows",{get:function(){return this._get("allowedWorkflows")},set:function(a){a&&0!==a.length||(a=Q.slice());this._set("allowedWorkflows",a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"canCreate",{get:function(){return this.editableItems.some(function(a){return-1<a.supports.indexOf("create")})},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"canUpdate",{get:function(){return this.editableItems.some(function(a){return-1<
a.supports.indexOf("update")})},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"editableItems",{get:function(){var a=this,c=this.get("view.allLayerViews");if(!c)return new r;this.handles.remove("layer-view-property-watchers");var b=function(){return a.notifyChange("editableItems")};return c.filter(P).map(function(c){a.handles.add(D.watch(c,["suspended","suspendInfo"],b),"layer-view-property-watchers");var p=c.layer,m=c.suspendInfo;c=[];var A=a.allowedWorkflows,k=p.capabilities,
e=k.data,k=k.operations,g=S(a.layerInfos,p),e=e.supportsAttachment&&(!g||!1!==g.allowAttachments),A=A.filter(function(e){return g?!1!==g.enabled&&("create"===e&&!1!==g.addEnabled||"update"===e&&!1!==g.updateEnabled):!0}),m=m.layerInvisible||m.layerNotLoaded||m.outsideScaleRange||m.viewNotReady;!m&&h.find(A,function(e){return"create"===e})&&k.supportsAdd&&c.push("create");!m&&h.find(A,function(e){return"update"===e})&&k.supportsUpdate&&c.push("update");!m&&!1!==(g&&g.deleteEnabled)&&k.supportsDelete&&
c.push("delete");return{hasAttachments:e,layer:p,supports:c}}).reverse()},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"state",{get:function(){if(!this.get("view.ready")||0===this.editableItems.length)return"disabled";var a=this.attachmentsViewModel.mode;return"add"===a?"adding-attachment":"edit"===a?"editing-attachment":(a=this.activeWorkflow)?a.stepId:"ready"},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"syncing",{get:function(){return 0<this.activityQueue.length},
enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"view",{set:function(a){this.sketchViewModel.view=a;this.spinnerViewModel.view=a;this._set("view",a)},enumerable:!0,configurable:!0});c.prototype.startCreateWorkflowAtFeatureTypeSelection=function(){return f(this,void 0,void 0,function(){var a;return b(this,function(c){switch(c.label){case 0:return this.canCreate?[4,this._cancelWorkflow()]:(O("editing:unsupported-workflow","Create workflow is unsupported or disabled."),[2]);case 1:return c.sent(),
a=this._createCreateWorkflow(),[4,a.start()];case 2:return c.sent(),this._set("activeWorkflow",a),[2]}})})};c.prototype.startCreateWorkflowAtFeatureCreation=function(a){return f(this,void 0,void 0,function(){var c;return b(this,function(b){switch(b.label){case 0:return this.canCreate?[4,this._cancelWorkflow()]:(O("editing:unsupported-workflow","Update workflow is unsupported or disabled."),[2]);case 1:return b.sent(),c=this._createCreateWorkflow("awaiting-feature-to-create"),c.data.creationInfo=a,
[4,c.start()];case 2:return b.sent(),this._set("activeWorkflow",c),[2]}})})};c.prototype.startCreateWorkflowAtFeatureEdit=function(a){return f(this,void 0,void 0,function(){var c;return b(this,function(b){switch(b.label){case 0:return this.canCreate?[4,this._cancelWorkflow()]:(O("editing:unsupported-workflow","Update workflow is unsupported or disabled."),[2]);case 1:return b.sent(),c=this._createCreateWorkflow("editing-new-feature"),c.data.edits.feature=a,[4,c.start()];case 2:return b.sent(),this._set("activeWorkflow",
c),[2]}})})};c.prototype.startUpdateWorkflowAtFeatureSelection=function(){return f(this,void 0,void 0,function(){var a;return b(this,function(c){switch(c.label){case 0:return this.canUpdate?[4,this._cancelWorkflow()]:(O("editing:unsupported-workflow","Update workflow is unsupported or disabled."),[2]);case 1:return c.sent(),a=this._createUpdateWorkflow(),[4,a.start()];case 2:return c.sent(),this._set("activeWorkflow",a),[2]}})})};c.prototype.startUpdateWorkflowAtMultipleFeatureSelection=function(a){return f(this,
void 0,void 0,function(){var c;return b(this,function(b){switch(b.label){case 0:return this.canUpdate?[4,this._cancelWorkflow()]:(O("editing:unsupported-workflow","Update workflow is unsupported or disabled."),[2]);case 1:return b.sent(),c=this._createUpdateWorkflow("awaiting-update-feature-candidate"),c.data.candidates=a,[4,c.start()];case 2:return b.sent(),this._set("activeWorkflow",c),[2]}})})};c.prototype.startUpdateWorkflowAtFeatureEdit=function(a){return f(this,void 0,void 0,function(){var c;
return b(this,function(b){switch(b.label){case 0:return this.canUpdate?[4,this._cancelWorkflow()]:(O("editing:unsupported-workflow","Update workflow is unsupported or disabled."),[2]);case 1:return b.sent(),c=this._createUpdateWorkflow("editing-existing-feature"),c.data.edits.feature=a,[4,c.start()];case 2:return b.sent(),this._set("activeWorkflow",c),[2]}})})};c.prototype.deleteFeatureFromWorkflow=function(){return f(this,void 0,void 0,function(){var a;return b(this,function(c){switch(c.label){case 0:return a=
this.activeWorkflow,a&&"create"!==a.type?[4,this._delete(a.data.edits.feature)]:(O("editing:unsupported-workflow","Deleting requires an active update workflow."),[2]);case 1:return c.sent(),[4,a.reset()];case 2:return c.sent(),[2]}})})};c.prototype.cancelWorkflow=function(a){return f(this,void 0,void 0,function(){return b(this,function(c){return[2,this._cancelWorkflow(q({warn:!0},a))]})})};c.prototype.refreshCreationTemplates=function(){this.featureTemplatesViewModel.layers=this.editableItems.filter(function(a){return-1<
a.supports.indexOf("create")}).map(function(a){return a.layer}).toArray()};c.prototype._cancelWorkflow=function(a){return f(this,void 0,void 0,function(){var c,m;return b(this,function(b){switch(b.label){case 0:c=this.activeWorkflow;if(!c)return a&&a.warn&&O("editing:no-active-workflow","There is no active workflow to cancel."),[2];m=!a||!1!==a.force;if(!m)return[3,2];this.emit("workflow-cancel");this._set("activeWorkflow",null);return[4,c.cancel(a)];case 1:return b.sent(),[2];case 2:return[4,c.cancel(a)];
case 3:return b.sent(),this._set("activeWorkflow",null),[2]}})})};c.prototype._createCreateWorkflow=function(a){var c=this;return J.create(this,a,function(a){return c._create(a)})};c.prototype._createUpdateWorkflow=function(a){var c=this;return K.create(this,a,function(a){return c._update(a)})};c.prototype._create=function(a){return f(this,void 0,void 0,function(){return b(this,function(c){switch(c.label){case 0:return[4,this._applyEdits(a.layer,{addFeatures:[a]})];case 1:return c.sent(),[2]}})})};
c.prototype._delete=function(a){return f(this,void 0,void 0,function(){return b(this,function(c){switch(c.label){case 0:return[4,this._applyEdits(a.layer,{deleteFeatures:[a]})];case 1:return c.sent(),[2]}})})};c.prototype._update=function(a){return f(this,void 0,void 0,function(){return b(this,function(c){switch(c.label){case 0:return[4,this._applyEdits(a.layer,{updateFeatures:[a]})];case 1:return c.sent(),[2]}})})};c.prototype._applyEdits=function(a,c){return f(this,void 0,void 0,function(){var m;
return b(this,function(b){switch(b.label){case 0:return[4,this._queueOperation(function(){return a.applyEdits(c)})];case 1:return b.sent(),[4,this.view.whenLayerView(a)];case 2:return m=b.sent(),[4,D.whenFalseOnce(m,"updating")];case 3:return b.sent(),[2]}})})};c.prototype._queueOperation=function(a){var c=this;this.activityQueue.push(a);this.notifyChange("syncing");var b=function(a,p){a=p.indexOf(a);-1<a&&p.splice(a,1)};return a().then(function(a){var p=a.deleteFeatureResults,c=a.updateFeatureResults;
if(a=h.find(a.addFeatureResults,function(p){return!!p.error})||h.find(c,function(p){return!!p.error})||h.find(p,function(p){return!!p.error}))throw a.error;}).catch(function(m){O("editing:operation-error","An error occurred.",{error:m});var p={error:m,retry:function(){b(p,c.failures);return c._queueOperation(a)},cancel:function(){b(p,c.failures)}};c._set("failures",c.failures.concat([p]))}).then(function(){b(a,c.activityQueue);c.notifyChange("syncing")})};l([w.property({readOnly:!0})],c.prototype,
"activeWorkflow",void 0);l([w.property({readOnly:!0})],c.prototype,"activityQueue",void 0);l([w.property({value:Q.slice()})],c.prototype,"allowedWorkflows",null);l([w.property({readOnly:!0,dependsOn:["editableItems"]})],c.prototype,"canCreate",null);l([w.property({readOnly:!0,dependsOn:["editableItems"]})],c.prototype,"canUpdate",null);l([w.property({dependsOn:["allowedWorkflows","layerInfos","view.allLayerViews","view.ready"],readOnly:!0})],c.prototype,"editableItems",null);l([w.property({readOnly:!0})],
c.prototype,"failures",void 0);l([w.property()],c.prototype,"attachmentsViewModel",void 0);l([w.property()],c.prototype,"featureFormViewModel",void 0);l([w.property()],c.prototype,"featureTemplatesViewModel",void 0);l([w.property()],c.prototype,"layerInfos",void 0);l([w.property()],c.prototype,"sketchViewModel",void 0);l([w.property()],c.prototype,"spinnerViewModel",void 0);l([w.property({dependsOn:["attachmentsViewModel.mode","editableItems","activeWorkflow.stepId","view.ready"]})],c.prototype,"state",
null);l([w.property({readOnly:!0})],c.prototype,"syncing",null);l([w.property()],c.prototype,"view",null);return c=l([w.subclass("esri.widgets.Editor.EditorViewModel")],c)}(w.declared(m.HandleOwnerMixin(a.EventedAccessor)))})},"esri/layers/GraphicsLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/assignHelper ../core/tsSupport/generatorHelper ../core/tsSupport/awaiterHelper ../core/accessorSupport/decorators ./Layer ./mixins/ScaleRangeLayer ../support/GraphicsCollection ../symbols/support/ElevationInfo".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m){return function(c){function b(b){b=c.call(this,b)||this;b.elevationInfo=null;b.graphics=new a.default;b.screenSizePerspectiveEnabled=!0;b.type="graphics";return b}t(b,c);b.prototype.destroy=function(){this.removeAll()};b.prototype.add=function(a){this.graphics.add(a);return this};b.prototype.addMany=function(a){this.graphics.addMany(a);return this};b.prototype.removeAll=function(){this.graphics.removeAll();return this};b.prototype.remove=function(a){this.graphics.remove(a)};
b.prototype.removeMany=function(a){this.graphics.removeMany(a)};b.prototype.on=function(a,c){return this.inherited(arguments,[a,c])};b.prototype.graphicChanged=function(a){this.emit("graphic-update",a)};l([h.property({type:m})],b.prototype,"elevationInfo",void 0);l([h.property(a.graphicsCollectionProperty)],b.prototype,"graphics",void 0);l([h.property({type:["show","hide"]})],b.prototype,"listMode",void 0);l([h.property()],b.prototype,"screenSizePerspectiveEnabled",void 0);l([h.property({readOnly:!0})],
b.prototype,"type",void 0);return b=l([h.subclass("esri.layers.GraphicsLayer")],b)}(h.declared(c.ScaleRangeLayer(r)))})},"esri/layers/graphics/editingSupport":function(){define("require exports ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../core/tsSupport/assignHelper ../../Graphic ../../core/Collection ../../core/Error ../../core/lang ../../core/promiseUtils ../../core/urlUtils ../../geometry/support/normalizeUtils".split(" "),function(z,d,t,l,q,b,f,h,r,c,a,m){function u(a,
b,m){return l(this,void 0,void 0,function(){var f,u;return t(this,function(d){switch(d.label){case 0:return[4,a.load()];case 1:d.sent();f=a.source;if(!f||null==f.applyEdits)return[2,c.reject(new h(a.type+"-layer:no-editing-support","Layer source does not support applyEdits capability",{layer:a}))];if(!a.editingEnabled)throw new h(a.type+"-layer:editing-disabled","Editing is disabled for layer",{layer:a});return[4,D(a,b,m)];case 2:return u=d.sent(),u.addFeatures.length||u.updateFeatures.length||u.deleteFeatures.length||
u.addAttachments.length||u.updateAttachments.length||u.deleteAttachments.length?[2,f.applyEdits(u,m)]:[2,{addFeatureResults:[],updateFeatureResults:[],deleteFeatureResults:[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]}]}})})}function D(a,c,b){return l(this,void 0,void 0,function(){var m,u,d,r;return t(this,function(l){m=c&&(c.addFeatures||c.updateFeatures||c.deleteFeatures);u=c&&(c.addAttachments||c.updateAttachments||c.deleteAttachments);if(!c||!m&&!u)throw new h(a.type+
"-layer:missing-parameters","'addFeatures', 'updateFeatures', 'deleteFeatures', 'addAttachments', 'updateAttachments' or 'deleteAttachments' parameter is required");if(!a.capabilities.data.isVersioned&&b&&b.gdbVersion)throw new h(a.type+"-layer:invalid-parameter","'gdbVersion' is applicable only if the layer supports versioned data. See: 'capabilities.data.isVersioned'");if(!a.capabilities.editing.supportsRollbackOnFailure&&b&&b.rollbackOnFailureEnabled)throw new h(a.type+"-layer:invalid-parameter",
"This layer does not support 'rollbackOnFailureEnabled' parameter. See: 'capabilities.editing.supportsRollbackOnFailure'");if(!a.capabilities.editing.supportsGlobalId&&b&&b.globalIdUsed)throw new h(a.type+"-layer:invalid-parameter","This layer does not support 'globalIdUsed' parameter. See: 'capabilities.editing.supportsGlobalId'");if(!a.capabilities.editing.supportsGlobalId&&u)throw new h(a.type+"-layer:invalid-parameter","'addAttachments', 'updateAttachments' and 'deleteAttachments' are applicable only if the layer supports global ids. See: 'capabilities.editing.supportsGlobalId'");
if((!b||!b.globalIdUsed)&&u)throw new h(a.type+"-layer:invalid-parameter","When 'addAttachments', 'updateAttachments' or 'deleteAttachments' is specified, globalIdUsed should be set to true");d=q({},c);d.addFeatures=f.isCollection(d.addFeatures)?d.addFeatures.toArray():d.addFeatures||[];d.updateFeatures=f.isCollection(d.updateFeatures)?d.updateFeatures.toArray():d.updateFeatures||[];d.deleteFeatures=f.isCollection(d.deleteFeatures)?d.deleteFeatures.toArray():d.deleteFeatures||[];d.addAttachments=
d.addAttachments||[];d.updateAttachments=d.updateAttachments||[];d.deleteAttachments=d.deleteAttachments||[];d.addFeatures=d.addFeatures.map(C);d.updateFeatures=d.updateFeatures.map(C);r=b&&b.globalIdUsed;d.addFeatures.forEach(function(c){return w(c,a,r)});d.updateFeatures.forEach(function(c){return w(c,a,r)});d.deleteFeatures.forEach(function(c){return w(c,a,r)});d.addAttachments.forEach(function(c){return v(c,a)});d.updateAttachments.forEach(function(c){return v(c,a)});return[2,E(d)]})})}function w(a,
c,b){if(b){if("attributes"in a&&!a.attributes[c.globalIdField])throw new h(c.type+"-layer:invalid-parameter","Feature should have 'globalId' when 'globalIdUsed' is true");if(!("attributes"in a||a.globalId))throw new h(c.type+"-layer:invalid-parameter","'globalId' of the feature should be passed when 'globalIdUsed' is true");}}function v(c,b){var m=c.feature;c=c.attachment;if(!m||"attributes"in m&&!m.attributes[b.globalIdField])throw new h(b.type+"-layer:invalid-parameter","Attachment should have reference to a feature with 'globalId'");
if(!("attributes"in m||m.globalId))throw new h(b.type+"-layer:invalid-parameter","Attachment should have reference to 'globalId' of the parent feature");if(!c.globalId)throw new h(b.type+"-layer:invalid-parameter","Attachment should have 'globalId'");if(!c.data&&!c.uploadId)throw new h(b.type+"-layer:invalid-parameter","Attachment should have 'data' or 'uploadId'");if(!(c.data instanceof File&&c.data.name||c.name))throw new h(b.type+"-layer:invalid-parameter","'name' is required when attachment is specified as Base64 encoded string using 'data'");
if(!b.capabilities.editing.supportsUploadWithItemId&&c.uploadId)throw new h(b.type+"-layer:invalid-parameter","This layer does not support 'uploadId' parameter. See: 'capabilities.editing.supportsUploadWithItemId'");if("string"===typeof c.data&&(m=a.dataComponents(c.data))&&!m.isBase64)throw new h(b.type+"-layer:invalid-parameter","Attachment 'data' should be a Blob, File or Base64 encoded string");}function E(a){return l(this,void 0,void 0,function(){var c,b,f,h,u,d;return t(this,function(v){switch(v.label){case 0:return c=
a.addFeatures,b=a.updateFeatures,f=c.concat(b).map(function(a){return a.geometry}),[4,m.normalizeCentralMeridian(f)];case 1:return h=v.sent(),u=c.length,d=b.length,h.slice(0,u).forEach(function(c,b){a.addFeatures[b].geometry=c}),h.slice(u,u+d).forEach(function(c,b){a.updateFeatures[b].geometry=c}),[2,a]}})})}function C(a){var c=new b;a.attributes||(a.attributes={});c.geometry=a.geometry;c.attributes=a.attributes;return c}Object.defineProperty(d,"__esModule",{value:!0});d.isEditableLayer=function(a){return!0===
a.get("capabilities.operations.supportsEditing")};d.applyEdits=function(a,b,m){return l(this,void 0,void 0,function(){var f,h,d,v,w,l,q;return t(this,function(x){switch(x.label){case 0:d={edits:b,result:c.create(function(a,c){f=a;h=c})},a.emit("apply-edits",d),x.label=1;case 1:return x.trys.push([1,3,,4]),[4,u(a,b,m)];case 2:return v=x.sent(),w=function(a){return a.filter(function(a){return!a.error}).map(r.clone)},l={addedFeatures:w(v.addFeatureResults),updatedFeatures:w(v.updateFeatureResults),deletedFeatures:w(v.deleteFeatureResults),
addedAttachments:w(v.addAttachmentResults),updatedAttachments:w(v.updateAttachmentResults),deletedAttachments:w(v.deleteAttachmentResults)},(l.addedFeatures.length||l.updatedFeatures.length||l.deletedFeatures.length||l.addedAttachments.length||l.updatedAttachments.length||l.deletedAttachments.length)&&a.emit("edits",l),f(l),[2,v];case 3:throw q=x.sent(),h(q),q;case 4:return[2]}})})}})},"esri/widgets/Editor/CreateWorkflow":function(){define("require exports ../../core/tsSupport/generatorHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/awaiterHelper ../../core/tsSupport/declareExtendsHelper ../../core/accessorSupport/decorators ./CreateWorkflowData ./Edits ./Workflow ./workflowUtils".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a){function m(a){if(1!==a.length)return null;a=a[0];if("items"in a){if(1===a.items.length)return a.items[0]}else return a;return null}return function(c){function d(a){a=c.call(this,a)||this;a.type="create";return a}b(d,c);u=d;d.create=function(a,c,b){a=new h({edits:new r,viewModel:a});b=new u({data:a,afterCommit:b});b._set("steps",this._createWorkflowSteps(b,c));return b};d._createWorkflowSteps=function(c,b){void 0===b&&(b="awaiting-feature-creation-info");var f=c.data,
h=c.handles,d={"awaiting-feature-creation-info":function(){return{id:"awaiting-feature-creation-info",setUp:function(){return q(this,void 0,void 0,function(){return t(this,function(a){f.creationInfo=null;h.add(f.viewModel.featureTemplatesViewModel.on("select",function(a){a=a.item;f.creationInfo={layer:a.layer,template:a.template};f.viewModel.activeWorkflow.next()}),this.id);return[2]})})},tearDown:function(){return q(this,void 0,void 0,function(){return t(this,function(a){h.remove(this.id);return[2]})})}}},
"awaiting-feature-to-create":function(){return{id:"awaiting-feature-to-create",setUp:function(){return q(this,void 0,void 0,function(){var c,b=this;return t(this,function(m){c=function(){h.add(a.setUpFeatureAdd(f.viewModel.sketchViewModel,f.creationInfo,f.viewModel.view,function(a){f.edits.feature=a;f.viewModel.activeWorkflow.next()},function(){h.remove(b.id);c()}),b.id)};c();return[2]})})},tearDown:function(){return q(this,void 0,void 0,function(){return t(this,function(a){h.remove(this.id);return[2]})})}}},
"editing-new-feature":function(){return{id:"editing-new-feature",setUp:function(){return q(this,void 0,void 0,function(){var c,b,m,d,u,v,w,r;return t(this,function(l){switch(l.label){case 0:return c=f.edits.feature,b=f.viewModel,d=(m=a.findLayerInfo(b.layerInfos,c.layer))&&m.fieldConfig,b.featureFormViewModel.set({feature:c,fieldConfig:d}),u=a.getVisualVariableAttributes(c),[4,a.setUpGeometryUpdate(c,u,b.sketchViewModel,b.view,function(a){var c=a.geometry;a=a.attributes;if(u.rotation){var m=u.rotation.field;
b.featureFormViewModel.setValue(m,a[m])}u.size&&(m=u.size.field,b.featureFormViewModel.setValue(m,a[m]));f.edits.updateAttributes(a);f.edits.updateGeometry(c)})];case 1:return v=l.sent(),w=v.interactive,r=v.visual,h.add([f.viewModel.featureFormViewModel.on("value-change",function(){f.edits.updateAttributes(f.viewModel.featureFormViewModel.getValues());c.attributes=f.edits.feature.attributes}),w,r],this.id),[2]}})})},tearDown:function(){return q(this,void 0,void 0,function(){return t(this,function(a){f.edits.feature=
null;f.viewModel.featureFormViewModel.set({feature:null,fieldConfig:null});h.remove(this.id);return[2]})})}}}},u=!1;c=["awaiting-feature-creation-info","awaiting-feature-to-create","editing-new-feature"].filter(function(a){return u?!0:u=a===b}).map(function(a){return d[a]()});f.viewModel.refreshCreationTemplates();var v=m(f.viewModel.featureTemplatesViewModel.items);"awaiting-feature-creation-info"===c[0].id&&v&&(f.creationInfo={layer:v.layer,template:v.template},c.shift());return c};var u;return d=
u=l([f.subclass("esri.widgets.Editor.CreateWorkflow")],d)}(f.declared(c))})},"esri/widgets/Editor/CreateWorkflowData":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators".split(" "),function(z,d,t,l,q,b){return function(f){function h(){var b=null!==f&&f.apply(this,arguments)||this;b.creationInfo=null;b.edits=null;b.viewModel=null;return b}t(h,f);l([b.property()],h.prototype,"creationInfo",
void 0);l([b.property()],h.prototype,"edits",void 0);l([b.property()],h.prototype,"viewModel",void 0);return h=l([b.subclass("esri.widgets.Editor.CreateWorkflowData")],h)}(b.declared(q))})},"esri/widgets/Editor/Edits":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/HandleOwner ../../core/maybe ../../core/accessorSupport/decorators".split(" "),function(z,d,t,l,q,b,f,h){function r(c){return f.isNone(c)?null:
JSON.stringify(c)}return function(c){function a(a){a=c.call(this,a)||this;a._baselineAttributesJSON=null;a._baselineGeometryJSON=null;a.feature=null;return a}t(a,c);Object.defineProperty(a.prototype,"attributesModified",{get:function(){var a=this._baselineAttributesJSON,c=this.feature;return!(!c||a===r(c.attributes))},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"geometryModified",{get:function(){var a=this._baselineGeometryJSON,c=this.feature;return!(!c||a===r(c.geometry))},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"modified",{get:function(){return this.attributesModified||this.geometryModified},enumerable:!0,configurable:!0});a.prototype.trackChanges=function(){this.feature&&(this._baselineAttributesJSON=r(this.feature.attributes),this._baselineGeometryJSON=r(this.feature.geometry),this.notifyChange("attributesModified"),this.notifyChange("geometryModified"))};a.prototype.updateAttributes=function(a){this.feature.attributes=a;this.notifyChange("attributesModified")};
a.prototype.updateGeometry=function(a){this.feature.geometry=a;this.notifyChange("geometryModified")};l([h.property()],a.prototype,"attributesModified",null);l([h.property()],a.prototype,"feature",void 0);l([h.property()],a.prototype,"geometryModified",null);l([h.property({dependsOn:["attributesModified","geometryModified"]})],a.prototype,"modified",null);return a=l([h.subclass("esri.widgets.Editor.Edits")],a)}(h.declared(b.HandleOwnerMixin(q)))})},"esri/widgets/Editor/Workflow":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/assignHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../core/arrayUtils ../../core/Error ../../core/Evented ../../core/HandleOwner ../../core/promiseUtils ../../core/accessorSupport/decorators".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u){return function(a){function c(c){c=a.call(this,c)||this;c._indexHistory=[];c._lastStepIndex=-1;c._stepIndex=-1;c._handleKeys={afterCommit:"after-commit",beforeCommit:"before-commit"};c.data=null;c.started=!1;c.steps=null;c.type=null;return c}t(c,a);Object.defineProperty(c.prototype,"hasNextStep",{get:function(){var a=this.steps;return!!(a&&this._stepIndex<a.filter(function(a){return!a.parent}).length-1)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,
"hasPreviousStep",{get:function(){return 0<this._stepIndex},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"stepId",{get:function(){var a=this.steps;return(a=a&&a[this._stepIndex])&&a.id},enumerable:!0,configurable:!0});c.prototype.cancel=function(a){void 0===a&&(a={force:!0});return f(this,void 0,void 0,function(){var c=this;return b(this,function(b){return!1!==a.force?[2,this._cancel()]:[2,m.create(function(a,b){c.emit("cancel-request",{controller:{allow:function(){c._cancel().then(a)},
deny:function(){return b(new r("workflow:cancel-denied","Request to cancel workflow was denied."))}}})})]})})};c.prototype.commit=function(){return f(this,void 0,void 0,function(){var a,c,m,f,h;return b(this,function(b){switch(b.label){case 0:return c=this.data,this.handles.remove(this._handleKeys.beforeCommit),m=c.edits.feature,f=m.clone(),c.edits.attributesModified||(h=m.layer.objectIdField,f.attributes=(a={},a[h]=m.getAttribute(h),a)),c.edits.geometryModified||(f.geometry=null),[4,this.afterCommit(f)];
case 1:return b.sent(),this.handles.remove(this._handleKeys.afterCommit),[4,this.reset()];case 2:return b.sent(),this.emit("commit"),[2]}})})};c.prototype.go=function(a){return f(this,void 0,void 0,function(){var c,m;return b(this,function(b){switch(b.label){case 0:return c=this.steps,m=h.findIndex(c,function(c){return c.id===a}),this._indexHistory.push(this._stepIndex),[4,this._go(m)];case 1:return b.sent(),[2]}})})};c.prototype.next=function(){return f(this,void 0,void 0,function(){return b(this,
function(a){switch(a.label){case 0:return this._indexHistory.push(this._stepIndex),[4,this._go(this._stepIndex+1)];case 1:return a.sent(),[2]}})})};c.prototype.previous=function(){return f(this,void 0,void 0,function(){return b(this,function(a){switch(a.label){case 0:return[4,this._go(this._indexHistory.pop())];case 1:return a.sent(),[2]}})})};c.prototype.reset=function(){return f(this,void 0,void 0,function(){return b(this,function(a){switch(a.label){case 0:return[4,this._cancel(!1)];case 1:return a.sent(),
[4,this.start()];case 2:return a.sent(),[2]}})})};c.prototype.start=function(){return f(this,void 0,void 0,function(){var a;return b(this,function(c){switch(c.label){case 0:return this._set("started",!0),a=-1===this._stepIndex?0:this._stepIndex,[4,this._go(a)];case 1:return c.sent(),[2]}})})};c.prototype._cancel=function(a){void 0===a&&(a=!0);return f(this,void 0,void 0,function(){return b(this,function(c){switch(c.label){case 0:if(!this.started)return[3,2];this._set("started",!1);return[4,this.steps[this._stepIndex].tearDown()];
case 1:c.sent(),c.label=2;case 2:return this.handles.remove([this._handleKeys.afterCommit,this._handleKeys.beforeCommit]),this._resetIndexing(a),a&&this.emit("cancel"),[2]}})})};c.prototype._go=function(a){void 0===a&&(a=-1);return f(this,void 0,void 0,function(){return b(this,function(c){switch(c.label){case 0:return-1>=a||a>=this.steps.length?[2]:this.started?-1<this._lastStepIndex?[4,this.steps[this._lastStepIndex].tearDown()]:[3,2]:(this._stepIndex=a,this._notifyStepProps(),[2]);case 1:c.sent(),
c.label=2;case 2:return[4,this.steps[a].setUp()];case 3:return c.sent(),this._stepIndex=this._lastStepIndex=a,this._notifyStepProps(),[2]}})})};c.prototype._resetIndexing=function(a){void 0===a&&(a=!0);this._lastStepIndex=this._stepIndex=-1;this._indexHistory.length=0;a&&this._notifyStepProps()};c.prototype._notifyStepProps=function(){this.notifyChange("stepId");this.notifyChange("hasPreviousStep");this.notifyChange("hasNextStep")};l([u.property()],c.prototype,"afterCommit",void 0);l([u.property()],
c.prototype,"data",void 0);l([u.property()],c.prototype,"hasNextStep",null);l([u.property()],c.prototype,"hasPreviousStep",null);l([u.property()],c.prototype,"started",void 0);l([u.property({readOnly:!0,dependsOn:["steps"]})],c.prototype,"stepId",null);l([u.property()],c.prototype,"steps",void 0);l([u.property()],c.prototype,"type",void 0);l([u.property()],c.prototype,"commit",null);return c=l([u.subclass("esri.widgets.Editor.Workflow")],c)}(u.declared(a.HandleOwnerMixin(c.EventedAccessor)))})},"esri/widgets/Editor/workflowUtils":function(){define("require exports ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../core/tsSupport/assignHelper ../../core/arrayUtils ../../core/compilerUtils ../../core/maybe ../../core/promiseUtils ../../core/screenUtils ../../core/accessorSupport/diffUtils ../../layers/support/fieldUtils ../../renderers/support/clickToleranceUtils ../../renderers/support/utils ../../renderers/visualVariables/support/sizeVariableUtils ../../renderers/visualVariables/support/visualVariableUtils ../../symbols/support/symbolConversion ../../symbols/support/symbolLayerUtils ../../symbols/support/symbolUtils ../../views/support/drapedUtils".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u,D,w,v,E,C,J,K){function G(a,c){var b="heading"===(a.axis||"heading")&&"arithmetic"===a.rotationType?-1:1,m=a.field,f=(a=c.fields&&c.fields.filter(function(p){return p.name===m}))&&1===a.length?a[0].type:"double",h=0,d=0;return{field:m,getDefault:function(){return r.resolve(0)},getValue:function(p){d=h-b*p;return O((d+360)%360,f)},initValue:function(p){h=null!=p?p:d;d=0},isUpdatingInteractively:!1}}function I(a,c){switch(c){case "width":return a[0];case "depth":return a[1];
case "height":return a[2];default:return a[2]||a[1]||a[0]}}function x(a,c,b){return l(this,void 0,void 0,function(){var m,u,v,r,p,w,A,k;return t(this,function(e){switch(e.label){case 0:if(h.isNone(c))return[2,0];m=E.to3D(c).symbol;if(h.isNone(m)||"web-style"===m.type)return[2,0];u=m.symbolLayers.getItemAt(0);if(!u)return[2,0];v=u.type;switch(v){case "icon":return[3,1];case "text":return[3,4];case "line":return[3,5];case "object":return[3,6];case "path":return[3,8];case "extrude":return[3,8];case "fill":return[3,
9];case "water":return[3,9]}return[3,10];case 1:if(r=u.size)return[3,3];w=(p=Math).min;A=[d.sizeDefaults.icon];return[4,C.computeIconLayerResourceSize(u,d.sizeDefaults.icon)];case 2:r=w.apply(p,A.concat([e.sent()[0]])),e.label=3;case 3:return[2,r||d.sizeDefaults.icon];case 4:return[2,u.size||d.sizeDefaults.text];case 5:return[2,u.size||d.sizeDefaults.line];case 6:return[4,C.computeObjectLayerResourceSize(u,a.scale/d.sizeDefaults.viewScaleSizeFactor)];case 7:return k=e.sent(),[2,I(k,b)];case 8:return[2,
u.size||a.scale/d.sizeDefaults.viewScaleSizeFactor];case 9:return[2,0];case 10:return f.neverReached(u),[2,0]}})})}function N(a,c){var b=this,m=a.field,f=a.axis,h=(c=c.fields&&c.fields.filter(function(k){return k.name===m}))&&1===c.length?c[0].type:"double",d=0,p=0,u=D.meterIn[a.valueUnit],A;A="area"===a.valueRepresentation?function(k){return Math.pow(k*u/2,2)*Math.PI}:"radius"===a.valueRepresentation||"distance"===a.valueRepresentation?function(k){return k*u/2}:function(k){return k*u};return{field:m,
getDefault:function(k,e){return l(b,void 0,void 0,function(){var g,n;return t(this,function(y){switch(y.label){case 0:return g=O,n=A,[4,x(e,k,f)];case 1:return[2,g.apply(void 0,[n.apply(void 0,[y.sent()]),h])]}})})},getValue:function(k,e){d||(d=e.pixelSizeAt(e.center));p=d*k;return O(p,h)},initValue:function(k){d=null!=k?k:p;p=0},isUpdatingInteractively:!1}}function O(a,c){switch(c){case "small-integer":case "integer":case "long":return Math.round(a);case "double":case "single":return a;default:return 0}}
function P(c){return l(this,void 0,void 0,function(){var b,m;return t(this,function(f){switch(f.label){case 0:return[4,J.getDisplayedSymbol(c,{ignoreGraphicSymbol:!0})];case 1:return b=f.sent(),m=a.diff(c.symbol,b),h.isSome(m)&&(c.symbol=b),[2]}})})}function S(a,c,b){return l(this,void 0,void 0,function(){var f,h;return t(this,function(d){switch(d.label){case 0:return 0===a.length?[2,[]]:[4,c.hitTest(b)];case 1:f=d.sent();if(0===f.results.length)return[2,[]];h=new Map;f.results.forEach(function(a){a=
a.graphic;var p=a.layer;h.has(p)||h.set(p,[]);h.get(p).push(a)});return[2,r.eachAlways(a.items.filter(function(a){var p=a.layer;return-1<a.supports.indexOf("update")&&h.has(p)}).map(function(a){a=a.layer;var p=a.displayField,c=[a.objectIdField];m.hasField(a.fields,p)&&c.push(p);p=h.get(a);if(p.some(function(k){return c.some(function(e){return!(e in k.attributes)})})){var b=a.createQuery();b.outFields=c;b.returnGeometry=!1;b.objectIds=p.map(function(k){return k.getObjectId()});return a.queryFeatures(b).then(function(k){return k.features})}return r.resolve(p)}))]}})})}
function R(a,c,b){return l(this,void 0,void 0,function(){var f,h;return t(this,function(d){switch(d.label){case 0:return 0===a.length?[2,[]]:[4,c.hitTest(b)];case 1:f=d.sent();if(0===f.results.length)return[2,[]];h=new Set;f.results.forEach(function(a){return h.add(a.graphic.layer)});return[2,r.eachAlways(a.items.filter(function(a){var p=a.layer;return-1<a.supports.indexOf("update")&&h.has(p)}).map(function(a){a=a.layer;var p=a.displayField,f=[a.objectIdField];m.hasField(a.fields,p)&&f.push(p);p=
a.createQuery();p.outFields=f;p.returnGeometry=!1;f=u.calculateTolerance({renderer:a.renderer,event:b});p.geometry=K.createQueryGeometry(b.mapPoint,f,c);return a.queryFeatures(p).then(function(p){return p.features})}))]}})})}Object.defineProperty(d,"__esModule",{value:!0});d.getVisualVariableAttributes=function(a){var c=a.layer,b;a:switch(c.renderer.type){case "class-breaks":case "simple":case "unique-value":case "dot-density":case "dictionary":b=!0;break a;default:b=!1}var m=(a=b&&v.getVisualVariableValues(c.renderer,
a))?a.map(function(a){return a.variable}):[];b=m.filter(function(a){return"rotation"===a.type&&(!a.axis||"heading"===a.axis)});a=b[0];b=1===b.length&&a.field&&!a.valueExpression;var f=m.filter(function(a){return"size"===a.type}),m=f[0],f=1===f.length&&"real-world-size"===w.getTransformationType(m)&&m.field&&!m.useSymbolValue&&!m.valueExpression;return{rotation:b&&G(a,c),size:f&&N(m,c)}};d.setUpFeatureAdd=function(a,c,b,m,f){var h=this,d=c.layer;a.layer.elevationInfo=d.elevationInfo;a.create(d.geometryType,
{hasZ:d.capabilities.data.supportsZ});var p=a.on("create",function(p){var b=p.state,k=p.graphic;return l(h,void 0,void 0,function(){var e;return t(this,function(g){switch(g.label){case 0:if("cancel"===b)return f(),[2];if("complete"!==b)return[3,2];e=k.clone();e.attributes=q({},c.template.prototype.attributes);e.layer=d;a.layer.remove(k);return[4,P(e)];case 1:g.sent(),m(e),g.label=2;case 2:return[2]}})})});b.map.add(a.layer);return{remove:function(){p.remove();b.map.remove(a.layer);a.cancel()}}};d.findLayerInfo=
function(a,c){return a&&b.find(a,function(a){return a.layer===c})};d.fetchCandidates=function(a,c,b){return l(this,void 0,void 0,function(){return t(this,function(m){switch(c.type){case "3d":return[2,S(a,c,b)];case "2d":return[2,R(a,c,b)];default:return f.neverReached(c),[2,null]}})})};d.fetchFullFeature=function(a,c,b){var m=a.layer,f=m.createQuery();f.objectIds=[a.getAttribute(m.objectIdField)];f.outFields=["*"];f.outSpatialReference=c.spatialReference;f.returnM=m.capabilities.data.supportsM;f.returnZ=
m.capabilities.data.supportsZ;return m.queryFeatures(f,b).then(function(a){return a.features[0]})};d.setUpGeometryUpdate=function(a,c,b,m,f){return l(this,void 0,void 0,function(){var h,d,p,u,A,k,e,g,n,y,B=this;return t(this,function(F){switch(F.label){case 0:return h=a.clone(),[4,P(h)];case 1:return F.sent(),b.layer.add(h),h.sourceLayer=a.layer,d=function(){var e=a.layer;if("graphics"===e.type)return{remove:function(){}};var g=a.attributes[e.objectIdField],n=m.whenLayerView(e);n.then(function(e){return e.setVisibility(g,
!1)});return{remove:function(){n.then(function(e){return e.setVisibility(g,!0)})}}},p=d(),u=a.layer,A=c.size,k=c.rotation,e={multipleSelectionEnabled:!1},"point"===u.geometryType&&(e.enableRotation=!!k,e.enableScaling=!!A),b.layer.elevationInfo=u.elevationInfo,b.update(h,e),g=(!!A||!!k)&&a.watch("attributes",function(e){return l(B,void 0,void 0,function(){var g,n,y;return t(this,function(p){switch(p.label){case 0:g=!1;for(n in e)y=e[n],y!==h.attributes[n]&&(h.setAttribute(n,y),g=!0,A&&!A.isUpdatingInteractively&&
A.field===n&&A.initValue(y),k&&!k.isUpdatingInteractively&&k.field===n&&k.initValue(y));return g&&"3d"===m.type?[4,P(h)]:[3,2];case 1:p.sent(),p.label=2;case 2:return[2]}})})}),[k,A].forEach(function(e){return l(B,void 0,void 0,function(){var g,n;return t(this,function(k){switch(k.label){case 0:if(!e)return[2];g=a.attributes[e.field];if(null==g)return[3,1];e.initValue(g);return[3,4];case 1:return[4,e.getDefault(h.symbol,m)];case 2:return n=k.sent(),e.initValue(n),h.setAttribute(e.field,n),"3d"!==
m.type?[3,4]:[4,P(h)];case 3:k.sent(),k.label=4;case 4:return[2]}})})}),n=b.on("update",function(g){return l(B,void 0,void 0,function(){var n,y,p,B,a,F,H,c,d;return t(this,function(M){switch(M.label){case 0:n=g.graphics[0];y=g.state;p=g.aborted;B=g.toolEventInfo;if("complete"===y&&p)return b.update(n,e),[2];a=B;k&&a&&(F=k.field,H=k.getValue,c=k.initValue,"rotate-stop"===a.type?(k.isUpdatingInteractively=!1,c()):null!=a.angle&&(k.isUpdatingInteractively=!0,h.attributes[F]=H(a.angle/Math.PI*180,m)));
d=B;A&&d&&(F=A.field,H=A.getValue,c=A.initValue,"scale-stop"===d.type?(A.isUpdatingInteractively=!1,c()):null!=d.xScale&&(A.isUpdatingInteractively=!0,h.attributes[F]=H(d.xScale,m)));return"3d"!==m.type?[3,2]:[4,P(h)];case 1:M.sent(),M.label=2;case 2:return f(n.clone()),[2]}})})}),m.map.add(b.layer),y=function(){},[2,{interactive:{remove:function(){n.remove();b.cancel();g&&g.remove();this.remove=y}},visual:{remove:function(){p.remove();m.map.remove(b.layer);b.layer.removeAll();this.remove=y}}}]}})})};
d.sizeDefaults={icon:c.px2pt(24),text:c.px2pt(12),line:c.px2pt(1),viewScaleSizeFactor:100}})},"esri/renderers/support/clickToleranceUtils":function(){define(["require","exports"],function(z,d){function t(b,f){return f?"xoffset"in f&&f.xoffset?Math.max(b,Math.abs(f.xoffset)):"yoffset"in f&&f.yoffset?Math.max(b,Math.abs(f.yoffset||0)):b:b}function l(b,f){if("number"===typeof b)return b;if(b&&b.stops&&b.stops.length){b=b.stops;for(var h=f=0,d=0;d<b.length;d++){var c=b[d].size;"number"===typeof c&&(f+=
c,h++)}return f/h}return f}function q(b,f){if(!f)return b;f=f.filter(function(a){return"size"===a.type}).map(function(a){var c=a.minSize;return(l(a.maxSize,b)+l(c,b))/2});var h=0,d=f.length;if(0===d)return b;for(var c=0;c<d;c++)h+=f[c];return Math.max(Math.floor(h/d),b)}Object.defineProperty(d,"__esModule",{value:!0});d.calculateTolerance=function(b){var f=b&&b.renderer;b="touch"===(b&&b.event&&b.event.pointerType)?9:6;if(!f)return b;b="visualVariables"in f?q(b,f.visualVariables):b;if("simple"===
f.type)return t(b,f.symbol);if("unique-value"===f.type){var h=b;f.uniqueValueInfos.forEach(function(c){h=t(h,c.symbol)});return h}if("class-breaks"===f.type){var d=b;f.classBreakInfos.forEach(function(c){d=t(d,c.symbol)});return d}return b}})},"esri/symbols/support/symbolLayerUtils":function(){define("require exports ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../request ../../core/Error ../../core/ItemCache ../../core/maybe ../../core/promiseUtils ../../geometry/support/aaBoundingBox ../../views/3d/layers/graphics/Graphics3DIconSymbolLayer ../../views/3d/layers/graphics/graphicUtils ../../views/3d/layers/graphics/objectResourceUtils ../../views/3d/layers/graphics/primitiveObjectSymbolUtils".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u,D){function w(c,m){return l(this,void 0,void 0,function(){return t(this,function(f){if(c.resource.href)return[2,E(c.resource.href).then(function(a){return[a.width,a.height]})];if(c.resource.primitive)return h.isSome(m)?[2,[m,m]]:[2,a.default.PRIMITIVE_SIZE];throw new b("symbol3d:invalid-symbol-layer","symbol layers of type Icon must have either an href or a primitive resource");})})}function v(a,c){return w(a,c).then(function(c){if(null==a.size)return c;c=c[0]/c[1];
return 1<c?[a.size,a.size/c]:[a.size*c,a.size]})}function E(a){return q(a,{responseType:"image"}).then(function(a){return a.data})}function C(a,b){return K(a,b).then(function(a){return c.size(a)})}function J(a,c){return C(a,c).then(function(c){return m.computeSizeWithResourceSize(c,a)})}function K(a,m){if(!a.isPrimitive){var f=a.resource.href;m=G.get(f);return void 0!==m?r.resolve(m):u.fetch(f,{disableTextures:!0}).then(function(a){G.put(f,a.referenceBoundingBox);return a.referenceBoundingBox})}var d=
null;if(a.resource&&a.resource.primitive&&(d=c.create(D.primitiveBoundingBox(a.resource.primitive)),h.isSome(m)))for(a=0;a<d.length;a++)d[a]*=m;return d?r.resolve(d):r.reject(new b("symbol:invalid-resource","The symbol does not have a valid resource"))}Object.defineProperty(d,"__esModule",{value:!0});var G=new f(50);d.clearBoundingBoxCache=function(){G=new f(50)};d.computeLayerResourceSize=function(a,c){if("icon"===a.type)return w(a,c);if("object"===a.type)return C(a,c);throw new b("symbol3d:unsupported-symbol-layer",
"computeLayerSize only works with symbol layers of type Icon and Object");};d.computeLayerSize=function(a,c){return l(this,void 0,void 0,function(){return t(this,function(m){if("icon"===a.type)return[2,v(a,c)];if("object"===a.type)return[2,J(a,c)];throw new b("symbol3d:unsupported-symbol-layer","computeLayerSize only works with symbol layers of type Icon and Object");})})};d.computeIconLayerResourceSize=w;d.computeObjectLayerResourceSize=C})},"esri/views/3d/layers/graphics/Graphics3DIconSymbolLayer":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../Color ../../../../symbols ../../../../core/asyncUtils ../../../../core/compilerUtils ../../../../core/Error ../../../../core/has ../../../../core/lang ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/screenUtils ../../../../core/urlUtils ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/vec2f64 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../core/libs/gl-matrix-2/vec4f64 ../../../../geometry/support/aaBoundingBox ../../../../support/arcadeOnDemand ../../../../symbols/cim/CIMSymbolRasterizer ../../../../symbols/support/IconSymbol3DLayerResource ../../../../symbols/support/utils ../../../2d/arcade/utils ./constants ./ElevationAligners ./elevationAlignmentUtils ./Graphics3DDrapedGraphicLayer ./Graphics3DObject3DGraphicLayer ./Graphics3DSymbolLayer ./graphicUtils ./pointUtils ./sdfPrimitives ../support/FastSymbolUpdates ../../support/projectionUtils ../../terrain/OverlayRenderer ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/RenderGeometry ../../webgl-engine/lib/Texture ../../webgl-engine/materials/HUDMaterial".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u,D,w,v,E,C,J,K,G,I,x,N,O,P,S,R,Q,U,V,Y,T,aa,W,p,L,A,k,e,g,n,y,B){function F(e){return D.isSome(e)?"cross"===e||"x"===e:!1}Object.defineProperty(d,"__esModule",{value:!0});var H=C.mat4f64.create(),M=K.vec3f64.fromValues(0,0,1),X=[.25,.25,.75,.75],Z=[64,64];z=function(d){function ba(e,g,n,k){e=d.call(this,e,g,n,k)||this;e._cimLayers=null;e._cimSymbolMaterials=new Map;e._cimSymbolTextures=new Map;e._cimMaterialParametersInfo=null;e._cimRequiredFields=null;e._cimScaleFactorOrFunction=
null;e._size=null;e._symbolTextureRatio=1;e._outlineSize=0;e._texture=null;e._releaseTexture=null;e._elevationOptions={supportsOffsetAdjustment:!0,supportsOnTheGround:!0};return e}l(ba,d);ba.prototype.getCachedSize=function(){return{size:this._getIconSize()}};ba.prototype.doLoad=function(e){return b(this,void 0,void 0,function(){var g,n,k,y;return q(this,function(p){switch(p.label){case 0:this._validateOrThrow();g=this._prepareMaterialParameters();n=this._getPrimitive();if(!D.isSome(n))return[3,1];
this._prepareResourcesPrimitive(g,n);return[3,5];case 1:return k=P.getIconHref(this.symbol,this.symbolLayer),(y=E.dataComponents(k))&&"application/json"===y.mediaType?[4,this._prepareResourcesCIM(g,JSON.parse(y.data),e)]:[3,3];case 2:return p.sent(),[3,5];case 3:return[4,this._prepareResourcesHref(g,k,e)];case 4:p.sent(),p.label=5;case 5:return[2]}})})};ba.prototype._validateOrThrow=function(){if(!this._drivenProperties.size){var e=aa.validateSymbolLayerSize(this._getIconSize());if(e)throw new a("graphics3diconsymbollayer:invalid-size",
e);}};ba.prototype._getIconSize=function(){var e=this.symbolLayer,e=Math.round(null!=e.size?v.pt2px(e.size):16);return this._drivenProperties.size?Math.max(e,64):e};ba.prototype._generateTextureCIM=function(e){var g=this._getGraphicHash(e),n=""===g?null:this._cimSymbolTextures.get(g);n||(e=this._context.sharedResources.cimSymbolRasterizer.rasterizeCIMSymbol(this._cimLayers,e,{scaleFactor:this._cimScaleFactorOrFunction}),this._cimMaterialParametersInfo.anchorPos=this._getAnchorPos("relative",e.anchorPosition),
n=new y(e.imageData,"symbol",{width:e.imageData.width,height:e.imageData.height,powerOfTwoResizeMode:2}),this._cimSymbolTextures.set(g,n),this._context.stage.add(4,n));return n};ba.prototype._computeSize=function(e,g){e=e.width/e.height;return 1<e?[g,Math.round(g/e)]:[Math.round(g*e),g]};ba.prototype._prepareMaterialParameters=function(){var e={anchorPos:this._getAnchorPos(this.symbolLayer.anchor,this.symbolLayer.anchorPosition)},g=this.symbol;if(g&&"point-3d"===g.type&&g.hasVisibleVerticalOffset()){var g=
g.verticalOffset,n=g.minWorldLength,k=g.maxWorldLength;e.verticalOffset={screenLength:v.pt2px(g.screenLength),minWorldLength:n||0,maxWorldLength:null!=k?k:Infinity}}this._context.screenSizePerspectiveEnabled&&(e.screenSizePerspective=this._context.sharedResources.screenSizePerspectiveSettings);e.occlusionTest=!0;e.slicePlaneEnabled=this._context.slicePlaneEnabled;return e};ba.prototype._prepareResourcesPrimitive=function(e,g){var n=this,k=this._getOutlineSize();if(F(g)&&0===k)throw Error("Nothing to render");
this._outlineSize=k;e.color=this._getFillColor();e.outlineColor=this._getOutlineColor();e.outlineSize=this._outlineSize;var B=this._context.sharedResources.textures.fromData(g,function(){var e;switch(g){case "circle":e=p.createCircle(128,64);break;case "square":e=p.createSquare(128,64);break;case "kite":e=p.createKite(128,64);break;case "cross":e=p.createCross(128,64);break;case "x":e=p.createX(128,64);break;case "triangle":e=p.createTriangle(128,64);break;default:c.neverReached(g)}return new y(e,
"sdf_"+g,{mipmap:!1,wrap:{s:33071,t:33071},width:128,height:128,components:4,noUnpackFlip:!0})});this._texture=B.texture;this._releaseTexture=function(){return n._context.sharedResources.textures.release(B.uid)};e.textureIsSignedDistanceField=!0;e.distanceFieldBoundingBox=X;e.textureId=this._texture.id;k=this._getIconSize();this._size=[k,k];this._symbolTextureRatio=2;this._createMaterialAndAddToStage(e,this._context.stage)};ba.prototype._prepareResourcesHref=function(e,g,n){return b(this,void 0,void 0,
function(){var k,y,p,B,F,H,c,b,M=this;return q(this,function(A){switch(A.label){case 0:if(!m("esri-canvas-svg-support")&&E.isSVG(g))throw k="IconSymbol3DLayer failed to load (SVG symbols are not supported in IE11)",new a("graphics3diconsymbollayer:unsupported-image-format",k);this._outlineSize=this._getOutlineSize();e.color=this._getFillColor();e.outlineColor=this._getOutlineColor();e.outlineSize=this._outlineSize;e.textureIsSignedDistanceField=!1;y=this._getIconSize();p=y*this._context.layerView.view.pixelRatio;
return[4,r.result(this._context.sharedResources.textures.fromUrl(g,p,{signal:n}))];case 1:B=A.sent();if(!1===B.ok)throw w.throwIfAbortError(B.error),k="Failed to load (Request for icon resource failed: "+g+")",new a("graphics3diconsymbollayer:request-failed",k);F=B.value;H=F.uid;c=F.texture;this._releaseTexture=function(){return M._context.sharedResources.textures.release(H)};b=c.params;this._size=this._computeSize(b,y);e.textureId=c.id;this._createMaterialAndAddToStage(e,this._context.stage);return[2]}})})};
ba.prototype._prepareResourcesCIM=function(e,g,n){return b(this,void 0,void 0,function(){var k,y,p,B,a,F,H,c,b,M,m;return q(this,function(A){switch(A.label){case 0:return k=new h.CIMSymbol({data:g}),this._context.sharedResources.cimSymbolRasterizer||(this._context.sharedResources.cimSymbolRasterizer=new N(this._context.renderCoordsHelper.spatialReference,!0)),y=this._context.layer.fields?this._context.layer.fields.map(function(e){return e.toJSON()}):null,p=this,[4,this._context.sharedResources.cimSymbolRasterizer.analyzeCIMSymbol(k,
y,this._context.renderer&&"dictionary"===this._context.renderer.type?this._context.renderer.fieldMap:null,"esriGeometryPoint",{signal:n})];case 1:p._cimLayers=A.sent();if(!this._context.renderer||"dictionary"!==this._context.renderer.type||!this._context.renderer.scaleExpression)return[3,4];F=this._context.renderer;if(!isNaN(F.scaleExpression))return[3,3];H=F.scaleExpression;return[4,x.createRendererExpression(H,this._context.layer.spatialReference,y)];case 2:return c=A.sent(),a=function(e,g,n){e=
S.callWithFeature(c,e,{$view:n},"esriGeometryPoint",g);return null!==e?e:1},[3,4];case 3:B=Number(F.scaleExpression),A.label=4;case 4:this._cimScaleFactorOrFunction=B||a||1;if(this._context.renderer)return[3,5];M=[];return[3,7];case 5:return[4,this._context.renderer.getRequiredFields(this._context.layer.fields)];case 6:M=A.sent(),A.label=7;case 7:return b=M,w.throwIfAborted(n),m=this._context.layer.fieldsIndex,this._cimRequiredFields=b.map(function(e){return m.get(e).name}),this._cimMaterialParametersInfo=
e,this._cimMaterialParametersInfo.color=this._getFillColor(),this._cimMaterialParametersInfo.outlineColor=[0,0,0,0],this._cimMaterialParametersInfo.outlineSize=0,this._cimMaterialParametersInfo.textureIsSignedDistanceField=!1,[2]}})})};ba.prototype._getPrimitive=function(){return this.symbolLayer.resource&&this.symbolLayer.resource.href?null:this.symbolLayer.resource&&this.symbolLayer.resource.primitive||O.defaultPrimitive};ba.prototype._getOutlineSize=function(){var e=0,e=this.symbolLayer;if(D.isSome(e.outline)&&
null!=e.outline.size)return Math.max(v.pt2px(e.outline.size),0);e=this._getPrimitive();e=F(e)?1.5:0;return Math.max(e,0)};ba.prototype._getOutlineColor=function(){var e=this._getLayerOpacity(),g=D.get(this.symbolLayer,"outline","color");if(D.isSome(g)){var n=f.toUnitRGB(g);return[n[0],n[1],n[2],g.a*e]}return[0,0,0,0]};ba.prototype._getFillColor=function(){if(F(this._getPrimitive()))return R.TRANSPARENT_UNIT;var e=D.isNone(this._getPrimitive()),g=D.get(this.symbolLayer,"material","color");return this._getCombinedOpacityAndColor(g,
{hasIntrinsicColor:e})};ba.prototype._getAnchorPos=function(e,g){return"relative"===e?J.vec2f64.fromValues((g.x||0)+.5,-(g.y||0)+.5):e in aa.namedAnchorToHUDMaterialAnchorPos?aa.namedAnchorToHUDMaterialAnchorPos[e]:aa.namedAnchorToHUDMaterialAnchorPos.center};ba.prototype._createMaterialAndAddToStage=function(e,g){this._fastUpdates=this._cimLayers?{enabled:!1}:L.initFastSymbolUpdatesState(this._context.renderer,this._fastVisualVariableConvertOptions());this._fastUpdates.enabled&&u.mixin(e,this._fastUpdates.materialParameters);
if(this._cimLayers){var n=this._cimSymbolMaterials.get(e.textureId);n||(n=new B(e,this._getIdHint("_icon")),this._cimSymbolMaterials.set(e.textureId,n),g.add(3,n));return n}this._material=new B(e,this._getIdHint("_icon"));g.add(3,this._material);return this._material};ba.prototype._setDrapingDependentMaterialParameters=function(){this.draped&&(this._forEachMaterial(function(e){e.setParameterValues({verticalOffset:null,screenSizePerspective:null,occlusionTest:!1,slicePlaneEnabled:!1,shaderPolygonOffset:0})}),
this.layerOpacityChanged())};ba.prototype.destroy=function(){var e=this;d.prototype.destroy.call(this);this._forEachMaterial(function(g){e._context.stage.remove(3,g.id)});D.isSome(this._material)&&(this._material=null);this._cimSymbolMaterials.clear();this._cimSymbolTextures.forEach(function(g){e._context.stage.remove(4,g.id)});this._cimSymbolTextures.clear();this._releaseTexture&&(this._releaseTexture(),this._releaseTexture=null)};ba.prototype._getScaleFactor=function(e,g){if(this._drivenProperties.size&&
e.size){for(var n=0;3>n;n++){var k=e.size[n];k&&"symbol-value"!==k&&"proportional"!==k&&(e.size[n]=v.pt2px(k))}if("symbol-value"===e.size[0])return 1;if(isFinite(+e.size[0]))return+e.size[0]/g;if(isFinite(+e.size[2]))return+e.size[2]/g}return 1};ba.prototype.createGraphics3DGraphic=function(e){var g=e.renderingInfo,n=e.graphic,k,y;if(this._cimLayers){if(!this._cimLayers.length)return null;var p=this._generateTextureCIM(n);y=t({textureId:p.id},this._cimMaterialParametersInfo);y=this._createMaterialAndAddToStage(y,
this._context.stage);k=[p.params.width,p.params.height]}else k=this._size,y=D.expect(this._material);if(!this._validateGeometry(n.geometry))return null;p=W.placePointOnGeometry(n.geometry);if(D.isNone(p))return this.logger.warn("unsupported geometry type for icon symbol: "+n.geometry.type),null;var B="graphic"+n.uid,a=this._getVertexOpacityAndColor(g),F=1;this._fastUpdates.enabled&&this._fastUpdates.visualVariables.size||(F=this._getScaleFactor(g,k[0]>k[1]?k[0]:k[1]));F*=this._symbolTextureRatio;
g=[k[0]*F,k[1]*F];k=this.getGraphicElevationContext(n);this.ensureDrapedStatus("on-the-ground"===k.mode)&&this._setDrapingDependentMaterialParameters();return this.draped?this._createAsOverlay(n,p,y,a,g,e.layer.uid):this._createAs3DShape(n,p,y,a,g,k,B,n.uid)};ba.prototype.layerOpacityChanged=function(){var e=this._getFillColor(),g=this._getOutlineColor();this._forEachMaterial(function(n){n.setParameterValues({color:e});n.setParameterValues({outlineColor:g})});return!0};ba.prototype.layerElevationInfoChanged=
function(e,g,n){var k=this._elevationContext.mode;n=U.elevationModeChangeUpdateType(ba.elevationModeChangeTypes,n,k);if(n!==U.SymbolUpdateType.UPDATE)return n;var y=U.needsElevationUpdates2D(k)||"absolute-height"===k;return this.updateGraphics3DGraphicElevationInfo(e,g,function(){return y})};ba.prototype.slicePlaneEnabledChanged=function(){var e=this;this.draped||this._forEachMaterial(function(g){g.setParameterValues({slicePlaneEnabled:e._context.slicePlaneEnabled})});return!0};ba.prototype.physicalBasedRenderingChanged=
function(){return!0};ba.prototype.pixelRatioChanged=function(){return this._getPrimitive()?!0:!1};ba.prototype.applyRendererDiff=function(e,g){for(var n in e.diff)switch(n){case "visualVariables":if(L.updateFastSymbolUpdatesState(this._fastUpdates,g,this._fastVisualVariableConvertOptions()))D.isSome(this._material)&&this._material.setParameterValues(this._fastUpdates.materialParameters);else return!1;break;default:return!1}return!0};ba.prototype._defaultElevationInfoNoZ=function(){return ca};ba.prototype._createAs3DShape=
function(n,k,y,p,B,a,F,H){var c=this,b=this.getFastUpdateAttrValues(n);n=b?function(e){return L.evaluateModelTransform(c._fastUpdates.materialParameters,b,e)}:null;p=g.createPointGeometry(M,null,p,B,da,null,b);p=[new e(p,F)];F=W.createStageObjectForHUD(this._context,k,p,[y],null,null,a,F,this._context.layer.uid,H,n);if(null===F)return null;var m=new Y(this,F.object,p,null,null,Q.perObjectElevationAligner,a);m.alignedSampledElevation=F.sampledElevation;m.needsElevationUpdates=U.needsElevationUpdates2D(a.mode)||
"absolute-height"===a.mode;m.getScreenSize=this._createScreenSizeGetter(B,n);m.calculateRelativeScreenBounds=function(e){return y.calculateRelativeScreenBounds(m.getScreenSize(),1,e)};W.extendPointGraphicElevationContext(m,k,this._context.elevationProvider);return m};ba.prototype._createAsOverlay=function(e,y,p,B,a,F){var H=this;p.renderPriority=this._renderPriority;var c=K.vec3f64.create();A.pointToVector(y,c,this._context.overlaySR);c[2]=k.DRAPED_Z;y=this._context.clippingExtent;if(D.isSome(y)&&
!I.containsPoint(y,c))return null;var b=this.getFastUpdateAttrValues(e);y=b?function(e){return L.evaluateModelTransform(H._fastUpdates.materialParameters,b,e)}:null;B=g.createPointGeometry(M,c,B,a,null,null,b);B=new n(B);B.material=p;B.center=c;B.bsRadius=0;B.data.layerUid=F;B.data.graphicUid=e.uid;B.calculateShaderTransformation=y;var m=new V(this,[B],null);m.getScreenSize=this._createScreenSizeGetter(a,y);m.calculateRelativeScreenBounds=function(e){return p.calculateRelativeScreenBounds(m.getScreenSize(),
1,e)};return m};ba.prototype._createScreenSizeGetter=function(e,g){var n=this._outlineSize+2;if(this._fastUpdates.enabled){var k=e[0]/this._symbolTextureRatio,y=e[1]/this._symbolTextureRatio;return function(e){void 0===e&&(e=J.vec2f64.create());var p=g(H);e[0]=p[0]*k+n;e[1]=p[5]*y+n;return e}}var p=e[0]/this._symbolTextureRatio+n,B=e[1]/this._symbolTextureRatio+n;return function(e){void 0===e&&(e=J.vec2f64.create());e[0]=p;e[1]=B;return e}};ba.prototype._fastVisualVariableConvertOptions=function(){var e=
this._size[0]>this._size[1]?this._size[0]:this._size[1],g=K.vec3f64.fromValues(e,e,e),n=v.px2pt(1),e=e*n,e=K.vec3f64.fromValues(e,e,e);return{modelSize:g,symbolSize:e,unitInMeters:n,transformation:{anchor:K.vec3f64.ZEROS,scale:K.vec3f64.ONES,rotation:K.vec3f64.ZEROS}}};ba.prototype._getGraphicHash=function(e){for(var g="",n=0,k=this._cimRequiredFields;n<k.length;n++)var y=k[n],g=g+(y+e.attributes[y]);return g};ba.prototype._forEachMaterial=function(e){D.isSome(this._material)&&e(this._material);this._cimSymbolMaterials.forEach(e)};
ba.PRIMITIVE_SIZE=Z;ba.elevationModeChangeTypes={definedChanged:U.SymbolUpdateType.UPDATE,staysOnTheGround:U.SymbolUpdateType.NONE,onTheGroundChanged:U.SymbolUpdateType.RECREATE};return ba}(T.default);d.Graphics3DIconSymbolLayer=z;var ca={mode:"relative-to-ground",offset:0},da=G.vec4f64.fromValues(0,0,0,1);d.default=z})},"esri/core/libs/gl-matrix-2/mat4f64":function(){define(["require","exports","./factories/mat4f64"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});d.mat4f64=t})},
"esri/core/libs/gl-matrix-2/factories/mat4f64":function(){define(["require","exports"],function(z,d){function t(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}Object.defineProperty(d,"__esModule",{value:!0});d.create=t;d.clone=function(d){return[d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7],d[8],d[9],d[10],d[11],d[12],d[13],d[14],d[15]]};d.fromValues=function(d,q,b,f,h,r,c,a,m,u,D,w,v,E,C,t){return[d,q,b,f,h,r,c,a,m,u,D,w,v,E,C,t]};d.createView=function(d,q){return new Float64Array(d,q,16)};d.IDENTITY=t()})},
"esri/core/libs/gl-matrix-2/vec2f64":function(){define(["require","exports","./factories/vec2f64"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});d.vec2f64=t})},"esri/core/libs/gl-matrix-2/factories/vec2f64":function(){define(["require","exports"],function(z,d){Object.defineProperty(d,"__esModule",{value:!0});d.create=function(){return[0,0]};d.clone=function(d){return[d[0],d[1]]};d.fromValues=function(d,l){return[d,l]};d.fromArray=function(d){for(var l=[0,0],q=Math.min(2,d.length),
b=0;b<q;++b)l[b]=d[b];return l};d.createView=function(d,l){return new Float64Array(d,l,2)};d.zeros=function(){return[0,0]};d.ones=function(){return[1,1]};d.unitX=function(){return[1,0]};d.unitY=function(){return[0,1]};d.ZEROS=[0,0];d.ONES=[1,1];d.UNIT_X=[1,0];d.UNIT_Y=[0,1]})},"esri/core/libs/gl-matrix-2/vec4f64":function(){define(["require","exports","./factories/vec4f64"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});d.vec4f64=t})},"esri/core/libs/gl-matrix-2/factories/vec4f64":function(){define(["require",
"exports"],function(z,d){function t(){return[0,0,0,0]}function l(){return[1,1,1,1]}function q(){return[1,0,0,0]}function b(){return[0,1,0,0]}function f(){return[0,0,1,0]}function h(){return[0,0,0,1]}Object.defineProperty(d,"__esModule",{value:!0});d.create=t;d.clone=function(b){return[b[0],b[1],b[2],b[3]]};d.fromValues=function(b,c,a,m){return[b,c,a,m]};d.fromArray=function(b){for(var c=t(),a=Math.min(4,b.length),m=0;m<a;++m)c[m]=b[m];return c};d.createView=function(b,c){return new Float64Array(b,
c,4)};d.zeros=function(){return t()};d.ones=l;d.unitX=q;d.unitY=b;d.unitZ=f;d.unitW=h;d.ZEROS=t();d.ONES=l();d.UNIT_X=q();d.UNIT_Y=b();d.UNIT_Z=f();d.UNIT_W=h()})},"esri/views/3d/layers/graphics/constants":function(){define(["require","exports","../../../../core/libs/gl-matrix-2/vec4f64"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});d.defaultIconElevationOffset=1;d.SUSPEND_RESUME_EXTENT_OPTIMISM=1.2;d.TRANSPARENT_UNIT=t.vec4f64.ZEROS;d.WHITE_UNIT=t.vec4f64.ONES})},"esri/views/3d/layers/graphics/ElevationAligners":function(){define("require exports ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../geometry/Point ./elevationAlignmentUtils ./graphicUtils ../../support/debugFlags ../../support/projectionUtils ../../webgl-engine/lib/Util".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m){Object.defineProperty(d,"__esModule",{value:!0});var u=m.VertexAttrConstants;d.perVertexElevationAligner=function(a,b,m,f){a=a.stageObject;w.spatialReference=m.spatialReference;for(var r=a.geometryRecords,l=r.length,q="absolute-height"!==b.mode,x=0,D=0;D<l;D++){var t=r[D].geometry,K=r[D].getShaderTransformation();E[0]=K[12];E[1]=K[13];E[2]=K[14];t.invalidateBoundingInfo();for(var K=t.data.getVertexAttr(),J=K[u.POSITION],t=J.data,K=K.mapPos.data,J=J.size,I=t.length/
J,N=0,p=0,L=!1,A=0,k=0;k<I;k++){w.x=K[p++];w.y=K[p++];w.z=K[p++];C[0]=t[N];C[1]=t[N+1];C[2]=t[N+2];var e=h.evaluateElevationAlignmentAtPoint(w,m,b,f,q?G:null);q&&(A+=G.sampledElevation);v[0]=t[N]+E[0];v[1]=t[N+1]+E[1];v[2]=t[N+2]+E[2];f.setAltitude(e,v);t[N]=v[0]-E[0];t[N+1]=v[1]-E[1];t[N+2]=v[2]-E[2];if(c.TESTS_DISABLE_UPDATE_THRESHOLDS)L=!0;else if(e=d.updateThresholdInMeters/f.unitInMeters,Math.abs(C[0]-t[N])>=e||Math.abs(C[1]-t[N+1])>=e||Math.abs(C[2]-t[N+2])>=e)L=!0;N+=J}x+=A/I;L&&a.geometryVertexAttrsUpdated(D)}return x/
l};d.perObjectElevationAligner=function(b,m,f,u){b=b.stageObject;var w=m.centerPointInElevationSR,l=0,x=0;if(b.metadata.usesVerticalDistanceToGround)l=h.evaluateElevationAlignmentAtPoint(w,f,m,u,G),r.updateVertexAttributeAuxpos1w(b,G.verticalDistanceToGround),x=G.sampledElevation;else{var C="absolute-height"!==m.mode,l=h.evaluateElevationAlignmentAtPoint(w,f,m,u,C?G:null);C&&(x=G.sampledElevation)}m=t.mat4.copy(D,b.objectTransformation);f=q.vec3.set(K,m[12],m[13],m[14]);c.DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES?
(v[0]=w.x,v[1]=w.y,v[2]=l,a.computeLinearTransformation(w.spatialReference,v,m,u.spatialReference)&&(b.objectTransformation=m)):u.setAltitudeOfTransformation(l,m);u=d.updateThresholdInMeters/u.unitInMeters;if(Math.abs(m[12]-f[0])>=u||Math.abs(m[13]-f[1])>=u||Math.abs(m[14]-f[2])>=u)b.objectTransformation=m;return x};var D=l.mat4f64.create();d.perLodInstanceElevationAligner=function(b,m,f,u){var w=m.centerPointInElevationSR,r=0,l=0,x="absolute-height"!==m.mode,r=h.evaluateElevationAlignmentAtPoint(w,
f,m,u,x?G:null);x&&(l=G.sampledElevation);m=b.graphics3DSymbolLayer.lodRenderer.instanceData;b=b.instanceIndex;f=J;m.getGlobalTransform(b,f);x=q.vec3.set(K,f[12],f[13],f[14]);c.DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES?(v[0]=w.x,v[1]=w.y,v[2]=r,a.computeLinearTransformation(w.spatialReference,v,f,u.spatialReference)&&m.setGlobalTransform(b,f)):u.setAltitudeOfTransformation(r,f);u=d.updateThresholdInMeters/u.unitInMeters;(Math.abs(f[12]-x[0])>=u||Math.abs(f[13]-x[1])>=u||Math.abs(f[14]-x[2])>=u)&&
m.setGlobalTransform(b,f);return l};d.updateThresholdInMeters=.01;d.iterativeUpdatesEnabled=!0;var w=new f,v=b.vec3f64.create(),E=b.vec3f64.create(),C=b.vec3f64.create(),J=l.mat4f64.create(),K=b.vec3f64.create(),G={verticalDistanceToGround:0,sampledElevation:0}})},"esri/core/libs/gl-matrix-2/mat4":function(){define(["require","exports","./math/mat4"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});d.mat4=t})},"esri/core/libs/gl-matrix-2/math/mat4":function(){define(["require","exports",
"../factories/vec3f64","./common"],function(z,d,t,l){function q(c){c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=1;c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=1;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c}function b(c,a,b){var m=a[0],f=a[1],h=a[2],d=a[3],r=a[4],l=a[5],q=a[6],t=a[7],G=a[8],I=a[9],x=a[10],N=a[11],O=a[12],P=a[13],S=a[14];a=a[15];var R=b[0],Q=b[1],U=b[2],V=b[3];c[0]=R*m+Q*r+U*G+V*O;c[1]=R*f+Q*l+U*I+V*P;c[2]=R*h+Q*q+U*x+V*S;c[3]=R*d+Q*t+U*N+V*a;R=b[4];Q=b[5];U=b[6];V=b[7];c[4]=R*m+Q*r+U*G+V*O;c[5]=
R*f+Q*l+U*I+V*P;c[6]=R*h+Q*q+U*x+V*S;c[7]=R*d+Q*t+U*N+V*a;R=b[8];Q=b[9];U=b[10];V=b[11];c[8]=R*m+Q*r+U*G+V*O;c[9]=R*f+Q*l+U*I+V*P;c[10]=R*h+Q*q+U*x+V*S;c[11]=R*d+Q*t+U*N+V*a;R=b[12];Q=b[13];U=b[14];V=b[15];c[12]=R*m+Q*r+U*G+V*O;c[13]=R*f+Q*l+U*I+V*P;c[14]=R*h+Q*q+U*x+V*S;c[15]=R*d+Q*t+U*N+V*a;return c}function f(c,a,b){var m=a[0],f=a[1],h=a[2],d=a[3],r=m+m,l=f+f,q=h+h;a=m*r;var t=m*l,m=m*q,G=f*l,f=f*q,h=h*q,r=d*r,l=d*l,d=d*q;c[0]=1-(G+h);c[1]=t+d;c[2]=m-l;c[3]=0;c[4]=t-d;c[5]=1-(a+h);c[6]=f+r;c[7]=
0;c[8]=m+l;c[9]=f-r;c[10]=1-(a+G);c[11]=0;c[12]=b[0];c[13]=b[1];c[14]=b[2];c[15]=1;return c}function h(c,a,b){c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];c[3]=a[3]-b[3];c[4]=a[4]-b[4];c[5]=a[5]-b[5];c[6]=a[6]-b[6];c[7]=a[7]-b[7];c[8]=a[8]-b[8];c[9]=a[9]-b[9];c[10]=a[10]-b[10];c[11]=a[11]-b[11];c[12]=a[12]-b[12];c[13]=a[13]-b[13];c[14]=a[14]-b[14];c[15]=a[15]-b[15];return c}Object.defineProperty(d,"__esModule",{value:!0});d.copy=function(c,a){c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=
a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];c[9]=a[9];c[10]=a[10];c[11]=a[11];c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};d.set=function(c,a,b,f,h,d,v,r,l,q,t,G,I,x,N,O,P){c[0]=a;c[1]=b;c[2]=f;c[3]=h;c[4]=d;c[5]=v;c[6]=r;c[7]=l;c[8]=q;c[9]=t;c[10]=G;c[11]=I;c[12]=x;c[13]=N;c[14]=O;c[15]=P;return c};d.identity=q;d.transpose=function(c,a){if(c===a){var b=a[1],f=a[2],h=a[3],d=a[6],v=a[7],r=a[11];c[1]=a[4];c[2]=a[8];c[3]=a[12];c[4]=b;c[6]=a[9];c[7]=a[13];c[8]=f;c[9]=d;c[11]=a[14];c[12]=h;c[13]=v;
c[14]=r}else c[0]=a[0],c[1]=a[4],c[2]=a[8],c[3]=a[12],c[4]=a[1],c[5]=a[5],c[6]=a[9],c[7]=a[13],c[8]=a[2],c[9]=a[6],c[10]=a[10],c[11]=a[14],c[12]=a[3],c[13]=a[7],c[14]=a[11],c[15]=a[15];return c};d.invert=function(c,a){var b=a[0],f=a[1],h=a[2],d=a[3],v=a[4],r=a[5],l=a[6],q=a[7],t=a[8],G=a[9],I=a[10],x=a[11],N=a[12],O=a[13],P=a[14];a=a[15];var S=b*r-f*v,R=b*l-h*v,Q=b*q-d*v,U=f*l-h*r,V=f*q-d*r,Y=h*q-d*l,T=t*O-G*N,aa=t*P-I*N,W=t*a-x*N,p=G*P-I*O,L=G*a-x*O,A=I*a-x*P,k=S*A-R*L+Q*p+U*W-V*aa+Y*T;if(!k)return null;
k=1/k;c[0]=(r*A-l*L+q*p)*k;c[1]=(h*L-f*A-d*p)*k;c[2]=(O*Y-P*V+a*U)*k;c[3]=(I*V-G*Y-x*U)*k;c[4]=(l*W-v*A-q*aa)*k;c[5]=(b*A-h*W+d*aa)*k;c[6]=(P*Q-N*Y-a*R)*k;c[7]=(t*Y-I*Q+x*R)*k;c[8]=(v*L-r*W+q*T)*k;c[9]=(f*W-b*L-d*T)*k;c[10]=(N*V-O*Q+a*S)*k;c[11]=(G*Q-t*V-x*S)*k;c[12]=(r*aa-v*p-l*T)*k;c[13]=(b*p-f*aa+h*T)*k;c[14]=(O*R-N*U-P*S)*k;c[15]=(t*U-G*R+I*S)*k;return c};d.adjoint=function(c,a){var b=a[0],f=a[1],h=a[2],d=a[3],v=a[4],r=a[5],l=a[6],q=a[7],t=a[8],G=a[9],I=a[10],x=a[11],N=a[12],O=a[13],P=a[14];a=
a[15];c[0]=r*(I*a-x*P)-G*(l*a-q*P)+O*(l*x-q*I);c[1]=-(f*(I*a-x*P)-G*(h*a-d*P)+O*(h*x-d*I));c[2]=f*(l*a-q*P)-r*(h*a-d*P)+O*(h*q-d*l);c[3]=-(f*(l*x-q*I)-r*(h*x-d*I)+G*(h*q-d*l));c[4]=-(v*(I*a-x*P)-t*(l*a-q*P)+N*(l*x-q*I));c[5]=b*(I*a-x*P)-t*(h*a-d*P)+N*(h*x-d*I);c[6]=-(b*(l*a-q*P)-v*(h*a-d*P)+N*(h*q-d*l));c[7]=b*(l*x-q*I)-v*(h*x-d*I)+t*(h*q-d*l);c[8]=v*(G*a-x*O)-t*(r*a-q*O)+N*(r*x-q*G);c[9]=-(b*(G*a-x*O)-t*(f*a-d*O)+N*(f*x-d*G));c[10]=b*(r*a-q*O)-v*(f*a-d*O)+N*(f*q-d*r);c[11]=-(b*(r*x-q*G)-v*(f*x-d*
G)+t*(f*q-d*r));c[12]=-(v*(G*P-I*O)-t*(r*P-l*O)+N*(r*I-l*G));c[13]=b*(G*P-I*O)-t*(f*P-h*O)+N*(f*I-h*G);c[14]=-(b*(r*P-l*O)-v*(f*P-h*O)+N*(f*l-h*r));c[15]=b*(r*I-l*G)-v*(f*I-h*G)+t*(f*l-h*r);return c};d.determinant=function(c){var a=c[0],b=c[1],f=c[2],h=c[3],d=c[4],v=c[5],r=c[6],l=c[7],q=c[8],t=c[9],G=c[10],I=c[11],x=c[12],N=c[13],O=c[14];c=c[15];return(a*v-b*d)*(G*c-I*O)-(a*r-f*d)*(t*c-I*N)+(a*l-h*d)*(t*O-G*N)+(b*r-f*v)*(q*c-I*x)-(b*l-h*v)*(q*O-G*x)+(f*l-h*r)*(q*N-t*x)};d.multiply=b;d.translate=function(c,
a,b){var m=b[0],f=b[1];b=b[2];var h=void 0,d=void 0,r=void 0,l=void 0,q=void 0,t=void 0,G=void 0,I=void 0,x=void 0,N=void 0,O=void 0,P=void 0;a===c?(c[12]=a[0]*m+a[4]*f+a[8]*b+a[12],c[13]=a[1]*m+a[5]*f+a[9]*b+a[13],c[14]=a[2]*m+a[6]*f+a[10]*b+a[14],c[15]=a[3]*m+a[7]*f+a[11]*b+a[15]):(h=a[0],d=a[1],r=a[2],l=a[3],q=a[4],t=a[5],G=a[6],I=a[7],x=a[8],N=a[9],O=a[10],P=a[11],c[0]=h,c[1]=d,c[2]=r,c[3]=l,c[4]=q,c[5]=t,c[6]=G,c[7]=I,c[8]=x,c[9]=N,c[10]=O,c[11]=P,c[12]=h*m+q*f+x*b+a[12],c[13]=d*m+t*f+N*b+a[13],
c[14]=r*m+G*f+O*b+a[14],c[15]=l*m+I*f+P*b+a[15]);return c};d.scale=function(c,a,b){var m=b[0],f=b[1];b=b[2];c[0]=a[0]*m;c[1]=a[1]*m;c[2]=a[2]*m;c[3]=a[3]*m;c[4]=a[4]*f;c[5]=a[5]*f;c[6]=a[6]*f;c[7]=a[7]*f;c[8]=a[8]*b;c[9]=a[9]*b;c[10]=a[10]*b;c[11]=a[11]*b;c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};d.rotate=function(c,a,b,f){var m=f[0],h=f[1];f=f[2];var d=Math.sqrt(m*m+h*h+f*f),u=void 0,r=void 0,q=void 0,t=void 0,G=void 0,I=void 0,x=void 0,N=void 0,O=void 0,P=void 0,S=void 0,R=void 0,
Q=void 0,U=void 0,V=void 0,Y=void 0,T=void 0,aa=void 0,W=void 0,p=void 0,L=void 0,A=void 0,r=u=void 0;if(d<l.EPSILON)return null;d=1/d;m*=d;h*=d;f*=d;u=Math.sin(b);r=Math.cos(b);q=1-r;t=a[0];G=a[1];I=a[2];x=a[3];N=a[4];O=a[5];P=a[6];S=a[7];R=a[8];Q=a[9];U=a[10];V=a[11];Y=m*m*q+r;T=h*m*q+f*u;aa=f*m*q-h*u;W=m*h*q-f*u;p=h*h*q+r;L=f*h*q+m*u;A=m*f*q+h*u;u=h*f*q-m*u;r=f*f*q+r;c[0]=t*Y+N*T+R*aa;c[1]=G*Y+O*T+Q*aa;c[2]=I*Y+P*T+U*aa;c[3]=x*Y+S*T+V*aa;c[4]=t*W+N*p+R*L;c[5]=G*W+O*p+Q*L;c[6]=I*W+P*p+U*L;c[7]=
x*W+S*p+V*L;c[8]=t*A+N*u+R*r;c[9]=G*A+O*u+Q*r;c[10]=I*A+P*u+U*r;c[11]=x*A+S*u+V*r;a!==c&&(c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]);return c};d.rotateX=function(c,a,b){var m=Math.sin(b);b=Math.cos(b);var f=a[4],h=a[5],d=a[6],r=a[7],l=a[8],q=a[9],t=a[10],G=a[11];a!==c&&(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]);c[4]=f*b+l*m;c[5]=h*b+q*m;c[6]=d*b+t*m;c[7]=r*b+G*m;c[8]=l*b-f*m;c[9]=q*b-h*m;c[10]=t*b-d*m;c[11]=G*b-r*m;return c};d.rotateY=function(c,
a,b){var m=Math.sin(b);b=Math.cos(b);var f=a[0],h=a[1],d=a[2],r=a[3],l=a[8],q=a[9],t=a[10],G=a[11];a!==c&&(c[4]=a[4],c[5]=a[5],c[6]=a[6],c[7]=a[7],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]);c[0]=f*b-l*m;c[1]=h*b-q*m;c[2]=d*b-t*m;c[3]=r*b-G*m;c[8]=f*m+l*b;c[9]=h*m+q*b;c[10]=d*m+t*b;c[11]=r*m+G*b;return c};d.rotateZ=function(c,a,b){var m=Math.sin(b);b=Math.cos(b);var f=a[0],h=a[1],d=a[2],r=a[3],l=a[4],q=a[5],t=a[6],G=a[7];a!==c&&(c[8]=a[8],c[9]=a[9],c[10]=a[10],c[11]=a[11],c[12]=a[12],c[13]=a[13],
c[14]=a[14],c[15]=a[15]);c[0]=f*b+l*m;c[1]=h*b+q*m;c[2]=d*b+t*m;c[3]=r*b+G*m;c[4]=l*b-f*m;c[5]=q*b-h*m;c[6]=t*b-d*m;c[7]=G*b-r*m;return c};d.fromTranslation=function(c,a){c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=1;c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=1;c[11]=0;c[12]=a[0];c[13]=a[1];c[14]=a[2];c[15]=1;return c};d.fromScaling=function(c,a){c[0]=a[0];c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=a[1];c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=a[2];c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};d.fromRotation=function(c,a,
b){var m=b[0],f=b[1];b=b[2];var h=Math.sqrt(m*m+f*f+b*b),d=void 0,r=void 0,q=void 0;if(h<l.EPSILON)return null;h=1/h;m*=h;f*=h;b*=h;d=Math.sin(a);r=Math.cos(a);q=1-r;c[0]=m*m*q+r;c[1]=f*m*q+b*d;c[2]=b*m*q-f*d;c[3]=0;c[4]=m*f*q-b*d;c[5]=f*f*q+r;c[6]=b*f*q+m*d;c[7]=0;c[8]=m*b*q+f*d;c[9]=f*b*q-m*d;c[10]=b*b*q+r;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};d.fromXRotation=function(c,a){var b=Math.sin(a);a=Math.cos(a);c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=a;c[6]=b;c[7]=0;c[8]=0;c[9]=-b;c[10]=a;
c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};d.fromYRotation=function(c,a){var b=Math.sin(a);a=Math.cos(a);c[0]=a;c[1]=0;c[2]=-b;c[3]=0;c[4]=0;c[5]=1;c[6]=0;c[7]=0;c[8]=b;c[9]=0;c[10]=a;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};d.fromZRotation=function(c,a){var b=Math.sin(a);a=Math.cos(a);c[0]=a;c[1]=b;c[2]=0;c[3]=0;c[4]=-b;c[5]=a;c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=1;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};d.fromRotationTranslation=f;d.fromQuat2=function(c,a){var b=r,h=-a[0],
d=-a[1],l=-a[2],v=a[3],q=a[4],C=a[5],t=a[6],K=a[7],G=h*h+d*d+l*l+v*v;0<G?(b[0]=2*(q*v+K*h+C*l-t*d)/G,b[1]=2*(C*v+K*d+t*h-q*l)/G,b[2]=2*(t*v+K*l+q*d-C*h)/G):(b[0]=2*(q*v+K*h+C*l-t*d),b[1]=2*(C*v+K*d+t*h-q*l),b[2]=2*(t*v+K*l+q*d-C*h));f(c,a,b);return c};var r=t.create();d.getTranslation=function(c,a){c[0]=a[12];c[1]=a[13];c[2]=a[14];return c};d.getScaling=function(c,a){var b=a[0],f=a[1],h=a[2],d=a[4],r=a[5],l=a[6],q=a[8],t=a[9];a=a[10];c[0]=Math.sqrt(b*b+f*f+h*h);c[1]=Math.sqrt(d*d+r*r+l*l);c[2]=Math.sqrt(q*
q+t*t+a*a);return c};d.getRotation=function(c,a){var b=a[0]+a[5]+a[10],f=0;0<b?(f=2*Math.sqrt(b+1),c[3]=.25*f,c[0]=(a[6]-a[9])/f,c[1]=(a[8]-a[2])/f,c[2]=(a[1]-a[4])/f):a[0]>a[5]&&a[0]>a[10]?(f=2*Math.sqrt(1+a[0]-a[5]-a[10]),c[3]=(a[6]-a[9])/f,c[0]=.25*f,c[1]=(a[1]+a[4])/f,c[2]=(a[8]+a[2])/f):a[5]>a[10]?(f=2*Math.sqrt(1+a[5]-a[0]-a[10]),c[3]=(a[8]-a[2])/f,c[0]=(a[1]+a[4])/f,c[1]=.25*f,c[2]=(a[6]+a[9])/f):(f=2*Math.sqrt(1+a[10]-a[0]-a[5]),c[3]=(a[1]-a[4])/f,c[0]=(a[8]+a[2])/f,c[1]=(a[6]+a[9])/f,c[2]=
.25*f);return c};d.fromRotationTranslationScale=function(c,a,b,f){var m=a[0],h=a[1],d=a[2],u=a[3],r=m+m,l=h+h,q=d+d;a=m*r;var t=m*l,m=m*q,I=h*l,h=h*q,d=d*q,r=u*r,l=u*l,u=u*q,q=f[0],x=f[1];f=f[2];c[0]=(1-(I+d))*q;c[1]=(t+u)*q;c[2]=(m-l)*q;c[3]=0;c[4]=(t-u)*x;c[5]=(1-(a+d))*x;c[6]=(h+r)*x;c[7]=0;c[8]=(m+l)*f;c[9]=(h-r)*f;c[10]=(1-(a+I))*f;c[11]=0;c[12]=b[0];c[13]=b[1];c[14]=b[2];c[15]=1;return c};d.fromRotationTranslationScaleOrigin=function(c,a,b,f,h){var m=a[0],d=a[1],u=a[2],r=a[3],l=m+m,q=d+d,D=
u+u;a=m*l;var t=m*q,x=m*D,m=d*q,d=d*D,N=u*D,u=r*l,q=r*q,O=r*D,P=f[0],S=f[1],D=f[2];f=h[0];r=h[1];h=h[2];var l=(1-(m+N))*P,R=(t+O)*P,P=(x-q)*P,t=(t-O)*S,N=(1-(a+N))*S,S=(d+u)*S,x=(x+q)*D,d=(d-u)*D;a=(1-(a+m))*D;c[0]=l;c[1]=R;c[2]=P;c[3]=0;c[4]=t;c[5]=N;c[6]=S;c[7]=0;c[8]=x;c[9]=d;c[10]=a;c[11]=0;c[12]=b[0]+f-(l*f+t*r+x*h);c[13]=b[1]+r-(R*f+N*r+d*h);c[14]=b[2]+h-(P*f+S*r+a*h);c[15]=1;return c};d.fromQuat=function(c,a){var b=a[0],f=a[1],h=a[2];a=a[3];var d=b+b,r=f+f,l=h+h,b=b*d,q=f*d,f=f*r,t=h*d,K=h*
r,h=h*l,d=a*d,r=a*r;a*=l;c[0]=1-f-h;c[1]=q+a;c[2]=t-r;c[3]=0;c[4]=q-a;c[5]=1-b-h;c[6]=K+d;c[7]=0;c[8]=t+r;c[9]=K-d;c[10]=1-b-f;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};d.frustum=function(c,a,b,f,h,d,r){var m=1/(b-a),u=1/(h-f),l=1/(d-r);c[0]=2*d*m;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=2*d*u;c[6]=0;c[7]=0;c[8]=(b+a)*m;c[9]=(h+f)*u;c[10]=(r+d)*l;c[11]=-1;c[12]=0;c[13]=0;c[14]=r*d*2*l;c[15]=0;return c};d.perspective=function(c,a,b,f,h){a=1/Math.tan(a/2);var m=void 0;c[0]=a/b;c[1]=0;c[2]=0;c[3]=0;
c[4]=0;c[5]=a;c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[11]=-1;c[12]=0;c[13]=0;c[15]=0;null!=h&&Infinity!==h?(m=1/(f-h),c[10]=(h+f)*m,c[14]=2*h*f*m):(c[10]=-1,c[14]=-2*f);return c};d.perspectiveFromFieldOfView=function(c,a,b,f){var m=Math.tan(a.upDegrees*Math.PI/180),h=Math.tan(a.downDegrees*Math.PI/180),d=Math.tan(a.leftDegrees*Math.PI/180);a=Math.tan(a.rightDegrees*Math.PI/180);var r=2/(d+a),u=2/(m+h);c[0]=r;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=u;c[6]=0;c[7]=0;c[8]=-((d-a)*r*.5);c[9]=(m-h)*u*.5;c[10]=f/(b-f);c[11]=
-1;c[12]=0;c[13]=0;c[14]=f*b/(b-f);c[15]=0;return c};d.ortho=function(c,a,b,f,h,d,r){var m=1/(a-b),u=1/(f-h),l=1/(d-r);c[0]=-2*m;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=-2*u;c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=2*l;c[11]=0;c[12]=(a+b)*m;c[13]=(h+f)*u;c[14]=(r+d)*l;c[15]=1;return c};d.lookAt=function(c,a,b,f){var m=void 0,h=void 0,d=void 0,r=void 0,u=void 0,t=void 0,K=void 0,G=void 0,I=void 0,x=void 0,N=a[0],O=a[1];a=a[2];d=f[0];r=f[1];f=f[2];K=b[0];G=b[1];b=b[2];if(Math.abs(N-K)<l.EPSILON&&Math.abs(O-G)<l.EPSILON&&
Math.abs(a-b)<l.EPSILON)return q(c);K=N-K;G=O-G;I=a-b;x=1/Math.sqrt(K*K+G*G+I*I);K*=x;G*=x;I*=x;m=r*I-f*G;h=f*K-d*I;d=d*G-r*K;(x=Math.sqrt(m*m+h*h+d*d))?(x=1/x,m*=x,h*=x,d*=x):d=h=m=0;r=G*d-I*h;u=I*m-K*d;t=K*h-G*m;(x=Math.sqrt(r*r+u*u+t*t))?(x=1/x,r*=x,u*=x,t*=x):t=u=r=0;c[0]=m;c[1]=r;c[2]=K;c[3]=0;c[4]=h;c[5]=u;c[6]=G;c[7]=0;c[8]=d;c[9]=t;c[10]=I;c[11]=0;c[12]=-(m*N+h*O+d*a);c[13]=-(r*N+u*O+t*a);c[14]=-(K*N+G*O+I*a);c[15]=1;return c};d.targetTo=function(c,a,b,f){var m=a[0],h=a[1];a=a[2];var d=f[0],
r=f[1],u=f[2];f=m-b[0];var l=h-b[1];b=a-b[2];var q=f*f+l*l+b*b;0<q&&(q=1/Math.sqrt(q),f*=q,l*=q,b*=q);var t=r*b-u*l,u=u*f-d*b,d=d*l-r*f,q=t*t+u*u+d*d;0<q&&(q=1/Math.sqrt(q),t*=q,u*=q,d*=q);c[0]=t;c[1]=u;c[2]=d;c[3]=0;c[4]=l*d-b*u;c[5]=b*t-f*d;c[6]=f*u-l*t;c[7]=0;c[8]=f;c[9]=l;c[10]=b;c[11]=0;c[12]=m;c[13]=h;c[14]=a;c[15]=1;return c};d.str=function(c){return"mat4("+c[0]+", "+c[1]+", "+c[2]+", "+c[3]+", "+c[4]+", "+c[5]+", "+c[6]+", "+c[7]+", "+c[8]+", "+c[9]+", "+c[10]+", "+c[11]+", "+c[12]+", "+c[13]+
", "+c[14]+", "+c[15]+")"};d.frob=function(c){return Math.sqrt(Math.pow(c[0],2)+Math.pow(c[1],2)+Math.pow(c[2],2)+Math.pow(c[3],2)+Math.pow(c[4],2)+Math.pow(c[5],2)+Math.pow(c[6],2)+Math.pow(c[7],2)+Math.pow(c[8],2)+Math.pow(c[9],2)+Math.pow(c[10],2)+Math.pow(c[11],2)+Math.pow(c[12],2)+Math.pow(c[13],2)+Math.pow(c[14],2)+Math.pow(c[15],2))};d.add=function(c,a,b){c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2];c[3]=a[3]+b[3];c[4]=a[4]+b[4];c[5]=a[5]+b[5];c[6]=a[6]+b[6];c[7]=a[7]+b[7];c[8]=a[8]+b[8];c[9]=
a[9]+b[9];c[10]=a[10]+b[10];c[11]=a[11]+b[11];c[12]=a[12]+b[12];c[13]=a[13]+b[13];c[14]=a[14]+b[14];c[15]=a[15]+b[15];return c};d.subtract=h;d.multiplyScalar=function(c,a,b){c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b;c[3]=a[3]*b;c[4]=a[4]*b;c[5]=a[5]*b;c[6]=a[6]*b;c[7]=a[7]*b;c[8]=a[8]*b;c[9]=a[9]*b;c[10]=a[10]*b;c[11]=a[11]*b;c[12]=a[12]*b;c[13]=a[13]*b;c[14]=a[14]*b;c[15]=a[15]*b;return c};d.multiplyScalarAndAdd=function(c,a,b,f){c[0]=a[0]+b[0]*f;c[1]=a[1]+b[1]*f;c[2]=a[2]+b[2]*f;c[3]=a[3]+b[3]*f;c[4]=
a[4]+b[4]*f;c[5]=a[5]+b[5]*f;c[6]=a[6]+b[6]*f;c[7]=a[7]+b[7]*f;c[8]=a[8]+b[8]*f;c[9]=a[9]+b[9]*f;c[10]=a[10]+b[10]*f;c[11]=a[11]+b[11]*f;c[12]=a[12]+b[12]*f;c[13]=a[13]+b[13]*f;c[14]=a[14]+b[14]*f;c[15]=a[15]+b[15]*f;return c};d.exactEquals=function(c,a){return c[0]===a[0]&&c[1]===a[1]&&c[2]===a[2]&&c[3]===a[3]&&c[4]===a[4]&&c[5]===a[5]&&c[6]===a[6]&&c[7]===a[7]&&c[8]===a[8]&&c[9]===a[9]&&c[10]===a[10]&&c[11]===a[11]&&c[12]===a[12]&&c[13]===a[13]&&c[14]===a[14]&&c[15]===a[15]};d.equals=function(c,
a){var b=c[0],f=c[1],h=c[2],d=c[3],r=c[4],q=c[5],C=c[6],t=c[7],K=c[8],G=c[9],I=c[10],x=c[11],N=c[12],O=c[13],P=c[14];c=c[15];var S=a[0],R=a[1],Q=a[2],U=a[3],V=a[4],Y=a[5],T=a[6],aa=a[7],W=a[8],p=a[9],L=a[10],A=a[11],k=a[12],e=a[13],g=a[14];a=a[15];return Math.abs(b-S)<=l.EPSILON*Math.max(1,Math.abs(b),Math.abs(S))&&Math.abs(f-R)<=l.EPSILON*Math.max(1,Math.abs(f),Math.abs(R))&&Math.abs(h-Q)<=l.EPSILON*Math.max(1,Math.abs(h),Math.abs(Q))&&Math.abs(d-U)<=l.EPSILON*Math.max(1,Math.abs(d),Math.abs(U))&&
Math.abs(r-V)<=l.EPSILON*Math.max(1,Math.abs(r),Math.abs(V))&&Math.abs(q-Y)<=l.EPSILON*Math.max(1,Math.abs(q),Math.abs(Y))&&Math.abs(C-T)<=l.EPSILON*Math.max(1,Math.abs(C),Math.abs(T))&&Math.abs(t-aa)<=l.EPSILON*Math.max(1,Math.abs(t),Math.abs(aa))&&Math.abs(K-W)<=l.EPSILON*Math.max(1,Math.abs(K),Math.abs(W))&&Math.abs(G-p)<=l.EPSILON*Math.max(1,Math.abs(G),Math.abs(p))&&Math.abs(I-L)<=l.EPSILON*Math.max(1,Math.abs(I),Math.abs(L))&&Math.abs(x-A)<=l.EPSILON*Math.max(1,Math.abs(x),Math.abs(A))&&Math.abs(N-
k)<=l.EPSILON*Math.max(1,Math.abs(N),Math.abs(k))&&Math.abs(O-e)<=l.EPSILON*Math.max(1,Math.abs(O),Math.abs(e))&&Math.abs(P-g)<=l.EPSILON*Math.max(1,Math.abs(P),Math.abs(g))&&Math.abs(c-a)<=l.EPSILON*Math.max(1,Math.abs(c),Math.abs(a))};d.mul=b;d.sub=h})},"esri/views/3d/layers/graphics/elevationAlignmentUtils":function(){define("require exports ../../../../core/compilerUtils ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/vec3f64 ./graphicUtils ../../support/ElevationProvider ../../support/projectionUtils".split(" "),
function(z,d,t,l,q,b,f,h,r){function c(a,c,b,f,m){var d=a.z||0,r=b.featureExpressionInfoContext;switch(b.mode){case "on-the-ground":var u=h.getElevationAtPoint(c,a,"ground")||0;m&&(m.verticalDistanceToGround=0,m.sampledElevation=u);return u;case "relative-to-ground":return u=h.getElevationAtPoint(c,a,"ground")||0,a=b.calculateOffsetRenderUnits(f),null==r&&(a+=d),m&&(m.verticalDistanceToGround=a,m.sampledElevation=u),a+u;case "relative-to-scene":return u=h.getElevationAtPoint(c,a,"scene")||0,a=b.calculateOffsetRenderUnits(f),
null==r&&(a+=d),m&&(m.verticalDistanceToGround=a,m.sampledElevation=u),a+u;case "absolute-height":return u=b.calculateOffsetRenderUnits(f),null==r&&(u+=d),m&&(d=h.getElevationAtPoint(c,a,"ground")||0,m.verticalDistanceToGround=u-d,m.sampledElevation=d),u;default:return t.neverReached(b.mode),0}}Object.defineProperty(d,"__esModule",{value:!0});d.applyPerVertexElevationAlignment=function(a,c,b,f,h,d,u,l,w,q,t){var v=m[t.mode],x=0;if(r.bufferToBuffer(a,c,b,f,w.spatialReference,h,l)&&(v.requiresAlignment(t)?
(x=v.applyElevationAlignmentBuffer(f,h,d,u,l,w,q,t),a=d,h=u):a=f,r.bufferToBuffer(a,w.spatialReference,h,d,q.spatialReference,u,l)))return x};d.evaluateElevationAlignmentAtPoint=c;d.elevationModeChangeUpdateType=function(c,b,f){return null==b||null==f?c.definedChanged:"on-the-ground"===b&&"on-the-ground"===f?c.staysOnTheGround:b===f||"on-the-ground"!==b&&"on-the-ground"!==f?a.UPDATE:c.onTheGroundChanged};d.needsElevationUpdates2D=function(a){return"relative-to-ground"===a||"relative-to-scene"===a};
d.needsElevationUpdates3D=function(a){return"absolute-height"!==a};d.applyElevationAlignmentForHUD=function(a,b,m,h,d){m=c(b,m,d,h,D);f.updateVertexAttributeAuxpos1w(a,D.verticalDistanceToGround);d=D.sampledElevation;var v=l.mat4.copy(u,a.objectTransformation);w[0]=b.x;w[1]=b.y;w[2]=m;r.computeLinearTransformation(b.spatialReference,w,v,h.spatialReference)?a.objectTransformation=v:console.warn("Could not locate symbol object properly, it might be misplaced");return d};var a;(function(a){a[a.NONE=
0]="NONE";a[a.UPDATE=1]="UPDATE";a[a.RECREATE=2]="RECREATE"})(a=d.SymbolUpdateType||(d.SymbolUpdateType={}));var m={"absolute-height":{applyElevationAlignmentBuffer:function(a,c,b,f,m,h,d,r){h=r.calculateOffsetRenderUnits(d);r=r.featureExpressionInfoContext;c*=3;f*=3;for(d=0;d<m;++d){var u=a[c+1],l=a[c+2];b[f+0]=a[c+0];b[f+1]=u;b[f+2]=null==r?l+h:h;c+=3;f+=3}return 0},requiresAlignment:function(a){var c=a.featureExpressionInfoContext;return 0!==a.meterUnitOffset||null!=c}},"on-the-ground":{applyElevationAlignmentBuffer:function(a,
c,b,f,m,h){var d=0,r=h.spatialReference;c*=3;f*=3;for(var u=0;u<m;++u){var l=a[c+0],v=a[c+1],w=h.getElevation(l,v,a[c+2],r,"ground")||0,d=d+w;b[f+0]=l;b[f+1]=v;b[f+2]=w;c+=3;f+=3}return d/m},requiresAlignment:function(){return!0}},"relative-to-ground":{applyElevationAlignmentBuffer:function(a,c,b,f,m,h,d,r){var u=0;d=r.calculateOffsetRenderUnits(d);r=r.featureExpressionInfoContext;var l=h.spatialReference;c*=3;f*=3;for(var v=0;v<m;++v){var w=a[c+0],q=a[c+1],x=a[c+2],t=h.getElevation(w,q,x,l,"ground")||
0,u=u+t;b[f+0]=w;b[f+1]=q;b[f+2]=null==r?x+t+d:t+d;c+=3;f+=3}return u/m},requiresAlignment:function(){return!0}},"relative-to-scene":{applyElevationAlignmentBuffer:function(a,c,b,f,m,h,d,r){var u=0;d=r.calculateOffsetRenderUnits(d);r=r.featureExpressionInfoContext;var l=h.spatialReference;c*=3;f*=3;for(var v=0;v<m;++v){var w=a[c+0],q=a[c+1],x=a[c+2],t=h.getElevation(w,q,x,l,"scene")||0,u=u+t;b[f+0]=w;b[f+1]=q;b[f+2]=null==r?x+t+d:t+d;c+=3;f+=3}return u/m},requiresAlignment:function(){return!0}}},
u=q.mat4f64.create(),D={verticalDistanceToGround:0,sampledElevation:0},w=b.vec3f64.create()})},"esri/views/3d/layers/graphics/graphicUtils":function(){define("require exports ../../../../core/mathUtils ../../../../core/maybe ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/vec2f64 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../core/libs/gl-matrix-2/vec4 ../../../../core/libs/gl-matrix-2/vec4f64 ../../../../geometry/support/aaBoundingBox ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/centroid ../../../../geometry/support/coordsUtils ../../../../layers/graphics/dehydratedFeatures ../../support/projectionUtils".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u,D,w,v){function E(a){var c=a.paths[0];if(!c||0===c.length)return null;c=D.getPointOnPath(c,D.getPathLength(c)/2);return w.makeDehydratedPoint(c[0],c[1],c[2],a.spatialReference)}function C(a,c,b){b=b?a:w.clonePoint(a);return c&&a?v.pointToPoint(a,b,c)?b:null:b}function J(a){if(Array.isArray(a)){for(var c=0;c<a.length;c++)if(!J(a[c]))return!1;return!0}return null==a||0<=a}Object.defineProperty(d,"__esModule",{value:!0});d.computeCentroid=function(a,c){if("point"===
a.type)return C(a,c,!1);if(w.isHydratedGeometry(a))switch(a.type){case "extent":return C(a.center,c,!1);case "polygon":return C(a.centroid,c,!1);case "polyline":return C(E(a),c,!0);case "mesh":return C(a.extent.center,c,!1)}else switch(a.type){case "extent":var b=t.isFinite(a.zmin);a=w.makeDehydratedPoint(.5*(a.xmax+a.xmin),.5*(a.ymax+a.ymin),b?.5*(a.zmax+a.zmin):void 0,a.spatialReference);return C(a,c,!0);case "polygon":return(b=a.rings[0])&&0!==b.length?(b=u.ringsCentroid(a.rings,a.hasZ),a=w.makeDehydratedPoint(b[0],
b[1],b[2],a.spatialReference)):a=null,C(a,c,!0);case "polyline":return C(E(a),c,!0)}};d.enlargeExtent=function(a,c,b){if(a){c||(c=m.create());var f=.5*a.width*(b-1);b=.5*a.height*(b-1);a.width<1E-7*a.height?f+=b/20:a.height<1E-7*a.width&&(b+=f/20);r.vec4.set(c,a.xmin-f,a.ymin-b,a.xmax+f,a.ymax+b);return c}return null};d.updateVertexAttributeAuxpos1w=function(a,c){for(var b=0;b<a.geometries.length;++b){var f=a.geometries[b].data.vertexAttributes.auxpos1;f&&f.data[3]!==c&&(f.data[3]=c,a.geometryVertexAttrsUpdated(b))}};
d.mixinColorAndOpacity=function(a,b){var f=c.vec4f64.clone(c.vec4f64.ONES);l.isSome(a)&&(f[0]=a[0],f[1]=a[1],f[2]=a[2]);l.isSome(b)?f[3]=b:l.isSome(a)&&3<a.length&&(f[3]=a[3]);return f};d.overrideColor=function(a,c,b,f,m,h){void 0===h&&(h=[0,0,0,0]);for(var d=0;3>d;++d)l.isSome(a)&&null!=a[d]?h[d]=a[d]:l.isSome(b)&&null!=b[d]?h[d]=b[d]:h[d]=m[d];l.isSome(c)?h[3]=c:l.isSome(f)?h[3]=f:h[3]=m[3];return h};d.computeObjectScale=function(a,c,b,f){void 0===a&&(a=h.vec3f64.ONES);void 0===f&&(f=1);var m=Array(3);
if(null==c||null==b)m[0]=1,m[1]=1,m[2]=1;else{for(var d=void 0,r=0,u=2;0<=u;u--){var l=a[u],v=void 0,w=null!=l,q=0===u&&!d&&!w,x=b[u];"symbol-value"===l||q?v=0!==x?c[u]/x:1:w&&"proportional"!==l&&isFinite(l)&&(v=0!==x?l/x:1);null!=v&&(d=m[u]=v,r=Math.max(r,Math.abs(v)))}for(u=2;0<=u;u--)null==m[u]?m[u]=d:0===m[u]&&(m[u]=.001*r)}for(u=2;0<=u;u--)m[u]/=f;return h.vec3f64.fromArray(m)};d.computeSizeWithResourceSize=function(a,c){var b=c.width,f=c.depth,m=c.height;c=c.isPrimitive?10:1;if(null==b&&null==
m&&null==f)return[c*a[0],c*a[1],c*a[2]];for(var b=h.vec3f64.fromValues(b,f,m),d,f=0;3>f;f++)if(m=b[f],null!=m){d=m/a[f];break}for(f=0;3>f;f++)null==b[f]&&(b[f]=a[f]*d);return b};d.validateSymbolLayerSize=function(a){null!=a.isPrimitive&&(a=[a.width,a.depth,a.height]);return J(a)?null:"Symbol sizes may not be negative values"};d.isValidSize=J;d.computeObjectRotation=function(a,c,f,m){void 0===m&&(m=b.mat4f64.create());a=a||0;c=c||0;f=f||0;0!==a&&q.mat4.rotateZ(m,m,-a/180*Math.PI);0!==c&&q.mat4.rotateX(m,
m,c/180*Math.PI);0!==f&&q.mat4.rotateY(m,m,f/180*Math.PI);return m};d.demResolutionForBoundingBox=function(c,b){return null!=b.minDemResolution?b.minDemResolution:a.isPoint(c)?b.minDemResolutionForPoints:.01*a.maximumDimension(c)};d.namedAnchorToHUDMaterialAnchorPos={"bottom-left":f.vec2f64.fromValues(0,0),bottom:f.vec2f64.fromValues(.5,0),"bottom-right":f.vec2f64.fromValues(1,0),left:f.vec2f64.fromValues(0,.5),center:f.vec2f64.fromValues(.5,.5),right:f.vec2f64.fromValues(1,.5),"top-left":f.vec2f64.fromValues(0,
1),top:f.vec2f64.fromValues(.5,1),"top-right":f.vec2f64.fromValues(1,1)}})},"esri/core/libs/gl-matrix-2/vec4":function(){define(["require","exports","./math/vec4"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});d.vec4=t})},"esri/core/libs/gl-matrix-2/math/vec4":function(){define(["require","exports","./common"],function(z,d,t){function l(a,c,b){a[0]=c[0]-b[0];a[1]=c[1]-b[1];a[2]=c[2]-b[2];a[3]=c[3]-b[3];return a}function q(a,c,b){a[0]=c[0]*b[0];a[1]=c[1]*b[1];a[2]=c[2]*b[2];a[3]=
c[3]*b[3];return a}function b(a,c,b){a[0]=c[0]/b[0];a[1]=c[1]/b[1];a[2]=c[2]/b[2];a[3]=c[3]/b[3];return a}function f(a,c){var b=c[0]-a[0],f=c[1]-a[1],m=c[2]-a[2];a=c[3]-a[3];return Math.sqrt(b*b+f*f+m*m+a*a)}function h(a,c){var b=c[0]-a[0],f=c[1]-a[1],m=c[2]-a[2];a=c[3]-a[3];return b*b+f*f+m*m+a*a}function r(a){var c=a[0],b=a[1],f=a[2];a=a[3];return Math.sqrt(c*c+b*b+f*f+a*a)}function c(a){var c=a[0],b=a[1],f=a[2];a=a[3];return c*c+b*b+f*f+a*a}Object.defineProperty(d,"__esModule",{value:!0});d.copy=
function(a,c){a[0]=c[0];a[1]=c[1];a[2]=c[2];a[3]=c[3];return a};d.set=function(a,c,b,f,h){a[0]=c;a[1]=b;a[2]=f;a[3]=h;return a};d.add=function(a,c,b){a[0]=c[0]+b[0];a[1]=c[1]+b[1];a[2]=c[2]+b[2];a[3]=c[3]+b[3];return a};d.subtract=l;d.multiply=q;d.divide=b;d.ceil=function(a,c){a[0]=Math.ceil(c[0]);a[1]=Math.ceil(c[1]);a[2]=Math.ceil(c[2]);a[3]=Math.ceil(c[3]);return a};d.floor=function(a,c){a[0]=Math.floor(c[0]);a[1]=Math.floor(c[1]);a[2]=Math.floor(c[2]);a[3]=Math.floor(c[3]);return a};d.min=function(a,
c,b){a[0]=Math.min(c[0],b[0]);a[1]=Math.min(c[1],b[1]);a[2]=Math.min(c[2],b[2]);a[3]=Math.min(c[3],b[3]);return a};d.max=function(a,c,b){a[0]=Math.max(c[0],b[0]);a[1]=Math.max(c[1],b[1]);a[2]=Math.max(c[2],b[2]);a[3]=Math.max(c[3],b[3]);return a};d.round=function(a,c){a[0]=Math.round(c[0]);a[1]=Math.round(c[1]);a[2]=Math.round(c[2]);a[3]=Math.round(c[3]);return a};d.scale=function(a,c,b){a[0]=c[0]*b;a[1]=c[1]*b;a[2]=c[2]*b;a[3]=c[3]*b;return a};d.scaleAndAdd=function(a,c,b,f){a[0]=c[0]+b[0]*f;a[1]=
c[1]+b[1]*f;a[2]=c[2]+b[2]*f;a[3]=c[3]+b[3]*f;return a};d.distance=f;d.squaredDistance=h;d.length=r;d.squaredLength=c;d.negate=function(a,c){a[0]=-c[0];a[1]=-c[1];a[2]=-c[2];a[3]=-c[3];return a};d.inverse=function(a,c){a[0]=1/c[0];a[1]=1/c[1];a[2]=1/c[2];a[3]=1/c[3];return a};d.normalize=function(a,c){var b=c[0],f=c[1],m=c[2];c=c[3];var h=b*b+f*f+m*m+c*c;0<h&&(h=1/Math.sqrt(h),a[0]=b*h,a[1]=f*h,a[2]=m*h,a[3]=c*h);return a};d.dot=function(a,c){return a[0]*c[0]+a[1]*c[1]+a[2]*c[2]+a[3]*c[3]};d.lerp=
function(a,c,b,f){var m=c[0],h=c[1],d=c[2];c=c[3];a[0]=m+f*(b[0]-m);a[1]=h+f*(b[1]-h);a[2]=d+f*(b[2]-d);a[3]=c+f*(b[3]-c);return a};d.random=function(a,c){c=c||1;var b,f,m,h,d,r;do b=2*t.RANDOM()-1,f=2*t.RANDOM()-1,d=b*b+f*f;while(1<=d);do m=2*t.RANDOM()-1,h=2*t.RANDOM()-1,r=m*m+h*h;while(1<=r);d=Math.sqrt((1-d)/r);a[0]=c*b;a[1]=c*f;a[2]=c*m*d;a[3]=c*h*d;return a};d.transformMat4=function(a,c,b){var f=c[0],m=c[1],h=c[2];c=c[3];a[0]=b[0]*f+b[4]*m+b[8]*h+b[12]*c;a[1]=b[1]*f+b[5]*m+b[9]*h+b[13]*c;a[2]=
b[2]*f+b[6]*m+b[10]*h+b[14]*c;a[3]=b[3]*f+b[7]*m+b[11]*h+b[15]*c;return a};d.transformQuat=function(a,c,b){var f=c[0],m=c[1],h=c[2],d=b[0],r=b[1],l=b[2];b=b[3];var u=b*f+r*h-l*m,q=b*m+l*f-d*h,t=b*h+d*m-r*f,f=-d*f-r*m-l*h;a[0]=u*b+f*-d+q*-l-t*-r;a[1]=q*b+f*-r+t*-d-u*-l;a[2]=t*b+f*-l+u*-r-q*-d;a[3]=c[3];return a};d.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};d.exactEquals=function(a,c){return a[0]===c[0]&&a[1]===c[1]&&a[2]===c[2]&&a[3]===c[3]};d.equals=function(a,c){var b=
a[0],f=a[1],m=a[2];a=a[3];var h=c[0],d=c[1],r=c[2];c=c[3];return Math.abs(b-h)<=t.EPSILON*Math.max(1,Math.abs(b),Math.abs(h))&&Math.abs(f-d)<=t.EPSILON*Math.max(1,Math.abs(f),Math.abs(d))&&Math.abs(m-r)<=t.EPSILON*Math.max(1,Math.abs(m),Math.abs(r))&&Math.abs(a-c)<=t.EPSILON*Math.max(1,Math.abs(a),Math.abs(c))};d.sub=l;d.mul=q;d.div=b;d.dist=f;d.sqrDist=h;d.len=r;d.sqrLen=c})},"esri/views/3d/support/projectionUtils":function(){define("require exports ../../../core/mathUtils ../../../core/maybe ../../../core/unitUtils ../../../core/libs/gl-matrix-2/mat4 ../../../core/libs/gl-matrix-2/vec3 ../../../core/libs/gl-matrix-2/vec3f64 ../../../geometry/Point ../../../geometry/SpatialReference ../../../geometry/support/aaBoundingRect ../../../layers/graphics/dehydratedFeatures ./earthUtils ../webgl-engine/lib/BufferVectorMath".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u,D){function w(e,g,n,k){2===e.length?(H[0]=e[0],H[1]=e[1],H[2]=0,e=H):e===n&&(f.vec3.copy(H,e),e=H);return v(e,g,0,n,k,0,1)}function v(e,n,k,y,p,B,a){void 0===a&&(a=1);n=S(n,p,g);if(l.isNone(n))return!1;if(n===C){if(e===y&&k===B)return!0;for(n=k+3*a;k<n;k++,B++)y[B]=e[k];return!0}for(a=k+3*a;k<a;k+=3,B+=3)n(e,k,y,B);return!0}function E(e,g){if(g.spatialReference===e)return g.spatialReferenceId;g.spatialReference=e;"metersPerUnit"in g&&(g.metersPerUnit=q.getMetersPerUnitForSR(e,
1));return e.wkt===d.SphericalECEFSpatialReference.wkt?g.spatialReferenceId=1:e.isWGS84?g.spatialReferenceId=2:e.isWebMercator?g.spatialReferenceId=3:e.wkt===d.WGS84ECEFSpatialReference.wkt?g.spatialReferenceId=4:4490===e.wkid?g.spatialReferenceId=5:g.spatialReferenceId=0}function C(e,g,n,k){n[k++]=e[g++];n[k++]=e[g++];n[k]=e[g]}function J(e,g,n,k){n[k++]=B*(e[g++]/u.earthRadius);n[k++]=B*(Math.PI/2-2*Math.atan(Math.exp(-1*e[g++]/u.earthRadius)));n[k]=e[g]}function K(e,g,n,k){var p=.4999999*Math.PI,
p=t.clamp(y*e[g+1],-p,p),p=Math.sin(p);n[k++]=y*e[g]*u.earthRadius;n[k++]=u.halfEarthRadius*Math.log((1+p)/(1-p));n[k]=e[g+2]}function G(e,g,n){g=E(g,k);g=A[g][6];if(l.isNone(g))return!1;g(e,0,H,0);n!==H&&(n[0]=H[0],n[1]=H[1],2<n.length&&(n[2]=H[2]));return!0}function I(e,g){H[0]=e.x;H[1]=e.y;H[2]=e.hasZ?e.z:0;return G(H,e.spatialReference,g)}function x(e,g,n,k){var p=u.earthRadius+e[g+2],B=y*e[g+1];e=y*e[g];g=Math.cos(B);n[k++]=Math.cos(e)*g*p;n[k++]=Math.sin(e)*g*p;n[k]=Math.sin(B)*p}function N(e,
g,n,k){var y=D.Vec3Compact.length(e,g),p=t.asinClamped(e[g+2]/(0===y?1:y));e=Math.atan2(e[g+1],e[g]);n[k++]=B*e;n[k++]=B*p;n[k]=y-u.earthRadius}function O(e,g,n,k){var p=F,B=y*e[g],a=y*e[g+1];e=e[g+2];g=Math.sin(a);var a=Math.cos(a),c=p.a/Math.sqrt(1-p.e2*g*g);n[k++]=(c+e)*a*Math.cos(B);n[k++]=(c+e)*a*Math.sin(B);n[k++]=(c*(1-p.e2)+e)*g}function P(e,g,n,k){var y=F,p=e[g],a=e[g+1];e=e[g+2];var c,H,b,M,f,A;g=Math.abs(e);c=p*p+a*a;H=Math.sqrt(c);b=c+e*e;M=Math.sqrt(b);p=Math.atan2(a,p);f=e*e/b;b=c/b;
a=y.a2/M;c=y.a3-y.a4/M;.3<b?(f=g/M*(1+b*(y.a1+a+f*c)/M),M=Math.asin(f),a=f*f,b=Math.sqrt(1-a)):(b=H/M*(1-f*(y.a5-a-b*c)/M),M=Math.acos(b),a=1-b*b,f=Math.sqrt(a));A=1-y.e2*a;a=y.a/Math.sqrt(A);y=y.a6*a;a=H-a*b;c=g-y*f;g=b*a+f*c;H=b*c-f*a;y=H/(y/A+g);M+=y;0>e&&(M=-M);n[k++]=B*p;n[k++]=B*M;n[k]=g+H*y/2}function S(e,g,n){void 0===n&&(n=Q());return R(e,g,n).projector}function R(e,g,n){if(n.source.spatialReference===e&&n.dest.spatialReference===g)return n;var k=E(e,n.source),y=E(g,n.dest);0===k&&0===y?
e.equals(g)?n.projector=C:n.projector=null:n.projector=A[k][y];return n}function Q(){return{source:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},projector:C}}Object.defineProperty(d,"__esModule",{value:!0});var U,V,Y,T,aa,W,p,L;d.SphericalECEFSpatialReference=new c({wkt:'GEOCCS["Spherical geocentric",\n  DATUM["Not specified",\n    SPHEROID["Sphere",\' + earthUtils.earthRadius + \',0]],\n  PRIMEM["Greenwich",0.0,\n    AUTHORITY["EPSG","8901"]],\n  UNIT["m",1.0],\n  AXIS["Geocentric X",OTHER],\n  AXIS["Geocentric Y",EAST],\n  AXIS["Geocentric Z",NORTH]\n]'});
d.WGS84ECEFSpatialReference=new c({wkt:'GEOCCS["WGS 84",\n  DATUM["WGS_1984",\n    SPHEROID["WGS 84",6378137,298.257223563,\n      AUTHORITY["EPSG","7030"]],\n    AUTHORITY["EPSG","6326"]],\n  PRIMEM["Greenwich",0,\n    AUTHORITY["EPSG","8901"]],\n  UNIT["m",1.0,\n    AUTHORITY["EPSG","9001"]],\n  AXIS["Geocentric X",OTHER],\n  AXIS["Geocentric Y",OTHER],\n  AXIS["Geocentric Z",NORTH],\n  AUTHORITY["EPSG","4978"]\n]'});d.canProject=function(e,n){return!!S(e,n,g)};d.vectorToVector=w;d.pointToPoint=
function(e,g,n,k){void 0===n&&(n=g.spatialReference);void 0===k&&(k=0);H[0]=e.x;H[1]=e.y;var y=e.z;H[2]=void 0!==y?y:k;if(!v(H,e.spatialReference,0,H,n,0,1))return!1;g.x=H[0];g.y=H[1];g.spatialReference=n;void 0!==y?(g.z=H[2],g.hasZ=!0):(g.z=void 0,g.hasZ=!1);return!0};d.pointToVector=function(e,g,n,k){void 0===k&&(k=0);H[0]=e.x;H[1]=e.y;var y=e.z;H[2]=void 0!==y?y:k;return v(H,e.spatialReference,0,g,n,0,1)};d.vectorToPoint=function(e,g,n,k){n instanceof r?k=k||n.spatialReference:m.isPoint(n)?(n.hasZ=
!0,k=k||n.spatialReference):(k=n,n=new r({spatialReference:k}));return v(e,g,0,H,k,0,1)?(n.x=H[0],n.y=H[1],n.z=H[2],n.spatialReference=k,n):null};d.xyzToVector=function(e,g,n,k,y,p){H[0]=e;H[1]=g;H[2]=n;return v(H,k,0,y,p,0,1)};d.bufferToBuffer=v;d.localLinearScaleFactors=function(g,n,y,p){var B=E(n,k),a=E(p,e);if(B===a&&0!==B||n.equals(p))return y[0]=1,y[1]=1,y[2]=1,!0;if(1===B){n=f.vec3.length(g);g=n/Math.sqrt(g[0]*g[0]+g[1]*g[1]);n/=u.earthRadius;if(3===a)return y[0]=g*n,y[1]=g*n,y[2]=1,!0;if(2===
a||5===a)return a=180/(u.earthRadius*Math.PI),y[0]=a*g*n,y[1]=a*n,y[2]=1,!0}return!1};d.computeLinearTransformation=function(g,n,p,B){var a=E(g,k),F=E(B,e);if(a===F&&1!==F&&(0!==a||g.equals(B)))return b.mat4.identity(p),b.mat4.translate(p,p,n),!0;if(1===F){g=A[a][6];F=A[6][F];if(l.isNone(g)||l.isNone(F))return!1;g(n,0,M,0);F(M,0,X,0);g=y*M[0];F=y*M[1];n=Math.sin(g);g=Math.cos(g);B=Math.sin(F);F=Math.cos(F);p[0]=-n;p[4]=-B*g;p[8]=F*g;p[12]=X[0];p[1]=g;p[5]=-B*n;p[9]=F*n;p[13]=X[1];p[2]=0;p[6]=F;p[10]=
B;p[14]=X[2];p[3]=0;p[7]=0;p[11]=0;p[15]=1;return!0}if(3===F&&(2===a||1===a)){g=A[a][6];if(l.isNone(g))return!1;g(n,0,M,0);n=y*M[1];K(M,0,X,0);b.mat4.identity(p);b.mat4.translate(p,p,X);n=1/Math.cos(n);b.mat4.scale(p,p,[n,n,1]);return!0}return!1};d.transformDirection=function(e,g,n,k,y){f.vec3.copy(Z,e);f.vec3.add(ca,e,g);w(Z,n,Z,y);w(ca,n,ca,y);f.vec3.subtract(k,ca,Z);f.vec3.normalize(k,k)};d.mbsToMbs=function(e,g,k,p){g=R(g,p,n);if(g.projector===C)return k[0]=e[0],k[1]=e[1],k[2]=e[2],k[3]=e[3],
!0;if(l.isNone(g.projector))return!1;p=g.source;var B=g.dest;if(3===B.spatialReferenceId){g=A[p.spatialReferenceId][2];if(l.isNone(g))return!1;g(e,0,M,0);g=Math.abs(y*M[1])+Math.asin(e[3]/(u.earthRadius+e[2]));K(M,0,k,0);k[3]=g>.9999*Math.PI?Number.MAX_VALUE:1/Math.cos(g)*e[3];return!0}g.projector(e,0,k,0);k[3]=e[3]*p.metersPerUnit/B.metersPerUnit;return!0};d.extentToBoundingBox=function(e,g,n){if(null==e)return!1;var k;H[0]=null!=e.xmin?e.xmin:0;H[1]=null!=e.ymin?e.ymin:0;H[2]=null!=e.zmin?e.zmin:
0;k=v(H,e.spatialReference,0,g,n,0,1);H[0]=null!=e.xmax?e.xmax:0;H[1]=null!=e.ymax?e.ymax:0;H[2]=null!=e.zmax?e.zmax:0;k=k&&v(H,e.spatialReference,0,g,n,3,1);null==e.xmin&&(g[0]=-Infinity);null==e.ymin&&(g[1]=-Infinity);null==e.zmin&&(g[2]=-Infinity);null==e.xmax&&(g[3]=Infinity);null==e.ymax&&(g[4]=Infinity);null==e.zmax&&(g[5]=Infinity);return k};d.extentToBoundingRect=function(e,g,n){if(null==e)return!1;var k;H[0]=null!=e.xmin?e.xmin:0;H[1]=null!=e.ymin?e.ymin:0;H[2]=null!=e.zmin?e.zmin:0;k=v(H,
e.spatialReference,0,H,n,0,1);g[0]=H[0];g[1]=H[1];H[0]=null!=e.xmax?e.xmax:0;H[1]=null!=e.ymax?e.ymax:0;H[2]=null!=e.zmax?e.zmax:0;k=k&&v(H,e.spatialReference,0,H,n,0,1);g[2]=H[0];g[3]=H[1];null==e.xmin&&(g[0]=-Infinity);null==e.ymin&&(g[1]=-Infinity);null==e.xmax&&(g[2]=Infinity);null==e.ymax&&(g[3]=Infinity);return k};d.boundingRectToBoundingRect=function(e,g,n,k){if(null==e)return!1;if(g.equals(k))return a.set(n,e),!0;H[0]=e[0];H[1]=e[1];H[2]=0;if(!v(H,g,0,H,k,0,1))return!1;n[0]=H[0];n[1]=H[1];
H[0]=e[2];H[1]=e[3];H[2]=0;if(!v(H,g,0,H,k,0,1))return!1;n[2]=H[0];n[3]=H[1];return!0};(function(e){e.x2lon=function(e){return e/u.earthRadius};e.y2lat=function(e){return Math.PI/2-2*Math.atan(Math.exp(-1*e/u.earthRadius))};e.lon2x=function(e){return e*u.earthRadius};e.lat2y=function(e){e=Math.sin(e);return u.earthRadius/2*Math.log((1+e)/(1-e))}})(d.webMercator||(d.webMercator={}));d.canProjectToWGS84ComparableLonLat=function(e){e=E(e,k);return!!A[e][6]};d.vectorToWGS84ComparableLonLat=G;d.pointToWGS84ComparableLonLat=
I;d.pointToWGS84ComparableLonLatPoint=function(g,n){var k=E(n.spatialReference,e);return l.isNone(A[6][k])?!1:I(g,H)?(n.x=H[0],n.y=H[1],n.z=H[2],!0):!1};d.wgs84ComparableLonLatToECEF=function(e,g,n,k){void 0===k&&(k=0);k=u.earthRadius+k;var y=Math.cos(n);e[0]=Math.cos(g)*y*k;e[1]=Math.sin(g)*y*k;e[2]=Math.sin(n)*k};var A=(U={},U[2]=(V={},V[5]=null,V[6]=C,V[1]=x,V[0]=null,V[3]=K,V[2]=C,V[4]=O,V),U[5]=(Y={},Y[5]=C,Y[6]=C,Y[1]=x,Y[0]=null,Y[3]=null,Y[2]=null,Y[4]=O,Y),U[3]=(T={},T[5]=null,T[6]=J,T[1]=
function(e,g,n,k){J(e,g,n,k);x(n,k,n,k)},T[0]=null,T[3]=C,T[2]=J,T[4]=function(e,g,n,k){J(e,g,n,k);O(n,k,n,k)},T),U[4]=(aa={},aa[5]=P,aa[6]=P,aa[1]=function(e,g,n,k){P(e,g,n,k);x(n,k,n,k)},aa[0]=null,aa[3]=function(e,g,n,k){P(e,g,n,k);K(n,k,n,k)},aa[2]=P,aa[4]=C,aa),U[1]=(W={},W[5]=N,W[6]=N,W[1]=C,W[0]=null,W[3]=function(e,g,n,k){N(e,g,n,k);K(n,k,n,k)},W[2]=N,W[4]=function(e,g,n,k){N(e,g,n,k);O(n,k,n,k)},W),U[0]=(p={},p[5]=null,p[6]=null,p[1]=null,p[0]=C,p[3]=null,p[2]=null,p[4]=null,p),U[6]=(L={},
L[5]=null,L[6]=C,L[1]=x,L[0]=null,L[3]=null,L[2]=C,L[4]=O,L),U);d.getProjector=S;var k={spatialReference:null,spatialReferenceId:0},e={spatialReference:null,spatialReferenceId:0},g=Q(),n=Q(),y=t.deg2rad(1),B=t.rad2deg(1),F={a:6378137,e2:.006694379990137799,a1:42697.67270715754,a2:1.8230912546075456E9,a3:142.91722289812412,a4:4.557728136518864E9,a5:42840.589930055656,a6:.9933056200098622},H=h.vec3f64.create(),M=h.vec3f64.create(),X=h.vec3f64.create(),Z=h.vec3f64.create(),ca=h.vec3f64.create()})},"esri/views/3d/support/earthUtils":function(){define("require exports ../../../core/mathUtils ../../../core/wgs84Constants ../../../core/libs/gl-matrix-2/vec3 ../../../core/libs/gl-matrix-2/vec3f64 ../../../geometry/Point ./projectionUtils".split(" "),
function(z,d,t,l,q,b,f,h){function r(a,c,b,m){var h,r;a instanceof f&&c instanceof f&&(b=c.longitude,m=c.latitude,r=a.latitude,h=a.longitude);a=t.deg2rad(r);m=t.deg2rad(m);h=t.deg2rad(h);c=t.deg2rad(b);b=Math.sin((a-m)/2);h=Math.sin((h-c)/2);b=2*t.asinClamped(Math.sqrt(b*b+Math.cos(a)*Math.cos(m)*h*h))*d.earthRadius;return Math.round(1E4*b)/1E4}function c(a,c){a/=15;c||(a=Math.round(a));return a}Object.defineProperty(d,"__esModule",{value:!0});d.earthRadius=l.wgs84Radius;d.halfEarthRadius=d.earthRadius/
2;d.halfEarthCircumference=Math.PI*d.earthRadius;d.earthCircumference=2*d.halfEarthCircumference;d.metersPerDegree=d.halfEarthCircumference/180;d.getGreatCircleDistance=r;d.getGreatCircleSpanAt=function(a,c,b){var m=c.spatialReference,h=new f(c.x,a.y,m),d=new f(b.x,a.y,m);c=new f(a.x,c.y,m);a=new f(a.x,b.y,m);return{lon:r(h,d),lat:r(c,a)}};d.getLonDeltaForDistance=function(a,c){c/=d.earthRadius;a=t.deg2rad(a);c=Math.sin(c/2);a=Math.cos(a);a=2*t.asinClamped(Math.sqrt(c*c/(a*a)));return t.rad2deg(a)};
d.getLatDeltaForDistance=function(a){return t.rad2deg(a/d.earthRadius)};d.getMaxCameraAltitude=function(a){a=t.deg2rad(a/2);return(1-Math.sin(a))*d.earthRadius/Math.sin(a)};d.getViewExtentDistance=function(a,c){c=t.deg2rad(c/2);return 2*t.acosClamped((Math.pow(a+d.earthRadius,2)+Math.pow(d.earthRadius,2)-Math.pow((a+d.earthRadius)*Math.cos(c)-Math.sqrt(Math.pow(Math.cos(c)*(a+d.earthRadius),2)-a*a-2*a*d.earthRadius),2))/(2*(a+d.earthRadius)*d.earthRadius))*d.earthRadius};d.computeCartesianDistance=
function(c,b){c=h.wgs84ComparableLonLatToECEF(a,c.longitude,c.latitude,c.z||0);b=h.wgs84ComparableLonLatToECEF(m,b.longitude,b.latitude,b.z||0);b=[b[0]-c[0],b[1]-c[1],b[2]-c[2]];return Math.sqrt(b[0]*b[0]+b[1]*b[1]+b[2]*b[2])};d.longitudeToTimezone=c;d.positionToTimezone=function(a,b){b||(b={hours:0,minutes:0,seconds:0});b.hours=c(a[0],!0);a=b.hours%1;b.hours-=a;b.minutes=60*a;a=b.minutes%1;b.minutes-=a;b.seconds=Math.round(60*a);return b};d.distanceToIdealHorizon=function(a,c){c=c||d.earthRadius;
a=q.vec3.dot(a,a);return Math.sqrt(Math.abs(a-c*c))};var a=b.vec3f64.create(),m=b.vec3f64.create()})},"esri/views/3d/webgl-engine/lib/BufferVectorMath":function(){define(["require","exports"],function(z,d){Object.defineProperty(d,"__esModule",{value:!0});(function(d){d.length=function(d,q){var b=d[q],f=d[q+1];d=d[q+2];return Math.sqrt(b*b+f*f+d*d)};d.normalize=function(d,q){var b=d[q],f=d[q+1],h=d[q+2],b=1/Math.sqrt(b*b+f*f+h*h);d[q]*=b;d[q+1]*=b;d[q+2]*=b};d.scale=function(d,q,b){d[q]*=b;d[q+1]*=
b;d[q+2]*=b};d.add=function(d,q,b,f,h,r){void 0===r&&(r=q);h=h||d;h[r]=d[q]+b[f];h[r+1]=d[q+1]+b[f+1];h[r+2]=d[q+2]+b[f+2]};d.subtract=function(d,q,b,f,h,r){void 0===r&&(r=q);h=h||d;h[r]=d[q]-b[f];h[r+1]=d[q+1]-b[f+1];h[r+2]=d[q+2]-b[f+2]}})(d.Vec3Compact||(d.Vec3Compact={}))})},"esri/views/3d/support/ElevationProvider":function(){define(["require","exports"],function(z,d){Object.defineProperty(d,"__esModule",{value:!0});d.getElevationAtPoint=function(d,l,q){return d.getElevation(l.x,l.y,l.z||0,l.spatialReference,
q)}})},"esri/views/3d/support/debugFlags":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/Accessor ../../../core/accessorSupport/decorators".split(" "),function(z,d,t,l,q,b){return new (function(f){function h(){var b=null!==f&&f.apply(this,arguments)||this;b.SCENEVIEW_HITTEST_RETURN_INTERSECTOR=!1;b.SCENEVIEW_LOCKING_LOG=!1;b.HIGHLIGHTS_GRID_OPTIMIZATION_DISABLED=!1;b.HIGHLIGHTS_PROFILE_TO_CONSOLE=!1;b.DECONFLICTOR_SHOW_OUTLINES=
!1;b.DECONFLICTOR_SHOW_OUTLINES_INVISIBLE=!1;b.DECONFLICTOR_SHOW_GRID=!1;b.LABELS_SHOW_BORDER=!1;b.OVERLAY_DRAW_DEBUG_TEXTURE=!1;b.OVERLAY_SHOW_CENTER=!1;b.TERRAIN_DEBUG_POPUP=!1;b.TESTS_DISABLE_UPDATE_THRESHOLDS=!1;b.DISABLE_DECONFLICTOR_VISIBILITY_OFFSET=!1;b.DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES=!1;b.DRAW_MESH_GEOMETRY_NORMALS=!1;b.FEATURE_TILE_FETCH_SHOW_TILES=!1;b.FEATURE_TILE_TREE_SHOW_TILES=!1;b.I3S_TREE_SHOW_TILES=!1;b.ENABLE_PROFILE_DEPTH_RANGE=!1;b.DISABLE_FAST_UPDATES=!1;b.LOD_INSTANCE_RENDERER_DISABLE_UPDATES=
!1;b.LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL=!1;b.EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES=!1;return b}t(h,f);l([b.property()],h.prototype,"SCENEVIEW_HITTEST_RETURN_INTERSECTOR",void 0);l([b.property()],h.prototype,"SCENEVIEW_LOCKING_LOG",void 0);l([b.property()],h.prototype,"HIGHLIGHTS_GRID_OPTIMIZATION_DISABLED",void 0);l([b.property()],h.prototype,"HIGHLIGHTS_PROFILE_TO_CONSOLE",void 0);l([b.property()],h.prototype,"DECONFLICTOR_SHOW_OUTLINES",void 0);l([b.property()],h.prototype,"DECONFLICTOR_SHOW_OUTLINES_INVISIBLE",
void 0);l([b.property()],h.prototype,"DECONFLICTOR_SHOW_GRID",void 0);l([b.property()],h.prototype,"LABELS_SHOW_BORDER",void 0);l([b.property()],h.prototype,"OVERLAY_DRAW_DEBUG_TEXTURE",void 0);l([b.property()],h.prototype,"OVERLAY_SHOW_CENTER",void 0);l([b.property()],h.prototype,"TERRAIN_DEBUG_POPUP",void 0);l([b.property()],h.prototype,"TESTS_DISABLE_UPDATE_THRESHOLDS",void 0);l([b.property()],h.prototype,"DISABLE_DECONFLICTOR_VISIBILITY_OFFSET",void 0);l([b.property()],h.prototype,"DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES",
void 0);l([b.property()],h.prototype,"DRAW_MESH_GEOMETRY_NORMALS",void 0);l([b.property()],h.prototype,"FEATURE_TILE_FETCH_SHOW_TILES",void 0);l([b.property()],h.prototype,"FEATURE_TILE_TREE_SHOW_TILES",void 0);l([b.property()],h.prototype,"I3S_TREE_SHOW_TILES",void 0);l([b.property()],h.prototype,"ENABLE_PROFILE_DEPTH_RANGE",void 0);l([b.property()],h.prototype,"DISABLE_FAST_UPDATES",void 0);l([b.property()],h.prototype,"LOD_INSTANCE_RENDERER_DISABLE_UPDATES",void 0);l([b.property()],h.prototype,
"LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL",void 0);l([b.property()],h.prototype,"EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES",void 0);return h=l([b.subclass("esri.views.3d.support.DebugFlags")],h)}(b.declared(q)))})},"esri/views/3d/webgl-engine/lib/Util":function(){define("require exports ../../../../core/mathUtils ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f64 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../core/libs/gl-matrix-2/vec4 ../../../../core/libs/gl-matrix-2/vec4f64".split(" "),
function(z,d,t,l,q,b,f,h,r){function c(a,c){if(!a)throw c=c||"assert",a=Error(c),a.stack&&console.log(a.stack),new v(c);}function a(a){for(var c in a)return c}function m(a,c){a[12]=c[0];a[13]=c[1];a[14]=c[2]}function u(a,c){void 0===c&&(c=0);for(var b=0,f=0;4>f;f++)b+=a[c+f]*C[f];return b}function D(a){return a-Math.floor(a)}Object.defineProperty(d,"__esModule",{value:!0});var w=r.vec4f64.create(),v=function(){function a(a){this.message=a}a.prototype.toString=function(){return"AssertException: "+
this.message};return a}();d.AssertException=v;d.VertexAttrConstants={POSITION:"position",NORMAL:"normal",NORMALCOMPRESSED:"normalCompressed",UV0:"uv0",AUXPOS1:"auxpos1",AUXPOS2:"auxpos2",COLOR:"color",SYMBOLCOLOR:"symbolColor",SIZE:"size",REGION:"region",COMPONENTINDEX:"componentIndex",TANGENT:"tangent"};d.assert=c;d.verify=function(a,c){a||console.warn("Verify failed: "+(c||"")+"\n"+Error("verify").stack)};d.encodeInt16=function(a){return t.clamp(Math.round(32767*a),-32767,32767)};d.encodeNormal=
function(a,c){var b=Math.abs(a[0]),f=Math.abs(a[1]),m=1/(b+f+Math.abs(a[2])),h=Math.min(a[2]*m,0);c[0]=(0>a[0]?-1:1)*(b*m-h);c[1]=(0>a[1]?-1:1)*(f*m-h)};d.fallbackIfUndefined=function(a,c){return void 0===a?c:a};d.hex2rgb=function(a){a=Math.floor(a);return[(a>>16&255)/255,(a>>8&255)/255,(a&255)/255]};d.rgb2hex=function(a){var c=t.clamp(Math.round(255*a[0]),0,255),b=t.clamp(Math.round(255*a[1]),0,255);a=t.clamp(Math.round(255*a[2]),0,255);return"0x"+((c<<16)+(b<<8)+a).toString(16)};d.dec2hex=function(a){a=
a.toString(16);return"00000000".substr(0,8-a.length)+a};d.rayTriangle3D=function(a,c,b,m,h,d,r,l,u){void 0===u&&(u=f.vec3f64.create());var v=m[r]-b[d],q=m[r+1]-b[d+1],w=m[r+2]-b[d+2];m=h[l]-b[d];r=h[l+1]-b[d+1];h=h[l+2]-b[d+2];var x=c[1]*h-r*c[2],t=c[2]*m-h*c[0],C=c[0]*r-m*c[1];l=v*x+q*t+w*C;if(-1E-5<l&&1E-5>l)return!1;l=1/l;var D=a[0]-b[d],p=a[1]-b[d+1];a=a[2]-b[d+2];u[1]=l*(D*x+p*t+a*C);if(0>u[1]||1<u[1])return!1;b=p*w-q*a;a=a*v-w*D;v=D*q-v*p;u[2]=l*(c[0]*b+c[1]*a+c[2]*v);if(0>u[2]||1<u[1]+u[2])return!1;
u[0]=l*(m*b+r*a+h*v);return!0};d.rayBoxTest=function(a,c,b,f){var m,h=(b[0]-a[0])/c[0],d=(f[0]-a[0])/c[0];h>d&&(m=h,h=d,d=m);var r=(b[1]-a[1])/c[1],l=(f[1]-a[1])/c[1];r>l&&(m=r,r=l,l=m);if(h>l||r>d)return!1;r>h&&(h=r);l<d&&(d=l);b=(b[2]-a[2])/c[2];a=(f[2]-a[2])/c[2];b>a&&(m=b,b=a,a=m);if(h>a||b>d)return!1;a<d&&(d=a);return 0>d?!1:!0};d.rayRay2D=function(a,c,f,m,h,d){void 0===d&&(d=b.vec2f64.create());var r=(m[h]-f[h])*(c[0]-a[0])-(m[0]-f[0])*(c[h]-a[h]);if(0===r)return!1;f=((m[0]-f[0])*(a[h]-f[h])-
(m[h]-f[h])*(a[0]-f[0]))/r;d[0]=a[0]+f*(c[0]-a[0]);d[1]=a[h]+f*(c[h]-a[h]);return!0};d.project=function(a,b,f,m,d){d||(d=a);w[0]=a[0];w[1]=a[1];w[2]=a[2];w[3]=1;h.vec4.transformMat4(w,w,b);2<d.length&&(d[2]=-w[2]);h.vec4.transformMat4(w,w,f);c(0!==w[3]);d[0]=w[0]/w[3];d[1]=w[1]/w[3];d[2]=w[2]/w[3];d[0]=(.5*d[0]+.5)*m[2]+m[0];d[1]=(.5*d[1]+.5)*m[3]+m[1]};d.getFirstObjectKey=a;d.getFirstObjectValue=function(c){return c[a(c)]};d.objectEmpty=function(a){for(var c in a)return!1;return!0};d.logWithBase=
function(a,c){return Math.log(a)/Math.log(c)};d.setMatrixTranslation=m;d.setMatrixTranslation3=function(a,c,b,f){a[12]=c;a[13]=b;a[14]=f};d.getMatrixTranslation=function(a,c){void 0===c&&(c=f.vec3f64.create());c[0]=a[12];c[1]=a[13];c[2]=a[14];return c};d.createTranslationMatrix=function(a,c){a=l.mat4.identity(a);m(a,c);return a};d.isTranslationMatrix=function(a){return 1===a[0]&&0===a[1]&&0===a[2]&&0===a[3]&&0===a[4]&&1===a[5]&&0===a[6]&&0===a[7]&&0===a[8]&&0===a[9]&&1===a[10]&&0===a[11]&&1===a[15]};
d.fovx2fovy=function(a,c,b){return 2*Math.atan(b*Math.tan(.5*a)/c)};d.fovy2fovx=function(a,c,b){return 2*Math.atan(c*Math.tan(.5*a)/b)};d.fovx2fovd=function(a,c,b){return 2*Math.atan(Math.sqrt(c*c+b*b)*Math.tan(.5*a)/c)};d.fovy2fovd=function(a,c,b){return 2*Math.atan(Math.sqrt(c*c+b*b)*Math.tan(.5*a)/b)};d.fovd2fovx=function(a,c,b){return 2*Math.atan(c*Math.tan(.5*a)/Math.sqrt(c*c+b*b))};d.fovd2fovy=function(a,c,b){return 2*Math.atan(b*Math.tan(.5*a)/Math.sqrt(c*c+b*b))};d.packFloatRGBA=function(a,
c,b){void 0===b&&(b=0);a=t.clamp(a,0,J);for(var f=0;4>f;f++)c[b+f]=Math.floor(256*D(a*E[f]))};d.unpackFloatRGBA=u;var E=[1,256,65536,16777216],C=[1/256,1/65536,1/16777216,1/4294967296],J=u(new Uint8ClampedArray([255,255,255,255]));d.inverseProjectionInfo=function(a,c,b,f,m){0===a[11]?(f[0]=2/(c*a[0]),f[1]=2/(b*a[5]),f[2]=(1+a[12])/a[0],f[3]=(1+a[13])/a[5],q.vec2.set(m,0,1)):(f[0]=-2/(c*a[0]),f[1]=-2/(b*a[5]),f[2]=(1-a[8])/a[0],f[3]=(1-a[9])/a[5],q.vec2.set(m,1,0))}})},"esri/core/libs/gl-matrix-2/vec2":function(){define(["require",
"exports","./math/vec2"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});d.vec2=t})},"esri/core/libs/gl-matrix-2/math/vec2":function(){define(["require","exports","./common"],function(z,d,t){function l(a,c,b){a[0]=c[0]-b[0];a[1]=c[1]-b[1];return a}function q(a,c,b){a[0]=c[0]*b[0];a[1]=c[1]*b[1];return a}function b(a,c,b){a[0]=c[0]/b[0];a[1]=c[1]/b[1];return a}function f(a,c){var b=c[0]-a[0];a=c[1]-a[1];return Math.sqrt(b*b+a*a)}function h(a,c){var b=c[0]-a[0];a=c[1]-a[1];return b*
b+a*a}function r(a){var c=a[0];a=a[1];return Math.sqrt(c*c+a*a)}function c(a){var c=a[0];a=a[1];return c*c+a*a}Object.defineProperty(d,"__esModule",{value:!0});d.copy=function(a,c){a[0]=c[0];a[1]=c[1];return a};d.set=function(a,c,b){a[0]=c;a[1]=b;return a};d.add=function(a,c,b){a[0]=c[0]+b[0];a[1]=c[1]+b[1];return a};d.subtract=l;d.multiply=q;d.divide=b;d.ceil=function(a,c){a[0]=Math.ceil(c[0]);a[1]=Math.ceil(c[1]);return a};d.floor=function(a,c){a[0]=Math.floor(c[0]);a[1]=Math.floor(c[1]);return a};
d.min=function(a,c,b){a[0]=Math.min(c[0],b[0]);a[1]=Math.min(c[1],b[1]);return a};d.max=function(a,c,b){a[0]=Math.max(c[0],b[0]);a[1]=Math.max(c[1],b[1]);return a};d.round=function(a,c){a[0]=Math.round(c[0]);a[1]=Math.round(c[1]);return a};d.scale=function(a,c,b){a[0]=c[0]*b;a[1]=c[1]*b;return a};d.scaleAndAdd=function(a,c,b,f){a[0]=c[0]+b[0]*f;a[1]=c[1]+b[1]*f;return a};d.distance=f;d.squaredDistance=h;d.length=r;d.squaredLength=c;d.negate=function(a,c){a[0]=-c[0];a[1]=-c[1];return a};d.inverse=
function(a,c){a[0]=1/c[0];a[1]=1/c[1];return a};d.normalize=function(a,c){var b=c[0],f=c[1],b=b*b+f*f;0<b&&(b=1/Math.sqrt(b),a[0]=c[0]*b,a[1]=c[1]*b);return a};d.dot=function(a,c){return a[0]*c[0]+a[1]*c[1]};d.cross=function(a,c,b){c=c[0]*b[1]-c[1]*b[0];a[0]=a[1]=0;a[2]=c;return a};d.lerp=function(a,c,b,f){var h=c[0];c=c[1];a[0]=h+f*(b[0]-h);a[1]=c+f*(b[1]-c);return a};d.random=function(a,c){c=c||1;var b=2*t.RANDOM()*Math.PI;a[0]=Math.cos(b)*c;a[1]=Math.sin(b)*c;return a};d.transformMat2=function(a,
c,b){var f=c[0];c=c[1];a[0]=b[0]*f+b[2]*c;a[1]=b[1]*f+b[3]*c;return a};d.transformMat2d=function(a,c,b){var f=c[0];c=c[1];a[0]=b[0]*f+b[2]*c+b[4];a[1]=b[1]*f+b[3]*c+b[5];return a};d.transformMat3=function(a,c,b){var f=c[0];c=c[1];a[0]=b[0]*f+b[3]*c+b[6];a[1]=b[1]*f+b[4]*c+b[7];return a};d.transformMat4=function(a,c,b){var f=c[0];c=c[1];a[0]=b[0]*f+b[4]*c+b[12];a[1]=b[1]*f+b[5]*c+b[13];return a};d.rotate=function(a,c,b,f){var h=c[0]-b[0];c=c[1]-b[1];var m=Math.sin(f);f=Math.cos(f);a[0]=h*f-c*m+b[0];
a[1]=h*m+c*f+b[1];return a};d.angle=function(a,c){var b=a[0];a=a[1];var f=c[0];c=c[1];var h=b*b+a*a;0<h&&(h=1/Math.sqrt(h));var m=f*f+c*c;0<m&&(m=1/Math.sqrt(m));b=(b*f+a*c)*h*m;return 1<b?0:-1>b?Math.PI:Math.acos(b)};d.str=function(a){return"vec2("+a[0]+", "+a[1]+")"};d.exactEquals=function(a,c){return a[0]===c[0]&&a[1]===c[1]};d.equals=function(a,c){var b=a[0];a=a[1];var f=c[0];c=c[1];return Math.abs(b-f)<=t.EPSILON*Math.max(1,Math.abs(b),Math.abs(f))&&Math.abs(a-c)<=t.EPSILON*Math.max(1,Math.abs(a),
Math.abs(c))};d.len=r;d.sub=l;d.mul=q;d.div=b;d.dist=f;d.sqrDist=h;d.sqrLen=c})},"esri/views/3d/layers/graphics/Graphics3DDrapedGraphicLayer":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../geometry/support/aaBoundingBox ../../../../geometry/support/aaBoundingRect ./graphicUtils ../../webgl-engine/lib/ComponentUtils".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a){z=function(){function d(a,c,b){this.graphics3DSymbolLayer=a;this.renderGeometries=c;this.boundingBox=b;this.type="draped";this.stage=null;this._addedToStage=this._visible=!1;this._layerView=null;this.isElevationSource=!1}d.prototype.initialize=function(a,c,b){this.stage=a;this._layerView=b;this._overlayRenderer=this._layerView.view.basemapTerrain.overlayManager.renderer};d.prototype.setVisibility=function(c){if(null!=this.stage){if(this._visible!==c){if((this._visible=
c)&&!this._addedToStage)return this._addedToStage=!0,this._overlayRenderer.addGeometries(this.renderGeometries,this._layerView,0),!0;if(!c&&!this._addedToStage)return!1;for(var b=0,f=this.renderGeometries;b<f.length;b++){var h=f[b],m=h.instanceParameters.componentVisibilities,m=c?a.unhideAllComponents(m):a.hideAllComponents(m);h.instanceParameters.componentVisibilities=m}this._overlayRenderer.updateGeometries(this.renderGeometries,this._layerView,1);return!0}return!1}};d.prototype.destroy=function(){this.stage&&
this._addedToStage&&this._overlayRenderer.removeGeometries(this.renderGeometries,this._layerView,1);this._visible=this._addedToStage=!1;this.stage=null};d.prototype.getBSRadius=function(){return this.renderGeometries.reduce(function(a,c){return Math.max(a,c.bsRadius)},0)};d.prototype.getCenterObjectSpace=function(a){void 0===a&&(a=f.vec3f64.create());return b.vec3.set(a,0,0,0)};d.prototype.getBoundingBoxObjectSpace=function(a){void 0===a&&(a=h.create());return h.empty(a)};d.prototype.addObjectState=
function(a,c){var b=this;0===a&&(this.renderGeometries.forEach(function(a){var f=a.addHighlight();c.addRenderGeometry(a,f,b)}),this._addedToStage&&this._overlayRenderer.updateHighlights(this.renderGeometries,this._layerView))};d.prototype.removeObjectState=function(a){this.renderGeometries.forEach(function(c){a.removeRenderGeometry(c)})};d.prototype.removeRenderGeometryObjectState=function(a,c){a.removeHighlight(c);this._addedToStage&&this._overlayRenderer.updateHighlights(this.renderGeometries,this._layerView)};
d.prototype.computeAttachmentOrigin=function(a){for(var c=0,b=this.renderGeometries;c<b.length;c++)b[c].computeAttachmentOrigin(D)&&(a.draped.origin[0]+=D[0],a.draped.origin[1]+=D[1],a.draped.num++)};d.prototype.getProjectedBoundingBox=function(a,b,f,d,r){return q(this,void 0,void 0,function(){var u,v,q,w;return l(this,function(l){switch(l.label){case 0:h.empty(r);for(u=0;u<this.renderGeometries.length;u++)v=this.renderGeometries[u],this._getRenderGeometryProjectedBoundingRect(v,a,m,f),h.expand(r,
m);if(!b)return[3,5];h.center(r,D);q=void 0;w=c.demResolutionForBoundingBox(r,b);l.label=1;case 1:return l.trys.push([1,3,,4]),[4,b.service.queryElevation(D[0],D[1],d,w)];case 2:return q=l.sent(),[3,4];case 3:return l.sent(),q=null,[3,4];case 4:null!=q&&(r[2]=Math.min(r[2],q),r[5]=Math.max(r[5],q)),l.label=5;case 5:return[2,r]}})})};d.prototype._getRenderGeometryProjectedBoundingRect=function(a,c,b,f){if(this.boundingBox)h.set(u,this.boundingBox);else{var m=a.center;a=a.bsRadius;u[0]=m[0]-a;u[1]=
m[1]-a;u[2]=m[2]-a;u[3]=m[0]+a;u[4]=m[1]+a;u[5]=m[2]+a}c(u,0,2);this.calculateRelativeScreenBounds&&f.push({location:h.center(u),screenSpaceBoundingRect:this.calculateRelativeScreenBounds()});return h.toRect(u,b)};return d}();var m=r.create(),u=h.create(),D=f.vec3f64.create();return z})},"esri/views/3d/webgl-engine/lib/ComponentUtils":function(){define(["require","exports","../../../../core/arrayUtils","../../../../core/maybe"],function(z,d,t,l){function q(a,b,f,h){if(f>=b)return a;null==a&&(a=c());
var m=a.data,d=8*m.BYTES_PER_ELEMENT,r=f/d|0,l=f-d*r,u=m;h=h===a.isVisibleBit;f<u.length*d||!h||(f=Math.max(r+1,Math.ceil(1.5*u.length)),f=Math.min(f,((b-1)/d|0)+1),m=new Uint32Array(f),m.set(u));r<m.length&&(m[r]=m[r]&~(1<<l)|(h?1:0)<<l);a.data=m;return a}function b(a,c){if(null==a)return!0;var b=a.isVisibleBit,f=a.data,h=8*f.BYTES_PER_ELEMENT;return c<f.length*h?D(b,f,c,h):!a.isVisibleBit}function f(a){return l.isSome(a.component)?a.component:-1}function h(a,c,f,h){b(c,h)&&r(a,f[h],f[h+1]-1)}function r(a,
c,b){var f=0<a.length?a[a.length-1]:null;(f?f[1]:-1)>=c||a.push([c,b])}function c(a){void 0===a&&(a=!0);return{isVisibleBit:!a,data:new Uint32Array(0)}}function a(a,c){return!m(a,c,!1)}function m(a,c,b){a=a||v;var f=a.data;a=b===a.isVisibleBit;b=w(c);if(0===f.length||0===b)return!a;var h=8*f.BYTES_PER_ELEMENT;if(f.length*h<b&&!a)return!0;var m=E[h];c=E[0];for(var d=0;d<f.length-1;d++)if(!a&&f[d]!==m||a&&f[d]!==c)return!0;m=f.length-1;b=E[(b-1)%h+1];return!a&&(f[m]&b)!==b||a&&(f[m]&b)!==c}function u(a){return 0<
a.length}function D(a,c,b,f){var h=b/f|0;return 0!==(c[h]&1<<b-h*f)===a}function w(a){return Math.max(0,a.length-1)}Object.defineProperty(d,"__esModule",{value:!0});d.updateVisibility=function(a,c,b,f){return q(a,w(c),b,f)};d.updateVisibilityWithCount=q;d.getVisibility=b;d.hideAllComponents=function(a){if(null==a)return c(!1);a.isVisibleBit=!0;for(var b=0;b<a.data.length;b++)a.data[b]=0;return a};d.unhideAllComponents=function(a){if(null==a)return null;a.isVisibleBit=!1;for(var c=0;c<a.data.length;c++)a.data[c]=
0;return a};d.generateVisibleIndexRanges=function(a,c){var b;if(a)if(u(c))if(0===a.data.length)b=[],c=[[c[0],c[c.length-1]-1]],b=a.isVisibleBit?b:c;else{b=[];for(var f=a.isVisibleBit,h=a.data,m=8*h.BYTES_PER_ELEMENT,d=h.length*m,r=w(c),l=!1,v=0;v<d&&v<r;v++){var q=D(f,h,v,m);if(q!==l){var t=c[v];q?b.push([t,0]):(l=b[b.length-1],l[1]=t-1);l=q}}a=!a.isVisibleBit;r>d&&a&&!l?b.push([c[d],c[r]-1]):l&&(l=b[b.length-1],l[1]=c[a?r:Math.min(r,d)]-1)}else b=[],b=a.isVisibleBit?b:null;else b=null;return b};
d.addOccludee=function(a,c){a=a||[];a.push({id:c});return a};d.removeOccludee=function(a,c){if(!a)return a;a=a.filter(function(a){return a.id!==c});return 0===a.length?null:a};d.addHighlight=function(a,c,b){a=a||[];c={component:c,id:b};a.push(c);b=f(c);for(var h=a.length-1;0<h&&b<f(a[h-1]);)c=[a[h],a[h-1]],a[h-1]=c[0],a[h]=c[1],--h;return a};d.removeHighlight=function(a,c){if(!a)return a;a=a.filter(function(a){return a.id!==c});return 0===a.length?null:a};d.generateHighlightedIndexRanges=function(c,
b,f){if(!b)return null;if(!u(f))return c&&c.isVisibleBit?null:b.map(function(a){return null});for(var m=f[0],d=f[f.length-1]-1,v=[],q=a(c,f),t=0;t<b.length;++t){var D=b[t].component;if(l.isSome(D))h(v,c,f,D);else if(q)r(v,m,d);else for(D=0;D<w(f);++D)h(v,c,f,D)}return 0<v.length?v:null};d.hasHighlights=function(c,b,f){if(!b)return!1;if(!u(f))return c&&c.isVisibleBit?!1:0<b.length;c=a(c,f);for(var h=0;h<b.length;h++)if(l.isSome(b[h].component)||c||0<w(f))return!0;return!1};d.defaultVisibilities=c;
d.isAllVisible=a;d.isAllHidden=function(a,c){return!m(a,c,!0)};var v=c();d.createOffsets=function(a){return a instanceof Uint32Array?a:new Uint32Array(a)};d.hasComponents=u;var E=[];for(z=0;65>z;z++)E.push(Math.pow(2,z)-1);d.componentCount=w;d.componentFind=function(a,c){a=t.binaryIndexOf(a,c,!0);return 0<=a?a:null}})},"esri/views/3d/layers/graphics/Graphics3DObject3DGraphicLayer":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/maybe ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../geometry/support/aaBoundingBox ./featureExpressionInfoUtils ./Graphics3DGraphicElevationContext ./graphicUtils".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m){function u(a){return a.isVisible?a.getParameters().transparent?1:2:0}z=function(){function d(c,b,f,h,m,r,l,u,v){this.uniqueGeometries=f;this.uniqueMaterials=h;this.uniqueTextures=m;this.elevationAligner=r;this._edgeState=u;this.type="object3d";this.stage=this.stageLayer=null;this._addedToStage=this._visible=!1;this.alignedSampledElevation=0;this.needsElevationUpdates=!1;this.graphics3DSymbolLayer=c;this.stageObject=b;this.elevationAligner=r;this.elevationContext=
new a(l);this.visibilityMode=null!=v?v:d.VisibilityModes.HIDE_FACERANGE}Object.defineProperty(d.prototype,"isElevationSource",{get:function(){return!(!this.stageObject.metadata||!this.stageObject.metadata.isElevationSource)},enumerable:!0,configurable:!0});d.prototype.initialize=function(a,c){this.stageLayer=c;this.stage=a;if(this.uniqueMaterials)for(c=0;c<this.uniqueMaterials.length;c++)a.add(3,this.uniqueMaterials[c]);if(this.uniqueGeometries)for(c=0;c<this.uniqueGeometries.length;c++)a.add(2,this.uniqueGeometries[c]);
if(this.uniqueTextures)for(c=0;c<this.uniqueTextures.length;c++)a.add(4,this.uniqueTextures[c]);a.add(1,this.stageObject)};d.prototype.layerOpacityChanged=function(a,c){if(!b.isNone(this._edgeState)){for(var f=u(this._edgeState.baseMaterial),h=!1,m=0,d=this._edgeState.edgeMaterials;m<d.length;m++){var r=d[m];r.objectTransparency!==f&&(r.objectTransparency=f,h=!0)}h&&this.resetEdgeObject(c);this.stage.renderView.ensureEdgeView().updateAllComponentOpacities(this.stageObject,[a])}};d.prototype.slicePlaneEnabledChanged=
function(a,c){b.isNone(this._edgeState)||(this.stage.renderView.ensureEdgeView().updateAllComponentMaterials(this.stageObject,this._edgeState.edgeMaterials,{slicePlaneEnabled:a},!c),this._edgeState.slicePlaneEnabled=a)};d.prototype.setVisibility=function(a){if(null!=this.stage){if(this._visible===a)return!1;(this._visible=a)?this._addedToStage?this.stageObject.unhide():(this.stageLayer.addObject(this.stageObject),this._addedToStage=!0):this.visibilityMode===d.VisibilityModes.HIDE_FACERANGE?this.stageObject.hide():
(this.stageLayer.removeObject(this.stageObject),this._addedToStage=!1);if(b.isSome(this._edgeState)){var c=this.stage.renderView.ensureEdgeView();c.hasObject(this.stageObject)?c.updateObjectVisibility(this.stageObject,a):a&&this.addOrUpdateEdgeObject(c,!1)}return!0}};Object.defineProperty(d.prototype,"visible",{get:function(){return this._visible},enumerable:!0,configurable:!0});d.prototype.destroy=function(){var a=this.stage;if(this.stageLayer){if(this.uniqueMaterials)for(var c=0;c<this.uniqueMaterials.length;c++)a.remove(3,
this.uniqueMaterials[c].id);if(this.uniqueGeometries)for(c=0;c<this.uniqueGeometries.length;c++)a.remove(2,this.uniqueGeometries[c].id);if(this.uniqueTextures)for(c=0;c<this.uniqueTextures.length;c++)a.remove(4,this.uniqueTextures[c].id)}a.remove(1,this.stageObject.id);this._addedToStage&&(this.stageLayer.removeObject(this.stageObject),this._addedToStage=!1);a=this.stage.renderView.ensureEdgeView();a.hasObject(this.stageObject)&&a.removeObject(this.stageObject);this.stageObject.dispose();this._visible=
!1;this.stage=this.stageLayer=null};d.prototype.alignWithElevation=function(a,f,h,m){null!=this.elevationAligner&&(b.isSome(h)&&c.setContextFeature(this.elevationContext.featureExpressionInfoContext,h),a=this.elevationAligner(this,this.elevationContext,a,f),null!=a&&(this.alignedSampledElevation=a),this.resetEdgeObject(m))};d.prototype.getBSRadius=function(){return this.stageObject.getBSRadius()};d.prototype.getCenterObjectSpace=function(a){void 0===a&&(a=h.vec3f64.create());return f.vec3.copy(a,
this.stageObject.getCenter(!0))};d.prototype.getBoundingBoxObjectSpace=function(a){void 0===a&&(a=r.create());var c=this.stageObject;a||(a=r.create());r.setMin(a,c.getBBMin(!0));r.setMax(a,c.getBBMax(!0));return a};d.prototype.computeAttachmentOrigin=function(a){for(var c=0,b=this.stageObject.geometryRecords;c<b.length;c++)b[c].computeAttachmentOrigin(v)&&(f.vec3.transformMat4(v,v,this.stageObject.objectTransformation),f.vec3.add(a.render.origin,a.render.origin,v),a.render.num++)};d.prototype.getProjectedBoundingBox=
function(a,c,b,h,d){return q(this,void 0,void 0,function(){var u,q,x,t,C,G,I,J,K,T;return l(this,function(l){switch(l.label){case 0:u=this.getBoundingBoxObjectSpace(d);q=E;x=r.isPoint(u)?1:q.length;for(t=0;t<x;t++)C=q[t],w[0]=u[C[0]],w[1]=u[C[1]],w[2]=u[C[2]],f.vec3.transformMat4(w,w,this.stageObject.objectTransformation),D[3*t+0]=w[0],D[3*t+1]=w[1],D[3*t+2]=w[2];if(!a(D,0,x))return[2,null];r.empty(u);G=null;this.calculateRelativeScreenBounds&&(G=this.calculateRelativeScreenBounds());for(t=0;t<3*
x;t+=3){for(I=0;3>I;I++)u[I]=Math.min(u[I],D[t+I]),u[I+3]=Math.max(u[I+3],D[t+I]);G&&b.push({location:D.slice(t,t+3),screenSpaceBoundingRect:G})}if(!c||!c.service||"absolute-height"===this.elevationContext.mode)return[3,5];r.center(u,v);J="relative-to-scene"===this.elevationContext.mode?"scene":"ground";K=void 0;if(!c.useViewElevation)return[3,1];K=c.service.getElevation(v[0],v[1],J);return[3,4];case 1:return l.trys.push([1,3,,4]),T=m.demResolutionForBoundingBox(u,c),[4,c.service.queryElevation(v[0],
v[1],h,T,J)];case 2:return K=l.sent(),[3,4];case 3:return l.sent(),K=null,[3,4];case 4:r.offset(u,0,0,-this.alignedSampledElevation+K),l.label=5;case 5:return[2,u]}})})};d.prototype.addObjectState=function(a,c){0===a&&c.addObject(this.stageObject,this.stageObject.highlight());1===a&&c.addObject(this.stageObject,this.stageObject.occlude())};d.prototype.removeObjectState=function(a){a.removeObject(this.stageObject)};d.prototype.resetEdgeObject=function(a){if(!b.isNone(this._edgeState)){var c=this.stage.renderView.ensureEdgeView();
this._visible?this.addOrUpdateEdgeObject(c,a):c.removeObject(this.stageObject)}};d.prototype.addOrUpdateEdgeObject=function(a,c){var f=this._edgeState;if(!b.isNone(f)){for(var h=u(f.baseMaterial),m=0,d=f.edgeMaterials;m<d.length;m++)d[m].objectTransparency=h;a.addOrUpdateObject(this.stageObject,f.edgeMaterials,{slicePlaneEnabled:f.slicePlaneEnabled},!c,f.addObjectSettings)}};return d}();(function(a){a=a.VisibilityModes||(a.VisibilityModes={});a[a.REMOVE_OBJECT=0]="REMOVE_OBJECT";a[a.HIDE_FACERANGE=
1]="HIDE_FACERANGE"})(z||(z={}));var D=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],w=h.vec3f64.create(),v=h.vec3f64.create(),E=[[0,1,2],[3,1,2],[0,4,2],[3,4,2],[0,1,5],[3,1,5],[0,4,5],[3,4,5]];return z})},"esri/views/3d/layers/graphics/featureExpressionInfoUtils":function(){define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/Logger ../../../../layers/graphics/dehydratedFeatures ../../../../support/arcadeOnDemand".split(" "),
function(z,d,t,l,q,b,f){Object.defineProperty(d,"__esModule",{value:!0});var h=q.getLogger("esri.views.3d.layers.graphics.featureExpressionInfoUtils");d.createContextWithoutExpressionSupport=function(b){b=b&&b.expression;return"string"===typeof b&&(b="0"===b?0:null,null!=b)?{cachedResult:b}:null};d.createContext=function(b,c,a){return l(this,void 0,void 0,function(){var h,d,r,l,v;return t(this,function(m){switch(m.label){case 0:h=b&&b.expression;if("string"!==typeof h)return[2,null];d="0"===h?0:null;
return null!=d?[2,{cachedResult:d}]:[4,f.loadArcade()];case 1:return r=m.sent(),l=r.arcadeUtils,v=l.createSyntaxTree(h),l.dependsOnView(v)?(null!=a&&a.error("Expressions containing '$view' are not supported on ElevationInfo"),[2,{cachedResult:0}]):[2,{arcade:{func:l.createFunction(v),context:l.createExecContext(null,{sr:c}),modules:r}}]}})})};d.createFeature=function(b,c,a){return b.arcadeUtils.createFeature(c.attributes,c.geometry,a)};d.setContextFeature=function(f,c){null!=f&&null==f.cachedResult&&
(c&&f.arcade?(c._geometry&&(c._geometry=b.hydrateGeometry(c._geometry)),f.arcade.modules.arcadeUtils.updateExecContext(f.arcade.context,c)):h.errorOncePerTick("Arcade support required but not provided"))};d.execute=function(b){if(null!=b){if(null!=b.cachedResult)return b.cachedResult;var c=b.arcade,c=b.arcade.modules.arcadeUtils.executeFunction(c.func,c.context);"number"!==typeof c&&(c=b.cachedResult=0);return c}return 0};d.extractExpressionInfo=function(b,c){void 0===c&&(c=!1);var a=(b=b&&b.featureExpressionInfo)&&
b.expression;c||"0"===a||(b=null);return b};d.zeroContext={cachedResult:0}})},"esri/views/3d/layers/graphics/Graphics3DGraphicElevationContext":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","./ElevationContext"],function(z,d,t,l){return function(d){function b(b){b=d.call(this,b)||this;b.centerPointInElevationSR=null;return b}t(b,d);b.fromElevationInfo=function(f){var h=new b;h.setFromElevationInfo(f);return h};return b}(l)})},"esri/views/3d/layers/graphics/ElevationContext":function(){define(["require",
"exports","../../../../core/maybe","../../../../symbols/support/unitConversionUtils","./featureExpressionInfoUtils"],function(z,d,t,l,q){return function(){function b(b){this._renderUnitOffset=this._meterUnitOffset=0;this.featureExpressionInfoContext=null;b?this.set(b):this.setDefaults()}Object.defineProperty(b.prototype,"meterUnitOffset",{get:function(){return this._meterUnitOffset},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"unit",{get:function(){return this._unit},enumerable:!0,
configurable:!0});b.prototype.setUnit=function(b){this._unit=b;this._metersPerElevationInfoUnit=l.getMetersPerUnit(b)};b.prototype.setDefaults=function(){this.mode=null;this._renderUnitOffset=this._meterUnitOffset=0;this.featureExpressionInfoContext=null;this.setUnit("meters")};b.prototype.set=function(b){this.mode=b.mode;this._meterUnitOffset=b._meterUnitOffset;this._renderUnitOffset=b._renderUnitOffset;this.featureExpressionInfoContext=b.featureExpressionInfoContext;this.setUnit(b.unit)};b.prototype.setOffsetMeters=
function(b){this._meterUnitOffset=b;this._renderUnitOffset=0};b.prototype.setOffsetElevationInfoUnits=function(b){this._meterUnitOffset=b*this._metersPerElevationInfoUnit;this._renderUnitOffset=0};b.prototype.addOffsetRenderUnits=function(b){this._renderUnitOffset+=b};b.prototype.calculateOffsetRenderUnits=function(b){var f=this._meterUnitOffset,d=this.featureExpressionInfoContext;null!=d&&(f+=q.execute(d)*this._metersPerElevationInfoUnit);return f/b.unitInMeters+this._renderUnitOffset};b.prototype.setFromElevationInfo=
function(b){this.mode=b.mode;this.setUnit(b.unit||"meters");this.setOffsetElevationInfoUnits(t.unwrapOr(b.offset,0))};b.fromElevationInfo=function(f){var h=new b;t.isSome(f)&&h.setFromElevationInfo(f);return h};return b}()})},"esri/views/3d/layers/graphics/Graphics3DSymbolLayer":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../Color ../../../../core/arrayUtils ../../../../core/compilerUtils ../../../../core/Logger ../../../../core/mathUtils ../../../../core/maybe ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../core/libs/gl-matrix-2/vec4f64 ./elevationAlignmentUtils ./ElevationContext ./featureExpressionInfoUtils ./graphicUtils ./Loadable ./symbolComplexity".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u,D,w,v,E,C,J){function K(a,c){a=null!=a?c.attributes[a]:0;return null!=a&&isFinite(a)?a:0}Object.defineProperty(d,"__esModule",{value:!0});var G=new w,I=r.getLogger("esri.views.3d.layers.graphics.Graphics3DSymbolLayer");z=function(d){function r(a,c,b,f){var h=d.call(this)||this;h._elevationInfoOverride=null;h.complexity=null;h.logger=I;h._elevationOptions={supportsOffsetAdjustment:!1,supportsOnTheGround:!0};h.symbol=a;h.symbolLayer=c;h._context=b;h._renderPriority=
f.renderPriority;h._renderPriorityDelta=f.renderPriorityStep;h._elevationContext=new w;h.complexity=h.computeComplexity();h._updateDrivenProperties(f.ignoreDrivers);h._updateElevationContext();return h}t(r,d);r.prototype.getCachedSize=function(){return null};Object.defineProperty(r.prototype,"needsDrivenTransparentPass",{get:function(){return this._drivenProperties.opacity&&!this._drivenProperties.opacityAlwaysOpaque},enumerable:!0,configurable:!0});r.prototype._logGeometryCreationWarnings=function(a,
c,b,f){var h="polygons"in a?a.polygons:null;f+=" geometry failed to be created";var m=null;a.projectionSuccess?!c.length||1===c.length&&!c[0].length?m=f+" (no "+b+" were defined)":Array.isArray(c)&&Array.isArray(c[0])?c.some(function(a){return 1===a.length})?m=f+" ("+b+" should contain at least 2 vertices)":h&&0===h.length&&"rings"===b&&(m=f+" (filled "+b+" should use clockwise winding - try reversing the order of vertices)"):m=f+" ("+b+" should be defined as a 2D array)":m=f+" (failed to project geometry to view spatial reference)";
m&&I.warnOncePerTick(m)};r.prototype._validateGeometryType=function(a,c,b){if(f.includes(c,a.type))return!0;this.logger.warn("unsupported geometry type for "+b+(" symbol: "+a.type));return!1};r.prototype._validateGeometry=function(a){return"point"!==a.type||c.isFinite(a.x)&&c.isFinite(a.y)?!0:(I.warn("point coordinate is not a valid number, graphic skipped"),!1)};r.prototype._defaultElevationInfoNoZ=function(){return x};r.prototype._defaultElevationInfoZ=function(){return N};r.prototype._updateElevationContext=
function(){a.isSome(this._elevationInfoOverride)?(this._elevationContext.setFromElevationInfo(this._elevationInfoOverride),this._elevationContext.featureExpressionInfoContext=null):this._context.layer.elevationInfo?(this._elevationContext.setFromElevationInfo(this._context.layer.elevationInfo),this._elevationContext.featureExpressionInfoContext=this._context.featureExpressionInfoContext):this._elevationContext.setDefaults()};r.prototype.getDefaultElevationInfo=function(a){return a.hasZ?this._defaultElevationInfoZ():
this._defaultElevationInfoNoZ()};r.prototype.getGeometryElevationMode=function(a,c){void 0===c&&(c=this.getDefaultElevationInfo(a));return this._elevationContext.mode||c.mode};r.prototype.setElevationInfoOverride=function(a){this._elevationInfoOverride=a;this._updateElevationContext()};r.prototype.getGraphicElevationContext=function(c){var b=a.expect(c.geometry),f=this.getDefaultElevationInfo(b);G.setUnit(null!=this._elevationContext.unit?this._elevationContext.unit:f.unit);G.mode=this.getGeometryElevationMode(b,
f);G.setOffsetMeters(a.unwrapOr(this._elevationContext.meterUnitOffset,a.unwrapOr(f.offset,0)));G.featureExpressionInfoContext=this._elevationContext.featureExpressionInfoContext;this._elevationOptions.supportsOnTheGround||"on-the-ground"!==G.mode||(G.mode="relative-to-ground",G.setOffsetMeters(0),G.featureExpressionInfoContext=v.zeroContext);if(b=G.featureExpressionInfoContext&&G.featureExpressionInfoContext.arcade)c=v.createFeature(b.modules,c,this._context.layer),v.setContextFeature(G.featureExpressionInfoContext,
c);return G};r.prototype.prepareSymbolLayerPatch=function(a){};r.prototype.updateGeometry=function(a,c){return!1};r.prototype.onRemoveGraphic=function(a){};r.prototype._updateDrivenProperties=function(a){var c={color:!1,opacity:!1,opacityAlwaysOpaque:!0,size:!1};a||(a=this._context.renderer)&&"visualVariables"in a&&a.visualVariables&&a.visualVariables.forEach(function(a){switch(a.type){case "color":c.color=!0;if(a.stops)for(var b=0;b<a.stops.length;b++){var f=a.stops[b].color;f&&(c.opacity=!0,1>f.a&&
(c.opacityAlwaysOpaque=!1))}break;case "opacity":c.opacity=!0;c.opacityAlwaysOpaque=!1;break;case "size":c.size=!0}});this._drivenProperties=c};r.prototype._getLayerOpacity=function(){if(this._context.layerView&&"fullOpacity"in this._context.layerView)return this._context.layerView.fullOpacity;var a=this._context.layer.opacity;return null==a?1:a};r.prototype._getCombinedOpacity=function(c,b){void 0===b&&(b=O);var f=1;this.draped||(f*=this._getLayerOpacity());if(this._drivenProperties.opacity)return f;
a.isSome(c)?f*=c.a:b.hasIntrinsicColor||(f=0);return f};r.prototype._getCombinedOpacityAndColor=function(c,f){void 0===f&&(f=O);f=this._getCombinedOpacity(c,f);if(this._drivenProperties.color)return E.mixinColorAndOpacity(null,f);c=a.isSome(c)?b.toUnitRGB(c):m.vec3f64.ONES;return E.mixinColorAndOpacity(c,f)};r.prototype._getVertexOpacityAndColor=function(a,c,b){a=E.mixinColorAndOpacity(this._drivenProperties.color?a.color:null,this._drivenProperties.opacity?a.opacity:null);b&&(a[0]*=b,a[1]*=b,a[2]*=
b,a[3]*=b);return c?new c(a):a};r.prototype._getIdHint=function(a){void 0===a&&(a="");return this._context.layer.id+"_symbol"+a};r.prototype.isFastUpdatesEnabled=function(){return this._fastUpdates&&this._fastUpdates.enabled};r.prototype.computeComplexity=function(){return J.defaultSymbolLayerComplexity(this.symbol,this.symbolLayer)};r.prototype.destroy=function(){this.abortLoad()};r.prototype.globalPropertyChanged=function(a,c,b){switch(a){case "opacity":return this.layerOpacityChanged(c,b);case "elevationInfo":return a=
this._elevationContext.mode,this._updateElevationContext(),this.layerElevationInfoChanged(c,b,a)===D.SymbolUpdateType.RECREATE?!1:!0;case "slicePlaneEnabled":return this.slicePlaneEnabledChanged(c,b);case "physicalBasedRenderingEnabled":return this.physicalBasedRenderingChanged();case "pixelRatio":return this.pixelRatioChanged();default:return h.neverReachedSilent(a),!1}};r.prototype.updateGraphics3DGraphicElevationInfo=function(c,b,f){var h=this,m=D.SymbolUpdateType.UPDATE;c.forEach(function(c){var d=
b(c);a.isSome(d)?(c=h.getGraphicElevationContext(c.graphic),d.needsElevationUpdates=f(c.mode),d.elevationContext.set(c)):m=D.SymbolUpdateType.RECREATE});return m};r.prototype.applyRendererDiff=function(a,c){return!1};r.prototype.getFastUpdateAttrValues=function(a){if(!this._fastUpdates.enabled)return null;var c=this._fastUpdates.visualVariables,b=c.size?K(c.size.field,a):0,f=c.color?K(c.color.field,a):0;a=c.opacity?K(c.opacity.field,a):0;return u.vec4f64.fromValues(b,f,a,0)};Object.defineProperty(r.prototype,
"draped",{get:function(){return this._draped},enumerable:!0,configurable:!0});r.prototype.ensureDrapedStatus=function(a){if(null==this._draped)return this._draped=a,!0;a!==this.draped&&I.warnOnce("A symbol can only produce either draped or non-draped visualizations. Use two separate symbol instances for draped and non-draped graphics if necessary.");return!1};return r}(C.Loadable);d.Graphics3DSymbolLayer=z;d.getAttributeValue=K;var x={mode:"on-the-ground",offset:0,unit:"meters"},N={mode:"absolute-height",
offset:0,unit:"meters"},O={hasIntrinsicColor:!1};d.default=z})},"esri/views/3d/layers/graphics/Loadable":function(){define(["require","exports","../../../../core/tsSupport/generatorHelper","../../../../core/tsSupport/awaiterHelper","../../../../core/promiseUtils"],function(z,d,t,l,q){Object.defineProperty(d,"__esModule",{value:!0});z=function(){function b(){this._abortController=null;this._loadStatus=0;this.logger=this._loader=this._loadError=null}Object.defineProperty(b.prototype,"loadStatus",{get:function(){return this._loadStatus},
enumerable:!0,configurable:!0});b.prototype.load=function(b,h){var f=this;if(1===this._loadStatus)return b&&b(),this._loader;if(2===this._loadStatus)return h&&h(this._loadError),this._loader;this._loader||(this._abortController=q.createAbortController(),this._loader=this.doLoad(this._abortController.signal).then(function(){f._abortController=null;f._loadStatus=1},function(c){f._loadError=c;f._abortController=null;f._loadStatus=2;!q.isAbortError(c)&&f.logger&&c.message&&f.logger.warn(c.message);throw c;
}));this._loader.then(b,h).catch(function(){});return this._loader};b.prototype.abortLoad=function(){this._abortController?(this._abortController.abort(),this._abortController=null):0===this._loadStatus&&(this._loadStatus=2);this._loader=null};return b}();d.Loadable=z})},"esri/views/3d/layers/graphics/symbolComplexity":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/compilerUtils ../../../../core/maybe ../../../../symbols/support/ObjectSymbol3DLayerResource ./primitiveObjectSymbolUtils ../../webgl-engine/lib/Util ../../webgl-engine/lib/lodRendering/LodResources".split(" "),
function(z,d,t,l,q,b,f,h,r){function c(a){for(var c=0,b=0,f=!1,h={bytesPerFeature:0,bytesPerFeatureLabel:0,bytesPerCoordinate:0,draped:{bytesPerFeature:0,bytesPerFeatureLabel:0,bytesPerCoordinate:0}},m=0;m<a.length;m++){var d=a[m];d&&(c+=d.primitivesPerFeature,b+=d.primitivesPerCoordinate,h.bytesPerFeature+=d.memory.bytesPerFeature,h.bytesPerFeatureLabel+=d.memory.bytesPerFeatureLabel,h.bytesPerCoordinate+=d.memory.bytesPerCoordinate,h.draped.bytesPerFeature+=d.memory.bytesPerFeature,h.draped.bytesPerFeatureLabel+=
d.memory.bytesPerFeatureLabel,h.draped.bytesPerCoordinate+=d.memory.bytesPerCoordinate,f=f||d.estimated)}return{primitivesPerFeature:c,primitivesPerCoordinate:b,estimated:f,memory:h}}function a(a,c){var f=m(a,c);switch(c.type){case "extrude":return{primitivesPerFeature:-4,primitivesPerCoordinate:4,estimated:!1,memory:f};case "fill":return"mesh-3d"===a.type?{primitivesPerFeature:0,primitivesPerCoordinate:0,estimated:!1,memory:f}:q.isSome(c.outline)&&0<c.outline.size?{primitivesPerFeature:-4,primitivesPerCoordinate:3,
estimated:!1,memory:f}:{primitivesPerFeature:-2,primitivesPerCoordinate:1,estimated:!1,memory:f};case "water":return{primitivesPerFeature:-2,primitivesPerCoordinate:1,estimated:!1,memory:f};case "line":return{primitivesPerFeature:-2,primitivesPerCoordinate:2,estimated:!1,memory:f};case "object":return c.resource&&c.resource.href?{primitivesPerFeature:16,primitivesPerCoordinate:0,estimated:!0,memory:f}:t({},u(c.resource&&c.resource.primitive||b.defaultPrimitive),{memory:f});case "path":var h=a=0;switch(c.profile){case "circle":a=
10;break;case "quad":a=4;break;default:l.neverReached(c.profile);return}switch(c.join){case "round":h=3;break;case "miter":case "bevel":h=1;break;default:l.neverReached(c.join);return}var d=2*a,h=a*h*2,r=-2*h-d;switch(c.cap){case "none":break;case "butt":case "square":r+=2*(a-1);break;case "round":r+=2*(4*a+a);break;default:l.neverReached(c.cap);return}return{primitivesPerFeature:r,primitivesPerCoordinate:h+d,estimated:!1,memory:f};case "text":case "icon":return{primitivesPerFeature:2,primitivesPerCoordinate:0,
estimated:!1,memory:f};default:l.neverReached(c)}}function m(a,c){a="point-3d"===a.type;switch(c.type){case "extrude":return c.edges&&0<c.edges.size?d.memoryEstimators.EXTRUDE_EDGES:d.memoryEstimators.EXTRUDE;case "fill":return q.isSome(c.outline)&&0<c.outline.size?d.memoryEstimators.FILL_OUTLINE:d.memoryEstimators.FILL;case "water":return d.memoryEstimators.FILL;case "line":return"round"===c.join?d.memoryEstimators.LINE_ROUND:d.memoryEstimators.LINE_MITER;case "path":switch(c.join){case "round":switch(c.profile){case "circle":return d.memoryEstimators.PATH_ROUND_CIRCLE;
case "quad":return d.memoryEstimators.PATH_ROUND_QUAD;default:l.neverReached(c.profile);return}case "miter":case "bevel":switch(c.profile){case "circle":return d.memoryEstimators.PATH_MITER_CIRCLE;case "quad":return d.memoryEstimators.PATH_MITER_QUAD;default:l.neverReached(c.profile);return}default:l.neverReached(c.join);return}case "object":return a?d.memoryEstimators.OBJECT_POINT:d.memoryEstimators.OBJECT_POLYGON;case "icon":case "text":return a?d.memoryEstimators.ICON_POINT:d.memoryEstimators.ICON_POLYGON;
default:l.neverReached(c)}}function u(a){var c=D[a];if(c)return c;c=f.primitiveLodResources(a,null,null);c={primitivesPerFeature:r.geometriesFromLodLevelResources(c.levels[0]).reduce(function(a,c){return a+c.data.getIndices(h.VertexAttrConstants.POSITION).length/3},0),primitivesPerCoordinate:0,estimated:!1};return D[a]=c}Object.defineProperty(d,"__esModule",{value:!0});d.emptySymbolComplexity={primitivesPerFeature:0,primitivesPerCoordinate:0,estimated:!0,memory:{bytesPerFeature:0,bytesPerCoordinate:0,
bytesPerFeatureLabel:0,draped:{bytesPerFeature:0,bytesPerFeatureLabel:0,bytesPerCoordinate:0}}};d.defaultSymbolComplexity=function(b){if("web-style"===b.type)return d.emptySymbolComplexity;var f=b.symbolLayers.toArray().map(function(c){return a(b,c)});return c(f)};d.totalSymbolComplexities=c;var D={};d.defaultSymbolLayerComplexity=a;d.defaultSymbolLayerMemoryComplexity=m;d.memoryEstimators={ICON_POINT:{bytesPerFeature:7127.413186968842,bytesPerFeatureLabel:4826.302896296296,bytesPerCoordinate:0,draped:{bytesPerFeature:3929.4396628895197,
bytesPerFeatureLabel:3550.1332222222227,bytesPerCoordinate:0}},ICON_POLYGON:{bytesPerFeature:9329.452613976147,bytesPerFeatureLabel:3675.3372604938268,bytesPerCoordinate:60.177252982212096,draped:{bytesPerFeature:6190.247450139383,bytesPerFeatureLabel:3744.074358024691,bytesPerCoordinate:59.488211068026104}},OBJECT_POINT:{bytesPerFeature:2350.5884192634558,bytesPerFeatureLabel:4446.651003703703,bytesPerCoordinate:0,draped:{bytesPerFeature:2350.5884192634558,bytesPerFeatureLabel:4446.651003703703,
bytesPerCoordinate:0}},OBJECT_POLYGON:{bytesPerFeature:4583.807620302299,bytesPerFeatureLabel:3665.342685185186,bytesPerCoordinate:60.11621818101506,draped:{bytesPerFeature:4583.807620302299,bytesPerFeatureLabel:3665.342685185186,bytesPerCoordinate:60.11621818101506}},LINE_MITER:{bytesPerFeature:7321.028181375921,bytesPerFeatureLabel:4048.0226716049388,bytesPerCoordinate:186.55621386363578,draped:{bytesPerFeature:4246.856619435009,bytesPerFeatureLabel:3852.3737679012347,bytesPerCoordinate:163.47884002621583}},
LINE_ROUND:{bytesPerFeature:7482.205842738954,bytesPerFeatureLabel:4045.886987654321,bytesPerCoordinate:191.5452524171851,draped:{bytesPerFeature:4473.481387957992,bytesPerFeatureLabel:3842.1112395061728,bytesPerCoordinate:167.27703460226945}},PATH_MITER_CIRCLE:{bytesPerFeature:9010.489006415351,bytesPerFeatureLabel:4230.9109,bytesPerCoordinate:4618.2594178027275,draped:{bytesPerFeature:9010.489006415351,bytesPerFeatureLabel:4230.9109,bytesPerCoordinate:4618.2594178027275}},PATH_ROUND_CIRCLE:{bytesPerFeature:4104.727250200398,
bytesPerFeatureLabel:4251.8525,bytesPerCoordinate:8019.043777064957,draped:{bytesPerFeature:4104.727250200398,bytesPerFeatureLabel:4251.8525,bytesPerCoordinate:8019.043777064957}},PATH_MITER_QUAD:{bytesPerFeature:9416.372942261387,bytesPerFeatureLabel:4241.2757,bytesPerCoordinate:3176.7222742582203,draped:{bytesPerFeature:9416.372942261387,bytesPerFeatureLabel:4241.2757,bytesPerCoordinate:3176.7222742582203}},PATH_ROUND_QUAD:{bytesPerFeature:6614.431545308682,bytesPerFeatureLabel:4206.7461,bytesPerCoordinate:5141.817789093826,
draped:{bytesPerFeature:6614.431545308682,bytesPerFeatureLabel:4206.7461,bytesPerCoordinate:5141.817789093826}},FILL:{bytesPerFeature:9478.244183633637,bytesPerFeatureLabel:3713.816824691358,bytesPerCoordinate:95.9343604185578,draped:{bytesPerFeature:6287.911108168086,bytesPerFeatureLabel:3790.785032098766,bytesPerCoordinate:83.08783220478168}},FILL_OUTLINE:{bytesPerFeature:13085.871870349445,bytesPerFeatureLabel:3392.613241975309,bytesPerCoordinate:118.63968023169875,draped:{bytesPerFeature:8437.199992480122,
bytesPerFeatureLabel:3973.5431172839503,bytesPerCoordinate:106.33556817014312}},EXTRUDE:{bytesPerFeature:19459.53727140414,bytesPerFeatureLabel:3743.7045209876546,bytesPerCoordinate:372.6819978900477,draped:{bytesPerFeature:19459.53727140414,bytesPerFeatureLabel:3743.7045209876546,bytesPerCoordinate:372.6819978900477}},EXTRUDE_EDGES:{bytesPerFeature:22266.888534913724,bytesPerFeatureLabel:3064.3193358024696,bytesPerCoordinate:374.3725221561312,draped:{bytesPerFeature:22266.888534913724,bytesPerFeatureLabel:3064.3193358024696,
bytesPerCoordinate:374.3725221561312}}}})},"esri/views/3d/layers/graphics/primitiveObjectSymbolUtils":function(){define("require exports ../../../../core/compilerUtils ../../../../geometry/support/aaBoundingBox ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryUtil".split(" "),function(z,d,t,l,q,b){Object.defineProperty(d,"__esModule",{value:!0});var f=l.fromValues(-.5,-.5,-.5,.5,.5,.5),h=l.fromValues(-.5,-.5,0,.5,.5,1),r=l.fromValues(-.5,-.5,0,.5,.5,.5);d.isValidPrimitive=function(a){switch(a){case "sphere":case "cube":case "diamond":case "cylinder":case "cone":case "inverted-cone":case "tetrahedron":return!0}return!1};
d.primitiveBoundingBox=function(a){switch(a){case "sphere":case "cube":case "diamond":return f;case "cylinder":case "cone":case "inverted-cone":return h;case "tetrahedron":return r;default:t.neverReached(a)}};d.primitiveGeometryData=function(a){switch(a){case "sphere":return b.createPolySphereGeometry(.5,2,!0);case "cube":return b.createBoxGeometry(1);case "cylinder":return b.createCylinderGeometry(1,.5,32,[0,0,1],[0,0,.5]);case "cone":return b.cgToGIS(b.createConeGeometry(1,.5,15,!1));case "inverted-cone":return b.cgToGIS(b.createConeGeometry(1,
.5,15,!0));case "tetrahedron":return b.cgToGIS(b.createTetrahedronGeometry(1));case "diamond":return b.cgToGIS(b.createDiamondGeometry(1));default:t.neverReached(a)}};d.primitiveLodResources=function(a,f,h){var m=function(a,c,m){void 0===m&&(m=!1);return{levels:a.map(function(a,d){var r=c(a.tesselation);m&&b.cgToGIS(r);return{components:[{geometry:new q(r,h+("_lod"+d)),material:f}],faceCount:r.indexCount/3,minScreenSpaceRadius:a.minScreenSpaceRadius}})}};switch(a){case "sphere":return m([{tesselation:0,
minScreenSpaceRadius:0},{tesselation:1,minScreenSpaceRadius:8},{tesselation:2,minScreenSpaceRadius:16},{tesselation:3,minScreenSpaceRadius:50},{tesselation:4,minScreenSpaceRadius:250}],function(a){return b.createPolySphereGeometry(.5,a,!0)});case "cube":return m([{tesselation:0,minScreenSpaceRadius:0}],function(){return b.createBoxGeometry(1)});case "cone":return m(c,function(a){return b.createConeGeometry(1,.5,a,!1)},!0);case "inverted-cone":return m(c,function(a){return b.createConeGeometry(1,.5,
a,!0)},!0);case "cylinder":return m(c,function(a){return b.createCylinderGeometry(1,.5,a,[0,0,1],[0,0,.5])});case "tetrahedron":return m([{tesselation:0,minScreenSpaceRadius:0}],function(){return b.createTetrahedronGeometry(1)},!0);case "diamond":return m([{tesselation:0,minScreenSpaceRadius:0}],function(){return b.createDiamondGeometry(1)},!0);default:t.neverReached(a)}};var c=[{tesselation:6,minScreenSpaceRadius:0},{tesselation:18,minScreenSpaceRadius:7},{tesselation:64,minScreenSpaceRadius:65}]})},
"esri/views/3d/webgl-engine/lib/Geometry":function(){define("require exports ./BoundingInfo ./ComponentUtils ./geometryDataUtils ./IdGen ./Util ./Util".split(" "),function(z,d,t,l,q,b,f,h){return function(){function d(c,a,b){this._componentAABBs=this._boundingInfo=null;this._id=d.__idGen.gen(a);this._data=c;this._boundingInfo=b}Object.defineProperty(d.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"data",{get:function(){return this._data},
enumerable:!0,configurable:!0});d.prototype.getIndices=function(c){return this.data.getIndices(c)};Object.defineProperty(d.prototype,"indexCount",{get:function(){return this.data.indexCount},enumerable:!0,configurable:!0});d.prototype.getAttribute=function(c){return this.data.getAttribute(c)};Object.defineProperty(d.prototype,"componentCount",{get:function(){return l.componentCount(this.data.componentOffsets)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"componentOffsets",{get:function(){return this.data.componentOffsets},
enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"vertexCount",{get:function(){return this.data.indexCount},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"faceCount",{get:function(){return this.data.indexCount/3},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"boundingInfo",{get:function(){null==this._boundingInfo&&(this._boundingInfo=this._calculateBoundingInfo());return this._boundingInfo},enumerable:!0,configurable:!0});d.prototype.computeAttachmentOrigin=
function(c){return"triangle"===this.data.primitiveType?this.computeAttachmentOriginTriangles(c):this.computeAttachmentOriginPoints(c)};d.prototype.computeAttachmentOriginTriangles=function(c){var a=this.getIndices(h.VertexAttrConstants.POSITION),b=this.getAttribute(h.VertexAttrConstants.POSITION);return q.computeAttachmentOriginTriangles(b,a,c)};d.prototype.computeAttachmentOriginPoints=function(c){var a=this.getIndices(h.VertexAttrConstants.POSITION),b=this.getAttribute(h.VertexAttrConstants.POSITION);
return q.computeAttachmentOriginPoints(b,a,c)};d.prototype.invalidateBoundingInfo=function(){this._componentAABBs=this._boundingInfo=null};d.prototype.getComponentAABB=function(c,a){null==this._componentAABBs&&(this._componentAABBs=this._computeComponentAABBs());for(var b=0;6>b;b++)a[b]=this._componentAABBs[6*c+b];return a};d.prototype._computeComponentAABBs=function(){for(var c=this.componentCount,a=new Float32Array(6*c),b=0;b<c;b++)this._calculateAABB(b,a,6*b);return a};d.prototype._calculateAABB=
function(c,a,b){var f=this.data.getIndices(h.VertexAttrConstants.POSITION),m=this.data.getAttribute(h.VertexAttrConstants.POSITION),d=this.data.componentOffsets,r=d.length?d[c+1]:f.length,l=Infinity,q=Infinity,t=Infinity,K=-Infinity,G=-Infinity,I=-Infinity,x=m.offsetIdx,N=m.strideIdx;for(c=d.length?d[c]:0;c<r;c++)var O=x+N*f[c],d=m.data[O],P=m.data[O+1],O=m.data[O+2],l=Math.min(l,d),q=Math.min(q,P),t=Math.min(t,O),K=Math.max(K,d),G=Math.max(G,P),I=Math.max(I,O);a[b]=l;a[b+1]=q;a[b+2]=t;a[b+3]=K;a[b+
4]=G;a[b+5]=I};d.prototype._calculateBoundingInfo=function(){var c=this.data.getIndices(h.VertexAttrConstants.POSITION),a=this.data.getAttribute(h.VertexAttrConstants.POSITION),b="triangle"===this.data.primitiveType?3:1;if(0===c.length)for(var c=new Uint32Array(b),d=0;d<b;++d)c[d]=d;d=c.length;f.assert(0===d%b,"Indexing error: "+d.toFixed(0)+" not divisible by "+b.toFixed(0));d=q.generateDefaultIndexArray(d/b);return new t(d,b,c,a)};d.__idGen=new b.IdGen;return d}()})},"esri/views/3d/webgl-engine/lib/BoundingInfo":function(){define("require exports ../../../../core/PooledArray ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ./Util".split(" "),
function(z,d,t,l,q,b){z=function(){function f(h,d,c,a){this.primitiveIndices=h;this._numIndexPerPrimitive=d;this.indices=c;this._position=a;this.center=q.vec3f64.create();b.assert(1<=h.length);b.assert(0===c.length%this._numIndexPerPrimitive);b.assert(c.length>=h.length*this._numIndexPerPrimitive);b.assert(3===this._position.size||4===this._position.size);a=this._position;d=a.data;var m=a.offsetIdx,r=a.strideIdx;a=0;var t=h.length,w=m+r*c[this._numIndexPerPrimitive*h[a]];f.tmpIndices.clear();f.tmpIndices.push(w);
this.bbMin=q.vec3f64.fromValues(d[w],d[w+1],d[w+2]);for(this.bbMax=q.vec3f64.clone(this.bbMin);a<t;++a)for(var v=this._numIndexPerPrimitive*h[a],E=0;E<this._numIndexPerPrimitive;++E){w=m+r*c[v+E];f.tmpIndices.push(w);var C=d[w];this.bbMin[0]=Math.min(C,this.bbMin[0]);this.bbMax[0]=Math.max(C,this.bbMax[0]);C=d[w+1];this.bbMin[1]=Math.min(C,this.bbMin[1]);this.bbMax[1]=Math.max(C,this.bbMax[1]);C=d[w+2];this.bbMin[2]=Math.min(C,this.bbMin[2]);this.bbMax[2]=Math.max(C,this.bbMax[2])}l.vec3.lerp(this.center,
this.bbMin,this.bbMax,.5);this.bsRadius=.5*Math.max(Math.max(this.bbMax[0]-this.bbMin[0],this.bbMax[1]-this.bbMin[1]),this.bbMax[2]-this.bbMin[2]);h=this.bsRadius*this.bsRadius;for(a=0;a<f.tmpIndices.length;++a)w=f.tmpIndices.data[a],c=d[w]-this.center[0],m=d[w+1]-this.center[1],w=d[w+2]-this.center[2],r=c*c+m*m+w*w,r<=h||(r=Math.sqrt(r),t=.5*(r-this.bsRadius),this.bsRadius+=t,h=this.bsRadius*this.bsRadius,r=t/r,this.center[0]+=c*r,this.center[1]+=m*r,this.center[2]+=w*r);f.tmpIndices.clear()}f.prototype.getCenter=
function(){return this.center};f.prototype.getBSRadius=function(){return this.bsRadius};f.prototype.getBBMin=function(){return this.bbMin};f.prototype.getBBMax=function(){return this.bbMax};f.prototype.getPrimitiveIndices=function(){return this.primitiveIndices};f.prototype.getIndices=function(){return this.indices};f.prototype.getPosition=function(){return this._position};f.prototype.getChildren=function(){if(this._children)return this._children;if(1<l.vec3.squaredDistance(this.bbMin,this.bbMax)){for(var b=
l.vec3.lerp(q.vec3f64.create(),this.bbMin,this.bbMax,.5),d=this.primitiveIndices.length,c=new Uint8Array(d),a=Array(8),m=0;8>m;++m)a[m]=0;for(var m=this._position,u=m.data,t=m.offsetIdx,w=m.strideIdx,m=0;m<d;++m){for(var v=0,E=this._numIndexPerPrimitive*this.primitiveIndices[m],C=t+w*this.indices[E],J=u[C],K=u[C+1],G=u[C+2],I=1;I<this._numIndexPerPrimitive;++I){var C=t+w*this.indices[E+I],x=u[C],N=u[C+1],C=u[C+2];x<J&&(J=x);N<K&&(K=N);C<G&&(G=C)}J<b[0]&&(v|=1);K<b[1]&&(v|=2);G<b[2]&&(v|=4);c[m]=v;
++a[v]}for(m=b=0;8>m;++m)0<a[m]&&++b;if(2>b)return;b=Array(8);for(m=0;8>m;++m)b[m]=0<a[m]?new Uint32Array(a[m]):void 0;for(m=0;8>m;++m)a[m]=0;for(m=0;m<d;++m)v=c[m],b[v][a[v]++]=this.primitiveIndices[m];this._children=Array(8);for(m=0;8>m;++m)void 0!==b[m]&&(this._children[m]=new f(b[m],this._numIndexPerPrimitive,this.indices,this._position))}return this._children};return f}();(z||(z={})).tmpIndices=new t({deallocator:null});return z})},"esri/views/3d/webgl-engine/lib/geometryDataUtils":function(){define(["require",
"exports","../../../../core/libs/gl-matrix-2/vec3","../../../../core/libs/gl-matrix-2/vec3f64","../../support/geometryUtils/triangle"],function(z,d,t,l,q){Object.defineProperty(d,"__esModule",{value:!0});var b=1,f=null,h=new Uint32Array([0]);d.generateDefaultIndexArray=function(a){if(1===a)return h;if(a>b||null==f){for(;a>b;)b*=2;f=new Uint32Array(b);for(var c=0;c<b;c++)f[c]=c}return new Uint32Array(f.buffer,0,a)};d.computeAttachmentOriginTriangles=function(b,f,h){if(!b)return!1;var d=b.strideIdx,
r=b.offsetIdx;b=b.data;t.vec3.set(h,0,0,0);t.vec3.set(u,0,0,0);for(var l=0,v=0,w=0;w<f.length-2;w+=3){var D=f[w+0]*d+r,x=f[w+1]*d+r,N=f[w+2]*d+r;t.vec3.set(c,b[D+0],b[D+1],b[D+2]);t.vec3.set(a,b[x+0],b[x+1],b[x+2]);t.vec3.set(m,b[N+0],b[N+1],b[N+2]);(D=q.areaPoints3d(c,a,m))?(t.vec3.add(c,c,a),t.vec3.add(c,c,m),t.vec3.scale(c,c,1/3*D),t.vec3.add(h,h,c),l+=D):(t.vec3.add(u,u,c),t.vec3.add(u,u,a),t.vec3.add(u,u,m),v+=3)}return 0===v&&0===l?!1:0!==l?(t.vec3.scale(h,h,1/l),!0):0!==v?(t.vec3.scale(h,u,
1/v),!0):!1};d.computeAttachmentOriginPoints=function(a,c,b){if(!a||!c)return!1;var f=a.strideIdx,h=a.offsetIdx;a=a.data;t.vec3.set(b,0,0,0);for(var d=-1,m=0,r=0;r<c.length;r++){var l=c[r]*f+h;d!==l&&(b[0]+=a[l+0],b[1]+=a[l+1],b[2]+=a[l+2],m++);d=l}1<m&&t.vec3.scale(b,b,1/m);return 0<m};d.computeAttachmentOriginLines=function(b,f,h,d){if(!b)return!1;var m=b.strideIdx,r=b.offsetIdx;b=b.data;t.vec3.set(d,0,0,0);t.vec3.set(u,0,0,0);var l=0,q=0,v=f?f.length-1:b.length/m-1;h=v+(h?2:0);for(var w=0;w<h;w+=
2){var D=w<v?w:v,E=w<v?w+1:0,D=(f?f[D]:D)*m+r,E=(f?f[E]:E)*m+r;c[0]=b[D+0];c[1]=b[D+1];c[2]=b[D+2];a[0]=b[E+0];a[1]=b[E+1];a[2]=b[E+2];t.vec3.scale(c,t.vec3.add(c,c,a),.5);E=t.vec3.dist(c,a);0<E?(t.vec3.add(d,d,t.vec3.scale(c,c,E)),l+=E):(t.vec3.add(u,u,c),q++)}return 0!==l?(t.vec3.scale(d,d,1/l),!0):0!==q?(t.vec3.scale(d,u,1/q),!0):!1};var r=0;d.getNewId=function(){return r++};var c=l.vec3f64.create(),a=l.vec3f64.create(),m=l.vec3f64.create(),u=l.vec3f64.create()})},"esri/views/3d/support/geometryUtils/triangle":function(){define("require exports ../../../../core/ObjectStack ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../stack ./lineSegment".split(" "),
function(z,d,t,l,q,b,f,h){function r(a){return a?{p0:b.vec3f64.clone(a.p0),p1:b.vec3f64.clone(a.p1),p2:b.vec3f64.clone(a.p2)}:{p0:b.vec3f64.create(),p1:b.vec3f64.create(),p2:b.vec3f64.create()}}function c(a,c,b,f){void 0===f&&(f=r());q.vec3.copy(f.p0,a);q.vec3.copy(f.p1,c);q.vec3.copy(f.p2,b);return f}function a(a,c,b){var f=l.vec2.distance(a,c);c=l.vec2.distance(c,b);a=l.vec2.distance(b,a);b=(f+c+a)/2;f=b*(b-f)*(b-c)*(b-a);return 0>=f?0:Math.sqrt(f)}Object.defineProperty(d,"__esModule",{value:!0});
d.create=r;d.wrap=function(a,c,b){var f=u.get();f.p0=a;f.p1=c;f.p2=b;return f};d.copy=function(a,b){void 0===b&&(b=r());return c(a.p0,a.p1,a.p2,b)};d.fromValues=c;d.distance2=function(a,c){var b=a.p0,d=a.p1;a=a.p2;var r=q.vec3.subtract(f.sv3d.get(),d,b),l=q.vec3.subtract(f.sv3d.get(),a,d),u=q.vec3.subtract(f.sv3d.get(),b,a),v=q.vec3.subtract(f.sv3d.get(),c,b),w=q.vec3.subtract(f.sv3d.get(),c,d),t=q.vec3.subtract(f.sv3d.get(),c,a),D=q.vec3.cross(r,r,u),E=q.vec3.dot(q.vec3.cross(f.sv3d.get(),r,D),v),
w=q.vec3.dot(q.vec3.cross(f.sv3d.get(),l,D),w),t=q.vec3.dot(q.vec3.cross(f.sv3d.get(),u,D),t);if(0<E&&0<w&&0<t)return c=q.vec3.dot(D,v),c*c/q.vec3.dot(D,D);b=h.distance2(h.fromValues(b,r,m.get()),c);d=h.distance2(h.fromValues(d,l,m.get()),c);c=h.distance2(h.fromValues(a,u,m.get()),c);return Math.min(b,d,c)};d.intersectRay=function(a,c,b){var f=c.direction;c=c.origin;var h=a.p0,d=a.p1,m=a.p2,r=d[0]-h[0],l=d[1]-h[1],u=d[2]-h[2],d=m[0]-h[0];a=m[1]-h[1];var m=m[2]-h[2],v=f[1]*m-a*f[2],w=f[2]*d-m*f[0],
t=f[0]*a-d*f[1],D=r*v+l*w+u*t;if(-1E-5<D&&1E-5>D)return!1;var D=1/D,C=c[0]-h[0],E=c[1]-h[1],h=c[2]-h[2],v=D*(C*v+E*w+h*t);if(0>v||1<v)return!1;w=E*u-l*h;u=h*r-u*C;r=C*l-r*E;l=D*(f[0]*w+f[1]*u+f[2]*r);if(0>l||1<v+l)return!1;b&&(q.vec3.scale(b,f,D*(d*w+a*u+m*r)),q.vec3.add(b,c,b));return!0};d.areaPoints2d=a;d.area2d=function(c){return a(c.p0,c.p1,c.p2)};d.areaPoints3d=function(a,c,b){q.vec3.subtract(D,c,a);q.vec3.subtract(w,b,a);return q.vec3.length(q.vec3.cross(D,D,w))/2};var m=new t.ObjectStack(h.create),
u=new t.ObjectStack(function(){return{p0:null,p1:null,p2:null}}),D=b.vec3f64.create(),w=b.vec3f64.create()})},"esri/core/ObjectStack":function(){define(["require","exports","./nextTick"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});z=function(){function d(b){var f=this;this.allocator=b;this.items=[];this.itemsPtr=0;this.tickHandle=t.before(function(){return f.reset()});this.grow()}d.prototype.destroy=function(){this.tickHandle&&(this.tickHandle.remove(),this.tickHandle=null);this.items=
null};d.prototype.get=function(){0===this.itemsPtr&&t(function(){});this.itemsPtr===this.items.length&&this.grow();return this.items[this.itemsPtr++]};d.prototype.reset=function(){this.items.length=Math.min(Math.min(3*Math.max(8,this.itemsPtr),this.itemsPtr+3*l),this.items.length);this.itemsPtr=0};d.prototype.grow=function(){for(var b=0;b<Math.max(8,Math.min(this.items.length,l));b++)this.items.push(this.allocator())};return d}();d.ObjectStack=z;var l=1024;d.default=z})},"esri/views/3d/support/stack":function(){define(["require",
"exports","../../../core/VectorStack"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});d.sv2d=t.VectorStack.createVec2f64();d.sv3d=t.VectorStack.createVec3f64();d.sv4d=t.VectorStack.createVec4f64();d.sm3d=t.VectorStack.createMat3f64();d.sm4d=t.VectorStack.createMat4f64();d.sq4d=t.VectorStack.createQuatf64()})},"esri/core/VectorStack":function(){define("require exports ./nextTick ./libs/gl-matrix-2/mat3f64 ./libs/gl-matrix-2/mat4f64 ./libs/gl-matrix-2/quatf64 ./libs/gl-matrix-2/vec2f64 ./libs/gl-matrix-2/vec3f64 ./libs/gl-matrix-2/vec4f64".split(" "),
function(z,d,t,l,q,b,f,h,r){Object.defineProperty(d,"__esModule",{value:!0});z=function(){function a(a,c,b){var f=this;this.itemByteSize=a;this.itemCreate=c;this.buffers=[];this.items=[];this.itemsPtr=this.itemsPerBuffer=0;this.itemsPerBuffer=Math.ceil(b/this.itemByteSize);this.tickHandle=t.before(function(){return f.reset()})}a.prototype.destroy=function(){this.tickHandle&&(this.tickHandle.remove(),this.tickHandle=null);this.itemsPtr=0;this.buffers=this.items=null};a.prototype.get=function(){0===
this.itemsPtr&&t(function(){});for(var a=Math.floor(this.itemsPtr/this.itemsPerBuffer);this.buffers.length<=a;){for(var c=new ArrayBuffer(this.itemsPerBuffer*this.itemByteSize),b=0;b<this.itemsPerBuffer;++b)this.items.push(this.itemCreate(c,b*this.itemByteSize));this.buffers.push(c)}return this.items[this.itemsPtr++]};a.prototype.reset=function(){for(var a=2*(Math.floor(this.itemsPtr/this.itemsPerBuffer)+1);this.buffers.length>a;)this.buffers.pop(),this.items.length=this.buffers.length*this.itemsPerBuffer;
this.itemsPtr=0};a.createVec2f64=function(b){void 0===b&&(b=c);return new a(16,f.vec2f64.createView,b)};a.createVec3f64=function(b){void 0===b&&(b=c);return new a(24,h.vec3f64.createView,b)};a.createVec4f64=function(b){void 0===b&&(b=c);return new a(32,r.vec4f64.createView,b)};a.createMat3f64=function(b){void 0===b&&(b=c);return new a(72,l.mat3f64.createView,b)};a.createMat4f64=function(b){void 0===b&&(b=c);return new a(128,q.mat4f64.createView,b)};a.createQuatf64=function(f){void 0===f&&(f=c);return new a(32,
b.quatf64.createView,f)};Object.defineProperty(a.prototype,"test",{get:function(){return{size:this.buffers.length*this.itemsPerBuffer*this.itemByteSize}},enumerable:!0,configurable:!0});return a}();d.VectorStack=z;var c=4096})},"esri/core/libs/gl-matrix-2/mat3f64":function(){define(["require","exports","./factories/mat3f64"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});d.mat3f64=t})},"esri/core/libs/gl-matrix-2/factories/mat3f64":function(){define(["require","exports"],function(z,
d){Object.defineProperty(d,"__esModule",{value:!0});d.create=function(){return[1,0,0,0,1,0,0,0,1]};d.clone=function(d){return[d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7],d[8]]};d.fromValues=function(d,l,q,b,f,h,r,c,a){return[d,l,q,b,f,h,r,c,a]};d.createView=function(d,l){return new Float64Array(d,l,9)}})},"esri/core/libs/gl-matrix-2/quatf64":function(){define(["require","exports","./factories/quatf64"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});d.quatf64=t})},"esri/core/libs/gl-matrix-2/factories/quatf64":function(){define(["require",
"exports"],function(z,d){Object.defineProperty(d,"__esModule",{value:!0});d.create=function(){return[0,0,0,1]};d.clone=function(d){return[d[0],d[1],d[2],d[3]]};d.fromValues=function(d,l,q,b){return[d,l,q,b]};d.createView=function(d,l){return new Float64Array(d,l,4)}})},"esri/views/3d/support/geometryUtils/lineSegment":function(){define("require exports ../../../../core/mathUtils ../../../../core/ObjectStack ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../stack".split(" "),
function(z,d,t,l,q,b,f){function h(a){return a?{origin:b.vec3f64.clone(a.origin),vector:b.vec3f64.clone(a.vector)}:{origin:b.vec3f64.create(),vector:b.vec3f64.create()}}function r(a,c){var b=w.get();b.origin=a;b.vector=c;return b}function c(a,c,b){void 0===b&&(b=h());q.vec3.copy(b.origin,a);q.vec3.copy(b.vector,c);return b}function a(a,c){c=q.vec3.subtract(f.sv3d.get(),c,a.origin);var b=q.vec3.dot(a.vector,c),h=q.vec3.dot(a.vector,a.vector),b=t.clamp(b/h,0,1);a=q.vec3.subtract(f.sv3d.get(),q.vec3.scale(f.sv3d.get(),
a.vector,b),c);return q.vec3.dot(a,a)}function m(a,c,b,h,d){var m=a.vector,r=a.origin;c=q.vec3.subtract(f.sv3d.get(),c,r);r=q.vec3.length(m);c=q.vec3.dot(m,c)/r;q.vec3.scale(d,m,t.clamp(c,b,h));return q.vec3.add(d,d,a.origin)}function u(a,c,b,h){var d=a.origin,m=q.vec3.add(f.sv3d.get(),d,a.vector);a=c.origin;var r=q.vec3.add(f.sv3d.get(),a,c.vector),l=f.sv3d.get();c=f.sv3d.get();l[0]=d[0]-a[0];l[1]=d[1]-a[1];l[2]=d[2]-a[2];c[0]=r[0]-a[0];c[1]=r[1]-a[1];c[2]=r[2]-a[2];if(1E-6>Math.abs(c[0])&&1E-6>
Math.abs(c[1])&&1E-6>Math.abs(c[2]))return!1;r=f.sv3d.get();r[0]=m[0]-d[0];r[1]=m[1]-d[1];r[2]=m[2]-d[2];if(1E-6>Math.abs(r[0])&&1E-6>Math.abs(r[1])&&1E-6>Math.abs(r[2]))return!1;var m=l[0]*c[0]+l[1]*c[1]+l[2]*c[2],u=c[0]*r[0]+c[1]*r[1]+c[2]*r[2],w=c[0]*c[0]+c[1]*c[1]+c[2]*c[2],v=(r[0]*r[0]+r[1]*r[1]+r[2]*r[2])*w-u*u;if(1E-6>Math.abs(v))return!1;l=(m*u-(l[0]*r[0]+l[1]*r[1]+l[2]*r[2])*w)/v;m=(m+u*l)/w;b&&(l=t.clamp(l,0,1),m=t.clamp(m,0,1));b=f.sv3d.get();u=f.sv3d.get();b[0]=d[0]+l*r[0];b[1]=d[1]+l*
r[1];b[2]=d[2]+l*r[2];u[0]=a[0]+m*c[0];u[1]=a[1]+m*c[1];u[2]=a[2]+m*c[2];h.tA=l;h.tB=m;h.pA=b;h.pB=u;h.distance2=q.vec3.squaredDistance(b,u);return!0}Object.defineProperty(d,"__esModule",{value:!0});d.create=h;d.wrap=r;d.copy=function(a,b){void 0===b&&(b=h());return c(a.origin,a.vector,b)};d.fromValues=c;d.fromPoints=function(a,c,b){void 0===b&&(b=h());q.vec3.copy(b.origin,a);q.vec3.subtract(b.vector,c,a);return b};d.distance2=a;d.distance=function(c,b){return Math.sqrt(a(c,b))};d.projectPoint=function(a,
c,b){return m(a,c,0,1,b)};d.pointAt=function(a,c,b){return q.vec3.add(b,a.origin,q.vec3.scale(b,a.vector,c))};d.projectPointClamp=m;d.closestRayDistance2=function(a,c){if(u(a,r(c.origin,c.direction),!1,D)){c=D.tA;var b=D.pB,h=D.distance2;if(0<=c&&1>=c)return h;if(0>c)return q.vec3.squaredDistance(a.origin,b);if(1<c)return q.vec3.squaredDistance(q.vec3.add(f.sv3d.get(),a.origin,a.vector),b)}return null};d.closestLineSegmentPoint=function(a,c,b){return u(a,c,!0,D)?(q.vec3.copy(b,D.pA),!0):!1};d.closestLineSegmentDistance2=
function(a,c){return u(a,c,!0,D)?D.distance2:null};var D={tA:0,tB:0,pA:b.vec3f64.create(),pB:b.vec3f64.create(),distance2:0},w=new l.ObjectStack(function(){return{origin:null,vector:null}})})},"esri/views/3d/webgl-engine/lib/IdGen":function(){define(["require","exports"],function(z,d){Object.defineProperty(d,"__esModule",{value:!0});z=function(){function d(){this._count=0}d.prototype.gen=function(d){null==d&&(d="a");return d+"_"+this._count++};return d}();d.IdGen=z})},"esri/views/3d/webgl-engine/lib/GeometryUtil":function(){define("require exports ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f32 ../../../../core/libs/gl-matrix-2/vec3f64 ../../support/geometryUtils ./BufferVectorMath ./GeometryData ./Util".split(" "),
function(z,d,t,l,q,b,f,h,r){var c=f.Vec3Compact,a;(function(a){for(var c=[[-.5,-.5,.5],[.5,-.5,.5],[.5,.5,.5],[-.5,.5,.5],[-.5,-.5,-.5],[.5,-.5,-.5],[.5,.5,-.5],[-.5,.5,-.5]],b=[0,0,1,-1,0,0,1,0,0,0,-1,0,0,1,0,0,0,-1],f=[0,0,1,0,1,1,0,1],d=[0,1,2,2,3,0,4,0,3,3,7,4,1,5,6,6,2,1,1,0,4,4,5,1,3,2,6,6,7,3,5,4,7,7,6,5],m=Array(36),l=0;6>l;l++)for(var u=0;6>u;u++)m[6*l+u]=l;for(var q=Array(36),l=0;6>l;l++)q[6*l+0]=0,q[6*l+1]=1,q[6*l+2]=2,q[6*l+3]=2,q[6*l+4]=3,q[6*l+5]=0;a.createGeometry=function(a){Array.isArray(a)||
(a=[a,a,a]);for(var l=new Float32Array(24),u=0;8>u;u++)l[3*u]=c[u][0]*a[0],l[3*u+1]=c[u][1]*a[1],l[3*u+2]=c[u][2]*a[2];a={};a[r.VertexAttrConstants.POSITION]=new Uint32Array(d);a[r.VertexAttrConstants.NORMAL]=new Uint32Array(m);a[r.VertexAttrConstants.UV0]=new Uint32Array(q);u={};u[r.VertexAttrConstants.POSITION]={size:3,data:l};u[r.VertexAttrConstants.NORMAL]={size:3,data:new Float32Array(b)};u[r.VertexAttrConstants.UV0]={size:2,data:new Float32Array(f)};return new h.GeometryData(u,a)}})(a||(a={}));
var m;(function(a){var c=[[-.5,0,-.5],[.5,0,-.5],[.5,0,.5],[-.5,0,.5],[0,-.5,0],[0,.5,0]],b=[0,1,-1,1,1,0,0,1,1,-1,1,0,0,-1,-1,1,-1,0,0,-1,1,-1,-1,0],f=[5,1,0,5,2,1,5,3,2,5,0,3,4,0,1,4,1,2,4,2,3,4,3,0],d=[0,0,0,1,1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6,7,7,7];a.createGeometry=function(a){Array.isArray(a)||(a=[a,a,a]);for(var m=new Float32Array(18),l=0;6>l;l++)m[3*l]=c[l][0]*a[0],m[3*l+1]=c[l][1]*a[1],m[3*l+2]=c[l][2]*a[2];a={};a[r.VertexAttrConstants.POSITION]=new Uint32Array(f);a[r.VertexAttrConstants.NORMAL]=
new Uint32Array(d);l={};l[r.VertexAttrConstants.POSITION]={size:3,data:m};l[r.VertexAttrConstants.NORMAL]={size:3,data:new Float32Array(b)};return new h.GeometryData(l,a)}})(m||(m={}));var u;(function(a){var c=l.vec3f32.fromValues(-.5,0,-.5),b=l.vec3f32.fromValues(.5,0,-.5),f=l.vec3f32.fromValues(0,0,.5),d=l.vec3f32.fromValues(0,.5,0),m=l.vec3f32.create(),u=l.vec3f32.create(),q=l.vec3f32.create(),w=l.vec3f32.create(),v=l.vec3f32.create();t.vec3.subtract(m,c,d);t.vec3.subtract(u,c,b);t.vec3.cross(q,
m,u);t.vec3.normalize(q,q);t.vec3.subtract(m,b,d);t.vec3.subtract(u,b,f);t.vec3.cross(w,m,u);t.vec3.normalize(w,w);t.vec3.subtract(m,f,d);t.vec3.subtract(u,f,c);t.vec3.cross(v,m,u);t.vec3.normalize(v,v);var D=[c,b,f,d],C=[0,-1,0,q[0],q[1],q[2],w[0],w[1],w[2],v[0],v[1],v[2]],E=[0,1,2,3,1,0,3,2,1,3,0,2],V=[0,0,0,1,1,1,2,2,2,3,3,3];a.createGeometry=function(a){Array.isArray(a)||(a=[a,a,a]);for(var c=new Float32Array(12),b=0;4>b;b++)c[3*b]=D[b][0]*a[0],c[3*b+1]=D[b][1]*a[1],c[3*b+2]=D[b][2]*a[2];a={};
a[r.VertexAttrConstants.POSITION]=new Uint32Array(E);a[r.VertexAttrConstants.NORMAL]=new Uint32Array(V);b={};b[r.VertexAttrConstants.POSITION]={size:3,data:c};b[r.VertexAttrConstants.NORMAL]={size:3,data:new Float32Array(C)};return new h.GeometryData(b,a)}})(u||(u={}));var D;(function(d){function D(a,c,b,f,h){if(Math.abs(t.vec3.dot(c,a))>h)return!1;t.vec3.cross(b,a,c);t.vec3.normalize(b,b);t.vec3.cross(f,b,a);t.vec3.normalize(f,f);return!0}function C(a,c,b,f,h,d,m){return D(a,c,h,d,m)||D(a,b,h,d,
m)||D(a,f,h,d,m)}d.createBoxGeometry=a.createGeometry;d.createDiamondGeometry=m.createGeometry;d.createTetrahedronGeometry=u.createGeometry;d.createSphereGeometry=function(a,c,b,f,d,m,l){a=a||50;f=void 0!==f?f:-Math.PI;d=void 0!==d?d:2*Math.PI;m=void 0!==m?m:.5*-Math.PI;l=void 0!==l?l:Math.PI;var u=Math.max(3,Math.floor(c)||8),q=Math.max(2,Math.floor(b)||6),w=(u+1)*(q+1);b=new Float32Array(3*w);c=new Float32Array(3*w);for(var w=new Float32Array(2*w),v=[],t=0,x=0;x<=q;x++){for(var D=[],C=x/q,p=m+C*
l,L=Math.cos(p),A=0;A<=u;A++){var k=A/u,e=f+k*d,g=Math.cos(e)*L,n=Math.sin(p),e=-Math.sin(e)*L;b[3*t]=g*a;b[3*t+1]=n*a;b[3*t+2]=e*a;c[3*t]=g;c[3*t+1]=n;c[3*t+2]=e;w[2*t]=k;w[2*t+1]=C;D.push(t);++t}v.push(D)}a=new Uint32Array(2*u*(q-1)*3);for(x=t=0;x<q;x++)for(A=0;A<u;A++)f=v[x][A],d=v[x][A+1],m=v[x+1][A+1],l=v[x+1][A],0===x?(a[t++]=f,a[t++]=m,a[t++]=l):x===q-1?(a[t++]=f,a[t++]=d,a[t++]=m):(a[t++]=f,a[t++]=d,a[t++]=m,a[t++]=m,a[t++]=l,a[t++]=f);r.assert(t===a.length);u={};u[r.VertexAttrConstants.POSITION]=
a;u[r.VertexAttrConstants.NORMAL]=a;u[r.VertexAttrConstants.UV0]=a;q={};q[r.VertexAttrConstants.POSITION]={size:3,data:b};q[r.VertexAttrConstants.NORMAL]={size:3,data:c};q[r.VertexAttrConstants.UV0]={size:2,data:w};return new h.GeometryData(q,u)};d.createPolySphereGeometry=function(a,b,f){function d(p,k){p>k&&(k=[k,p],p=k[0],k=k[1]);var e=p.toString()+"."+k.toString();if(u[e])return u[e];var g=m.length;m.length+=3;c.add(m,3*p,m,3*k,m,g);c.scale(m,g,a/c.length(m,g));g/=3;return u[e]=g}var m;f?(m=[0,
-1,0,1,0,0,0,0,1,-1,0,0,0,0,-1,0,1,0],f=new Uint32Array([0,1,2,0,2,3,0,3,4,0,4,1,1,5,2,2,5,3,3,5,4,4,5,1])):(f=a*(1+Math.sqrt(5))/2,m=[-a,f,0,a,f,0,-a,-f,0,a,-f,0,0,-a,f,0,a,f,0,-a,-f,0,a,-f,f,0,-a,f,0,a,-f,0,-a,-f,0,a],f=new Uint32Array([0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1]));for(var l=0;l<m.length;l+=3)c.scale(m,l,a/c.length(m,l));for(var u={},l=0;l<b;l++){for(var q=f.length,w=new Uint32Array(4*q),v=0;v<
q;v+=3){var t=f[v],x=f[v+1],D=f[v+2],C=d(t,x),E=d(x,D),p=d(D,t),L=4*v;w[L]=t;w[L+1]=C;w[L+2]=p;w[L+3]=x;w[L+4]=E;w[L+5]=C;w[L+6]=D;w[L+7]=p;w[L+8]=E;w[L+9]=C;w[L+10]=E;w[L+11]=p}f=w;u={}}b=new Float32Array(m);for(l=0;l<b.length;l+=3)c.normalize(b,l);l={};l[r.VertexAttrConstants.POSITION]=f;l[r.VertexAttrConstants.NORMAL]=f;f={};f[r.VertexAttrConstants.POSITION]={size:3,data:new Float32Array(m)};f[r.VertexAttrConstants.NORMAL]={size:3,data:b};return new h.GeometryData(f,l)};d.createPointGeometry=function(a,
c,b,f,d,m,l,u){c=c?new Float64Array([c[0],c[1],c[2]]):new Float32Array([0,0,0]);a=a?new Float32Array([a[0],a[1],a[2]]):new Float32Array([0,0,1]);m=m?new Float32Array(m):new Float32Array([0,0]);b=b?new Uint8Array([255*b[0],255*b[1],255*b[2],3<b.length?255*b[3]:255]):new Uint8Array([255,255,255,255]);var q=null!=f&&2===f.length?new Float32Array(f):new Float32Array([1,1]);f={};f[r.VertexAttrConstants.POSITION]={size:3,data:c};f[r.VertexAttrConstants.NORMAL]={size:3,data:a};f[r.VertexAttrConstants.UV0]=
{size:m.length,data:m};f[r.VertexAttrConstants.COLOR]={size:4,data:b};f[r.VertexAttrConstants.SIZE]={size:2,data:q};null!=d&&(d=new Float32Array([d[0],d[1],d[2],d[3]]),f[r.VertexAttrConstants.AUXPOS1]={size:4,data:d});null!=l&&(l=new Float32Array([l[0],l[1],l[2],l[3]]),f[r.VertexAttrConstants.AUXPOS2]={size:4,data:l});return null!=u?(h.GeometryData.call(u,f,h.GeometryData.DefaultIndices,h.GeometryData.DefaultOffsets,"point"),u):new h.GeometryData(f,h.GeometryData.DefaultIndices,h.GeometryData.DefaultOffsets,
"point")};d.updatePointGeometry=function(a,c,b,f,h,d,m,l){var u=l.vertexAttributes;if(null!=a){var q=u[r.VertexAttrConstants.NORMAL].data;q[0]=a[0];q[1]=a[1];q[2]=a[2]}null!=c&&(q=u[r.VertexAttrConstants.POSITION].data,q[0]=c[0],q[1]=c[1],q[2]=c[2]);null!=b&&(q=u[r.VertexAttrConstants.COLOR].data,q[0]=b[0],q[1]=b[1],q[2]=b[2],q[3]=b[3]);null!=f&&(q=u[r.VertexAttrConstants.SIZE].data,q[0]=f[0],q[1]=f[1]);null!=h&&(q=u[r.VertexAttrConstants.AUXPOS1].data,q[0]=h[0],q[1]=h[1],q[2]=h[2],q[3]=h[3]);null!=
d&&(q=u[r.VertexAttrConstants.UV0].data,q[0]=d[0],q[1]=d[1]);null!=m&&(q=u[r.VertexAttrConstants.AUXPOS2].data,q[0]=m[0],q[1]=m[1],q[2]=m[2],q[3]=m[3]);return l};d.createPointArrayGeometry=function(a,c){for(var b=new Float32Array(3*a.length),f=new Float32Array(c?3*a.length:3),d=new Uint32Array(a.length),m=new Uint32Array(a.length),l=0;l<a.length;l++)b[3*l]=a[l][0],b[3*l+1]=a[l][1],b[3*l+2]=a[l][2],c&&(f[3*l]=c[l][0],f[3*l+1]=c[l][1],f[3*l+2]=c[l][2]),d[l]=l,m[l]=0;c||(f[0]=0,f[1]=1,f[2]=0);a=new Float32Array(2);
a[0]=0;a[1]=0;l={};l[r.VertexAttrConstants.POSITION]=d;l[r.VertexAttrConstants.NORMAL]=c?d:m;l[r.VertexAttrConstants.UV0]=m;c={};c[r.VertexAttrConstants.POSITION]={size:3,data:b};c[r.VertexAttrConstants.NORMAL]={size:3,data:f};c[r.VertexAttrConstants.UV0]={size:2,data:a};return new h.GeometryData(c,l,h.GeometryData.DefaultOffsets,"point")};d.createTriangleGeometry=function(){var a=new Float32Array([0,0,0,0,0,100,100,0,0]),c=new Uint32Array([0,1,2]),b=new Float32Array([0,1,0]),f=new Uint32Array([0,
0,0]),d=new Float32Array([0,0]),m=new Uint32Array([0,0,0]),l={};l[r.VertexAttrConstants.POSITION]=c;l[r.VertexAttrConstants.NORMAL]=f;l[r.VertexAttrConstants.UV0]=m;c={};c[r.VertexAttrConstants.POSITION]={size:3,data:a};c[r.VertexAttrConstants.NORMAL]={size:3,data:b};c[r.VertexAttrConstants.UV0]={size:2,data:d};return new h.GeometryData(c,l)};d.createSquareGeometry=function(a){var c=new Float32Array(12);if(a)for(var b=0;4>b;b++)for(var f=0;3>f;f++)c[3*b+f]=a[b][f];else c[0]=-1,c[1]=-1,c[2]=0,c[3]=
1,c[4]=-1,c[5]=0,c[6]=1,c[7]=1,c[8]=0,c[9]=-1,c[10]=1,c[11]=0;var d=new Uint32Array([0,1,2,2,3,0]);a=new Float32Array([0,0,1]);var m=new Uint32Array([0,0,0,0,0,0]),b=new Float32Array([0,0,1,0,1,1,0,1]),f=new Uint8Array([255,255,255,255]),l={};l[r.VertexAttrConstants.POSITION]=d;l[r.VertexAttrConstants.NORMAL]=m;l[r.VertexAttrConstants.UV0]=d;l[r.VertexAttrConstants.COLOR]=m;d={};d[r.VertexAttrConstants.POSITION]={size:3,data:c};d[r.VertexAttrConstants.NORMAL]={size:3,data:a};d[r.VertexAttrConstants.UV0]=
{size:2,data:b};d[r.VertexAttrConstants.COLOR]={size:4,data:f};return new h.GeometryData(d,l)};d.createConeGeometry=function(a,c,b,f,d,m){void 0===d&&(d=!0);void 0===m&&(m=!0);var u=0,q=l.vec3f32.fromValues(0,u,0),w=l.vec3f32.fromValues(0,u+a,0),v=l.vec3f32.fromValues(0,-1,0),t=l.vec3f32.fromValues(0,1,0);f&&(u=a,w=l.vec3f32.fromValues(0,0,0),q=l.vec3f32.fromValues(0,u,0),v=l.vec3f32.fromValues(0,1,0),t=l.vec3f32.fromValues(0,-1,0));q=[w,q];v=[v,t];t=b+2;w=Math.sqrt(a*a+c*c);if(f)for(f=b-1;0<=f;f--)x=
2*Math.PI/b*f,D=l.vec3f32.fromValues(Math.cos(x)*c,u,Math.sin(x)*c),q.push(D),x=l.vec3f32.fromValues(a*Math.cos(x)/w,-c/w,a*Math.sin(x)/w),v.push(x);else for(f=0;f<b;f++){var x=2*Math.PI/b*f,D=l.vec3f32.fromValues(Math.cos(x)*c,u,Math.sin(x)*c);q.push(D);x=l.vec3f32.fromValues(a*Math.cos(x)/w,c/w,a*Math.sin(x)/w);v.push(x)}a=new Uint32Array(6*(b+2));b=new Uint32Array(6*(b+2));u=c=0;if(d){for(f=3;f<q.length;f++)a[c++]=1,a[c++]=f-1,a[c++]=f,b[u++]=0,b[u++]=0,b[u++]=0;a[c++]=q.length-1;a[c++]=2;a[c++]=
1;b[u++]=0;b[u++]=0;b[u++]=0}if(m){for(f=3;f<q.length;f++)a[c++]=f,a[c++]=f-1,a[c++]=0,b[u++]=f,b[u++]=f-1,b[u++]=1;a[c++]=0;a[c++]=2;a[c++]=q.length-1;b[u++]=1;b[u++]=2;b[u++]=v.length-1}d=new Float32Array(3*t);for(f=0;f<t;f++)d[3*f]=q[f][0],d[3*f+1]=q[f][1],d[3*f+2]=q[f][2];m=new Float32Array(3*t);for(f=0;f<t;f++)m[3*f]=v[f][0],m[3*f+1]=v[f][1],m[3*f+2]=v[f][2];q={};q[r.VertexAttrConstants.POSITION]=a;q[r.VertexAttrConstants.NORMAL]=b;v={};v[r.VertexAttrConstants.POSITION]={size:3,data:d};v[r.VertexAttrConstants.NORMAL]=
{size:3,data:m};return new h.GeometryData(v,q)};d.createCylinderGeometry=function(a,c,b,f,d,m){f=f?l.vec3f32.clone(f):l.vec3f32.fromValues(1,0,0);d=d?l.vec3f32.clone(d):l.vec3f32.fromValues(0,0,0);m=void 0===m?!0:m;var u=l.vec3f32.create();t.vec3.normalize(u,f);f=l.vec3f32.create();t.vec3.scale(f,u,Math.abs(a));var q=l.vec3f32.create();t.vec3.scale(q,f,-.5);t.vec3.add(q,q,d);var w=l.vec3f32.fromValues(0,1,0);.2>Math.abs(1-t.vec3.dot(u,w))&&t.vec3.set(w,0,0,1);var v=l.vec3f32.create();t.vec3.cross(v,
u,w);t.vec3.normalize(v,v);t.vec3.cross(w,v,u);var x=2*b+(m?2:0),D=b+(m?2:0);a=new Float32Array(3*x);d=new Float32Array(3*D);var C=new Float32Array(2*x),E=new Uint32Array(3*b*(m?4:2)),J=new Uint32Array(3*b*(m?4:2));m&&(a[3*(x-2)+0]=q[0],a[3*(x-2)+1]=q[1],a[3*(x-2)+2]=q[2],C[2*(x-2)]=0,C[2*(x-2)+1]=0,a[3*(x-1)+0]=a[3*(x-2)+0]+f[0],a[3*(x-1)+1]=a[3*(x-2)+1]+f[1],a[3*(x-1)+2]=a[3*(x-2)+2]+f[2],C[2*(x-1)]=1,C[2*(x-1)+1]=1,d[3*(D-2)+0]=-u[0],d[3*(D-2)+1]=-u[1],d[3*(D-2)+2]=-u[2],d[3*(D-1)+0]=u[0],d[3*
(D-1)+1]=u[1],d[3*(D-1)+2]=u[2]);for(var u=function(e,n,k){E[e]=n;J[e]=k},p=0,L=l.vec3f32.create(),A=l.vec3f32.create(),k=0;k<b;k++){var e=2*Math.PI/b*k;t.vec3.scale(L,w,Math.sin(e));t.vec3.scale(A,v,Math.cos(e));t.vec3.add(L,L,A);d[3*k+0]=L[0];d[3*k+1]=L[1];d[3*k+2]=L[2];t.vec3.scale(L,L,c);t.vec3.add(L,L,q);a[3*k+0]=L[0];a[3*k+1]=L[1];a[3*k+2]=L[2];C[2*k+0]=k/b;C[2*k+1]=0;a[3*(k+b)+0]=a[3*k+0]+f[0];a[3*(k+b)+1]=a[3*k+1]+f[1];a[3*(k+b)+2]=a[3*k+2]+f[2];C[2*(k+b)+0]=k/b;C[2*k+1]=1;e=(k+1)%b;u(p++,
k,k);u(p++,k+b,k);u(p++,e,e);u(p++,e,e);u(p++,k+b,k);u(p++,e+b,e)}if(m){for(k=0;k<b;k++)e=(k+1)%b,u(p++,x-2,D-2),u(p++,k,D-2),u(p++,e,D-2);for(k=0;k<b;k++)e=(k+1)%b,u(p++,k+b,D-1),u(p++,x-1,D-1),u(p++,e+b,D-1)}c={};c[r.VertexAttrConstants.POSITION]=E;c[r.VertexAttrConstants.NORMAL]=J;c[r.VertexAttrConstants.UV0]=E;b={};b[r.VertexAttrConstants.POSITION]={size:3,data:a};b[r.VertexAttrConstants.NORMAL]={size:3,data:d};b[r.VertexAttrConstants.UV0]={size:2,data:C};return new h.GeometryData(b,c)};d.createTubeGeometry=
function(a,c,b,f,h){b=b||10;f=null!=f?f:!0;r.assert(1<a.length);for(var m=[],l=[],u=0;u<b;u++){m.push([0,-u-1,-((u+1)%b)-1]);var q=u/b*2*Math.PI;l.push([Math.cos(q)*c,Math.sin(q)*c])}return d.createPathExtrusionGeometry(l,a,[[0,0,0]],m,f,h)};d.createPathExtrusionGeometry=function(a,c,f,d,m,u){void 0===u&&(u=l.vec3f32.fromValues(0,0,0));var v=a.length,x=new Float32Array(c.length*v*3+(6*f.length||0)),D=new Float32Array(c.length*v+(2*f.length||0)),E=new Float32Array(c.length*v*3+(f?6:0)),J=(c.length-
1)*v*6+6*d.length,I=new Uint32Array(J),J=new Uint32Array(J),G=0,aa=0,K=0,p=0,L=0,A=l.vec3f32.create(),k=l.vec3f32.create(),e=l.vec3f32.create(),g=l.vec3f32.create(),n=l.vec3f32.create(),y=l.vec3f32.create(),B=l.vec3f32.create(),F=q.vec3f64.create(),H=l.vec3f32.create(),M=l.vec3f32.create(),X=l.vec3f32.create(),Z=l.vec3f32.create(),ca=l.vec3f32.create(),da=b.plane.create();t.vec3.set(H,0,1,0);t.vec3.subtract(k,c[1],c[0]);t.vec3.normalize(k,k);m?(t.vec3.add(F,c[0],u),t.vec3.normalize(e,F)):t.vec3.set(e,
0,0,1);C(k,e,H,H,n,e,w);t.vec3.copy(g,e);t.vec3.copy(Z,n);for(var ba=0;ba<f.length;ba++)t.vec3.scale(y,n,f[ba][0]),t.vec3.scale(F,e,f[ba][2]),t.vec3.add(y,y,F),t.vec3.add(y,y,c[0]),x[G++]=y[0],x[G++]=y[1],x[G++]=y[2],D[K++]=0;E[aa++]=-k[0];E[aa++]=-k[1];E[aa++]=-k[2];for(ba=0;ba<d.length;ba++)I[p++]=0<d[ba][0]?d[ba][0]:-d[ba][0]-1+f.length,I[p++]=0<d[ba][1]?d[ba][1]:-d[ba][1]-1+f.length,I[p++]=0<d[ba][2]?d[ba][2]:-d[ba][2]-1+f.length,J[L++]=0,J[L++]=0,J[L++]=0;for(var fa=f.length,ba=f.length-1,ea=
0;ea<c.length;ea++){var ka=!1;0<ea&&(t.vec3.copy(A,k),ea<c.length-1?(t.vec3.subtract(k,c[ea+1],c[ea]),t.vec3.normalize(k,k)):ka=!0,t.vec3.add(M,A,k),t.vec3.normalize(M,M),t.vec3.add(X,c[ea-1],g),b.plane.fromPositionAndNormal(c[ea],M,da),b.plane.intersectRay(da,b.ray.wrap(X,A),F)?(t.vec3.subtract(F,F,c[ea]),t.vec3.normalize(e,F),t.vec3.cross(n,M,e),t.vec3.normalize(n,n)):C(M,g,Z,H,n,e,w),t.vec3.copy(g,e),t.vec3.copy(Z,n));m&&(t.vec3.add(F,c[ea],u),t.vec3.normalize(ca,F));for(var O=0;O<v;O++)if(t.vec3.scale(y,
n,a[O][0]),t.vec3.scale(F,e,a[O][1]),t.vec3.add(y,y,F),t.vec3.normalize(B,y),E[aa++]=B[0],E[aa++]=B[1],E[aa++]=B[2],m?D[K++]=t.vec3.dot(y,ca):D[K++]=y[2],t.vec3.add(y,y,c[ea]),x[G++]=y[0],x[G++]=y[1],x[G++]=y[2],!ka){var ga=(O+1)%v;I[p++]=fa+O;I[p++]=fa+v+O;I[p++]=fa+ga;I[p++]=fa+ga;I[p++]=fa+v+O;I[p++]=fa+v+ga;for(ga=0;6>ga;ga++)J[L++]=I[p-6+ga]-ba}fa+=v}a=c[c.length-1];for(ba=0;ba<f.length;ba++)t.vec3.scale(y,n,f[ba][0]),t.vec3.scale(F,e,f[ba][1]),t.vec3.add(y,y,F),t.vec3.add(y,y,a),x[G++]=y[0],
x[G++]=y[1],x[G++]=y[2],D[K++]=0;f=aa/3;E[aa++]=k[0];E[aa++]=k[1];E[aa++]=k[2];v=fa-v;for(ba=0;ba<d.length;ba++)I[p++]=0<=d[ba][0]?fa+d[ba][0]:-d[ba][0]-1+v,I[p++]=0<=d[ba][2]?fa+d[ba][2]:-d[ba][2]-1+v,I[p++]=0<=d[ba][1]?fa+d[ba][1]:-d[ba][1]-1+v,J[L++]=f,J[L++]=f,J[L++]=f;d={};d[r.VertexAttrConstants.POSITION]=I;d[r.VertexAttrConstants.NORMAL]=J;I={};I[r.VertexAttrConstants.POSITION]={size:3,data:x};I.zOffset={size:1,data:D};I[r.VertexAttrConstants.NORMAL]={size:3,data:E};return new h.GeometryData(I,
d)};d.createPolylineGeometry=function(a,c){r.assert(1<a.length,"createPolylineGeometry(): polyline needs at least 2 points");r.assert(3===a[0].length,"createPolylineGeometry(): malformed vertex");r.assert(void 0===c||c.length===a.length,"createPolylineGeometry: need same number of points and normals");r.assert(void 0===c||3===c[0].length,"createPolylineGeometry(): malformed normal");for(var b=new Float64Array(3*a.length),f=new Uint32Array(2*(a.length-1)),d=0,m=0,l=0;l<a.length;l++){for(var u=0;3>
u;u++)b[d++]=a[l][u];0<l&&(f[m++]=l-1,f[m++]=l)}d={};m={};d[r.VertexAttrConstants.POSITION]=f;m[r.VertexAttrConstants.POSITION]={size:3,data:b};if(c){for(var b=new Float32Array(3*c.length),q=0,l=0;l<a.length;l++)for(u=0;3>u;u++)b[q++]=c[l][u];d[r.VertexAttrConstants.NORMAL]=f;m[r.VertexAttrConstants.NORMAL]={size:3,data:b}}return new h.GeometryData(m,d,h.GeometryData.DefaultOffsets,"line")};d.createExtrudedTriangle=function(a,c,b,f){var d,m,l=new Float32Array(18);a=[[-c,0,f/2],[b,0,f/2],[0,a,f/2],
[-c,0,-f/2],[b,0,-f/2],[0,a,-f/2]];for(c=0;6>c;c++)l[3*c]=a[c][0],l[3*c+1]=a[c][1],l[3*c+2]=a[c][2];a=(d={},d[r.VertexAttrConstants.POSITION]=new Uint32Array([0,1,2,3,0,2,2,5,3,1,4,5,5,2,1,1,0,3,3,4,1,4,3,5]),d);d=(m={},m[r.VertexAttrConstants.POSITION]={size:3,data:l},m);return new h.GeometryData(d,a)};d.transformInPlace=function(a,c){a=a.vertexAttributes[r.VertexAttrConstants.POSITION].data;for(var b=0;b<a.length;b+=3)t.vec3.set(v,a[b],a[b+1],a[b+2]),t.vec3.transformMat4(v,v,c),a[b]=v[0],a[b+1]=
v[1],a[b+2]=v[2]};d.addVertexColors=function(a,c){var b=c||[1,1,1,1];c=new Uint8Array(4);c[0]=255*b[0];c[1]=255*b[1];c[2]=255*b[2];c[3]=255*(3<b.length?b[3]:1);var b={},f=a.getVertexAttr(),d;for(d in f)b[d]=f[d];b[r.VertexAttrConstants.COLOR]={size:4,data:c};c={};for(d in a.indices)c[d]=a.indices[d];c[r.VertexAttrConstants.COLOR]=new Uint32Array(c[r.VertexAttrConstants.POSITION].length);return a=new h.GeometryData(b,c,a.componentOffsets,a.primitiveType)};d.addNormals=function(a){var c=a.getVertexAttr();
a=a.indices;for(var b=f.Vec3Compact.subtract,d=new Float32Array(a.position.length/3*3),h=c.position.data,m=0,l=a.position,u=new Uint32Array(l.length),q=0;q<l.length;q+=3){b(h,3*l[q],h,3*l[q+2],E,0);b(h,3*l[q],h,3*l[q+1],v,0);t.vec3.cross(v,v,E);t.vec3.normalize(v,v);var w=m/3;d[m++]=v[0];d[m++]=v[1];d[m++]=v[2];u[q]=w;u[q+1]=w;u[q+2]=w}c[r.VertexAttrConstants.NORMAL]={size:3,data:d,offsetIdx:0,strideIdx:3};a[r.VertexAttrConstants.NORMAL]=u};d.cgToGIS=function(a,c){void 0===c&&(c=a);var b=a.getVertexAttr();
a=b.position.data;var b=b.normal.data,f=c.getVertexAttr(),d=f.position.data,f=f.normal.data;if(b)for(var h=0;h<b.length;h+=3){var m=b[h+1];f[h+1]=-b[h+2];f[h+2]=m}if(a)for(h=0;h<a.length;h+=3)m=a[h+1],d[h+1]=-a[h+2],d[h+2]=m;return c};d.makeOrthoBasisDirUp=D;d.makeOrthoBasisDirUpFallback=C})(D||(D={}));var w=.99619469809,v=l.vec3f32.create(),E=l.vec3f32.create();return D})},"esri/core/libs/gl-matrix-2/vec3f32":function(){define(["require","exports","./factories/vec3f32"],function(z,d,t){Object.defineProperty(d,
"__esModule",{value:!0});d.vec3f32=t})},"esri/core/libs/gl-matrix-2/factories/vec3f32":function(){define(["require","exports"],function(z,d){function t(){return new Float32Array(3)}function l(b,c,a){var f=new Float32Array(3);f[0]=b;f[1]=c;f[2]=a;return f}function q(){return l(1,1,1)}function b(){return l(1,0,0)}function f(){return l(0,1,0)}function h(){return l(0,0,1)}Object.defineProperty(d,"__esModule",{value:!0});d.create=t;d.clone=function(b){var c=new Float32Array(3);c[0]=b[0];c[1]=b[1];c[2]=
b[2];return c};d.fromValues=l;d.createView=function(b,c){return new Float32Array(b,c,3)};d.zeros=function(){return t()};d.ones=q;d.unitX=b;d.unitY=f;d.unitZ=h;d.ZEROS=t();d.ONES=q();d.UNIT_X=b();d.UNIT_Y=f();d.UNIT_Z=h()})},"esri/views/3d/support/geometryUtils":function(){define("require exports ./geometryUtils/axisAngle ./geometryUtils/boundedPlane ./geometryUtils/clipRay ./geometryUtils/frustum ./geometryUtils/lineSegment ./geometryUtils/plane ./geometryUtils/ray ./geometryUtils/sphere ./geometryUtils/triangle ./geometryUtils/vector".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m){Object.defineProperty(d,"__esModule",{value:!0});d.plane=h;d.boundedPlane=l;d.triangle=a;d.lineSegment=f;d.ray=r;d.clipRay=q;d.sphere=c;d.frustum=b;d.vector=m;d.axisAngle=t})},"esri/views/3d/support/geometryUtils/axisAngle":function(){define(["require","exports","../../../../core/libs/gl-matrix-2/vec3","../stack","./vector"],function(z,d,t,l,q){function b(b){void 0===b&&(b=d.UP);return[b[0],b[1],b[2],b[3]]}function f(f,d,c,a,m){void 0===m&&(m=b());m[0]=f;m[1]=d;m[2]=
c;m[3]=a;return m}Object.defineProperty(d,"__esModule",{value:!0});d.create=b;d.wrap=function(b,d,c,a){return f(b,d,c,a,l.sv4d.get())};d.wrapAxisAngle=function(b,d){return f(b[0],b[1],b[2],d,l.sv4d.get())};d.copy=function(d,l){void 0===l&&(l=b());return f(d[0],d[1],d[2],d[3],l)};d.fromValues=f;d.fromAxisAndAngle=function(f,d,c){void 0===c&&(c=b());t.vec3.copy(c,f);c[3]=d;return c};d.fromPoints=function(f,d,c){void 0===c&&(c=b());t.vec3.cross(c,f,d);t.vec3.normalize(c,c);c[3]=q.angle(f,d);return c};
d.UP=[0,0,1,0]})},"esri/views/3d/support/geometryUtils/vector":function(){define(["require","exports","../../../../core/mathUtils","../../../../core/libs/gl-matrix-2/vec3"],function(z,d,t,l){Object.defineProperty(d,"__esModule",{value:!0});d.projectPoint=function(d,b,f){b=l.vec3.dot(d,b)/l.vec3.dot(d,d);return l.vec3.scale(f,d,b)};d.projectPointSignedLength=function(d,b){return l.vec3.dot(d,b)/l.vec3.length(d)};d.angle=function(d,b){d=l.vec3.dot(d,b)/(l.vec3.length(d)*l.vec3.length(b));return-t.acosClamped(d)}})},
"esri/views/3d/support/geometryUtils/boundedPlane":function(){define("require exports ../../../../core/compilerUtils ../../../../core/Logger ../../../../core/mathUtils ../../../../core/ObjectStack ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../mathUtils ../stack ./lineSegment ./plane ./ray ./vector".split(" "),function(z,d,t,l,q,b,f,h,r,c,a,m,u,D,w,v){function E(e){void 0===e&&(e=
d.UP);return{plane:D.create(e.plane),origin:c.vec3f64.clone(e.origin),basis1:c.vec3f64.clone(e.basis1),basis2:c.vec3f64.clone(e.basis2)}}function C(e,g){void 0===g&&(g=E());return J(e.origin,e.basis1,e.basis2,g)}function J(e,g,n,k){void 0===k&&(k=E());r.vec3.copy(k.origin,e);r.vec3.copy(k.basis1,g);r.vec3.copy(k.basis2,n);D.fromVectorsAndPoint(n,g,e,k.plane);e=k;1E-6<Math.abs(r.vec3.dot(e.basis1,e.basis2)/(r.vec3.length(e.basis1)*r.vec3.length(e.basis2)))&&T.warn("fromValues()","Provided basis vectors are not perpendicular");
1E-6<Math.abs(r.vec3.dot(e.basis1,e.plane))&&T.warn("fromValues()","Basis vectors and plane normal are not perpendicular");1E-6<Math.abs(-r.vec3.dot(e.plane,e.origin)-e.plane[3])&&T.warn("fromValues()","Plane offset is not consistent with plane origin");return k}function K(e,g,n){e!==n&&C(e,n);e=r.vec3.scale(m.sv3d.get(),e.plane,g);r.vec3.add(n.origin,n.origin,e);n.plane[3]-=g;return n}function G(e,g){void 0===g&&(g=E());var n=(e[2]-e[0])/2,k=(e[3]-e[1])/2;r.vec3.set(g.origin,e[0]+n,e[1]+k,0);r.vec3.set(g.basis1,
n,0,0);r.vec3.set(g.basis2,0,k,0);D.fromValues(0,0,1,0,g.plane);return g}function I(e,g,n){return D.intersectRay(e.plane,g,n)?Q(e,n):!1}function x(e,g,n){var k=aa.get(),p=aa.get();Y(e,g,k,p);for(var p=Number.POSITIVE_INFINITY,c=0,b=A;c<b.length;c++){var f=V(e,b[c],W.get()),d=m.sv3d.get();D.intersectLineSegment(k,f,d)&&(f=a.directionFromTo(m.sv3d.get(),g.origin,d),f=Math.abs(q.acosClamped(r.vec3.dot(g.direction,f))),f<p&&(p=f,r.vec3.copy(n,d)))}return p===Number.POSITIVE_INFINITY?N(e,g,n):n}function N(e,
g,n){if(I(e,g,n))return n;var k=aa.get(),a=aa.get();Y(e,g,k,a);for(var p=Number.POSITIVE_INFINITY,c=0,b=A;c<b.length;c++){var f=V(e,b[c],W.get()),d=m.sv3d.get();D.intersectLineSegmentClamp(k,f,d)&&(f=w.distance2(g,d),D.isPointInside(a,d)&&f<p&&(p=f,r.vec3.copy(n,d)))}S(e,g.origin)<p&&O(e,g.origin,n);return n}function O(e,g,n){var k=D.projectPoint(e.plane,g,m.sv3d.get());g=u.projectPointClamp(U(e,e.basis1),k,-1,1,m.sv3d.get());k=u.projectPointClamp(U(e,e.basis2),k,-1,1,m.sv3d.get());r.vec3.subtract(n,
r.vec3.add(m.sv3d.get(),g,k),e.origin);return n}function P(e,g,n){var k=e.origin,a=e.basis1,p=e.basis2;g=r.vec3.subtract(m.sv3d.get(),g,k);a=v.projectPointSignedLength(a,g);p=v.projectPointSignedLength(p,g);e=v.projectPointSignedLength(e.plane,g);return r.vec3.set(n,a,p,e)}function S(e,g){g=P(e,g,m.sv3d.get());var n=e.basis2;e=r.vec3.length(e.basis1);n=r.vec3.length(n);e=Math.max(Math.abs(g[0])-e,0);n=Math.max(Math.abs(g[1])-n,0);g=g[2];return e*e+n*n+g*g}function R(e,g){var n=-e.plane[3];return v.projectPointSignedLength(e.plane,
g)-n}function Q(e,g){var n=r.vec3.subtract(m.sv3d.get(),g,e.origin);g=r.vec3.squaredLength(e.basis1);var k=r.vec3.squaredLength(e.basis2),a=r.vec3.dot(e.basis1,n);e=r.vec3.dot(e.basis2,n);return 0>-a-g&&0>a-g&&0>-e-k&&0>e-k}function U(e,g){var n=W.get();r.vec3.copy(n.origin,e.origin);r.vec3.copy(n.vector,g);return n}function V(e,g,n){var k=e.basis1,a=e.basis2;e=e.origin;var p=r.vec3.scale(m.sv3d.get(),k,g.origin[0]),c=r.vec3.scale(m.sv3d.get(),a,g.origin[1]);r.vec3.add(n.origin,p,c);r.vec3.add(n.origin,
n.origin,e);k=r.vec3.scale(m.sv3d.get(),k,g.direction[0]);g=r.vec3.scale(m.sv3d.get(),a,g.direction[1]);r.vec3.scale(n.vector,r.vec3.add(k,k,g),2);return n}function Y(e,g,n,k){e=e.plane;D.fromVectorsAndPoint(e,g.direction,g.origin,n);D.fromVectorsAndPoint(n,e,g.origin,k)}Object.defineProperty(d,"__esModule",{value:!0});var T=l.getLogger("esri.views.3d.support.geometryUtils.boundedPlane");z=function(){return function(){this.plane=D.create();this.origin=c.vec3f64.create();this.basis1=c.vec3f64.create();
this.basis2=c.vec3f64.create()}}();d.BoundedPlaneClass=z;d.create=E;d.wrap=function(e,g,n){var k=L.get();k.origin=e;k.basis1=g;k.basis2=n;k.plane=D.fromVectorsAndPoint(n,g,e,D.wrap(0,0,0,0));return k};d.copy=C;d.fromValues=J;d.elevate=K;d.setExtent=function(e,g,n){G(g,n);K(n,R(e,e.origin),n);return n};d.fromAABoundingRect=G;d.intersectRay=I;d.intersectRayClosestSilhouette=function(e,g,n){if(I(e,g,n))return n;e=x(e,g,m.sv3d.get());r.vec3.add(n,g.origin,r.vec3.scale(m.sv3d.get(),g.direction,r.vec3.distance(g.origin,
e)/r.vec3.length(g.direction)));return n};d.closestPointOnSilhouette=x;d.closestPoint=N;d.projectPoint=O;d.projectPointLocal=P;d.distance2=S;d.distance=function(e,g){return Math.sqrt(S(e,g))};d.distanceToSilhouette=function(e,g){for(var n=Number.NEGATIVE_INFINITY,k=0,a=A;k<a.length;k++){var p=V(e,a[k],W.get()),p=u.distance2(p,g);p>n&&(n=p)}return Math.sqrt(n)};d.extrusionContainsPoint=function(e,g){return D.isPointInside(e.plane,g)&&Q(e,g)};d.axisAt=function(e,g,n,k){switch(n){case 0:r.vec3.copy(k,
e.basis1);r.vec3.normalize(k,k);break;case 1:r.vec3.copy(k,e.basis2);r.vec3.normalize(k,k);break;case 2:r.vec3.copy(k,e.plane);break;default:t.neverReached(n)}return k};d.altitudeAt=R;d.setAltitudeAt=function(e,g,n,k){var y=R(e,g);e=r.vec3.scale(p,e.plane,n-y);r.vec3.add(k,g,e);return k};d.transform=function(e,g,n){e!==n&&C(e,n);f.mat4.invert(k,g);f.mat4.transpose(k,k);r.vec3.transformMat4(n.basis1,e.basis1,k);r.vec3.transformMat4(n.basis2,e.basis2,k);r.vec3.transformMat4(n.plane,e.plane,k);r.vec3.transformMat4(n.origin,
e.origin,g);D.setOffsetFromPoint(n.plane,n.origin,n.plane);return n};d.UP={plane:D.create(),origin:c.vec3f64.fromValues(0,0,0),basis1:c.vec3f64.fromValues(1,0,0),basis2:c.vec3f64.fromValues(0,1,0)};var aa=new b.ObjectStack(D.create),W=new b.ObjectStack(u.create),p=c.vec3f64.create(),L=new b.ObjectStack(function(){return{origin:null,basis1:null,basis2:null,plane:null}}),A=[{origin:[-1,-1],direction:[1,0]},{origin:[1,-1],direction:[0,1]},{origin:[1,1],direction:[-1,0]},{origin:[-1,1],direction:[0,-1]}],
k=h.mat4f64.create()})},"esri/views/3d/support/geometryUtils/plane":function(){define(["require","exports","../../../../core/mathUtils","../../../../core/libs/gl-matrix-2/vec3","../stack"],function(z,d,t,l,q){function b(a){void 0===a&&(a=d.UP);return[a[0],a[1],a[2],a[3]]}function f(a,c){void 0===c&&(c=b());return h(a[0],a[1],a[2],a[3],c)}function h(a,c,f,d,h){void 0===h&&(h=b());h[0]=a;h[1]=c;h[2]=f;h[3]=d;return h}function r(a,f,d){void 0===d&&(d=b());l.vec3.copy(d,f);f=l.vec3.dot(f,f);1E-5<Math.abs(f-
1)&&1E-12<f&&l.vec3.scale(d,d,1/Math.sqrt(f));c(d,a,d);return d}function c(a,c,b){a!==b&&f(a,b);b[3]=-l.vec3.dot(b,c);return b}function a(a,c,f,d){void 0===d&&(d=b());a=l.vec3.cross(q.sv3d.get(),c,a);return r(f,a,d)}function m(a,c,b){a=l.vec3.scale(q.sv3d.get(),a,l.vec3.dot(a,c));l.vec3.subtract(b,c,a);return b}function u(a,c){return l.vec3.dot(a,c)+a[3]}function D(a,c,b,f,d,h){var m=l.vec3.dot(a,b);if(0===m)return!1;a=-(l.vec3.dot(a,c)+a[3])/m;d&&(a=f?Math.max(0,a):t.clamp(a,0,1));if(0>a||!f&&1<
a)return!1;l.vec3.add(h,c,l.vec3.scale(h,b,a));return!0}Object.defineProperty(d,"__esModule",{value:!0});d.create=b;d.wrap=function(a,c,b,f){return h(a,c,b,f,q.sv4d.get())};d.copy=f;d.fromValues=h;d.fromNormalAndOffset=function(a,c,f){void 0===f&&(f=b());l.vec3.copy(f,a);f[3]=c;return f};d.fromPositionAndNormal=r;d.fromPoints=function(c,f,d,h){void 0===h&&(h=b());return a(l.vec3.subtract(q.sv3d.get(),c,f),l.vec3.subtract(q.sv3d.get(),d,f),c,h)};d.setOffsetFromPoint=c;d.negate=function(a,c){c[0]=-a[0];
c[1]=-a[1];c[2]=-a[2];c[3]=-a[3];return c};d.fromVectorsAndPoint=a;d.intersectRay=function(a,c,b){return D(a,c.origin,c.direction,!0,!1,b)};d.intersectLineSegment=function(a,c,b){return D(a,c.origin,c.vector,!1,!1,b)};d.intersectLineSegmentClamp=function(a,c,b){return D(a,c.origin,c.vector,!1,!0,b)};d.isSphereFullyInside=function(a,c){var b=c.radius;return 0<=u(a,c.center)-b};d.isSphereFullyOutside=function(a,c){var b=c.radius;return 0>u(a,c.center)+b};d.isPointInside=function(a,c){return 0<=u(a,
c)};d.isPointOutside=function(a,c){return 0>u(a,c)};d.isAABBFullyInside=function(a,c){var b=c[0],f=c[1],d=c[2],h=c[3],m=c[4];c=c[5];return 0<=a[0]*(0<a[0]?b:h)+a[1]*(0<a[1]?f:m)+a[2]*(0<a[2]?d:c)+a[3]};d.clip=function(a,c){var b=l.vec3.dot(a,c.ray.direction);a=-u(a,c.ray.origin);if(0>a&&0<=b)return!1;if(-1E-6<b&&1E-6>b)return 0<a;if((0>a||0>b)&&!(0>a&&0>b))return!0;a/=b;0<b?a<c.c1&&(c.c1=a):a>c.c0&&(c.c0=a);return c.c0<=c.c1};d.clipInfinite=function(a,c){var b=l.vec3.dot(a,c.ray.direction);a=-u(a,
c.ray.origin);if(-1E-6<b&&1E-6>b)return 0<a;a/=b;0<b?a<c.c1&&(c.c1=a):a>c.c0&&(c.c0=a);return c.c0<=c.c1};d.projectPoint=function(a,c,b){var f=l.vec3.scale(q.sv3d.get(),a,-a[3]);c=l.vec3.subtract(q.sv3d.get(),c,f);a=m(a,c,q.sv3d.get());l.vec3.add(b,a,f);return b};d.projectVector=m;d.distance=function(a,c){return Math.abs(u(a,c))};d.signedDistance=u;d.UP=[0,0,1,0]})},"esri/views/3d/support/geometryUtils/ray":function(){define("require exports ../../../../core/ObjectStack ../../../../core/screenUtils ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../stack".split(" "),
function(z,d,t,l,q,b,f,h){function r(a){return a?{origin:f.vec3f64.clone(a.origin),direction:f.vec3f64.clone(a.direction)}:{origin:f.vec3f64.create(),direction:f.vec3f64.create()}}function c(a,c,f){void 0===f&&(f=r());b.vec3.copy(f.origin,a);b.vec3.copy(f.direction,c);return f}function a(a,c,f){void 0===f&&(f=r());var d=l.castRenderScreenPointArray3(q.vec2.copy(h.sv3d.get(),c));d[2]=0;a.unprojectPoint(d,f.origin);c=l.castRenderScreenPointArray3(q.vec2.copy(h.sv3d.get(),c));c[2]=1;a=a.unprojectPoint(c,
h.sv3d.get());b.vec3.subtract(f.direction,a,f.origin);return f}function m(a,c,f){void 0===f&&(f=r());b.vec3.copy(f.origin,a.eye);c=b.vec3.set(h.sv3d.get(),c[0],c[1],1);a=a.unprojectPoint(c,h.sv3d.get());b.vec3.subtract(f.direction,a,f.origin);return f}function u(a,c){a=b.vec3.cross(h.sv3d.get(),b.vec3.normalize(h.sv3d.get(),a.direction),b.vec3.subtract(h.sv3d.get(),c,a.origin));return b.vec3.dot(a,a)}function D(){return{origin:null,direction:null}}Object.defineProperty(d,"__esModule",{value:!0});
d.create=r;d.wrap=function(a,c){var b=w.get();b.origin=a;b.direction=c;return b};d.copy=function(a,b){void 0===b&&(b=r());return c(a.origin,a.direction,b)};d.fromPoints=function(a,c,f){void 0===f&&(f=r());b.vec3.copy(f.origin,a);b.vec3.subtract(f.direction,c,a);return f};d.fromValues=c;d.fromScreen=function(c,b,f){void 0===f&&(f=r());return a(c,c.screenToRender(b,l.castRenderScreenPointArray3(h.sv3d.get())),f)};d.fromRender=a;d.fromScreenAtEye=function(a,c,b){void 0===b&&(b=r());return m(a,a.screenToRender(c,
l.castRenderScreenPointArray3(h.sv3d.get())),b)};d.fromRenderAtEye=m;d.distance2=u;d.distance=function(a,c){return Math.sqrt(u(a,c))};d.closestPoint=function(a,c,f){c=b.vec3.dot(a.direction,b.vec3.subtract(f,c,a.origin));b.vec3.add(f,a.origin,b.vec3.scale(f,a.direction,c));return f};d.createWrapper=D;var w=new t.ObjectStack(D)})},"esri/views/3d/support/geometryUtils/clipRay":function(){define("require exports ../../../../core/ObjectStack ../../../../core/libs/gl-matrix-2/vec3 ../stack ./ray".split(" "),
function(z,d,t,l,q,b){function f(a){return a?{ray:b.create(a.ray),c0:a.c0,c1:a.c1}:{ray:b.create(),c0:0,c1:Number.MAX_VALUE}}function h(a,c,d,h){void 0===h&&(h=f());b.copy(a,h.ray);h.c0=c;h.c1=d;return h}function r(a,c,d){void 0===d&&(d=f());var h=l.vec3.length(a.vector);b.fromValues(a.origin,c,d.ray);d.c0=0;d.c1=h;return d}function c(a,c,b){return l.vec3.add(b,a.ray.origin,l.vec3.scale(b,a.ray.direction,c))}Object.defineProperty(d,"__esModule",{value:!0});d.create=f;d.wrap=function(c,b,f){var d=
a.get();d.ray=c;d.c0=b;d.c1=f;return d};d.copy=function(a,c){void 0===c&&(c=f());return h(a.ray,a.c0,a.c1,c)};d.fromValues=h;d.fromRay=function(a,c){void 0===c&&(c=f());b.copy(a,c.ray);c.c0=0;c.c1=Number.MAX_VALUE;return c};d.fromLineSegment=function(a,c){void 0===c&&(c=f());var b=l.vec3.normalize(q.sv3d.get(),a.vector);return r(a,b,c)};d.fromLineSegmentAndDirection=r;d.getStart=function(a,b){return c(a,a.c0,b)};d.getEnd=function(a,b){return c(a,a.c1,b)};d.getAt=c;var a=new t.ObjectStack(function(){return{c0:0,
c1:0,ray:null}})})},"esri/views/3d/support/geometryUtils/frustum":function(){define("require exports ../../../../core/ObjectStack ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../core/libs/gl-matrix-2/vec4 ../../../../core/libs/gl-matrix-2/vec4f64 ../stack ./clipRay ./plane".split(" "),function(z,d,t,l,q,b,f,h,r,c,a){function m(c){if(c){var f=c.planes;c=c.points;return{planes:[a.create(f[0]),a.create(f[1]),a.create(f[2]),
a.create(f[3]),a.create(f[4]),a.create(f[5])],points:[b.vec3f64.clone(c[0]),b.vec3f64.clone(c[1]),b.vec3f64.clone(c[2]),b.vec3f64.clone(c[3]),b.vec3f64.clone(c[4]),b.vec3f64.clone(c[5]),b.vec3f64.clone(c[6]),b.vec3f64.clone(c[7])]}}return{planes:[a.create(),a.create(),a.create(),a.create(),a.create(),a.create()],points:[b.vec3f64.create(),b.vec3f64.create(),b.vec3f64.create(),b.vec3f64.create(),b.vec3f64.create(),b.vec3f64.create(),b.vec3f64.create(),b.vec3f64.create()]}}function u(c,b,f){void 0===
f&&(f=m());for(var d=0;6>d;d++)a.copy(c[d],f.planes[d]);for(d=0;8>d;d++)q.vec3.copy(f.points[d],b[d]);return f}function D(c){var b=c.planes;c=c.points;a.fromPoints(c[4],c[0],c[3],b[0]);a.fromPoints(c[1],c[5],c[6],b[1]);a.fromPoints(c[4],c[5],c[1],b[2]);a.fromPoints(c[3],c[2],c[6],b[3]);a.fromPoints(c[0],c[1],c[2],b[4]);a.fromPoints(c[5],c[4],c[7],b[5])}function w(c,b){for(var f=0;6>f;f++)if(!a.clip(c[f],b))return!1;return!0}Object.defineProperty(d,"__esModule",{value:!0});d.create=m;d.copy=function(a,
c){void 0===c&&(c=m());return u(a.planes,a.points,c)};d.fromValues=u;d.fromMatrix=function(a,c,b){void 0===b&&(b=m());var d=b.points;a=l.mat4.multiply(r.sm4d.get(),c,a);l.mat4.invert(a,a);for(c=0;8>c;++c){var h=f.vec4.transformMat4(r.sv4d.get(),v[c],a);q.vec3.set(d[c],h[0]/h[3],h[1]/h[3],h[2]/h[3])}D(b);return b};d.recomputePlanes=D;d.intersectsSphere=function(c,b){for(var f=0;6>f;f++)if(a.isSphereFullyInside(c[f],b))return!1;return!0};d.intersectsRay=function(a,b){return w(a,c.fromRay(b,E.get()))};
d.intersectClipRay=function(c,b){for(var f=0;6>f;f++)if(!a.clipInfinite(c[f],b))return!1;return!0};d.intersectsLineSegment=function(a,b,f){return w(a,c.fromLineSegmentAndDirection(b,f,E.get()))};d.intersectsPoint=function(c,b){for(var f=0;6>f;f++)if(0<a.signedDistance(c[f],b))return!1;return!0};d.intersectsAABB=function(c,b){for(var f=0;6>f;f++)if(a.isAABBFullyInside(c[f],b))return!1;return!0};d.planePointIndices={bottom:[5,1,0,4],near:[0,1,2,3],far:[5,4,7,6],right:[1,5,6,2],left:[4,0,3,7],top:[7,
3,2,6]};var v=[h.vec4f64.fromValues(-1,-1,-1,1),h.vec4f64.fromValues(1,-1,-1,1),h.vec4f64.fromValues(1,1,-1,1),h.vec4f64.fromValues(-1,1,-1,1),h.vec4f64.fromValues(-1,-1,1,1),h.vec4f64.fromValues(1,-1,1,1),h.vec4f64.fromValues(1,1,1,1),h.vec4f64.fromValues(-1,1,1,1)],E=new t.ObjectStack(c.create)})},"esri/views/3d/support/geometryUtils/sphere":function(){define("require exports ../../../../core/compilerUtils ../../../../core/Logger ../../../../core/mathUtils ../../../../core/ObjectStack ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../geometryUtils ../mathUtils ../stack ./ray".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u){function D(a){return a?{radius:a.radius,center:r.vec3f64.clone(a.center)}:{radius:1,center:r.vec3f64.create()}}function w(a,c){void 0===c&&(c=D());return v(a.radius,a.center,c)}function v(a,c,b){void 0===b&&(b=D());h.vec3.copy(b.center,c);b.radius=a;return b}function E(a,c,b){var f=h.vec3.subtract(m.sv3d.get(),c.origin,a.center),d=h.vec3.dot(c.direction,c.direction),l=2*h.vec3.dot(c.direction,f);a=h.vec3.dot(f,f)-a.radius*a.radius;a=l*l-4*d*a;if(0>a)return!1;f=
Math.sqrt(a);a=(-l-f)/(2*d);d=(-l+f)/(2*d);if(0>a||d<a&&0<d)a=d;if(0>a)return!1;b&&h.vec3.add(b,c.origin,h.vec3.scale(m.sv3d.get(),c.direction,a));return!0}function C(a,b,d){var l=m.sv3d.get(),r=m.sm4d.get();h.vec3.cross(l,b.origin,b.direction);h.vec3.cross(d,l,b.origin);h.vec3.scale(d,d,1/h.vec3.length(d)*a.radius);a=K(a,b.origin);b=c.vector.angle(b.origin,d);f.mat4.identity(r);f.mat4.rotate(r,r,b+a,l);h.vec3.transformMat4(d,d,r);return d}function J(a,c,b){c=h.vec3.subtract(m.sv3d.get(),c,a.center);
c=h.vec3.scale(m.sv3d.get(),c,a.radius/h.vec3.length(c));return h.vec3.add(b,c,a.center)}function K(a,c){c=h.vec3.subtract(m.sv3d.get(),c,a.center);c=h.vec3.length(c);return q.acosClamped(a.radius/(a.radius+Math.abs(a.radius-c)))}function G(c,b,f,d){c=h.vec3.subtract(N,b,c.center);switch(f){case 0:return c=a.cartesianToSpherical(c,N),c=c[2],h.vec3.set(d,-Math.sin(c),Math.cos(c),0);case 1:return c=a.cartesianToSpherical(c,N),f=c[1],c=c[2],b=Math.sin(f),h.vec3.set(d,-b*Math.cos(c),-b*Math.sin(c),Math.cos(f));
case 2:return h.vec3.normalize(d,c);default:t.neverReached(f)}}function I(a,c){c=h.vec3.subtract(R,c,a.center);return h.vec3.length(c)-a.radius}Object.defineProperty(d,"__esModule",{value:!0});var x=l.getLogger("esri.views.3d.support.geometryUtils.sphere");d.create=D;d.wrap=function(a,c){var b=O.get();b.radius=a;b.center=c||S;return b};d.copy=w;d.fromValues=v;d.elevate=function(a,c,b){a!==b&&h.vec3.copy(b.center,a.center);b.radius=a.radius+c;return b};d.setExtent=function(a,c,b){x.error("sphere.setExtent is not yet supported");
return a===b?b:w(a,b)};d.intersectRay=E;d.intersectScreen=function(a,c,b,f){c=u.fromScreenAtEye(c,b,P);return E(a,c,f)};d.intersectsRay=function(a,c){return E(a,c,null)};d.intersectRayClosestSilhouette=function(a,c,b){if(E(a,c,b))return b;a=C(a,c,m.sv3d.get());h.vec3.add(b,c.origin,h.vec3.scale(m.sv3d.get(),c.direction,h.vec3.distance(c.origin,a)/h.vec3.length(c.direction)));return b};d.closestPointOnSilhouette=C;d.closestPoint=function(a,c,b){if(E(a,c,b))return b;u.closestPoint(c,a.center,b);return J(a,
b,b)};d.projectPoint=J;d.distanceToSilhouette=function(a,c){c=h.vec3.subtract(m.sv3d.get(),c,a.center);c=h.vec3.squaredLength(c);return Math.sqrt(Math.abs(c-a.radius*a.radius))};d.angleToSilhouette=K;var N=r.vec3f64.create();d.axisAt=G;d.altitudeAt=I;d.setAltitudeAt=function(a,c,b,f){var d=I(a,c);a=G(a,c,2,R);b=h.vec3.scale(R,a,b-d);h.vec3.add(f,c,b);return f};var O=new b.ObjectStack(function(){return{center:null,radius:0}}),P=u.create(),S=r.vec3f64.create(),R=r.vec3f64.create();Object.freeze(S)})},
"esri/views/3d/webgl-engine/lib/GeometryData":function(){define(["require","exports","./ComponentUtils","./geometryDataUtils","./Util"],function(z,d,t,l,q){Object.defineProperty(d,"__esModule",{value:!0});z=function(){function b(f,d,r,c){void 0===d&&(d=b.DefaultIndices);void 0===r&&(r=b.DefaultOffsets);void 0===c&&(c="triangle");var a={},h;for(h in f){var u=f[h],D=u.size;a[h]={data:u.data,size:D,offsetIdx:0,strideIdx:D}}if(d===b.DefaultIndices){d=q.getFirstObjectValue(a);d=null==d?0:d.data.length/
d.size;f=l.generateDefaultIndexArray(d);d={};for(var w in a)d[w]=f}this._id=l.getNewId();this._vertexAttributes=a;this._indices=d;this._componentOffsets=t.createOffsets(r);this._primitiveType=c}Object.defineProperty(b.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"vertexAttributes",{get:function(){return this._vertexAttributes},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"indices",{get:function(){return this._indices},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"componentOffsets",{get:function(){return this._componentOffsets},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"indexCount",{get:function(){var b=q.getFirstObjectValue(this._indices);return null==b?0:b.length},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"primitiveType",{get:function(){return this._primitiveType},enumerable:!0,configurable:!0});b.prototype.getVertexAttr=function(){return this.vertexAttributes};
b.prototype.toRenderData=function(){return{id:this._id.toString(),indices:this._indices,vertexAttr:this._vertexAttributes}};b.prototype.getIndices=function(b){return this._indices[b]};b.prototype.getAttribute=function(b){return this._vertexAttributes[b]};b.prototype.estimateGpuMemoryUsage=function(){var b=0;this._indices[q.VertexAttrConstants.POSITION]&&(b+=12*this._indices[q.VertexAttrConstants.POSITION].length);this._indices[q.VertexAttrConstants.NORMAL]&&(b+=12*this._indices[q.VertexAttrConstants.NORMAL].length);
this._indices[q.VertexAttrConstants.UV0]&&(b+=8*this._indices[q.VertexAttrConstants.UV0].length);this._indices[q.VertexAttrConstants.COLOR]&&(b+=4*this._indices[q.VertexAttrConstants.COLOR].length);return b};b.DefaultIndices={};b.DefaultOffsets=new Uint32Array(0);return b}();d.GeometryData=z})},"esri/views/3d/webgl-engine/lib/lodRendering/LodResources":function(){define(["require","exports","../../../../../core/arrayUtils"],function(z,d,t){function l(d){var b=[];d.components.forEach(function(f){b.push(f.geometry)});
return t.unique(b)}Object.defineProperty(d,"__esModule",{value:!0});d.materialsFromLodResources=function(d){var b=[];d.levels.forEach(function(f){f.components.forEach(function(f){b.push(f.material)})});return t.unique(b)};d.texturesFromLodResources=function(d){var b=[];d.levels.forEach(function(f){f.components.forEach(function(f){f.textures&&b.push.apply(b,f.textures)})});return t.unique(b)};d.geometriesFromLodLevelResources=l;d.geometriesFromLodResources=function(d){var b=[];d.levels.forEach(function(f){f.components.forEach(function(f){b.push(f.geometry)})});
return t.unique(b)};d.computeFaceCount=function(d){var b=0;l(d).forEach(function(f){b+=f.data.indexCount/3});return b}})},"esri/views/3d/layers/graphics/pointUtils":function(){define("require exports ../../../../core/maybe ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../geometry/support/aaBoundingBox ../../../../geometry/support/coordsUtils ../../../../layers/graphics/dehydratedFeatures ./elevationAlignmentUtils ./graphicUtils ../../support/projectionUtils ../../webgl-engine/lib/Object3D".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m){Object.defineProperty(d,"__esModule",{value:!0});var u=q.vec3f64.create();d.createStageObjectForHUD=function(c,f,d,h,q,J,K,G,I,x,z){var w=d?d.length:0,v=c.clippingExtent;a.pointToVector(f,u,c.elevationProvider.spatialReference);if(t.isSome(v)&&!b.containsPoint(v,u))return null;a.pointToVector(f,u,c.renderCoordsHelper.spatialReference);v=c.localOriginFactory.getOrigin(u);G=new m({castShadow:!1,metadata:{layerUid:I,graphicUid:x,usesVerticalDistanceToGround:!0},idHint:G});
for(I=0;I<w;I++)G.addGeometry(d[I],h[I],q?q[I]:l.mat4f64.IDENTITY,J,v,z);c=r.applyElevationAlignmentForHUD(G,f,c.elevationProvider,c.renderCoordsHelper,K);return{object:G,sampledElevation:c}};d.extendPointGraphicElevationContext=function(c,b,f){c=c.elevationContext;f=f.spatialReference;a.pointToVector(b,u,f);c.centerPointInElevationSR=h.makeDehydratedPoint(u[0],u[1],b.hasZ?u[2]:0,f)};d.placePointOnGeometry=function(a){switch(a.type){case "point":return a;case "polygon":case "extent":return c.computeCentroid(a);
case "polyline":var b=a.paths[0];if(!b||0===b.length)break;b=f.getPointOnPath(b,f.getPathLength(b)/2);return h.makeDehydratedPoint(b[0],b[1],b[2],a.spatialReference);case "mesh":return a.extent.center}return null}})},"esri/views/3d/webgl-engine/lib/Object3D":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/maybe ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../support/mathUtils ./ComponentUtils ./GeometryRecord ./IdGen ./Object3DStateSet ./Util".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u,D){z=function(){function d(a){void 0===a&&(a={});this._objectTransformation=b.mat4f64.create();this._bvObjectSpace=new v;this._bvWorldSpace=new v;this._bvDirty=!0;this._hasVolatileTransformation=!1;this._allComponentsVisibleDirty=this._allComponentsHiddenDirty=!0;this.id=d._idGen.gen(a.idHint);this.castShadow=null!=a.castShadow?a.castShadow:!0;(this.metadata=a.metadata)&&this.metadata.isElevationSource&&(this.metadata.lastValidElevationBB=new w);this.objectTransformation=
b.mat4f64.create();this._initializeGeometryRecords(a.geometries,a.materials,a.transformations,a.origins)}Object.defineProperty(d.prototype,"geometryRecords",{get:function(){return this._geometryRecords},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"geometries",{get:function(){return this._geometries},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"objectTransformation",{get:function(){return this._objectTransformation},set:function(a){q.mat4.copy(this._objectTransformation,
a);this._invalidateBoundingVolume();this._notifyDirty("objTransformation")},enumerable:!0,configurable:!0});d.prototype.dispose=function(){for(var c=0,b=this._geometryRecords;c<b.length;c++)a.pool.release(b[c]);this._geometries=this._geometryRecords=null};d.prototype._initializeGeometryRecords=function(c,f,d,h){if(Array.isArray(c)){D.assert(f.length===c.length,"Object3D: materials don't match geometries");D.assert(d.length===c.length,"Object3D: transformations don't match geometries");this._geometryRecords=
Array(c.length);this._geometries=c.slice();for(var m=0;m<c.length;m++)this._geometryRecords[m]=a.pool.acquire(c[m],f[m],b.mat4f64.clone(d[m]),{},h&&h[m]);this._hasVolatileTransformation=!1}else this._geometryRecords=[],this._geometries=[]};Object.defineProperty(d.prototype,"parentLayer",{get:function(){return this._parentLayer},set:function(a){D.assert(null==this._parentLayer||null==a,"Object3D can only be added to a single Layer");this._parentLayer=a},enumerable:!0,configurable:!0});d.prototype.getNumGeometryRecords=
function(){return this._geometryRecords.length};d.prototype.findGeometryRecords=function(a){for(var c=[],b=0;b<this._geometries.length;b++)this._geometries[b]===a&&c.push(this._geometryRecords[b]);return c};d.prototype.getGeometryRecord=function(a){D.assert(0<=a&&a<this._geometryRecords.length,"Object3d.getGeometryDataByIndex: index out of range");return this._geometryRecords[a]};d.prototype.addGeometry=function(c,f,d,h,m,l){d=d?d:b.mat4f64.IDENTITY;this._geometries.push(c);c=a.pool.acquire(c,f,d,
h||{},m,l);this._geometryRecords.push(c);this._hasVolatileTransformation=this._geometryRecords.some(function(a){return!!a.shaderTransformation});this._notifyDirty("objGeometryAdded",c);this._invalidateBoundingVolume();this._allComponentsVisibleDirty=this._allComponentsHiddenDirty=!0;return c};d.prototype.removeGeometry=function(c){var b=this._geometryRecords.splice(c,1)[0];a.pool.release(b);this._hasVolatileTransformation=this._geometryRecords.some(function(a){return!!a.shaderTransformation});this._geometries.splice(c,
1);this._notifyDirty("objGeometryRemoved",b);this._invalidateBoundingVolume();this._allComponentsVisibleDirty=this._allComponentsHiddenDirty=!0;return b};d.prototype.removeAllGeometries=function(){for(;0<this.getNumGeometryRecords();)this.removeGeometry(0)};d.prototype.geometryVertexAttrsUpdated=function(a){this._notifyDirty("vertexAttrsUpdated",this._geometryRecords[a]);this._invalidateBoundingVolume()};d.prototype.isHidden=function(){if(this._allComponentsHiddenDirty){this._allComponentsHiddenDirty=
!1;this._allComponentsHidden=!0;for(var a=0,b=this._geometryRecords;a<b.length;a++){var f=b[a];if(!c.isAllHidden(f.instanceParameters.componentVisibilities,f.geometry.data.componentOffsets)){this._allComponentsHidden=!1;break}}}return this._allComponentsHidden};d.prototype.isVisible=function(){if(this._allComponentsVisibleDirty){this._allComponentsVisibleDirty=!1;this._allComponentsVisible=!0;for(var a=0,b=this._geometryRecords;a<b.length;a++){var f=b[a];if(!c.isAllVisible(f.instanceParameters.componentVisibilities,
f.geometry.data.componentOffsets)){this._allComponentsVisible=!1;break}}}return this._allComponentsVisible};d.prototype.hide=function(){if(this._allComponentsHiddenDirty||!this._allComponentsHidden){for(var a=0,b=this._geometryRecords;a<b.length;a++){var f=b[a],d=c.hideAllComponents(f.instanceParameters.componentVisibilities);f.instanceParameters.componentVisibilities=d}this._notifyDirty("visibilityChanged");this._allComponentsVisibleDirty=this._allComponentsHiddenDirty=!1;this._allComponentsHidden=
!0;this._allComponentsVisible=!1}};d.prototype.unhide=function(){if(this._allComponentsVisibleDirty||!this._allComponentsVisible){for(var a=0,b=this._geometryRecords;a<b.length;a++){var f=b[a],d=c.unhideAllComponents(f.instanceParameters.componentVisibilities);f.instanceParameters.componentVisibilities=d}this._notifyDirty("visibilityChanged");this._allComponentsHidden=this._allComponentsVisibleDirty=this._allComponentsHiddenDirty=!1;this._allComponentsVisible=!0}};d.prototype.occlude=function(){for(var a=
u.generateObject3DStateId(1),b=0,f=this._geometryRecords;b<f.length;b++){var d=f[b];d.instanceParameters.occludees=c.addOccludee(d.instanceParameters.occludees,a)}this._notifyDirty("occlusionChanged");return a};d.prototype.removeOcclude=function(a){for(var b=0,f=this._geometryRecords;b<f.length;b++){var d=f[b];d.instanceParameters.occludees=c.removeOccludee(d.instanceParameters.occludees,a)}this._notifyDirty("occlusionChanged")};d.prototype.highlight=function(){for(var a=u.generateObject3DStateId(0),
b=0,f=this._geometryRecords;b<f.length;b++){var d=f[b];d.instanceParameters.componentHighlights=c.addHighlight(d.instanceParameters.componentHighlights,null,a)}this._notifyDirty("highlightChanged");return a};d.prototype.removeHighlight=function(a){for(var b=0,f=this._geometryRecords;b<f.length;b++){var d=f[b];d.instanceParameters.componentHighlights=c.removeHighlight(d.instanceParameters.componentHighlights,a)}this._notifyDirty("highlightChanged")};d.prototype.getComponentFromTriangleNr=function(a,
b){D.assert(0<=a&&a<this._geometryRecords.length,"Object3d.getComponentFromTriangleNr: index out of range");return c.componentFind(this._geometryRecords[a].geometry.data.componentOffsets,3*b)};d.prototype.setGeometryTransformation=function(c,f){D.assert(0<=c&&c<this._geometryRecords.length,"Object3d.setGeometryTransformation: index out of range");var d=this._geometryRecords[c];a.pool.release(d);f=a.pool.acquire(d.geometry,d.material,b.mat4f64.clone(f),d.instanceParameters);this._geometryRecords[c]=
f;this._notifyDirty("objGeometryReplaced",[d,f]);this._invalidateBoundingVolume()};d.prototype.getCombinedStaticTransformation=function(a,c){return q.mat4.multiply(l.unwrapOr(c,b.mat4f64.create()),this.objectTransformation,a.getStaticTransformation())};d.prototype.getCombinedShaderTransformation=function(a,c){c=c||b.mat4f64.create();q.mat4.multiply(c,this.objectTransformation,a.getShaderTransformation());return c};d.prototype.hasVolativeTransformation=function(){return this._hasVolatileTransformation};
d.prototype.getBBMin=function(a){this._validateBoundingVolume();return a?this._bvObjectSpace.bbMin:this._bvWorldSpace.bbMin};d.prototype.getBBMax=function(a){this._validateBoundingVolume();return a?this._bvObjectSpace.bbMax:this._bvWorldSpace.bbMax};d.prototype.getCenter=function(a){this._validateBoundingVolume();return a?this._bvObjectSpace.center:this._bvWorldSpace.center};d.prototype.getBSRadius=function(a){this._validateBoundingVolume();return a?this._bvObjectSpace.bsRadius:this._bvWorldSpace.bsRadius};
d.prototype._validateBoundingVolume=function(){if(this._bvDirty||this._hasVolatileTransformation){this._bvObjectSpace.init();this._bvWorldSpace.init();for(var a=0;a<this._geometryRecords.length;++a){var c=this._geometries[a],b=this._geometryRecords[a],c=c.boundingInfo;this._calculateTransformedBoundingVolume(c,this._bvObjectSpace,b.getShaderTransformation());this._calculateTransformedBoundingVolume(c,this._bvWorldSpace,this.getCombinedShaderTransformation(b))}f.vec3.lerp(this._bvObjectSpace.center,
this._bvObjectSpace.bbMin,this._bvObjectSpace.bbMax,.5);f.vec3.lerp(this._bvWorldSpace.center,this._bvWorldSpace.bbMin,this._bvWorldSpace.bbMax,.5);for(var b=h.vec3f64.create(),d=h.vec3f64.create(),m=r.maxScale(this.objectTransformation),a=0;a<this._geometryRecords.length;++a){var c=this._geometries[a],l=this._geometryRecords[a].getShaderTransformation(),u=r.maxScale(l),c=c.boundingInfo;f.vec3.transformMat4(b,c.getCenter(),l);l=f.vec3.distance(b,this._bvObjectSpace.center);c=c.getBSRadius()*u;this._bvObjectSpace.bsRadius=
Math.max(this._bvObjectSpace.bsRadius,l+c);f.vec3.transformMat4(d,b,this.objectTransformation);u=f.vec3.distance(d,this._bvWorldSpace.center);this._bvWorldSpace.bsRadius=Math.max(this._bvWorldSpace.bsRadius,u+c*m)}this._bvDirty=!1}};d.prototype._calculateTransformedBoundingVolume=function(a,c,b){var d=a.getBBMin();a=a.getBBMax();var m=h.vec3f64.clone(d),l=h.vec3f64.clone(a);f.vec3.transformMat4(m,m,b);f.vec3.transformMat4(l,l,b);for(var r=0;3>r;++r)c.bbMin[r]=Math.min(c.bbMin[r],m[r],l[r]),c.bbMax[r]=
Math.max(c.bbMax[r],m[r],l[r]);for(r=0;3>r;++r){f.vec3.copy(m,d);f.vec3.copy(l,a);m[r]=a[r];l[r]=d[r];f.vec3.transformMat4(m,m,b);f.vec3.transformMat4(l,l,b);for(var u=0;3>u;++u)c.bbMin[u]=Math.min(c.bbMin[u],m[u],l[u]),c.bbMax[u]=Math.max(c.bbMax[u],m[u],l[u])}};d.prototype._invalidateBoundingVolume=function(){this._bvDirty=!0;this._parentLayer&&this._parentLayer.notifyObjectBBChanged(this,{center:this._bvWorldSpace.center,radius:this._bvWorldSpace.bsRadius})};d.prototype._notifyDirty=function(a,
c,b,f){this._parentLayer&&this._parentLayer.notifyDirty(a,c,b||1,f||this)};Object.defineProperty(d.prototype,"test",{get:function(){var a=this;return{hasGeometry:function(c){return-1<a._geometries.indexOf(c)},getGeometryIndex:function(c){return a._geometries.indexOf(c)}}},enumerable:!0,configurable:!0});d._idGen=new m.IdGen;return d}();var w=function(){function a(){this.bbMin=h.vec3f64.fromValues(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);this.bbMax=h.vec3f64.fromValues(-Number.MAX_VALUE,
-Number.MAX_VALUE,-Number.MAX_VALUE)}a.prototype.isEmpty=function(){return this.bbMax[0]<this.bbMin[0]&&this.bbMax[1]<this.bbMin[1]&&this.bbMax[2]<this.bbMin[2]};return a}(),v=function(a){function c(){var c=a.call(this)||this;c.center=h.vec3f64.create();c.bsRadius=0;return c}t(c,a);c.prototype.init=function(){f.vec3.set(this.bbMin,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);f.vec3.set(this.bbMax,-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);f.vec3.set(this.center,0,0,0);this.bsRadius=
0};c.prototype.getCenter=function(){return this.center};c.prototype.getBSRadius=function(){return this.bsRadius};return c}(w);return z})},"esri/views/3d/webgl-engine/lib/GeometryRecord":function(){define(["require","exports","../../../../core/ObjectPool","../../../../core/libs/gl-matrix-2/vec3","./IdGen"],function(z,d,t,l,q){return function(){function b(f,d,l,c,a,m){this.id=b._idGen.gen(f&&f.id);this.geometry=f;this.material=d;this.transformation=l;this.instanceParameters=c;this.origin=a;this.shaderTransformation=
m}b.prototype.getStaticTransformation=function(){return this.transformation};b.prototype.getShaderTransformation=function(){return this.shaderTransformation?this.shaderTransformation(this.transformation):this.transformation};b.prototype.computeAttachmentOrigin=function(b){return(this.material.computeAttachmentOrigin?this.material.computeAttachmentOrigin(this.geometry,b):this.geometry.computeAttachmentOrigin(b))?(l.vec3.transformMat4(b,b,this.getStaticTransformation()),!0):!1};b._idGen=new q.IdGen;
b.pool=new t(b,!0);return b}()})},"esri/views/3d/webgl-engine/lib/Object3DStateSet":function(){define(["require","exports","./IdGen"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});var l=new t.IdGen;d.generateObject3DStateId=function(d){return{id:l.gen(0===d?"highlight":"occludee"),channel:d}};z=function(){function d(){this.items=[]}d.prototype.addObject=function(b,f){this.items.push({type:0,objectStateId:f,object:b})};d.prototype.addRenderGeometry=function(b,f,d){this.items.push({type:1,
objectStateId:f,renderGeometry:b,owner:d})};d.prototype.addExternal=function(b,f){this.items.push({type:2,objectStateId:f,remove:b})};d.prototype.remove=function(b){for(var f=this.items.length-1;0<=f;--f){var d=this.items[f];d.objectStateId===b&&(this._removeObjectStateItem(d),this.items.splice(f,1))}};d.prototype.removeObject=function(b){for(var f=this.items.length-1;0<=f;--f){var d=this.items[f];0===d.type&&d.object===b&&(this._removeObjectStateItem(d),this.items.splice(f,1))}};d.prototype.removeRenderGeometry=
function(b){for(var f=this.items.length-1;0<=f;--f){var d=this.items[f];1===d.type&&d.renderGeometry===b&&(this._removeObjectStateItem(d),this.items.splice(f,1))}};d.prototype.removeAll=function(){var b=this;this.items.forEach(function(f){b._removeObjectStateItem(f)});this.items=[]};d.prototype._removeObjectStateItem=function(b){switch(b.type){case 0:0===b.objectStateId.channel?b.object.removeHighlight(b.objectStateId):1===b.objectStateId.channel&&b.object.removeOcclude(b.objectStateId);break;case 1:b.owner.removeRenderGeometryObjectState(b.renderGeometry,
b.objectStateId);break;case 2:b.remove(b.objectStateId)}};return d}();d.Object3DStateSet=z})},"esri/views/3d/layers/graphics/sdfPrimitives":function(){define(["require","exports","../../../../core/compilerUtils","../../webgl-engine/lib/Util"],function(z,d,t,l){function q(a,c){var b=new Uint8Array(4*a*a),f=a/2-.5;c/=2;for(var d=0;d<a;d++)for(var h=0;h<a;h++){var m=h+a*d,r=h-f,u=d-f,r=Math.sqrt(r*r+u*u)-c,r=r/a+.5;l.packFloatRGBA(r,b,4*m)}return b}function b(c,b){return a(c,b,!1)}function f(c,b){return a(c,
b,!0)}function h(a,c){return m(a,c,!1)}function r(a,c){return m(a,c,!0)}function c(a,c){for(var b=new Uint8Array(4*a*a),f=Math.sqrt(1.25),d=(a-c)/2,h=0;h<a;h++)for(var m=0;m<a;m++){var r=(m-d)/c,u=(h-d+.75)/c;l.packFloatRGBA(Math.max(-(1*r+-.5*u)/f,(1*(r-1)+-.5*-u)/f,-u)*c/a+.5,b,4*(h*a+m))}return b}function a(a,c,b){b&&(c/=Math.SQRT2);for(var f=new Uint8Array(4*a*a),d=0;d<a;d++)for(var h=0;h<a;h++){var m=h-.5*a+.25,r=-d+.5*a-.75,u=d*a+h;if(b)var q=(m+r)/Math.SQRT2,r=(r-m)/Math.SQRT2,m=q;m=Math.max(Math.abs(m),
Math.abs(r))-.5*c;m=m/a+.5;l.packFloatRGBA(m,f,4*u)}return f}function m(a,c,b){b&&(c*=Math.SQRT2);c*=.5;for(var f=new Uint8Array(4*a*a),d=0;d<a;d++)for(var h=0;h<a;h++){var m=h-.5*a,r=-d+.5*a-1,u=d*a+h;if(b)var q=(m+r)/Math.SQRT2,r=(r-m)/Math.SQRT2,m=q;q=void 0;m=Math.abs(m);r=Math.abs(r);q=m>r?m>c?Math.sqrt((m-c)*(m-c)+r*r):r:r>c?Math.sqrt(m*m+(r-c)*(r-c)):m;q=q/a+.5;l.packFloatRGBA(q,f,4*u)}return f}Object.defineProperty(d,"__esModule",{value:!0});d.createType=function(a,d,m){switch(a){case "circle":return q(d,
m);case "square":return b(d,m);case "cross":return h(d,m);case "x":return r(d,m);case "kite":return f(d,m);case "triangle":return c(d,m);default:return t.neverReached(a),q(d,m)}};d.createCircle=q;d.createSquare=b;d.createKite=f;d.createCross=h;d.createX=r;d.createTriangle=c})},"esri/views/3d/layers/support/FastSymbolUpdates":function(){define("require exports ../../../../core/compilerUtils ../../../../core/mathUtils ../../../../core/libs/gl-matrix-2/mat3 ../../../../core/libs/gl-matrix-2/mat3f64 ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../renderers/support/utils ../../support/debugFlags".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m){function u(a){return null!==a&&void 0!==a}function D(a){return"number"===typeof a}function w(a){return"string"===typeof a}function v(a,c){a&&a.push(c)}function E(c,b,f,d,h){var p=c.minSize,m=c.maxSize;if(c.expression)return v(h,"Could not convert size info: expression not supported"),!1;if(c.useSymbolValue)return c=d.symbolSize[f],b.minSize[f]=c,b.maxSize[f]=c,b.offset[f]=b.minSize[f],b.factor[f]=0,b.type[f]=1,!0;if(u(c.field)){if(u(c.stops)){if(2===c.stops.length&&
D(c.stops[0].size)&&D(c.stops[1].size))return C(c.stops[0].size,c.stops[1].size,c.stops[0].value,c.stops[1].value,b,f),b.type[f]=1,!0;v(h,"Could not convert size info: stops only supported with 2 elements");return!1}if(D(p)&&D(m)&&u(c.minDataValue)&&u(c.maxDataValue))return C(p,m,c.minDataValue,c.maxDataValue,b,f),b.type[f]=1,!0;if(null!=a.meterIn[c.valueUnit])return b.minSize[f]=-Infinity,b.maxSize[f]=Infinity,b.offset[f]=0,b.factor[f]=1/a.meterIn[c.valueUnit],b.type[f]=1,!0;if("unknown"===c.valueUnit)return v(h,
"Could not convert size info: proportional size not supported"),!1;v(h,"Could not convert size info: scale-dependent size not supported");return!1}if(!u(c.field)){if(c.stops&&c.stops[0]&&D(c.stops[0].size))return b.minSize[f]=c.stops[0].size,b.maxSize[f]=c.stops[0].size,b.offset[f]=b.minSize[f],b.factor[f]=0,b.type[f]=1,!0;if(D(p))return b.minSize[f]=p,b.maxSize[f]=p,b.offset[f]=p,b.factor[f]=0,b.type[f]=1,!0}v(h,"Could not convert size info: unsupported variant of sizeInfo");return!1}function C(a,
c,b,f,d,p){f=0<Math.abs(f-b)?(c-a)/(f-b):0;d.minSize[p]=0<f?a:c;d.maxSize[p]=0<f?c:a;d.offset[p]=a-b*f;d.factor[p]=f}function J(a,c,b,f){if(a.normalizationField||a.valueRepresentation)return v(f,"Could not convert size info: unsupported property"),null;var d=a.field;if(null!=d&&!w(d))return v(f,"Could not convert size info: field is not a string"),null;if(!c.size)c.size={field:a.field,minSize:[0,0,0],maxSize:[0,0,0],offset:[0,0,0],factor:[0,0,0],type:[0,0,0]};else if(a.field)if(!c.size.field)c.size.field=
a.field;else if(a.field!==c.size.field)return v(f,"Could not convert size info: multiple fields in use"),null;switch(a.axis){case "width":return(d=E(a,c.size,0,b,f))?c:null;case "height":return(d=E(a,c.size,2,b,f))?c:null;case "depth":return(d=E(a,c.size,1,b,f))?c:null;case "width-and-depth":return(d=E(a,c.size,0,b,f))&&E(a,c.size,1,b,f),d?c:null;case null:case void 0:case "all":return(d=(d=(d=E(a,c.size,0,b,f))&&E(a,c.size,1,b,f))&&E(a,c.size,2,b,f))?c:null;default:return v(f,'Could not convert size info: unknown axis "'+
a.axis+'""'),null}}function K(a,c,b){for(var f=0;3>f;++f){var d=c.unitInMeters;1===a.type[f]&&(d*=c.modelSize[f],a.type[f]=2);a.minSize[f]/=d;a.maxSize[f]/=d;a.offset[f]/=d;a.factor[f]/=d}if(0!==a.type[0])c=0;else if(0!==a.type[1])c=1;else if(0!==a.type[2])c=2;else return v(b,"No size axis contains a valid size or scale"),!1;for(f=0;3>f;++f)0===a.type[f]&&(a.minSize[f]=a.minSize[c],a.maxSize[f]=a.maxSize[c],a.offset[f]=a.offset[c],a.factor[f]=a.factor[c],a.type[f]=a.type[c]);return!0}function G(a,
c,b){a[4*c+0]=b.r/255;a[4*c+1]=b.g/255;a[4*c+2]=b.b/255;a[4*c+3]=b.a}function I(a,c,b){if(a.normalizationField)return v(b,"Could not convert color info: unsupported property"),null;if(w(a.field))if(a.stops){if(8<a.stops.length)return v(b,"Could not convert color info: too many color stops"),null;c.color={field:a.field,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};b=a.stops;for(a=0;8>a;++a){var f=b[Math.min(a,b.length-1)];c.color.values[a]=f.value;
G(c.color.colors,a,f.color)}}else return v(b,"Could not convert color info: missing stops or colors"),null;else if(a.stops&&0<=a.stops.length)for(b=a.stops&&0<=a.stops.length&&a.stops[0].color,c.color={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},a=0;8>a;a++)c.color.values[a]=Infinity,G(c.color.colors,a,b);else return v(b,"Could not convert color info: no field and no colors/stops"),null;return c}function x(a,c,b){if(a.normalizationField)return v(b,
"Could not convert opacity info: unsupported property"),null;if(w(a.field))if(a.stops){if(8<a.stops.length)return v(b,"Could not convert opacity info: too many opacity stops"),null;c.opacity={field:a.field,values:[0,0,0,0,0,0,0,0],opacityValues:[0,0,0,0,0,0,0,0]};b=a.stops;for(a=0;8>a;++a){var f=b[Math.min(a,b.length-1)];c.opacity.values[a]=f.value;c.opacity.opacityValues[a]=f.opacity}}else return v(b,"Could not convert opacity info: missing stops or opacities"),null;else if(a.stops&&0<=a.stops.length)for(b=
a.stops&&0<=a.stops.length&&a.stops[0].opacity,c.opacity={field:null,values:[0,0,0,0,0,0,0,0],opacityValues:[0,0,0,0,0,0,0,0]},a=0;8>a;a++)c.opacity.values[a]=Infinity,c.opacity.opacityValues[a]=b;else return v(b,"Could not convert opacity info: no field and no opacities/stops"),null;return c}function N(a,c,b){a=2===b&&"arithmetic"===a.rotationType;c.offset[b]=a?90:0;c.factor[b]=a?-1:1;c.type[b]=1}function O(a,c,b){if(!w(a.field))return v(b,"Could not convert rotation info: field is not a string"),
null;if(!c.rotation)c.rotation={field:a.field,offset:[0,0,0],factor:[1,1,1],type:[0,0,0]};else if(a.field)if(!c.rotation.field)c.rotation.field=a.field;else if(a.field!==c.rotation.field)return v(b,"Could not convert rotation info: multiple fields in use"),null;switch(a.axis){case "tilt":return N(a,c.rotation,0),c;case "roll":return N(a,c.rotation,1),c;case null:case void 0:case "heading":return N(a,c.rotation,2),c;default:return v(b,'Could not convert rotation info: unknown axis "'+a.axis+'""'),
null}}function P(a,c,b){if(!a)return null;var f=!c.supportedTypes||!!c.supportedTypes.size,d=!c.supportedTypes||!!c.supportedTypes.color,p=!c.supportedTypes||!!c.supportedTypes.rotation,h=!!c.supportedTypes&&!!c.supportedTypes.opacity,m=a.reduce(function(k,e){if(!k)return k;if(e.valueExpression)return v(b,"Could not convert visual variables: arcade expressions not supported"),null;switch(e.type){case "size":return f?J(e,k,c,b):k;case "color":return d?I(e,k,b):k;case "opacity":return h?x(e,k,b):null;
case "rotation":return p?O(e,k,b):k;default:return t.neverReached(e),null}},{size:null,color:null,opacity:null,rotation:null});return 0<a.length&&m&&!m.size&&!m.color&&!m.opacity&&!m.rotation||m&&m.size&&!K(m.size,c,b)?null:m}function S(a,c,b){if(!!a!==!!c||a&&a.field!==c.field)return!1;if(a&&"rotation"===b)for(b=0;3>b;b++)if(a.type[b]!==c.type[b]||a.offset[b]!==c.offset[b]||a.factor[b]!==c.factor[b])return!1;return!0}function R(a,c){var d={vvSizeEnabled:!1,vvSizeMinSize:null,vvSizeMaxSize:null,vvSizeOffset:null,
vvSizeFactor:null,vvSizeValue:null,vvColorEnabled:!1,vvColorValues:null,vvColorColors:null,vvOpacityEnabled:!1,vvOpacityValues:null,vvOpacityOpacities:null,vvSymbolAnchor:null,vvSymbolRotationMatrix:null},m=a&&null!=a.size;a&&a.size?(d.vvSizeEnabled=!0,d.vvSizeMinSize=a.size.minSize,d.vvSizeMaxSize=a.size.maxSize,d.vvSizeOffset=a.size.offset,d.vvSizeFactor=a.size.factor):a&&m&&(d.vvSizeValue=c.transformation.scale);if(a&&m){d.vvSymbolAnchor=c.transformation.anchor;d.vvSymbolRotationMatrix=b.mat3f64.create();
f.mat4.identity(U);var l=c.transformation.rotation[2],m=c.transformation.rotation[0],p=c.transformation.rotation[1];c=U;void 0===c&&(c=h.mat4f64.create());l=l||0;m=m||0;p=p||0;0!==l&&f.mat4.rotateZ(c,c,-l/180*Math.PI);0!==m&&f.mat4.rotateX(c,c,m/180*Math.PI);0!==p&&f.mat4.rotateY(c,c,p/180*Math.PI);q.mat3.fromMat4(d.vvSymbolRotationMatrix,U)}a&&a.color&&(d.vvColorEnabled=!0,d.vvColorValues=a.color.values,d.vvColorColors=a.color.colors);a&&a.opacity&&(d.vvOpacityEnabled=!0,d.vvOpacityValues=a.opacity.values,
d.vvOpacityOpacities=a.opacity.opacityValues);return d}Object.defineProperty(d,"__esModule",{value:!0});d.convertVisualVariables=P;d.initFastSymbolUpdatesState=function(a,c){return!a||m.DISABLE_FAST_UPDATES?{enabled:!1}:(a=P(a.visualVariables,c))?{enabled:!0,visualVariables:a,materialParameters:R(a,c),requiresShaderTransformation:a&&null!=a.size}:{enabled:!1}};d.updateFastSymbolUpdatesState=function(a,c,b){if(!c||!a.enabled)return!1;var f=a.visualVariables;c=P(c.visualVariables,b);if(!(c&&S(f.size,
c.size,"size")&&S(f.color,c.color,"color")&&S(f.rotation,c.rotation,"rotation")&&S(f.opacity,c.opacity,"opacity")))return!1;a.visualVariables=c;a.materialParameters=R(c,b);a.requiresShaderTransformation=c&&null!=c.size;return!0};d.getMaterialParams=R;var Q;(function(a){var b=h.mat4f64.create(),d=c.vec3f64.create();a.evaluateModelTransform=function(a,c,p){if(!a.vvSizeEnabled)return p;f.mat4.copy(b,p);p=a.vvSymbolRotationMatrix;f.mat4.set(U,p[0],p[1],p[2],0,p[3],p[4],p[5],0,p[6],p[7],p[8],0,0,0,0,1);
f.mat4.multiply(b,b,U);for(p=0;3>p;++p)d[p]=l.clamp(a.vvSizeOffset[p]+c[0]*a.vvSizeFactor[p],a.vvSizeMinSize[p],a.vvSizeMaxSize[p]);f.mat4.scale(b,b,d);f.mat4.translate(b,b,a.vvSymbolAnchor);return b};a.evaluateModelTransformScale=function(a,c,p){if(!c.vvSizeEnabled)return r.vec3.set(a,1,1,1);for(var b=0;3>b;++b)a[b]=l.clamp(c.vvSizeOffset[b]+p[0]*c.vvSizeFactor[b],c.vvSizeMinSize[b],c.vvSizeMaxSize[b]);return a}})(Q||(Q={}));var U=h.mat4f64.create();d.evaluateModelTransform=Q.evaluateModelTransform;
d.evaluateModelTransformScale=Q.evaluateModelTransformScale})},"esri/core/libs/gl-matrix-2/mat3":function(){define(["require","exports","./math/mat3"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});d.mat3=t})},"esri/core/libs/gl-matrix-2/math/mat3":function(){define(["require","exports","./common"],function(z,d,t){function l(b,f,d){var h=f[0],c=f[1],a=f[2],m=f[3],l=f[4],q=f[5],w=f[6],v=f[7];f=f[8];var t=d[0],C=d[1],J=d[2],K=d[3],G=d[4],I=d[5],x=d[6],z=d[7];d=d[8];b[0]=t*h+C*m+J*
w;b[1]=t*c+C*l+J*v;b[2]=t*a+C*q+J*f;b[3]=K*h+G*m+I*w;b[4]=K*c+G*l+I*v;b[5]=K*a+G*q+I*f;b[6]=x*h+z*m+d*w;b[7]=x*c+z*l+d*v;b[8]=x*a+z*q+d*f;return b}function q(b,f,d){b[0]=f[0]-d[0];b[1]=f[1]-d[1];b[2]=f[2]-d[2];b[3]=f[3]-d[3];b[4]=f[4]-d[4];b[5]=f[5]-d[5];b[6]=f[6]-d[6];b[7]=f[7]-d[7];b[8]=f[8]-d[8];return b}Object.defineProperty(d,"__esModule",{value:!0});d.fromMat4=function(b,f){b[0]=f[0];b[1]=f[1];b[2]=f[2];b[3]=f[4];b[4]=f[5];b[5]=f[6];b[6]=f[8];b[7]=f[9];b[8]=f[10];return b};d.copy=function(b,
f){b[0]=f[0];b[1]=f[1];b[2]=f[2];b[3]=f[3];b[4]=f[4];b[5]=f[5];b[6]=f[6];b[7]=f[7];b[8]=f[8];return b};d.set=function(b,f,d,l,c,a,m,u,q,w){b[0]=f;b[1]=d;b[2]=l;b[3]=c;b[4]=a;b[5]=m;b[6]=u;b[7]=q;b[8]=w;return b};d.identity=function(b){b[0]=1;b[1]=0;b[2]=0;b[3]=0;b[4]=1;b[5]=0;b[6]=0;b[7]=0;b[8]=1;return b};d.transpose=function(b,f){if(b===f){var d=f[1],l=f[2],c=f[5];b[1]=f[3];b[2]=f[6];b[3]=d;b[5]=f[7];b[6]=l;b[7]=c}else b[0]=f[0],b[1]=f[3],b[2]=f[6],b[3]=f[1],b[4]=f[4],b[5]=f[7],b[6]=f[2],b[7]=f[5],
b[8]=f[8];return b};d.invert=function(b,f){var d=f[0],l=f[1],c=f[2],a=f[3],m=f[4],u=f[5],q=f[6],w=f[7];f=f[8];var v=f*m-u*w,t=-f*a+u*q,C=w*a-m*q,J=d*v+l*t+c*C;if(!J)return null;J=1/J;b[0]=v*J;b[1]=(-f*l+c*w)*J;b[2]=(u*l-c*m)*J;b[3]=t*J;b[4]=(f*d-c*q)*J;b[5]=(-u*d+c*a)*J;b[6]=C*J;b[7]=(-w*d+l*q)*J;b[8]=(m*d-l*a)*J;return b};d.adjoint=function(b,f){var d=f[0],l=f[1],c=f[2],a=f[3],m=f[4],u=f[5],q=f[6],w=f[7];f=f[8];b[0]=m*f-u*w;b[1]=c*w-l*f;b[2]=l*u-c*m;b[3]=u*q-a*f;b[4]=d*f-c*q;b[5]=c*a-d*u;b[6]=a*
w-m*q;b[7]=l*q-d*w;b[8]=d*m-l*a;return b};d.determinant=function(b){var f=b[3],d=b[4],l=b[5],c=b[6],a=b[7],m=b[8];return b[0]*(m*d-l*a)+b[1]*(-m*f+l*c)+b[2]*(a*f-d*c)};d.multiply=l;d.translate=function(b,f,d){var h=f[0],c=f[1],a=f[2],m=f[3],l=f[4],q=f[5],w=f[6],v=f[7];f=f[8];var t=d[0];d=d[1];b[0]=h;b[1]=c;b[2]=a;b[3]=m;b[4]=l;b[5]=q;b[6]=t*h+d*m+w;b[7]=t*c+d*l+v;b[8]=t*a+d*q+f;return b};d.rotate=function(b,f,d){var h=f[0],c=f[1],a=f[2],m=f[3],l=f[4],q=f[5],w=f[6],v=f[7];f=f[8];var t=Math.sin(d);
d=Math.cos(d);b[0]=d*h+t*m;b[1]=d*c+t*l;b[2]=d*a+t*q;b[3]=d*m-t*h;b[4]=d*l-t*c;b[5]=d*q-t*a;b[6]=w;b[7]=v;b[8]=f;return b};d.scale=function(b,f,d){var h=d[0],c=d[1];d=d[2];b[0]=h*f[0];b[1]=h*f[1];b[2]=h*f[2];b[3]=c*f[3];b[4]=c*f[4];b[5]=c*f[5];b[6]=d*f[6];b[7]=d*f[7];b[8]=d*f[8];return b};d.scaleByVec2=function(b,f,d){var h=d[0];d=d[1];b[0]=h*f[0];b[1]=h*f[1];b[2]=h*f[2];b[3]=d*f[3];b[4]=d*f[4];b[5]=d*f[5];return b};d.fromTranslation=function(b,f){b[0]=1;b[1]=0;b[2]=0;b[3]=0;b[4]=1;b[5]=0;b[6]=f[0];
b[7]=f[1];b[8]=1;return b};d.fromRotation=function(b,f){var d=Math.sin(f);f=Math.cos(f);b[0]=f;b[1]=d;b[2]=0;b[3]=-d;b[4]=f;b[5]=0;b[6]=0;b[7]=0;b[8]=1;return b};d.fromScaling=function(b,f){b[0]=f[0];b[1]=0;b[2]=0;b[3]=0;b[4]=f[1];b[5]=0;b[6]=0;b[7]=0;b[8]=1;return b};d.fromMat2d=function(b,f){b[0]=f[0];b[1]=f[1];b[2]=0;b[3]=f[2];b[4]=f[3];b[5]=0;b[6]=f[4];b[7]=f[5];b[8]=1;return b};d.fromQuat=function(b,f){var d=f[0],l=f[1],c=f[2];f=f[3];var a=d+d,m=l+l,u=c+c,d=d*a,q=l*a,l=l*m,w=c*a,v=c*m,c=c*u,
a=f*a,m=f*m;f*=u;b[0]=1-l-c;b[3]=q-f;b[6]=w+m;b[1]=q+f;b[4]=1-d-c;b[7]=v-a;b[2]=w-m;b[5]=v+a;b[8]=1-d-l;return b};d.normalFromMat4Legacy=function(b,f){var d=f[0],l=f[1],c=f[2],a=f[4],m=f[5],u=f[6],q=f[8],w=f[9];f=f[10];var v=f*m-u*w,t=-f*a+u*q,C=w*a-m*q,J=d*v+l*t+c*C;if(!J)return null;J=1/J;b[0]=v*J;b[1]=(-f*l+c*w)*J;b[2]=(u*l-c*m)*J;b[3]=t*J;b[4]=(f*d-c*q)*J;b[5]=(-u*d+c*a)*J;b[6]=C*J;b[7]=(-w*d+l*q)*J;b[8]=(m*d-l*a)*J;return b};d.normalFromMat4=function(b,f){var d=f[0],l=f[1],c=f[2],a=f[3],m=f[4],
q=f[5],t=f[6],w=f[7],v=f[8],E=f[9],C=f[10],J=f[11],K=f[12],G=f[13],I=f[14];f=f[15];var x=d*q-l*m,z=d*t-c*m,O=d*w-a*m,P=l*t-c*q,S=l*w-a*q,R=c*w-a*t,Q=v*G-E*K,U=v*I-C*K,v=v*f-J*K,V=E*I-C*G,E=E*f-J*G,C=C*f-J*I,J=x*C-z*E+O*V+P*v-S*U+R*Q;if(!J)return null;J=1/J;b[0]=(q*C-t*E+w*V)*J;b[1]=(t*v-m*C-w*U)*J;b[2]=(m*E-q*v+w*Q)*J;b[3]=(c*E-l*C-a*V)*J;b[4]=(d*C-c*v+a*U)*J;b[5]=(l*v-d*E-a*Q)*J;b[6]=(G*R-I*S+f*P)*J;b[7]=(I*O-K*R-f*z)*J;b[8]=(K*S-G*O+f*x)*J;return b};d.projection=function(b,f,d){b[0]=2/f;b[1]=0;
b[2]=0;b[3]=0;b[4]=-2/d;b[5]=0;b[6]=-1;b[7]=1;b[8]=1;return b};d.str=function(b){return"mat3("+b[0]+", "+b[1]+", "+b[2]+", "+b[3]+", "+b[4]+", "+b[5]+", "+b[6]+", "+b[7]+", "+b[8]+")"};d.frob=function(b){return Math.sqrt(Math.pow(b[0],2)+Math.pow(b[1],2)+Math.pow(b[2],2)+Math.pow(b[3],2)+Math.pow(b[4],2)+Math.pow(b[5],2)+Math.pow(b[6],2)+Math.pow(b[7],2)+Math.pow(b[8],2))};d.add=function(b,f,d){b[0]=f[0]+d[0];b[1]=f[1]+d[1];b[2]=f[2]+d[2];b[3]=f[3]+d[3];b[4]=f[4]+d[4];b[5]=f[5]+d[5];b[6]=f[6]+d[6];
b[7]=f[7]+d[7];b[8]=f[8]+d[8];return b};d.subtract=q;d.multiplyScalar=function(b,f,d){b[0]=f[0]*d;b[1]=f[1]*d;b[2]=f[2]*d;b[3]=f[3]*d;b[4]=f[4]*d;b[5]=f[5]*d;b[6]=f[6]*d;b[7]=f[7]*d;b[8]=f[8]*d;return b};d.multiplyScalarAndAdd=function(b,f,d,l){b[0]=f[0]+d[0]*l;b[1]=f[1]+d[1]*l;b[2]=f[2]+d[2]*l;b[3]=f[3]+d[3]*l;b[4]=f[4]+d[4]*l;b[5]=f[5]+d[5]*l;b[6]=f[6]+d[6]*l;b[7]=f[7]+d[7]*l;b[8]=f[8]+d[8]*l;return b};d.exactEquals=function(b,f){return b[0]===f[0]&&b[1]===f[1]&&b[2]===f[2]&&b[3]===f[3]&&b[4]===
f[4]&&b[5]===f[5]&&b[6]===f[6]&&b[7]===f[7]&&b[8]===f[8]};d.equals=function(b,f){var d=b[0],l=b[1],c=b[2],a=b[3],m=b[4],q=b[5],D=b[6],w=b[7];b=b[8];var v=f[0],E=f[1],C=f[2],J=f[3],K=f[4],G=f[5],I=f[6],x=f[7];f=f[8];return Math.abs(d-v)<=t.EPSILON*Math.max(1,Math.abs(d),Math.abs(v))&&Math.abs(l-E)<=t.EPSILON*Math.max(1,Math.abs(l),Math.abs(E))&&Math.abs(c-C)<=t.EPSILON*Math.max(1,Math.abs(c),Math.abs(C))&&Math.abs(a-J)<=t.EPSILON*Math.max(1,Math.abs(a),Math.abs(J))&&Math.abs(m-K)<=t.EPSILON*Math.max(1,
Math.abs(m),Math.abs(K))&&Math.abs(q-G)<=t.EPSILON*Math.max(1,Math.abs(q),Math.abs(G))&&Math.abs(D-I)<=t.EPSILON*Math.max(1,Math.abs(D),Math.abs(I))&&Math.abs(w-x)<=t.EPSILON*Math.max(1,Math.abs(w),Math.abs(x))&&Math.abs(b-f)<=t.EPSILON*Math.max(1,Math.abs(b),Math.abs(f))};d.mul=l;d.sub=q})},"esri/views/3d/terrain/OverlayRenderer":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/Logger ../../../core/MapUtils ../../../core/maybe ../../../core/PooledArray ../../../core/SetUtils ../../../core/accessorSupport/decorators/declared ../../../core/libs/gl-matrix-2/mat4 ../../../core/libs/gl-matrix-2/vec3f64 ../support/debugFlags ../webgl-engine/core/shaderTechnique/CommonUniformStore ../webgl-engine/core/shaderTechnique/ShaderTechniqueRepository ../webgl-engine/lib/AutoDisposable ../webgl-engine/lib/Camera ../webgl-engine/lib/GLMaterialRep ../webgl-engine/lib/glUtil3D ../webgl-engine/lib/GridLocalOriginFactory ../webgl-engine/lib/intersectorUtils ../webgl-engine/lib/RenderContext ../webgl-engine/lib/renderStats ../webgl-engine/lib/SortedRenderGeometryRenderer ../webgl-engine/lib/TextureTechnique ../webgl-engine/lighting/Lightsources ../webgl-engine/lighting/SceneLighting ../webgl-engine/materials/lineStippleUtils ../../webgl/FramebufferObject ../../webgl/Texture ../../webgl/Util".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u,D,w,v,E,C,J,K,G,I,x,N,O,P,S,R,Q,U,V){Object.defineProperty(d,"__esModule",{value:!0});var Y=q.getLogger("esri.views.3d.webgl-engine.lib.OverlayRenderer");z=function(c){function k(e){var g=c.call(this)||this;g._hasHighlights=!1;g._rendersOccluded=!1;g._lighting=new S.SceneLighting;g._localOrigins=new K;g._layerViewHandles=new Map;g._layerRenderers=new Map;g._sortedLayerRenderersDirty=!1;g._sortedLayerRenderers=new h;g._stats=new x.RenderStatsAggregator;g._geometries=
new Map;g._renderTargets={};g._uniqueIdx=0;g.longitudeCyclical=null;g._rctx=e.renderingContext;g._renderContext=new I(g._rctx,null,null,null,null,null);g._stippleTextureRepository=new R.StippleTextureRepository;g._shaderTechniqueRepository=new w.ShaderTechniqueRepository({rctx:g._rctx,viewingMode:1,commonUniformStore:new D.CommonUniformStore,stippleTextureRepository:g._stippleTextureRepository});g._materialRepository=new C(e.textureRepository,g._shaderTechniqueRepository);g._materialRepository.onMaterialChanged=
function(e){0<(e.renderOccluded&d.overlayRenderOccludedFlag)!==g._rendersOccluded&&g.updateRendersOccluded();g.emitContentChanged()};g._compositingHelper=e.compositingHelper;g._bindParameters={slot:null,fovY:0,highlightDepthTexture:J.createEmptyDepthTexture(g._rctx),nearFar:[W.near,W.far],origin:null,pixelRatio:null,proj:null,shadowMappingEnabled:!1,slicePlane:null,ssaoEnabled:!1,view:null,viewInvTransp:null,viewport:null,hasOccludees:!1};g._lighting.set({lights:[new P.AmbientLight(m.vec3f64.fromValues(1,
1,1))],groundLightingFactor:1,globalFactor:0});return g}t(k,c);k.prototype.dispose=function(){this._layerRenderers.forEach(function(e){return e.dispose()});this._layerRenderers.clear();for(var e in this._renderTargets)this._renderTargets[e].dispose();this._renderTargets=null;this._bindParameters.highlightDepthTexture.dispose();this._bindParameters.highlightDepthTexture=null};k.prototype.disposeRenderTarget=function(e){var g=this._renderTargets[e];g&&g.dispose();delete this._renderTargets[e]};Object.defineProperty(k.prototype,
"updating",{get:function(){return this._sortedLayerRenderersDirty||b.someMap(this._layerRenderers,function(e){return e.updating})},enumerable:!0,configurable:!0});k.prototype.commitChanges=function(){var e=this,g=!1;this._layerRenderers.forEach(function(n,k){n.commitChanges()&&(g=!0);n.isEmpty&&(e._layerRenderers.delete(k),e._sortedLayerRenderersDirty=!0,n=e._layerViewHandles.get(k))&&(n.remove(),e._layerViewHandles.delete(k))});this._sortedLayerRenderersDirty&&(this.updateSortedLayerRenderers(),
g=!0);this.emitUpdatingChanged();g&&(this.emitContentChanged(),this.updateHasHighlights(),this.updateRendersOccluded())};k.prototype.getRenderTargetTexture=function(e){return(e=this._renderTargets[e])?e.colorTexture:null};k.prototype.addGeometries=function(e,g,n){for(var k=0;k<e.length;k++){var a=e[k];null==a.origin&&(a.origin=this._localOrigins.getOrigin(a.center));a.uniqueName||(a.uniqueName="ov:"+this._uniqueIdx++);this._geometries.set(a.uniqueName,a)}this.ensureLayerRenderer(g).add(e);2===n&&
this.notifyGraphicUpdate(e,g,2)};k.prototype.removeGeometries=function(e,g,n){for(var k=0;k<e.length;k++)this._geometries.delete(e[k].uniqueName);(k=this._layerRenderers.get(g))?(k.remove(e),2===n&&this.notifyGraphicUpdate(e,g,2)):Y.warn("Attempted to remove geometry for nonexistent layer")};k.prototype.updateGeometries=function(e,g,n){var k=this._layerRenderers.get(g);k?(k.modify(e,n),this.notifyUpdateGeometries(e,g,n)):Y.warn("Attempted to update geometry for nonexistent layer")};k.prototype.notifyUpdateGeometries=
function(e,g,n){this.notifyGraphicUpdate(e,g,4===n||2===n?2:1===n?1:0)};k.prototype.notifyGraphicUpdate=function(e,g,n){if(0!==n)for(var k=-1,a=0;a<e.length;a++){var p=e[a].data.graphicUid;p!==k&&(g.notifyGraphicUpdate(p,n),k=p)}};k.prototype.updateHighlights=function(e,g){(g=this._layerRenderers.get(g))?g.modify(e,8):Y.warn("Attempted to update highlights for nonexistent layer")};k.prototype.isEmpty=function(){return 0===this._geometries.size&&!u.OVERLAY_DRAW_DEBUG_TEXTURE};Object.defineProperty(k.prototype,
"hasHighlights",{get:function(){return this._hasHighlights},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"hasWater",{get:function(){return b.someMap(this._layerRenderers,function(e){return e.hasWater})},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"rendersOccluded",{get:function(){return this._rendersOccluded},enumerable:!0,configurable:!0});k.prototype.updateLogic=function(e){var g=!1;this._layerRenderers.forEach(function(n){n.updateLogic(e)&&(g=!0)});return g};
k.prototype.updateLayerOrder=function(){this._sortedLayerRenderersDirty=!0};k.prototype.draw=function(e,g){return this.drawPass(0,e,g)};k.prototype.drawWithoutRasterImage=function(e,g){return this.drawPass(0,e,g,2)};k.prototype.drawNormals=function(e,g){return this.drawPass(2,e,g)};k.prototype.drawHighlights=function(e,g){return this.drawPass(4,e,g)};k.prototype.drawOccluded=function(e,g){return this.drawPass(0,e,g,1)};k.prototype.drawPass=function(e,g,n,k){var a=this;void 0===k&&(k=0);if(0===n.numViews)return!1;
this._pixelRatio=n.pixelRatio*Math.abs(n.views[0].extent[2]-n.views[0].extent[0])/Math.abs(n.views[0].viewport[2]-n.views[0].viewport[0]);if(this.isEmpty()||4===e&&!this.hasHighlights||2===e&&!this.hasWater||!this.hasNonZeroSizedView(n))return!1;var y=n.width,p=n.height,c=this._renderTargets[g];if(!c)return!1;c.resize(y,p);var b=this._rctx,m=W;m.pixelRatio=n.pixelRatio||1;this._renderContext.pass=e;this._bindParameters.pixelRatio=m.pixelRatio;b.bindFramebuffer(c);b.setClearColor(0,0,0,0);b.clearSafe(16384);
this.updateLightingUniforms();1===k&&(this._renderContext.renderOccludedMask=d.overlayRenderOccludedFlag);if(u.OVERLAY_DRAW_DEBUG_TEXTURE&&1!==k)for(g=0;g<n.numViews;g++)this.setViewParameters(n.views[g],m),this.drawDebugTexture(y,p,aa[n.index%aa.length]);0<this._layerRenderers.size&&this._sortedLayerRenderers.forEach(function(g){var B=g.layerView;g=g.renderer;if(2!==k||!f.isSome(B)||0!==B.drapeSourceType){var F=f.isSome(B)&&f.isSome(B.fullOpacity)&&1>B.fullOpacity&&0===e;F&&(a.bindTemporaryFramebuffer(y,
p),b.clearSafe(16384));for(var H=0;H<n.numViews;H++)a.setViewParameters(n.views[H],m),g.draw(a._renderContext,a._bindParameters,a._stats);F&&(b.bindFramebuffer(c),a._compositingHelper.composite(a.temporaryTexture,2,f.expect(f.expect(B).fullOpacity)))}});b.bindFramebuffer(null);c.colorTexture.descriptor.hasMipmap&&c.colorTexture.generateMipmap();this._renderContext.resetRenderOccludedMask();return!0};k.prototype.createRenderTarget=function(e,g){for(var n=e,k=0;this._renderTargets[n];)n=e+"_"+ ++k;
this._renderTargets[n]=new Q(this._rctx,{colorTarget:0,depthStencilTarget:0},{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9987,hasMipmap:g,maxAnisotropy:8,width:0,height:0});return n};k.prototype.disposeRenderTargetMemory=function(e){(e=this._renderTargets[e])&&e.resize(0,0)};k.prototype.bindTemporaryFramebuffer=function(e,g){f.isNone(this._temporaryRenderTargetId)&&(this._temporaryRenderTargetId=this.createRenderTarget("temp",!1));var n=this._renderTargets[this._temporaryRenderTargetId];
n.resize(e,g);this._rctx.bindFramebuffer(n)};Object.defineProperty(k.prototype,"temporaryTexture",{get:function(){return this._renderTargets[f.expect(this._temporaryRenderTargetId)].colorTexture},enumerable:!0,configurable:!0});k.prototype.getGpuMemoryUsage=function(){var e=0,g;for(g in this._renderTargets)e+=V.getGpuMemoryUsage(this._renderTargets[g]);return e};k.prototype.getStats=function(){return this._stats.getAggregatedStats()};k.prototype.intersect=function(e,g,n){var k=this,a=0;this._geometries.forEach(function(y){if(!n||
n(y)){k.intersectRenderGeometry(y,g,0,e,a);var p=k.longitudeCyclical;p&&(y.center[0]-y.bsRadius<p.min&&k.intersectRenderGeometry(y,g,p.range,e,a),y.center[0]+y.bsRadius>p.max&&k.intersectRenderGeometry(y,g,-p.range,e,a));a++}})};k.prototype.intersectRenderGeometry=function(e,g,n,k,a){var y=this,B=0;f.isSome(e.transformation)&&(n+=e.transformation[12],B=e.transformation[13]);p[0]=g[0]-n;p[1]=g[1]-B;p[2]=1;L[0]=g[0]-n;L[1]=g[1]-B;L[2]=0;e.pixelRatio=this._pixelRatio;e.material.intersect(e,null,e.getShaderTransformation(),
k,p,L,function(g,n,p){y.addIntersectionResult(p,e.material.renderPriority,a,k,e.data.layerUid,e.data.graphicUid)},e.calculateShaderTransformation,!0)};k.prototype.addIntersectionResult=function(e,g,n,k,a,p){var y={type:"external",metadata:{layerUid:a,graphicUid:p}};a=function(a){a.set(y,null,k.results.ground.dist,k.results.ground.normal,k.results.ground.transformation,g,null,null,e,n);a.intersector="OverlayRenderer"};(null==k.results.min.drapedLayerOrder||g>=k.results.min.drapedLayerOrder)&&(null==
k.results.min.dist||k.results.ground.dist<=k.results.min.dist)&&a(k.results.min);0!==k.options.store&&(null==k.results.max.drapedLayerOrder||g<k.results.max.drapedLayerOrder)&&(null==k.results.max.dist||k.results.ground.dist>k.results.max.dist)&&a(k.results.max);2===k.options.store&&(p=new G.IntersectorResult(k.ray),a(p),k.results.all.push(p))};k.prototype.ensureLayerRenderer=function(e){var g=this,n=this._layerRenderers.get(e);n||(n=new N.SortedRenderGeometryRenderer(this._rctx,this._materialRepository,
function(){return g.emitUpdatingChanged()}),this._layerRenderers.set(e,n),this._sortedLayerRenderersDirty=!0,this._layerViewHandles.set(e,e.watch("fullOpacity",function(){return g.emitContentChanged()})));return n};k.prototype.updateSortedLayerRenderers=function(){var e=this;if(this._sortedLayerRenderersDirty&&(this._sortedLayerRenderersDirty=!1,this._sortedLayerRenderers.clear(),0!==this._layerRenderers.size)){var g=b.firstKeyOfMap(this._layerRenderers).view.allLayerViews,n=r.createSetFromValues(b.valuesOfMap(this._layerRenderers));
g.forEach(function(g){var k=e._layerRenderers.get(g);k&&(e._sortedLayerRenderers.push(new T(g,k)),n.delete(k))});n.forEach(function(g){e._sortedLayerRenderers.push(new T(null,g))})}};k.prototype.setViewParameters=function(e,g){g.viewport=e.viewport;var n=e.extent;a.mat4.ortho(g.projectionMatrix,0,n[2]-n[0],0,n[3]-n[1],g.near,g.far);a.mat4.identity(g.viewMatrix);a.mat4.translate(g.viewMatrix,g.viewMatrix,[-e.extent[0],-e.extent[1],0]);g.setGLViewport(this._rctx);this._renderContext.camera=g;this._bindParameters.view=
g.viewMatrix;this._bindParameters.proj=g.projectionMatrix;this._bindParameters.viewInvTransp=g.viewInverseTransposeMatrix;this._bindParameters.viewport=g.fullViewport;this._shaderTechniqueRepository.getProgramsUsingUniform("proj").forEach(function(e){e.setUniformMatrix4fv("proj",g.projectionMatrix)})};k.prototype.updateLightingUniforms=function(){var e=this;this._shaderTechniqueRepository.getProgramsUsingUniform("lightingMainDirection").forEach(function(g){e._lighting.setUniforms(g)})};k.prototype.hasNonZeroSizedView=
function(e){for(var g=0;g<e.numViews;g++){var n=e.views[g];if(n.extent[0]!==n.extent[2]&&n.extent[1]!==n.extent[3])return!0}return!1};k.prototype.emitContentChanged=function(){if(this.onContentChanged)this.onContentChanged()};k.prototype.emitUpdatingChanged=function(){if(this.onUpdatingChanged)this.onUpdatingChanged()};k.prototype.updateHasHighlights=function(){var e=b.someMap(this._layerRenderers,function(e){return e.hasHighlights});if(e!==this._hasHighlights&&(this._hasHighlights=e,this.onHasHighlightsChanged))this.onHasHighlightsChanged(this._hasHighlights)};
k.prototype.updateRendersOccluded=function(){var e=b.someMap(this._layerRenderers,function(e){return e.rendersOccluded});if(e!==this._rendersOccluded&&(this._rendersOccluded=e,this.onRendersOccludedChanged))this.onRendersOccludedChanged(this.rendersOccluded)};k.prototype.drawDebugTexture=function(e,g,n){var k=this._rctx;this.ensureDebugPatternResources(e,g);e=this._debugPatternProgram;k.bindProgram(e);k.setPipelineState(this._debugPatternPipelineState);e.setUniform4f("color",n[0],n[1],n[2],1);e.setUniform1i("tex",
0);k.bindTexture(this._debugPatternTexture,0);k.bindVAO(this._quadVAO);k.drawArrays(5,0,V.vertexCount(this._quadVAO,"geometry"))};k.prototype.ensureDebugPatternResources=function(e,g){if(!this._debugPatternTexture){for(var n=new Uint8Array(e*g*4),k=0,a=0;a<g;a++)for(var p=0;p<e;p++){var c=Math.floor(p/10),b=Math.floor(a/10);2>c||2>b||10*c>e-20||10*b>g-20?(n[k++]=255,n[k++]=255,n[k++]=255,n[k++]=255):(n[k++]=255,n[k++]=255,n[k++]=255,c&1&&b&1?n[k++]=p&1^a&1?0:255:n[k++]=c&1^b&1?0:128)}this._debugPatternTexture=
new U(this._rctx,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,width:e,height:g},n);e=new O.TextureTechniqueConfiguration;e.hasAlpha=!0;this._debugTextureTechnique=this._shaderTechniqueRepository.acquireAndReleaseExisting(O.TextureTechnique,e,this._debugTextureTechnique);this._debugPatternProgram=this._debugTextureTechnique.program;this._debugPatternPipelineState=this._debugTextureTechnique.pipeline;this._quadVAO=J.createQuadVAO(this._rctx)}};Object.defineProperty(k.prototype,"test",
{get:function(){return{layerRenderers:this._layerRenderers}},enumerable:!0,configurable:!0});l([v.autoDispose()],k.prototype,"_shaderTechniqueRepository",void 0);l([v.autoDispose()],k.prototype,"_stippleTextureRepository",void 0);return k}(c.declared(v.AutoDisposable));d.OverlayRenderer=z;var T=function(){return function(a,k){this.layerView=a;this.renderer=k}}(),aa=[[1,.5,.5],[.5,.5,1],[.5,1,.5]],W=new E.default;W.near=1;W.far=1E4;var p=m.vec3f64.create(),L=m.vec3f64.create();d.DRAPED_Z=-2;d.overlayRenderOccludedFlag=
4})},"esri/views/3d/webgl-engine/core/shaderTechnique/CommonUniformStore":function(){define(["require","exports","../../../../../core/arrayUtils"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});z=function(){function d(){this._uniforms={proj:[],shadowMapDistance:[],viewportPixelSz:[],lightingMainDirection:[]}}d.prototype.dispose=function(){this._uniforms=null};d.prototype.getPrograms=function(d){return this._uniforms[d]||[]};d.prototype.subscribeProgram=function(d){for(var b in this._uniforms)d.hasUniform(b)&&
this._uniforms[b].push(d)};d.prototype.unsubscribeProgram=function(d){for(var b in this._uniforms)t.removeUnordered(this._uniforms[b],d)};return d}();d.CommonUniformStore=z})},"esri/views/3d/webgl-engine/core/shaderTechnique/ShaderTechniqueRepository":function(){define("require exports ../../../../../core/tsSupport/awaiterHelper ../../../../../core/tsSupport/generatorHelper ../../../../../core/maybe ../../../../../core/promiseUtils".split(" "),function(z,d,t,l,q,b){Object.defineProperty(d,"__esModule",
{value:!0});z=function(){function f(b){this._context=b;this._perConstructorInstances=new Map;this._frameCounter=0;this._keepAliveFrameCount=1200}Object.defineProperty(f.prototype,"viewingMode",{get:function(){return this._context.viewingMode},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"constructionContext",{get:function(){return this._context},enumerable:!0,configurable:!0});f.prototype.acquire=function(b,f){var c=f.key,a=this._perConstructorInstances.get(b);a||(a=new Map,this._perConstructorInstances.set(b,
a));var d=a.get(c);void 0===d?(d={technique:new b(this._context,f),refCount:1,refZeroFrame:0},a.set(c,d)):d.refCount+=1;return d.technique};f.prototype.acquireAndReleaseExisting=function(b,f,c){return q.isNone(c)?this.acquire(b,f):f.key===c.key&&c instanceof b?c:(this.release(c),this.acquire(b,f))};f.prototype.release=function(b){b=this._perConstructorInstances.get(b.constructor).get(b.key);--b.refCount;0===b.refCount&&(b.refZeroFrame=this._frameCounter)};f.prototype.frameUpdate=function(){var b=
this;this._frameCounter++;this._perConstructorInstances.forEach(function(f,c){f.forEach(function(a,c){0===a.refCount&&a.refZeroFrame+b._keepAliveFrameCount<b._frameCounter&&(a.technique.dispose(),f.delete(c))});0===f.size&&b._perConstructorInstances.delete(c)})};f.prototype.getProgramsUsingUniform=function(b){return this._context.commonUniformStore.getPrograms(b)};f.prototype.hotReload=function(){return t(this,void 0,void 0,function(){var f,d=this;return l(this,function(c){switch(c.label){case 0:return f=
[],this._perConstructorInstances.forEach(function(a,c){f.push(function(a,c){return t(d,void 0,void 0,function(){var b,f=this;return l(this,function(d){switch(d.label){case 0:return(b=c.shader)?[4,b.reload()]:[3,2];case 1:d.sent(),a.forEach(function(a){a.technique.reload(f._context)}),d.label=2;case 2:return[2]}})})}(a,c))}),[4,b.all(f)];case 1:return c.sent(),[2]}})})};return f}();d.ShaderTechniqueRepository=z})},"esri/views/3d/webgl-engine/lib/AutoDisposable":function(){define(["require","exports",
"../../../../core/tsSupport/declareExtendsHelper","../../../../core/tsSupport/decorateHelper","../../../../core/accessorSupport/decorators"],function(z,d,t,l,q){Object.defineProperty(d,"__esModule",{value:!0});d.AutoDisposableMixin=function(b){return function(b){function f(){var f=null!==b&&b.apply(this,arguments)||this;f._isDisposed=!1;return f}t(f,b);f.prototype.dispose=function(){for(var b=this.__proto__.__managedDisposables__||[],c=b.length-1;0<=c;c--){var a=b[c];this[a]&&"function"===typeof this[a].dispose&&
this[a].dispose();this[a]=null}this._isDisposed=!0};Object.defineProperty(f.prototype,"isDisposed",{get:function(){return this._isDisposed},enumerable:!0,configurable:!0});return f=l([q.subclass("esri.views.3d.webgl-engine.lib.AutoDisposableMixin")],f)}(q.declared(b))};z=function(b){function f(){return null!==b&&b.apply(this,arguments)||this}t(f,b);return f=l([q.subclass("esri.views.3d.webgl-engine.lib.AutoDisposable")],f)}(q.declared(d.AutoDisposableMixin(function(){return function(){}}())));d.AutoDisposable=
z;d.autoDispose=function(){return function(b,f){b.__managedDisposables__=b.__managedDisposables__||[];b.__managedDisposables__.push(f)}}})},"esri/views/3d/webgl-engine/lib/Camera":function(){define("require exports ../../../../core/mathUtils ../../../../core/screenUtils ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../core/libs/gl-matrix-2/vec4 ../../../../core/libs/gl-matrix-2/vec4f64 ../../support/geometryUtils ../../support/mathUtils ../../support/geometryUtils/vector ./Util".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u,D){function w(a,c){var b=c[0]-a[0],f=c[1]-a[1],d=c[2]-a[2];a=c[3]-a[3];return b*b+f*f+d*d+a*a}function v(a,c){return a[0]===c[0]&&a[1]===c[1]&&a[2]===c[2]}function E(a,c){return a[0]===c[0]&&a[1]===c[1]&&a[2]===c[2]&&a[3]===c[3]}Object.defineProperty(d,"__esModule",{value:!0});z=function(){function d(f,d,m){void 0===f&&(f=h.vec3f64.create());void 0===d&&(d=h.vec3f64.create());void 0===m&&(m=h.vec3f64.fromValues(0,0,1));this._viewUp=h.vec3f64.create();this._viewForward=
h.vec3f64.create();this._viewRight=h.vec3f64.create();this._ray=a.ray.createWrapper();this._viewport=c.vec4f64.fromValues(0,0,1,1);this._padding=c.vec4f64.fromValues(0,0,0,0);this._fov=55/180*Math.PI;this._near=1;this._far=1E3;this._viewDirty=!0;this._viewMatrix=b.mat4f64.create();this._projectionDirty=!0;this._projectionMatrix=b.mat4f64.create();this._viewProjectionDirty=!0;this._viewProjectionMatrix=b.mat4f64.create();this._viewInverseTransposeMatrixDirty=!0;this._viewInverseTransposeMatrix=b.mat4f64.create();
this._frustumDirty=!0;this._frustum=a.frustum.create();this._fullViewport=null;this.pixelRatio=1;this.relativeElevation=0;this._eye=h.vec3f64.clone(f);this._center=h.vec3f64.clone(d);this._up=h.vec3f64.clone(m);this._padding=c.vec4f64.create()}Object.defineProperty(d.prototype,"eye",{get:function(){return this._eye},set:function(a){this._compareAndSetView(a,this._eye)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"center",{get:function(){return this._center},set:function(a){this._compareAndSetView(a,
this._center)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"ray",{get:function(){this._ray.origin=this.eye;this._ray.direction||(this._ray.direction=h.vec3f64.create());f.vec3.subtract(this._ray.direction,this.center,this.eye);return this._ray},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"up",{get:function(){return this._up},set:function(a){this._compareAndSetView(a,this._up)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"viewMatrix",
{get:function(){this._ensureViewClean();return this._viewMatrix},set:function(a){q.mat4.copy(this._viewMatrix,a);this._viewDirty=!1;this._frustumDirty=this._viewProjectionDirty=this._viewInverseTransposeMatrixDirty=!0},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"viewForward",{get:function(){this._ensureViewClean();return this._viewForward},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"viewUp",{get:function(){this._ensureViewClean();return this._viewUp},
enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"viewRight",{get:function(){this._ensureViewClean();return this._viewRight},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"near",{get:function(){return this._near},set:function(a){this._near!==a&&(this._near=a,this._frustumDirty=this._viewProjectionDirty=this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"far",{get:function(){return this._far},set:function(a){this._far!==
a&&(this._far=a,this._frustumDirty=this._viewProjectionDirty=this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"viewport",{get:function(){return this._viewport},set:function(a){this.x=a[0];this.y=a[1];this.width=a[2];this.height=a[3]},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"x",{get:function(){return this._viewport[0]},set:function(a){a+=this._padding[3];this._viewport[0]!==a&&(this._viewport[0]=a,this._frustumDirty=this._viewProjectionDirty=
this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"y",{get:function(){return this._viewport[1]},set:function(a){a+=this._padding[2];this._viewport[1]!==a&&(this._viewport[1]=a,this._frustumDirty=this._viewProjectionDirty=this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"width",{get:function(){return this._viewport[2]},set:function(a){this._viewport[2]!==a&&(this._viewport[2]=a,this._frustumDirty=this._viewProjectionDirty=
this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"height",{get:function(){return this._viewport[3]},set:function(a){this._viewport[3]!==a&&(this._viewport[3]=a,this._frustumDirty=this._viewProjectionDirty=this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"fullWidth",{get:function(){return this._viewport[2]+this._padding[1]+this._padding[3]},set:function(a){this.width=a-(this._padding[1]+this._padding[3])},enumerable:!0,
configurable:!0});Object.defineProperty(d.prototype,"fullHeight",{get:function(){return this._viewport[3]+this._padding[0]+this._padding[2]},set:function(a){this.height=a-(this._padding[0]+this._padding[2])},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"fullViewport",{get:function(){this._fullViewport||(this._fullViewport=c.vec4f64.create());this._fullViewport[0]=this._viewport[0]-this._padding[3];this._fullViewport[1]=this._viewport[1]-this._padding[2];this._fullViewport[2]=
this.fullWidth;this._fullViewport[3]=this.fullHeight;return this._fullViewport},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"aspect",{get:function(){return this.width/this.height},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"padding",{get:function(){return this._padding},set:function(a){if(this._padding[0]!==a[0]||this._padding[1]!==a[1]||this._padding[2]!==a[2]||this._padding[3]!==a[3])this._viewport[0]+=a[3]-this._padding[3],this._viewport[1]+=a[2]-this._padding[2],
this._viewport[2]-=a[1]+a[3]-(this._padding[1]+this._padding[3]),this._viewport[3]-=a[0]+a[2]-(this._padding[0]+this._padding[2]),r.vec4.copy(this._padding,a),this._frustumDirty=this._viewProjectionDirty=this._projectionDirty=!0},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"viewProjectionMatrix",{get:function(){this._viewProjectionDirty&&(q.mat4.multiply(this._viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),this._viewProjectionDirty=!1);return this._viewProjectionMatrix},
enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"projectionMatrix",{get:function(){if(this._projectionDirty){var a=this.width,c=this.height,b=this.near*Math.tan(this.fovY/2),f=b*this.aspect;q.mat4.frustum(this._projectionMatrix,-f*(1+2*this._padding[3]/a),f*(1+2*this._padding[1]/a),-b*(1+2*this._padding[2]/c),b*(1+2*this._padding[0]/c),this.near,this.far);this._projectionDirty=!1}return this._projectionMatrix},set:function(a){q.mat4.copy(this._projectionMatrix,a);this._projectionDirty=
!1;this._frustumDirty=this._viewProjectionDirty=!0},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"fov",{get:function(){return this._fov},set:function(a){this._fov=a;this._frustumDirty=this._viewProjectionDirty=this._projectionDirty=!0},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"fovX",{get:function(){return D.fovd2fovx(this._fov,this.width,this.height)},set:function(a){this._fov=D.fovx2fovd(a,this.width,this.height);this._frustumDirty=this._viewProjectionDirty=
this._projectionDirty=!0},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"fovY",{get:function(){return D.fovd2fovy(this._fov,this.width,this.height)},set:function(a){this._fov=D.fovy2fovd(a,this.width,this.height);this._frustumDirty=this._viewProjectionDirty=this._projectionDirty=!0},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"distance",{get:function(){return f.vec3.distance(this._center,this._eye)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,
"frustum",{get:function(){this._recomputeFrustum();return this._frustum},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"viewInverseTransposeMatrix",{get:function(){if(this._viewInverseTransposeMatrixDirty||this._viewDirty)this._viewInverseTransposeMatrix||(this._viewInverseTransposeMatrix=b.mat4f64.create()),q.mat4.invert(this._viewInverseTransposeMatrix,this.viewMatrix),q.mat4.transpose(this._viewInverseTransposeMatrix,this._viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=
!1;return this._viewInverseTransposeMatrix},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"perRenderPixelRatio",{get:function(){return Math.tan(this.fovX/2)/(this.width/2)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"perScreenPixelRatio",{get:function(){return this.perRenderPixelRatio*this.pixelRatio},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"aboveGround",{get:function(){return 0<=this.relativeElevation},enumerable:!0,configurable:!0});
d.prototype.copyFrom=function(d){f.vec3.copy(this._eye,d._eye);f.vec3.copy(this._center,d._center);f.vec3.copy(this._up,d._up);r.vec4.copy(this._viewport,d._viewport);r.vec4.copy(this._padding,d._padding);this._near=d._near;this._far=d._far;this._fov=d._fov;this.relativeElevation=d.relativeElevation;this._viewDirty=d._viewDirty;this._viewDirty||(q.mat4.copy(this._viewMatrix,d._viewMatrix),f.vec3.copy(this._viewRight,d._viewRight),f.vec3.copy(this._viewUp,d._viewUp),f.vec3.copy(this._viewForward,d._viewForward));
d._projectionDirty?this._projectionDirty=!0:(q.mat4.copy(this._projectionMatrix,d._projectionMatrix),this._projectionDirty=!1);this._viewProjectionDirty=!0;this._frustumDirty=d._frustumDirty;this._frustumDirty||(a.frustum.copy(d._frustum,this._frustum),this._frustumDirty=!1);d._viewInverseTransposeMatrixDirty?this._viewInverseTransposeMatrixDirty=!0:(this._viewInverseTransposeMatrix?q.mat4.copy(this._viewInverseTransposeMatrix,d._viewInverseTransposeMatrix):this._viewInverseTransposeMatrix=b.mat4f64.clone(d._viewInverseTransposeMatrix),
this._viewInverseTransposeMatrixDirty=!1);d._fullViewport?this._fullViewport?r.vec4.copy(this._fullViewport,d._fullViewport):this._fullViewport=c.vec4f64.clone(d._fullViewport):this._fullViewport=null;this.pixelRatio=d.pixelRatio;return this};d.prototype.copyViewFrom=function(a){this.eye=a.eye;this.center=a.center;this.up=a.up};d.prototype.clone=function(){var a=new d;a.copyFrom(this);return a};d.prototype.equals=function(a){return v(this._eye,a._eye)&&v(this._center,a._center)&&v(this._up,a._up)&&
E(this._viewport,a._viewport)&&E(this._padding,a._padding)&&this._near===a._near&&this._far===a._far&&this._fov===a._fov&&this.pixelRatio===a.pixelRatio&&this.relativeElevation===a.relativeElevation};d.prototype.almostEquals=function(a,c,b){void 0===b&&(b=!1);c=f.vec3.distance(this._eye,this._center)*(c||5E-4);c*=c;b?(m.directionFromTo(K,a._eye,a._center),m.directionFromTo(G,this._eye,this._center),b=1E-10):(f.vec3.copy(K,a._center),f.vec3.copy(G,this._center),b=c);return f.vec3.squaredDistance(a._eye,
this._eye)<c&&f.vec3.squaredDistance(K,G)<b&&.001>Math.abs(a._fov-this._fov)&&.5>w(a._padding,this._padding)&&.5>w(a._viewport,this._viewport)&&this.pixelRatio===a.pixelRatio};d.prototype.markViewDirty=function(){this._viewProjectionDirty=this._frustumDirty=this._viewDirty=!0};d.prototype.computeRenderPixelSizeAt=function(a){return this.computeRenderPixelSizeAtDist(this.viewDirectionDistance(a))};d.prototype.computeRenderPixelSizeAtDist=function(a){return a*this.perRenderPixelRatio};d.prototype.computeScreenPixelSizeAt=
function(a){return this.computeScreenPixelSizeAtDist(this.viewDirectionDistance(a))};d.prototype.viewDirectionDistance=function(a){return Math.abs(u.projectPointSignedLength(this.viewForward,f.vec3.subtract(K,a,this._eye)))};d.prototype.computeScreenPixelSizeAtDist=function(a){return a*this.perScreenPixelRatio};d.prototype.computeDistanceFromRadius=function(a,c){return a/Math.tan(Math.min(this.fovX,this.fovY)/(2*(c||1)))};d.prototype.getScreenCenter=function(a){void 0===a&&(a=l.createScreenPointArray());
a[0]=(this.padding[3]+this.width/2)/this.pixelRatio;a[1]=(this.padding[0]+this.height/2)/this.pixelRatio;return a};d.prototype.getRenderCenter=function(a,c,b){void 0===c&&(c=.5);void 0===b&&(b=.5);a||(a=l.createRenderScreenPointArray3());a[0]=this.padding[3]+this.width*c;a[1]=this.padding[2]+this.height*b;2<a.length&&(a[2]=.5);return a};d.prototype.setGLViewport=function(a){var c=this.viewport,b=this.padding;a.setViewport(c[0]-b[3],c[1]-b[2],c[2]+b[1]+b[3],c[3]+b[0]+b[2])};d.prototype.applyProjection=
function(a,c,b){void 0===b&&(b=!1);a!==C&&f.vec3.copy(C,a);C[3]=1;b&&(c[2]=-C[2]);r.vec4.transformMat4(C,C,this.projectionMatrix);f.vec3.scale(C,C,1/Math.abs(C[3]));a=this.fullViewport;c[0]=t.lerp(0,a[0]+a[2],.5+.5*C[0]);c[1]=t.lerp(0,a[1]+a[3],.5+.5*C[1]);b||(c[2]=.5*(C[2]+1));return c};d.prototype.projectPoint=function(a,c){C[0]=a[0];C[1]=a[1];C[2]=a[2];C[3]=1;r.vec4.transformMat4(C,C,this.viewProjectionMatrix);if(0===C[3])return null;f.vec3.scale(C,C,1/Math.abs(C[3]));a=this.fullViewport;"x"in
c?(c.x=t.lerp(0,a[0]+a[2],.5+.5*C[0]),c.y=t.lerp(0,a[1]+a[3],.5+.5*C[1])):(c[0]=t.lerp(0,a[0]+a[2],.5+.5*C[0]),c[1]=t.lerp(0,a[1]+a[3],.5+.5*C[1]),2<c.length&&(c[2]=.5*(C[2]+1)));return c};d.prototype.unprojectPoint=function(a,c){q.mat4.multiply(J,this.projectionMatrix,this.viewMatrix);if(!q.mat4.invert(J,J))return null;var b=this.fullViewport;C[0]=2*(a[0]-b[0])/b[2]-1;C[1]=2*(a[1]-b[1])/b[3]-1;C[2]=2*a[2]-1;C[3]=1;r.vec4.transformMat4(C,C,J);if(0===C[3])return null;c[0]=C[0]/C[3];c[1]=C[1]/C[3];
c[2]=C[2]/C[3];return c};d.prototype.computeUp=function(a){"global"===a?this.computeUpGlobal():this.computeUpLocal()};d.prototype.screenToRender=function(a,c){var b=this.fullHeight-a[1]*this.pixelRatio;c[0]=a[0]*this.pixelRatio;c[1]=b;return c};d.prototype.renderToScreen=function(a,c){var b=(this.fullHeight-a[1])/this.pixelRatio;c[0]=a[0]/this.pixelRatio;c[1]=b;return c};d.prototype.computeUpGlobal=function(){f.vec3.subtract(K,this.center,this.eye);var a=f.vec3.length(this.center);1>a?(f.vec3.set(this.up,
0,0,1),this.markViewDirty()):Math.abs(f.vec3.dot(K,this.center))>.9999*f.vec3.length(K)*a||(f.vec3.cross(this.up,K,this.center),f.vec3.cross(this.up,this.up,K),f.vec3.normalize(this.up,this.up),this.markViewDirty())};d.prototype.computeUpLocal=function(){m.directionFromTo(K,this.eye,this.center);.9999>=Math.abs(K[2])&&(f.vec3.scale(K,K,K[2]),f.vec3.set(this.up,-K[0],-K[1],1-K[2]),f.vec3.normalize(this.up,this.up),this.markViewDirty())};d.prototype._compareAndSetView=function(a,c){v(a,c)||(f.vec3.copy(c,
a),this._viewProjectionDirty=this._frustumDirty=this._viewDirty=!0)};d.prototype._recomputeFrustum=function(){this._frustumDirty&&(a.frustum.fromMatrix(this.viewMatrix,this.projectionMatrix,this._frustum),this._frustumDirty=!1)};d.prototype._ensureViewClean=function(){this._viewDirty&&(q.mat4.lookAt(this._viewMatrix,this._eye,this._center,this._up),f.vec3.set(this._viewForward,-this._viewMatrix[2],-this._viewMatrix[6],-this._viewMatrix[10]),f.vec3.set(this._viewUp,this._viewMatrix[1],this._viewMatrix[5],
this._viewMatrix[9]),f.vec3.set(this._viewRight,this._viewMatrix[0],this._viewMatrix[4],this._viewMatrix[8]),this._viewDirty=!1,this._viewInverseTransposeMatrixDirty=!0)};return d}();d.default=z;var C=c.vec4f64.create(),J=b.mat4f64.create(),K=h.vec3f64.create(),G=h.vec3f64.create()})},"esri/views/3d/webgl-engine/lib/GLMaterialRep":function(){define("require exports ../../../../core/Logger ../../../../core/maybe ../core/shaderLibrary/ShaderOutputOptions ./Util".split(" "),function(z,d,t,l,q,b){var f=
t.getLogger("esri.views.3d.webgl-engine.lib.GLMaterialRep"),h=function(){function f(c){this.refCnt=0;this.glMaterial=c}f.prototype.incRefCnt=function(){++this.refCnt};f.prototype.decRefCnt=function(){--this.refCnt;b.assert(0<=this.refCnt)};f.prototype.getRefCnt=function(){return this.refCnt};f.prototype.getGLMaterial=function(){return this.glMaterial};return f}();return function(){function b(c,a,b){this._textureRep=c;this._techniqueRep=a;this.onMaterialChanged=b;this._id2glMaterialRef=new Map}b.prototype.acquire=
function(c,a){this.ownMaterial(c);var b=q.getShaderOutputID(c.id,a),f=this._id2glMaterialRef.get(b);null==f?(c=c.getGLMaterial({material:c,techniqueRep:this._techniqueRep,textureRep:this._textureRep,output:a}),f=new h(c),this._id2glMaterialRef.set(b,f)):c=f.getGLMaterial();f.incRefCnt();return c};b.prototype.release=function(c,a){c=q.getShaderOutputID(c.id,a);a=this._id2glMaterialRef.get(c);a.decRefCnt();0===a.getRefCnt()&&((a=a.getGLMaterial())&&a.dispose(),this._id2glMaterialRef.delete(c))};b.prototype.materialChanged=
function(c){for(var a=0,b=q.ShaderOutputTypes;a<b.length;a++){var f=b[a];5!==f.output&&6!==f.output&&(f=this._id2glMaterialRef.get(q.getShaderOutputID(c.id,f.output)))&&f.getGLMaterial()&&(f=f.getGLMaterial(),f.updateParameters&&f.updateParameters())}if(this.onMaterialChanged)this.onMaterialChanged(c)};b.prototype.ownMaterial=function(c){l.isSome(c.materialRepository)&&c.materialRepository!==this&&f.error("Material is already owned by a different material repository");c.materialRepository=this};return b}()})},
"esri/views/3d/webgl-engine/core/shaderLibrary/ShaderOutputOptions":function(){define(["require","exports","../../../../../core/arrayUtils"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});d.ShaderOutputTypes=[{output:0,name:"color"},{output:1,name:"depth"},{output:2,name:"normal"},{output:3,name:"depthShadowMap"},{output:4,name:"highlight"},{output:5,name:"draped"},{output:6,name:"occlusion"}];d.getShaderOutputID=function(l,q){return l+"_"+t.find(d.ShaderOutputTypes,function(b){return b.output===
q}).name}})},"esri/views/3d/webgl-engine/lib/glUtil3D":function(){define("require exports ./DefaultVertexAttributeLocations ./DefaultVertexBufferLayouts ../../../webgl/BufferObject ../../../webgl/Texture ../../../webgl/VertexArrayObject".split(" "),function(z,d,t,l,q,b,f){Object.defineProperty(d,"__esModule",{value:!0});d.createQuadVAO=function(b,d,c){void 0===d&&(d=l.Pos2);void 0===c&&(c=t.Default3D);var a=null;switch(d){case l.Pos2Tex:a=new Float32Array([-1,-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1]);break;
default:a=new Float32Array([-1,-1,1,-1,-1,1,1,1])}return new f(b,c,{geometry:d},{geometry:q.createVertex(b,35044,a)})};d.createEmptyTexture=function(f,d){void 0===d&&(d=4);return new b(f,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,width:d,height:d})};d.createColorTexture=function(f,d,c){void 0===c&&(c=4);for(var a=new Uint8Array(c*c*4),m=0;m<a.length;m+=4)a[m+0]=255*d[0],a[m+1]=255*d[1],a[m+2]=255*d[2],a[m+3]=255*d[3];return new b(f,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,
width:c,height:c},a)};d.createEmptyDepthTexture=function(f){return new b(f,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array([255,255,255,255]))}})},"esri/views/3d/webgl-engine/lib/DefaultVertexAttributeLocations":function(){define(["require","exports"],function(z,d){Object.defineProperty(d,"__esModule",{value:!0});d.Default3D={position:0,normal:1,normalCompressed:1,uv0:2,color:3,size:4,tangent:4,auxpos1:5,symbolColor:5,componentIndex:5,auxpos2:6,featureAttribute:6,
instanceFeatureAttribute:6,region:7,instanceColor:7,model:8,modelNormal:12,modelOriginHi:11,modelOriginLo:15}})},"esri/views/3d/webgl-engine/lib/DefaultVertexBufferLayouts":function(){define(["require","exports"],function(z,d){Object.defineProperty(d,"__esModule",{value:!0});d.Pos3=[{name:"position",count:3,type:5126,offset:0,stride:12,normalized:!1}];d.Pos3Tex=[{name:"position",count:3,type:5126,offset:0,stride:20,normalized:!1},{name:"uv0",count:2,type:5126,offset:12,stride:20,normalized:!1}];d.Pos3NormalTex=
[{name:"position",count:3,type:5126,offset:0,stride:32,normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:32,normalized:!1},{name:"uv0",count:2,type:5126,offset:24,stride:32,normalized:!1}];d.Pos3Col=[{name:"position",count:3,type:5126,offset:0,stride:16,normalized:!1},{name:"color",count:4,type:5121,offset:12,stride:16,normalized:!1}];d.Pos2=[{name:"position",count:2,type:5126,offset:0,stride:8,normalized:!1}];d.Pos2Tex=[{name:"position",count:2,type:5126,offset:0,stride:16,normalized:!1},
{name:"uv0",count:2,type:5126,offset:8,stride:16,normalized:!1}]})},"esri/views/webgl/BufferObject":function(){define(["require","exports","../../core/has","../../core/typedArrayUtil"],function(z,d,t,l){return function(){function d(b,f,h,l,c){this._glName=this._context=null;this._bufferType=void 0;this._usage=35044;this._size=-1;this._indexType=void 0;this._context=b;this._bufferType=f;this._usage=h;this._id=d._nextId++;this._glName=this._context.gl.createBuffer();l&&this.setData(l,c)}d.createIndex=
function(b,f,h,l){return new d(b,34963,f,h,l)};d.createVertex=function(b,f,h){return new d(b,34962,f,h)};Object.defineProperty(d.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"usage",{get:function(){return this._usage},
enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"bufferType",{get:function(){return this._bufferType},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"indexType",{get:function(){return this._indexType},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"byteSize",{get:function(){return 34962===this._bufferType?this._size:5125===this._indexType?4*this._size:2*this._size},enumerable:!0,configurable:!0});d.prototype.dispose=function(){this._context&&
(this._glName&&(this._context.gl.deleteBuffer(this._glName),this._glName=null),this._context=null)};d.prototype.setData=function(b,f){if(b){if("number"===typeof b){if(0>b&&console.error("Buffer size cannot be negative!"),34963===this._bufferType&&f)switch(this._indexType=f,this._size=b,f){case 5123:b*=2;break;case 5125:b*=4}}else f=b.byteLength,l.isUint16Array(b)&&(f/=2,this._indexType=5123),l.isUint32Array(b)&&(f/=4,this._indexType=5125),this._size=f;f=this._context.getBoundVAO();this._context.bindVAO(null);
this._context.bindBuffer(this);this._context.gl.bufferData(this._bufferType,b,this._usage);this._context.bindVAO(f)}};d.prototype.setSubData=function(b,f,d,r){void 0===f&&(f=0);void 0===d&&(d=0);if(b){(0>f||f>=this._size)&&console.error("offset is out of range!");var c=f,a=d,m=r,h=b.byteLength;l.isUint16Array(b)&&(h/=2,c*=2,a*=2,m*=2);l.isUint32Array(b)&&(h/=4,c*=4,a*=4,m*=4);void 0===r&&(r=h-1);d>=r&&console.error("end must be bigger than start!");f+d-r>this._size&&console.error("An attempt to write beyond the end of the buffer!");
f=this._context.getBoundVAO();this._context.bindVAO(null);this._context.bindBuffer(this);d=this._context.gl;b=ArrayBuffer.isView(b)?b.buffer:b;d.bufferSubData(this._bufferType,c,b.slice(a,m));this._context.bindVAO(f)}};d._nextId=0;return d}()})},"esri/views/webgl/Texture":function(){define(["require","exports","../../core/tsSupport/assignHelper","../../core/has","../../core/mathUtils"],function(z,d,t,l,q){return function(){function b(f,d,l){this._glName=this._context=null;this._id=-1;this._descriptor=
void 0;this._wrapModeDirty=this._samplingModeDirty=!1;this._boundToUnits=new Set;this._context=f;this._descriptor=t({target:3553,samplingMode:9729,wrapMode:10497,flipped:!1,hasMipmap:!1,isOpaque:!1,unpackAlignment:4,preMultiplyAlpha:!1},d);this._id=++b._nextId;this.setData(l)}Object.defineProperty(b.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"descriptor",{get:function(){return this._descriptor},enumerable:!0,configurable:!0});b.prototype.dispose=function(){var b=this;if(this._context&&this._context.gl){if(this._glName){var d=this._context.gl;this._boundToUnits.forEach(function(f){b._context.bindTexture(null,f)});d.deleteTexture(this._glName);this._glName=null}this._context=null}};b.prototype.release=function(){this.dispose()};b.prototype.resize=function(b,d){var f=this._descriptor;if(f.width!==b||f.height!==d)f.width=b,f.height=d,this.setData(null)};
b.prototype.setData=function(f){var d=this._context.gl;this._glName||(this._glName=d.createTexture());void 0===f&&(f=null);null===f&&(this._descriptor.width=this._descriptor.width||4,this._descriptor.height=this._descriptor.height||4);var l=this._context.getBoundTexture(0);this._context.bindTexture(this,0);var c=this._descriptor;b._validateTexture(c);d.pixelStorei(d.UNPACK_ALIGNMENT,c.unpackAlignment);d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,c.flipped?1:0);d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,
c.preMultiplyAlpha?1:0);var a=c.pixelFormat,m=c.internalFormat?c.internalFormat:a;if(f instanceof ImageData||f instanceof HTMLImageElement||f instanceof HTMLCanvasElement||f instanceof HTMLVideoElement){var q=f.width,t=f.height;f instanceof HTMLVideoElement&&(q=f.videoWidth,t=f.videoHeight);c.width&&c.height&&console.assert(q===c.width&&t===c.height);d.texImage2D(d.TEXTURE_2D,0,m,a,c.dataType,f);c.hasMipmap&&this.generateMipmap();void 0===c.width&&(c.width=q);void 0===c.height&&(c.height=t)}else if(null!=
c.width&&null!=c.height||console.error("Width and height must be specified!"),d.DEPTH24_STENCIL8&&m===d.DEPTH_STENCIL&&(m=d.DEPTH24_STENCIL8),q=c.width,t=c.height,null!=f&&"type"in f&&"compressed"===f.type){a=Math.round(Math.log(Math.max(q,t))/Math.LN2)+1;c.hasMipmap=c.hasMipmap&&a===f.levels.length;for(var w=0;;++w){d.compressedTexImage2D(d.TEXTURE_2D,w,m,q,t,0,f.levels[Math.min(w,f.levels.length-1)]);if(1===q&&1===t||!c.hasMipmap)break;q=Math.max(1,q>>1);t=Math.max(1,t>>1)}}else if(f)d.texImage2D(d.TEXTURE_2D,
0,m,q,t,0,a,c.dataType,f),c.hasMipmap&&this.generateMipmap();else for(w=0;;++w){d.texImage2D(d.TEXTURE_2D,w,m,q,t,0,a,c.dataType,null);if(1===q&&1===t||!c.hasMipmap)break;q=Math.max(1,q>>1);t=Math.max(1,t>>1)}b._applySamplingMode(d,this._descriptor);b._applyWrapMode(d,this._descriptor);b._applyAnisotropicFilteringParameters(this._context,this._descriptor);this._context.bindTexture(l,0)};b.prototype.updateData=function(b,d,l,c,a,m){m||console.error("An attempt to use uninitialized data!");this._glName||
console.error("An attempt to update uninitialized texture!");var f=this._context.gl,h=this._descriptor,r=this._context.getBoundTexture(0);this._context.bindTexture(this,0);(0>d||0>l||c>h.width||a>h.height||d+c>h.width||l+a>h.height)&&console.error("An attempt to update out of bounds of the texture!");f.pixelStorei(f.UNPACK_ALIGNMENT,h.unpackAlignment);f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,h.flipped?1:0);f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,h.preMultiplyAlpha?1:0);m instanceof ImageData||m instanceof
HTMLImageElement||m instanceof HTMLCanvasElement||m instanceof HTMLVideoElement?f.texSubImage2D(f.TEXTURE_2D,b,d,l,h.pixelFormat,h.dataType,m):f.texSubImage2D(f.TEXTURE_2D,b,d,l,c,a,h.pixelFormat,h.dataType,m);this._context.bindTexture(r,0)};b.prototype.generateMipmap=function(){var f=this._descriptor;f.hasMipmap||(f.hasMipmap=!0,b._validateTexture(f));9729===f.samplingMode?(this._samplingModeDirty=!0,f.samplingMode=9985):9728===f.samplingMode&&(this._samplingModeDirty=!0,f.samplingMode=9984);f=this._context.getBoundTexture(0);
this._context.bindTexture(this,0);var d=this._context.gl;d.generateMipmap(d.TEXTURE_2D);this._context.bindTexture(f,0)};b.prototype.setSamplingMode=function(f){f!==this._descriptor.samplingMode&&(this._descriptor.samplingMode=f,b._validateTexture(this._descriptor),this._samplingModeDirty=!0)};b.prototype.setWrapMode=function(f){f!==this._descriptor.wrapMode&&(this._descriptor.wrapMode=f,b._validateTexture(this._descriptor),this._wrapModeDirty=!0)};b.prototype.applyChanges=function(){var f=this._context.gl,
d=this._descriptor;this._samplingModeDirty&&(b._applySamplingMode(f,d),this._samplingModeDirty=!1);this._wrapModeDirty&&(b._applyWrapMode(f,d),this._wrapModeDirty=!1)};b.prototype.setBoundToUnit=function(b,d){d?this._boundToUnits.add(b):this._boundToUnits.delete(b)};b._validateTexture=function(b){(0>b.width||0>b.height)&&console.error("Negative dimension parameters are not allowed!");q.isPowerOfTwo(b.width)&&q.isPowerOfTwo(b.height)||("number"===typeof b.wrapMode?33071!==b.wrapMode&&console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"):
33071===b.wrapMode.s&&33071===b.wrapMode.t||console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"),b.hasMipmap&&console.error("Mipmapping requires power-of-two textures!"))};b._applySamplingMode=function(b,d){var f=d.samplingMode,c=d.samplingMode;if(9985===f||9987===f)f=9729,d.hasMipmap||(c=9729);else if(9984===f||9986===f)f=9728,d.hasMipmap||(c=9728);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,f);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,c)};b._applyWrapMode=
function(b,d){"number"===typeof d.wrapMode?(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,d.wrapMode),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,d.wrapMode)):(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,d.wrapMode.s),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,d.wrapMode.t))};b._applyAnisotropicFilteringParameters=function(b,d){if(null!=d.maxAnisotropy){var f=b.capabilities.textureFilterAnisotropic;f&&(b=b.gl,b.texParameterf(b.TEXTURE_2D,f.TEXTURE_MAX_ANISOTROPY,d.maxAnisotropy))}};b._nextId=
0;return b}()})},"esri/views/webgl/VertexArrayObject":function(){define(["require","exports","../../core/has","./Util"],function(z,d,t,l){return function(){function d(b,f,h,l,c){this._locations=this._layout=this._glName=this._context=null;this._indexBuffer=this._buffers=void 0;this._initialized=!1;this._context=b;this._layout=h;this._buffers=l;this._locations=f;c&&(this._indexBuffer=c);this._id=d._nextId++}Object.defineProperty(d.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});
Object.defineProperty(d.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"vertexBuffers",{get:function(){return this._buffers},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"indexBuffer",{get:function(){return this._indexBuffer},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"size",{get:function(){var b=this;return Object.keys(this._buffers).reduce(function(f,d){return f+b._buffers[d].size},
this._indexBuffer?this._indexBuffer.size:0)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"layout",{get:function(){return this._layout},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"locations",{get:function(){return this._locations},enumerable:!0,configurable:!0});d.prototype.dispose=function(b){void 0===b&&(b=!0);if(this._context){var f=this._context.capabilities.vao;f&&this._glName&&(f.deleteVertexArray(this._glName),this._glName=null);this._context.getBoundVAO()===
this&&this._context.bindVAO(null);if(b){for(var d in this._buffers)this._buffers[d].dispose(),delete this._buffers[d];this._indexBuffer&&(this._indexBuffer.dispose(),this._indexBuffer=null)}this._context=null}};d.prototype.initialize=function(){if(!this._initialized){var b=this._context.capabilities.vao;if(b){var f=b.createVertexArray();b.bindVertexArray(f);this._bindLayout();b.bindVertexArray(null);this._glName=f}this._initialized=!0}};d.prototype.bind=function(){this.initialize();var b=this._context.capabilities.vao;
b?b.bindVertexArray(this.glName):(this._context.bindVAO(null),this._bindLayout())};d.prototype._bindLayout=function(){var b=this._buffers,f=!!this._context.capabilities.vao,d=this._layout,r=this._indexBuffer;b||console.error("Vertex buffer dictionary is empty!");var c=this._context.gl,a;for(a in b){var m=b[a];m||console.error("Vertex buffer is uninitialized!");var q=d[a];q||console.error("Vertex element descriptor is empty!");l.bindVertexBufferLayout(this._context,this._locations,m,q)}r&&(f?c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,
r.glName):this._context.bindBuffer(r))};d.prototype.unbind=function(){this.initialize();var b=this._context.capabilities.vao;b?b.bindVertexArray(null):this._unbindLayout()};d.prototype._unbindLayout=function(){var b=this._buffers,f=this._layout;b||console.error("Vertex buffer dictionary is empty!");for(var d in b){var r=b[d];r||console.error("Vertex buffer is uninitialized!");l.unbindVertexBufferLayout(this._context,this._locations,r,f[d])}(b=this._indexBuffer)&&this._context.unbindBuffer(b.bufferType)};
d._nextId=0;return d}()})},"esri/views/webgl/Util":function(){define(["require","exports","../../core/tsSupport/assignHelper","../../core/compilerUtils"],function(z,d,t,l){function q(b){return b[0].stride}function b(b){switch(b){case 5126:return 4;case 5124:return 4;case 5125:return 4;case 5122:return 2;case 5123:return 2;case 5120:return 1;case 5121:return 1;default:throw l.neverReached(b),Error("Unknown data type");}}function f(b){switch(b){case 6406:case 6409:return 1;case 6410:return 2;case 6407:return 3;
case 6408:return 4;case 34041:return 4;case 33325:return 2;case 33326:return 4;case 35898:return 4;case 33327:return 4;case 33328:return 8;case 34842:return 8;case 34836:return 16;case 33189:return 2;case 34041:return 4;case 32854:return 2;case 36168:return 1;default:l.neverReached(b)}return 0}function h(b){if(!b)return 0;if("colorAttachment"in b)return b.glName?h(b.colorAttachment)+h(b.depthStencilAttachment):0;if("descriptor"in b)return b.glName?h(b.descriptor):0;var c=b.internalFormat||"pixelFormat"in
b&&b.pixelFormat;if(!c)return 0;var a="hasMipmap"in b&&b.hasMipmap?1.3:1;b=b.width*b.height;return f(c)*b*a}Object.defineProperty(d,"__esModule",{value:!0});d.vertexCount=function(b,c){return b.vertexBuffers[c].size/q(b.layout[c])};d.getStride=q;d.getBytesPerElement=b;d.getTypedArrayConstructor=function(b){switch(b){case 5120:return Int8Array;case 5126:return Float32Array;case 5124:return Int32Array;case 5122:return Int16Array;case 5121:return Uint8Array;case 5125:return Uint32Array;case 5123:return Uint16Array;
default:throw l.neverReached(b),Error("Unknown data type");}};d.addDescriptor=function(f,c,a,d,h,l){var m=b(d);if(0<f.length){var r=f[0].stride,q=r+m*a;f.forEach(function(a){return a.stride=q});f.push({name:c,count:a,type:d,offset:r,stride:q,normalized:h,divisor:l})}else f.push({name:c,count:a,type:d,offset:0,stride:m*a,normalized:h,divisor:l})};d.hasAttribute=function(b,c){for(var a=0;a<b.length;a++)if(b[a].name===c)return!0;return!1};d.findAttribute=function(b,c){for(var a=0;a<b.length;a++)if(b[a].name===
c)return b[a];return null};d.copyFramebufferToTexture=function(b,c,a,f,d){void 0===d&&(d=0);var m=b.getBoundFramebufferObject(),h=b.getBoundTexture(0);b.bindFramebuffer(c);b.bindTexture(a,0);b.gl.copyTexImage2D(b.gl.TEXTURE_2D,d,a.descriptor.pixelFormat,f[0],f[1],f[2],f[3],0);b.gl.flush();b.bindFramebuffer(m);b.bindTexture(h,0)};d.setBaseInstanceOffset=function(b,c){var a={},f;for(f in b)a[f]=b[f].map(function(a){return a.divisor?t({},a,{baseInstance:c}):a});return a};d.bindVertexBufferLayout=function(b,
c,a,f,d){var m=b.gl,h=b.capabilities.instancing;b.bindBuffer(a);for(b=0;b<f.length;b++){a=f[b];var l=c[a.name],r=(d?d:0+a.baseInstance?a.baseInstance:0)*a.stride;void 0===l&&console.error("There is no location for vertex attribute '"+a.name+"' defined.");a.baseInstance&&!a.divisor&&console.error("Vertex attribute '"+a.name+"' uses baseInstanceOffset without divisor.");if(4>=a.count)m.vertexAttribPointer(l,a.count,a.type,a.normalized,a.stride,a.offset+r),m.enableVertexAttribArray(l),a.divisor&&0<a.divisor&&
h&&h.vertexAttribDivisor(l,a.divisor);else if(9===a.count)for(var q=0;3>q;q++)m.vertexAttribPointer(l+q,3,a.type,a.normalized,a.stride,a.offset+12*q+r),m.enableVertexAttribArray(l+q),a.divisor&&0<a.divisor&&h&&h.vertexAttribDivisor(l+q,a.divisor);else if(16===a.count)for(q=0;4>q;q++)m.vertexAttribPointer(l+q,4,a.type,a.normalized,a.stride,a.offset+16*q+r),m.enableVertexAttribArray(l+q),a.divisor&&0<a.divisor&&h&&h.vertexAttribDivisor(l+q,a.divisor);else console.error("Unsupported vertex attribute element count: "+
a.count)}};d.unbindVertexBufferLayout=function(b,c,a,f){var d=b.gl,m=b.capabilities.instancing;b.bindBuffer(a);for(a=0;a<f.length;a++){var h=f[a],l=c[h.name];if(4>=h.count)d.disableVertexAttribArray(l),h.divisor&&0<h.divisor&&m&&m.vertexAttribDivisor(l,0);else if(9===h.count)for(var r=0;3>r;r++)d.disableVertexAttribArray(l+r),h.divisor&&0<h.divisor&&m&&m.vertexAttribDivisor(l+r,0);else if(16===h.count)for(r=0;4>r;r++)d.disableVertexAttribArray(l+r),h.divisor&&0<h.divisor&&m&&m.vertexAttribDivisor(l+
r,0);else console.error("Unsupported vertex attribute element count: "+h.count)}b.unbindBuffer(34962)};d.getBytesPerElementFormat=f;d.getGpuMemoryUsage=h})},"esri/views/3d/webgl-engine/lib/GridLocalOriginFactory":function(){define("require exports ../../../../core/maybe ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../geometry/SpatialReference ../../support/projectionUtils ./Geometry ./GeometryData ./Layer ./localOrigin ./Object3D ./Util ../materials/RibbonLineMaterial".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u,D,w){var v=0;z=function(){function b(){this.ROOT_ORIGIN_ID="rg_root_"+v++;this._origins=new Map;this._gridSize=42E5}b.prototype.getOrigin=function(a){var c=this._origins.get(this.ROOT_ORIGIN_ID);if(null==c){if(t.isSome(b.testOrigin)){var f=b.testOrigin;this._origins.set(this.ROOT_ORIGIN_ID,m.fromValues(f[0],f[1],f[2],this.ROOT_ORIGIN_ID));return this.getOrigin(a)}f=m.fromValues(a[0]+Math.random()-.5,a[1]+Math.random()-.5,a[2]+Math.random()-.5,this.ROOT_ORIGIN_ID);
this._origins.set(this.ROOT_ORIGIN_ID,f);return f}q.vec3.subtract(E,a,c.vec3);E[0]=Math.abs(E[0]);E[1]=Math.abs(E[1]);E[2]=Math.abs(E[2]);f=this._gridSize;if(E[0]<f&&E[1]<f&&E[2]<f)return c;var c=Math.round(a[0]/f),d=Math.round(a[1]/f);a=Math.round(a[2]/f);var h="rg_"+c+"/"+d+"/"+a,l=this._origins.get(h);l||(l=m.fromValues(c*f,d*f,a*f,h),this._origins.set(h,l));return l};b.prototype._drawOriginBox=function(b){var d=window.view,m=d._stage;if(null==this._object){this._material=new w({width:2,color:[0,
1,0,1]},"GridLocalOriginMaterial");m.add(3,this._material);var q=new a("GridLocalOrigin",{isPickable:!1});m.add(0,q);this._object=new u({idHint:"GridLocalOrigin",castShadow:!1});m.add(1,this._object);q.addObject(this._object);m.addToViewContent([q.id])}for(var v=[0,1,5,4,0,2,1,7,6,2,0,1,3,7,5,4,6,2,0],t=v.length,C=new Float32Array(3*t),q=new Uint32Array(2*(t-1)),E=.5*this._gridSize,J=0;J<t;J++)C[3*J+0]=b[0]+(v[J]&1?E:-E),C[3*J+1]=b[1]+(v[J]&2?E:-E),C[3*J+2]=b[2]+(v[J]&4?E:-E),0<J&&(q[2*J+0]=J-1,q[2*
J+1]=J);h.bufferToBuffer(C,f.WebMercator,0,C,d.spatialReference,0,t);d={};d[D.VertexAttrConstants.POSITION]={size:3,data:C};C={};C[D.VertexAttrConstants.POSITION]=q;q=new c.GeometryData(d,C,void 0,"line");q=new r(q,"GridLocalOriginBox");m.add(2,q);this._object.addGeometry(q,this._material,l.mat4f64.IDENTITY);console.log(this._origins.size,b)};return b}();var E=b.vec3f64.create();(z||(z={})).testOrigin=null;return z})},"esri/views/3d/webgl-engine/lib/Layer":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/arrayUtils ../../../../core/Evented ../../../../core/libs/gl-matrix-2/vec3f64 ./IdGen ./Octree".split(" "),
function(z,d,t,l,q,b,f,h){return function(d){function c(a,f,h){var m=d.call(this)||this;m._parentStages=new Map;m._objects=new Set;m.id=c._idGen.gen(a);m.apiLayerUid=h;m.name=a;f=f||{};m.group=f.group||"";m.isVisible=null!=f.isVisible?f.isVisible:!0;m.isPickable=null!=f.isPickable?f.isPickable:!0;m.isSliceable=!1;m.translation=f.translation?b.vec3f64.clone(f.translation):b.vec3f64.create();return m}t(c,d);c.prototype.addParentStage=function(a){if(!this._parentStages.has(a)){var c=this.on("dirty",
function(c){a.notifyDirty(c.origin,c.dirtyType,c.subObject)});this._parentStages.set(a,c)}};c.prototype.removeParentStage=function(a){var c=this._parentStages.get(a);c&&(c.remove(),this._parentStages.delete(a));this.invalidateSpatialQueryAccelerator()};c.prototype.getName=function(){return this.name};c.prototype.getGroup=function(){return this.group};c.prototype.getTranslation=function(){return this.translation};c.prototype.getObjectIds=function(){return l.keysOfSet(this._objects,function(a){return a.id})};
c.prototype.getObjects=function(){return l.keysOfSet(this._objects)};c.prototype.addObject=function(a){this._objects.add(a);a.parentLayer=this;this.notifyDirty("layerObjectAdded",a);this._octree&&this._octree.add(a)};c.prototype.hasObject=function(a){return this._objects.has(a)};c.prototype.removeObject=function(a){if(!this._objects.delete(a))return!1;a.parentLayer=null;this.notifyDirty("layerObjectRemoved",a);this._octree&&this._octree.remove(a);return!0};c.prototype.notifyObjectBBChanged=function(a,
c){this._octree&&this._octree.update(a,c)};c.prototype.getSpatialQueryAccelerator=function(){!this._octree&&50<this._objects.size&&this._createOctree();return this._octree};c.prototype.shaderTransformationChanged=function(){this.notifyDirty("shaderTransformationChanged",null)};c.prototype.invalidateSpatialQueryAccelerator=function(){this._octree&&(this._octree.destroy(),this._octree=null)};c.prototype.notifyDirty=function(a,c,b,f){this.emit("dirty",{origin:f||this,dirtyType:a,subObject:c})};c.prototype._createOctree=
function(){this._octree=new h({getRadius:function(a){return a.getBSRadius()},getCenter:function(a){return a.getCenter()}});this._octree.add(l.keysOfSet(this._objects))};c._idGen=new f.IdGen;return c}(q)})},"esri/views/3d/webgl-engine/lib/Octree":function(){define("require exports ../../../../core/ObjectPool ../../../../core/PooledArray ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../support/geometryUtils ./Util".split(" "),function(z,d,t,l,q,b,f,h){function r(a,
c,b){b=b||a;b[0]=a[0]+c;b[1]=a[1]+c;b[2]=a[2]+c;return b}function c(a,c,b){return!f.frustum.intersectsSphere(b.planes,f.sphere.wrap(c,a))}function a(a,c,b){if(!U.length)for(var f=0;8>f;++f)U.push({index:0,distance:0});for(f=0;8>f;++f){var p=v[f];U.data[f].index=f;U.data[f].distance=u(a,c,p)}U.sort(function(a,p){return a.distance-p.distance});b.clear();for(f=0;8>f;++f)b.push(U.data[f].index)}function m(a,c){for(var b=Infinity,f=null,p=0;8>p;++p){var d=u(a,c,E[p]);d<b&&(b=d,f=E[p])}return f}function u(a,
c,b){return c*(a[0]*b[0]+a[1]*b[1]+a[2]*b[2])}function D(a){if(Array.isArray(a))return a;J[0]=a;return J}z=function(){function d(a,c){this._maximumObjectsPerNode=10;this._maximumDepth=20;this._degenerateObjects=new Set;this._objectCount=0;this._objectToBoundingSphere=a;c&&(void 0!==c.maximumObjectsPerNode&&(this._maximumObjectsPerNode=c.maximumObjectsPerNode),void 0!==c.maximumDepth&&(this._maximumDepth=c.maximumDepth));this._root=new w(null,b.vec3f64.fromValues(0,0,0),0)}Object.defineProperty(d.prototype,
"center",{get:function(){return this._root.center},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"size",{get:function(){return 2*this._root.halfSize},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"root",{get:function(){return this._root.node},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"maximumObjectsPerNode",{get:function(){return this._maximumObjectsPerNode},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"maximumDepth",
{get:function(){return this._maximumDepth},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"objectCount",{get:function(){return this._objectCount},enumerable:!0,configurable:!0});d.prototype.destroy=function(){this._degenerateObjects.clear();this._root=null;w.clearPool();J[0]=null;N.prune();U.prune();V.prune()};d.prototype.add=function(a,c){a=D(a);c=null==c?a.length:c;this._objectCount+=c;this._grow(a,c);for(var b=w.acquire(),p=0;p<c;p++){var f=a[p];this._isDegenerate(f)?this._degenerateObjects.add(f):
(b.init(this._root),this._add(f,b))}w.release(b)};d.prototype.remove=function(a,c){a=D(a);this._objectCount-=a.length;for(var b=w.acquire(),p=0;p<a.length;p++){var f=a[p],d=c||this._boundingSphereFromObject(f,O);this._isValidRadius(d.radius)?(b.init(this._root),this._remove(f,d,b)):this._degenerateObjects.delete(f)}w.release(b);this._shrink()};d.prototype.update=function(a,c){if(this._isValidRadius(c.radius)||!this._isDegenerate(a))this.remove(a,c),this.add(a)};d.prototype.forEachAlongRay=function(a,
c,b){var p=this,d=f.ray.wrap(a,c);this._forEachNode(this._root,function(a){if(!p._intersectsNode(d,a))return!1;a=a.node;a.terminals.forEach(function(k){p._intersectsObject(d,k)&&b(k)});null!==a.residents&&a.residents.forEach(function(k){p._intersectsObject(d,k)&&b(k)});return!0})};d.prototype.forEachAlongRayWithVerticalOffset=function(a,c,b,p){var d=this,m=f.ray.wrap(a,c);this._forEachNode(this._root,function(k){if(!d._intersectsNodeWithOffset(m,k,p))return!1;k=k.node;k.terminals.forEach(function(e){d._intersectsObjectWithOffset(m,
e,p)&&b(e)});null!==k.residents&&k.residents.forEach(function(e){d._intersectsObjectWithOffset(m,e,p)&&b(e)});return!0})};d.prototype.forEach=function(a){this._forEachNode(this._root,function(c){c=c.node;c.terminals.forEach(a);null!==c.residents&&c.residents.forEach(a);return!0});this._degenerateObjects.forEach(a)};d.prototype.forEachDegenerateObject=function(a){this._degenerateObjects.forEach(a)};d.prototype.findClosest=function(a,c,b,p,f){return this._findClosest(a,"front-to-back"===c?1:-1,b,p,
f)};d.prototype.forEachInDepthRange=function(a,c,b,p,f,d,k,e){this._forEachInDepthRange(a,c,"front-to-back"===b?1:-1,p,f,d,k,e)};d.prototype.forEachNode=function(a){this._forEachNode(this._root,function(c){return a(c.node,c.center,2*c.halfSize)})};d.prototype._intersectsNode=function(a,c){r(c.center,2*-c.halfSize,I);r(c.center,2*c.halfSize,x);return h.rayBoxTest(a.origin,a.direction,I,x)};d.prototype._intersectsNodeWithOffset=function(a,c,b){r(c.center,2*-c.halfSize,I);r(c.center,2*c.halfSize,x);
b.applyToMinMax(I,x);return h.rayBoxTest(a.origin,a.direction,I,x)};d.prototype._intersectsObject=function(a,c){var b=this._objectToBoundingSphere.getRadius(c);return 0<b?f.sphere.intersectsRay(f.sphere.wrap(b,this._objectToBoundingSphere.getCenter(c)),a):!0};d.prototype._intersectsObjectWithOffset=function(a,c,b){var p=this._objectToBoundingSphere.getRadius(c);return 0<p?f.sphere.intersectsRay(b.applyToBoundingSphere(p,this._objectToBoundingSphere.getCenter(c)),a):!0};d.prototype._forEachNode=function(a,
c){a=w.acquire().init(a);for(var b=[a];0!==b.length;){a=b.pop();if(c(a)&&!a.isLeaf())for(var p=0;p<a.node.children.length;p++)a.node.children[p]&&b.push(w.acquire().init(a).advance(p));w.release(a)}};d.prototype._forEachNodeDepthOrdered=function(c,b,f,p){void 0===p&&(p=1);c=w.acquire().init(c);var d=[c];for(a(f,p,V);0!==d.length;){c=d.pop();if(b(c)&&!c.isLeaf())for(f=7;0<=f;--f)p=V.data[f],p>=c.node.children.length||c.node.children[p]&&d.push(w.acquire().init(c).advance(p));w.release(c)}};d.prototype._findClosest=
function(a,b,f,p,d){var A=this,k=Infinity,e=Infinity,g=null,n=m(a,b),y=0,B=function(n){++y;if(!p||p(n)){var B=A._objectToBoundingSphere.getCenter(n),F=A._objectToBoundingSphere.getRadius(n);if(!f||!c(B,F,f)){var B=u(a,b,B),d=B-F;d<k&&(k=d,e=B+F,g=n)}}};this._forEachNodeDepthOrdered(this._root,function(g){if(null!=d&&y>=d||f&&c(g.center,g.halfSize*C,f))return!1;q.vec3.scale(G,n,g.halfSize);q.vec3.add(G,G,g.center);if(u(a,b,G)>e)return!1;g=g.node;g.terminals.forEach(function(e){B(e)});null!==g.residents&&
g.residents.forEach(function(e){B(e)});return!0},a,b);return g};d.prototype._forEachInDepthRange=function(a,b,f,p,d,A,k,e){var g=this,n=-Infinity,y=Infinity,B={setRange:function(e){1===f?(n=Math.max(n,e.near),y=Math.min(y,e.far)):(n=Math.max(n,-e.far),y=Math.min(y,-e.near))}};B.setRange(p);var F=u(b,f,a),H=m(b,f),M=m(b,-1*f),h=0,l=function(e){++h;if(!k||k(e)){var a=g._objectToBoundingSphere.getCenter(e),p=g._objectToBoundingSphere.getRadius(e),H=u(b,f,a)-F;H-p>y||H+p<n||A&&c(a,p,A)||d(e,B)}};this._forEachNodeDepthOrdered(this._root,
function(g){if(null!=e&&h>=e||A&&c(g.center,g.halfSize*C,A))return!1;q.vec3.scale(G,H,g.halfSize);q.vec3.add(G,G,g.center);if(u(b,f,G)-F>y)return!1;q.vec3.scale(G,M,g.halfSize);q.vec3.add(G,G,g.center);if(u(b,f,G)-F<n)return!1;g=g.node;g.terminals.forEach(function(e){l(e)});null!==g.residents&&g.residents.forEach(function(e){l(e)});return!0},b,f)};d.prototype._remove=function(a,c,b){N.clear();c=b.advanceTo(c,function(a,c){N.push(a.node);N.push(c)})?b.node.terminals:b.node.residents;c.removeUnordered(a);
if(0===c.length)for(a=N.length-2;0<=a&&this._purge(N.data[a],N.data[a+1]);a-=2);};d.prototype._nodeIsEmpty=function(a){if(0!==a.terminals.length)return!1;if(null!==a.residents)return 0===a.residents.length;for(var c=0;c<a.children.length;c++)if(a.children[c])return!1;return!0};d.prototype._purge=function(a,c){0<=c&&(a.children[c]=null);return this._nodeIsEmpty(a)?(null===a.residents&&(a.residents=new l({shrink:!0})),!0):!1};d.prototype._add=function(a,c){c.advanceTo(this._boundingSphereFromObject(a,
O))?c.node.terminals.push(a):(c.node.residents.push(a),c.node.residents.length>this._maximumObjectsPerNode&&c.depth<this._maximumDepth&&this._split(c))};d.prototype._split=function(a){var c=a.node.residents;a.node.residents=null;for(var b=0;b<c.length;b++){var p=w.acquire().init(a);this._add(c.data[b],p);w.release(p)}};d.prototype._grow=function(a,c){var b=this;0!==c&&(a=this._boundingSphereFromObjects(a,c,function(a,c){return b._boundingSphereFromObject(a,c)},P),this._isValidRadius(a.radius)&&!this._fitsInsideTree(a)&&
(this._nodeIsEmpty(this._root.node)?(q.vec3.copy(this._root.center,a.center),this._root.halfSize=1.25*a.radius):(c=w.acquire(),this._rootBoundsForRootAsSubNode(a,c),this._placingRootViolatesMaxDepth(c)?this._rebuildTree(a,c):this._growRootAsSubNode(c),w.release(c))))};d.prototype._rebuildTree=function(a,c){var b=this;q.vec3.copy(S.center,c.center);S.radius=c.halfSize;a=this._boundingSphereFromObjects([a,S],2,function(a){return a},R);c=w.acquire().init(this._root);this._root.initFrom(null,a.center,
1.25*a.radius);this._forEachNode(c,function(a){b.add(a.node.terminals.data,a.node.terminals.length);null!==a.node.residents&&b.add(a.node.residents.data,a.node.residents.length);return!0});w.release(c)};d.prototype._placingRootViolatesMaxDepth=function(a){var c=0;this._forEachNode(this._root,function(a){c=Math.max(c,a.depth);return!0});return c+Math.log(a.halfSize/this._root.halfSize)*Math.LOG2E>this._maximumDepth};d.prototype._rootBoundsForRootAsSubNode=function(a,c){var b=a.radius,p=a.center;a=
-Infinity;for(var f=this._root.center,d=this._root.halfSize,k=0;3>k;k++){var e=Math.max(0,Math.ceil((f[k]-d-(p[k]-b))/(2*d))),g=Math.max(0,Math.ceil((p[k]+b-(f[k]+d))/(2*d)))+1;a=Math.max(a,Math.pow(2,Math.ceil(Math.log(e+g)*Math.LOG2E)));Q[k].min=e;Q[k].max=g}for(k=0;3>k;k++)e=Q[k].min,g=Q[k].max,b=(a-(e+g))/2,e+=Math.ceil(b),g+=Math.floor(b),K[k]=f[k]-d-e*d*2+(g+e)*d;return c.initFrom(null,K,a*d,0)};d.prototype._growRootAsSubNode=function(a){var c=this._root.node;q.vec3.copy(P.center,this._root.center);
P.radius=this._root.halfSize;this._root.init(a);a.advanceTo(P,null,!0);a.node.children=c.children;a.node.residents=c.residents;a.node.terminals=c.terminals};d.prototype._shrink=function(){for(;;){var a=this._findShrinkIndex();if(-1===a)break;this._root.advance(a);this._root.depth=0}};d.prototype._findShrinkIndex=function(){if(0!==this._root.node.terminals.length||this._root.isLeaf())return-1;for(var a=null,c=this._root.node.children,b=0,p=0;p<c.length&&null==a;)b=p++,a=c[b];for(;p<c.length;)if(c[p++])return-1;
return b};d.prototype._isDegenerate=function(a){a=this._objectToBoundingSphere.getRadius(a);return!this._isValidRadius(a)};d.prototype._isValidRadius=function(a){return!isNaN(a)&&-Infinity!==a&&Infinity!==a&&0<a};d.prototype._fitsInsideTree=function(a){var c=this._root.center,b=this._root.halfSize,p=a.center;return a.radius<=b&&p[0]>=c[0]-b&&p[0]<=c[0]+b&&p[1]>=c[1]-b&&p[1]<=c[1]+b&&p[2]>=c[2]-b&&p[2]<=c[2]+b};d.prototype._boundingSphereFromObject=function(a,c){q.vec3.copy(c.center,this._objectToBoundingSphere.getCenter(a));
c.radius=this._objectToBoundingSphere.getRadius(a);return c};d.prototype._boundingSphereFromObjects=function(a,c,b,p){if(1===c){var f=b(a[0],P);q.vec3.copy(p.center,f.center);p.radius=f.radius}else{I[0]=Infinity;I[1]=Infinity;I[2]=Infinity;x[0]=-Infinity;x[1]=-Infinity;x[2]=-Infinity;for(var d=0;d<c;d++)if(f=b(a[d],P),this._isValidRadius(f.radius)){var k=I,e=f.center,g=f.radius;k[0]=Math.min(k[0],e[0]-g);k[1]=Math.min(k[1],e[1]-g);k[2]=Math.min(k[2],e[2]-g);k=x;e=f.center;f=f.radius;k[0]=Math.max(k[0],
e[0]+f);k[1]=Math.max(k[1],e[1]+f);k[2]=Math.max(k[2],e[2]+f)}q.vec3.lerp(p.center,I,x,.5);p.radius=Math.max(x[0]-I[0],x[1]-I[1],x[2]-I[2])/2}return p};return d}();var w=function(){function a(a,c,f){void 0===f&&(f=0);this.center=b.vec3f64.create();this.initFrom(a,c,f,0)}a.prototype.init=function(a){return this.initFrom(a.node,a.center,a.halfSize,a.depth)};a.prototype.initFrom=function(c,b,f,p){void 0===c&&(c=null);void 0===f&&(f=this.halfSize);void 0===p&&(p=this.depth);this.node=c||a.createEmptyNode();
b&&q.vec3.copy(this.center,b);this.halfSize=f;this.depth=p;return this};a.prototype.advance=function(c){var b=this.node.children[c];b||(b=a.createEmptyNode(),this.node.children[c]=b);this.node=b;this.halfSize/=2;this.depth++;c=v[c];this.center[0]+=c[0]*this.halfSize;this.center[1]+=c[1]*this.halfSize;this.center[2]+=c[2]*this.halfSize;return this};a.prototype.advanceTo=function(a,c,b){for(void 0===b&&(b=!1);;){if(this.isTerminalFor(a))return c&&c(this,-1),!0;if(this.isLeaf()&&!b)return c&&c(this,
-1),!1;this.isLeaf()&&(this.node.residents=null);var p=this._childIndex(a);c&&c(this,p);this.advance(p)}};a.prototype.isLeaf=function(){return null!=this.node.residents};a.prototype.isTerminalFor=function(a){return a.radius>this.halfSize/2};a.prototype._childIndex=function(a){a=a.center;for(var c=this.center,b=0,p=0;3>p;p++)c[p]<a[p]&&(b|=1<<p);return b};a.createEmptyNode=function(){return{children:[null,null,null,null,null,null,null,null],terminals:new l({shrink:!0}),residents:new l({shrink:!0})}};
a.acquire=function(){return a._pool.acquire()};a.release=function(c){a._pool.release(c)};a.clearPool=function(){a._pool.prune()};a._pool=new t(a);return a}(),v=[b.vec3f64.fromValues(-1,-1,-1),b.vec3f64.fromValues(1,-1,-1),b.vec3f64.fromValues(-1,1,-1),b.vec3f64.fromValues(1,1,-1),b.vec3f64.fromValues(-1,-1,1),b.vec3f64.fromValues(1,-1,1),b.vec3f64.fromValues(-1,1,1),b.vec3f64.fromValues(1,1,1)],E=[b.vec3f64.fromValues(-1,-1,-1),b.vec3f64.fromValues(-1,-1,1),b.vec3f64.fromValues(-1,1,-1),b.vec3f64.fromValues(-1,
1,1),b.vec3f64.fromValues(1,-1,-1),b.vec3f64.fromValues(1,-1,1),b.vec3f64.fromValues(1,1,-1),b.vec3f64.fromValues(1,1,1)],C=Math.sqrt(3),J=[null],K=b.vec3f64.create(),G=b.vec3f64.create(),I=b.vec3f64.create(),x=b.vec3f64.create(),N=new l,O={center:b.vec3f64.create(),radius:0},P={center:b.vec3f64.create(),radius:0},S={center:b.vec3f64.create(),radius:0},R={center:b.vec3f64.create(),radius:0},Q=[{min:0,max:0},{min:0,max:0},{min:0,max:0}],U=new l,V=new l;return z})},"esri/views/3d/webgl-engine/lib/localOrigin":function(){define(["require",
"exports","../../../../core/libs/gl-matrix-2/vec3f64"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});d.fromVector=function(d,q){return{vec3:t.vec3f64.clone(d),id:q}};d.fromValues=function(d,q,b,f){return{vec3:t.vec3f64.fromValues(d,q,b),id:f}}})},"esri/views/3d/webgl-engine/materials/RibbonLineMaterial":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/assignHelper ../../../../core/Logger ../../../../core/mathUtils ../../../../core/maybe ../../../../core/screenUtils ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../support/geometryUtils ../../support/buffer/InterleavedLayout ../lib/ComponentUtils ../lib/geometryDataUtils ../lib/GLMaterial ../lib/Material ../lib/Util ./VisualVariableMaterialParameters ./internal/MaterialUtil ./renderers/MergedRenderer ../shaders/RibbonLineTechnique ../shaders/RibbonLineTechnique".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u,D,w,v,E,C,J,K,G,I,x){function N(e,g,n,k,a){for(var y=0;y<a;y++)n[k++]=e[g++];return k}var O=q.getLogger("esri.views.3d.webgl-engine.materials.RibbonLineMaterial");z=function(n){function a(e,g){g=n.call(this,g)||this;g.techniqueConfig=new x.RibbonLineTechniqueConfiguration;g.params=K.copyParameters(e,S);g.validateParams();g.params.transparent=1>g.params.color[3]||g.params.transparent;g.layout=g.createLayout();return g}t(a,n);a.prototype.dispose=function(){};a.prototype.setParameterValues=
function(e){for(var g in e)"cap"===g?O.error("cap cannot be changed after creation"):"join"===g&&"round"===this.params[g]!==("round"===e[g])?O.error("join cannot be changed after creation"):"stipplePattern"===g&&!!this.params[g]!==!!e[g]?O.error("stippledness cannot be changed after creation"):this.params[g]=e[g];this.validateParams();this.parametersChanged()};a.prototype.getParameters=function(){return this.params};a.prototype.getPassParameters=function(){return this.params};a.prototype.getTechniqueConfig=
function(e){this.techniqueConfig.output=e;e=f.isSome(this.params.stipplePattern);this.techniqueConfig.stippleEnabled=e;this.techniqueConfig.stippleIntegerRepeatsEnabled=e&&this.params.stippleIntegerRepeats;this.techniqueConfig.stippleOffColorEnabled=e&&f.isSome(this.params.stippleOffColor);this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled;this.techniqueConfig.sceneHasOcludees=this.params.sceneHasOcludees;this.techniqueConfig.roundJoins="round"===this.params.join;this.techniqueConfig.roundCaps=
"round"===this.params.cap;this.techniqueConfig.transparent=this.params.transparent;this.techniqueConfig.polygonOffset=this.params.polygonOffset;this.techniqueConfig.writeDepth=this.params.writeDepth;this.techniqueConfig.vvColor=this.params.vvColorEnabled;this.techniqueConfig.vvOpacity=this.params.vvOpacityEnabled;this.techniqueConfig.vvSize=this.params.vvSizeEnabled;this.techniqueConfig.innerColorEnabled=0<this.params.innerWidth&&f.isSome(this.params.innerColor);this.techniqueConfig.falloffEnabled=
0<this.params.falloff;this.techniqueConfig.occluder=8===this.renderOccluded;return this.techniqueConfig};a.prototype.intersect=function(e,g,n,k,a,y,p,c,B){B?K.intersectDrapedRenderLineGeometry(e,k,y,this.params.width,p):this.intersectLineGeometry(e,g,n,k,this.params.width,p)};a.prototype.intersectLineGeometry=function(n,a,y,B,f,d){if(B.options.selectionMode&&!D.isAllHidden(a.componentVisibilities,n.componentOffsets))if(C.isTranslationMatrix(y)){a=n.data.getVertexAttr();n=a[x.RibbonVertexAttributeConstants.POSITION].data;
this.params.vvSizeEnabled?f*=b.clamp(this.params.vvSizeOffset[0]+a[x.RibbonVertexAttributeConstants.SIZEFEATUREATTRIBUTE].data[0]*this.params.vvSizeFactor[0],this.params.vvSizeMinSize[0],this.params.vvSizeMaxSize[0]):a[x.RibbonVertexAttributeConstants.SIZE]&&(f*=a[x.RibbonVertexAttributeConstants.SIZE].data[0]);var h=B.camera,l=W;r.vec2.copy(l,B.point);f=f*h.pixelRatio/2+4*h.pixelRatio;c.vec3.set(F[0],l[0]-f,l[1]+f,0);c.vec3.set(F[1],l[0]+f,l[1]+f,0);c.vec3.set(F[2],l[0]+f,l[1]-f,0);c.vec3.set(F[3],
l[0]-f,l[1]-f,0);for(var q=0;4>q;q++)h.unprojectPoint(F[q],H[q]);m.plane.fromPoints(h.eye,H[0],H[1],M);m.plane.fromPoints(h.eye,H[1],H[2],X);m.plane.fromPoints(h.eye,H[2],H[3],Z);m.plane.fromPoints(h.eye,H[3],H[0],ca);a=Number.MAX_VALUE;for(var u=this.params.isClosed?n.length-2:n.length-5,q=0;q<u;q+=3){V[0]=n[q]+y[12];V[1]=n[q+1]+y[13];V[2]=n[q+2]+y[14];var w=(q+3)%n.length;Y[0]=n[w]+y[12];Y[1]=n[w+1]+y[13];Y[2]=n[w+2]+y[14];if(!(0>m.plane.signedDistance(M,V)&&0>m.plane.signedDistance(M,Y)||0>m.plane.signedDistance(X,
V)&&0>m.plane.signedDistance(X,Y)||0>m.plane.signedDistance(Z,V)&&0>m.plane.signedDistance(Z,Y)||0>m.plane.signedDistance(ca,V)&&0>m.plane.signedDistance(ca,Y))){h.projectPoint(V,p);h.projectPoint(Y,L);if(0>p[2]&&0<L[2]){c.vec3.subtract(T,V,Y);var w=h.frustum,v=-m.plane.signedDistance(w.planes[4],V),w=v/c.vec3.dot(T,w.planes[4]);c.vec3.scale(T,T,w);c.vec3.add(V,V,T);h.projectPoint(V,p)}else if(0<p[2]&&0>L[2])c.vec3.subtract(T,Y,V),w=h.frustum,v=-m.plane.signedDistance(w.planes[4],Y),w=v/c.vec3.dot(T,
w.planes[4]),c.vec3.scale(T,T,w),c.vec3.add(Y,Y,T),h.projectPoint(Y,L);else if(0>p[2]&&0>L[2])continue;p[2]=0;L[2]=0;w=m.lineSegment.distance2(m.lineSegment.fromPoints(p,L,e),l);w<a&&(a=w,c.vec3.copy(A,V),c.vec3.copy(k,Y))}}y=B.rayBeginPoint;B=B.rayEndPoint;a<f*f&&(n=Number.MAX_VALUE,m.lineSegment.closestLineSegmentPoint(m.lineSegment.fromPoints(A,k,e),m.lineSegment.fromPoints(y,B,g),aa)&&(c.vec3.subtract(aa,aa,y),n=c.vec3.length(aa),c.vec3.scale(aa,aa,1/n),n/=c.vec3.distance(y,B)),d(n,aa))}else O.error("intersection assumes a translation-only matrix")};
a.prototype.computeAttachmentOrigin=function(e,g){var n=e.data;e="getVertexAttr"in n?n.getVertexAttr():"vertexAttr"in n?n.vertexAttr:null;if(!e)return null;var k=x.RibbonVertexAttributeConstants.POSITION,n="getVertexAttr"in n?n.getIndices(k):null;return w.computeAttachmentOriginLines(e[k],n,n&&this.params.isClosed,g)};a.prototype.createLayout=function(){var e=u.newLayout().vec3f(x.RibbonVertexAttributeConstants.POSITION).f32(x.RibbonVertexAttributeConstants.SUBDIVISIONFACTOR).vec2f(x.RibbonVertexAttributeConstants.UV0).vec3f(x.RibbonVertexAttributeConstants.AUXPOS1).vec3f(x.RibbonVertexAttributeConstants.AUXPOS2);
this.params.vvSizeEnabled?e.f32(x.RibbonVertexAttributeConstants.SIZEFEATUREATTRIBUTE):e.f32(x.RibbonVertexAttributeConstants.SIZE);this.params.vvColorEnabled?e.f32(x.RibbonVertexAttributeConstants.COLORFEATUREATTRIBUTE):e.vec4f(x.RibbonVertexAttributeConstants.COLOR);this.params.vvOpacityEnabled&&e.f32(x.RibbonVertexAttributeConstants.OPACITYFEATUREATTRIBUTE);return e};a.prototype.createBufferWriter=function(){return new R(this.layout,this.params)};a.prototype.createRenderer=function(e,g){return new G(e,
g,this,x.ribbonVertexAttributeLocations)};a.prototype.getGLMaterial=function(e){return 0===e.output||4===e.output?new P(e):void 0};a.prototype.validateParams=function(){this.params.width&&1<this.params.width&&(this.params.width=Math.round(this.params.width));"miter"!==this.params.join&&(this.params.miterLimit=0)};return a}(E.Material);var P=function(e){function g(g){g=e.call(this,g)||this;g.updateParameters();return g}t(g,e);g.prototype.updateParameters=function(){this.technique=this.techniqueRep.acquireAndReleaseExisting(I.RibbonLineTechnique,
this.material.getTechniqueConfig(this.output),this.technique)};g.prototype.beginSlot=function(e){return this.technique.configuration.occluder?3===e||10===e||11===e:0===this.output?(this.targetSlot=this.technique.configuration.writeDepth?5:8,e===this.targetSlot):3===e};g.prototype._updateOccludeeState=function(e){e.hasOccludees!==this.material.getParameters().sceneHasOcludees&&(this.material.setParameterValues({sceneHasOcludees:e.hasOccludees}),this.updateParameters())};g.prototype.ensureParameters=
function(e){0===this.output&&this._updateOccludeeState(e)};g.prototype.bind=function(e,g){e.bindProgram(this.technique.program);this.technique.bindPass(e,this.material.getPassParameters(),g)};g.prototype.getPipelineState=function(e,g){return g?this.technique.occludeePipeline:this.technique.configuration.occluder?11===e?this.technique.occluderPipelineTransparent:10===e?this.technique.occluderPipelineOpaque:this.technique.occluderPipelineMaskWrite:this.technique.pipeline};return g}(v.GLMaterial),S=
l({width:0,color:[1,1,1,1],join:"miter",cap:"butt",miterLimit:5,writeDepth:!0,polygonOffset:!1,stipplePattern:null,stippleIntegerRepeats:!1,stippleOffColor:null,slicePlaneEnabled:!1,vvFastUpdate:!1,transparent:!1,isClosed:!1,falloff:0,innerWidth:0,innerColor:null,sceneHasOcludees:!1},J.Default),R=function(){function e(e,g){this.params=g;this.numJoinSubdivisions=this.numCapSubdivisions=0;this.vertexBufferLayout=e;if(!g.isClosed)switch(this.params.cap){case "butt":this.numCapSubdivisions=0;break;case "square":this.numCapSubdivisions=
1;break;case "round":this.numCapSubdivisions=Q}switch(this.params.join){case "miter":case "bevel":this.numJoinSubdivisions=g.stipplePattern?1:0;break;case "round":this.numJoinSubdivisions=U}}e.prototype.allocate=function(e){return this.vertexBufferLayout.createBuffer(e)};e.prototype.elementCount=function(e){var g=2*this.numCapSubdivisions+2,n=e.indices[x.RibbonVertexAttributeConstants.POSITION].length/2+1,k=this.params.isClosed,g=k?2:2*g,a=k?0:1,n=k?n:n-1;if(e.vertexAttr[x.RibbonVertexAttributeConstants.SUBDIVISIONS])for(e=
e.vertexAttr[x.RibbonVertexAttributeConstants.SUBDIVISIONS].data;a<n;++a)g+=4+2*e[a];else g+=(n-a)*(2*this.numJoinSubdivisions+4);return g+2};e.prototype.write=function(e,g,k,a){var p=this,b=n,F=y,f=B,H=g.vertexAttr[x.RibbonVertexAttributeConstants.POSITION].data,d=g.indices&&g.indices[x.RibbonVertexAttributeConstants.POSITION];d&&d.length!==2*(H.length/3-1)&&console.warn("RibbonLineMaterial does not support indices");d=null;g.vertexAttr[x.RibbonVertexAttributeConstants.SUBDIVISIONS]&&(d=g.vertexAttr[x.RibbonVertexAttributeConstants.SUBDIVISIONS].data);
var M=1,m=0;this.params.vvSizeEnabled?m=g.vertexAttr[x.RibbonVertexAttributeConstants.SIZEFEATUREATTRIBUTE].data[0]:g.vertexAttr[x.RibbonVertexAttributeConstants.SIZE]&&(M=g.vertexAttr[x.RibbonVertexAttributeConstants.SIZE].data[0]);var h=[1,1,1,1],A=0;this.params.vvColorEnabled?A=g.vertexAttr[x.RibbonVertexAttributeConstants.COLORFEATUREATTRIBUTE].data[0]:g.vertexAttr[x.RibbonVertexAttributeConstants.COLOR]&&(h=g.vertexAttr[x.RibbonVertexAttributeConstants.COLOR].data);var X=0;this.params.vvOpacityEnabled&&
(X=g.vertexAttr[x.RibbonVertexAttributeConstants.OPACITYFEATUREATTRIBUTE].data[0]);g=H.length/3;e=e.transformation;var l=new Float32Array(k.buffer);k=this.vertexBufferLayout.stride/4;var r=a*k;a=r;var Z=function(e,g,n,k,a,y){l[r++]=g[0];l[r++]=g[1];l[r++]=g[2];l[r++]=k;l[r++]=a;l[r++]=y;l[r++]=e[0];l[r++]=e[1];l[r++]=e[2];l[r++]=n[0];l[r++]=n[1];l[r++]=n[2];p.params.vvSizeEnabled?l[r++]=m:l[r++]=M;p.params.vvColorEnabled?l[r++]=A:(l[r++]=h[0],l[r++]=h[1],l[r++]=h[2],l[r++]=h[3]);p.params.vvOpacityEnabled&&
(l[r++]=X)},r=r+k;c.vec3.set(F,H[0],H[1],H[2]);e&&c.vec3.transformMat4(F,F,e);var q=this.params.isClosed;if(q){var u=H.length-3;c.vec3.set(b,H[u],H[u+1],H[u+2]);e&&c.vec3.transformMat4(b,b,e)}else{c.vec3.copy(b,F);c.vec3.set(f,H[3],H[4],H[5]);e&&c.vec3.transformMat4(f,f,e);for(u=0;u<this.numCapSubdivisions;++u){var ca=1-u/this.numCapSubdivisions;Z(b,F,f,ca,1,-4);Z(b,F,f,ca,1,4)}Z(b,F,f,0,0,-4);Z(b,F,f,0,0,4);c.vec3.copy(b,F);c.vec3.copy(F,f)}for(var w=q?g:g-1,u=q?0:1;u<w;u++){ca=(u+1)%g*3;c.vec3.set(f,
H[ca+0],H[ca+1],H[ca+2]);e&&c.vec3.transformMat4(f,f,e);Z(b,F,f,0,1,-1);Z(b,F,f,0,1,1);for(var v=d?d[u]:this.numJoinSubdivisions,t=0;t<v;++t)ca=(t+1)/(v+1),Z(b,F,f,ca,1,-2),Z(b,F,f,ca,1,2);Z(b,F,f,1,0,-2);Z(b,F,f,1,0,2);c.vec3.copy(b,F);c.vec3.copy(F,f)}if(q)r=N(l,a+k,l,r,2*k);else for(Z(b,F,f,0,1,-5),Z(b,F,f,0,1,5),u=0;u<this.numCapSubdivisions;++u)ca=(u+1)/this.numCapSubdivisions,Z(b,F,f,ca,1,-5),Z(b,F,f,ca,1,5);N(l,a+k,l,a,k);r=N(l,r-k,l,r,k)};return e}(),Q=3,U=1,V=a.vec3f64.create(),Y=a.vec3f64.create(),
T=a.vec3f64.create(),aa=a.vec3f64.create(),W=a.vec3f64.create(),p=h.createRenderScreenPointArray3(),L=h.createRenderScreenPointArray3(),A=a.vec3f64.create(),k=a.vec3f64.create(),e=m.lineSegment.create(),g=m.lineSegment.create(),n=a.vec3f64.create(),y=a.vec3f64.create(),B=a.vec3f64.create(),F=[h.createRenderScreenPointArray3(),h.createRenderScreenPointArray3(),h.createRenderScreenPointArray3(),h.createRenderScreenPointArray3()],H=[a.vec3f64.create(),a.vec3f64.create(),a.vec3f64.create(),a.vec3f64.create()],
M=m.plane.create(),X=m.plane.create(),Z=m.plane.create(),ca=m.plane.create();return z})},"esri/views/3d/support/buffer/InterleavedLayout":function(){define(["require","exports","./BufferView","./types"],function(z,d,t,l){Object.defineProperty(d,"__esModule",{value:!0});var q=function(){function b(b,f){this.layout=b;this.buffer="number"===typeof f?new ArrayBuffer(f*b.stride):f;f=0;for(var c=b.fieldNames;f<c.length;f++){var a=c[f],d=b.fields.get(a);this[a]=new d.constructor(this.buffer,d.offset,this.stride)}}
Object.defineProperty(b.prototype,"stride",{get:function(){return this.layout.stride},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"count",{get:function(){return this.buffer.byteLength/this.stride},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"byteLength",{get:function(){return this.buffer.byteLength},enumerable:!0,configurable:!0});b.prototype.getField=function(b,f){return(b=this[b])&&b.elementCount===f.ElementCount&&b.elementType===f.ElementType?b:null};
b.prototype.slice=function(f,d){return new b(this.layout,this.buffer.slice(f*this.stride,d*this.stride))};b.prototype.copyFrom=function(b,f,c,a){var d=this.stride;0===d%4?(b=new Uint32Array(b.buffer,f*d,a*d/4),c=new Uint32Array(this.buffer,c*d,a*d/4)):(b=new Uint8Array(b.buffer,f*d,a*d),c=new Uint8Array(this.buffer,c*d,a*d));c.set(b)};return b}();d.InterleavedBuffer=q;var b=function(){function b(){this.stride=0;this.fields=new Map;this.fieldNames=[]}b.prototype.vec2f=function(b,f){this.appendField(b,
t.BufferViewVec2f,f);return this};b.prototype.vec2f64=function(b,f){this.appendField(b,t.BufferViewVec2f64,f);return this};b.prototype.vec3f=function(b,f){this.appendField(b,t.BufferViewVec3f,f);return this};b.prototype.vec3f64=function(b,f){this.appendField(b,t.BufferViewVec3f64,f);return this};b.prototype.vec4f=function(b,f){this.appendField(b,t.BufferViewVec4f,f);return this};b.prototype.vec4f64=function(b,f){this.appendField(b,t.BufferViewVec4f64,f);return this};b.prototype.mat3f=function(b,f){this.appendField(b,
t.BufferViewMat3f,f);return this};b.prototype.mat3f64=function(b,f){this.appendField(b,t.BufferViewMat3f64,f);return this};b.prototype.mat4f=function(b,f){this.appendField(b,t.BufferViewMat4f,f);return this};b.prototype.mat4f64=function(b,f){this.appendField(b,t.BufferViewMat4f64,f);return this};b.prototype.vec4u8=function(b,f){this.appendField(b,t.BufferViewVec4u8,f);return this};b.prototype.f32=function(b,f){this.appendField(b,t.BufferViewFloat,f);return this};b.prototype.f64=function(b,f){this.appendField(b,
t.BufferViewFloat64,f);return this};b.prototype.u8=function(b,f){this.appendField(b,t.BufferViewUint8,f);return this};b.prototype.u16=function(b,f){this.appendField(b,t.BufferViewUint16,f);return this};b.prototype.i8=function(b,f){this.appendField(b,t.BufferViewInt8,f);return this};b.prototype.vec2i8=function(b,f){this.appendField(b,t.BufferViewVec2i8,f);return this};b.prototype.vec2i16=function(b,f){this.appendField(b,t.BufferViewVec2i16,f);return this};b.prototype.vec2u8=function(b,f){this.appendField(b,
t.BufferViewVec2u8,f);return this};b.prototype.vec4u16=function(b,f){this.appendField(b,t.BufferViewVec4u16,f);return this};b.prototype.u32=function(b,f){this.appendField(b,t.BufferViewUint32,f);return this};b.prototype.appendField=function(b,f,c){var a=f.ElementCount*l.elementTypeSize(f.ElementType);this.fields.set(b,{size:a,constructor:f,offset:this.stride,optional:c});this.stride+=a;this.fieldNames.push(b)};b.prototype.alignTo=function(b){this.stride=Math.floor((this.stride+b-1)/b)*b;return this};
b.prototype.hasField=function(b){return 0<=this.fieldNames.indexOf(b)};b.prototype.createBuffer=function(b){return new q(this,b)};b.prototype.createView=function(b){return new q(this,b)};b.prototype.clone=function(){var f=new b;f.stride=this.stride;f.fields=new Map;this.fields.forEach(function(b,c){return f.fields.set(c,b)});f.fieldNames=this.fieldNames.slice();f.BufferType=this.BufferType;return f};return b}();d.InterleavedLayout=b;d.newLayout=function(){return new b}})},"esri/views/3d/support/buffer/BufferView":function(){define("require exports ../../../../core/tsSupport/extendsHelper ./internals/Mat3 ./internals/Mat4 ./internals/Scalar ./internals/Vec2 ./internals/Vec3 ./internals/Vec4".split(" "),
function(z,d,t,l,q,b,f,h,r){Object.defineProperty(d,"__esModule",{value:!0});z=function(c){function a(a,b,f,d){void 0===b&&(b=0);a=c.call(this,Float32Array,a,b,f,d)||this;a.elementType="f32";return a}t(a,c);a.fromTypedArray=function(c,b){return new a(c.buffer,c.byteOffset,b,c.byteOffset+c.byteLength)};a.ElementType="f32";return a}(b.BufferViewScalarImpl);d.BufferViewFloat=z;z=function(c){function a(a,b,f,d){void 0===b&&(b=0);a=c.call(this,Float32Array,a,b,f,d)||this;a.elementType="f32";return a}t(a,
c);a.fromTypedArray=function(c,b){return new a(c.buffer,c.byteOffset,b,c.byteOffset+c.byteLength)};a.ElementType="f32";return a}(f.BufferViewVec2Impl);d.BufferViewVec2f=z;z=function(c){function a(a,b,f,d){void 0===b&&(b=0);a=c.call(this,Float32Array,a,b,f,d)||this;a.elementType="f32";return a}t(a,c);a.fromTypedArray=function(c,b){return new a(c.buffer,c.byteOffset,b,c.byteOffset+c.byteLength)};a.ElementType="f32";return a}(h.BufferViewVec3Impl);d.BufferViewVec3f=z;z=function(c){function a(a,b,f,d){void 0===
b&&(b=0);a=c.call(this,Float32Array,a,b,f,d)||this;a.elementType="f32";return a}t(a,c);a.fromTypedArray=function(c,b){return new a(c.buffer,c.byteOffset,b,c.byteOffset+c.byteLength)};a.ElementType="f32";return a}(r.BufferViewVec4Impl);d.BufferViewVec4f=z;z=function(c){function a(a,b,f,d){void 0===b&&(b=0);a=c.call(this,Float32Array,a,b,f,d)||this;a.elementType="f32";return a}t(a,c);a.fromTypedArray=function(c,b){return new a(c.buffer,c.byteOffset,b,c.byteOffset+c.byteLength)};a.ElementType="f32";
return a}(l.BufferViewMat3Impl);d.BufferViewMat3f=z;l=function(c){function a(a,b,f,d){void 0===b&&(b=0);a=c.call(this,Float64Array,a,b,f,d)||this;a.elementType="f64";return a}t(a,c);a.fromTypedArray=function(c,b){return new a(c.buffer,c.byteOffset,b,c.byteOffset+c.byteLength)};a.ElementType="f64";return a}(l.BufferViewMat3Impl);d.BufferViewMat3f64=l;l=function(c){function a(a,b,f,d){void 0===b&&(b=0);a=c.call(this,Float32Array,a,b,f,d)||this;a.elementType="f32";return a}t(a,c);a.fromTypedArray=function(c,
b){return new a(c.buffer,c.byteOffset,b,c.byteOffset+c.byteLength)};a.ElementType="f32";return a}(q.BufferViewMat4Impl);d.BufferViewMat4f=l;q=function(c){function a(a,b,f,d){void 0===b&&(b=0);a=c.call(this,Float64Array,a,b,f,d)||this;a.elementType="f64";return a}t(a,c);a.fromTypedArray=function(c,b){return new a(c.buffer,c.byteOffset,b,c.byteOffset+c.byteLength)};a.ElementType="f64";return a}(q.BufferViewMat4Impl);d.BufferViewMat4f64=q;q=function(c){function a(a,b,f,d){void 0===b&&(b=0);a=c.call(this,
Float64Array,a,b,f,d)||this;a.elementType="f64";return a}t(a,c);a.fromTypedArray=function(c,b){return new a(c.buffer,c.byteOffset,b,c.byteOffset+c.byteLength)};a.ElementType="f64";return a}(b.BufferViewScalarImpl);d.BufferViewFloat64=q;q=function(c){function a(a,b,f,d){void 0===b&&(b=0);a=c.call(this,Float64Array,a,b,f,d)||this;a.elementType="f64";return a}t(a,c);a.fromTypedArray=function(c,b){return new a(c.buffer,c.byteOffset,b,c.byteOffset+c.byteLength)};a.ElementType="f64";return a}(f.BufferViewVec2Impl);
d.BufferViewVec2f64=q;q=function(c){function a(a,b,f,d){void 0===b&&(b=0);a=c.call(this,Float64Array,a,b,f,d)||this;a.elementType="f64";return a}t(a,c);a.fromTypedArray=function(c,b){return new a(c.buffer,c.byteOffset,b,c.byteOffset+c.byteLength)};a.ElementType="f64";return a}(h.BufferViewVec3Impl);d.BufferViewVec3f64=q;q=function(c){function a(a,b,f,d){void 0===b&&(b=0);a=c.call(this,Float64Array,a,b,f,d)||this;a.elementType="f64";return a}t(a,c);a.fromTypedArray=function(c,b){return new a(c.buffer,
c.byteOffset,b,c.byteOffset+c.byteLength)};a.ElementType="f64";return a}(r.BufferViewVec4Impl);d.BufferViewVec4f64=q;q=function(c){function a(a,b,f,d){void 0===b&&(b=0);a=c.call(this,Uint8Array,a,b,f,d)||this;a.elementType="u8";return a}t(a,c);a.fromTypedArray=function(c,b){return new a(c.buffer,c.byteOffset,b,c.byteOffset+c.byteLength)};a.ElementType="u8";return a}(b.BufferViewScalarImpl);d.BufferViewUint8=q;q=function(c){function a(a,b,f,d){void 0===b&&(b=0);a=c.call(this,Uint8Array,a,b,f,d)||this;
a.elementType="u8";return a}t(a,c);a.fromTypedArray=function(c,b){return new a(c.buffer,c.byteOffset,b,c.byteOffset+c.byteLength)};a.ElementType="u8";return a}(f.BufferViewVec2Impl);d.BufferViewVec2u8=q;q=function(c){function a(a,b,f,d){void 0===b&&(b=0);a=c.call(this,Uint8Array,a,b,f,d)||this;a.elementType="u8";return a}t(a,c);a.fromTypedArray=function(c,b){return new a(c.buffer,c.byteOffset,b,c.byteOffset+c.byteLength)};a.ElementType="u8";return a}(h.BufferViewVec3Impl);d.BufferViewVec3u8=q;q=function(c){function a(a,
b,f,d){void 0===b&&(b=0);a=c.call(this,Uint8Array,a,b,f,d)||this;a.elementType="u8";return a}t(a,c);a.fromTypedArray=function(c,b){return new a(c.buffer,c.byteOffset,b,c.byteOffset+c.byteLength)};a.ElementType="u8";return a}(r.BufferViewVec4Impl);d.BufferViewVec4u8=q;q=function(c){function a(a,b,f,d){void 0===b&&(b=0);a=c.call(this,Uint16Array,a,b,f,d)||this;a.elementType="u16";return a}t(a,c);a.fromTypedArray=function(c,b){return new a(c.buffer,c.byteOffset,b,c.byteOffset+c.byteLength)};a.ElementType=
"u16";return a}(b.BufferViewScalarImpl);d.BufferViewUint16=q;q=function(c){function a(a,b,f,d){void 0===b&&(b=0);a=c.call(this,Uint16Array,a,b,f,d)||this;a.elementType="u16";return a}t(a,c);a.fromTypedArray=function(c,b){return new a(c.buffer,c.byteOffset,b,c.byteOffset+c.byteLength)};a.ElementType="u16";return a}(f.BufferViewVec2Impl);d.BufferViewVec2u16=q;q=function(c){function a(a,b,f,d){void 0===b&&(b=0);a=c.call(this,Uint16Array,a,b,f,d)||this;a.elementType="u16";return a}t(a,c);a.fromTypedArray=
function(c,b){return new a(c.buffer,c.byteOffset,b,c.byteOffset+c.byteLength)};a.ElementType="u16";return a}(h.BufferViewVec3Impl);d.BufferViewVec3u16=q;q=function(c){function a(a,b,f,d){void 0===b&&(b=0);a=c.call(this,Uint16Array,a,b,f,d)||this;a.elementType="u16";return a}t(a,c);a.fromTypedArray=function(c,b){return new a(c.buffer,c.byteOffset,b,c.byteOffset+c.byteLength)};a.ElementType="u16";return a}(r.BufferViewVec4Impl);d.BufferViewVec4u16=q;q=function(c){function a(a,b,f,d){void 0===b&&(b=
0);a=c.call(this,Uint32Array,a,b,f,d)||this;a.elementType="u32";return a}t(a,c);a.fromTypedArray=function(c,b){return new a(c.buffer,c.byteOffset,b,c.byteOffset+c.byteLength)};a.ElementType="u32";return a}(b.BufferViewScalarImpl);d.BufferViewUint32=q;q=function(c){function a(a,b,f,d){void 0===b&&(b=0);a=c.call(this,Uint32Array,a,b,f,d)||this;a.elementType="u32";return a}t(a,c);a.fromTypedArray=function(c,b){return new a(c.buffer,c.byteOffset,b,c.byteOffset+c.byteLength)};a.ElementType="u32";return a}(f.BufferViewVec2Impl);
d.BufferViewVec2u32=q;q=function(c){function a(a,b,f,d){void 0===b&&(b=0);a=c.call(this,Uint32Array,a,b,f,d)||this;a.elementType="u32";return a}t(a,c);a.fromTypedArray=function(c,b){return new a(c.buffer,c.byteOffset,b,c.byteOffset+c.byteLength)};a.ElementType="u32";return a}(h.BufferViewVec3Impl);d.BufferViewVec3u32=q;q=function(c){function a(a,b,f,d){void 0===b&&(b=0);a=c.call(this,Uint32Array,a,b,f,d)||this;a.elementType="u32";return a}t(a,c);a.fromTypedArray=function(c,b){return new a(c.buffer,
c.byteOffset,b,c.byteOffset+c.byteLength)};a.ElementType="u32";return a}(r.BufferViewVec4Impl);d.BufferViewVec4u32=q;q=function(c){function a(a,b,f,d){void 0===b&&(b=0);a=c.call(this,Int8Array,a,b,f,d)||this;a.elementType="i8";return a}t(a,c);a.fromTypedArray=function(c,b){return new a(c.buffer,c.byteOffset,b,c.byteOffset+c.byteLength)};a.ElementType="i8";return a}(b.BufferViewScalarImpl);d.BufferViewInt8=q;q=function(c){function a(a,b,f,d){void 0===b&&(b=0);a=c.call(this,Int8Array,a,b,f,d)||this;
a.elementType="i8";return a}t(a,c);a.fromTypedArray=function(c,b){return new a(c.buffer,c.byteOffset,b,c.byteOffset+c.byteLength)};a.ElementType="i8";return a}(f.BufferViewVec2Impl);d.BufferViewVec2i8=q;q=function(c){function a(a,b,f,d){void 0===b&&(b=0);a=c.call(this,Int8Array,a,b,f,d)||this;a.elementType="i8";return a}t(a,c);a.fromTypedArray=function(c,b){return new a(c.buffer,c.byteOffset,b,c.byteOffset+c.byteLength)};a.ElementType="i8";return a}(h.BufferViewVec3Impl);d.BufferViewVec3i8=q;q=function(c){function a(a,
b,f,d){void 0===b&&(b=0);a=c.call(this,Int8Array,a,b,f,d)||this;a.elementType="i8";return a}t(a,c);a.fromTypedArray=function(c,b){return new a(c.buffer,c.byteOffset,b,c.byteOffset+c.byteLength)};a.ElementType="i8";return a}(r.BufferViewVec4Impl);d.BufferViewVec4i8=q;q=function(c){function a(a,b,f,d){void 0===b&&(b=0);a=c.call(this,Int16Array,a,b,f,d)||this;a.elementType="i16";return a}t(a,c);a.fromTypedArray=function(c,b){return new a(c.buffer,c.byteOffset,b,c.byteOffset+c.byteLength)};a.ElementType=
"i16";return a}(b.BufferViewScalarImpl);d.BufferViewInt16=q;q=function(c){function a(a,b,f,d){void 0===b&&(b=0);a=c.call(this,Int16Array,a,b,f,d)||this;a.elementType="i16";return a}t(a,c);a.fromTypedArray=function(c,b){return new a(c.buffer,c.byteOffset,b,c.byteOffset+c.byteLength)};a.ElementType="i16";return a}(f.BufferViewVec2Impl);d.BufferViewVec2i16=q;q=function(c){function a(a,b,f,d){void 0===b&&(b=0);a=c.call(this,Int16Array,a,b,f,d)||this;a.elementType="i16";return a}t(a,c);a.fromTypedArray=
function(c,b){return new a(c.buffer,c.byteOffset,b,c.byteOffset+c.byteLength)};a.ElementType="i16";return a}(h.BufferViewVec3Impl);d.BufferViewVec3i16=q;q=function(c){function a(a,b,f,d){void 0===b&&(b=0);a=c.call(this,Int16Array,a,b,f,d)||this;a.elementType="i16";return a}t(a,c);a.fromTypedArray=function(c,b){return new a(c.buffer,c.byteOffset,b,c.byteOffset+c.byteLength)};a.ElementType="i16";return a}(r.BufferViewVec4Impl);d.BufferViewVec4i16=q;b=function(c){function a(a,b,f,d){void 0===b&&(b=0);
a=c.call(this,Int32Array,a,b,f,d)||this;a.elementType="i32";return a}t(a,c);a.fromTypedArray=function(c,b){return new a(c.buffer,c.byteOffset,b,c.byteOffset+c.byteLength)};a.ElementType="i32";return a}(b.BufferViewScalarImpl);d.BufferViewInt32=b;f=function(c){function a(a,b,f,d){void 0===b&&(b=0);a=c.call(this,Int32Array,a,b,f,d)||this;a.elementType="i32";return a}t(a,c);a.fromTypedArray=function(c,b){return new a(c.buffer,c.byteOffset,b,c.byteOffset+c.byteLength)};a.ElementType="i32";return a}(f.BufferViewVec2Impl);
d.BufferViewVec2i32=f;h=function(c){function a(a,b,f,d){void 0===b&&(b=0);a=c.call(this,Int32Array,a,b,f,d)||this;a.elementType="i32";return a}t(a,c);a.fromTypedArray=function(c,b){return new a(c.buffer,c.byteOffset,b,c.byteOffset+c.byteLength)};a.ElementType="i32";return a}(h.BufferViewVec3Impl);d.BufferViewVec3i32=h;r=function(c){function a(a,b,f,d){void 0===b&&(b=0);a=c.call(this,Int32Array,a,b,f,d)||this;a.elementType="i32";return a}t(a,c);a.fromTypedArray=function(c,b){return new a(c.buffer,
c.byteOffset,b,c.byteOffset+c.byteLength)};a.ElementType="i32";return a}(r.BufferViewVec4Impl);d.BufferViewVec4i32=r})},"esri/views/3d/support/buffer/internals/Mat3":function(){define(["require","exports"],function(z,d){Object.defineProperty(d,"__esModule",{value:!0});z=function(){function d(d,q,b,f,h){void 0===b&&(b=0);this.TypedArrayConstructor=d;this.elementCount=9;d=this.TypedArrayConstructor;void 0===f&&(f=9*d.BYTES_PER_ELEMENT);var l=0===q.byteLength?0:b;this.typedBuffer=null==h?new d(q,l):
new d(q,l,(h-b)/d.BYTES_PER_ELEMENT);this.typedBufferStride=f/d.BYTES_PER_ELEMENT;this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride);this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}d.prototype.getMat=function(d,q){d*=this.typedBufferStride;for(var b=0;9>b;b++)q[b]=this.typedBuffer[d+b];return q};d.prototype.setMat=function(d,q){d*=this.typedBufferStride;for(var b=0;9>b;b++)this.typedBuffer[d+b]=q[b]};d.prototype.get=function(d,q){return this.typedBuffer[d*
this.typedBufferStride+q]};d.prototype.set=function(d,q,b){this.typedBuffer[d*this.typedBufferStride+q]=b};d.prototype.copyFrom=function(d,q,b){var f=this.typedBuffer,h=q.typedBuffer;d*=this.typedBufferStride;q=b*q.typedBufferStride;for(b=0;9>b;++b)f[d+b]=h[q+b]};Object.defineProperty(d.prototype,"buffer",{get:function(){return this.typedBuffer.buffer},enumerable:!0,configurable:!0});d.ElementCount=9;return d}();d.BufferViewMat3Impl=z})},"esri/views/3d/support/buffer/internals/Mat4":function(){define(["require",
"exports"],function(z,d){Object.defineProperty(d,"__esModule",{value:!0});z=function(){function d(d,q,b,f,h){void 0===b&&(b=0);this.TypedArrayConstructor=d;this.elementCount=16;d=this.TypedArrayConstructor;void 0===f&&(f=16*d.BYTES_PER_ELEMENT);var l=0===q.byteLength?0:b;this.typedBuffer=null==h?new d(q,l):new d(q,l,(h-b)/d.BYTES_PER_ELEMENT);this.typedBufferStride=f/d.BYTES_PER_ELEMENT;this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride);this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}
d.prototype.getMat=function(d,q){d*=this.typedBufferStride;for(var b=0;16>b;b++)q[b]=this.typedBuffer[d+b];return q};d.prototype.setMat=function(d,q){d*=this.typedBufferStride;for(var b=0;16>b;b++)this.typedBuffer[d+b]=q[b]};d.prototype.get=function(d,q){return this.typedBuffer[d*this.typedBufferStride+q]};d.prototype.set=function(d,q,b){this.typedBuffer[d*this.typedBufferStride+q]=b};d.prototype.copyFrom=function(d,q,b){var f=this.typedBuffer,h=q.typedBuffer;d*=this.typedBufferStride;q=b*q.typedBufferStride;
for(b=0;16>b;++b)f[d+b]=h[q+b]};Object.defineProperty(d.prototype,"buffer",{get:function(){return this.typedBuffer.buffer},enumerable:!0,configurable:!0});d.ElementCount=16;return d}();d.BufferViewMat4Impl=z})},"esri/views/3d/support/buffer/internals/Scalar":function(){define(["require","exports"],function(z,d){Object.defineProperty(d,"__esModule",{value:!0});z=function(){function d(d,q,b,f,h){void 0===b&&(b=0);this.TypedArrayConstructor=d;this.elementCount=1;d=this.TypedArrayConstructor;void 0===
f&&(f=d.BYTES_PER_ELEMENT);var l=0===q.byteLength?0:b;this.typedBuffer=null==h?new d(q,l):new d(q,l,(h-b)/d.BYTES_PER_ELEMENT);this.typedBufferStride=f/d.BYTES_PER_ELEMENT;this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride);this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}d.prototype.get=function(d){return this.typedBuffer[d*this.typedBufferStride]};d.prototype.set=function(d,q){this.typedBuffer[d*this.typedBufferStride]=q};Object.defineProperty(d.prototype,
"buffer",{get:function(){return this.typedBuffer.buffer},enumerable:!0,configurable:!0});d.ElementCount=1;return d}();d.BufferViewScalarImpl=z})},"esri/views/3d/support/buffer/internals/Vec2":function(){define(["require","exports","../../../../../core/libs/gl-matrix-2/vec2"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});z=function(){function d(d,b,f,h,l){void 0===f&&(f=0);this.TypedArrayConstructor=d;this.elementCount=2;d=this.TypedArrayConstructor;void 0===h&&(h=2*d.BYTES_PER_ELEMENT);
var c=0===b.byteLength?0:f;this.typedBuffer=null==l?new d(b,c):new d(b,c,(l-f)/d.BYTES_PER_ELEMENT);this.typedBufferStride=h/d.BYTES_PER_ELEMENT;this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride);this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}d.prototype.getVec=function(d,b){return t.vec2.set(b,this.typedBuffer[d*this.typedBufferStride],this.typedBuffer[d*this.typedBufferStride+1])};d.prototype.setVec=function(d,b){this.typedBuffer[d*this.typedBufferStride]=
b[0];this.typedBuffer[d*this.typedBufferStride+1]=b[1]};d.prototype.get=function(d,b){return this.typedBuffer[d*this.typedBufferStride+b]};d.prototype.set=function(d,b,f){this.typedBuffer[d*this.typedBufferStride+b]=f};d.prototype.setValues=function(d,b,f){this.typedBuffer[d*this.typedBufferStride]=b;this.typedBuffer[d*this.typedBufferStride+1]=f};d.prototype.copyFrom=function(d,b,f){var h=this.typedBuffer,l=b.typedBuffer;d*=this.typedBufferStride;b=f*b.typedBufferStride;h[d]=l[b];h[d+1]=l[b+1]};
Object.defineProperty(d.prototype,"buffer",{get:function(){return this.typedBuffer.buffer},enumerable:!0,configurable:!0});d.ElementCount=2;return d}();d.BufferViewVec2Impl=z})},"esri/views/3d/support/buffer/internals/Vec3":function(){define(["require","exports","../../../../../core/libs/gl-matrix-2/vec3"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});z=function(){function d(d,b,f,h,l){void 0===f&&(f=0);this.TypedArrayConstructor=d;this.elementCount=3;d=this.TypedArrayConstructor;
void 0===h&&(h=3*d.BYTES_PER_ELEMENT);var c=0===b.byteLength?0:f;this.typedBuffer=null==l?new d(b,c):new d(b,c,(l-f)/d.BYTES_PER_ELEMENT);this.typedBufferStride=h/d.BYTES_PER_ELEMENT;this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride);this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}d.prototype.getVec=function(d,b){return t.vec3.set(b,this.typedBuffer[d*this.typedBufferStride],this.typedBuffer[d*this.typedBufferStride+1],this.typedBuffer[d*this.typedBufferStride+
2])};d.prototype.setVec=function(d,b){this.typedBuffer[d*this.typedBufferStride]=b[0];this.typedBuffer[d*this.typedBufferStride+1]=b[1];this.typedBuffer[d*this.typedBufferStride+2]=b[2]};d.prototype.get=function(d,b){return this.typedBuffer[d*this.typedBufferStride+b]};d.prototype.set=function(d,b,f){this.typedBuffer[d*this.typedBufferStride+b]=f};d.prototype.setValues=function(d,b,f,h){this.typedBuffer[d*this.typedBufferStride]=b;this.typedBuffer[d*this.typedBufferStride+1]=f;this.typedBuffer[d*
this.typedBufferStride+2]=h};d.prototype.copyFrom=function(d,b,f){var h=this.typedBuffer,l=b.typedBuffer;d*=this.typedBufferStride;b=f*b.typedBufferStride;h[d]=l[b];h[d+1]=l[b+1];h[d+2]=l[b+2]};Object.defineProperty(d.prototype,"buffer",{get:function(){return this.typedBuffer.buffer},enumerable:!0,configurable:!0});d.ElementCount=3;return d}();d.BufferViewVec3Impl=z})},"esri/views/3d/support/buffer/internals/Vec4":function(){define(["require","exports","../../../../../core/libs/gl-matrix-2/vec4"],
function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});z=function(){function d(d,b,f,h,l){void 0===f&&(f=0);this.TypedArrayConstructor=d;this.elementCount=4;d=this.TypedArrayConstructor;void 0===h&&(h=4*d.BYTES_PER_ELEMENT);var c=0===b.byteLength?0:f;this.typedBuffer=null==l?new d(b,c):new d(b,c,(l-f)/d.BYTES_PER_ELEMENT);this.typedBufferStride=h/d.BYTES_PER_ELEMENT;this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride);this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}
d.prototype.getVec=function(d,b){return t.vec4.set(b,this.typedBuffer[d*this.typedBufferStride],this.typedBuffer[d*this.typedBufferStride+1],this.typedBuffer[d*this.typedBufferStride+2],this.typedBuffer[d*this.typedBufferStride+3])};d.prototype.setVec=function(d,b){this.typedBuffer[d*this.typedBufferStride]=b[0];this.typedBuffer[d*this.typedBufferStride+1]=b[1];this.typedBuffer[d*this.typedBufferStride+2]=b[2];this.typedBuffer[d*this.typedBufferStride+3]=b[3]};d.prototype.get=function(d,b){return this.typedBuffer[d*
this.typedBufferStride+b]};d.prototype.set=function(d,b,f){this.typedBuffer[d*this.typedBufferStride+b]=f};d.prototype.setValues=function(d,b,f,h,l){this.typedBuffer[d*this.typedBufferStride]=b;this.typedBuffer[d*this.typedBufferStride+1]=f;this.typedBuffer[d*this.typedBufferStride+2]=h;this.typedBuffer[d*this.typedBufferStride+3]=l};d.prototype.copyFrom=function(d,b,f){var h=this.typedBuffer,l=b.typedBuffer;d*=this.typedBufferStride;b=f*b.typedBufferStride;h[d]=l[b];h[d+1]=l[b+1];h[d+2]=l[b+2];h[d+
3]=l[b+3]};Object.defineProperty(d.prototype,"buffer",{get:function(){return this.typedBuffer.buffer},enumerable:!0,configurable:!0});d.ElementCount=4;return d}();d.BufferViewVec4Impl=z})},"esri/views/3d/support/buffer/types":function(){define(["require","exports","../../../../core/compilerUtils"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});d.elementTypeSize=function(d){switch(d){case "u8":return 1;case "u16":return 2;case "u32":return 4;case "i8":return 1;case "i16":return 2;
case "i32":return 4;case "f32":return 4;case "f64":return 8;default:t.neverReached(d)}};d.isSigned=function(d){switch(d){case "u8":case "u16":case "u32":return!1;case "i8":case "i16":case "i32":case "f32":case "f64":return!0;default:t.neverReached(d)}};d.isInteger=function(d){switch(d){case "u8":case "u16":case "u32":case "i8":case "i16":case "i32":return!0;case "f32":case "f64":return!1;default:t.neverReached(d)}};d.maximumValue=function(d){switch(d){case "u8":return 255;case "u16":return 65535;
case "u32":return 4294967295;case "i8":return 127;case "i16":return 32767;case "i32":return 2147483647;case "f32":return 3.402823E38;case "f64":return 1.79769E308;default:t.neverReached(d)}}})},"esri/views/3d/webgl-engine/lib/GLMaterial":function(){define("require exports ../../../../core/tsSupport/declareExtendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/accessorSupport/decorators ./AutoDisposable".split(" "),function(z,d,t,l,q,b){Object.defineProperty(d,"__esModule",{value:!0});
z=function(b){function d(d){var c=b.call(this)||this;c.material=d.material;c.techniqueRep=d.techniqueRep;c.output=d.output;return c}t(d,b);d.prototype.getTechnique=function(){return this.technique};d.prototype.getPipelineState=function(b,c){return this.getTechnique().pipeline};d.prototype.ensureResources=function(b){return 2};d.prototype.ensureParameters=function(b){};return d=l([q.subclass("esri.views.3d.webgl-engine.lib.GLMaterial")],d)}(q.declared(b.AutoDisposable));d.GLMaterial=z})},"esri/views/3d/webgl-engine/lib/Material":function(){define(["require",
"exports","../../../../core/maybe","./IdGen"],function(z,d,t,l){Object.defineProperty(d,"__esModule",{value:!0});z=function(){function d(b){this.supportsEdges=!1;this._visible=!0;this._renderOccluded=1;this._renderPriority=0;this.id=d._idGen.gen(b)}d.prototype.dispose=function(){};d.prototype.update=function(b){return!1};Object.defineProperty(d.prototype,"visible",{get:function(){return this._visible},set:function(b){b!==this._visible&&(this._visible=b,this.parametersChanged())},enumerable:!0,configurable:!0});
Object.defineProperty(d.prototype,"renderOccluded",{get:function(){return this._renderOccluded},set:function(b){b!==this._renderOccluded&&(this._renderOccluded=b,this.parametersChanged())},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"renderPriority",{get:function(){return this._renderPriority},set:function(b){b!==this._renderPriority&&(this._renderPriority=b,this.parametersChanged())},enumerable:!0,configurable:!0});d.prototype.isVisibleInPass=function(b){return!0};d.prototype.isVisible=
function(){return this._visible};d.prototype.parametersChanged=function(){t.isSome(this.materialRepository)&&this.materialRepository.materialChanged(this)};d._idGen=new l.IdGen;return d}();d.Material=z;d.materialPredicate=function(d,b){return d.isVisible()&&d.isVisibleInPass(b.pass)&&0!==(d.renderOccluded&b.renderOccludedMask)}})},"esri/views/3d/webgl-engine/materials/VisualVariableMaterialParameters":function(){define(["require","exports","../../../../core/libs/gl-matrix-2/mat3f64","../../../../core/libs/gl-matrix-2/vec3f32"],
function(z,d,t,l){var q;(q||(q={})).Default={vvSizeEnabled:!1,vvSizeMinSize:l.vec3f32.fromValues(1,1,1),vvSizeMaxSize:l.vec3f32.fromValues(100,100,100),vvSizeOffset:l.vec3f32.fromValues(0,0,0),vvSizeFactor:l.vec3f32.fromValues(1,1,1),vvSizeValue:l.vec3f32.fromValues(1,1,1),vvColorEnabled:!1,vvColorValues:[0,0,0,0,0,0,0,0],vvColorColors:[1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],vvOpacityEnabled:!1,vvOpacityValues:[0,0,0,0,0,0,0,0],vvOpacityOpacities:[1,1,1,1,1,1,1,1],vvSymbolAnchor:[0,
0,0],vvSymbolRotationMatrix:t.mat3f64.create()};return q})},"esri/views/3d/webgl-engine/materials/internal/MaterialUtil":function(){define("require exports ../../../../../core/tsSupport/assignHelper ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../core/libs/gl-matrix-2/mat4 ../../../../../core/libs/gl-matrix-2/mat4f64 ../../../../../core/libs/gl-matrix-2/vec3 ../../../../../core/libs/gl-matrix-2/vec3f64 ../../../../../core/libs/gl-matrix-2/vec4 ../../../../../geometry/support/aaBoundingBox ../../lib/ComponentUtils ../../lib/screenSizePerspectiveUtils ../../lib/Util".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u,D){function w(c,b,d,f,p,h){var A=C(b,d,P);a.setMin(N,c.getBBMin());a.setMax(N,c.getBBMax());q.isSome(p)&&p.applyToAABB(N);if(J(N,b,A,f)){var A=c.getPrimitiveIndices(),k=c.getIndices(),e=c.getPosition(),g=A?A.length:k.length/3;if(g>V&&(c=c.getChildren(),void 0!==c)){for(A=0;8>A;++A)void 0!==c[A]&&w(c[A],b,d,f,p,h);return}v(b,d,0,g,k,e,A,p,h)}}function v(a,c,b,d,p,f,A,k,e){var g,n,y;if(A){var B,F,H=f.data,M=f.offsetIdx;f=f.strideIdx;var h=a[0],m=a[1];a=a[2];var l=
c[0]-h,r=c[1]-m;for(c=c[2]-a;b<d;++b){var u=A[b],v=3*u;F=M+f*p[v++];var w=H[F++],t=H[F++];g=H[F];F=M+f*p[v++];var L=H[F++];n=H[F++];B=H[F];F=M+f*p[v];v=H[F++];y=H[F++];F=H[F];q.isSome(k)&&(g=k.applyToVertex(w,t,g),w=g[0],t=g[1],g=g[2],B=k.applyToVertex(L,n,B),L=B[0],n=B[1],B=B[2],F=k.applyToVertex(v,y,F),v=F[0],y=F[1],F=F[2]);L-=w;n-=t;B-=g;v-=w;y-=t;F-=g;var x=r*F-y*c,D=c*v-F*l,C=l*y-v*r,J=L*x+n*D+B*C;if(!(Math.abs(J)<=S)){w=h-w;t=m-t;g=a-g;x=w*x+t*D+g*C;if(0<J){if(0>x||x>J)continue}else if(0<x||
x<J)continue;D=t*B-n*g;g=g*L-B*w;t=w*n-L*t;w=l*D+r*g+c*t;if(0<J){if(0>w||x+w>J)continue}else if(0<w||x+w<J)continue;t=(v*D+y*g+F*t)/J;0<=t&&(L=E(L,n,B,v,y,F,R),e(t,L,u))}}}else for(A=f.data,H=f.offsetIdx,M=f.strideIdx,f=a[0],h=a[1],m=a[2],a=c[0]-f,l=c[1]-h,r=c[2]-m,c=b,b*=3;c<d;++c)if(y=H+M*p[b++],w=A[y++],t=A[y++],g=A[y],y=H+M*p[b++],u=A[y++],L=A[y++],n=A[y],y=H+M*p[b++],B=A[y++],v=A[y++],y=A[y],q.isSome(k)&&(g=k.applyToVertex(w,t,g),w=g[0],t=g[1],g=g[2],n=k.applyToVertex(u,L,n),u=n[0],L=n[1],n=
n[2],y=k.applyToVertex(B,v,y),B=y[0],v=y[1],y=y[2]),u-=w,L-=t,n-=g,B-=w,v-=t,y-=g,J=l*y-v*r,x=r*B-y*a,D=a*v-B*l,F=u*J+L*x+n*D,!(Math.abs(F)<=S)){w=f-w;t=h-t;g=m-g;J=w*J+t*x+g*D;if(0<F){if(0>J||J>F)continue}else if(0<J||J<F)continue;x=t*n-L*g;g=g*u-n*w;t=w*L-u*t;w=a*x+l*g+r*t;if(0<F){if(0>w||J+w>F)continue}else if(0<w||J+w<F)continue;t=(B*x+v*g+y*t)/F;0<=t&&(u=E(u,L,n,B,v,y,R),e(t,u,c))}}function E(a,c,b,d,p,f,A){h.vec3.set(Q,a,c,b);h.vec3.set(U,d,p,f);h.vec3.cross(A,Q,U);h.vec3.normalize(A,A);return A}
function C(a,c,b){return h.vec3.set(b,1/(c[0]-a[0]),1/(c[1]-a[1]),1/(c[2]-a[2]))}function J(a,c,b,d){return K(a,c,b,d,Infinity)}function K(a,c,b,d,p){var f=(a[0]-d-c[0])*b[0],A=(a[3]+d-c[0])*b[0],k=Math.min(f,A),f=Math.max(f,A),A=(a[1]-d-c[1])*b[1],e=(a[4]+d-c[1])*b[1],f=Math.min(f,Math.max(A,e));if(0>f)return!1;k=Math.max(k,Math.min(A,e));if(k>f)return!1;A=(a[2]-d-c[2])*b[2];a=(a[5]+d-c[2])*b[2];f=Math.min(f,Math.max(A,a));if(0>f)return!1;k=Math.max(k,Math.min(A,a));return k>f?!1:k<p}function G(a,
c){c=c?G(c):{};for(var b in a){var d=a[b];d&&d.forEach&&(d=I(d));null==d&&b in c||(c[b]=d)}return c}function I(a){var c=[];a.forEach(function(a){return c.push(a)});return c}Object.defineProperty(d,"__esModule",{value:!0});var x=f.mat4f64.create(),N=a.create(),O=D.VertexAttrConstants;d.intersectTriangleGeometry=function(c,b,d,f,p,h,A){b=b&&b.componentVisibilities;d=d.tolerance;if(1<c.componentCount)a:{var k=C(f,p,P),e=c.componentCount,g=c.componentOffsets,n=c.getIndices(O.POSITION),y=c.getAttribute(O.POSITION),
B=c.boundingInfo;if(B&&(a.setMin(N,B.getBBMin()),a.setMax(N,B.getBBMax()),q.isSome(h)&&h.applyToAABB(N),!J(N,f,k,d)))break a;for(B=0;B<e;B++)if(!b||m.getVisibility(b,B)){if(c.getComponentAABB){var F=c.getComponentAABB(B,N);q.isSome(h)&&h.applyToAABB(F);if(!J(F,f,k,d))continue}v(f,p,g[B]/3,g[B+1]/3,n,y,void 0,h,A)}}else if(!b||m.getVisibility(b,0))c.boundingInfo?(D.assert("triangle"===c.data.primitiveType),w(c.boundingInfo,f,p,d,h,A)):(b=c.getIndices(O.POSITION),c=c.getAttribute(O.POSITION),v(f,p,
0,b.length/3,b,c,void 0,h,A))};var P=r.vec3f64.create(),S=Math.pow(2,-52),R=r.vec3f64.create();d.intersectTriangles=v;var Q=r.vec3f64.create(),U=r.vec3f64.create();d.computeNormal=E;d.computeInvDir=C;d.intersectAabbInvDir=J;d.intersectAabbInvDirBefore=K;d.transformToWorld=function(a,b,d){return c.vec4.set(d,a[0]-b[0],a[1]-b[1],a[2]-b[2],1)};d.transformToView=function(a,d,f,h){b.mat4.translate(x,f,d);return c.vec4.transformMat4(h,a,x)};d.transformToProjection=function(a,b,d,f){f[0]=a[0]+d[0];f[1]=
a[1]+d[1];f[2]=a[2]+d[2];f[3]=a[3];return c.vec4.transformMat4(f,f,b)};d.transformToNDC=function(a,b){return c.vec4.scale(b,a,1/Math.abs(a[3]))};d.verticalOffsetAtDistance=function(a,c,b,d,p){var f=(b.screenLength||0)*a.pixelRatio;p&&(f=u.scale(f,d,c,p));return l.glClamp(f*Math.tan(.5*a.fovY)/(.5*a.fullHeight)*c,b.minWorldLength||0,null!=b.maxWorldLength?b.maxWorldLength:Infinity)};d.acquireIfNotUndefined=function(a,c,b){if(void 0!==a)return c.acquire(a,b)};d.releaseIfNotUndefined=function(a,c){void 0!==
a&&c.release(a)};d.bindScreenSizePerspective=function(a,c,b){void 0===b&&(b="screenSizePerspectiveAlignment");if(a){var d=a.parameters;c.setUniform4f(b,d.divisor,d.offset,d.minPixelSize,a.paddingPixelsOverride)}};d.copyParameters=G;d.updateParameters=function(a,c){var b=!1,d;for(d in c){var p=c[d];void 0!==p&&(b=!0,Array.isArray(p)?a[d]=p.slice():a[d]=p)}return b};d.intersectDrapedRenderLineGeometry=function(a,c,b,d,p){if(c.options.selectionMode){c=a.getAttribute(O.POSITION).data;var f=a.getAttribute(O.SIZE),
A=b[0];b=b[1];a=(((f&&f.data[0])+d)/2+4)*a.pixelRatio;d=Number.MAX_VALUE;for(f=0;f<c.length-5;f+=3){var k=c[f],e=c[f+1],g=A-k,n=b-e,k=c[f+3]-k,e=c[f+4]-e,y=l.clamp((k*g+e*n)/(k*k+e*e),0,1),g=k*y-g,n=e*y-n,n=g*g+n*n;n<d&&(d=n)}d<a*a&&p()}};d.colorMixModes={multiply:1,ignore:2,replace:3,tint:4};var V=1E3})},"esri/views/3d/webgl-engine/lib/screenSizePerspectiveUtils":function(){define(["require","exports","../../../../core/mathUtils","../../support/earthUtils"],function(z,d,t,l){function q(a){return Math.abs(a*
a*a)}function b(a,c,b,d){void 0===d&&(d=m);var f=b.parameters;b=b.paddingPixelsOverride;d.scale=Math.min(f.divisor/(c-f.offset),1);d.factor=q(a);d.minPixelSize=f.minPixelSize;d.paddingPixels=b;return d}function f(a,c){return 0===a?c.minPixelSize:c.minPixelSize*(1+2*c.paddingPixels/a)}function h(a,c){return Math.max(t.lerp(a*c.scale,a,c.factor),f(a,c))}function r(a,c,d){a=b(a,c,d);a.minPixelSize=0;a.paddingPixels=0;return h(1,a)}Object.defineProperty(d,"__esModule",{value:!0});d.getSettings=function(a){return new c(a,
d.defaultDescription)};d.getLabelSettings=function(b){var f=d.defaultDescription.curvatureDependent;return new c(b,{curvatureDependent:{min:{curvature:f.min.curvature,tiltAngle:f.min.tiltAngle,scaleFallOffFactor:a.curvatureDependent.min.scaleFallOffFactor},max:{curvature:f.max.curvature,tiltAngle:f.max.tiltAngle,scaleFallOffFactor:a.curvatureDependent.max.scaleFallOffFactor}},scaleStart:d.defaultDescription.scaleStart,scaleFallOffRange:d.defaultDescription.scaleFallOffRange,minPixelSize:a.minPixelSize})};
d.perspectiveFactor=q;d.scaleFactor=b;d.applyScaleFactor=h;d.applyScaleFactorVec2=function(a,c,b){void 0===b&&(b=[0,0]);var d=Math.min(Math.max(c.scale,f(a[1],c)/a[1]),1);b[0]=t.lerp(a[0]*d,a[0],c.factor);b[1]=t.lerp(a[1]*d,a[1],c.factor);return b};d.precomputeScale=r;d.precomputeScaleFactor=function(a,c,b,d){d.scale=r(a,c,b);d.factor=0;d.minPixelSize=b.parameters.minPixelSize;d.paddingPixels=b.paddingPixelsOverride;return d};d.applyPrecomputedScaleFactorVec2=function(a,c,b){void 0===b&&(b=[0,0]);
c=Math.min(Math.max(c.scale,f(a[1],c)/a[1]),1);b[0]=a[0]*c;b[1]=a[1]*c;return b};d.scale=function(a,c,d,f){return h(a,b(c,d,f))};var c=function(){function a(a,c,b,d){void 0===b&&(b={camera:{distance:0,fovY:0},divisor:0,offset:0,minPixelSize:0,paddingPixels:0});this.viewingMode=a;this.description=c;this.parameters=b;this._paddingPixelsOverride=d;"local"===this.viewingMode?(this.coverageCompensation=this.surfaceCoverageCompensationLocal,this.calculateCurvatureDependentParameters=this.calculateCurvatureDependentParametersLocal):
(this.coverageCompensation=this.surfaceCoverageCompensationGlobal,this.calculateCurvatureDependentParameters=this.calculateCurvatureDependentParametersGlobal)}Object.defineProperty(a.prototype,"paddingPixelsOverride",{get:function(){return this._paddingPixelsOverride||this.parameters.paddingPixels},enumerable:!0,configurable:!0});a.prototype.update=function(a){if(this.parameters&&this.parameters.camera.fovY===a.fovY&&this.parameters.camera.distance===a.distance)return!1;this.calculateParameters(a,
this.parameters);return!0};a.prototype.overridePadding=function(c){return c!==this.paddingPixelsOverride?new a(this.viewingMode,this.description,this.parameters,c):this};a.prototype.calculateParameters=function(a,c){var b=this.description,d=b.scaleStart,f=b.scaleFallOffRange,b=b.minPixelSize,h=a.fovY,m=a.distance,l=this.calculateCurvatureDependentParameters(a),r=this.coverageCompensation(a,l),q=l.tiltAngle,l=l.scaleFallOffFactor,m=Math.sin(q)*m,q=.5*Math.PI-q-h*(.5-d*r),d=m/Math.cos(q),f=(d-m/Math.cos(q+
h*f*r)*l)/(1-l);c.camera.fovY=a.fovY;c.camera.distance=a.distance;c.offset=f;c.divisor=d-f;c.minPixelSize=b;return c};a.prototype.calculateCurvatureDependentParametersLocal=function(a,c){void 0===c&&(c=u);c.tiltAngle=this.description.curvatureDependent.min.tiltAngle;c.scaleFallOffFactor=this.description.curvatureDependent.min.scaleFallOffFactor;return c};a.prototype.calculateCurvatureDependentParametersGlobal=function(a,c){void 0===c&&(c=u);var b=this.description.curvatureDependent;a=1+a.distance/
l.earthRadius;var d=[b.min.curvature,b.max.curvature],f=d[0];a=t.clamp((Math.sqrt(a*a-1)-f)/(d[1]-f),0,1);d=[b.min,b.max];b=d[0];d=d[1];c.tiltAngle=t.lerp(b.tiltAngle,d.tiltAngle,a);c.scaleFallOffFactor=t.lerp(b.scaleFallOffFactor,d.scaleFallOffFactor,a);return c};a.prototype.surfaceCoverageCompensationLocal=function(a,c){return(a.fovY-c.tiltAngle)/a.fovY};a.prototype.surfaceCoverageCompensationGlobal=function(a,c){var b=l.earthRadius*l.earthRadius;c=c.tiltAngle+.5*Math.PI;var d=a.fovY;a=a.distance;
a=a*a+b-2*Math.cos(c)*a*l.earthRadius;var f=Math.sqrt(a);return(Math.acos(Math.sqrt(a-b)/f)-Math.asin(l.earthRadius/(f/Math.sin(c)))+.5*d)/d};return a}();d.defaultDescription={curvatureDependent:{min:{curvature:t.deg2rad(10),tiltAngle:t.deg2rad(12),scaleFallOffFactor:.5},max:{curvature:t.deg2rad(70),tiltAngle:t.deg2rad(40),scaleFallOffFactor:.8}},scaleStart:.3,scaleFallOffRange:.65,minPixelSize:0};var a={curvatureDependent:{min:{scaleFallOffFactor:.7},max:{scaleFallOffFactor:.95}},minPixelSize:14};
d.copyParameters=function(a,c){c.camera.distance=a.camera.distance;c.camera.fovY=a.camera.fovY;c.divisor=a.divisor;c.offset=a.offset;c.minPixelSize=a.minPixelSize;return c};var m={scale:0,factor:0,minPixelSize:0,paddingPixels:0},u={tiltAngle:0,scaleFallOffFactor:0}})},"esri/views/3d/webgl-engine/materials/renderers/MergedRenderer":function(){define("require exports ../../../../../core/MapUtils ../../../../../core/maybe ../../../../../core/libs/gl-matrix-2/mat4 ../../../../../core/libs/gl-matrix-2/mat4f64 ../../../support/buffer/glUtil ../../lib/DefaultVertexAttributeLocations ../../lib/IntervalUtilities ../../lib/ResizableFloat32Array ../../lib/Util ../WaterGLMaterial ./Instance ./utils ../../../../webgl/BufferObject ../../../../webgl/Util ../../../../webgl/VertexArrayObject".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u,D,w,v,E){function C(a,c,b,d){for(var f=new Map,h=c.vertexBufferLayout.stride/4,m=function(b,d){var m=b.origin,p=a.get(m.id),l=f.get(m.id);null==l&&(l={optimalCount:null==p?0:p.optimalCount,sparseCount:null==p?0:p.buffer.size,toAdd:[],toRemove:[],origin:m.vec3},f.set(m.id,l));m=c.elementCount(b.data)*h;d?(l.optimalCount+=m,l.sparseCount+=m,l.toAdd.push(b)):(l.optimalCount-=m,l.toRemove.push(b))},l=0;l<b.length;l++){var r=b[l];m(r,!0)}for(b=0;b<d.length;b++)r=d[b],
m(r,!1);return f}z=function(){function d(a,c,b,d){void 0===d&&(d=h.Default3D);this.type="MergedRenderer";this._dataByOrigin=new Map;this._highlightCount=0;this._hasOccludees=!1;this._rctx=a;this._vertexAttributeLocations=d;this._material=b;this._materialRep=c;this._glMaterials=D.acquireMaterials(this._material,this._materialRep);this._bufferWriter=b.createBufferWriter()}d.prototype.dispose=function(){D.releaseMaterials(this._material,this._materialRep)};Object.defineProperty(d.prototype,"isEmpty",
{get:function(){return 0===this._dataByOrigin.size},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"hasHighlights",{get:function(){return 0<this._highlightCount},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"hasOccludees",{get:function(){return this._hasOccludees},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"hasWater",{get:function(){return!this.isEmpty&&t.someMap(this._glMaterials,function(a){return a instanceof m.WaterGLMaterial})},enumerable:!0,
configurable:!0});Object.defineProperty(d.prototype,"rendersOccluded",{get:function(){return!this.isEmpty&&1!==this._material.renderOccluded},enumerable:!0,configurable:!0});d.prototype.modify=function(a){var c=this,b=x;b.clear();this.updateGeometries(a.toUpdate,b);this.addAndRemoveGeometries(a.toAdd,a.toRemove,b);this.updateHighlightCount();this.updateOccludeeFlag();b.forEach(function(a){return c.updateDisplayedIndexRanges(a)})};d.prototype.addAndRemoveGeometries=function(c,b,d){var f=this,h=this._bufferWriter,
m=h.vertexBufferLayout,l=m.stride/4,r=this._dataByOrigin,q=C(r,h,c,b);q.forEach(function(c,b){q.delete(b);var p=c.optimalCount,h=c.sparseCount,A=r.get(b);null==A&&(a.assert(0<p),A=f.createData(m,p,c.origin),r.set(b,A));if(0===p)A.vao.dispose(!0),A.vao=null,r.delete(b);else{var k=p<c.sparseCount/2;b=J;var e=A.buffer.size,g=A.buffer.array,p=A.buffer.resize(k?p:h,!1);k||p?f.removeAndRebuild(A,c.toRemove,l,g,b):0<c.toRemove.length?(f.removeByErasing(A,c.toRemove,l,b),0<c.toAdd.length&&(b.end=e)):(b.begin=
e,b.end=e);p=K;a.setMatrixTranslation3(p,-c.origin[0],-c.origin[1],-c.origin[2]);f.append(A,c.toAdd,l,p,b);c=A.vao.vertexBuffers.geometry;c.byteSize!==A.buffer.array.buffer.byteLength?c.setData(A.buffer.array):(h=b.begin,p=b.end,h<p&&(h*=4,c.setSubData(A.buffer.array,h,h,4*p)));(b.updatedDisplayedIndexRange||A.displayedIndexRanges)&&d.add(A)}})};d.prototype.updateGeometries=function(c,b){for(var d=this._bufferWriter,f=d.vertexBufferLayout.stride/4,h=0;h<c.length;h++){var m=c[h],l=m.updateType,m=m.renderGeometry,
r=this._dataByOrigin.get(m.origin.id),q=r&&r.instances.get(m.uniqueName);if(!q)break;l&1&&(q.isHidden=D.checkIsHidden(m),b.add(r));l&9&&(q.highlightedIndexRanges=D.generateRenderGeometryHighlightRanges(m),r.highlightCount=null);l&16&&(q.hasOccludees=!!m.instanceParameters.occludees);l&6&&(l=r.buffer.array,r=r.vao,D.calculateTransformRelToOrigin(m,G,I),d.write({transformation:G,invTranspTransformation:I},m.data,d.vertexBufferLayout.createView(l.buffer),q.from),a.assert(q.from+d.elementCount(m.data)===
q.to,"material VBO layout has changed"),r.vertexBuffers.geometry.setSubData(l,q.from*f*4,q.from*f*4,q.to*f*4))}};d.prototype.updateDisplayedIndexRanges=function(a){a.displayedIndexRanges=[];var c=!0;a.instances.forEach(function(b){b.isHidden?c=!1:a.displayedIndexRanges.push([b.from,b.to-1])});a.displayedIndexRanges=c?null:r.mergeIntervals(a.displayedIndexRanges)};d.prototype.updateHighlightCount=function(){var a=this;this._highlightCount=0;this._dataByOrigin.forEach(function(c){if(null==c.highlightCount){var b=
0;c.instances.forEach(function(a){a.highlightedIndexRanges&&++b});c.highlightCount=b}a._highlightCount+=c.highlightCount})};d.prototype.updateOccludeeFlag=function(){this._hasOccludees=t.someMap(this._dataByOrigin,function(a){a.hasOccludees=t.someMap(a.instances,function(a){return a.hasOccludees});return a.hasOccludees})};d.prototype.updateLogic=function(a){return this._material.update(a)};d.prototype.render=function(a,c,d,f){var h=this,m=this._rctx,l=this._glMaterials.get(c.pass),r=4===c.pass,q=
a;2===c.pass&&null===q&&(q=22);if(!l||2!==l.ensureResources(m)||null!=q&&!l.beginSlot(q)||r&&0===this._highlightCount)return!1;l.ensureParameters(d);var u=l.getTechnique(),t=l.getPipelineState(q,!1);m.setPipelineState(t);l.bind(m,d);u.program.setUniformMatrix4fv("model",b.mat4f64.IDENTITY);u.program.hasUniform("modelNormal")&&u.program.setUniformMatrix4fv("modelNormal",b.mat4f64.IDENTITY);var p=!1;this._dataByOrigin.forEach(function(a){if(!r||0!==a.highlightCount)if(d.origin=a.origin,u.bindDraw(d),
u.ensureAttributeLocations(a.vao),m.bindVAO(a.vao),r)p=h.renderHighlightPass(u,a,f)||p;else if(a.hasOccludees){var c=l.getPipelineState(q,!0);p=h.renderDefaultPassWithOccludees(u,a,t,c,f)||p}else p=h.renderDefaultPass(u,a,f)||p});return p};d.prototype.renderDefaultPass=function(a,c,b){var d=this._rctx,f=c.displayedIndexRanges;if(f&&0===f.length)return!1;f?D.drawArraysFaceRange(d,f,0,a.primitiveType,b):(c=4*c.buffer.size/v.getStride(c.vao.layout.geometry),D.drawArrays(d,a.primitiveType,0,c,b));return!0};
d.prototype.renderDefaultPassWithOccludees=function(a,c,b,d,f){var h=this._rctx,m=c.displayedIndexRanges;if(m&&0===m.length)return!1;c.instances.forEach(function(c){c.isHidden||(c.hasOccludees&&h.setPipelineState(d),D.drawArrays(h,a.primitiveType,c.from,c.to-c.from,f),c.hasOccludees&&h.setPipelineState(b))});return!0};d.prototype.renderHighlightPass=function(a,c,b){var d=this._rctx,f=!1;c.instances.forEach(function(c){var h=c.highlightedIndexRanges;if(h&&0!==h.length)for(var m=0;m<h.length;m++){var l=
h[m];D.drawArrays(d,a.primitiveType,l?l[0]+c.from:c.from,l?l[1]-l[0]+1:c.to-c.from,b);f=!0}});return f};d.prototype.createData=function(a,b,d){return{instances:new Map,vao:new E(this._rctx,this._vertexAttributeLocations,{geometry:f.glLayout(a)},{geometry:w.createVertex(this._rctx,35044)}),buffer:new c.ResizableFloat32Array(b),optimalCount:0,origin:d,highlightCount:0,hasOccludees:!1}};d.prototype.removeAndRebuild=function(a,c,b,d,f){for(var h=0;h<c.length;h++){var m=c[h].uniqueName,l=a.instances.get(m);
a.optimalCount-=(l.to-l.from)*b;a.instances.delete(m)}var r=0,q=a.buffer.array;f.begin=0;f.end=0;var u=-1,p=-1,t=0;a.instances.forEach(function(a){var k=a.from*b,e=a.to*b,g=e-k;u!==p&&p!==k?(q.set(d.subarray(u,p),t),t+=p-u,u=k):-1===u&&(u=k);p=e;a.from=r/b;r+=g;a.to=r/b});u!==p&&q.set(d.subarray(u,p),t);f.end=r};d.prototype.removeByErasing=function(a,c,b,d){d.begin=Infinity;d.end=-Infinity;for(var f=-1,h=-1,m=0;m<c.length;m++){var l=c[m].uniqueName,r=a.instances.get(l),q=r.from*b,r=r.to*b;f!==h&&
h!==q?(a.buffer.erase(f,h),f=q):-1===f&&(f=q);h=r;a.instances.delete(l);a.optimalCount-=r-q;q<d.begin&&(d.begin=q);r>d.end&&(d.end=r)}f!==h&&a.buffer.erase(f,h)};d.prototype.append=function(c,b,d,f,h){h.updatedDisplayedIndexRange=!1;for(var m=this._bufferWriter,r=0;r<b.length;r++){var t=b[r],v=t.data,w=l.isSome(t.transformation)?q.mat4.multiply(G,f,t.transformation):f;q.mat4.invert(I,w);q.mat4.transpose(I,I);var x=h.end;m.write({transformation:w,invTranspTransformation:I},v,m.vertexBufferLayout.createView(c.buffer.array.buffer),
h.end/d);var v=m.elementCount(v)*d,p=x+v;a.assert(null==c.instances.get(t.uniqueName));var w=D.checkIsHidden(t),L=D.generateRenderGeometryHighlightRanges(t),A=!!t.instanceParameters.occludees;L&&(c.highlightCount=null);A&&(c.hasOccludees=c.hasOccludees||!0);x=new u.Instance(x/d,p/d,w,L,A);c.instances.set(t.uniqueName,x);w&&(h.updatedDisplayedIndexRange=!0);c.optimalCount+=v;h.end+=v}};Object.defineProperty(d.prototype,"test",{get:function(){return{material:this._material}},enumerable:!0,configurable:!0});
return d}();var J={updatedDisplayedIndexRange:!1,begin:0,end:0},K=b.mat4f64.create(),G=b.mat4f64.create(),I=b.mat4f64.create(),x=new Set;return z})},"esri/views/3d/support/buffer/glUtil":function(){define(["require","exports","../../../../core/tsSupport/assignHelper"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});var l={divisor:0};d.glLayout=function(b,d){void 0===d&&(d={});d=t({},l,d);var f=b.stride;return b.fieldNames.filter(function(d){d=b.fields.get(d).optional;return!(d&&d.glPadding)}).map(function(h){var c=
b.fields.get(h),a=c.constructor.ElementCount;var m=q[c.constructor.ElementType];if(!m)throw Error("BufferType not supported in WebGL");return{name:h,stride:f,count:a,type:m,offset:c.offset,normalized:!(!c.optional||!c.optional.glNormalized),divisor:d.divisor}})};var q={u8:5121,u16:5123,u32:5125,i8:5120,i16:5122,i32:5124,f32:5126}})},"esri/views/3d/webgl-engine/lib/IntervalUtilities":function(){define(["require","exports"],function(z,d){return function(){function d(){}d.copyIntervals=function(d){for(var l=
[],b=0;b<d.length;b++){var f=d[b];l.push([f[0],f[1]])}return l};d.convertFaceToIndexRange=function(d,q){for(var b=0;b<d.length;b++){var f=d[b];f[0]*=q;f[1]=f[1]*q+(q-1)}};d.sortIntervals=function(d){return d.sort(function(d,b){return d[0]===b[0]?d[1]>b[1]?1:d[1]<b[1]?-1:0:d[0]>b[0]?1:d[0]<b[0]?-1:0})};d.intersectIntervals=function(d,q){if(0>=d.length)return[];for(var b=[],f=0;f<d.length;f++){var h=d[f];h[1]<q[0]||h[0]>q[1]||(h=[h[0],h[1]],h[0]<q[0]&&(h[0]=q[0]),h[1]>q[1]&&(h[1]=q[1]),b.push(h))}return b};
d.mergeIntervals=function(d){if(0>=d.length)return[];var l=[];d=this.sortIntervals(d);l.push(d[0]);for(var b=1;b<d.length;b++){var f=l[l.length-1];f[1]+1<d[b][0]?l.push(d[b]):f[1]<d[b][1]&&(f[1]=d[b][1],l.pop(),l.push(f))}return l};d.invertIntervals=function(d,q){for(var b=[],f=0,h=0;h<d.length;h++){var l=d[h];l[0]>f&&b.push([f,l[0]-1]);f=l[1]+1}f<=q&&b.push([f,q]);return b};d.offsetIntervals=function(d,q){for(var b=[],f=0;f<d.length;f++){var h=d[f];b.push([h[0]+q,h[1]+q])}return b};return d}()})},
"esri/views/3d/webgl-engine/lib/ResizableFloat32Array":function(){define(["require","exports","../../../../core/mathUtils"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});z=function(){function d(d){null==d?d=16:65536>d&&(d=t.nextHighestPowerOfTwo(d));this._array=new Float32Array(d);this._size=0}d.prototype.resize=function(d,b){this._size=d;if(this._size>this._array.length){for(d=this._array.length||1;d<this._size;)d*=2;var f=new Float32Array(d);b&&f.set(this._array);this._array=
f;return!0}f=2*this._size;if(f<=this._array.length){for(d=this._array.length;d>=f;)d=Math.floor(d/2);f=new Float32Array(d);b&&f.set(this._array.subarray(0,d));this._array=f;return!0}return!1};d.prototype.append=function(d){var b=this._size;this.resize(this._size+d.length,!0);this._array.set(d,b)};d.prototype.erase=function(d,b){for(;d<b;++d)this._array[d]=0};Object.defineProperty(d.prototype,"array",{get:function(){return this._array},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,
"size",{get:function(){return this._size},enumerable:!0,configurable:!0});return d}();d.ResizableFloat32Array=z})},"esri/views/3d/webgl-engine/materials/WaterGLMaterial":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/assignHelper ../lib/GLMaterial ./WaterTechnique ./internal/MaterialUtil ./internal/waterMaterialUtils".split(" "),function(z,d,t,l,q,b,f,h){Object.defineProperty(d,"__esModule",{value:!0});z=function(d){function c(a){a=d.call(this,
a)||this;a.updateParameters();return a}t(c,d);c.prototype.updateParameters=function(){this.params=f.copyParameters(this.material.getParameters());this.technique=this.techniqueRep.acquireAndReleaseExisting(b.WaterTechnique,this.material.getTechniqueConfig(this.output),this.technique)};c.prototype.beginSlot=function(a){if(2===this.output)return 22===a;if(5===this.output)return null==a;var c=3;this.params.transparent&&(c=this.params.writeDepth?5:8);return a===c};c.prototype.setElapsedTimeUniform=function(a){a.setUniform1f("timeElapsed",
.001*this.material.animation.time*this.params.animationSpeed)};c.prototype._updateShadowState=function(a){a.shadowMappingEnabled!==this.params.receiveShadows&&(this.material.setParameterValues({receiveShadows:a.shadowMappingEnabled}),this.updateParameters())};c.prototype.ensureResources=function(a){h.waterTextureRepo.ready()||h.waterTextureRepo.loading()||h.waterTextureRepo.initialize(a);return h.waterTextureRepo.ready()?2:1};c.prototype.ensureParameters=function(a){0===this.output&&this._updateShadowState(a)};
c.prototype.bind=function(a,c){a.bindProgram(this.technique.program);this.technique.bindPass(a,this.params);if(2===this.output||0===this.output)h.waterTextureRepo.bindRepo(a),this.setElapsedTimeUniform(this.technique.program)};return c}(q.GLMaterial);d.WaterGLMaterial=z})},"esri/views/3d/webgl-engine/materials/WaterTechnique":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/tsSupport/assignHelper ../core/shaderLibrary/Slice.glsl ../core/shaderLibrary/Transform.glsl ../core/shaderLibrary/shading/ReadShadowMap.glsl ../core/shaderLibrary/shading/WaterDistortion.glsl ../core/shaderLibrary/util/Camera.glsl ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../core/shaderTechnique/ShaderTechniqueConfiguration ../lib/DefaultTextureUnits ../lib/DefaultVertexAttributeLocations ../shaders/WaterSurface.glsl ../../../webgl/Program ../../../webgl/renderState".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u,D,w,v,E,C){Object.defineProperty(d,"__esModule",{value:!0});q=function(d){function m(){return null!==d&&d.apply(this,arguments)||this}t(m,d);m.prototype.initializeProgram=function(a){var c=m.shader.get(),b=this.configuration,c=c.build({output:b.output,viewingMode:a.viewingMode,slicePlaneEnabled:b.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,receiveShadows:b.receiveShadows,pbrMode:3,useCustomDTRExponentForWater:!0});return new E(a.rctx,
c.generateSource("vertex"),c.generateSource("fragment"),w.Default3D)};m.prototype.bindPass=function(a,c){0!==this.configuration.output&&2!==this.configuration.output||r.WaterDistortion.bindUniforms(this.program,c);0!==this.configuration.output&&5!==this.configuration.output||this.program.setUniform4fv("waterColor",c.color)};m.prototype.bindDraw=function(a){f.Transform.bindUniforms(this.program,a);0===this.configuration.output&&(c.Camera.bindUniforms(this.program,a),b.Slice.bindUniformsWithOrigin(this.program,
this.configuration,a),h.ReadShadowMap.bindUniforms(this.program,a,D.DefaultTextureUnits.SHADOW_MAP))};m.prototype.initializePipeline=function(){var a=this.configuration;return 2===a.output?C.makePipelineState({depthTest:{func:513},depthWrite:a.writeDepth&&C.defaultDepthWriteParams,colorWrite:C.defaultColorWriteParams}):C.makePipelineState({blending:a.transparent&&C.separateBlendingParams(770,1,771,771),depthTest:{func:513},depthWrite:a.writeDepth&&C.defaultDepthWriteParams,colorWrite:C.defaultColorWriteParams})};
m.shader=new a.ReloadableShaderModule(v,"../shaders/WaterSurface.glsl",z);return m}(m.ShaderTechnique);d.WaterTechnique=q;q=function(a){function c(){var c=null!==a&&a.apply(this,arguments)||this;c.output=0;c.receiveShadows=!1;c.slicePlaneEnabled=!1;c.transparent=!1;c.writeDepth=!1;return c}t(c,a);l([u.parameter({count:7})],c.prototype,"output",void 0);l([u.parameter()],c.prototype,"receiveShadows",void 0);l([u.parameter()],c.prototype,"slicePlaneEnabled",void 0);l([u.parameter()],c.prototype,"transparent",
void 0);l([u.parameter()],c.prototype,"writeDepth",void 0);return c}(u.ShaderTechniqueConfiguration);d.WaterTechniqueConfiguration=q})},"esri/views/3d/webgl-engine/core/shaderLibrary/Slice.glsl":function(){define("require exports ../../../../../core/tsSupport/makeTemplateObjectHelper ../../../../../core/maybe ../../../../../core/libs/gl-matrix-2/vec3 ../../../../../core/libs/gl-matrix-2/vec3f64 ../shaderModules/interfaces".split(" "),function(z,d,t,l,q,b,f){function h(b,d){if(d.slicePlaneEnabled){b.extensions.add("GL_OES_standard_derivatives");
d.sliceEnabledForVertexPrograms&&(b.vertex.uniforms.add("slicePlaneOrigin","vec3"),b.vertex.uniforms.add("slicePlaneBasis1","vec3"),b.vertex.uniforms.add("slicePlaneBasis2","vec3"));b.fragment.uniforms.add("slicePlaneOrigin","vec3");b.fragment.uniforms.add("slicePlaneBasis1","vec3");b.fragment.uniforms.add("slicePlaneBasis2","vec3");var h=f.glsl(c||(c=t(["\n      struct SliceFactors {\n        float front;\n        float side0;\n        float side1;\n        float side2;\n        float side3;\n      };\n\n      SliceFactors calculateSliceFactors(vec3 pos) {\n        vec3 rel \x3d pos - slicePlaneOrigin;\n\n        vec3 slicePlaneNormal \x3d -cross(slicePlaneBasis1, slicePlaneBasis2);\n        float slicePlaneW \x3d -dot(slicePlaneNormal, slicePlaneOrigin);\n\n        float basis1Len2 \x3d dot(slicePlaneBasis1, slicePlaneBasis1);\n        float basis2Len2 \x3d dot(slicePlaneBasis2, slicePlaneBasis2);\n\n        float basis1Dot \x3d dot(slicePlaneBasis1, rel);\n        float basis2Dot \x3d dot(slicePlaneBasis2, rel);\n\n        return SliceFactors(\n          dot(slicePlaneNormal, pos) + slicePlaneW,\n          -basis1Dot - basis1Len2,\n          basis1Dot - basis1Len2,\n          -basis2Dot - basis2Len2,\n          basis2Dot - basis2Len2\n        );\n      }\n\n      bool sliceByFactors(SliceFactors factors) {\n        return factors.front \x3c 0.0\n          \x26\x26 factors.side0 \x3c 0.0\n          \x26\x26 factors.side1 \x3c 0.0\n          \x26\x26 factors.side2 \x3c 0.0\n          \x26\x26 factors.side3 \x3c 0.0;\n      }\n      \n      bool sliceEnabled() {\n        // a slicePlaneBasis1 vector of zero length is used to disable slicing in the shader during draped rendering.\n        return dot(slicePlaneBasis1, slicePlaneBasis1) !\x3d 0.0;\n      }\n\n      bool sliceByPlane(vec3 pos) {\n        return sliceEnabled() \x26\x26 sliceByFactors(calculateSliceFactors(pos));\n      }\n\n      #define rejectBySlice(_pos_) sliceByPlane(_pos_)\n      #define discardBySlice(_pos_) { if (sliceByPlane(_pos_)) discard; }\n    "],
["\n      struct SliceFactors {\n        float front;\n        float side0;\n        float side1;\n        float side2;\n        float side3;\n      };\n\n      SliceFactors calculateSliceFactors(vec3 pos) {\n        vec3 rel \x3d pos - slicePlaneOrigin;\n\n        vec3 slicePlaneNormal \x3d -cross(slicePlaneBasis1, slicePlaneBasis2);\n        float slicePlaneW \x3d -dot(slicePlaneNormal, slicePlaneOrigin);\n\n        float basis1Len2 \x3d dot(slicePlaneBasis1, slicePlaneBasis1);\n        float basis2Len2 \x3d dot(slicePlaneBasis2, slicePlaneBasis2);\n\n        float basis1Dot \x3d dot(slicePlaneBasis1, rel);\n        float basis2Dot \x3d dot(slicePlaneBasis2, rel);\n\n        return SliceFactors(\n          dot(slicePlaneNormal, pos) + slicePlaneW,\n          -basis1Dot - basis1Len2,\n          basis1Dot - basis1Len2,\n          -basis2Dot - basis2Len2,\n          basis2Dot - basis2Len2\n        );\n      }\n\n      bool sliceByFactors(SliceFactors factors) {\n        return factors.front \x3c 0.0\n          \x26\x26 factors.side0 \x3c 0.0\n          \x26\x26 factors.side1 \x3c 0.0\n          \x26\x26 factors.side2 \x3c 0.0\n          \x26\x26 factors.side3 \x3c 0.0;\n      }\n      \n      bool sliceEnabled() {\n        // a slicePlaneBasis1 vector of zero length is used to disable slicing in the shader during draped rendering.\n        return dot(slicePlaneBasis1, slicePlaneBasis1) !\x3d 0.0;\n      }\n\n      bool sliceByPlane(vec3 pos) {\n        return sliceEnabled() \x26\x26 sliceByFactors(calculateSliceFactors(pos));\n      }\n\n      #define rejectBySlice(_pos_) sliceByPlane(_pos_)\n      #define discardBySlice(_pos_) { if (sliceByPlane(_pos_)) discard; }\n    "]))),
l=f.glsl(a||(a=t(["\n      vec4 applySliceHighlight(vec4 color, vec3 pos) {\n        SliceFactors factors \x3d calculateSliceFactors(pos);\n\n        if (sliceByFactors(factors)) {\n          return color;\n        }\n\n        const float HIGHLIGHT_WIDTH \x3d 1.0;\n        const vec4 HIGHLIGHT_COLOR \x3d vec4(0.0, 0.0, 0.0, 0.3);\n\n        factors.front /\x3d (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.front);\n        factors.side0 /\x3d (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side0);\n        factors.side1 /\x3d (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side1);\n        factors.side2 /\x3d (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side2);\n        factors.side3 /\x3d (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side3);\n\n        float highlightFactor \x3d (1.0 - step(0.5, factors.front))\n          * (1.0 - step(0.5, factors.side0))\n          * (1.0 - step(0.5, factors.side1))\n          * (1.0 - step(0.5, factors.side2))\n          * (1.0 - step(0.5, factors.side3));\n\n        return mix(color, vec4(HIGHLIGHT_COLOR.rgb, color.a), highlightFactor * HIGHLIGHT_COLOR.a);\n      }\n    "],
["\n      vec4 applySliceHighlight(vec4 color, vec3 pos) {\n        SliceFactors factors \x3d calculateSliceFactors(pos);\n\n        if (sliceByFactors(factors)) {\n          return color;\n        }\n\n        const float HIGHLIGHT_WIDTH \x3d 1.0;\n        const vec4 HIGHLIGHT_COLOR \x3d vec4(0.0, 0.0, 0.0, 0.3);\n\n        factors.front /\x3d (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.front);\n        factors.side0 /\x3d (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side0);\n        factors.side1 /\x3d (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side1);\n        factors.side2 /\x3d (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side2);\n        factors.side3 /\x3d (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side3);\n\n        float highlightFactor \x3d (1.0 - step(0.5, factors.front))\n          * (1.0 - step(0.5, factors.side0))\n          * (1.0 - step(0.5, factors.side1))\n          * (1.0 - step(0.5, factors.side2))\n          * (1.0 - step(0.5, factors.side3));\n\n        return mix(color, vec4(HIGHLIGHT_COLOR.rgb, color.a), highlightFactor * HIGHLIGHT_COLOR.a);\n      }\n    "]))),
l=d.sliceHighlightDisabled?f.glsl(m||(m=t(["#define highlightSlice(_color_, _pos_) (_color_)"],["#define highlightSlice(_color_, _pos_) (_color_)"]))):f.glsl(u||(u=t(["\n        "," \n        #define highlightSlice(_color_, _pos_) (sliceEnabled() ? applySliceHighlight(_color_, _pos_) : (_color_))\n      "],["\n        "," \n        #define highlightSlice(_color_, _pos_) (sliceEnabled() ? applySliceHighlight(_color_, _pos_) : (_color_))\n      "])),l);d.sliceEnabledForVertexPrograms&&b.vertex.code.add(h);
b.fragment.code.add(h);b.fragment.code.add(l)}else h=f.glsl(D||(D=t(["\n      #define rejectBySlice(_pos_) false\n      #define discardBySlice(_pos_) {}\n      #define highlightSlice(_color_, _pos_) (_color_)\n    "],["\n      #define rejectBySlice(_pos_) false\n      #define discardBySlice(_pos_) {}\n      #define highlightSlice(_color_, _pos_) (_color_)\n    "]))),d.sliceEnabledForVertexPrograms&&b.vertex.code.add(h),b.fragment.code.add(h)}Object.defineProperty(d,"__esModule",{value:!0});d.Slice=
h;(function(a){a.bindUniformsWithOrigin=function(c,b,d){a.bindUniforms(c,b,d.slicePlane,d.origin)};a.bindUniforms=function(a,c,d,f){c.slicePlaneEnabled&&(l.isSome(d)?(f?(q.vec3.subtract(r,d.origin,f),a.setUniform3fv("slicePlaneOrigin",r)):a.setUniform3fv("slicePlaneOrigin",d.origin),a.setUniform3fv("slicePlaneBasis1",d.basis1),a.setUniform3fv("slicePlaneBasis2",d.basis2)):(a.setUniform3fv("slicePlaneBasis1",b.vec3f64.ZEROS),a.setUniform3fv("slicePlaneBasis2",b.vec3f64.ZEROS),a.setUniform3fv("slicePlaneOrigin",
b.vec3f64.ZEROS)))}})(h=d.Slice||(d.Slice={}));var r=b.vec3f64.create(),c,a,m,u,D})},"esri/core/tsSupport/makeTemplateObjectHelper":function(){define([],function(){return function(z,d){if(Object.defineProperty)return Object.defineProperty(z,"raw",{value:d});z.raw=d;return z}})},"esri/views/3d/webgl-engine/core/shaderModules/interfaces":function(){define(["require","exports"],function(z,d){function t(d){for(var l=[],b=1;b<arguments.length;b++)l[b-1]=arguments[b];for(var b="",f=0;f<l.length;f++)b+=
d[f]+l[f];return b+=d[d.length-1]}Object.defineProperty(d,"__esModule",{value:!0});d.glsl=t;(function(d){d.int=function(d){return Math.round(d).toString()};d.float=function(d){return d.toPrecision(8)}})(t=d.glsl||(d.glsl={}))})},"esri/views/3d/webgl-engine/core/shaderLibrary/Transform.glsl":function(){define("require exports ../../../../../core/tsSupport/makeTemplateObjectHelper ../../../../../core/libs/gl-matrix-2/mat4 ../../../../../core/libs/gl-matrix-2/mat4f32 ../shaderModules/interfaces".split(" "),
function(z,d,t,l,q,b){function f(a,d){d.linearDepth?a.vertex.code.add(b.glsl(r||(r=t(["\n    vec4 transformPositionWithDepth(mat4 proj, mat4 view, vec3 pos, vec2 nearFar, out float depth) {\n      vec4 eye \x3d view * vec4(pos, 1.0);\n      depth \x3d (-eye.z - nearFar[0]) / (nearFar[1] - nearFar[0]) ;\n      return proj * eye;\n    }\n    "],["\n    vec4 transformPositionWithDepth(mat4 proj, mat4 view, vec3 pos, vec2 nearFar, out float depth) {\n      vec4 eye \x3d view * vec4(pos, 1.0);\n      depth \x3d (-eye.z - nearFar[0]) / (nearFar[1] - nearFar[0]) ;\n      return proj * eye;\n    }\n    "])))):
a.vertex.code.add(b.glsl(c||(c=t(["\n    vec4 transformPosition(mat4 proj, mat4 view, vec3 pos) {\n      // Make sure the order of operations is the same as in transformPositionWithDepth.\n      return proj * (view * vec4(pos, 1.0));\n    }\n    "],["\n    vec4 transformPosition(mat4 proj, mat4 view, vec3 pos) {\n      // Make sure the order of operations is the same as in transformPositionWithDepth.\n      return proj * (view * vec4(pos, 1.0));\n    }\n    "]))))}Object.defineProperty(d,"__esModule",
{value:!0});d.Transform=f;(function(a){function c(a,c,b){l.mat4.translate(h,b,c);a.setUniform3fv("localOrigin",c);a.setUniformMatrix4fv("view",h)}a.bindUniformsCustomOrigin=c;a.bindUniforms=function(a,b){c(a,b.origin,b.view)}})(f=d.Transform||(d.Transform={}));var h=q.mat4f32.create(),r,c})},"esri/core/libs/gl-matrix-2/mat4f32":function(){define(["require","exports","./factories/mat4f32"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});d.mat4f32=t})},"esri/core/libs/gl-matrix-2/factories/mat4f32":function(){define(["require",
"exports"],function(z,d){function t(){var d=new Float32Array(16);d[0]=1;d[5]=1;d[10]=1;d[15]=1;return d}Object.defineProperty(d,"__esModule",{value:!0});d.create=t;d.clone=function(d){var l=new Float32Array(16);l[0]=d[0];l[1]=d[1];l[2]=d[2];l[3]=d[3];l[4]=d[4];l[5]=d[5];l[6]=d[6];l[7]=d[7];l[8]=d[8];l[9]=d[9];l[10]=d[10];l[11]=d[11];l[12]=d[12];l[13]=d[13];l[14]=d[14];l[15]=d[15];return l};d.fromValues=function(d,q,b,f,h,r,c,a,m,u,t,w,v,E,C,J){var l=new Float32Array(16);l[0]=d;l[1]=q;l[2]=b;l[3]=
f;l[4]=h;l[5]=r;l[6]=c;l[7]=a;l[8]=m;l[9]=u;l[10]=t;l[11]=w;l[12]=v;l[13]=E;l[14]=C;l[15]=J;return l};d.createView=function(d,q){return new Float32Array(d,q,16)};d.IDENTITY=t()})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/ReadShadowMap.glsl":function(){define(["require","exports","../../../../../../core/tsSupport/makeTemplateObjectHelper","../util/RgbaFloatEncoding.glsl","../../shaderModules/interfaces"],function(z,d,t,l,q){function b(b){b.include(l.RgbaFloatEncoding);b.fragment.uniforms.add("depthTex",
"sampler2D");b.fragment.uniforms.add("shadowMapNum","int");b.fragment.uniforms.add("shadowMapDistance","vec4");b.fragment.uniforms.add("shadowMapMatrix","mat4",4);b.fragment.uniforms.add("depthHalfPixelSz","float");b.fragment.code.add(q.glsl(f||(f=t(["\n    float readShadowMap(const in vec3 _vpos, float _linearDepth) {\n      float halfPixelSize \x3d depthHalfPixelSz;\n      vec4 distance \x3d shadowMapDistance;\n      float depth \x3d _linearDepth;\n\n      //choose correct cascade\n      int i \x3d depth \x3c distance[1] ? 0 : depth \x3c distance[2] ? 1 : depth \x3c distance[3] ? 2 : 3;\n\n      if (i \x3e\x3d shadowMapNum) { return 0.0; }\n\n      mat4 mat \x3d i \x3d\x3d 0 ? shadowMapMatrix[0] : i \x3d\x3d 1 ? shadowMapMatrix[1] : i \x3d\x3d 2 ? shadowMapMatrix[2] : shadowMapMatrix[3];\n\n      vec4 lv \x3d mat * vec4(_vpos, 1.0);\n      lv.xy /\x3d lv.w;\n\n      // vertex completely outside? -\x3e no shadow\n      vec3 lvpos \x3d 0.5 * lv.xyz + vec3(0.5);\n      if (lvpos.z \x3e\x3d 1.0) { return 0.0; }\n      if (lvpos.x \x3c 0.0 || lvpos.x \x3e 1.0 || lvpos.y \x3c 0.0 || lvpos.y \x3e 1.0) { return 0.0; }\n\n      // calc coord in cascade texture\n      vec2 uv \x3d vec2(float(i - 2 * (i / 2)) * 0.5, float(i / 2) * 0.5) + 0.5 * lvpos.xy;\n\n      float texSize \x3d 0.5 / halfPixelSize;\n\n      // filter, offset by half pixels\n      vec2 st \x3d fract((vec2(halfPixelSize) + uv) * texSize);\n\n      float s00 \x3d rgba2float(texture2D(depthTex, uv + vec2(-halfPixelSize, -halfPixelSize))) \x3c lvpos.z ? 1.0 : 0.0;\n      float s10 \x3d rgba2float(texture2D(depthTex, uv + vec2(halfPixelSize, -halfPixelSize))) \x3c lvpos.z ? 1.0 : 0.0;\n      float s11 \x3d rgba2float(texture2D(depthTex, uv + vec2(halfPixelSize, halfPixelSize))) \x3c lvpos.z ? 1.0 : 0.0;\n      float s01 \x3d rgba2float(texture2D(depthTex, uv + vec2(-halfPixelSize, halfPixelSize))) \x3c lvpos.z ? 1.0 : 0.0;\n\n      return mix(mix(s00, s10, st.x), mix(s01, s11, st.x), st.y);\n    }\n  "],
["\n    float readShadowMap(const in vec3 _vpos, float _linearDepth) {\n      float halfPixelSize \x3d depthHalfPixelSz;\n      vec4 distance \x3d shadowMapDistance;\n      float depth \x3d _linearDepth;\n\n      //choose correct cascade\n      int i \x3d depth \x3c distance[1] ? 0 : depth \x3c distance[2] ? 1 : depth \x3c distance[3] ? 2 : 3;\n\n      if (i \x3e\x3d shadowMapNum) { return 0.0; }\n\n      mat4 mat \x3d i \x3d\x3d 0 ? shadowMapMatrix[0] : i \x3d\x3d 1 ? shadowMapMatrix[1] : i \x3d\x3d 2 ? shadowMapMatrix[2] : shadowMapMatrix[3];\n\n      vec4 lv \x3d mat * vec4(_vpos, 1.0);\n      lv.xy /\x3d lv.w;\n\n      // vertex completely outside? -\x3e no shadow\n      vec3 lvpos \x3d 0.5 * lv.xyz + vec3(0.5);\n      if (lvpos.z \x3e\x3d 1.0) { return 0.0; }\n      if (lvpos.x \x3c 0.0 || lvpos.x \x3e 1.0 || lvpos.y \x3c 0.0 || lvpos.y \x3e 1.0) { return 0.0; }\n\n      // calc coord in cascade texture\n      vec2 uv \x3d vec2(float(i - 2 * (i / 2)) * 0.5, float(i / 2) * 0.5) + 0.5 * lvpos.xy;\n\n      float texSize \x3d 0.5 / halfPixelSize;\n\n      // filter, offset by half pixels\n      vec2 st \x3d fract((vec2(halfPixelSize) + uv) * texSize);\n\n      float s00 \x3d rgba2float(texture2D(depthTex, uv + vec2(-halfPixelSize, -halfPixelSize))) \x3c lvpos.z ? 1.0 : 0.0;\n      float s10 \x3d rgba2float(texture2D(depthTex, uv + vec2(halfPixelSize, -halfPixelSize))) \x3c lvpos.z ? 1.0 : 0.0;\n      float s11 \x3d rgba2float(texture2D(depthTex, uv + vec2(halfPixelSize, halfPixelSize))) \x3c lvpos.z ? 1.0 : 0.0;\n      float s01 \x3d rgba2float(texture2D(depthTex, uv + vec2(-halfPixelSize, halfPixelSize))) \x3c lvpos.z ? 1.0 : 0.0;\n\n      return mix(mix(s00, s10, st.x), mix(s01, s11, st.x), st.y);\n    }\n  "]))))}
Object.defineProperty(d,"__esModule",{value:!0});d.ReadShadowMap=b;(function(b){b.bindUniforms=function(b,c,a){c.shadowMappingEnabled&&(c.shadowMap.bind(b,a),c.shadowMap.bindView(b,c.origin))};b.bindViewCustomOrigin=function(b,c,a){c.shadowMappingEnabled&&c.shadowMap.bindView(b,a)};b.bindView=function(b,c){c.shadowMappingEnabled&&c.shadowMap.bindView(b,c.origin)}})(b=d.ReadShadowMap||(d.ReadShadowMap={}));var f})},"esri/views/3d/webgl-engine/core/shaderLibrary/util/RgbaFloatEncoding.glsl":function(){define(["require",
"exports","../../../../../../core/tsSupport/makeTemplateObjectHelper","../../shaderModules/interfaces"],function(z,d,t,l){Object.defineProperty(d,"__esModule",{value:!0});d.RgbaFloatEncoding=function(b){var d=l.glsl(q||(q=t(["\n    // This is the maximum float value representable as 32bit fixed point,\n    // it is rgba2float(vec4(1)) inlined.\n    const float MAX_RGBA_FLOAT \x3d\n      255.0 / 256.0 +\n      255.0 / 256.0 / 256.0 +\n      255.0 / 256.0 / 256.0 / 256.0 +\n      255.0 / 256.0 / 256.0 / 256.0 / 256.0;\n\n    // Factors to convert to fixed point, i.e. factors (256^0, 256^1, 256^2, 256^3)\n    const vec4 FIXED_POINT_FACTORS \x3d vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);\n\n    vec4 float2rgba(const float value) {\n      // Make sure value is in the domain we can represent\n      float valueInValidDomain \x3d clamp(value, 0.0, MAX_RGBA_FLOAT);\n\n      // Decompose value in 32bit fixed point parts represented as\n      // uint8 rgba components. Decomposition uses the fractional part after multiplying\n      // by a power of 256 (this removes the bits that are represented in the previous\n      // component) and then converts the fractional part to 8bits.\n      vec4 fixedPointU8 \x3d floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);\n\n      // Convert uint8 values (from 0 to 255) to floating point representation for\n      // the shader\n      const float toU8AsFloat \x3d 1.0 / 255.0;\n\n      return fixedPointU8 * toU8AsFloat;\n    }\n\n    // Factors to convert rgba back to float\n    const vec4 RGBA_2_FLOAT_FACTORS \x3d vec4(\n      255.0 / (256.0),\n      255.0 / (256.0 * 256.0),\n      255.0 / (256.0 * 256.0 * 256.0),\n      255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n    );\n\n    float rgba2float(vec4 rgba) {\n      // Convert components from 0-\x3e1 back to 0-\x3e255 and then\n      // add the components together with their corresponding\n      // fixed point factors, i.e. (256^1, 256^2, 256^3, 256^4)\n      return dot(rgba, RGBA_2_FLOAT_FACTORS);\n    }\n  "],
["\n    // This is the maximum float value representable as 32bit fixed point,\n    // it is rgba2float(vec4(1)) inlined.\n    const float MAX_RGBA_FLOAT \x3d\n      255.0 / 256.0 +\n      255.0 / 256.0 / 256.0 +\n      255.0 / 256.0 / 256.0 / 256.0 +\n      255.0 / 256.0 / 256.0 / 256.0 / 256.0;\n\n    // Factors to convert to fixed point, i.e. factors (256^0, 256^1, 256^2, 256^3)\n    const vec4 FIXED_POINT_FACTORS \x3d vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);\n\n    vec4 float2rgba(const float value) {\n      // Make sure value is in the domain we can represent\n      float valueInValidDomain \x3d clamp(value, 0.0, MAX_RGBA_FLOAT);\n\n      // Decompose value in 32bit fixed point parts represented as\n      // uint8 rgba components. Decomposition uses the fractional part after multiplying\n      // by a power of 256 (this removes the bits that are represented in the previous\n      // component) and then converts the fractional part to 8bits.\n      vec4 fixedPointU8 \x3d floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);\n\n      // Convert uint8 values (from 0 to 255) to floating point representation for\n      // the shader\n      const float toU8AsFloat \x3d 1.0 / 255.0;\n\n      return fixedPointU8 * toU8AsFloat;\n    }\n\n    // Factors to convert rgba back to float\n    const vec4 RGBA_2_FLOAT_FACTORS \x3d vec4(\n      255.0 / (256.0),\n      255.0 / (256.0 * 256.0),\n      255.0 / (256.0 * 256.0 * 256.0),\n      255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n    );\n\n    float rgba2float(vec4 rgba) {\n      // Convert components from 0-\x3e1 back to 0-\x3e255 and then\n      // add the components together with their corresponding\n      // fixed point factors, i.e. (256^1, 256^2, 256^3, 256^4)\n      return dot(rgba, RGBA_2_FLOAT_FACTORS);\n    }\n  "])));
b.fragment.code.add(d);b.vertex.code.add(d)};var q})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/WaterDistortion.glsl":function(){define(["require","exports","../../../../../../core/tsSupport/makeTemplateObjectHelper","../../shaderModules/interfaces"],function(z,d,t,l){function q(d){d.fragment.uniforms.add("texWaveNormal","sampler2D");d.fragment.uniforms.add("texWavePerturbation","sampler2D");d.fragment.uniforms.add("waveParams","vec4");d.fragment.uniforms.add("waveDirection","vec2");
d.fragment.code.add(l.glsl(b||(b=t(["\n      const vec2  FLOW_JUMP \x3d vec2(6.0/25.0, 5.0/24.0);\n\n      vec2 textureDenormalized2D(sampler2D _tex, vec2 _uv) {\n        return 2.0 * texture2D(_tex, _uv).rg - 1.0;\n      }\n\n      float sampleNoiseTexture(vec2 _uv) {\n        return texture2D(texWavePerturbation, _uv).b;\n      }\n\n      vec3 textureDenormalized3D(sampler2D _tex, vec2 _uv) {\n        return 2.0 * texture2D(_tex, _uv).rgb - 1.0;\n      }\n\n      float computeProgress(vec2 uv, float time) {\n        return fract(time);\n      }\n\n      float computeWeight(vec2 uv, float time) {\n        float progress \x3d computeProgress(uv, time);\n        return 1.0 - abs(1.0 - 2.0 * progress);\n      }\n\n      vec3 computeUVPerturbedWeigth(sampler2D texFlow, vec2 uv, float time, float phaseOffset) {\n        float flowStrength \x3d waveParams[2];\n        float flowOffset \x3d waveParams[3];\n\n        vec2 flowVector \x3d textureDenormalized2D(texFlow, uv) * flowStrength;\n\n        float progress \x3d computeProgress(uv, time + phaseOffset);\n        float weight \x3d computeWeight(uv, time + phaseOffset);\n\n        vec2 result \x3d uv;\n        result -\x3d flowVector * (progress + flowOffset);\n        result +\x3d phaseOffset;\n        result +\x3d (time - progress) * FLOW_JUMP;\n\n        return vec3(result, weight);\n      }\n\n      const float TIME_NOISE_TEXTURE_REPEAT \x3d 0.3737;\n      const float TIME_NOISE_STRENGTH \x3d 7.77;\n\n      vec3 getWaveLayer(sampler2D _texNormal, sampler2D _dudv, vec2 _uv, vec2 _waveDir, float time) {\n        float waveStrength \x3d waveParams[0];\n\n        // overall directional shift in uv's for directional wave movement for\n        // now we do a hard coded scale for wave speed such that a unit length\n        // direction is not too fast.\n        vec2 waveMovement \x3d time * -_waveDir;\n\n        float timeNoise \x3d sampleNoiseTexture(_uv * TIME_NOISE_TEXTURE_REPEAT) * TIME_NOISE_STRENGTH;\n\n        // compute two perturbed uvs and blend weights\n        // then sample the wave normals at the two positions and blend\n        vec3 uv_A \x3d computeUVPerturbedWeigth(_dudv, _uv + waveMovement, time + timeNoise, 0.0);\n        vec3 uv_B \x3d computeUVPerturbedWeigth(_dudv, _uv + waveMovement, time + timeNoise, 0.5);\n\n        vec3 normal_A \x3d textureDenormalized3D(_texNormal, uv_A.xy) * uv_A.z;\n        vec3 normal_B \x3d textureDenormalized3D(_texNormal, uv_B.xy) * uv_B.z;\n\n        // logic to flatten the wave pattern\n        // scale xy components of the normal, then adjust z (up) component\n        vec3 mixNormal \x3d normalize(normal_A + normal_B);\n        mixNormal.xy *\x3d waveStrength;\n        mixNormal.z \x3d sqrt(1.0 - dot(mixNormal.xy, mixNormal.xy));\n\n        return mixNormal;\n      }\n\n      vec3 getSurfaceNormal(vec2 _uv, float _time) {\n        float waveTextureRepeat \x3d waveParams[1];\n        return getWaveLayer(texWaveNormal, texWavePerturbation, _uv * waveTextureRepeat, waveDirection, _time);\n      }\n    "],
["\n      const vec2  FLOW_JUMP \x3d vec2(6.0/25.0, 5.0/24.0);\n\n      vec2 textureDenormalized2D(sampler2D _tex, vec2 _uv) {\n        return 2.0 * texture2D(_tex, _uv).rg - 1.0;\n      }\n\n      float sampleNoiseTexture(vec2 _uv) {\n        return texture2D(texWavePerturbation, _uv).b;\n      }\n\n      vec3 textureDenormalized3D(sampler2D _tex, vec2 _uv) {\n        return 2.0 * texture2D(_tex, _uv).rgb - 1.0;\n      }\n\n      float computeProgress(vec2 uv, float time) {\n        return fract(time);\n      }\n\n      float computeWeight(vec2 uv, float time) {\n        float progress \x3d computeProgress(uv, time);\n        return 1.0 - abs(1.0 - 2.0 * progress);\n      }\n\n      vec3 computeUVPerturbedWeigth(sampler2D texFlow, vec2 uv, float time, float phaseOffset) {\n        float flowStrength \x3d waveParams[2];\n        float flowOffset \x3d waveParams[3];\n\n        vec2 flowVector \x3d textureDenormalized2D(texFlow, uv) * flowStrength;\n\n        float progress \x3d computeProgress(uv, time + phaseOffset);\n        float weight \x3d computeWeight(uv, time + phaseOffset);\n\n        vec2 result \x3d uv;\n        result -\x3d flowVector * (progress + flowOffset);\n        result +\x3d phaseOffset;\n        result +\x3d (time - progress) * FLOW_JUMP;\n\n        return vec3(result, weight);\n      }\n\n      const float TIME_NOISE_TEXTURE_REPEAT \x3d 0.3737;\n      const float TIME_NOISE_STRENGTH \x3d 7.77;\n\n      vec3 getWaveLayer(sampler2D _texNormal, sampler2D _dudv, vec2 _uv, vec2 _waveDir, float time) {\n        float waveStrength \x3d waveParams[0];\n\n        // overall directional shift in uv's for directional wave movement for\n        // now we do a hard coded scale for wave speed such that a unit length\n        // direction is not too fast.\n        vec2 waveMovement \x3d time * -_waveDir;\n\n        float timeNoise \x3d sampleNoiseTexture(_uv * TIME_NOISE_TEXTURE_REPEAT) * TIME_NOISE_STRENGTH;\n\n        // compute two perturbed uvs and blend weights\n        // then sample the wave normals at the two positions and blend\n        vec3 uv_A \x3d computeUVPerturbedWeigth(_dudv, _uv + waveMovement, time + timeNoise, 0.0);\n        vec3 uv_B \x3d computeUVPerturbedWeigth(_dudv, _uv + waveMovement, time + timeNoise, 0.5);\n\n        vec3 normal_A \x3d textureDenormalized3D(_texNormal, uv_A.xy) * uv_A.z;\n        vec3 normal_B \x3d textureDenormalized3D(_texNormal, uv_B.xy) * uv_B.z;\n\n        // logic to flatten the wave pattern\n        // scale xy components of the normal, then adjust z (up) component\n        vec3 mixNormal \x3d normalize(normal_A + normal_B);\n        mixNormal.xy *\x3d waveStrength;\n        mixNormal.z \x3d sqrt(1.0 - dot(mixNormal.xy, mixNormal.xy));\n\n        return mixNormal;\n      }\n\n      vec3 getSurfaceNormal(vec2 _uv, float _time) {\n        float waveTextureRepeat \x3d waveParams[1];\n        return getWaveLayer(texWaveNormal, texWavePerturbation, _uv * waveTextureRepeat, waveDirection, _time);\n      }\n    "]))))}
Object.defineProperty(d,"__esModule",{value:!0});d.WaterDistortion=q;(function(b){b.bindUniforms=function(b,d){b.setUniform1i("texWaveNormal",0);b.setUniform1i("texWavePerturbation",1);b.setUniform4f("waveParams",d.waveStrength,d.waveTextureRepeat,d.flowStrength,d.flowOffset);b.setUniform2f("waveDirection",d.waveDirection[0]*d.waveVelocity,d.waveDirection[1]*d.waveVelocity)}})(q=d.WaterDistortion||(d.WaterDistortion={}));var b})},"esri/views/3d/webgl-engine/core/shaderLibrary/util/Camera.glsl":function(){define(["require",
"exports"],function(z,d){Object.defineProperty(d,"__esModule",{value:!0});(function(d){function l(d,b,f){d.setUniform3f("camPos",f[3]-b[0],f[7]-b[1],f[11]-b[2])}d.bindUniformsCustomOrigin=l;d.bindUniforms=function(d,b){l(d,b.origin,b.viewInvTransp)}})(d.Camera||(d.Camera={}));(function(d){d.bindUniforms=function(d,q){d.setUniform1f("pixelRatio",q.pixelRatio||1);d.setUniform4fv("viewport",q.viewport)}})(d.Viewport||(d.Viewport={}))})},"esri/views/3d/webgl-engine/core/shaderTechnique/ReloadableShaderModule":function(){define(["require",
"exports","../../../../../core/promiseUtils"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});z=function(){function d(d,b,f){this._relativePath=b;this._moduleRequire=f;this._module=d}d.prototype.get=function(){return this._module};d.prototype.reload=function(){var d=this,b=this._moduleRequire.toUrl(this._relativePath),b=b.slice(b.indexOf("esri/"));this._recursivelyInvalidateModuleCache(b);return t.create(function(b){d._moduleRequire([d._relativePath],function(f){d._module=f;b()})})};
d.prototype._recursivelyInvalidateModuleCache=function(d){if(-1!==d.search("shader")||-1!==d.search("shading")){var b=this._moduleRequire.modules,f=b[d];if(f)for(f=f.deps,delete b[d],d=0;d<f.length;d++)b=f[d],"esri"===b.pid&&this._recursivelyInvalidateModuleCache(b.mid)}};return d}();d.ReloadableShaderModule=z})},"esri/views/3d/webgl-engine/core/shaderTechnique/ShaderTechnique":function(){define(["require","exports"],function(z,d){Object.defineProperty(d,"__esModule",{value:!0});z=function(){function d(d,
q){if(q){var b=q.__proto__.__configurationParameters||[],f={};f.key=q.key;for(var h=0;h<b.length;h++){var l=b[h];f[l]=q[l]}this._config=f}this._program=this.initializeProgram(d);d.commonUniformStore&&(this._commonUniformStore=d.commonUniformStore,this._commonUniformStore.subscribeProgram(this._program));this._pipeline=this.initializePipeline(d)}d.prototype.dispose=function(){this._program&&(this._commonUniformStore&&this._commonUniformStore.unsubscribeProgram(this._program),this._program.dispose(),
this._program=null)};d.prototype.reload=function(d){this._program&&(this._commonUniformStore&&this._commonUniformStore.unsubscribeProgram(this._program),this._program.dispose());this._program=this.initializeProgram(d);this._commonUniformStore&&this._commonUniformStore.subscribeProgram(this._program)};Object.defineProperty(d.prototype,"program",{get:function(){return this._program},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"pipeline",{get:function(){return this._pipeline},enumerable:!0,
configurable:!0});Object.defineProperty(d.prototype,"key",{get:function(){return this._config.key},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"configuration",{get:function(){return this._config},enumerable:!0,configurable:!0});d.prototype.bindPass=function(d,q,b){};d.prototype.bindMaterial=function(d,q,b){};d.prototype.bindDraw=function(d,q,b){};d.prototype.bindInstance=function(d){};d.prototype.bindPipelineState=function(d){d.setPipelineState(this.pipeline)};d.prototype.ensureAttributeLocations=
function(d){this.program.assertCompatibleVertexAttributeLocations(d)};Object.defineProperty(d.prototype,"primitiveType",{get:function(){return 4},enumerable:!0,configurable:!0});return d}();d.ShaderTechnique=z})},"esri/views/3d/webgl-engine/core/shaderTechnique/ShaderTechniqueConfiguration":function(){define(["require","exports","../../../../../core/mathUtils"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});z=function(){return function(){this.key=0}}();d.ShaderTechniqueConfiguration=
z;d.parameter=function(d){void 0===d&&(d={});return function(l,b){l.__configurationParameters=l.__configurationParameters||[];l.__configurationParameters.push(b);var f="_"+b;void 0===l.__configurationParameters__offset&&(l.__configurationParameters__offset=0);var h=l.__configurationParameters__offset,r=Math.ceil(t.log2(d.count||2)),c=(1<<r)-1<<h;l.__configurationParameters__offset+=r;if(32<=l.__configurationParameters__offset)throw Error("ShaderTechniqueConfiguration is too complex, requiring more than 32 bits to encode.\n      Either the configuration must be simplified, or this restriction must be relaxed.(Currently used: "+
l.__configurationParameters__offset+")");Object.defineProperty(l,b,{get:function(){return this[f]},set:function(a){this.key=this.key&~c|a<<h&c;this[f]=a}})}}})},"esri/views/3d/webgl-engine/lib/DefaultTextureUnits":function(){define(["require","exports"],function(z,d){Object.defineProperty(d,"__esModule",{value:!0});d.DefaultTextureUnits={DIFFUSE:0,NORMAL:1,EMISSION:2,OCCLUSION:3,METALLIC_ROUGHNESS:4,SSAO:6,SHADOW_MAP:7}})},"esri/views/3d/webgl-engine/shaders/WaterSurface.glsl":function(){define("require exports ../../../../core/tsSupport/makeTemplateObjectHelper ../core/shaderLibrary/ForwardLinearDepth.glsl ../core/shaderLibrary/Slice.glsl ../core/shaderLibrary/Transform.glsl ../core/shaderLibrary/shading/NormalUtils.glsl ../core/shaderLibrary/shading/ReadShadowMap.glsl ../core/shaderLibrary/shading/Water.glsl ../core/shaderLibrary/shading/WaterDistortion.glsl ../core/shaderModules/interfaces ../core/shaderModules/ShaderBuilder".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m){Object.defineProperty(d,"__esModule",{value:!0});d.build=function(d){var x=new m.ShaderBuilder;x.include(b.Transform,{linearDepth:!1});x.attributes.add("position","vec3");x.attributes.add("uv0","vec2");x.vertex.uniforms.add("proj","mat4").add("view","mat4").add("model","mat4").add("localOrigin","vec3");0===d.output&&(x.include(f.NormalUtils,d),x.include(l.ForwardLinearDepth,d),x.varyings.add("vuv","vec2"),x.varyings.add("vpos","vec3"),x.varyings.add("vnormal","vec3"),
x.varyings.add("vtbnMatrix","mat3"),x.vertex.code.add(a.glsl(u||(u=t(["\n      void main(void) {\n        vuv \x3d uv0;\n        vpos \x3d (model * vec4(position, 1.0)).xyz;\n\n        vnormal \x3d getLocalUp(vpos, localOrigin);\n        vtbnMatrix \x3d getTBNMatrix(vnormal);\n\n        gl_Position \x3d transformPosition(proj, view, vpos);\n        forwardLinearDepth();\n      }\n    "],["\n      void main(void) {\n        vuv \x3d uv0;\n        vpos \x3d (model * vec4(position, 1.0)).xyz;\n\n        vnormal \x3d getLocalUp(vpos, localOrigin);\n        vtbnMatrix \x3d getTBNMatrix(vnormal);\n\n        gl_Position \x3d transformPosition(proj, view, vpos);\n        forwardLinearDepth();\n      }\n    "])))),
x.include(c.WaterDistortion,d),x.include(q.Slice,d),d.receiveShadows&&x.include(h.ReadShadowMap,d),x.include(r.Water,d),x.fragment.uniforms.add("waterColor","vec4").add("lightingMainDirection","vec3").add("lightingMainIntensity","vec3").add("camPos","vec3").add("timeElapsed","float"),x.fragment.code.add(a.glsl(D||(D=t(["\n      void main() {\n        discardBySlice(vpos);\n        vec3 localUp \x3d vnormal;\n        // the created normal is in tangent space\n        vec3 tangentNormal \x3d getSurfaceNormal(vuv, timeElapsed);\n\n        // we rotate the normal according to the tangent-bitangent-normal-Matrix\n        vec3 n \x3d normalize(vtbnMatrix * tangentNormal);\n        vec3 v \x3d -normalize(vpos - camPos);\n        vec3 l \x3d normalize(-lightingMainDirection);\n        "],
["\n      void main() {\n        discardBySlice(vpos);\n        vec3 localUp \x3d vnormal;\n        // the created normal is in tangent space\n        vec3 tangentNormal \x3d getSurfaceNormal(vuv, timeElapsed);\n\n        // we rotate the normal according to the tangent-bitangent-normal-Matrix\n        vec3 n \x3d normalize(vtbnMatrix * tangentNormal);\n        vec3 v \x3d -normalize(vpos - camPos);\n        vec3 l \x3d normalize(-lightingMainDirection);\n        "])))),d.receiveShadows?x.fragment.code.add(a.glsl(w||
(w=t(["\n        float shadow \x3d 1.0 - readShadowMap(vpos, linearDepth);\n      "],["\n        float shadow \x3d 1.0 - readShadowMap(vpos, linearDepth);\n      "])))):x.fragment.code.add(a.glsl(v||(v=t(["\n        float shadow \x3d 1.0;\n      "],["\n        float shadow \x3d 1.0;\n      "])))),x.fragment.code.add(a.glsl(E||(E=t(["\n        vec4 final \x3d vec4(getSeaColor(n, v, l, waterColor.rgb, lightingMainIntensity, localUp, shadow), waterColor.w);\n\n        // gamma correction\n        gl_FragColor \x3d delinearizeGamma(final);\n        gl_FragColor \x3d highlightSlice(gl_FragColor, vpos);\n      }\n    "],
["\n        vec4 final \x3d vec4(getSeaColor(n, v, l, waterColor.rgb, lightingMainIntensity, localUp, shadow), waterColor.w);\n\n        // gamma correction\n        gl_FragColor \x3d delinearizeGamma(final);\n        gl_FragColor \x3d highlightSlice(gl_FragColor, vpos);\n      }\n    "])))));2===d.output&&(x.include(f.NormalUtils,d),x.include(c.WaterDistortion,d),x.include(q.Slice,d),x.varyings.add("vpos","vec3"),x.varyings.add("vuv","vec2"),x.vertex.code.add(a.glsl(C||(C=t(["\n        void main(void) {\n          vuv \x3d uv0;\n          vpos \x3d (model * vec4(position, 1.0)).xyz;\n          gl_Position \x3d transformPosition(proj, view, vpos);\n        }\n    "],
["\n        void main(void) {\n          vuv \x3d uv0;\n          vpos \x3d (model * vec4(position, 1.0)).xyz;\n          gl_Position \x3d transformPosition(proj, view, vpos);\n        }\n    "])))),x.fragment.uniforms.add("timeElapsed","float"),x.fragment.code.add(a.glsl(J||(J=t(["\n        void main() {\n          discardBySlice(vpos);\n          // the created normal is in tangent space\n          vec3 tangentNormal \x3d getSurfaceNormal(vuv, timeElapsed);\n          tangentNormal \x3d normalize(tangentNormal);\n          gl_FragColor \x3d vec4((tangentNormal + vec3(1.0)) * 0.5, 0.0);\n        }\n    "],
["\n        void main() {\n          discardBySlice(vpos);\n          // the created normal is in tangent space\n          vec3 tangentNormal \x3d getSurfaceNormal(vuv, timeElapsed);\n          tangentNormal \x3d normalize(tangentNormal);\n          gl_FragColor \x3d vec4((tangentNormal + vec3(1.0)) * 0.5, 0.0);\n        }\n    "])))));5===d.output&&(x.include(f.NormalUtils,d),x.varyings.add("vpos","vec3"),x.vertex.code.add(a.glsl(K||(K=t(["\n        void main(void) {\n          vpos \x3d (model * vec4(position, 1.0)).xyz;\n          gl_Position \x3d transformPosition(proj, view, vpos);\n        }\n    "],
["\n        void main(void) {\n          vpos \x3d (model * vec4(position, 1.0)).xyz;\n          gl_Position \x3d transformPosition(proj, view, vpos);\n        }\n    "])))),x.fragment.uniforms.add("waterColor","vec4"),x.fragment.code.add(a.glsl(G||(G=t(["\n        void main() {\n          gl_FragColor \x3d waterColor;\n        }\n    "],["\n        void main() {\n          gl_FragColor \x3d waterColor;\n        }\n    "])))));return x};var u,D,w,v,E,C,J,K,G})},"esri/views/3d/webgl-engine/core/shaderLibrary/ForwardLinearDepth.glsl":function(){define(["require",
"exports","../../../../../core/tsSupport/makeTemplateObjectHelper","../shaderModules/interfaces"],function(z,d,t,l){Object.defineProperty(d,"__esModule",{value:!0});d.ForwardLinearDepth=function(d,r){0===r.output&&r.receiveShadows?(d.varyings.add("linearDepth","float"),d.vertex.code.add(l.glsl(q||(q=t(["\n      void forwardLinearDepth() { linearDepth \x3d gl_Position.w; }\n    "],["\n      void forwardLinearDepth() { linearDepth \x3d gl_Position.w; }\n    "]))))):1===r.output||3===r.output?(d.varyings.add("linearDepth",
"float"),d.vertex.uniforms.add("uCameraNearFar","vec2"),d.vertex.code.add(l.glsl(b||(b=t(["\n      void forwardLinearDepth() {\n        linearDepth \x3d (-position_view().z - uCameraNearFar[0]) / (uCameraNearFar[1] - uCameraNearFar[0]);\n      }\n    "],["\n      void forwardLinearDepth() {\n        linearDepth \x3d (-position_view().z - uCameraNearFar[0]) / (uCameraNearFar[1] - uCameraNearFar[0]);\n      }\n    "]))))):d.vertex.code.add(l.glsl(f||(f=t(["\n      void forwardLinearDepth() {}\n    "],
["\n      void forwardLinearDepth() {}\n    "]))))};var q,b,f})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/NormalUtils.glsl":function(){define(["require","exports","../../../../../../core/tsSupport/makeTemplateObjectHelper","../../shaderModules/interfaces"],function(z,d,t,l){Object.defineProperty(d,"__esModule",{value:!0});d.NormalUtils=function(d,c){0===c.viewingMode?d.vertex.code.add(l.glsl(q||(q=t(["\n      vec3 getLocalUp(in vec3 pos, in vec3 origin) {\n          return normalize(pos + origin);\n      }\n    "],
["\n      vec3 getLocalUp(in vec3 pos, in vec3 origin) {\n          return normalize(pos + origin);\n      }\n    "])))):d.vertex.code.add(l.glsl(b||(b=t(["\n      vec3 getLocalUp(in vec3 pos, in vec3 origin) {\n          return vec3(0.0, 0.0, 1.0); // WARNING: up-axis dependent code\n      }\n    "],["\n      vec3 getLocalUp(in vec3 pos, in vec3 origin) {\n          return vec3(0.0, 0.0, 1.0); // WARNING: up-axis dependent code\n      }\n    "]))));0===c.viewingMode?d.vertex.code.add(l.glsl(f||(f=
t(["\n        mat3 getTBNMatrix(in vec3 n) {\n            vec3 t \x3d normalize(cross(vec3(0.0, 0.0, 1.0), n));\n            vec3 b \x3d normalize(cross(n, t));\n            return mat3(t, b, n);\n        }\n    "],["\n        mat3 getTBNMatrix(in vec3 n) {\n            vec3 t \x3d normalize(cross(vec3(0.0, 0.0, 1.0), n));\n            vec3 b \x3d normalize(cross(n, t));\n            return mat3(t, b, n);\n        }\n    "])))):d.vertex.code.add(l.glsl(h||(h=t(["\n        mat3 getTBNMatrix(in vec3 n) {\n            vec3 t \x3d vec3(1.0, 0.0, 0.0);\n            vec3 b \x3d normalize(cross(n, t));\n            return mat3(t, b, n);\n        }\n    "],
["\n        mat3 getTBNMatrix(in vec3 n) {\n            vec3 t \x3d vec3(1.0, 0.0, 0.0);\n            vec3 b \x3d normalize(cross(n, t));\n            return mat3(t, b, n);\n        }\n    "]))))};var q,b,f,h})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/Water.glsl":function(){define("require exports ../../../../../../core/tsSupport/makeTemplateObjectHelper ./Gamma.glsl ./PhysicallyBasedRendering.glsl ../../shaderModules/interfaces".split(" "),function(z,d,t,l,q,b){Object.defineProperty(d,
"__esModule",{value:!0});d.Water=function(d,r){d.include(q.PhysicallyBasedRendering,r);d.include(l.Gamma);d.fragment.code.add(b.glsl(f||(f=t(["\n    const vec3 fresnelSky \x3d  vec3(0.02, 1.0, 5.0); // f0, f0max, exp\n    const vec2 fresnelMaterial \x3d  vec2(0.02, 0.1); // f0, f0max for specular term\n    const float roughness \x3d 0.06;\n\n    const vec3 skyZenitColor \x3d vec3(0, 0.6, 0.9);\n    const vec3 skyColor \x3d vec3(0.72, 0.92, 1.0);\n\n    PBRShadingWater shadingInfo;\n\n    /*\n    *   This function is an approximation for the sky gradient reflected\n    *   the water surface and describes a combination of two fresnel terms.\n    *   @parameter: cosTheta \x3d is the result of max(dot(n,v), 0.0)\n    *   @parameter: horizon \x3d the dominant color of the sky horizon\n    *   @parameter: cosTheta \x3d the dominant color of the sky zenit\n    */\n    vec3 getSkyGradientColor(in float cosTheta, in vec3 horizon, in vec3 zenit) {\n      float exponent \x3d pow((1.0 - cosTheta), fresnelSky[2]);\n      return mix(zenit, horizon, exponent);\n    }\n\n    /*\n    *   This function determines the water color per pixel.\n    *   @parameter: n \x3d normal facing away from the surface\n    *   @parameter: v \x3d view direction facing away from the surface.\n    *   @parameter: l \x3d light direction facing away from the surface\n    *   @parameter: lightIntensity \x3d light intensity, currently between 0...PI\n    *   @parameter: localUp \x3d a normal for the general direction of the surface\n    *   @parameter: shadow \x3d the amount of shadow at this pixel (0 \x3d no shadow)\n    */\n    vec3 getSeaColor(in vec3 n, in vec3 v, in vec3 l, vec3 color, in vec3 lightIntensity, in vec3 localUp, in float shadow) {\n\n      vec3 seaWaterColor \x3d linearizeGamma(color);\n      // using half vector to determine the specular light\n      vec3 h \x3d normalize(l + v);\n      shadingInfo.NdotL \x3d clamp(dot(n, l), 0.0, 1.0);\n      shadingInfo.NdotV \x3d clamp(dot(n, v), 0.001, 1.0);\n      shadingInfo.VdotN \x3d clamp(dot(v, n), 0.001, 1.0);\n      shadingInfo.NdotH \x3d clamp(dot(n, h), 0.0, 1.0);\n      shadingInfo.VdotH \x3d clamp(dot(v, h), 0.0, 1.0);\n      shadingInfo.LdotH \x3d clamp(dot(l, h), 0.0, 1.0);\n\n      // angle between vertex normal and view direction\n      float upDotV \x3d max(dot(localUp,v), 0.0);\n      // reflected sky color: the reflected sky color consists of two main colors, the\n      // reflected color at the horizon and the reflected color of the zenit.\n      // the reflected sky color is then an approximation based on the fresnel term.\n      vec3 skyHorizon \x3d linearizeGamma(skyColor);\n      vec3 skyZenit \x3d linearizeGamma(skyZenitColor);\n      vec3 skyColor \x3d getSkyGradientColor(upDotV, skyHorizon, skyZenit );\n\n      // we use the upDotL to smoothen out the\n      // reflected color of the water\n      float upDotL \x3d max(dot(localUp,l),0.0);\n\n      // The approximated sky color is adjusted according to the sun position.\n      // This is done as approximation for e.g. night views.\n      skyColor *\x3d 0.1 + upDotL * 0.9;\n\n      // If a water surface is in shadow we just use a slight darkening of the\n      // water surface expressed with this shadowModifier.\n      float shadowModifier \x3d clamp(shadow, 0.8, 1.0);\n\n      // The reflected sky color consists of the fresnel reflection multiplied with the approximated sky color.\n      // The shadow is influencing the frensel term to keep the shadow impression for really near views. As long\n      // as reflection are absent there is a need to have a slight shadow for depth perception.\n      vec3 reflSky \x3d fresnelReflection(shadingInfo.VdotN, vec3(fresnelSky[0]), fresnelSky[1]) * skyColor * shadowModifier;\n\n      // The reflected sea color is the input water color combined with the reflected sky color.\n      // The reflected sky color is modified by the incoming light.\n      vec3 reflSea \x3d seaWaterColor * mix(skyColor, upDotL * lightIntensity * LIGHT_NORMALIZATION, 2.0 / 3.0) * shadowModifier;\n\n      vec3 specular \x3d vec3(0.0);\n      // This prevents the specular light to be rendered when:\n      // - sun is behind a polygon (e.g. sundown for elevated polygons where nDotL might be still ok)\n      // - viewer is under water (for this localUp is better than n)\n      if(upDotV \x3e 0.0 \x26\x26 upDotL \x3e 0.0) {\n        // calculate the cook torrance BRDF but with simplified occlusion\n        vec3 specularSun \x3d brdfWater(shadingInfo, roughness, vec3(fresnelMaterial[0]), fresnelMaterial[1]);\n        // Normalize light intensity to be between 0...1. Shadow cancels out specular light here\n        vec3 incidentLight \x3d lightIntensity * LIGHT_NORMALIZATION * shadow;\n\n        specular \x3d shadingInfo.NdotL * incidentLight * specularSun;\n      }\n      // combining reflected sky, reflected sea and specular highlight.\n      return tonemapACES(reflSky + reflSea + specular);\n    }\n  "],
["\n    const vec3 fresnelSky \x3d  vec3(0.02, 1.0, 5.0); // f0, f0max, exp\n    const vec2 fresnelMaterial \x3d  vec2(0.02, 0.1); // f0, f0max for specular term\n    const float roughness \x3d 0.06;\n\n    const vec3 skyZenitColor \x3d vec3(0, 0.6, 0.9);\n    const vec3 skyColor \x3d vec3(0.72, 0.92, 1.0);\n\n    PBRShadingWater shadingInfo;\n\n    /*\n    *   This function is an approximation for the sky gradient reflected\n    *   the water surface and describes a combination of two fresnel terms.\n    *   @parameter: cosTheta \x3d is the result of max(dot(n,v), 0.0)\n    *   @parameter: horizon \x3d the dominant color of the sky horizon\n    *   @parameter: cosTheta \x3d the dominant color of the sky zenit\n    */\n    vec3 getSkyGradientColor(in float cosTheta, in vec3 horizon, in vec3 zenit) {\n      float exponent \x3d pow((1.0 - cosTheta), fresnelSky[2]);\n      return mix(zenit, horizon, exponent);\n    }\n\n    /*\n    *   This function determines the water color per pixel.\n    *   @parameter: n \x3d normal facing away from the surface\n    *   @parameter: v \x3d view direction facing away from the surface.\n    *   @parameter: l \x3d light direction facing away from the surface\n    *   @parameter: lightIntensity \x3d light intensity, currently between 0...PI\n    *   @parameter: localUp \x3d a normal for the general direction of the surface\n    *   @parameter: shadow \x3d the amount of shadow at this pixel (0 \x3d no shadow)\n    */\n    vec3 getSeaColor(in vec3 n, in vec3 v, in vec3 l, vec3 color, in vec3 lightIntensity, in vec3 localUp, in float shadow) {\n\n      vec3 seaWaterColor \x3d linearizeGamma(color);\n      // using half vector to determine the specular light\n      vec3 h \x3d normalize(l + v);\n      shadingInfo.NdotL \x3d clamp(dot(n, l), 0.0, 1.0);\n      shadingInfo.NdotV \x3d clamp(dot(n, v), 0.001, 1.0);\n      shadingInfo.VdotN \x3d clamp(dot(v, n), 0.001, 1.0);\n      shadingInfo.NdotH \x3d clamp(dot(n, h), 0.0, 1.0);\n      shadingInfo.VdotH \x3d clamp(dot(v, h), 0.0, 1.0);\n      shadingInfo.LdotH \x3d clamp(dot(l, h), 0.0, 1.0);\n\n      // angle between vertex normal and view direction\n      float upDotV \x3d max(dot(localUp,v), 0.0);\n      // reflected sky color: the reflected sky color consists of two main colors, the\n      // reflected color at the horizon and the reflected color of the zenit.\n      // the reflected sky color is then an approximation based on the fresnel term.\n      vec3 skyHorizon \x3d linearizeGamma(skyColor);\n      vec3 skyZenit \x3d linearizeGamma(skyZenitColor);\n      vec3 skyColor \x3d getSkyGradientColor(upDotV, skyHorizon, skyZenit );\n\n      // we use the upDotL to smoothen out the\n      // reflected color of the water\n      float upDotL \x3d max(dot(localUp,l),0.0);\n\n      // The approximated sky color is adjusted according to the sun position.\n      // This is done as approximation for e.g. night views.\n      skyColor *\x3d 0.1 + upDotL * 0.9;\n\n      // If a water surface is in shadow we just use a slight darkening of the\n      // water surface expressed with this shadowModifier.\n      float shadowModifier \x3d clamp(shadow, 0.8, 1.0);\n\n      // The reflected sky color consists of the fresnel reflection multiplied with the approximated sky color.\n      // The shadow is influencing the frensel term to keep the shadow impression for really near views. As long\n      // as reflection are absent there is a need to have a slight shadow for depth perception.\n      vec3 reflSky \x3d fresnelReflection(shadingInfo.VdotN, vec3(fresnelSky[0]), fresnelSky[1]) * skyColor * shadowModifier;\n\n      // The reflected sea color is the input water color combined with the reflected sky color.\n      // The reflected sky color is modified by the incoming light.\n      vec3 reflSea \x3d seaWaterColor * mix(skyColor, upDotL * lightIntensity * LIGHT_NORMALIZATION, 2.0 / 3.0) * shadowModifier;\n\n      vec3 specular \x3d vec3(0.0);\n      // This prevents the specular light to be rendered when:\n      // - sun is behind a polygon (e.g. sundown for elevated polygons where nDotL might be still ok)\n      // - viewer is under water (for this localUp is better than n)\n      if(upDotV \x3e 0.0 \x26\x26 upDotL \x3e 0.0) {\n        // calculate the cook torrance BRDF but with simplified occlusion\n        vec3 specularSun \x3d brdfWater(shadingInfo, roughness, vec3(fresnelMaterial[0]), fresnelMaterial[1]);\n        // Normalize light intensity to be between 0...1. Shadow cancels out specular light here\n        vec3 incidentLight \x3d lightIntensity * LIGHT_NORMALIZATION * shadow;\n\n        specular \x3d shadingInfo.NdotL * incidentLight * specularSun;\n      }\n      // combining reflected sky, reflected sea and specular highlight.\n      return tonemapACES(reflSky + reflSea + specular);\n    }\n  "]))))};
var f})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/Gamma.glsl":function(){define(["require","exports","../../../../../../core/tsSupport/makeTemplateObjectHelper","../../shaderModules/interfaces"],function(z,d,t,l){Object.defineProperty(d,"__esModule",{value:!0});d.Gamma=function(b){b.fragment.code.add(l.glsl(q||(q=t(["\n    const float GAMMA \x3d 2.2;\n    const float INV_GAMMA \x3d 0.4545454545;\n\n    vec4 delinearizeGamma(vec4 color) {\n      return vec4(pow(color.rgb, vec3(INV_GAMMA)), color.w);\n    }\n\n    vec3 linearizeGamma(vec3 color) {\n      return pow(color, vec3(GAMMA));\n    }\n  "],
["\n    const float GAMMA \x3d 2.2;\n    const float INV_GAMMA \x3d 0.4545454545;\n\n    vec4 delinearizeGamma(vec4 color) {\n      return vec4(pow(color.rgb, vec3(INV_GAMMA)), color.w);\n    }\n\n    vec3 linearizeGamma(vec3 color) {\n      return pow(color, vec3(GAMMA));\n    }\n  "]))))};var q})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/PhysicallyBasedRendering.glsl":function(){define("require exports ../../../../../../core/tsSupport/makeTemplateObjectHelper ./AnalyticalSkyModel.glsl ./PiUtils.glsl ../../shaderModules/interfaces".split(" "),
function(z,d,t,l,q,b){Object.defineProperty(d,"__esModule",{value:!0});d.PhysicallyBasedRendering=function(d,J){var C=d.fragment.code;d.include(q.PiUtils);if(3===J.pbrMode||4===J.pbrMode)C.add(b.glsl(f||(f=t(["\n    struct PBRShadingWater\n    {\n        float NdotL;   // cos angle between normal and light direction\n        float NdotV;   // cos angle between normal and view direction\n        float NdotH;   // cos angle between normal and half vector\n        float VdotH;   // cos angle between view direction and half vector\n        float LdotH;   // cos angle between light direction and half vector\n        float VdotN;   // cos angle between view direction and normal vector\n    };\n\n    float dtrExponent \x3d ",
";\n    "],["\n    struct PBRShadingWater\n    {\n        float NdotL;   // cos angle between normal and light direction\n        float NdotV;   // cos angle between normal and view direction\n        float NdotH;   // cos angle between normal and half vector\n        float VdotH;   // cos angle between view direction and half vector\n        float LdotH;   // cos angle between light direction and half vector\n        float VdotN;   // cos angle between view direction and normal vector\n    };\n\n    float dtrExponent \x3d ",
";\n    "])),J.useCustomDTRExponentForWater?"2.2":"2.0")),C.add(b.glsl(h||(h=t(["\n    vec3 fresnelReflection(float angle, vec3 f0, float f90) {\n      return f0 + (f90 - f0) * pow(1.0 - angle, 5.0);\n    }\n    "],["\n    vec3 fresnelReflection(float angle, vec3 f0, float f90) {\n      return f0 + (f90 - f0) * pow(1.0 - angle, 5.0);\n    }\n    "])))),C.add(b.glsl(r||(r=t(["\n    float normalDistributionWater(float NdotH, float roughness)\n    {\n      float r2 \x3d roughness * roughness;\n      float NdotH2 \x3d NdotH * NdotH;\n      float denom \x3d pow((NdotH2 * (r2 - 1.0) + 1.0), dtrExponent) * PI;\n      return r2 / denom;\n    }\n    "],
["\n    float normalDistributionWater(float NdotH, float roughness)\n    {\n      float r2 \x3d roughness * roughness;\n      float NdotH2 \x3d NdotH * NdotH;\n      float denom \x3d pow((NdotH2 * (r2 - 1.0) + 1.0), dtrExponent) * PI;\n      return r2 / denom;\n    }\n    "])))),C.add(b.glsl(c||(c=t(["\n    float geometricOcclusionKelemen(float LoH)\n    {\n        return 0.25 / (LoH * LoH);\n    }\n    "],["\n    float geometricOcclusionKelemen(float LoH)\n    {\n        return 0.25 / (LoH * LoH);\n    }\n    "])))),
C.add(b.glsl(a||(a=t(["\n    vec3 brdfWater(in PBRShadingWater props, float roughness, vec3 F0, float F0Max)\n    {\n      vec3  F \x3d fresnelReflection(props.VdotH, F0, F0Max);\n      float D \x3d normalDistributionWater(props.NdotH, roughness);\n      float V \x3d geometricOcclusionKelemen(props.LdotH);\n      return (D * V) * F;\n    }\n\n    vec3 tonemapACES(const vec3 x) {\n      return (x * (2.51 * x + 0.03)) / (x * (2.43 * x + 0.59) + 0.14);\n    }\n    "],["\n    vec3 brdfWater(in PBRShadingWater props, float roughness, vec3 F0, float F0Max)\n    {\n      vec3  F \x3d fresnelReflection(props.VdotH, F0, F0Max);\n      float D \x3d normalDistributionWater(props.NdotH, roughness);\n      float V \x3d geometricOcclusionKelemen(props.LdotH);\n      return (D * V) * F;\n    }\n\n    vec3 tonemapACES(const vec3 x) {\n      return (x * (2.51 * x + 0.03)) / (x * (2.43 * x + 0.59) + 0.14);\n    }\n    "]))));
else if(1===J.pbrMode||2===J.pbrMode)d.include(l.AnalyticalSkyModel),C.add(b.glsl(m||(m=t(["\n    struct PBRShadingInfo\n    {\n        float NdotL;                  // cos angle between normal and light direction\n        float NdotV;                  // cos angle between normal and view direction\n        float NdotH;                  // cos angle between normal and half vector\n        float VdotH;                  // cos angle between view direction and half vector\n        float LdotH;                  // cos angle between view light direction and half vector\n        float NdotNG;                 // cos angle between normal and normal of the ground\n        float RdotNG;                 // cos angle between view direction reflected of the normal and normal of the ground\n        float NdotAmbDir;             // cos angle between view direction and the fill light in ambient illumination\n        float NdotH_Horizon;          // cos angle between normal and half vector defined with horizon illumination\n        vec3 skyRadianceToSurface;         // integrated radiance of the sky based on the surface roughness (used for specular reflection)\n        vec3 groundRadianceToSurface;      // integrated radiance of the ground based on the surface roughness (used for specular reflection)\n        vec3 skyIrradianceToSurface;       // irradiance of the sky (used for diffuse reflection)\n        vec3 groundIrradianceToSurface;    // irradiance of the ground (used for diffuse reflection)\n\n        float averageAmbientRadiance;      // average ambient radiance used to deduce black level in gamut mapping\n        float ssao;                   // ssao coefficient\n        vec3 albedoLinear;            // linear color of the albedo\n        vec3 f0;                      // fresnel value at normal incident light\n        vec3 f90;                     // fresnel value at 90o of incident light\n\n        vec3 diffuseColor;            // diffuse color of the material used in environment illumination\n        float metalness;              // metalness of the material\n        float roughness;              // roughness of the material\n    };\n    "],
["\n    struct PBRShadingInfo\n    {\n        float NdotL;                  // cos angle between normal and light direction\n        float NdotV;                  // cos angle between normal and view direction\n        float NdotH;                  // cos angle between normal and half vector\n        float VdotH;                  // cos angle between view direction and half vector\n        float LdotH;                  // cos angle between view light direction and half vector\n        float NdotNG;                 // cos angle between normal and normal of the ground\n        float RdotNG;                 // cos angle between view direction reflected of the normal and normal of the ground\n        float NdotAmbDir;             // cos angle between view direction and the fill light in ambient illumination\n        float NdotH_Horizon;          // cos angle between normal and half vector defined with horizon illumination\n        vec3 skyRadianceToSurface;         // integrated radiance of the sky based on the surface roughness (used for specular reflection)\n        vec3 groundRadianceToSurface;      // integrated radiance of the ground based on the surface roughness (used for specular reflection)\n        vec3 skyIrradianceToSurface;       // irradiance of the sky (used for diffuse reflection)\n        vec3 groundIrradianceToSurface;    // irradiance of the ground (used for diffuse reflection)\n\n        float averageAmbientRadiance;      // average ambient radiance used to deduce black level in gamut mapping\n        float ssao;                   // ssao coefficient\n        vec3 albedoLinear;            // linear color of the albedo\n        vec3 f0;                      // fresnel value at normal incident light\n        vec3 f90;                     // fresnel value at 90o of incident light\n\n        vec3 diffuseColor;            // diffuse color of the material used in environment illumination\n        float metalness;              // metalness of the material\n        float roughness;              // roughness of the material\n    };\n    "])))),
C.add(b.glsl(u||(u=t(["\n    float normalDistribution(float NdotH, float roughness)\n    {\n        float a \x3d NdotH * roughness;\n        float b \x3d roughness / (1.0 - NdotH * NdotH + a * a);\n        return b * b * INV_PI;\n    }\n    "],["\n    float normalDistribution(float NdotH, float roughness)\n    {\n        float a \x3d NdotH * roughness;\n        float b \x3d roughness / (1.0 - NdotH * NdotH + a * a);\n        return b * b * INV_PI;\n    }\n    "])))),C.add(b.glsl(D||(D=t(["\n    const vec4 c0 \x3d vec4(-1.0, -0.0275, -0.572,  0.022);\n    const vec4 c1 \x3d vec4( 1.0,  0.0425,  1.040, -0.040);\n    const vec2 c2 \x3d vec2(-1.04, 1.04);\n\n    vec2 prefilteredDFGAnalytical(float roughness, float NdotV) {\n        vec4 r \x3d roughness * c0 + c1;\n        float a004 \x3d min(r.x * r.x, exp2(-9.28 * NdotV)) * r.x + r.y;\n        return c2 * a004 + r.zw;\n    }\n    "],
["\n    const vec4 c0 \x3d vec4(-1.0, -0.0275, -0.572,  0.022);\n    const vec4 c1 \x3d vec4( 1.0,  0.0425,  1.040, -0.040);\n    const vec2 c2 \x3d vec2(-1.04, 1.04);\n\n    vec2 prefilteredDFGAnalytical(float roughness, float NdotV) {\n        vec4 r \x3d roughness * c0 + c1;\n        float a004 \x3d min(r.x * r.x, exp2(-9.28 * NdotV)) * r.x + r.y;\n        return c2 * a004 + r.zw;\n    }\n    "])))),C.add(b.glsl(w||(w=t(["\n    vec3 evaluateEnvironmentIllumination(PBRShadingInfo inputs) {\n      vec3 indirectDiffuse \x3d evaluateDiffuseIlluminationHemisphere(inputs.groundIrradianceToSurface, inputs.skyIrradianceToSurface, inputs.NdotNG);\n      vec3 indirectSpecular \x3d evaluateSpecularIlluminationHemisphere(inputs.groundRadianceToSurface, inputs.skyRadianceToSurface, inputs.RdotNG, inputs.roughness);\n\n      // From diffuse illumination calculate reflected color\n      vec3 diffuseComponent \x3d inputs.diffuseColor * indirectDiffuse * INV_PI;\n\n      // From specular illumination calculate reflected color\n      vec2 dfg \x3d prefilteredDFGAnalytical(inputs.roughness, inputs.NdotV);\n      vec3 specularColor \x3d inputs.f0 * dfg.x + inputs.f90 * dfg.y;\n      vec3 specularComponent \x3d specularColor * indirectSpecular;\n\n      return (diffuseComponent + specularComponent);\n    }\n    "],
["\n    vec3 evaluateEnvironmentIllumination(PBRShadingInfo inputs) {\n      vec3 indirectDiffuse \x3d evaluateDiffuseIlluminationHemisphere(inputs.groundIrradianceToSurface, inputs.skyIrradianceToSurface, inputs.NdotNG);\n      vec3 indirectSpecular \x3d evaluateSpecularIlluminationHemisphere(inputs.groundRadianceToSurface, inputs.skyRadianceToSurface, inputs.RdotNG, inputs.roughness);\n\n      // From diffuse illumination calculate reflected color\n      vec3 diffuseComponent \x3d inputs.diffuseColor * indirectDiffuse * INV_PI;\n\n      // From specular illumination calculate reflected color\n      vec2 dfg \x3d prefilteredDFGAnalytical(inputs.roughness, inputs.NdotV);\n      vec3 specularColor \x3d inputs.f0 * dfg.x + inputs.f90 * dfg.y;\n      vec3 specularComponent \x3d specularColor * indirectSpecular;\n\n      return (diffuseComponent + specularComponent);\n    }\n    "])))),
C.add(b.glsl(v||(v=t(["\n    float gamutMapChanel(float x, vec2 p){\n      return (x \x3c p.x) ? mix(0.0, p.y, x/p.x) : mix(p.y, 1.0, (x - p.x) / (1.0 - p.x) );\n    }"],["\n    float gamutMapChanel(float x, vec2 p){\n      return (x \x3c p.x) ? mix(0.0, p.y, x/p.x) : mix(p.y, 1.0, (x - p.x) / (1.0 - p.x) );\n    }"])))),C.add(b.glsl(E||(E=t(["\n    vec3 blackLevelSoftCompression(vec3 inColor, PBRShadingInfo inputs){\n      vec3 outColor;\n      vec2 p \x3d vec2(0.02 * (inputs.averageAmbientRadiance), 0.0075 * (inputs.averageAmbientRadiance));\n      outColor.x \x3d gamutMapChanel(inColor.x, p) ;\n      outColor.y \x3d gamutMapChanel(inColor.y, p) ;\n      outColor.z \x3d gamutMapChanel(inColor.z, p) ;\n      return outColor;\n    }\n    "],
["\n    vec3 blackLevelSoftCompression(vec3 inColor, PBRShadingInfo inputs){\n      vec3 outColor;\n      vec2 p \x3d vec2(0.02 * (inputs.averageAmbientRadiance), 0.0075 * (inputs.averageAmbientRadiance));\n      outColor.x \x3d gamutMapChanel(inColor.x, p) ;\n      outColor.y \x3d gamutMapChanel(inColor.y, p) ;\n      outColor.z \x3d gamutMapChanel(inColor.z, p) ;\n      return outColor;\n    }\n    "]))))};var f,h,r,c,a,m,u,D,w,v,E})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/AnalyticalSkyModel.glsl":function(){define(["require",
"exports","../../../../../../core/tsSupport/makeTemplateObjectHelper","../../shaderModules/interfaces"],function(z,d,t,l){Object.defineProperty(d,"__esModule",{value:!0});d.AnalyticalSkyModel=function(d){d=d.fragment.code;d.add(l.glsl(q||(q=t(["\n    vec3 evaluateDiffuseIlluminationHemisphere(vec3 ambientGround, vec3 ambientSky, float NdotNG)\n    {\n      return ((1.0 - NdotNG) * ambientGround + (1.0 + NdotNG) * ambientSky) * 0.5;\n    }\n    "],["\n    vec3 evaluateDiffuseIlluminationHemisphere(vec3 ambientGround, vec3 ambientSky, float NdotNG)\n    {\n      return ((1.0 - NdotNG) * ambientGround + (1.0 + NdotNG) * ambientSky) * 0.5;\n    }\n    "]))));
d.add(l.glsl(b||(b=t(["\n    float integratedRadiance(float cosTheta2, float roughness)\n    {\n      return (cosTheta2 - 1.0) / (cosTheta2 * (1.0 - roughness * roughness) - 1.0);\n    }\n    "],["\n    float integratedRadiance(float cosTheta2, float roughness)\n    {\n      return (cosTheta2 - 1.0) / (cosTheta2 * (1.0 - roughness * roughness) - 1.0);\n    }\n    "]))));d.add(l.glsl(f||(f=t(["\n    vec3 evaluateSpecularIlluminationHemisphere(vec3 ambientGround, vec3 ambientSky, float RdotNG, float roughness)\n    {\n      float cosTheta2 \x3d 1.0 - RdotNG * RdotNG;\n      float intRadTheta \x3d integratedRadiance(cosTheta2, roughness);\n\n      // Calculate the integrated directional radiance of the ground and the sky\n      float ground \x3d RdotNG \x3c 0.0 ? 1.0 - intRadTheta : 1.0 + intRadTheta;\n      float sky \x3d 2.0 - ground;\n      return (ground * ambientGround + sky * ambientSky) * 0.5;\n    }\n    "],
["\n    vec3 evaluateSpecularIlluminationHemisphere(vec3 ambientGround, vec3 ambientSky, float RdotNG, float roughness)\n    {\n      float cosTheta2 \x3d 1.0 - RdotNG * RdotNG;\n      float intRadTheta \x3d integratedRadiance(cosTheta2, roughness);\n\n      // Calculate the integrated directional radiance of the ground and the sky\n      float ground \x3d RdotNG \x3c 0.0 ? 1.0 - intRadTheta : 1.0 + intRadTheta;\n      float sky \x3d 2.0 - ground;\n      return (ground * ambientGround + sky * ambientSky) * 0.5;\n    }\n    "]))))};
var q,b,f})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/PiUtils.glsl":function(){define(["require","exports","../../../../../../core/tsSupport/makeTemplateObjectHelper","../../shaderModules/interfaces"],function(z,d,t,l){Object.defineProperty(d,"__esModule",{value:!0});d.PiUtils=function(d){d.vertex.code.add(l.glsl(q||(q=t(["\n    const float PI \x3d 3.141592653589793;\n  "],["\n    const float PI \x3d 3.141592653589793;\n  "]))));d.fragment.code.add(l.glsl(b||(b=t(["\n    const float PI \x3d 3.141592653589793;\n    const float LIGHT_NORMALIZATION \x3d 1.0 / PI;\n    const float INV_PI \x3d 0.3183098861837907;\n    const float HALF_PI \x3d 1.570796326794897;\n    "],
["\n    const float PI \x3d 3.141592653589793;\n    const float LIGHT_NORMALIZATION \x3d 1.0 / PI;\n    const float INV_PI \x3d 0.3183098861837907;\n    const float HALF_PI \x3d 1.570796326794897;\n    "]))))};var q,b})},"esri/views/3d/webgl-engine/core/shaderModules/ShaderBuilder":function(){define(["require","exports","../../../../../core/Logger","../../../../../core/MapUtils","../../../../../core/SetUtils"],function(z,d,t,l,q){Object.defineProperty(d,"__esModule",{value:!0});var b=t.getLogger("esri.views.3d.webgl-engine.core.shaderModules.shaderBuilder");
z=function(){function d(){this.vertex=new r;this.fragment=new r;this.attributes=new c;this.varyings=new a;this.extensions=new m;this.defines=new u;this._includedModules=new Map}d.prototype.include=function(a,c){this._includedModules.has(a)?this._includedModules.get(a)!==c&&b.error("Trying to include shader module multiple times with different sets of options."):(this._includedModules.set(a,c),"shaderModule"in a?a.shaderModule(this,c):a(this,c))};d.prototype.generateSource=function(a){var c=this.extensions.generateSource(a),
b=this.attributes.generateSource(a),d=this.varyings.generateSource(),f="vertex"===a?this.vertex:this.fragment,h=f.uniforms.generateSource(),m=f.code.generateSource();a="vertex"===a?w:D;f=this.defines.generateSource().concat(f.defines.generateSource());return"\n"+c.join("\n")+"\n\n"+f.join("\n")+"\n\n"+a+"\n\n"+h.join("\n")+"\n\n"+b.join("\n")+"\n\n"+d.join("\n")+"\n\n"+m.join("\n")};return d}();d.ShaderBuilder=z;var f=function(){function a(){this._entries=[];this._set=new Set}a.prototype.add=function(a,
c,b){var d=a+"_"+c+"_"+b;this._set.has(d)||(this._entries.push([a,c,b]),this._set.add(d));return this};a.prototype.generateSource=function(){return this._entries.map(function(a){var c=a[2];return"uniform "+a[1]+" "+a[0]+(c?"["+c+"]":"")+";"})};return a}(),h=function(){function a(){this._entries=[]}a.prototype.add=function(a){this._entries.push(a)};a.prototype.generateSource=function(){return this._entries};return a}(),r=function(){return function(){this.uniforms=new f;this.code=new h;this.defines=
new u}}(),c=function(){function a(){this._entries=[]}a.prototype.add=function(a,c){this._entries.push([a,c])};a.prototype.generateSource=function(a){return"fragment"===a?[]:this._entries.map(function(a){return"attribute "+a[1]+" "+a[0]+";"})};return a}(),a=function(){function a(){this._entries=[]}a.prototype.add=function(a,c){this._entries.push([a,c])};a.prototype.generateSource=function(){return this._entries.map(function(a){return"varying "+a[1]+" "+a[0]+";"})};return a}(),m=function(){function a(){this._entries=
new Set}a.prototype.add=function(a){this._entries.add(a)};a.prototype.generateSource=function(c){var b="vertex"===c?a.WHITELIST_VERTEX:a.WHITELIST_FRAGMENT;return q.valuesOfSet(this._entries).filter(function(a){return 0<=b.indexOf(a)}).map(function(a){return"#extension "+a+" : enable"})};a.WHITELIST_FRAGMENT=["GL_EXT_shader_texture_lod","GL_OES_standard_derivatives"];a.WHITELIST_VERTEX=[];return a}(),u=function(){function a(){this._entries=new Map}a.prototype.addInt=function(a,c){c=0===c%1?c.toFixed(0):
c.toString();this._entries.set(a,c)};a.prototype.addFloat=function(a,c){c=0===c%1?c.toFixed(1):c.toString();this._entries.set(a,c)};a.prototype.generateSource=function(){return l.pairsOfMap(this._entries).map(function(a){return"#define "+a[0]+" "+a[1]})};return a}(),D="#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n  precision highp sampler2D;\n#else\n  precision mediump float;\n  precision mediump sampler2D;\n#endif",w="precision highp float;\nprecision highp sampler2D;"})},"esri/views/webgl/Program":function(){define(["require",
"exports","../../core/has","../../core/maybe","./ShaderTranspiler"],function(z,d,t,l,q){function b(b,d){if(l.isNone(b)||b.length!==d.length)return!0;for(var f=0;f<b.length;++f)if(b[f]!==d[f])return!0;return!1}return function(){function d(b,f,c,a,m){void 0===m&&(m={});this._glName=this._context=null;this._locations={};this._id=void 0;this._initialized=!1;this._fShader=this._vShader=null;this._defines={};this._nameToUniformLocation={};this._nameToAttribLocation={};this._nameToUniform1={};this._nameToUniform1v=
{};this._nameToUniform2={};this._nameToUniform3={};this._nameToUniform4={};this._nameToUniformMatrix3={};this._nameToUniformMatrix4={};b||console.error("RenderingContext isn't initialized!");0===f.length&&console.error("Shaders source should not be empty!");this._context=b;this._vertexShaderSource=f;this._fragmentShaderSource=c;if(Array.isArray(m))for(b=0;b<m.length;b++)this._defines[m[b]]="1";else this._defines=m;this._id=d._nextId++;this._locations=a}Object.defineProperty(d.prototype,"id",{get:function(){return this._id},
enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"locations",{get:function(){return this._locations},enumerable:!0,configurable:!0});d.prototype.getDefine=function(b){return this._defines[b]};d.prototype.dispose=function(){if(this._context){var b=this._context.gl;this._vShader&&(b.deleteShader(this._vShader),this._vShader=null);this._fShader&&(b.deleteShader(this._fShader),
this._fShader=null);this._glName&&(b.deleteProgram(this._glName),this._glName=null);this._context=null}};d.prototype.initialize=function(){if(!this._initialized){this._vShader=this._loadShader(35633);this._fShader=this._loadShader(35632);this._vShader&&this._fShader||console.error("Error loading shaders!");var b=this._context.gl,d=b.createProgram();b.attachShader(d,this._vShader);b.attachShader(d,this._fShader);for(var c in this._locations)b.bindAttribLocation(d,this._locations[c],c);b.linkProgram(d);
this._glName=d;this._initialized=!0}};d.prototype.getUniformLocation=function(b){this.initialize();void 0===this._nameToUniformLocation[b]&&(this._nameToUniformLocation[b]=this._context.gl.getUniformLocation(this._glName,b));return this._nameToUniformLocation[b]};d.prototype.hasUniform=function(b){return null!==this.getUniformLocation(b)};d.prototype.getAttribLocation=function(b){this.initialize();void 0===this._nameToAttribLocation[b]&&(this._nameToAttribLocation[b]=this._context.gl.getAttribLocation(this._glName,
b));return this._nameToAttribLocation[b]};d.prototype.setUniform1i=function(b,d){var c=this._nameToUniform1[b];if(void 0===c||d!==c)this._context.bindProgram(this),this._context.gl.uniform1i(this.getUniformLocation(b),d),this._nameToUniform1[b]=d};d.prototype.setUniform1iv=function(f,l){var c=this._nameToUniform1v[f];b(c,l)&&(this._context.bindProgram(this),this._context.gl.uniform1iv(this.getUniformLocation(f),l),void 0===c?this._nameToUniform1v[f]=d._arrayCopy(l):d._arrayAssign(l,c))};d.prototype.setUniform2iv=
function(f,l){var c=this._nameToUniform2[f];b(c,l)&&(this._context.bindProgram(this),this._context.gl.uniform2iv(this.getUniformLocation(f),l),void 0===c?this._nameToUniform2[f]=d._arrayCopy(l):d._arrayAssign(l,c))};d.prototype.setUniform3iv=function(f,l){var c=this._nameToUniform3[f];b(c,l)&&(this._context.bindProgram(this),this._context.gl.uniform3iv(this.getUniformLocation(f),l),void 0===c?this._nameToUniform3[f]=d._arrayCopy(l):d._arrayAssign(l,c))};d.prototype.setUniform4iv=function(f,l){var c=
this._nameToUniform4[f];b(c,l)&&(this._context.bindProgram(this),this._context.gl.uniform4iv(this.getUniformLocation(f),l),void 0===c?this._nameToUniform4[f]=d._arrayCopy(l):d._arrayAssign(l,c))};d.prototype.setUniform1f=function(b,d){var c=this._nameToUniform1[b];if(void 0===c||d!==c)this._context.bindProgram(this),this._context.gl.uniform1f(this.getUniformLocation(b),d),this._nameToUniform1[b]=d};d.prototype.setUniform1fv=function(f,l){var c=this._nameToUniform1v[f];b(c,l)&&(this._context.bindProgram(this),
this._context.gl.uniform1fv(this.getUniformLocation(f),l),void 0===c?this._nameToUniform1v[f]=d._arrayCopy(l):d._arrayAssign(l,c))};d.prototype.setUniform2f=function(b,d,c){var a=this._nameToUniform2[b];if(void 0===a||d!==a[0]||c!==a[1])this._context.bindProgram(this),this._context.gl.uniform2f(this.getUniformLocation(b),d,c),void 0===a?this._nameToUniform2[b]=[d,c]:(a[0]=d,a[1]=c)};d.prototype.setUniform2fv=function(f,l){var c=this._nameToUniform2[f];b(c,l)&&(this._context.bindProgram(this),this._context.gl.uniform2fv(this.getUniformLocation(f),
l),void 0===c?this._nameToUniform2[f]=d._arrayCopy(l):d._arrayAssign(l,c))};d.prototype.setUniform3f=function(b,d,c,a){var f=this._nameToUniform3[b];if(void 0===f||d!==f[0]||c!==f[1]||a!==f[2])this._context.bindProgram(this),this._context.gl.uniform3f(this.getUniformLocation(b),d,c,a),void 0===f?this._nameToUniform3[b]=[d,c,a]:(f[0]=d,f[1]=c,f[2]=a)};d.prototype.setUniform3fv=function(f,l){var c=this._nameToUniform3[f];b(c,l)&&(this._context.bindProgram(this),this._context.gl.uniform3fv(this.getUniformLocation(f),
l),void 0===c?this._nameToUniform3[f]=d._arrayCopy(l):d._arrayAssign(l,c))};d.prototype.setUniform4f=function(b,d,c,a,f){var h=this._nameToUniform4[b];if(void 0===h||d!==h[0]||c!==h[1]||a!==h[2]||f!==h[3])this._context.bindProgram(this),this._context.gl.uniform4f(this.getUniformLocation(b),d,c,a,f),void 0===h?this._nameToUniform4[b]=[d,c,a,f]:(h[0]=d,h[1]=c,h[2]=a,h[3]=f)};d.prototype.setUniform4fv=function(f,l){var c=this._nameToUniform4[f];b(c,l)&&(this._context.bindProgram(this),this._context.gl.uniform4fv(this.getUniformLocation(f),
l),void 0===c?this._nameToUniform4[f]=d._arrayCopy(l):d._arrayAssign(l,c))};d.prototype.setUniformMatrix3fv=function(f,r,c){void 0===c&&(c=!1);var a=this._nameToUniformMatrix3[f],h;h=l.isNone(a)?!0:9!==a.length?b(a,r):9!==a.length||a[0]!==r[0]||a[1]!==r[1]||a[2]!==r[2]||a[3]!==r[3]||a[4]!==r[4]||a[5]!==r[5]||a[6]!==r[6]||a[7]!==r[7]||a[8]!==r[8];h&&(this._context.bindProgram(this),this._context.gl.uniformMatrix3fv(this.getUniformLocation(f),c,r),void 0===a?this._nameToUniformMatrix3[f]=d._arrayCopy(r):
d._arrayAssign(r,a))};d.prototype.setUniformMatrix4fv=function(f,r,c){void 0===c&&(c=!1);var a=this._nameToUniformMatrix4[f],h;h=l.isNone(a)?!0:16!==a.length?b(a,r):16!==a.length||a[0]!==r[0]||a[1]!==r[1]||a[2]!==r[2]||a[3]!==r[3]||a[4]!==r[4]||a[5]!==r[5]||a[6]!==r[6]||a[7]!==r[7]||a[8]!==r[8]||a[9]!==r[9]||a[10]!==r[10]||a[11]!==r[11]||a[12]!==r[12]||a[13]!==r[13]||a[14]!==r[14]||a[15]!==r[15];h&&(this._context.bindProgram(this),this._context.gl.uniformMatrix4fv(this.getUniformLocation(f),c,r),
void 0===a?this._nameToUniformMatrix4[f]=d._arrayCopy(r):d._arrayAssign(r,a))};d.prototype.assertCompatibleVertexAttributeLocations=function(b){(b=b.locations===this.locations)||console.error("VertexAttributeLocations are incompatible");return b};d._padToThree=function(b){var d=b.toString();1E3>b&&(d=("  "+b).slice(-3));return d};d.prototype._addLineNumbers=function(b){var f=2;return b.replace(/\n/g,function(){return"\n"+d._padToThree(f++)+":"})};d.prototype._loadShader=function(b){var d=35633===
b,c=d?this._vertexShaderSource:this._fragmentShaderSource,a;a="";for(var f in this._defines)a+="#define "+f+" "+this._defines[f]+"\n";a+=c;"webgl2"===this._context.contextVersion&&(a=q.transpileShader(a,d?"vertex":"fragment"));f=this._context.gl;b=f.createShader(b);f.shaderSource(b,a);f.compileShader(b);f.getShaderParameter(b,f.COMPILE_STATUS)||(console.error("Compile error in ".concat(d?"vertex":"fragment"," shader")),console.error(f.getShaderInfoLog(b)),console.error(this._addLineNumbers(a)),"webgl2"===
this._context.contextVersion&&(console.log("Shader source before transpilation:"),console.log(c)));return b};d._arrayCopy=function(b){for(var d=[],c=0;c<b.length;++c)d.push(b[c]);return d};d._arrayAssign=function(b,d){for(var c=0;c<b.length;++c)d[c]=b[c]};d._nextId=0;return d}()})},"esri/views/webgl/ShaderTranspiler":function(){define(["require","exports","./reservedWordsGLSL3","./lib/glsl-tokenizer/string"],function(z,d,t,l){function q(b){return b.map(function(c){return"eof"!==c.type?c.data:""}).join("")}
function b(d,c,a,f){f=f||a;for(var h=0;h<d.length;h++){var m=d[h];if("ident"===m.type&&m.data===a)return f in c?c[f]++:c[f]=0,b(d,c,f+"_"+c[f],f)}return a}function f(b,c,a){void 0===a&&(a="afterVersion");var d={data:"\n",type:"whitespace"},f=function(a){return a<b.length?/[^\r\n]$/.test(b[a].data):!1},h=function(c){for(var b=-1,d=0,f=-1,h=0;h<c.length;h++){var m=c[h];"preprocessor"===m.type&&(m.data.match(/\#(if|ifdef|ifndef)\s+.+/)?++d:m.data.match(/\#endif\s*.*/)&&--d);("afterVersion"===a||"afterPrecision"===
a)&&"preprocessor"===m.type&&/^#version/.test(m.data)&&(f=Math.max(f,h));if("afterPrecision"===a&&"keyword"===m.type&&"precision"===m.data){a:{for(m=h;m<c.length;m++){var l=c[m];if("operator"===l.type&&";"===l.data)break a}m=null}if(null===m)throw Error("precision statement not followed by any semicolons!");f=Math.max(f,m)}b<f&&0===d&&(b=h)}return b+1}(b);f(h-1)&&b.splice(h++,0,d);for(var l=0;l<c.length;l++){var r=c[l];b.splice(h++,0,r)}f(h-1)&&f(h)&&b.splice(h,0,d)}Object.defineProperty(d,"__esModule",
{value:!0});var h=["GL_OES_standard_derivatives","GL_EXT_frag_depth","GL_EXT_draw_buffers","GL_EXT_shader_texture_lod"];d.transpileShader=function(d,c){d=l(d);var a;a:{a="100";var m="300 es";void 0===a&&(a="100");void 0===m&&(m="300 es");for(var r=/^\s*\#version\s+([0-9]+(\s+[a-zA-Z]+)?)\s*/,D=0;D<d.length;D++){var w=d[D];if("preprocessor"===w.type){var v=r.exec(w.data);if(v){r=v[1].replace(/\s\s+/g," ");if(r===m){a=r;break a}if(r===a){w.data="#version "+m;break a}throw Error("unknown glsl version: "+
r);}}}d.splice(0,0,{type:"preprocessor",data:"#version "+m},{type:"whitespace",data:"\n"});a=null}if("300 es"===a)throw Error("shader is already glsl 300 es");r=w=null;D={};v={};for(a=0;a<d.length;++a)switch(m=d[a],m.type){case "keyword":"vertex"===c&&"attribute"===m.data?m.data="in":"varying"===m.data&&(m.data="vertex"===c?"out":"in");break;case "builtin":/^texture(2D|Cube)(Proj)?(Lod|Grad)?(EXT)?$/.test(m.data.trim())&&(m.data=m.data.replace(/(2D|Cube|EXT)/g,""));if("fragment"===c&&"gl_FragColor"===
m.data){if(!w){var w=b(d,D,"fragColor"),E=void 0;void 0===E&&(E="lowp");f(d,[{type:"keyword",data:"out"},{type:"whitespace",data:" "},{type:"keyword",data:E},{type:"whitespace",data:" "},{type:"keyword",data:"vec4"},{type:"whitespace",data:" "},{type:"ident",data:w},{type:"operator",data:";"}],"afterPrecision")}m.data=w}else"fragment"===c&&"gl_FragDepthEXT"===m.data&&(r||(r=b(d,D,"gl_FragDepth")),m.data=r);break;case "ident":if(0<=t.indexOf(m.data)){if(E="vertex"===c)a:{for(E=a-1;0<=E;E--){var C=
d[E];if("whitespace"!==C.type&&"block-comment"!==C.type)if("keyword"===C.type){if("attribute"===C.data||"in"===C.data){E=!0;break a}}else break}E=!1}if(E)throw Error("attribute in vertex shader uses a name that is a reserved word in glsl 300 es");m.data in v||(v[m.data]=b(d,D,m.data));m.data=v[m.data]}}for(a=d.length-1;0<=a;--a)m=d[a],"preprocessor"===m.type&&((c=m.data.match(/\#extension\s+(.*)\:/))&&c[1]&&0<=h.indexOf(c[1].trim())&&(c=d[a+1],d.splice(a,c&&"whitespace"===c.type?2:1)),(c=m.data.match(/\#ifdef\s+(.*)/))&&
c[1]&&0<=h.indexOf(c[1].trim())&&(m.data="#if 1"),(c=m.data.match(/\#ifndef\s+(.*)/))&&c[1]&&0<=h.indexOf(c[1].trim())&&(m.data="#if 0"));return q(d)}})},"esri/views/webgl/reservedWordsGLSL3":function(){define(["require","exports"],function(z,d){return"layout centroid smooth case mat2x2 mat2x3 mat2x4 mat3x2 mat3x3 mat3x4 mat4x2 mat4x3 mat4x4 uint uvec2 uvec3 uvec4 samplerCubeShadow sampler2DArray sampler2DArrayShadow isampler2D isampler3D isamplerCube isampler2DArray usampler2D usampler3D usamplerCube usampler2DArray coherent restrict readonly writeonly resource atomic_uint noperspective patch sample subroutine common partition active filter image1D image2D image3D imageCube iimage1D iimage2D iimage3D iimageCube uimage1D uimage2D uimage3D uimageCube image1DArray image2DArray iimage1DArray iimage2DArray uimage1DArray uimage2DArray image1DShadow image2DShadow image1DArrayShadow image2DArrayShadow imageBuffer iimageBuffer uimageBuffer sampler1DArray sampler1DArrayShadow isampler1D isampler1DArray usampler1D usampler1DArray isampler2DRect usampler2DRect samplerBuffer isamplerBuffer usamplerBuffer sampler2DMS isampler2DMS usampler2DMS sampler2DMSArray isampler2DMSArray usampler2DMSArray trunc round roundEven isnan isinf floatBitsToInt floatBitsToUint intBitsToFloat uintBitsToFloat packSnorm2x16 unpackSnorm2x16 packUnorm2x16 unpackUnorm2x16 packHalf2x16 unpackHalf2x16 outerProduct transpose determinant inverse texture textureSize textureProj textureLod textureOffset texelFetch texelFetchOffset textureProjOffset textureLodOffset textureProjLod textureProjLodOffset textureGrad textureGradOffset textureProjGrad textureProjGradOffset".split(" ")})},
"esri/views/webgl/lib/glsl-tokenizer/string":function(){define(["./index"],function(z){"use strict;";return function(d){var t=z(),l=[],l=l.concat(t(d));return l=l.concat(t(null))}})},"esri/views/webgl/lib/glsl-tokenizer/index":function(){define(["./lib/literals","./lib/operators","./lib/builtins"],function(z,d,t){"use strict;";var l="block-comment line-comment preprocessor operator integer float ident builtin keyword whitespace eof integer".split(" ");return function(){function q(a){a.length&&C.push({type:l[D],
data:a,position:G,line:J,column:K})}function b(){E=E.length?[]:E;if("/"===v&&"*"===w)return G=u+m-1,D=0,v=w,m+1;if("/"===v&&"/"===w)return G=u+m-1,D=1,v=w,m+1;if("#"===w)return D=2,G=u+m,m;if(/\s/.test(w))return D=9,G=u+m,m;I=/\d/.test(w);x=/[^\w_]/.test(w);G=u+m;D=I?4:x?3:9999;return m}function f(){if(("\r"===w||"\n"===w)&&"\\"!==v)return q(E.join("")),D=999,m;E.push(w);v=w;return m+1}function h(){if("."===v&&/\d/.test(w))return D=5,m;if("/"===v&&"*"===w)return D=0,m;if("/"===v&&"/"===w)return D=
1,m;if("."===w&&E.length){for(;r(E););D=5;return m}if(";"===w||")"===w||"("===w){if(E.length)for(;r(E););q(w);D=999;return m+1}var a=2===E.length&&"\x3d"!==w;if(/[\w_\d\s]/.test(w)||a){for(;r(E););D=999;return m}E.push(w);v=w;return m+1}function r(a){var c=0,b,f;do{b=d.indexOf(a.slice(0,a.length+c).join(""));f=d[b];if(-1===b){if(0<c--+a.length)continue;f=a.slice(0,1).join("")}q(f);G+=f.length;E=E.slice(f.length);return E.length}while(1)}function c(){if("."===w||/[eE]/.test(w))return E.push(w),D=5,
v=w,m+1;if("x"===w&&1===E.length&&"0"===E[0])return D=11,E.push(w),v=w,m+1;if(/[^\d]/.test(w))return q(E.join("")),D=999,m;E.push(w);v=w;return m+1}function a(){"f"===w&&(E.push(w),v=w,m+=1);if(/[eE]/.test(w)||"-"===w&&/[eE]/.test(v))return E.push(w),v=w,m+1;if(/[^\d]/.test(w))return q(E.join("")),D=999,m;E.push(w);v=w;return m+1}var m=0,u=0,D=999,w,v,E=[],C=[],J=1,K=0,G=0,I=!1,x=!1,N="",O;return function(d){C=[];if(null!==d){d=d.replace?d.replace(/\r\n/g,"\n"):d;m=0;N+=d;for(O=N.length;w=N[m],m<
O;){d=m;switch(D){case 0:"/"===w&&"*"===v?(E.push(w),q(E.join("")),D=999):(E.push(w),v=w);m+=1;break;case 1:m=f();break;case 2:m=f();break;case 3:m=h();break;case 4:m=c();break;case 11:/[^a-fA-F0-9]/.test(w)?(q(E.join("")),D=999):(E.push(w),v=w,m+=1);break;case 5:m=a();break;case 9999:if(/[^\d\w_]/.test(w)){var l=E.join("");D=-1<z.indexOf(l)?8:-1<t.indexOf(l)?7:6;q(E.join(""));D=999}else E.push(w),v=w,m+=1;break;case 9:/[^\s]/g.test(w)?(q(E.join("")),D=999):(E.push(w),v=w,m+=1);break;case 999:m=b()}if(d!==
m)switch(N[d]){case "\n":K=0;++J;break;default:++K}}u+=m;N=N.slice(m);return C}E.length&&q(E.join(""));D=10;q("(eof)");return C}}})},"esri/views/webgl/lib/glsl-tokenizer/lib/literals":function(){define([],function(){return"precision highp mediump lowp attribute const uniform varying break continue do for while if else in out inout float int void bool true false discard return mat2 mat3 mat4 vec2 vec3 vec4 ivec2 ivec3 ivec4 bvec2 bvec3 bvec4 sampler1D sampler2D sampler3D samplerCube sampler1DShadow sampler2DShadow struct asm class union enum typedef template this packed goto switch default inline noinline volatile public static extern external interface long short double half fixed unsigned input output hvec2 hvec3 hvec4 dvec2 dvec3 dvec4 fvec2 fvec3 fvec4 sampler2DRect sampler3DRect sampler2DRectShadow sizeof cast namespace using".split(" ")})},
"esri/views/webgl/lib/glsl-tokenizer/lib/operators":function(){define([],function(){"use strict;";return"\x3c\x3c\x3d \x3e\x3e\x3d ++ -- \x3c\x3c \x3e\x3e \x3c\x3d \x3e\x3d \x3d\x3d !\x3d \x26\x26 || +\x3d -\x3d *\x3d /\x3d %\x3d \x26\x3d ^^ ^\x3d |\x3d ( ) [ ] . ! ~ * / % + - \x3c \x3e \x26 ^ | ? : \x3d , ; { }".split(" ")})},"esri/views/webgl/lib/glsl-tokenizer/lib/builtins":function(){define([],function(){return"abs acos all any asin atan ceil clamp cos cross dFdx dFdy degrees distance dot equal exp exp2 faceforward floor fract gl_BackColor gl_BackLightModelProduct gl_BackLightProduct gl_BackMaterial gl_BackSecondaryColor gl_ClipPlane gl_ClipVertex gl_Color gl_DepthRange gl_DepthRangeParameters gl_EyePlaneQ gl_EyePlaneR gl_EyePlaneS gl_EyePlaneT gl_Fog gl_FogCoord gl_FogFragCoord gl_FogParameters gl_FragColor gl_FragCoord gl_FragData gl_FragDepth gl_FragDepthEXT gl_FrontColor gl_FrontFacing gl_FrontLightModelProduct gl_FrontLightProduct gl_FrontMaterial gl_FrontSecondaryColor gl_LightModel gl_LightModelParameters gl_LightModelProducts gl_LightProducts gl_LightSource gl_LightSourceParameters gl_MaterialParameters gl_MaxClipPlanes gl_MaxCombinedTextureImageUnits gl_MaxDrawBuffers gl_MaxFragmentUniformComponents gl_MaxLights gl_MaxTextureCoords gl_MaxTextureImageUnits gl_MaxTextureUnits gl_MaxVaryingFloats gl_MaxVertexAttribs gl_MaxVertexTextureImageUnits gl_MaxVertexUniformComponents gl_ModelViewMatrix gl_ModelViewMatrixInverse gl_ModelViewMatrixInverseTranspose gl_ModelViewMatrixTranspose gl_ModelViewProjectionMatrix gl_ModelViewProjectionMatrixInverse gl_ModelViewProjectionMatrixInverseTranspose gl_ModelViewProjectionMatrixTranspose gl_MultiTexCoord0 gl_MultiTexCoord1 gl_MultiTexCoord2 gl_MultiTexCoord3 gl_MultiTexCoord4 gl_MultiTexCoord5 gl_MultiTexCoord6 gl_MultiTexCoord7 gl_Normal gl_NormalMatrix gl_NormalScale gl_ObjectPlaneQ gl_ObjectPlaneR gl_ObjectPlaneS gl_ObjectPlaneT gl_Point gl_PointCoord gl_PointParameters gl_PointSize gl_Position gl_ProjectionMatrix gl_ProjectionMatrixInverse gl_ProjectionMatrixInverseTranspose gl_ProjectionMatrixTranspose gl_SecondaryColor gl_TexCoord gl_TextureEnvColor gl_TextureMatrix gl_TextureMatrixInverse gl_TextureMatrixInverseTranspose gl_TextureMatrixTranspose gl_Vertex greaterThan greaterThanEqual inversesqrt length lessThan lessThanEqual log log2 matrixCompMult max min mix mod normalize not notEqual pow radians reflect refract sign sin smoothstep sqrt step tan texture2D texture2DLod texture2DProj texture2DProjLod textureCube textureCubeLod texture2DLodEXT texture2DProjLodEXT textureCubeLodEXT texture2DGradEXT texture2DProjGradEXT textureCubeGradEXT".split(" ")})},
"esri/views/webgl/renderState":function(){define(["require","exports","../../core/tsSupport/assignHelper"],function(z,d,t){function l(a){return G.intern(a)}function q(a){return I.intern(a)}function b(a){return x.intern(a)}function f(a){return N.intern(a)}function h(a){return O.intern(a)}function r(a){return P.intern(a)}function c(a){return S.intern(a)}function a(a){return R.intern(a)}function m(a){return"["+a.join(",")+"]"}function u(a){return a?m([a.srcRgb,a.srcAlpha,a.dstRgb,a.dstAlpha,a.opRgb,
a.opAlpha,a.color.r,a.color.g,a.color.b,a.color.a]):null}function D(a){return a?m([a.face,a.mode]):null}function w(a){return a?m([a.factor,a.units]):null}function v(a){return a?m([a.func]):null}function E(a){return a?m([a.function.func,a.function.ref,a.function.mask,a.operation.fail,a.operation.zFail,a.operation.zPass]):null}function C(a){return a?m([a.zNear,a.zFar]):null}function J(a){return a?m([a.r,a.g,a.b,a.a]):null}function K(a){return a?m([a.mask]):null}Object.defineProperty(d,"__esModule",
{value:!0});d.simpleBlendingParams=function(a,c,b,d){void 0===b&&(b=32774);void 0===d&&(d=[0,0,0,0]);return{srcRgb:a,srcAlpha:a,dstRgb:c,dstAlpha:c,opRgb:b,opAlpha:b,color:{r:d[0],g:d[1],b:d[2],a:d[3]}}};d.separateBlendingParams=function(a,c,b,d,f,h,p){void 0===f&&(f=32774);void 0===h&&(h=32774);void 0===p&&(p=[0,0,0,0]);return{srcRgb:a,srcAlpha:c,dstRgb:b,dstAlpha:d,opRgb:f,opAlpha:h,color:{r:p[0],g:p[1],b:p[2],a:p[3]}}};d.backFaceCullingParams={face:1029,mode:2305};d.defaultDepthWriteParams={zNear:0,
zFar:1};d.defaultColorWriteParams={r:!0,g:!0,b:!0,a:!0};d.makeBlending=l;d.makeCulling=q;d.makePolygonOffset=b;d.makeDepthTest=f;d.makeStencilTest=h;d.makeDepthWrite=r;d.makeColorWrite=c;d.makeStencilWrite=a;d.makePipelineState=function(a){return Q.intern(a)};z=function(){function a(a,c){this.makeKey=a;this.makeRef=c;this.interns=new Map}a.prototype.intern=function(a){if(!a)return null;var c=this.makeKey(a),b=this.interns;b.has(c)||b.set(c,this.makeRef(a));return b.get(c)};return a}();var G=new z(u,
function(a){return t({__tag:"Blending"},a)}),I=new z(D,function(a){return t({__tag:"Culling"},a)}),x=new z(w,function(a){return t({__tag:"PolygonOffset"},a)}),N=new z(v,function(a){return t({__tag:"DepthTest"},a)}),O=new z(E,function(a){return t({__tag:"StencilTest"},a)}),P=new z(C,function(a){return t({__tag:"DepthWrite"},a)}),S=new z(J,function(a){return t({__tag:"ColorWrite"},a)}),R=new z(K,function(a){return t({__tag:"StencilWrite"},a)}),Q=new z(function(a){return a?m([u(a.blending),D(a.culling),
w(a.polygonOffset),v(a.depthTest),E(a.stencilTest),C(a.depthWrite),J(a.colorWrite),K(a.stencilWrite)]):null},function(d){return{blending:l(d.blending),culling:q(d.culling),polygonOffset:b(d.polygonOffset),depthTest:f(d.depthTest),stencilTest:h(d.stencilTest),depthWrite:r(d.depthWrite),colorWrite:c(d.colorWrite),stencilWrite:a(d.stencilWrite)}});z=function(){function a(a){this._stencilWriteInvalid=this._colorWriteInvalid=this._depthWriteInvalid=this._stencilTestInvalid=this._depthTestInvalid=this._polygonOffsetInvalid=
this._cullingInvalid=this._blendingInvalid=this._pipelineInvalid=!0;this._stateSetters=a}a.prototype.setPipeline=function(a){if(this._pipelineInvalid||a!==this._pipeline)this.setBlending(a.blending),this.setCulling(a.culling),this.setPolygonOffset(a.polygonOffset),this.setDepthTest(a.depthTest),this.setStencilTest(a.stencilTest),this.setDepthWrite(a.depthWrite),this.setColorWrite(a.colorWrite),this.setStencilWrite(a.stencilWrite),this._pipeline=a;this._pipelineInvalid=!1};a.prototype.invalidateBlending=
function(){this._pipelineInvalid=this._blendingInvalid=!0};a.prototype.invalidateCulling=function(){this._pipelineInvalid=this._cullingInvalid=!0};a.prototype.invalidatePolygonOffset=function(){this._pipelineInvalid=this._polygonOffsetInvalid=!0};a.prototype.invalidateDepthTest=function(){this._pipelineInvalid=this._depthTestInvalid=!0};a.prototype.invalidateStencilTest=function(){this._pipelineInvalid=this._stencilTestInvalid=!0};a.prototype.invalidateDepthWrite=function(){this._pipelineInvalid=
this._depthWriteInvalid=!0};a.prototype.invalidateColorWrite=function(){this._pipelineInvalid=this._colorWriteInvalid=!0};a.prototype.invalidateStencilWrite=function(){this._pipelineInvalid=this._stencilTestInvalid=!0};a.prototype.setBlending=function(a){this._blending=this.setSubState(a,this._blending,this._blendingInvalid,this._stateSetters.setBlending);this._blendingInvalid=!1};a.prototype.setCulling=function(a){this._culling=this.setSubState(a,this._culling,this._cullingInvalid,this._stateSetters.setCulling);
this._cullingInvalid=!1};a.prototype.setPolygonOffset=function(a){this._polygonOffset=this.setSubState(a,this._polygonOffset,this._polygonOffsetInvalid,this._stateSetters.setPolygonOffset);this._polygonOffsetInvalid=!1};a.prototype.setDepthTest=function(a){this._depthTest=this.setSubState(a,this._depthTest,this._depthTestInvalid,this._stateSetters.setDepthTest);this._depthTestInvalid=!1};a.prototype.setStencilTest=function(a){this._stencilTest=this.setSubState(a,this._stencilTest,this._stencilTestInvalid,
this._stateSetters.setStencilTest);this._stencilTestInvalid=!1};a.prototype.setDepthWrite=function(a){this._depthWrite=this.setSubState(a,this._depthWrite,this._depthWriteInvalid,this._stateSetters.setDepthWrite);this._depthWriteInvalid=!1};a.prototype.setColorWrite=function(a){this._colorWrite=this.setSubState(a,this._colorWrite,this._colorWriteInvalid,this._stateSetters.setColorWrite);this._colorWriteInvalid=!1};a.prototype.setStencilWrite=function(a){this._stencilWrite=this.setSubState(a,this._stencilWrite,
this._stencilWriteInvalid,this._stateSetters.setStencilWrite);this._stencilTestInvalid=!1};a.prototype.setSubState=function(a,c,b,d){if(b||a!==c)d(a),this._pipelineInvalid=!0;return a};return a}();d.StateTracker=z})},"esri/views/3d/webgl-engine/materials/internal/waterMaterialUtils":function(){define("require exports ../../../../../core/Logger ../../../../../core/promiseUtils ../../../../../core/libs/gl-matrix-2/vec2f64 ../../../support/imageUtils ../../../../webgl/Texture".split(" "),function(z,
d,t,l,q,b,f){Object.defineProperty(d,"__esModule",{value:!0});var h=t.getLogger("esri.views.3d.webgl-engine.materials.internal.waterMaterialUtils");d.waveAndPertubationTextureUrls=[z.toUrl("../../../../../images/materials/water/normals.jpg"),z.toUrl("../../../../../images/materials/water/perturbation.jpg")];d.defaultWaterMaterialParameters={waveStrength:.06,waveTextureRepeat:32,waveDirection:q.vec2f64.fromValues(1,0),waveVelocity:.05,flowStrength:.015,flowOffset:-.5,animationSpeed:.35,color:[0,.35686,
.4,1],transparent:!1,writeDepth:!0,slicePlaneEnabled:!1,isDraped:!1,receiveShadows:!0};d.wavePresets={"calm-small":{waveStrength:.005,perturbationStrength:.02,textureRepeat:12,waveVelocity:.01},"rippled-small":{waveStrength:.02,perturbationStrength:.09,textureRepeat:32,waveVelocity:.07},"slight-small":{waveStrength:.05,perturbationStrength:.07,textureRepeat:28,waveVelocity:.1},"moderate-small":{waveStrength:.075,perturbationStrength:.07,textureRepeat:24,waveVelocity:.1},"calm-medium":{waveStrength:.003125,
perturbationStrength:.01,textureRepeat:8,waveVelocity:.02},"rippled-medium":{waveStrength:.035,perturbationStrength:.015,textureRepeat:12,waveVelocity:.07},"slight-medium":{waveStrength:.06,perturbationStrength:.015,textureRepeat:8,waveVelocity:.12},"moderate-medium":{waveStrength:.09,perturbationStrength:.03,textureRepeat:4,waveVelocity:.12},"calm-large":{waveStrength:.01,perturbationStrength:0,textureRepeat:4,waveVelocity:.05},"rippled-large":{waveStrength:.025,perturbationStrength:.01,textureRepeat:8,
waveVelocity:.11},"slight-large":{waveStrength:.06,perturbationStrength:.02,textureRepeat:3,waveVelocity:.13},"moderate-large":{waveStrength:.14,perturbationStrength:.03,textureRepeat:2,waveVelocity:.15}};z=function(){function r(){this.loadingState=0;this.data=[]}r.prototype.getTextureProps=function(c,a,b){void 0===b&&(b=!1);return{target:3553,pixelFormat:6408,dataType:5121,wrapMode:10497,samplingMode:9987,hasMipmap:b,maxAnisotropy:8,width:c,height:a}};r.prototype.ready=function(){return 2===this.loadingState};
r.prototype.loading=function(){return 1===this.loadingState};r.prototype.initialize=function(c){var a=this;this.loadingState=1;l.all(d.waveAndPertubationTextureUrls.map(function(a){return b.requestImage(a)})).then(function(b){b.forEach(function(b,d){a.data[d]=new f(c,a.getTextureProps(b.width,b.height,!0),b)});a.loadingState=2}).catch(function(c){h.error("Failed to load textures for water material.",c);a.loadingState=0})};r.prototype.bindRepo=function(c){for(var a=0;a<this.data.length;a++)c.bindTexture(this.data[a],
a)};return r}();d.waterTextureRepo=new z})},"esri/views/3d/support/imageUtils":function(){define(["require","exports","../../../core/tsSupport/assignHelper","../../../request"],function(z,d,t,l){Object.defineProperty(d,"__esModule",{value:!0});d.dataURItoBlob=function(d){var b=atob(d.split(",")[1]);d=d.split(",")[0].split(":")[1].split(";")[0];for(var f=new ArrayBuffer(b.length),h=new Uint8Array(f),l=0;l<b.length;l++)h[l]=b.charCodeAt(l);return new Blob([f],{type:d})};d.requestImage=function(d,b){return l(d,
t({responseType:"image"},b)).then(function(b){return b.data})}})},"esri/views/3d/webgl-engine/materials/renderers/Instance":function(){define(["require","exports","../../../../../core/libs/gl-matrix-2/mat4","../../../../../core/libs/gl-matrix-2/mat4f64"],function(z,d,t,l){Object.defineProperty(d,"__esModule",{value:!0});z=function(){return function(d,b,f,h,r,c,a){this.from=d;this.to=b;this.isHidden=f;this.highlightedIndexRanges=h;this.hasOccludees=r;this.transformation=c;this.instanceParameters=a;
null!=c&&(this.transformationNormal=l.mat4f64.clone(c),t.mat4.invert(this.transformationNormal,this.transformationNormal),t.mat4.transpose(this.transformationNormal,this.transformationNormal))}}();d.Instance=z})},"esri/views/3d/webgl-engine/materials/renderers/utils":function(){define("require exports ../../../../../core/maybe ../../../../../core/libs/gl-matrix-2/mat4 ../../../../../core/libs/gl-matrix-2/mat4f64 ../../lib/ComponentUtils ../../lib/doublePrecisionUtils ../../lib/Util ../../../../webgl/Util".split(" "),
function(z,d,t,l,q,b,f,h,r){Object.defineProperty(d,"__esModule",{value:!0});d.checkIsHidden=function(a){return a.instanceParameters.hidden||b.generateVisibleIndexRanges(a.instanceParameters.componentVisibilities,a.componentOffsets)?!0:!1};d.generateRenderGeometryHighlightRanges=function(a){return a.instanceParameters.hidden?null:b.generateHighlightedIndexRanges(a.instanceParameters.componentVisibilities,a.instanceParameters.componentHighlights,a.componentOffsets)};d.doesRenderGeometryHaveHighlights=
function(a){return a.instanceParameters.hidden?!1:b.hasHighlights(a.instanceParameters.componentVisibilities,a.instanceParameters.componentHighlights,a.componentOffsets)};d.isRenderGeometryHidden=function(a){return a.instanceParameters.hidden?!0:b.isAllHidden(a.instanceParameters.componentVisibilities,a.componentOffsets)};d.drawArrays=function(a,c,b,d,f){a.drawArrays(c,b,d);f&&(f.drawCalls++,4===c&&(f.triangles+=d))};d.drawElements=function(a,c,b,d,f,h){var m=r.getBytesPerElement(b);a.drawElements(c,
f,b,d*m);h&&(h.drawCalls++,4===c&&(h.triangles+=f))};d.drawArraysFaceRange=function(a,c,b,d,f){for(var h=0,m=0;m<c.length;m++){var l=c[m],r=l[0]+b,l=l[1]-l[0]+1,h=h+l;a.drawArrays(d,r,l)}f&&(f.drawCalls+=c.length,4===d&&(f.triangles=h/3))};d.drawElementsFaceRange=function(a,c,b,d,f,h){for(var m=r.getBytesPerElement(f),l=0,q=0;q<c.length;q++){var u=c[q],t=u[0]+b,u=u[1]-u[0]+1,l=l+u;a.drawElements(d,u,f,t*m)}h&&(h.drawCalls+=c.length,4===d&&(h.triangles+=l/3))};d.acquireMaterials=function(a,c){var b=
new Map;b.set(0,c.acquire(a,0));b.set(3,c.acquire(a,3));b.set(2,c.acquire(a,2));b.set(1,c.acquire(a,1));b.set(4,c.acquire(a,4));return b};d.releaseMaterials=function(a,c){c.release(a,0);c.release(a,3);c.release(a,2);c.release(a,1);c.release(a,4)};d.calculateTransformRelToOrigin=function(a,c,b){var d=a.origin.vec3;h.setMatrixTranslation3(m,-d[0],-d[1],-d[2]);t.isSome(a.transformation)?l.mat4.multiply(c,m,a.transformation):l.mat4.copy(c,m);b&&(l.mat4.invert(b,c),l.mat4.transpose(b,b))};d.encodeDoubleVec3=
function(b,d,h,m,l){c[0]=b.get(d,0);c[1]=b.get(d,1);c[2]=b.get(d,2);f.encodeDoubleArray(c,a,3);h.set(l,0,a[0]);m.set(l,0,a[1]);h.set(l,1,a[2]);m.set(l,1,a[3]);h.set(l,2,a[4]);m.set(l,2,a[5])};var c=new Float64Array(3),a=new Float32Array(6),m=q.mat4f64.create()})},"esri/views/3d/webgl-engine/lib/doublePrecisionUtils":function(){define(["require","exports"],function(z,d){function t(b,d,h){for(var f=0;f<h;++f)d[2*f]=b[f],d[2*f+1]=b[f]-d[2*f]}Object.defineProperty(d,"__esModule",{value:!0});d.encodeDouble=
function(b,d){q[0]=b;q[1]=b-q[0];d[0]=q[0];d[1]=q[1]};d.encodeDoubleArray=t;d.decodeDoubleArray=function(b,d,h){for(var f=0;f<h;++f)d[f]=b[2*f]+b[2*f+1]};d.encodeDoubleArraySplit=function(b,d,h,r){for(var c=0;c<r;++c)l[0]=b[c],t(l,q,1),d[c]=q[0],h[c]=q[1]};var l=new Float64Array(1),q=new Float32Array(2)})},"esri/views/3d/webgl-engine/shaders/RibbonLineTechnique":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/tsSupport/assignHelper ../../../../core/maybe ../../../../core/maybe ../core/shaderLibrary/Slice.glsl ../core/shaderLibrary/Transform.glsl ../core/shaderLibrary/output/OutputHighlight.glsl ../core/shaderLibrary/shading/VisualVariables.glsl ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../core/shaderTechnique/ShaderTechniqueConfiguration ../lib/StencilUtils ./RibbonLine.glsl ../../../webgl/Program ../../../webgl/renderState".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u,D,w,v,E,C){Object.defineProperty(d,"__esModule",{value:!0});d.RibbonVertexAttributeConstants={POSITION:"position",SUBDIVISIONFACTOR:"subdivisionFactor",UV0:"uv0",AUXPOS1:"auxpos1",AUXPOS2:"auxpos2",SUBDIVISIONS:"subdivisions",COLOR:"color",COLORFEATUREATTRIBUTE:"colorFeatureAttribute",SIZE:"size",SIZEFEATUREATTRIBUTE:"sizeFeatureAttribute",OPACITYFEATUREATTRIBUTE:"opacityFeatureAttribute"};d.ribbonVertexAttributeLocations={position:0,subdivisionFactor:1,uv0:2,auxpos1:3,
auxpos2:4,size:6,sizeFeatureAttribute:6,color:5,colorFeatureAttribute:5,opacityFeatureAttribute:7};q=function(l){function q(a,c){c=l.call(this,a,c)||this;c.stipplePattern=null;c.stippleTextureBind=null;c.stippleTextureRepository=a.stippleTextureRepository;return c}t(q,l);q.prototype.initializeProgram=function(a){var c=q.shader.get(),b=this.configuration,c=c.build({output:b.output,slicePlaneEnabled:b.slicePlaneEnabled,sliceHighlightDisabled:b.sliceHighlightDisabled,sliceEnabledForVertexPrograms:!1,
stippleEnabled:b.stippleEnabled,stippleOffColorEnabled:b.stippleOffColorEnabled,stippleUVMaxEnabled:b.stippleIntegerRepeatsEnabled,stippleIntegerRepeatsEnabled:b.stippleIntegerRepeatsEnabled,roundCaps:b.roundCaps,roundJoins:b.roundJoins,vvColor:b.vvColor,vvSize:b.vvSize,vvInstancingEnabled:!0,vvOpacity:b.vvOpacity,falloffEnabled:b.falloffEnabled,innerColorEnabled:b.innerColorEnabled});return new E(a.rctx,c.generateSource("vertex"),c.generateSource("fragment"),d.ribbonVertexAttributeLocations)};q.prototype.dispose=
function(){l.prototype.dispose.call(this);this.stippleTextureRepository.release(this.stipplePattern);this.stippleTextureBind=this.stipplePattern=null};q.prototype.bindPass=function(d,h,m){4===this.configuration.output&&c.OutputHighlight.bindOutputHighlight(d,this.program,m);this.program.setUniform1f("intrinsicWidth",h.width);this.program.setUniform4fv("intrinsicColor",h.color);this.program.setUniform1f("miterLimit","miter"!==h.join?0:h.miterLimit);this.program.setUniform1f("nearPlane",m.nearFar[0]);
this.program.setUniform1f("pixelRatio",m.pixelRatio);this.program.setUniform2fv("screenSize",[m.viewport[2],m.viewport[3]]);a.VisualVariables.bindUniformsWithOpacity(this.program,h);if(this.stipplePattern!==h.stipplePattern){var l=h.stipplePattern;this.stippleTextureBind=this.stippleTextureRepository.swap(this.stipplePattern,l);this.stipplePattern=l}this.configuration.stippleEnabled&&(d=f.isSome(this.stippleTextureBind)?this.stippleTextureBind(d,0)*m.pixelRatio:1,this.program.setUniform1i("stipplePatternTexture",
0),this.program.setUniform1f("stipplePatternPixelSizeInv",1/d),this.configuration.stippleOffColorEnabled&&(d=b.expect(h.stippleOffColor),this.program.setUniform4f("stippleOffColor",d[0],d[1],d[2],3<d.length?d[3]:1)));this.configuration.falloffEnabled&&this.program.setUniform1f("falloff",h.falloff);this.configuration.innerColorEnabled&&(this.program.setUniform4fv("innerColor",b.unwrapOr(h.innerColor,h.color)),this.program.setUniform1f("innerWidth",h.innerWidth*m.pixelRatio))};q.prototype.bindDraw=
function(a){r.Transform.bindUniforms(this.program,a);h.Slice.bindUniformsWithOrigin(this.program,this.configuration,a)};q.prototype.initializePipeline=function(){var a=this.configuration,c=C.separateBlendingParams(770,1,771,771),b=a.polygonOffset&&J;a.occluder&&(this._occluderPipelineTransparent=C.makePipelineState({blending:c,polygonOffset:b,depthTest:w.depthCompareAlways,depthWrite:null,colorWrite:C.defaultColorWriteParams,stencilWrite:null,stencilTest:w.stencilToolTransparentOccluderParams}),this._occluderPipelineOpaque=
C.makePipelineState({polygonOffset:b,depthTest:w.depthCompareAlways,depthWrite:null,colorWrite:C.defaultColorWriteParams,stencilWrite:w.stencilWriteMaskOff,stencilTest:w.stencilToolMaskOccluderParams}),this._occluderPipelineMaskWrite=C.makePipelineState({polygonOffset:b,depthTest:w.depthCompareLess,depthWrite:null,colorWrite:null,stencilWrite:w.stencilWriteMaskOn,stencilTest:w.stencilToolMaskBaseParams}));if(0===a.output){var d=function(d){return C.makePipelineState({blending:c,polygonOffset:b,depthTest:w.depthCompareLess,
depthWrite:!a.transparent&&a.writeDepth&&C.defaultDepthWriteParams,colorWrite:C.defaultColorWriteParams,stencilWrite:a.sceneHasOcludees?w.stencilWriteMaskOn:null,stencilTest:a.sceneHasOcludees?d?w.stencilToolMaskBaseParams:a.sceneHasOcludees?w.stencilBaseAllZerosParams:null:null})};this._occludeePipeline=d(!0);return d(!1)}return C.makePipelineState({polygonOffset:b,depthTest:w.depthCompareLess,depthWrite:!a.transparent&&a.writeDepth&&C.defaultDepthWriteParams,colorWrite:C.defaultColorWriteParams})};
Object.defineProperty(q.prototype,"occluderPipelineTransparent",{get:function(){return this._occluderPipelineTransparent},enumerable:!0,configurable:!0});Object.defineProperty(q.prototype,"occluderPipelineOpaque",{get:function(){return this._occluderPipelineOpaque},enumerable:!0,configurable:!0});Object.defineProperty(q.prototype,"occludeePipeline",{get:function(){return this._occludeePipeline},enumerable:!0,configurable:!0});Object.defineProperty(q.prototype,"occluderPipelineMaskWrite",{get:function(){return this._occluderPipelineMaskWrite},
enumerable:!0,configurable:!0});Object.defineProperty(q.prototype,"primitiveType",{get:function(){return 5},enumerable:!0,configurable:!0});q.shader=new m.ReloadableShaderModule(v,"./RibbonLine.glsl",z);return q}(u.ShaderTechnique);d.RibbonLineTechnique=q;var J={factor:0,units:-4};q=function(a){function c(){var c=null!==a&&a.apply(this,arguments)||this;c.output=0;c.occluder=!1;c.slicePlaneEnabled=!1;c.sliceHighlightDisabled=!1;c.vertexColors=!1;c.transparent=!1;c.polygonOffset=!1;c.writeDepth=!1;
c.stippleEnabled=!1;c.stippleOffColorEnabled=!1;c.stippleIntegerRepeatsEnabled=!1;c.roundCaps=!1;c.roundJoins=!1;c.vvSize=!1;c.vvColor=!1;c.vvOpacity=!1;c.falloffEnabled=!1;c.innerColorEnabled=!1;c.sceneHasOcludees=!1;return c}t(c,a);l([D.parameter({count:7})],c.prototype,"output",void 0);l([D.parameter()],c.prototype,"occluder",void 0);l([D.parameter()],c.prototype,"slicePlaneEnabled",void 0);l([D.parameter()],c.prototype,"sliceHighlightDisabled",void 0);l([D.parameter()],c.prototype,"vertexColors",
void 0);l([D.parameter()],c.prototype,"transparent",void 0);l([D.parameter()],c.prototype,"polygonOffset",void 0);l([D.parameter()],c.prototype,"writeDepth",void 0);l([D.parameter()],c.prototype,"stippleEnabled",void 0);l([D.parameter()],c.prototype,"stippleOffColorEnabled",void 0);l([D.parameter()],c.prototype,"stippleIntegerRepeatsEnabled",void 0);l([D.parameter()],c.prototype,"roundCaps",void 0);l([D.parameter()],c.prototype,"roundJoins",void 0);l([D.parameter()],c.prototype,"vvSize",void 0);l([D.parameter()],
c.prototype,"vvColor",void 0);l([D.parameter()],c.prototype,"vvOpacity",void 0);l([D.parameter()],c.prototype,"falloffEnabled",void 0);l([D.parameter()],c.prototype,"innerColorEnabled",void 0);l([D.parameter()],c.prototype,"sceneHasOcludees",void 0);return c}(D.ShaderTechniqueConfiguration);d.RibbonLineTechniqueConfiguration=q})},"esri/views/3d/webgl-engine/core/shaderLibrary/output/OutputHighlight.glsl":function(){define(["require","exports","../../../../../../core/tsSupport/makeTemplateObjectHelper",
"../../shaderModules/interfaces"],function(z,d,t,l){function q(d){d.fragment.uniforms.add("depthTex","sampler2D");d.fragment.uniforms.add("highlightViewportPixelSz","vec4");d.fragment.code.add(l.glsl(b||(b=t(["\n    void outputHighlight() {\n      vec4 fragCoord \x3d gl_FragCoord;\n\n      float sceneDepth \x3d texture2D(depthTex, (fragCoord.xy - highlightViewportPixelSz.xy) * highlightViewportPixelSz.zw).r;\n      if (fragCoord.z \x3e sceneDepth + 5e-7) {\n        gl_FragColor \x3d vec4(1.0, 1.0, 0.0, 1.0);\n      }\n      else {\n        gl_FragColor \x3d vec4(1.0, 0.0, 1.0, 1.0);\n      }\n    }\n  "],
["\n    void outputHighlight() {\n      vec4 fragCoord \x3d gl_FragCoord;\n\n      float sceneDepth \x3d texture2D(depthTex, (fragCoord.xy - highlightViewportPixelSz.xy) * highlightViewportPixelSz.zw).r;\n      if (fragCoord.z \x3e sceneDepth + 5e-7) {\n        gl_FragColor \x3d vec4(1.0, 1.0, 0.0, 1.0);\n      }\n      else {\n        gl_FragColor \x3d vec4(1.0, 0.0, 1.0, 1.0);\n      }\n    }\n  "]))))}Object.defineProperty(d,"__esModule",{value:!0});d.OutputHighlight=q;(function(b){b.bindOutputHighlight=
function(b,d,c){b.bindTexture(c.highlightDepthTexture,5);d.setUniform1i("depthTex",5);d.setUniform4f("highlightViewportPixelSz",0,0,1/c.viewport[2],1/c.viewport[3])}})(q=d.OutputHighlight||(d.OutputHighlight={}));var b})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/VisualVariables.glsl":function(){define(["require","exports","../../../../../../core/tsSupport/makeTemplateObjectHelper","../../shaderModules/interfaces"],function(z,d,t,l){function q(d,q){q.vvInstancingEnabled&&(q.vvSize||q.vvColor)&&
d.attributes.add("instanceFeatureAttribute","vec4");q.vvSize?(d.vertex.uniforms.add("vvSizeMinSize","vec3"),d.vertex.uniforms.add("vvSizeMaxSize","vec3"),d.vertex.uniforms.add("vvSizeOffset","vec3"),d.vertex.uniforms.add("vvSizeFactor","vec3"),d.vertex.uniforms.add("vvSymbolRotationMatrix","mat3"),d.vertex.uniforms.add("vvSymbolAnchor","vec3"),d.vertex.code.add(l.glsl(b||(b=t(["\n      vec3 vvScale(vec4 _featureAttribute) {\n        return clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize);\n      }\n\n      vec4 vvTransformPosition(vec3 position, vec4 _featureAttribute) {\n        return vec4(vvSymbolRotationMatrix * ( vvScale(_featureAttribute) * (position + vvSymbolAnchor)), 1.0);\n      }\n    "],
["\n      vec3 vvScale(vec4 _featureAttribute) {\n        return clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize);\n      }\n\n      vec4 vvTransformPosition(vec3 position, vec4 _featureAttribute) {\n        return vec4(vvSymbolRotationMatrix * ( vvScale(_featureAttribute) * (position + vvSymbolAnchor)), 1.0);\n      }\n    "])))),d.vertex.code.add(l.glsl(h||(h=t(["\n      const float eps \x3d 1.192092896e-07;\n      vec4 vvTransformNormal(vec3 _normal, vec4 _featureAttribute) {\n        vec3 vvScale \x3d clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize + eps, vvSizeMaxSize);\n        return vec4(vvSymbolRotationMatrix * _normal / vvScale, 1.0);\n      }\n\n      ",
"\n    "],["\n      const float eps \x3d 1.192092896e-07;\n      vec4 vvTransformNormal(vec3 _normal, vec4 _featureAttribute) {\n        vec3 vvScale \x3d clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize + eps, vvSizeMaxSize);\n        return vec4(vvSymbolRotationMatrix * _normal / vvScale, 1.0);\n      }\n\n      ","\n    "])),q.vvInstancingEnabled?l.glsl(f||(f=t(["\n      vec4 vvLocalNormal(vec3 _normal) {\n        return vvTransformNormal(_normal, instanceFeatureAttribute);\n      }\n\n      vec4 localPosition() {\n        return vvTransformPosition(position, instanceFeatureAttribute);\n      }"],
["\n      vec4 vvLocalNormal(vec3 _normal) {\n        return vvTransformNormal(_normal, instanceFeatureAttribute);\n      }\n\n      vec4 localPosition() {\n        return vvTransformPosition(position, instanceFeatureAttribute);\n      }"]))):""))):d.vertex.code.add(l.glsl(r||(r=t(["\n      vec4 localPosition() { return vec4(position, 1.0); }\n\n      vec4 vvLocalNormal(vec3 _normal) { return vec4(_normal, 1.0); }\n    "],["\n      vec4 localPosition() { return vec4(position, 1.0); }\n\n      vec4 vvLocalNormal(vec3 _normal) { return vec4(_normal, 1.0); }\n    "]))));
q.vvColor?(d.vertex.defines.addInt("VV_COLOR_N",8),d.vertex.code.add(l.glsl(a||(a=t(["\n      uniform float vvColorValues[VV_COLOR_N];\n      uniform vec4 vvColorColors[VV_COLOR_N];\n\n      vec4 vvGetColor(vec4 featureAttribute, float values[VV_COLOR_N], vec4 colors[VV_COLOR_N]) {\n        float value \x3d featureAttribute.y;\n        if (value \x3c\x3d values[0]) {\n          return colors[0];\n        }\n\n        for (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\n          if (values[i] \x3e\x3d value) {\n            float f \x3d (value - values[i-1]) / (values[i] - values[i-1]);\n            return mix(colors[i-1], colors[i], f);\n          }\n        }\n        return colors[VV_COLOR_N - 1];\n      }\n\n      ",
"\n    "],["\n      uniform float vvColorValues[VV_COLOR_N];\n      uniform vec4 vvColorColors[VV_COLOR_N];\n\n      vec4 vvGetColor(vec4 featureAttribute, float values[VV_COLOR_N], vec4 colors[VV_COLOR_N]) {\n        float value \x3d featureAttribute.y;\n        if (value \x3c\x3d values[0]) {\n          return colors[0];\n        }\n\n        for (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\n          if (values[i] \x3e\x3d value) {\n            float f \x3d (value - values[i-1]) / (values[i] - values[i-1]);\n            return mix(colors[i-1], colors[i], f);\n          }\n        }\n        return colors[VV_COLOR_N - 1];\n      }\n\n      ",
"\n    "])),q.vvInstancingEnabled?l.glsl(c||(c=t(["\n      vec4 vvColor() {\n        return vvGetColor(instanceFeatureAttribute, vvColorValues, vvColorColors);\n      }"],["\n      vec4 vvColor() {\n        return vvGetColor(instanceFeatureAttribute, vvColorValues, vvColorColors);\n      }"]))):""))):d.vertex.code.add(l.glsl(m||(m=t(["\n      vec4 vvColor() { return vec4(1.0); }\n    "],["\n      vec4 vvColor() { return vec4(1.0); }\n    "]))))}Object.defineProperty(d,"__esModule",{value:!0});d.VisualVariables=
q;(function(a){function c(a,c){c.vvSizeEnabled&&(a.setUniform3fv("vvSizeMinSize",c.vvSizeMinSize),a.setUniform3fv("vvSizeMaxSize",c.vvSizeMaxSize),a.setUniform3fv("vvSizeOffset",c.vvSizeOffset),a.setUniform3fv("vvSizeFactor",c.vvSizeFactor));c.vvColorEnabled&&(a.setUniform1fv("vvColorValues",c.vvColorValues),a.setUniform4fv("vvColorColors",c.vvColorColors))}a.bindUniforms=c;a.bindUniformsWithOpacity=function(a,b){c(a,b);b.vvOpacityEnabled&&(a.setUniform1fv("vvOpacityValues",b.vvOpacityValues),a.setUniform1fv("vvOpacityOpacities",
b.vvOpacityOpacities))};a.bindUniformsForSymbols=function(a,b){c(a,b);b.vvSizeEnabled&&(a.setUniform3fv("vvSymbolAnchor",b.vvSymbolAnchor),a.setUniformMatrix3fv("vvSymbolRotationMatrix",b.vvSymbolRotationMatrix))}})(q=d.VisualVariables||(d.VisualVariables={}));var b,f,h,r,c,a,m})},"esri/views/3d/webgl-engine/lib/StencilUtils":function(){define(["require","exports"],function(z,d){Object.defineProperty(d,"__esModule",{value:!0});d.depthCompareLess={func:513};d.depthCompareAlways={func:519};d.stencilWriteMaskOn=
{mask:255};d.stencilWriteMaskOff={mask:0};d.renderWhenBitIsNotSet=function(d){return{function:{func:517,ref:d,mask:d},operation:{fail:7680,zFail:7680,zPass:7680}}};d.replaceBitWhenDepthTestPasses=function(d){return{function:{func:519,ref:d,mask:d},operation:{fail:7680,zFail:7680,zPass:7681}}};d.stencilBaseAllZerosParams={function:{func:519,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:0}};d.stencilToolMaskBaseParams={function:{func:519,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7681}};
d.stencilToolMaskOccluderParams={function:{func:514,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7680}};d.stencilToolTransparentOccluderParams={function:{func:517,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7680}}})},"esri/views/3d/webgl-engine/shaders/RibbonLine.glsl":function(){define("require exports ../../../../core/tsSupport/makeTemplateObjectHelper ../core/shaderLibrary/Slice.glsl ../core/shaderLibrary/attributes/RibbonVertexPosition.glsl ../core/shaderLibrary/shading/LineStipple.glsl ../core/shaderLibrary/shading/PiUtils.glsl ../core/shaderModules/interfaces ../core/shaderModules/ShaderBuilder".split(" "),
function(z,d,t,l,q,b,f,h,r){Object.defineProperty(d,"__esModule",{value:!0});d.build=function(d){var p=new r.ShaderBuilder;p.extensions.add("GL_OES_standard_derivatives");p.include(f.PiUtils);p.include(q.RibbonVertexPosition,d);p.include(b.LineStipple,d);p.vertex.uniforms.add("proj","mat4").add("view","mat4").add("model","mat4").add("nearPlane","float").add("pixelRatio","float").add("miterLimit","float").add("screenSize","vec2");p.attributes.add("position","vec3");p.attributes.add("subdivisionFactor",
"float");p.attributes.add("uv0","vec2");p.attributes.add("auxpos1","vec3");p.attributes.add("auxpos2","vec3");p.varyings.add("vColor","vec4");p.varyings.add("vpos","vec3");var L=d.falloffEnabled,A=d.innerColorEnabled;A&&p.varyings.add("vLineDistance","float");L&&p.varyings.add("vLineDistanceNorm","float");d.falloffEnabled&&p.fragment.uniforms.add("falloff","float");d.innerColorEnabled&&(p.fragment.uniforms.add("innerColor","vec4"),p.fragment.uniforms.add("innerWidth","float"));p.vertex.code.add(h.glsl(c||
(c=t(["\n\t\t#define PERPENDICULAR(v) vec2(v.y, -v.x);\n\t\t#define ISOUTSIDE (left.x * right.y - left.y * right.x)*uv0.y \x3e 0.0\n\n\t\tfloat interp(float ncp, vec4 a, vec4 b) {\n\t\t\treturn (-ncp - a.z) / (b.z - a.z);\n\t\t}\n\n\t\tvec2 rotate(vec2 v, float a) {\n\t\t\tfloat s \x3d sin(a);\n\t\t\tfloat c \x3d cos(a);\n\t\t\tmat2 m \x3d mat2(c, -s, s, c);\n\t\t\treturn m * v;\n\t\t}\n"],["\n\t\t#define PERPENDICULAR(v) vec2(v.y, -v.x);\n\t\t#define ISOUTSIDE (left.x * right.y - left.y * right.x)*uv0.y \x3e 0.0\n\n\t\tfloat interp(float ncp, vec4 a, vec4 b) {\n\t\t\treturn (-ncp - a.z) / (b.z - a.z);\n\t\t}\n\n\t\tvec2 rotate(vec2 v, float a) {\n\t\t\tfloat s \x3d sin(a);\n\t\t\tfloat c \x3d cos(a);\n\t\t\tmat2 m \x3d mat2(c, -s, s, c);\n\t\t\treturn m * v;\n\t\t}\n"]))));
p.vertex.code.add(h.glsl(a||(a=t(["\n    vec4 projectAndScale(vec4 pos) {\n      vec4 posNdc \x3d proj * pos;\n\n      // Note that posNdc is in -1:1, scaling by screenSize converts this to a coordinate system\n      // that is twice scaled (going from -size:size).\n      posNdc.xy *\x3d screenSize / posNdc.w;\n      return posNdc;\n    }\n"],["\n    vec4 projectAndScale(vec4 pos) {\n      vec4 posNdc \x3d proj * pos;\n\n      // Note that posNdc is in -1:1, scaling by screenSize converts this to a coordinate system\n      // that is twice scaled (going from -size:size).\n      posNdc.xy *\x3d screenSize / posNdc.w;\n      return posNdc;\n    }\n"]))));
p.vertex.code.add(h.glsl(m||(m=t(["\n    void clipAndTransform(inout vec4 pos, inout vec4 prev, inout vec4 next, in bool isStartVertex) {\n      float vnp \x3d nearPlane*0.99;\n\n      //current pos behind ncp --\x3e we need to clip\n      if(pos.z \x3e -nearPlane) {\n        if (!isStartVertex) {\n          //previous in front of ncp\n          if(prev.z \x3c -nearPlane) {\n            pos \x3d mix(prev, pos, interp(vnp, prev, pos));\n            next \x3d pos;\n          } else {\n            pos \x3d vec4(0.0, 0.0, 0.0, 1.0);\n          }\n        }\n        //next in front of ncp\n        if(isStartVertex) {\n          if(next.z \x3c -nearPlane) {\n            pos \x3d mix(pos, next, interp(vnp, pos, next));\n            prev \x3d pos;\n          } else {\n            pos \x3d vec4(0.0, 0.0, 0.0, 1.0);\n          }\n        }\n      } else {\n        //current position visible\n        //previous behind ncp\n        if (prev.z \x3e -nearPlane) {\n          prev \x3d mix(pos, prev, interp(vnp, pos, prev));\n        }\n        //next behind ncp\n        if (next.z \x3e -nearPlane) {\n          next \x3d mix(next, pos, interp(vnp, next, pos));\n        }\n      }\n\n      pos \x3d projectAndScale(pos);\n      next \x3d projectAndScale(next);\n      prev \x3d projectAndScale(prev);\n    }\n"],
["\n    void clipAndTransform(inout vec4 pos, inout vec4 prev, inout vec4 next, in bool isStartVertex) {\n      float vnp \x3d nearPlane*0.99;\n\n      //current pos behind ncp --\x3e we need to clip\n      if(pos.z \x3e -nearPlane) {\n        if (!isStartVertex) {\n          //previous in front of ncp\n          if(prev.z \x3c -nearPlane) {\n            pos \x3d mix(prev, pos, interp(vnp, prev, pos));\n            next \x3d pos;\n          } else {\n            pos \x3d vec4(0.0, 0.0, 0.0, 1.0);\n          }\n        }\n        //next in front of ncp\n        if(isStartVertex) {\n          if(next.z \x3c -nearPlane) {\n            pos \x3d mix(pos, next, interp(vnp, pos, next));\n            prev \x3d pos;\n          } else {\n            pos \x3d vec4(0.0, 0.0, 0.0, 1.0);\n          }\n        }\n      } else {\n        //current position visible\n        //previous behind ncp\n        if (prev.z \x3e -nearPlane) {\n          prev \x3d mix(pos, prev, interp(vnp, pos, prev));\n        }\n        //next behind ncp\n        if (next.z \x3e -nearPlane) {\n          next \x3d mix(next, pos, interp(vnp, next, pos));\n        }\n      }\n\n      pos \x3d projectAndScale(pos);\n      next \x3d projectAndScale(next);\n      prev \x3d projectAndScale(prev);\n    }\n"]))));
p.vertex.code.add(h.glsl(u||(u=t(["\n  void main(void) {\n    float coverage \x3d 1.0;\n    vpos \x3d (model * vec4(position, 1.0)).xyz;\n\n    // Check for special value of uv0.y which is used by the Renderer when graphics\n    // are removed before the VBO is recompacted. If this is the case, then we just\n    // project outside of clip space.\n    if (uv0.y \x3d\x3d 0.0) {\n      // Project out of clip space\n      gl_Position \x3d vec4(1e038, 1e038, 1e038, 1.0);\n    }\n    else {\n      bool isStartVertex \x3d abs(abs(uv0.y)-3.0) \x3d\x3d 1.0;\n      bool isJoin \x3d abs(uv0.y)-3.0 \x3c 0.0;\n\n      float lineWidth \x3d getSize() * pixelRatio;\n\n      // convert sub-pixel coverage to alpha\n      if (lineWidth \x3c 1.0) {\n        coverage \x3d lineWidth;\n        lineWidth \x3d 1.0;\n      }\n\n      vec4 pos  \x3d view * vec4((model * vec4(position.xyz, 1.0)).xyz, 1.0);\n      vec4 prev \x3d view * vec4((model * vec4(auxpos1.xyz, 1.0)).xyz, 1.0);\n      vec4 next \x3d view * vec4((model * vec4(auxpos2.xyz, 1.0)).xyz, 1.0);\n\n      clipAndTransform(pos, prev, next, isStartVertex);\n\n      vec2 left \x3d (pos.xy - prev.xy);\n      vec2 right \x3d (next.xy - pos.xy);\n\n      float leftLen \x3d length(left);\n      float rightLen \x3d length(right);\n  "],
["\n  void main(void) {\n    float coverage \x3d 1.0;\n    vpos \x3d (model * vec4(position, 1.0)).xyz;\n\n    // Check for special value of uv0.y which is used by the Renderer when graphics\n    // are removed before the VBO is recompacted. If this is the case, then we just\n    // project outside of clip space.\n    if (uv0.y \x3d\x3d 0.0) {\n      // Project out of clip space\n      gl_Position \x3d vec4(1e038, 1e038, 1e038, 1.0);\n    }\n    else {\n      bool isStartVertex \x3d abs(abs(uv0.y)-3.0) \x3d\x3d 1.0;\n      bool isJoin \x3d abs(uv0.y)-3.0 \x3c 0.0;\n\n      float lineWidth \x3d getSize() * pixelRatio;\n\n      // convert sub-pixel coverage to alpha\n      if (lineWidth \x3c 1.0) {\n        coverage \x3d lineWidth;\n        lineWidth \x3d 1.0;\n      }\n\n      vec4 pos  \x3d view * vec4((model * vec4(position.xyz, 1.0)).xyz, 1.0);\n      vec4 prev \x3d view * vec4((model * vec4(auxpos1.xyz, 1.0)).xyz, 1.0);\n      vec4 next \x3d view * vec4((model * vec4(auxpos2.xyz, 1.0)).xyz, 1.0);\n\n      clipAndTransform(pos, prev, next, isStartVertex);\n\n      vec2 left \x3d (pos.xy - prev.xy);\n      vec2 right \x3d (next.xy - pos.xy);\n\n      float leftLen \x3d length(left);\n      float rightLen \x3d length(right);\n  "]))));
d.stippleEnabled&&p.vertex.code.add(h.glsl(D||(D=t(["\n      // uv0.x is either 0 or 1, depending on whether this is considered the start of a line segment\n      // or the end. If start, then use pos-\x3enext, otherwise use prev-\x3epos to define the line segment\n      // vector\n      vec4 stippleSegmentInfo \x3d mix(vec4(pos.xy, right), vec4(prev.xy, left), uv0.x);\n      vec2 stippleSegmentOrigin \x3d stippleSegmentInfo.xy;\n\n      // Scale s.t. it's in units of stipple pattern size.\n      vec2 stippleSegmentDirection \x3d stippleSegmentInfo.zw;\n    "],
["\n      // uv0.x is either 0 or 1, depending on whether this is considered the start of a line segment\n      // or the end. If start, then use pos-\x3enext, otherwise use prev-\x3epos to define the line segment\n      // vector\n      vec4 stippleSegmentInfo \x3d mix(vec4(pos.xy, right), vec4(prev.xy, left), uv0.x);\n      vec2 stippleSegmentOrigin \x3d stippleSegmentInfo.xy;\n\n      // Scale s.t. it's in units of stipple pattern size.\n      vec2 stippleSegmentDirection \x3d stippleSegmentInfo.zw;\n    "]))));
p.vertex.code.add(h.glsl(w||(w=t(['\n    left \x3d (leftLen \x3e 0.001) ? left/leftLen : vec2(0.0, 0.0);\n    right \x3d (rightLen \x3e 0.001) ? right/rightLen : vec2(0.0, 0.0);\n\n    vec2 capDisplacementDir \x3d vec2(0, 0);\n    vec2 joinDisplacementDir \x3d vec2(0, 0);\n    float displacementLen \x3d lineWidth;\n\n    if (isJoin) {\n\n      // JOIN handling ---------------------------------------------------\n      // determine if vertex is on the "outside or "inside" of the join\n      bool isOutside \x3d ISOUTSIDE;\n\n      // compute miter join position first\n      joinDisplacementDir \x3d normalize(left + right);\n      joinDisplacementDir \x3d PERPENDICULAR(joinDisplacementDir);\n\n      // compute miter stretch\n      if (leftLen \x3e 0.001 \x26\x26 rightLen \x3e 0.001) {\n        float nDotSeg \x3d dot(joinDisplacementDir, left);\n        displacementLen /\x3d length(nDotSeg * left - joinDisplacementDir);\n\n        // limit displacement of inner vertices\n        if (!isOutside) {\n          displacementLen \x3d min(displacementLen, min(leftLen, rightLen)/abs(nDotSeg));\n        }\n      }\n\n      if (isOutside \x26\x26 (displacementLen \x3e miterLimit * lineWidth)) {\n    '],
['\n    left \x3d (leftLen \x3e 0.001) ? left/leftLen : vec2(0.0, 0.0);\n    right \x3d (rightLen \x3e 0.001) ? right/rightLen : vec2(0.0, 0.0);\n\n    vec2 capDisplacementDir \x3d vec2(0, 0);\n    vec2 joinDisplacementDir \x3d vec2(0, 0);\n    float displacementLen \x3d lineWidth;\n\n    if (isJoin) {\n\n      // JOIN handling ---------------------------------------------------\n      // determine if vertex is on the "outside or "inside" of the join\n      bool isOutside \x3d ISOUTSIDE;\n\n      // compute miter join position first\n      joinDisplacementDir \x3d normalize(left + right);\n      joinDisplacementDir \x3d PERPENDICULAR(joinDisplacementDir);\n\n      // compute miter stretch\n      if (leftLen \x3e 0.001 \x26\x26 rightLen \x3e 0.001) {\n        float nDotSeg \x3d dot(joinDisplacementDir, left);\n        displacementLen /\x3d length(nDotSeg * left - joinDisplacementDir);\n\n        // limit displacement of inner vertices\n        if (!isOutside) {\n          displacementLen \x3d min(displacementLen, min(leftLen, rightLen)/abs(nDotSeg));\n        }\n      }\n\n      if (isOutside \x26\x26 (displacementLen \x3e miterLimit * lineWidth)) {\n    ']))));
d.roundJoins?p.vertex.code.add(h.glsl(v||(v=t(["\n        vec2 startDir;\n        vec2 endDir;\n\n        if (leftLen \x3c 0.001) {\n          startDir \x3d right;\n        }\n        else{\n          startDir \x3d left;\n        }\n        startDir \x3d normalize(startDir);\n        startDir \x3d PERPENDICULAR(startDir);\n\n        if (rightLen \x3c 0.001) {\n          endDir \x3d left;\n        }\n        else{\n          endDir \x3d right;\n        }\n        endDir \x3d normalize(endDir);\n        endDir \x3d PERPENDICULAR(endDir);\n\n        float rotationAngle \x3d acos(clamp(dot(startDir, endDir), -1.0, 1.0));\n        joinDisplacementDir \x3d rotate(startDir, -sign(uv0.y) * subdivisionFactor * rotationAngle);\n      "],
["\n        vec2 startDir;\n        vec2 endDir;\n\n        if (leftLen \x3c 0.001) {\n          startDir \x3d right;\n        }\n        else{\n          startDir \x3d left;\n        }\n        startDir \x3d normalize(startDir);\n        startDir \x3d PERPENDICULAR(startDir);\n\n        if (rightLen \x3c 0.001) {\n          endDir \x3d left;\n        }\n        else{\n          endDir \x3d right;\n        }\n        endDir \x3d normalize(endDir);\n        endDir \x3d PERPENDICULAR(endDir);\n\n        float rotationAngle \x3d acos(clamp(dot(startDir, endDir), -1.0, 1.0));\n        joinDisplacementDir \x3d rotate(startDir, -sign(uv0.y) * subdivisionFactor * rotationAngle);\n      "])))):
p.vertex.code.add(h.glsl(E||(E=t(["\n        // convert to bevel join if miterLimit is exceeded\n        if (leftLen \x3c 0.001) {\n          joinDisplacementDir \x3d right;\n        }\n        else if (rightLen \x3c 0.001) {\n          joinDisplacementDir \x3d left;\n        }\n        else {\n          joinDisplacementDir \x3d isStartVertex ? right : left;\n        }\n        joinDisplacementDir \x3d normalize(joinDisplacementDir);\n        joinDisplacementDir \x3d PERPENDICULAR(joinDisplacementDir);\n  "],
["\n        // convert to bevel join if miterLimit is exceeded\n        if (leftLen \x3c 0.001) {\n          joinDisplacementDir \x3d right;\n        }\n        else if (rightLen \x3c 0.001) {\n          joinDisplacementDir \x3d left;\n        }\n        else {\n          joinDisplacementDir \x3d isStartVertex ? right : left;\n        }\n        joinDisplacementDir \x3d normalize(joinDisplacementDir);\n        joinDisplacementDir \x3d PERPENDICULAR(joinDisplacementDir);\n  "]))));p.vertex.code.add(h.glsl(C||
(C=t(["\n        displacementLen \x3d lineWidth;\n      }\n    } else {\n    // CAP handling ---------------------------------------------------\n    if (leftLen \x3c 0.001) {\n      joinDisplacementDir \x3d right;\n    }\n    else if (rightLen \x3c 0.001) {\n      joinDisplacementDir \x3d left;\n    }\n    else {\n      joinDisplacementDir \x3d isStartVertex ? right : left;\n    }\n    joinDisplacementDir \x3d normalize(joinDisplacementDir);\n    joinDisplacementDir \x3d PERPENDICULAR(joinDisplacementDir);\n    displacementLen \x3d lineWidth;\n\n    capDisplacementDir \x3d isStartVertex ? -right : left;\n  "],
["\n        displacementLen \x3d lineWidth;\n      }\n    } else {\n    // CAP handling ---------------------------------------------------\n    if (leftLen \x3c 0.001) {\n      joinDisplacementDir \x3d right;\n    }\n    else if (rightLen \x3c 0.001) {\n      joinDisplacementDir \x3d left;\n    }\n    else {\n      joinDisplacementDir \x3d isStartVertex ? right : left;\n    }\n    joinDisplacementDir \x3d normalize(joinDisplacementDir);\n    joinDisplacementDir \x3d PERPENDICULAR(joinDisplacementDir);\n    displacementLen \x3d lineWidth;\n\n    capDisplacementDir \x3d isStartVertex ? -right : left;\n  "]))));
d.roundCaps?p.vertex.code.add(h.glsl(J||(J=t(["\n    float angle \x3d subdivisionFactor*PI*0.5;\n    joinDisplacementDir *\x3d cos(angle);\n    capDisplacementDir *\x3d sin(angle);\n    "],["\n    float angle \x3d subdivisionFactor*PI*0.5;\n    joinDisplacementDir *\x3d cos(angle);\n    capDisplacementDir *\x3d sin(angle);\n    "])))):p.vertex.code.add(h.glsl(K||(K=t(["\n    capDisplacementDir *\x3d subdivisionFactor;\n    "],["\n    capDisplacementDir *\x3d subdivisionFactor;\n    "]))));p.vertex.code.add(h.glsl(N||
(N=t(["\n  }\n\n  // Displacement (in pixels) caused by join/or cap\n  vec2 dpos \x3d joinDisplacementDir * sign(uv0.y) * displacementLen + capDisplacementDir * displacementLen;\n\n  ","\n\n  ","\n  ","\n\n  pos.xy +\x3d dpos;\n  "],["\n  }\n\n  // Displacement (in pixels) caused by join/or cap\n  vec2 dpos \x3d joinDisplacementDir * sign(uv0.y) * displacementLen + capDisplacementDir * displacementLen;\n\n  ","\n\n  ","\n  ","\n\n  pos.xy +\x3d dpos;\n  "])),L||A?h.glsl(G||(G=t(["float lineDist \x3d lineWidth * sign(uv0.y) * pos.w;"],
["float lineDist \x3d lineWidth * sign(uv0.y) * pos.w;"]))):"",A?h.glsl(I||(I=t(["vLineDistance \x3d lineDist;"],["vLineDistance \x3d lineDist;"]))):"",L?h.glsl(x||(x=t(["vLineDistanceNorm \x3d lineDist / lineWidth;"],["vLineDistanceNorm \x3d lineDist / lineWidth;"]))):""));d.stippleEnabled&&(p.vertex.code.add(h.glsl(O||(O=t(["\n    {\n      // Compute the stipple pattern UV coordinate from the actual position, based on the origin\n      // and direction of the line segment on which the stipple pattern is based.\n\n      // Project the vector from the origin of the segment to the vertex onto the line segment.\n      // Note the 0.5 factor due to projected positions being at twice the screen size scale (see projectAndScale)\n      vec2 posVec \x3d pos.xy - stippleSegmentOrigin;\n\n      float stippleSegmentDirectionLength \x3d length(stippleSegmentDirection);\n    "],
["\n    {\n      // Compute the stipple pattern UV coordinate from the actual position, based on the origin\n      // and direction of the line segment on which the stipple pattern is based.\n\n      // Project the vector from the origin of the segment to the vertex onto the line segment.\n      // Note the 0.5 factor due to projected positions being at twice the screen size scale (see projectAndScale)\n      vec2 posVec \x3d pos.xy - stippleSegmentOrigin;\n\n      float stippleSegmentDirectionLength \x3d length(stippleSegmentDirection);\n    "])))),
d.stippleIntegerRepeatsEnabled&&p.vertex.code.add(h.glsl(P||(P=t(["\n      float numberOfPatternRepeats \x3d stippleSegmentDirectionLength * 0.5 * stipplePatternPixelSizeInv;\n      float roundedNumberOfPatternRepeats \x3d max(1.0, floor(numberOfPatternRepeats + 0.5));\n      stipplePatternUvMax \x3d roundedNumberOfPatternRepeats;\n      "],["\n      float numberOfPatternRepeats \x3d stippleSegmentDirectionLength * 0.5 * stipplePatternPixelSizeInv;\n      float roundedNumberOfPatternRepeats \x3d max(1.0, floor(numberOfPatternRepeats + 0.5));\n      stipplePatternUvMax \x3d roundedNumberOfPatternRepeats;\n      "])))),
p.vertex.code.add(h.glsl(S||(S=t(["\n      if (stippleSegmentDirectionLength \x3e\x3d 0.001) {\n        // Project the vertex position onto the line segment.\n        float projectedLength \x3d dot(stippleSegmentDirection, posVec) / stippleSegmentDirectionLength * 0.5;\n     ","\n        stipplePatternUv \x3d projectedLength * wholeNumberOfRepeatsScale * stipplePatternPixelSizeInv * pos.w;\n        } else {\n          stipplePatternUv \x3d 1.0;\n        }\n      }\n    "],["\n      if (stippleSegmentDirectionLength \x3e\x3d 0.001) {\n        // Project the vertex position onto the line segment.\n        float projectedLength \x3d dot(stippleSegmentDirection, posVec) / stippleSegmentDirectionLength * 0.5;\n     ",
"\n        stipplePatternUv \x3d projectedLength * wholeNumberOfRepeatsScale * stipplePatternPixelSizeInv * pos.w;\n        } else {\n          stipplePatternUv \x3d 1.0;\n        }\n      }\n    "])),d.stippleIntegerRepeatsEnabled?"float wholeNumberOfRepeatsScale \x3d roundedNumberOfPatternRepeats / numberOfPatternRepeats;":"float wholeNumberOfRepeatsScale \x3d 1.0;")));p.vertex.code.add(h.glsl(R||(R=t(["\n      // Convert back into NDC\n      pos.xy \x3d pos.xy / screenSize * pos.w;\n\n      vColor \x3d getColor();\n      vColor.a *\x3d coverage;\n\n      gl_Position \x3d pos;\n    }\n  }\n  "],
["\n      // Convert back into NDC\n      pos.xy \x3d pos.xy / screenSize * pos.w;\n\n      vColor \x3d getColor();\n      vColor.a *\x3d coverage;\n\n      gl_Position \x3d pos;\n    }\n  }\n  "]))));p.include(l.Slice,d);0===d.output&&(p.fragment.uniforms.add("intrinsicColor","vec4"),p.fragment.code.add(h.glsl(Q||(Q=t(["\n    void main() {\n      discardBySlice(vpos);\n      float stippleAlpha \x3d getStippleAlpha();\n      discardByStippleAlpha(stippleAlpha, STIPPLE_ALPHA_COLOR_DISCARD);\n\n      vec4 color \x3d intrinsicColor * vColor;\n    "],
["\n    void main() {\n      discardBySlice(vpos);\n      float stippleAlpha \x3d getStippleAlpha();\n      discardByStippleAlpha(stippleAlpha, STIPPLE_ALPHA_COLOR_DISCARD);\n\n      vec4 color \x3d intrinsicColor * vColor;\n    "])))),d.innerColorEnabled&&(p.fragment.uniforms.add("pixelRatio","float"),p.fragment.code.add(h.glsl(U||(U=t(["\n      float distToInner \x3d abs(vLineDistance * gl_FragCoord.w) - innerWidth;\n      float innerAA \x3d clamp(0.5 - distToInner, 0.0, 1.0);\n      float innerAlpha \x3d innerColor.a + color.a * (1.0 - innerColor.a);\n      color \x3d mix(color, vec4(innerColor.rgb, innerAlpha), innerAA);\n      "],
["\n      float distToInner \x3d abs(vLineDistance * gl_FragCoord.w) - innerWidth;\n      float innerAA \x3d clamp(0.5 - distToInner, 0.0, 1.0);\n      float innerAlpha \x3d innerColor.a + color.a * (1.0 - innerColor.a);\n      color \x3d mix(color, vec4(innerColor.rgb, innerAlpha), innerAA);\n      "]))))),p.fragment.code.add(h.glsl(V||(V=t(["\n      vec4 finalColor \x3d blendStipple(color, stippleAlpha);\n    "],["\n      vec4 finalColor \x3d blendStipple(color, stippleAlpha);\n    "])))),d.falloffEnabled&&
p.fragment.code.add(h.glsl(Y||(Y=t(["\n      finalColor.a *\x3d pow(max(0.0, 1.0 - abs(vLineDistanceNorm * gl_FragCoord.w)), falloff);\n      "],["\n      finalColor.a *\x3d pow(max(0.0, 1.0 - abs(vLineDistanceNorm * gl_FragCoord.w)), falloff);\n      "])))),p.fragment.code.add(h.glsl(T||(T=t(["\n      gl_FragColor \x3d highlightSlice(finalColor, vpos);\n    }\n    "],["\n      gl_FragColor \x3d highlightSlice(finalColor, vpos);\n    }\n    "])))));4===d.output&&p.fragment.code.add(h.glsl(aa||(aa=
t(["\n      void main() {\n        discardBySlice(vpos);\n        discardByStippleAlpha(getStippleAlpha(), STIPPLE_ALPHA_HIGHLIGHT_DISCARD);\n        gl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\n      }\n    "],["\n      void main() {\n        discardBySlice(vpos);\n        discardByStippleAlpha(getStippleAlpha(), STIPPLE_ALPHA_HIGHLIGHT_DISCARD);\n        gl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\n      }\n    "]))));return p};var c,a,m,u,D,w,v,E,C,J,K,G,I,x,N,O,P,S,R,Q,U,V,Y,T,aa})},"esri/views/3d/webgl-engine/core/shaderLibrary/attributes/RibbonVertexPosition.glsl":function(){define(["require",
"exports","../../../../../../core/tsSupport/makeTemplateObjectHelper","../../shaderModules/interfaces"],function(z,d,t,l){Object.defineProperty(d,"__esModule",{value:!0});d.RibbonVertexPosition=function(a,d){a.vertex.uniforms.add("intrinsicWidth","float");d.vvSize?(a.attributes.add("sizeFeatureAttribute","float"),a.vertex.uniforms.add("vvSizeMinSize","vec3"),a.vertex.uniforms.add("vvSizeMaxSize","vec3"),a.vertex.uniforms.add("vvSizeOffset","vec3"),a.vertex.uniforms.add("vvSizeFactor","vec3"),a.vertex.code.add(l.glsl(q||
(q=t(["\n    float getSize() {\n      return intrinsicWidth * clamp(vvSizeOffset + sizeFeatureAttribute * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize).x;\n    }\n    "],["\n    float getSize() {\n      return intrinsicWidth * clamp(vvSizeOffset + sizeFeatureAttribute * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize).x;\n    }\n    "]))))):(a.attributes.add("size","float"),a.vertex.code.add(l.glsl(b||(b=t(["\n    float getSize(){\n      return intrinsicWidth * size;\n    }\n    "],["\n    float getSize(){\n      return intrinsicWidth * size;\n    }\n    "])))));
d.vvOpacity?(a.attributes.add("opacityFeatureAttribute","float"),a.vertex.defines.addInt("VV_OPACITY_N",8),a.vertex.code.add(l.glsl(f||(f=t(["\n    uniform float vvOpacityValues[VV_OPACITY_N];\n    uniform float vvOpacityOpacities[VV_OPACITY_N];\n\n    float interpolateOpacity( float value ){\n      if (value \x3c\x3d vvOpacityValues[0]) {\n        return vvOpacityOpacities[0];\n      }\n\n      for (int i \x3d 1; i \x3c VV_OPACITY_N; ++i) {\n        if (vvOpacityValues[i] \x3e\x3d value) {\n          float f \x3d (value - vvOpacityValues[i-1]) / (vvOpacityValues[i] - vvOpacityValues[i-1]);\n          return mix(vvOpacityOpacities[i-1], vvOpacityOpacities[i], f);\n        }\n      }\n\n      return vvOpacityOpacities[VV_OPACITY_N - 1];\n    }\n\n    vec4 applyOpacity( vec4 color ){\n      return vec4(color.xyz, interpolateOpacity(opacityFeatureAttribute));\n    }\n    "],
["\n    uniform float vvOpacityValues[VV_OPACITY_N];\n    uniform float vvOpacityOpacities[VV_OPACITY_N];\n\n    float interpolateOpacity( float value ){\n      if (value \x3c\x3d vvOpacityValues[0]) {\n        return vvOpacityOpacities[0];\n      }\n\n      for (int i \x3d 1; i \x3c VV_OPACITY_N; ++i) {\n        if (vvOpacityValues[i] \x3e\x3d value) {\n          float f \x3d (value - vvOpacityValues[i-1]) / (vvOpacityValues[i] - vvOpacityValues[i-1]);\n          return mix(vvOpacityOpacities[i-1], vvOpacityOpacities[i], f);\n        }\n      }\n\n      return vvOpacityOpacities[VV_OPACITY_N - 1];\n    }\n\n    vec4 applyOpacity( vec4 color ){\n      return vec4(color.xyz, interpolateOpacity(opacityFeatureAttribute));\n    }\n    "]))))):
a.vertex.code.add(l.glsl(h||(h=t(["\n    vec4 applyOpacity( vec4 color ){\n      return color;\n    }\n    "],["\n    vec4 applyOpacity( vec4 color ){\n      return color;\n    }\n    "]))));d.vvColor?(a.attributes.add("colorFeatureAttribute","float"),a.vertex.defines.addInt("VV_COLOR_N",8),a.vertex.code.add(l.glsl(r||(r=t(["\n    uniform float vvColorValues[VV_COLOR_N];\n    uniform vec4 vvColorColors[VV_COLOR_N];\n\n    vec4 interpolateColor( float value ) {\n      if (value \x3c\x3d vvColorValues[0]) {\n        return vvColorColors[0];\n      }\n\n      for (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\n        if (vvColorValues[i] \x3e\x3d value) {\n          float f \x3d (value - vvColorValues[i-1]) / (vvColorValues[i] - vvColorValues[i-1]);\n          return mix(vvColorColors[i-1], vvColorColors[i], f);\n        }\n      }\n\n      return vvColorColors[VV_COLOR_N - 1];\n    }\n\n    vec4 getColor(){\n      return applyOpacity(interpolateColor(colorFeatureAttribute));\n    }\n    "],
["\n    uniform float vvColorValues[VV_COLOR_N];\n    uniform vec4 vvColorColors[VV_COLOR_N];\n\n    vec4 interpolateColor( float value ) {\n      if (value \x3c\x3d vvColorValues[0]) {\n        return vvColorColors[0];\n      }\n\n      for (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\n        if (vvColorValues[i] \x3e\x3d value) {\n          float f \x3d (value - vvColorValues[i-1]) / (vvColorValues[i] - vvColorValues[i-1]);\n          return mix(vvColorColors[i-1], vvColorColors[i], f);\n        }\n      }\n\n      return vvColorColors[VV_COLOR_N - 1];\n    }\n\n    vec4 getColor(){\n      return applyOpacity(interpolateColor(colorFeatureAttribute));\n    }\n    "]))))):
(a.attributes.add("color","vec4"),a.vertex.code.add(l.glsl(c||(c=t(["\n    vec4 getColor(){\n      return applyOpacity(color);\n    }\n    "],["\n    vec4 getColor(){\n      return applyOpacity(color);\n    }\n    "])))))};var q,b,f,h,r,c})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/LineStipple.glsl":function(){define(["require","exports","../../../../../../core/tsSupport/makeTemplateObjectHelper","../../shaderModules/interfaces"],function(z,d,t,l){Object.defineProperty(d,"__esModule",
{value:!0});d.LineStipple=function(d,c){d.defines.addFloat("STIPPLE_ALPHA_COLOR_DISCARD",.001);d.defines.addFloat("STIPPLE_ALPHA_HIGHLIGHT_DISCARD",.5);c.stippleEnabled?(d.vertex.uniforms.add("stipplePatternPixelSizeInv","float"),c.stippleUVMaxEnabled&&d.varyings.add("stipplePatternUvMax","float"),d.varyings.add("stipplePatternUv","float"),d.fragment.uniforms.add("stipplePatternTexture","sampler2D"),c.stippleOffColorEnabled&&d.fragment.uniforms.add("stippleOffColor","vec4"),d.fragment.code.add(l.glsl(q||
(q=t(["\n  float getStippleAlpha() {\n    float stipplePatternUvClamped \x3d stipplePatternUv * gl_FragCoord.w;\n    ","\n\n    return texture2D(stipplePatternTexture, vec2(mod(stipplePatternUvClamped, 1.0), 0.5)).a;\n  }"],["\n  float getStippleAlpha() {\n    float stipplePatternUvClamped \x3d stipplePatternUv * gl_FragCoord.w;\n    ","\n\n    return texture2D(stipplePatternTexture, vec2(mod(stipplePatternUvClamped, 1.0), 0.5)).a;\n  }"])),c.stippleUVMaxEnabled?"stipplePatternUvClamped \x3d clamp(stipplePatternUvClamped, 0.0, stipplePatternUvMax);":
"")),c.stippleOffColorEnabled?d.fragment.code.add(l.glsl(b||(b=t(["\n    #define discardByStippleAlpha(stippleAlpha, threshold) {}\n    #define blendStipple(color, stippleAlpha) mix(color, stippleOffColor, stippleAlpha)\n    "],["\n    #define discardByStippleAlpha(stippleAlpha, threshold) {}\n    #define blendStipple(color, stippleAlpha) mix(color, stippleOffColor, stippleAlpha)\n    "])))):d.fragment.code.add(l.glsl(f||(f=t(["\n    #define discardByStippleAlpha(stippleAlpha, threshold) if (stippleAlpha \x3c threshold) { discard; }\n    #define blendStipple(color, stippleAlpha) vec4(color.rgb, color.a * stippleAlpha)\n    "],
["\n    #define discardByStippleAlpha(stippleAlpha, threshold) if (stippleAlpha \x3c threshold) { discard; }\n    #define blendStipple(color, stippleAlpha) vec4(color.rgb, color.a * stippleAlpha)\n    "]))))):d.fragment.code.add(l.glsl(h||(h=t(["\n  float getStippleAlpha() { return 1.0; }\n\n  #define discardByStippleAlpha(_stippleAlpha_, _threshold_) {}\n  #define blendStipple(color, _stippleAlpha_) color\n  "],["\n  float getStippleAlpha() { return 1.0; }\n\n  #define discardByStippleAlpha(_stippleAlpha_, _threshold_) {}\n  #define blendStipple(color, _stippleAlpha_) color\n  "]))))};
var q,b,f,h})},"esri/views/3d/webgl-engine/lib/intersectorUtils":function(){define("require exports ../../../../core/maybe ../../../../core/libs/gl-matrix-2/mat3 ../../../../core/libs/gl-matrix-2/mat3f64 ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/quat ../../../../core/libs/gl-matrix-2/quatf64 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f32 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../core/libs/gl-matrix-2/vec4 ../../../../core/libs/gl-matrix-2/vec4f64 ../../support/geometryUtils ../../support/geometryUtils/boundedPlane ../../support/geometryUtils/sphere ./Object3D".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u,D,w,v,E,C){function J(a,c){return t.isNone(a)||null==a.layerUid?null:t.isSome(c.graphicsView)&&a.layerUid===c.graphicsView.mockLayerId?c.graphics:c.map.findLayerByUid(a.layerUid)}function K(a,c){if(t.isNone(a))return null;var b=J(a,c);return t.isNone(b)?null:b===c.graphics?t.isSome(c.graphicsView)?t.expect(c.graphicsView.getGraphicFromGraphicUid(a.graphicUid)):null:(c=c.allLayerViews.find(function(a){return a.layer===b}))?G(c,a):null}function G(a,c){return!a||a.suspended?
null:"getGraphicFromIntersectorMetadata"in a&&c?a.getGraphicFromIntersectorMetadata(c):"getGraphicFromGraphicUid"in a&&null!=c.graphicUid?a.getGraphicFromGraphicUid(c.graphicUid):null}Object.defineProperty(d,"__esModule",{value:!0});d.sliceFilterPredicate=function(a){return function(b,d,p){c.vec3.lerp(Q,b,d,p);return!v.extrusionContainsPoint(a,Q)}};z=function(){return function(){this.verticalOffset=0;this.selectionMode=!1;this.selectOpaqueTerrainOnly=this.hud=!0;this.invisibleTerrain=!1;this.storeTerrainResults=
this.backfacesTerrain=!0;this.store=2}}();d.IntersectorOptions=z;z=function(){function a(){this._transform=f.mat4f64.create();this._transformInverse=new I({value:this._transform},b.mat4.invert,f.mat4f64.create);this._transformInverseTranspose=new I(this._transformInverse,b.mat4.transpose,f.mat4f64.create);this._transformTranspose=new I({value:this._transform},b.mat4.transpose,f.mat4f64.create);this._transformInverseRotation=new I({value:this._transform},l.mat3.normalFromMat4Legacy,q.mat3f64.create)}
a.prototype.invalidateLazyTransforms=function(){this._transformInverse.invalidate();this._transformInverseTranspose.invalidate();this._transformTranspose.invalidate();this._transformInverseRotation.invalidate()};Object.defineProperty(a.prototype,"transform",{get:function(){return this._transform},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"inverse",{get:function(){return this._transformInverse.value},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"inverseTranspose",
{get:function(){return this._transformInverseTranspose.value},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"inverseRotation",{get:function(){return this._transformInverseRotation.value},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"transpose",{get:function(){return this._transformTranspose.value},enumerable:!0,configurable:!0});a.prototype.setTransformMatrix=function(a){b.mat4.copy(this._transform,a)};a.prototype.multiplyTransform=function(a){b.mat4.multiply(this._transform,
this._transform,a)};a.prototype.set=function(a){b.mat4.copy(this._transform,a);this.invalidateLazyTransforms()};a.prototype.setAndInvalidateLazyTransforms=function(a,c){this.setTransformMatrix(a);this.multiplyTransform(c);this.invalidateLazyTransforms()};return a}();d.IntersectorTransform=z;var I=function(){function a(a,c,b){this.original=a;this.update=c;this.dirty=!0;this.transform=b()}a.prototype.invalidate=function(){this.dirty=!0};Object.defineProperty(a.prototype,"value",{get:function(){this.dirty&&
(this.update(this.transform,this.original.value),this.dirty=!1);return this.transform},enumerable:!0,configurable:!0});return a}();z=function(){function a(){this.min=new x;this.max=new x;this.hud=new x;this.ground=new x}a.prototype.init=function(a){this.min.init(a);this.max.init(a);this.hud.init(a);this.ground.init(a);this.all=[]};return a}();d.IntersectorResults=z;var x=function(){function a(a){this.normal=m.vec3f64.create();this.transformation=f.mat4f64.create();this._ray=w.ray.create();this.init(a)}
Object.defineProperty(a.prototype,"ray",{get:function(){return this._ray},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hasIntersectionPoint",{get:function(){return null!=this.dist},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"distanceInRenderSpace",{get:function(){if(null!=this.dist)return c.vec3.scale(U,this.ray.direction,this.dist),c.vec3.length(U)},enumerable:!0,configurable:!0});a.prototype.getIntersectionPoint=function(a){if(!this.hasIntersectionPoint)return!1;
c.vec3.scale(U,this.ray.direction,this.dist);c.vec3.add(a,this.ray.origin,U);return!0};a.prototype.getTransformedNormal=function(a){c.vec3.copy(V,this.normal);V[3]=0;u.vec4.transformMat4(V,V,this.transformation);c.vec3.copy(a,V);c.vec3.normalize(a,a);return a};a.prototype.init=function(a){this.drapedLayerGraphicOrder=this.drapedLayerOrder=this.name=this.target=this.dist=void 0;this.triangleNr=this.geometryId=this.center=null;this.intersector="Stage";a?w.ray.copy(a,this._ray):this._ray=w.ray.create()};
a.prototype.set=function(a,d,p,f,A,k,e,g,n,y){a instanceof C&&(a={type:"stage",obj:a});this.dist=p;c.vec3.copy(this.normal,f);b.mat4.copy(this.transformation,A);this.target=a;this.name=d;this.drapedLayerOrder=k;this.center=e?m.vec3f64.clone(e):null;this.geometryId=g;this.triangleNr=n;this.drapedLayerGraphicOrder=y};a.prototype.copyFrom=function(a){w.ray.copy(a._ray,this._ray);this.dist=a.dist;this.target=a.target;this.name=a.name;this.drapedLayerOrder=a.drapedLayerOrder;this.center=a.center?m.vec3f64.clone(a.center):
null;this.geometryId=a.geometryId;this.triangleNr=a.triangleNr;this.intersector=a.intersector;this.drapedLayerGraphicOrder=a.drapedLayerGraphicOrder;c.vec3.copy(this.normal,a.normal);b.mat4.copy(this.transformation,a.transformation)};a.prototype.toOwner=function(a){if(!this.target)return null;switch(this.target.type){case "stage":return J(this.target.obj.metadata,a);case "external":switch(this.intersector){case "PointRenderer":var c=this.target.metadata.layerUid;return null!=c?a.map.findLayerByUid(c):
null;case "I3S":case "IM":case "LodRenderer":case "OverlayRenderer":return J(this.target.metadata,a);case "TerrainRenderer":return a.map&&a.map.ground}}return null};a.prototype.toGraphic=function(a){if(!this.target)return null;switch(this.target.type){case "stage":return K(this.target.obj.metadata,a);case "external":switch(this.intersector){case "PointRenderer":return this.target.metadata.createGraphic();case "I3S":case "IM":case "LodRenderer":case "OverlayRenderer":return K(this.target.metadata,
a)}}return null};return a}();d.IntersectorResult=x;z=function(){function a(a){void 0===a&&(a=0);this.offset=a;this.tmpVertex=m.vec3f64.create()}a.prototype.applyToVertex=function(a,c,b){var p=a+this.localOrigin[0],d=c+this.localOrigin[1],k=b+this.localOrigin[2],e=this.offset/Math.sqrt(p*p+d*d+k*k);this.tmpVertex[0]=a+p*e;this.tmpVertex[1]=c+d*e;this.tmpVertex[2]=b+k*e;return this.tmpVertex};a.prototype.applyToAABB=function(a){var c=a[0]+this.localOrigin[0],b=a[1]+this.localOrigin[1],d=a[2]+this.localOrigin[2],
f=a[3]+this.localOrigin[0],k=a[4]+this.localOrigin[1],e=a[5]+this.localOrigin[2],g=this.offset/Math.sqrt(c*c+b*b+d*d);a[0]+=c*g;a[1]+=b*g;a[2]+=d*g;c=this.offset/Math.sqrt(f*f+k*k+e*e);a[3]+=f*c;a[4]+=k*c;a[5]+=e*c;return a};return a}();d.TerrainVerticalOffsetGlobalViewingMode=z;var N=function(){function b(c){void 0===c&&(c=0);this.offset=c;this.componentLocalOriginLength=0;this.tmpVertex=m.vec3f64.create();this.mbs=D.vec4f64.create();this.obb={center:m.vec3f64.create(),halfSize:a.vec3f32.create(),
quaternion:null}}Object.defineProperty(b.prototype,"localOrigin",{set:function(a){this.componentLocalOriginLength=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2])},enumerable:!0,configurable:!0});b.prototype.applyToVertex=function(a,c,b){var p=b+this.componentLocalOriginLength,d=this.offset/Math.sqrt(a*a+c*c+p*p);this.tmpVertex[0]=a+a*d;this.tmpVertex[1]=c+c*d;this.tmpVertex[2]=b+p*d;return this.tmpVertex};b.prototype.applyToAABB=function(a){var c=a[0],b=a[1],d=a[2]+this.componentLocalOriginLength,f=a[3],
k=a[4],e=a[5]+this.componentLocalOriginLength,g=this.offset/Math.sqrt(c*c+b*b+d*d);a[0]+=c*g;a[1]+=b*g;a[2]+=d*g;c=this.offset/Math.sqrt(f*f+k*k+e*e);a[3]+=f*c;a[4]+=k*c;a[5]+=e*c;return a};b.prototype.applyToMbs=function(a){var c=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]),b=this.offset/c;this.mbs[0]=a[0]+a[0]*b;this.mbs[1]=a[1]+a[1]*b;this.mbs[2]=a[2]+a[2]*b;this.mbs[3]=a[3]+a[3]*this.offset/c;return this.mbs};b.prototype.applyToObb=function(a){var b=a.center,p=this.offset/Math.sqrt(b[0]*b[0]+b[1]*
b[1]+b[2]*b[2]);this.obb.center[0]=b[0]+b[0]*p;this.obb.center[1]=b[1]+b[1]*p;this.obb.center[2]=b[2]+b[2]*p;c.vec3.transformQuat(this.obb.halfSize,a.halfSize,a.quaternion);c.vec3.add(this.obb.halfSize,this.obb.halfSize,a.center);b=this.offset/Math.sqrt(this.obb.halfSize[0]*this.obb.halfSize[0]+this.obb.halfSize[1]*this.obb.halfSize[1]+this.obb.halfSize[2]*this.obb.halfSize[2]);this.obb.halfSize[0]+=this.obb.halfSize[0]*b;this.obb.halfSize[1]+=this.obb.halfSize[1]*b;this.obb.halfSize[2]+=this.obb.halfSize[2]*
b;c.vec3.subtract(this.obb.halfSize,this.obb.halfSize,a.center);h.quat.conjugate(Y,a.quaternion);c.vec3.transformQuat(this.obb.halfSize,this.obb.halfSize,Y);this.obb.halfSize[0]*=0>this.obb.halfSize[0]?-1:1;this.obb.halfSize[1]*=0>this.obb.halfSize[1]?-1:1;this.obb.halfSize[2]*=0>this.obb.halfSize[2]?-1:1;this.obb.quaternion=a.quaternion;return this.obb};return b}();d.I3SVerticalOffsetGlobalViewingMode=N;var O=function(){function a(a){void 0===a&&(a=0);this.offset=a;this.sphere=E.create();this.tmpVertex=
m.vec3f64.create()}a.prototype.applyToVertex=function(a,c,b){var p=this.objectTransform.transform,d=p[0]*a+p[4]*c+p[8]*b+p[12],k=p[1]*a+p[5]*c+p[9]*b+p[13];a=p[2]*a+p[6]*c+p[10]*b+p[14];c=this.offset/Math.sqrt(d*d+k*k+a*a);d+=d*c;k+=k*c;a+=a*c;c=this.objectTransform.inverse;this.tmpVertex[0]=c[0]*d+c[4]*k+c[8]*a+c[12];this.tmpVertex[1]=c[1]*d+c[5]*k+c[9]*a+c[13];this.tmpVertex[2]=c[2]*d+c[6]*k+c[10]*a+c[14];return this.tmpVertex};a.prototype.applyToMinMax=function(a,c){var b=this.offset/Math.sqrt(a[0]*
a[0]+a[1]*a[1]+a[2]*a[2]);a[0]+=a[0]*b;a[1]+=a[1]*b;a[2]+=a[2]*b;a=this.offset/Math.sqrt(c[0]*c[0]+c[1]*c[1]+c[2]*c[2]);c[0]+=c[0]*a;c[1]+=c[1]*a;c[2]+=c[2]*a};a.prototype.applyToAABB=function(a){var c=this.offset/Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);a[0]+=a[0]*c;a[1]+=a[1]*c;a[2]+=a[2]*c;c=this.offset/Math.sqrt(a[3]*a[3]+a[4]*a[4]+a[5]*a[5]);a[3]+=a[3]*c;a[4]+=a[4]*c;a[5]+=a[5]*c;return a};a.prototype.applyToBoundingSphere=function(a,c){var b=Math.sqrt(c[0]*c[0]+c[1]*c[1]+c[2]*c[2]),d=this.offset/
b;this.sphere.center[0]=c[0]+c[0]*d;this.sphere.center[1]=c[1]+c[1]*d;this.sphere.center[2]=c[2]+c[2]*d;this.sphere.radius=a+a*this.offset/b;return this.sphere};return a}();d.Object3DVerticalOffsetGlobalViewingMode=O;var P=new O;d.getVerticalOffsetObject3D=function(a){return t.isSome(a)?(P.offset=a,P):null};var S=new N;d.getVerticalOffsetI3S=function(a){return t.isSome(a)?(S.offset=a,S):null};var R=new z;d.getVerticalOffsetTerrain=function(a){return t.isSome(a)?(R.offset=a,R):null};d.TERRAIN_ID="terrain";
var Q=m.vec3f64.create(),U=m.vec3f64.create(),V=D.vec4f64.create(),Y=r.quatf64.create()})},"esri/core/libs/gl-matrix-2/quat":function(){define(["require","exports","./math/quat"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});d.quat=t})},"esri/core/libs/gl-matrix-2/math/quat":function(){define("require exports ../factories/mat3f64 ../factories/quatf64 ../factories/vec3f64 ./common ./vec3 ./vec4".split(" "),function(z,d,t,l,q,b,f,h){function r(a,c,b){b*=.5;var d=Math.sin(b);a[0]=
d*c[0];a[1]=d*c[1];a[2]=d*c[2];a[3]=Math.cos(b);return a}function c(a,c,b){var d=c[0],f=c[1],h=c[2];c=c[3];var m=b[0],l=b[1],q=b[2];b=b[3];a[0]=d*b+c*m+f*q-h*l;a[1]=f*b+c*l+h*m-d*q;a[2]=h*b+c*q+d*l-f*m;a[3]=c*b-d*m-f*l-h*q;return a}function a(a,c,d,f){var h=c[0],m=c[1],l=c[2];c=c[3];var q=d[0],r=d[1],u=d[2];d=d[3];var t,v,w;v=h*q+m*r+l*u+c*d;0>v&&(v=-v,q=-q,r=-r,u=-u,d=-d);1-v>b.EPSILON?(t=Math.acos(v),w=Math.sin(t),v=Math.sin((1-f)*t)/w,f=Math.sin(f*t)/w):v=1-f;a[0]=v*h+f*q;a[1]=v*m+f*r;a[2]=v*l+
f*u;a[3]=v*c+f*d;return a}function m(a,c){var b=c[0]+c[4]+c[8];if(0<b)b=Math.sqrt(b+1),a[3]=.5*b,b=.5/b,a[0]=(c[5]-c[7])*b,a[1]=(c[6]-c[2])*b,a[2]=(c[1]-c[3])*b;else{var d=0;c[4]>c[0]&&(d=1);c[8]>c[3*d+d]&&(d=2);var f=(d+1)%3,h=(d+2)%3,b=Math.sqrt(c[3*d+d]-c[3*f+f]-c[3*h+h]+1);a[d]=.5*b;b=.5/b;a[3]=(c[3*f+h]-c[3*h+f])*b;a[f]=(c[3*f+d]+c[3*d+f])*b;a[h]=(c[3*h+d]+c[3*d+h])*b}return a}Object.defineProperty(d,"__esModule",{value:!0});d.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};d.setAxisAngle=
r;d.getAxisAngle=function(a,c){var d=2*Math.acos(c[3]),f=Math.sin(d/2);f>b.EPSILON?(a[0]=c[0]/f,a[1]=c[1]/f,a[2]=c[2]/f):(a[0]=1,a[1]=0,a[2]=0);return d};d.multiply=c;d.rotateX=function(a,c,b){b*=.5;var d=c[0],f=c[1],h=c[2];c=c[3];var m=Math.sin(b);b=Math.cos(b);a[0]=d*b+c*m;a[1]=f*b+h*m;a[2]=h*b-f*m;a[3]=c*b-d*m;return a};d.rotateY=function(a,c,b){b*=.5;var d=c[0],f=c[1],h=c[2];c=c[3];var m=Math.sin(b);b=Math.cos(b);a[0]=d*b-h*m;a[1]=f*b+c*m;a[2]=h*b+d*m;a[3]=c*b-f*m;return a};d.rotateZ=function(a,
c,b){b*=.5;var d=c[0],f=c[1],h=c[2];c=c[3];var m=Math.sin(b);b=Math.cos(b);a[0]=d*b+f*m;a[1]=f*b-d*m;a[2]=h*b+c*m;a[3]=c*b-h*m;return a};d.calculateW=function(a,c){var b=c[0],d=c[1];c=c[2];a[0]=b;a[1]=d;a[2]=c;a[3]=Math.sqrt(Math.abs(1-b*b-d*d-c*c));return a};d.slerp=a;d.random=function(a){var c=b.RANDOM(),d=b.RANDOM(),f=b.RANDOM(),h=Math.sqrt(1-c),c=Math.sqrt(c);a[0]=h*Math.sin(2*Math.PI*d);a[1]=h*Math.cos(2*Math.PI*d);a[2]=c*Math.sin(2*Math.PI*f);a[3]=c*Math.cos(2*Math.PI*f);return a};d.invert=
function(a,c){var b=c[0],d=c[1],f=c[2];c=c[3];var h=b*b+d*d+f*f+c*c,h=h?1/h:0;a[0]=-b*h;a[1]=-d*h;a[2]=-f*h;a[3]=c*h;return a};d.conjugate=function(a,c){a[0]=-c[0];a[1]=-c[1];a[2]=-c[2];a[3]=c[3];return a};d.fromMat3=m;d.fromEuler=function(a,c,b,d){var f=.5*Math.PI/180;c*=f;b*=f;d*=f;f=Math.sin(c);c=Math.cos(c);var h=Math.sin(b);b=Math.cos(b);var m=Math.sin(d);d=Math.cos(d);a[0]=f*b*d-c*h*m;a[1]=c*h*d+f*b*m;a[2]=c*b*m-f*h*d;a[3]=c*b*d+f*h*m;return a};d.str=function(a){return"quat("+a[0]+", "+a[1]+
", "+a[2]+", "+a[3]+")"};d.copy=h.copy;d.set=h.set;d.add=h.add;d.mul=c;d.scale=h.scale;d.dot=h.dot;d.lerp=h.lerp;d.length=h.length;d.len=d.length;d.squaredLength=h.squaredLength;d.sqrLen=d.squaredLength;d.normalize=h.normalize;d.exactEquals=h.exactEquals;d.equals=h.equals;d.rotationTo=function(a,c,b){var h=f.dot(c,b);if(-.999999>h)return f.cross(u,D,c),1E-6>f.len(u)&&f.cross(u,w,c),f.normalize(u,u),r(a,u,Math.PI),a;if(.999999<h)return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a;f.cross(u,c,b);a[0]=u[0];a[1]=u[1];
a[2]=u[2];a[3]=1+h;return d.normalize(a,a)};var u=q.create(),D=q.fromValues(1,0,0),w=q.fromValues(0,1,0);d.sqlerp=function(c,b,d,f,h,m){a(v,b,h,m);a(E,d,f,m);a(c,v,E,2*m*(1-m));return c};var v=l.create(),E=l.create();d.setAxes=function(a,c,b,f){var h=C;h[0]=b[0];h[3]=b[1];h[6]=b[2];h[1]=f[0];h[4]=f[1];h[7]=f[2];h[2]=-c[0];h[5]=-c[1];h[8]=-c[2];return d.normalize(a,m(a,h))};var C=t.create()})},"esri/views/3d/webgl-engine/lib/RenderContext":function(){define(["require","exports"],function(z,d){return function(){function d(d,
q,b,f,h,r){this.camera=null;this.slot=this.pass=0;this.highlightDepthTexture=null;this.renderOccludedMask=13;this.hasOccludees=!1;this.rctx=d;this.offscreenRenderingHelper=q;this.scenelightingData=b;this.shadowMap=f;this.ssaoHelper=h;this.sliceHelper=r}d.prototype.resetRenderOccludedMask=function(){this.renderOccludedMask=13};Object.defineProperty(d.prototype,"isHighlightPass",{get:function(){return 4===this.pass},enumerable:!0,configurable:!0});return d}()})},"esri/views/3d/webgl-engine/lib/renderStats":function(){define(["require",
"exports"],function(z,d){function t(){return{triangles:0,drawCalls:0}}Object.defineProperty(d,"__esModule",{value:!0});d.makeNewRenderStats=t;z=function(){function d(){this.materialRenderStats=new Map;this.reset()}d.prototype.getMaterialRenderStatsObject=function(d){var b=this.materialRenderStats.get(d);b||(b=t(),this.materialRenderStats.set(d,b));return b};d.prototype.getAggregatedStats=function(){var d={materialRenderers:{},total:t()};this.materialRenderStats.forEach(function(b,f){d.materialRenderers[f]=
b;d.total.drawCalls+=b.drawCalls;d.total.triangles+=b.triangles});return d};d.prototype.reset=function(){this.materialRenderStats.forEach(function(d){d.drawCalls=0;d.triangles=0})};return d}();d.RenderStatsAggregator=z})},"esri/views/3d/webgl-engine/lib/SortedRenderGeometryRenderer":function(){define("require exports ../../../../core/MapUtils ../../../../core/PooledArray ./Material ./rendererUtils".split(" "),function(z,d,t,l,q,b){Object.defineProperty(d,"__esModule",{value:!0});var f=function(){return function(){}}();
z=function(){function d(b,c,a){this._rctx=b;this._materialRep=c;this.emitUpdatingChanged=a;this._pendingAddsRemoves=new Map;this._adds=new l;this._removes=new l;this._updates=new l({allocator:function(a){return a||new f},deallocator:function(a){a.renderGeometry=null;return a}});this._materialRenderers=new Map;this._sortedMaterialRenderers=new l;this._hasWater=this._hasHighlights=!1}d.prototype.dispose=function(){this._adds.prune();this._removes.prune();this._updates.prune()};Object.defineProperty(d.prototype,
"updating",{get:function(){return 0<this._pendingAddsRemoves.size||0<this._updates.length},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"hasHighlights",{get:function(){return this._hasHighlights},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"hasWater",{get:function(){return this._hasWater},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"rendersOccluded",{get:function(){return t.someMap(this._materialRenderers,function(b){return b.rendersOccluded})},
enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"isEmpty",{get:function(){return!this.updating&&0===this._materialRenderers.size},enumerable:!0,configurable:!0});d.prototype.commitChanges=function(){var d=this,c=!1;if(!this.updating)return!1;this.updateAddsRemoves();var a=!1,f=!1;b.splitRenderGeometryChangeSetByMaterial({numToAdd:this._adds.length,toAdd:this._adds.data,numToRemove:this._removes.length,toRemove:this._removes.data,numToUpdate:this._updates.length,toUpdate:this._updates.data}).forEach(function(b,
h){var m=d._materialRenderers.get(h);!m&&0<b.toAdd.length&&(m=h.createRenderer(d._rctx,d._materialRep),d._materialRenderers.set(h,m),f=a=c=!0);if(m){var l=a||m.hasHighlights,q=f||m.hasWater;m.modify(b);a=a||l!==m.hasHighlights;f=f||q!==m.hasWater;m.isEmpty&&(d._materialRenderers.delete(h),m.dispose(),c=!0)}});this._adds.clear();this._removes.clear();this._updates.clear();this._pendingAddsRemoves.clear();c&&this.updateSortedMaterialRenderers();a&&(this._hasHighlights=t.someMap(this._materialRenderers,
function(a){return a.hasHighlights}));f&&(this._hasWater=t.someMap(this._materialRenderers,function(a){return a.hasWater}));this.emitUpdatingChanged();return!0};d.prototype.add=function(b){for(var c=0===this._pendingAddsRemoves.size,a=0;a<b.length;a++)this._pendingAddsRemoves.set(b[a],0);c&&0<this._pendingAddsRemoves.size&&this.emitUpdatingChanged()};d.prototype.remove=function(b){for(var c=0===this._pendingAddsRemoves.size,a=0;a<b.length;a++){var d=b[a],f=this._pendingAddsRemoves.get(d);0===f?this._pendingAddsRemoves.set(d,
2):2!==f&&this._pendingAddsRemoves.set(d,1)}c&&0<this._pendingAddsRemoves.size&&this.emitUpdatingChanged()};d.prototype.modify=function(b,c){for(var a=0===this._updates.length,d=0;d<b.length;d++){var f=b[d],h=this._updates.pushNew();h.renderGeometry=f;h.updateType=c}a&&0<this._updates.length&&this.emitUpdatingChanged()};d.prototype.updateLogic=function(b){for(var c=!1,a=0;a<this._sortedMaterialRenderers.length;a++){var d=this._sortedMaterialRenderers.data[a].materialRenderer;d.updateLogic&&d.updateLogic(b)&&
(c=!0)}return c};d.prototype.draw=function(b,c,a){for(var d=0;d<this._sortedMaterialRenderers.length;d++){var f=this._sortedMaterialRenderers.data[d];if(q.materialPredicate(f.material,b)){var h=a.getMaterialRenderStatsObject(f.materialRenderer.type);f.materialRenderer.render(null,b,c,h)}}};d.prototype.updateSortedMaterialRenderers=function(){var b=this;this._sortedMaterialRenderers.clear();this._materialRenderers.forEach(function(c,a){b._sortedMaterialRenderers.push({material:a,materialRenderer:c})});
this._sortedMaterialRenderers.sort(function(c,a){return a.material.renderPriority-c.material.renderPriority})};d.prototype.updateAddsRemoves=function(){var b=this;this._adds.clear();this._removes.clear();this._pendingAddsRemoves.forEach(function(a,c){switch(a){case 0:b._adds.push(c);break;case 1:b._removes.push(c)}});for(var c=0;c<this._updates.length;)this._pendingAddsRemoves.has(this._updates.data[c].renderGeometry)?this._updates.removeUnorderedIndex(c):c++};Object.defineProperty(d.prototype,"test",
{get:function(){return{sortedMaterialRenderers:this._sortedMaterialRenderers}},enumerable:!0,configurable:!0});return d}();d.SortedRenderGeometryRenderer=z})},"esri/views/3d/webgl-engine/lib/rendererUtils":function(){define(["require","exports","./Util"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});d.splitRenderGeometryChangeSetByMaterial=function(d){for(var l=new Map,b=null,f=null,h=function(a){if(a===b)return f;var c=l.get(a);c||(c={toAdd:[],numToAdd:-1,toRemove:[],numToRemove:-1,
toUpdate:[],numToUpdate:-1},l.set(a,c));b=a;return f=c},r=0;r<d.numToAdd;r++){var c=d.toAdd[r];if(1<=t.getFirstObjectValue(c.data.indices).length){var a=h(c.material);a.toAdd.push(c)}}for(r=0;r<d.numToRemove;r++)c=d.toRemove[r],1<=t.getFirstObjectValue(c.data.indices).length&&(a=h(c.material),a.toRemove.push(c));for(r=0;r<d.numToUpdate;r++)c=d.toUpdate[r],1<=t.getFirstObjectValue(c.renderGeometry.data.indices).length&&(a=h(c.renderGeometry.material),a.toUpdate.push(c));return l}})},"esri/views/3d/webgl-engine/lib/TextureTechnique":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/tsSupport/assignHelper ../core/shaderLibrary/util/TextureOnly.glsl ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../core/shaderTechnique/ShaderTechniqueConfiguration ./DefaultVertexAttributeLocations ../../../webgl/Program ../../../webgl/renderState".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m){Object.defineProperty(d,"__esModule",{value:!0});q=function(d){function h(){return null!==d&&d.apply(this,arguments)||this}t(h,d);h.prototype.initializeProgram=function(b){var d=h.shader.get().build();return new a(b.rctx,d.generateSource("vertex"),d.generateSource("fragment"),c.Default3D)};h.prototype.initializePipeline=function(){return this.configuration.hasAlpha?m.makePipelineState({blending:m.separateBlendingParams(770,1,771,771),colorWrite:m.defaultColorWriteParams}):
m.makePipelineState({colorWrite:m.defaultColorWriteParams})};h.shader=new f.ReloadableShaderModule(b,"../core/shaderLibrary/util/TextureOnly.glsl",z);return h}(h.ShaderTechnique);d.TextureTechnique=q;q=function(a){function c(){var c=null!==a&&a.apply(this,arguments)||this;c.hasAlpha=!1;return c}t(c,a);l([r.parameter()],c.prototype,"hasAlpha",void 0);return c}(r.ShaderTechniqueConfiguration);d.TextureTechniqueConfiguration=q})},"esri/views/3d/webgl-engine/core/shaderLibrary/util/TextureOnly.glsl":function(){define("require exports ../../../../../../core/tsSupport/makeTemplateObjectHelper ../ScreenSpacePass ../../shaderModules/interfaces ../../shaderModules/ShaderBuilder".split(" "),
function(z,d,t,l,q,b){Object.defineProperty(d,"__esModule",{value:!0});d.build=function(){var d=new b.ShaderBuilder;d.include(l.ScreenSpacePass);d.fragment.uniforms.add("tex","sampler2D");d.fragment.uniforms.add("color","vec4");d.fragment.code.add(q.glsl(f||(f=t(["\n    void main() {\n      vec4 texColor \x3d texture2D(tex, uv);\n      gl_FragColor \x3d texColor * color;\n    }\n  "],["\n    void main() {\n      vec4 texColor \x3d texture2D(tex, uv);\n      gl_FragColor \x3d texColor * color;\n    }\n  "]))));
return d};var f})},"esri/views/3d/webgl-engine/core/shaderLibrary/ScreenSpacePass":function(){define(["require","exports","../../../../../core/tsSupport/makeTemplateObjectHelper","../shaderModules/interfaces"],function(z,d,t,l){Object.defineProperty(d,"__esModule",{value:!0});d.ScreenSpacePass=function(b){b.attributes.add("position","vec2");b.varyings.add("uv","vec2");b.vertex.code.add(l.glsl(q||(q=t(["\n    void main(void) {\n      gl_Position \x3d vec4(position, 0.0, 1.0);\n      uv \x3d position * 0.5 + vec2(0.5);\n    } \n  "],
["\n    void main(void) {\n      gl_Position \x3d vec4(position, 0.0, 1.0);\n      uv \x3d position * 0.5 + vec2(0.5);\n    } \n  "]))))};var q})},"esri/views/3d/webgl-engine/lighting/Lightsources":function(){define(["require","exports","../../../../core/libs/gl-matrix-2/vec3f64"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});z=function(){return function(d,q,b){void 0===d&&(d=t.vec3f64.create());void 0===q&&(q=t.vec3f64.fromValues(.57735,.57735,.57735));void 0===b&&(b=!0);this.intensity=
d;this.direction=q;this.castShadows=b}}();d.MainLight=z;z=function(){return function(d,q){void 0===d&&(d=t.vec3f64.create());void 0===q&&(q=t.vec3f64.fromValues(.57735,.57735,.57735));this.intensity=t.vec3f64.create();this.direction=t.vec3f64.create();this.intensity=d;this.direction=q}}();d.FillLight=z;z=function(){return function(d){void 0===d&&(d=t.vec3f64.create());this.intensity=d}}();d.AmbientLight=z;z=function(){return function(){this.sh={r:[0],g:[0],b:[0]}}}();d.SphericalHarmonicsLight=z})},
"esri/views/3d/webgl-engine/lighting/SceneLighting":function(){define(["require","exports","../../../../core/libs/gl-matrix-2/vec3","../../../../core/libs/gl-matrix-2/vec3f64","./SphericalHarmonics"],function(z,d,t,l,q){Object.defineProperty(d,"__esModule",{value:!0});var b=l.vec3f64.create();z=function(){function d(){this._renderLighting={main:{intensity:l.vec3f64.create(),direction:l.vec3f64.fromValues(1,0,0),castShadows:!1},sphericalHarmonics:{sh:{r:[0],g:[0],b:[0]}}};this._shOrder=2;this._oldSunlight=
{direction:l.vec3f64.create(),ambient:{color:l.vec3f64.create(),intensity:0},diffuse:{color:l.vec3f64.create(),intensity:0}}}d.prototype.setLightDirectionUniform=function(b){b.setUniform3fv("lightingMainDirection",this._renderLighting.main.direction)};d.prototype.setUniforms=function(b,d){void 0===d&&(d=!1);d?b.setUniform1f("lightingFixedFactor",(1-this._info.groundLightingFactor)*(1-this._info.globalFactor)):b.setUniform1f("lightingFixedFactor",0);b.setUniform1f("lightingGlobalFactor",this._info.globalFactor);
this.setLightDirectionUniform(b);b.setUniform3fv("lightingMainIntensity",this._renderLighting.main.intensity);b.setUniform1f("ambientBoostFactor",.4);d=this._renderLighting.sphericalHarmonics.sh;0===this._shOrder?b.setUniform3f("lightingAmbientSH0",d.r[0],d.g[0],d.b[0]):1===this._shOrder?(b.setUniform4f("lightingAmbientSH_R",d.r[0],d.r[1],d.r[2],d.r[3]),b.setUniform4f("lightingAmbientSH_G",d.g[0],d.g[1],d.g[2],d.g[3]),b.setUniform4f("lightingAmbientSH_B",d.b[0],d.b[1],d.b[2],d.b[3])):2===this._shOrder&&
(b.setUniform3f("lightingAmbientSH0",d.r[0],d.g[0],d.b[0]),b.setUniform4f("lightingAmbientSH_R1",d.r[1],d.r[2],d.r[3],d.r[4]),b.setUniform4f("lightingAmbientSH_G1",d.g[1],d.g[2],d.g[3],d.g[4]),b.setUniform4f("lightingAmbientSH_B1",d.b[1],d.b[2],d.b[3],d.b[4]),b.setUniform4f("lightingAmbientSH_R2",d.r[5],d.r[6],d.r[7],d.r[8]),b.setUniform4f("lightingAmbientSH_G2",d.g[5],d.g[6],d.g[7],d.g[8]),b.setUniform4f("lightingAmbientSH_B2",d.b[5],d.b[6],d.b[7],d.b[8]))};d.prototype.set=function(d){this._info=
d;q.combineLights(d.lights,this._shOrder,this._renderLighting);t.vec3.negate(this._oldSunlight.direction,this._renderLighting.main.direction);d=1/Math.PI;this._oldSunlight.ambient.color[0]=.282095*this._renderLighting.sphericalHarmonics.sh.r[0]*d;this._oldSunlight.ambient.color[1]=.282095*this._renderLighting.sphericalHarmonics.sh.g[0]*d;this._oldSunlight.ambient.color[2]=.282095*this._renderLighting.sphericalHarmonics.sh.b[0]*d;this._oldSunlight.ambient.intensity=1;this._oldSunlight.diffuse.color[0]=
this._renderLighting.main.intensity[0]*d;this._oldSunlight.diffuse.color[1]=this._renderLighting.main.intensity[1]*d;this._oldSunlight.diffuse.color[2]=this._renderLighting.main.intensity[2]*d;this._oldSunlight.diffuse.intensity=1;d=t.vec3.copy(b,this._oldSunlight.diffuse.color);t.vec3.scale(d,d,.4*this._info.globalFactor);t.vec3.add(this._oldSunlight.ambient.color,this._oldSunlight.ambient.color,d)};Object.defineProperty(d.prototype,"globalFactor",{get:function(){return this._info.globalFactor},
enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"old",{get:function(){return this._oldSunlight},enumerable:!0,configurable:!0});return d}();d.SceneLighting=z})},"esri/views/3d/webgl-engine/lighting/SphericalHarmonics":function(){define("require exports ../../../../core/mathUtils ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../lib/LongVectorMath ./Lightsources".split(" "),function(z,d,t,l,q,b,f){function h(a){return(a+1)*(a+1)}function r(a){return t.clamp(Math.floor(Math.sqrt(a)-
1),0,2)}function c(a,c,b){var d=a[0],f=a[1];a=a[2];b=b||[];b.length=h(c);0<=c&&(b[0]=.28209479177);1<=c&&(b[1]=.4886025119*d,b[2]=.4886025119*a,b[3]=.4886025119*f);2<=c&&(b[4]=1.09254843059*d*f,b[5]=1.09254843059*f*a,b[6]=.31539156525*(3*a*a-1),b[7]=1.09254843059*d*a,b[8]=.54627421529*(d*d-f*f));return b}function a(a,c){a=h(a);c=c||{r:[],g:[],b:[]};c.r.length=c.g.length=c.b.length=a;for(var b=0;b<a;b++)c.r[b]=c.g[b]=c.b[b]=0;return c}function m(a,d){for(var f=r(d.r.length),h=0;h<a.length;h++){var m=
a[h];l.vec3.negate(J,m.direction);c(J,f,E);b.elementwiseProduct(E,K);b.scalarProduct(E,m.intensity[0],C);b.add(d.r,C);b.scalarProduct(E,m.intensity[1],C);b.add(d.g,C);b.scalarProduct(E,m.intensity[2],C);b.add(d.b,C)}return d}function u(a,b){c(J,0,E);for(var d=0;d<a.length;d++){var f=a[d];b.r[0]+=E[0]*K[0]*f.intensity[0]*4*Math.PI;b.g[0]+=E[0]*K[0]*f.intensity[1]*4*Math.PI;b.b[0]+=E[0]*K[0]*f.intensity[2]*4*Math.PI}return b}Object.defineProperty(d,"__esModule",{value:!0});d.numberOfCoefficients=h;
d.numberOfCoefficientsInBand=function(a){return 2*a+1};d.orderFromNumberOfCoefficients=r;d.computeCoefficients=c;d.initSHCoefficients=a;d.projectFillLights=m;d.projectAmbientLights=u;d.combineLights=function(c,d,h){a(d,h.sphericalHarmonics.sh);l.vec3.set(h.main.intensity,0,0,0);var q=!1,r=D,t=w;d=v;r.length=0;t.length=0;for(var x=d.length=0;x<c.length;x++){var C=c[x];C instanceof f.MainLight&&!q?(l.vec3.copy(h.main.direction,C.direction),h.main.intensity[0]=C.intensity[0],h.main.intensity[1]=C.intensity[1],
h.main.intensity[2]=C.intensity[2],h.main.castShadows=C.castShadows,q=!0):C instanceof f.MainLight||C instanceof f.FillLight?r.push(C):C instanceof f.AmbientLight?t.push(C):C instanceof f.SphericalHarmonicsLight&&d.push(C)}m(r,h.sphericalHarmonics.sh);u(t,h.sphericalHarmonics.sh);for(c=0;c<d.length;c++)C=d[c],b.add(h.sphericalHarmonics.sh.r,C.sh.r),b.add(h.sphericalHarmonics.sh.g,C.sh.g),b.add(h.sphericalHarmonics.sh.b,C.sh.b)};var D=[],w=[],v=[],E=[0],C=[0],J=q.vec3f64.create(),K=[3.141593,2.094395,
2.094395,2.094395,.785398,.785398,.785398,.785398,.785398]})},"esri/views/3d/webgl-engine/lib/LongVectorMath":function(){define(["require","exports"],function(z,d){Object.defineProperty(d,"__esModule",{value:!0});d.dotProduct=function(d,l){for(var q=0,b=0;b<d.length;b++)q+=d[b]*l[b];return q};d.elementwiseProduct=function(d,l,q){q=q||d;q.length=d.length;for(var b=0;b<d.length;b++)q[b]=d[b]*l[b];return q};d.scalarProduct=function(d,l,q){q=q||d;q.length=d.length;for(var b=0;b<d.length;b++)q[b]=d[b]*
l;return q};d.add=function(d,l,q){q=q||d;q.length=d.length;for(var b=0;b<d.length;b++)q[b]=d[b]+l[b];return q}})},"esri/views/3d/webgl-engine/materials/lineStippleUtils":function(){define(["require","exports","../../../../core/maybe","../../../webgl"],function(z,d,t,l){Object.defineProperty(d,"__esModule",{value:!0});z=function(){function d(){this.cache=new Map}d.prototype.dispose=function(){this.cache.forEach(function(b){t.isSome(b.texture)&&(b.texture.dispose(),b.texture=null)});this.cache.clear()};
d.prototype.acquire=function(b){if(t.isNone(b))return null;var d=this.patternId(b),h=this.cache.get(d);if(h)return h.refCount++,h.bind;var q=this.patternToTextureData(b,2),c=q.length/2,a={refCount:1,texture:null,bind:function(b,d){t.isNone(a.texture)&&(a.texture=new l.Texture(b,{width:q.length,height:1,internalFormat:6406,pixelFormat:6406,dataType:5121,wrapMode:33071},q));b.bindTexture(a.texture,d);return c}};this.cache.set(d,a);return a.bind};d.prototype.release=function(b){if(!t.isNone(b)){b=this.patternId(b);
var d=this.cache.get(b);d&&(d.refCount--,0===d.refCount&&(t.isSome(d.texture)&&d.texture.dispose(),this.cache.delete(b)))}};d.prototype.swap=function(b,d){d=this.acquire(d);this.release(b);return d};d.prototype.bind=function(b,d,h,l,c){b=t.isSome(l)?l(b,c)*d.pixelRatio:1;h.setUniform1i("stipplePatternTexture",c);h.setUniform1f("stipplePatternPixelSizeInv",1/b)};d.prototype.patternId=function(b){return b.join(",")};d.prototype.patternToTextureData=function(b,d){for(var f=b.reduce(function(a,c){return a+
c})*d,f=new Uint8Array(f),l=!0,c=0,a=0;a<b.length;a++){for(var m=b[a],q=0;q<m*d;q++)f[c++]=l?255:0;l=!l}return f};return d}();d.StippleTextureRepository=z;d.createStipplePattern=function(d){return t.isNone(d)?d:d.slice()};d.createStipplePatternSimple=function(d){return[d,d]}})},"esri/views/webgl":function(){define("require exports ./webgl/BufferObject ./webgl/enums ./webgl/FramebufferObject ./webgl/Program ./webgl/Renderbuffer ./webgl/RenderingContext ./webgl/ShaderCompiler ./webgl/Texture ./webgl/VertexArrayObject ./webgl/ProgramCache ./webgl/programUtils ./webgl/context-util".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u,D){Object.defineProperty(d,"__esModule",{value:!0});d.BufferObject=t;d.enums=l;d.FramebufferObject=q;d.Program=b;d.Renderbuffer=f;d.RenderingContext=h;d.ShaderCompiler=r;d.Texture=c;d.VertexArrayObject=a;d.ProgramCache=m.ProgramCache;d.createProgram=u.createProgram;d.glslifyDefineMap=u.glslifyDefineMap;d.createContextOrErrorHTML=D.createContextOrErrorHTML})},"esri/views/webgl/enums":function(){define(["require","exports"],function(z,d){Object.defineProperty(d,"__esModule",
{value:!0});d.BASE_TEXTURE_UNIT=33984})},"esri/views/webgl/FramebufferObject":function(){define(["require","exports","../../core/has","./Renderbuffer","./Texture"],function(z,d,t,l,q){return function(){function b(d,h,r,c){this._colorAttachment=this._stencilAttachment=this._depthAttachment=this._glName=this._context=null;this._initialized=!1;this._context=d;this._desc={colorTarget:h.colorTarget,depthStencilTarget:h.depthStencilTarget,width:h.width,height:h.height,multisampled:h.multisampled};this._id=
b._nextId++;r&&(d=void 0,r instanceof q?(this._colorAttachment=r,d=r.descriptor):(d=r,this._colorAttachment=new q(this._context,d)),0!==this._desc.colorTarget&&console.error("Framebuffer is initialized with a texture however the descriptor indicates using a renderbuffer color attachment!"),b._validateTextureDimensions(d,this._desc));c instanceof l?(2===h.depthStencilTarget?this._stencilAttachment=c:1===h.depthStencilTarget||3===h.depthStencilTarget?this._depthAttachment=c:console.error('If a Renderbuffer is provided, "depthStencilTarget" must be one of STENCIL_RENDER_BUFFER, DEPTH_RENDER_BUFFER or DEPTH_STENCIL_RENDER_BUFFER'),
b._validateBufferDimensions(c.descriptor,this._desc)):c&&(this._context.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!"),h=void 0,c instanceof q?(this._depthStencilTexture=c,h=this._depthStencilTexture.descriptor):(h=c,this._depthStencilTexture=new q(this._context,h)),b._validateTextureDimensions(h,this._desc))}Object.defineProperty(b.prototype,"id",{get:function(){return this._id},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"descriptor",{get:function(){return this._desc},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"colorTexture",{get:function(){return this._colorAttachment instanceof q?this._colorAttachment:null},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"colorAttachment",{get:function(){return this._colorAttachment},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"depthStencilAttachment",{get:function(){return this._depthStencilTexture||this._depthAttachment||this._stencilAttachment},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"depthStencilTexture",{get:function(){return this._depthStencilTexture},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"width",{get:function(){return this._desc.width},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"height",{get:function(){return this._desc.height},enumerable:!0,configurable:!0});b.prototype.dispose=function(){if(this._context){var b=this._context,d=b.getBoundFramebufferObject();this._disposeColorAttachment();this._disposeDepthStencilAttachments();this._glName&&(b.gl.deleteFramebuffer(this._glName),this._glName=null);b.bindFramebuffer(d);this._context=null}};b.prototype.attachColorTexture=function(d){if(d){b._validateTextureDimensions(d.descriptor,this._desc);this._disposeColorAttachment();
if(this._initialized){this._context.bindFramebuffer(this);var f=this._context.gl;f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,d.glName,0)}this._colorAttachment=d}};b.prototype.detachColorTexture=function(){if(this._colorAttachment instanceof q){var b=this._colorAttachment;if(this._initialized){this._context.bindFramebuffer(this);var d=this._context.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,null,0)}this._colorAttachment=null;return b}};b.prototype.attachDepthStencilTexture=
function(d){if(d){var f=d.descriptor;34041!==f.pixelFormat&&console.error("Depth/Stencil texture must have a pixel type of DEPTH_STENCIL!");34042!==f.dataType&&console.error("Depth/Stencil texture must have data type of UNSIGNED_INT_24_8_WEBGL!");this._context.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture!");b._validateTextureDimensions(f,this._desc);4!==this._desc.depthStencilTarget&&(this._desc.depthStencilTarget=
4);this._disposeDepthStencilAttachments();this._initialized&&(this._context.bindFramebuffer(this),f=this._context.gl,f.framebufferTexture2D(f.FRAMEBUFFER,f.DEPTH_STENCIL_ATTACHMENT,f.TEXTURE_2D,d.glName,0));this._depthStencilTexture=d}};b.prototype.detachDepthStencilTexture=function(){var b=this._depthStencilTexture;if(b&&this._initialized){this._context.bindFramebuffer(this);var d=this._context.gl;this._context.gl.framebufferTexture2D(d.FRAMEBUFFER,d.DEPTH_STENCIL_ATTACHMENT,d.TEXTURE_2D,null,0)}this._depthStencilTexture=
null;return b};b.prototype.attachDepthStencilBuffer=function(d){if(d){var f=d.descriptor;34041!==f.internalFormat&&33189!==f.internalFormat&&console.error("Depth/Stencil buffer must have correct internalFormat");b._validateBufferDimensions(f,this._desc);this._disposeDepthStencilAttachments();this._desc.depthStencilTarget=34041===f.internalFormat?3:1;this._initialized&&(this._context.bindFramebuffer(this),f=this._context.gl,f.framebufferRenderbuffer(f.FRAMEBUFFER,1===this._desc.depthStencilTarget?
f.DEPTH_ATTACHMENT:f.DEPTH_STENCIL_ATTACHMENT,f.RENDERBUFFER,d.glName));this._depthAttachment=d}};b.prototype.detachDepthStencilBuffer=function(){var b=this._context.gl,d=this._depthAttachment;d&&this._initialized&&(this._context.bindFramebuffer(this),b.framebufferRenderbuffer(b.FRAMEBUFFER,1===this._desc.depthStencilTarget?b.DEPTH_ATTACHMENT:b.DEPTH_STENCIL_ATTACHMENT,b.RENDERBUFFER,null));this._depthAttachment=null;return d};b.prototype.copyToTexture=function(b,d,l,c,a,m,q){(0>b||0>d||0>a||0>m)&&
console.error("Offsets cannot be negative!");(0>=l||0>=c)&&console.error("Copy width and height must be greater than zero!");var f=this._desc,h=q.descriptor;3553!==q.descriptor.target&&console.error("Texture target must be TEXTURE_2D!");(b+l>f.width||d+c>f.height||a+l>h.width||m+c>h.height)&&console.error("Bad dimensions, the current input values will attempt to read or copy out of bounds!");f=this._context;f.bindTexture(q);f.bindFramebuffer(this);f.gl.copyTexSubImage2D(3553,0,a,m,b,d,l,c)};b.prototype.readPixels=
function(b,d,l,c,a,m,q){(0>=l||0>=c)&&console.error("Copy width and height must be greater than zero!");q||console.error("Target memory is not initialized!");this._context.bindFramebuffer(this);this._context.gl.readPixels(b,d,l,c,a,m,q)};b.prototype.resize=function(d,h){var f=this._desc;if(f.width!==d||f.height!==h)if(this._initialized)f.width=d,f.height=h,this._colorAttachment instanceof q?(c=this._colorAttachment,f=c.descriptor,f.width=d,f.height=h,this._colorAttachment.dispose(),this._colorAttachment=
new q(this._context,f),b._validateTextureDimensions(c.descriptor,this._desc)):this._colorAttachment&&this._disposeColorAttachment(),null!=this._depthStencilTexture?(f=this._depthStencilTexture.descriptor,f.width=d,f.height=h,this._depthStencilTexture.dispose(),this._depthStencilTexture=new q(this._context,f)):(this._depthAttachment||this._stencilAttachment)&&this._disposeDepthStencilAttachments(),this._context.getBoundFramebufferObject()===this&&this._context.bindFramebuffer(null),this._initialized=
!1;else{f.width=d;f.height=h;if(this._colorAttachment instanceof q){var c=this._colorAttachment;c.resize(d,h)}this._depthStencilTexture&&this._depthStencilTexture.resize(d,h)}};b.prototype.initialize=function(){if(this._initialized)return!1;var b=this._context.gl;this._glName&&b.deleteFramebuffer(this._glName);var d=b.createFramebuffer(),r=this._desc;b.bindFramebuffer(b.FRAMEBUFFER,d);if(!this._colorAttachment)if(0===r.colorTarget)this._colorAttachment=new q(this._context,{target:3553,pixelFormat:6408,
dataType:5121,samplingMode:9728,wrapMode:33071,width:r.width,height:r.height});else{var c=new l(this._context,{internalFormat:32854,width:r.width,height:r.height});b.framebufferRenderbuffer(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.RENDERBUFFER,c.glName);this._colorAttachment=c}this._colorAttachment instanceof q&&b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,this._colorAttachment.glName,0);switch(r.depthStencilTarget){case 1:case 3:this._depthAttachment||(this._depthAttachment=new l(this._context,
{internalFormat:1===r.depthStencilTarget?33189:34041,width:r.width,height:r.height}));b.framebufferRenderbuffer(b.FRAMEBUFFER,1===r.depthStencilTarget?b.DEPTH_ATTACHMENT:b.DEPTH_STENCIL_ATTACHMENT,b.RENDERBUFFER,this._depthAttachment.glName);break;case 2:this._stencilAttachment||(this._stencilAttachment=new l(this._context,{internalFormat:36168,width:r.width,height:r.height}));b.framebufferRenderbuffer(b.FRAMEBUFFER,b.STENCIL_ATTACHMENT,b.RENDERBUFFER,this._stencilAttachment.glName);break;case 4:this._depthStencilTexture||
(this._context.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!"),this._depthStencilTexture=new q(this._context,{target:3553,pixelFormat:34041,dataType:34042,samplingMode:9728,wrapMode:33071,width:r.width,height:r.height})),b.framebufferTexture2D(b.FRAMEBUFFER,b.DEPTH_STENCIL_ATTACHMENT,b.TEXTURE_2D,this._depthStencilTexture.glName,0)}b.checkFramebufferStatus(b.FRAMEBUFFER)!==b.FRAMEBUFFER_COMPLETE&&
console.error("Framebuffer is incomplete!");this._glName=d;return this._initialized=!0};b.prototype._disposeColorAttachment=function(){if(this._colorAttachment instanceof q){var b=this._colorAttachment;if(this._initialized){this._context.bindFramebuffer(this);var d=this._context.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,null,0)}b.dispose()}else this._colorAttachment instanceof WebGLRenderbuffer&&(b=this._colorAttachment,d=this._context.gl,this._initialized&&(this._context.bindFramebuffer(this),
d.framebufferRenderbuffer(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.RENDERBUFFER,null)),this._context.gl.deleteRenderbuffer(b));this._colorAttachment=null};b.prototype._disposeDepthStencilAttachments=function(){var b=this._context.gl;this._depthAttachment&&(this._initialized&&(this._context.bindFramebuffer(this),b.framebufferRenderbuffer(b.FRAMEBUFFER,1===this._desc.depthStencilTarget?b.DEPTH_ATTACHMENT:b.DEPTH_STENCIL_ATTACHMENT,b.RENDERBUFFER,null)),this._depthAttachment.dispose(),this._depthAttachment=
null);this._stencilAttachment&&(this._initialized&&(this._context.bindFramebuffer(this),b.framebufferRenderbuffer(b.FRAMEBUFFER,b.STENCIL_ATTACHMENT,b.RENDERBUFFER,null)),this._stencilAttachment.dispose(),this._stencilAttachment=null);this._depthStencilTexture&&(this._initialized&&(this._context.bindFramebuffer(this),b.framebufferTexture2D(b.FRAMEBUFFER,b.DEPTH_STENCIL_ATTACHMENT,b.TEXTURE_2D,null,0)),this._depthStencilTexture.dispose(),this._depthStencilTexture=null)};b._validateBufferDimensions=
function(b,d){console.assert(0<=b.width&&0<=b.height);void 0!==d.width&&0<=d.width&&void 0!==d.height&&0<=d.height?d.width===b.width&&d.height===b.height||console.error("Renderbuffer dimensions must match the framebuffer's!"):(d.width=b.width,d.height=b.height)};b._validateTextureDimensions=function(b,d){console.assert(0<=b.width&&0<=b.height);3553!==b.target&&console.error("Texture type must be TEXTURE_2D!");void 0!==d.width&&0<=d.width&&void 0!==d.height&&0<=d.height?d.width===b.width&&d.height===
b.height||console.error("Color attachment texture must match the framebuffer's!"):(d.width=b.width,d.height=b.height)};b._nextId=0;return b}()})},"esri/views/webgl/Renderbuffer":function(){define(["require","exports","../../core/has"],function(z,d,t){return function(){function d(l,b){this._context=l;this._desc=b;this._glName=null;this._id=-1;l=this._context.gl;this._id=++d._nextId;this._glName=l.createRenderbuffer();this._context.bindRenderbuffer(this);l.renderbufferStorage(l.RENDERBUFFER,b.internalFormat,
b.width,b.height)}Object.defineProperty(d.prototype,"descriptor",{get:function(){return this._desc},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});d.prototype.resize=function(d,b){var f=this._context.gl,h=this._desc;if(h.width!==d||h.height!==b)h.width=d,h.height=b,this._context.bindRenderbuffer(this),
f.renderbufferStorage(f.RENDERBUFFER,h.internalFormat,h.width,h.height)};d.prototype.dispose=function(){this._glName&&(this._context.gl.deleteRenderbuffer(this._glName),this._glName=null);this._context=null};d._nextId=0;return d}()})},"esri/views/webgl/RenderingContext":function(){define("require exports ../../core/has ../../core/maybe ./enums ./InstanceCounter ./renderState ./capabilities/isWebGL2Context ./capabilities/load".split(" "),function(z,d,t,l,q,b,f,h,r){return function(){function c(a,c){var b=
this;this.gl=null;this._blendEnabled=!1;this._blendColorState={r:0,g:0,b:0,a:0};this._blendFunctionState={srcRGB:1,dstRGB:0,srcAlpha:1,dstAlpha:0};this._blendEquationState={mode:32774,modeAlpha:32774};this._colorMaskState={r:!0,g:!0,b:!0,a:!0};this._polygonCullingEnabled=!1;this._cullFace=1029;this._frontFace=2305;this._scissorTestEnabled=!1;this._scissorRect={x:0,y:0,width:0,height:0};this._depthTestEnabled=!1;this._depthFunction=513;this._clearDepth=1;this._depthWriteEnabled=!0;this._depthRange=
{zNear:0,zFar:1};this._viewport=null;this._polygonOffsetFillEnabled=this._stencilTestEnabled=!1;this._polygonOffset=[0,0];this._stencilFunction={face:1032,func:519,ref:0,mask:1};this._clearStencil=0;this._stencilWriteMask=1;this._stencilOperation={face:1032,fail:7680,zFail:7680,zPass:7680};this._clearColor={r:0,g:0,b:0,a:0};this._activeRenderbuffer=this._activeFramebuffer=this._activeIndexBuffer=this._activeVertexBuffer=this._activeShaderProgram=null;this._activeTextureUnit=0;this._textureUnitMap=
{};this._numOfTriangles=this._numOfDrawCalls=0;this.contextVersion=h.default(a)?"webgl2":"webgl";this.gl=a;a instanceof WebGLRenderingContext&&this.gl.getExtension("OES_element_index_uint");this._capabilities=r.loadCapabilities(a,c);a=this.gl.getParameter(this.gl.VIEWPORT);this._viewport={x:a[0],y:a[1],width:a[2],height:a[3]};this._stateTracker=new f.StateTracker({setBlending:function(a){a?(b.setBlendingEnabled(!0),b.setBlendEquationSeparate(a.opRgb,a.opAlpha),b.setBlendFunctionSeparate(a.srcRgb,
a.dstRgb,a.srcAlpha,a.dstAlpha),a=a.color,b.setBlendColor(a.r,a.g,a.b,a.a)):b.setBlendingEnabled(!1)},setCulling:function(a){a?(b.setFaceCullingEnabled(!0),b.setCullFace(a.face),b.setFrontFace(a.mode)):b.setFaceCullingEnabled(!1)},setPolygonOffset:function(a){a?(b.setPolygonOffsetFillEnabled(!0),b.setPolygonOffset(a.factor,a.units)):b.setPolygonOffsetFillEnabled(!1)},setDepthTest:function(a){a?(b.setDepthTestEnabled(!0),b.setDepthFunction(a.func)):b.setDepthTestEnabled(!1)},setStencilTest:function(a){if(a){b.setStencilTestEnabled(!0);
var c=a.function;b.setStencilFunction(c.func,c.ref,c.mask);a=a.operation;b.setStencilOp(a.fail,a.zFail,a.zPass)}else b.setStencilTestEnabled(!1)},setDepthWrite:function(a){a?(b.setDepthWriteEnabled(!0),b.setDepthRange(a.zNear,a.zFar)):b.setDepthWriteEnabled(!1)},setColorWrite:function(a){a?b.setColorMask(a.r,a.g,a.b,a.a):b.setColorMask(!1,!1,!1,!1)},setStencilWrite:function(a){a?b.setStencilWriteMask(a.mask):b.setStencilWriteMask(0)}});this.enforceState()}Object.defineProperty(c.prototype,"contextAttributes",
{get:function(){return this.gl.getContextAttributes()},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"parameters",{get:function(){if(!this._parameters){var a=this.capabilities.textureFilterAnisotropic;this._parameters={versionString:this.gl.getParameter(this.gl.VERSION),maxVertexTextureImageUnits:this.gl.getParameter(this.gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxVertexAttributes:this.gl.getParameter(this.gl.MAX_VERTEX_ATTRIBS),maxMaxAnisotropy:a?this.gl.getParameter(a.MAX_TEXTURE_MAX_ANISOTROPY):
void 0,maxTextureImageUnits:this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS)}}return this._parameters},enumerable:!0,configurable:!0});c.prototype.dispose=function(){this.bindVAO(null);this.unbindBuffer(34962);this.unbindBuffer(34963);this._textureUnitMap={};this.gl=null};c.prototype.setPipelineState=function(a){this._stateTracker.setPipeline(a)};c.prototype.setBlendingEnabled=function(a){this._blendEnabled!==a&&(!0===a?this.gl.enable(this.gl.BLEND):this.gl.disable(this.gl.BLEND),this._blendEnabled=
a,this._stateTracker.invalidateBlending())};c.prototype.setBlendColor=function(a,c,b,d){if(a!==this._blendColorState.r||c!==this._blendColorState.g||b!==this._blendColorState.b||d!==this._blendColorState.a)this.gl.blendColor(a,c,b,d),this._blendColorState.r=a,this._blendColorState.g=c,this._blendColorState.b=b,this._blendColorState.a=d,this._stateTracker.invalidateBlending()};c.prototype.setBlendFunction=function(a,c){if(a!==this._blendFunctionState.srcRGB||c!==this._blendFunctionState.dstRGB)this.gl.blendFunc(a,
c),this._blendFunctionState.srcRGB=a,this._blendFunctionState.srcAlpha=a,this._blendFunctionState.dstRGB=c,this._blendFunctionState.dstAlpha=c,this._stateTracker.invalidateBlending()};c.prototype.setBlendFunctionSeparate=function(a,c,b,d){if(this._blendFunctionState.srcRGB!==a||this._blendFunctionState.srcAlpha!==b||this._blendFunctionState.dstRGB!==c||this._blendFunctionState.dstAlpha!==d)this.gl.blendFuncSeparate(a,c,b,d),this._blendFunctionState.srcRGB=a,this._blendFunctionState.srcAlpha=b,this._blendFunctionState.dstRGB=
c,this._blendFunctionState.dstAlpha=d,this._stateTracker.invalidateBlending()};c.prototype.setBlendEquation=function(a){this._blendEquationState.mode!==a&&(this.gl.blendEquation(a),this._blendEquationState.mode=a,this._blendEquationState.modeAlpha=a,this._stateTracker.invalidateBlending())};c.prototype.setBlendEquationSeparate=function(a,c){if(this._blendEquationState.mode!==a||this._blendEquationState.modeAlpha!==c)this.gl.blendEquationSeparate(a,c),this._blendEquationState.mode=a,this._blendEquationState.modeAlpha=
c,this._stateTracker.invalidateBlending()};c.prototype.setColorMask=function(a,c,b,d){if(this._colorMaskState.r!==a||this._colorMaskState.g!==c||this._colorMaskState.b!==b||this._colorMaskState.a!==d)this.gl.colorMask(a,c,b,d),this._colorMaskState.r=a,this._colorMaskState.g=c,this._colorMaskState.b=b,this._colorMaskState.a=d,this._stateTracker.invalidateColorWrite()};c.prototype.setClearColor=function(a,c,b,d){if(this._clearColor.r!==a||this._clearColor.g!==c||this._clearColor.b!==b||this._clearColor.a!==
d)this.gl.clearColor(a,c,b,d),this._clearColor.r=a,this._clearColor.g=c,this._clearColor.b=b,this._clearColor.a=d};c.prototype.setFaceCullingEnabled=function(a){this._polygonCullingEnabled!==a&&(!0===a?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this._polygonCullingEnabled=a,this._stateTracker.invalidateCulling())};c.prototype.setPolygonOffsetFillEnabled=function(a){this._polygonOffsetFillEnabled!==a&&(!0===a?this.gl.enable(this.gl.POLYGON_OFFSET_FILL):this.gl.disable(this.gl.POLYGON_OFFSET_FILL),
this._polygonOffsetFillEnabled=a,this._stateTracker.invalidatePolygonOffset())};c.prototype.setPolygonOffset=function(a,c){if(this._polygonOffset[0]!==a||this._polygonOffset[1]!==c)this._polygonOffset[0]=a,this._polygonOffset[1]=c,this.gl.polygonOffset(a,c),this._stateTracker.invalidatePolygonOffset()};c.prototype.setCullFace=function(a){this._cullFace!==a&&(this.gl.cullFace(a),this._cullFace=a,this._stateTracker.invalidateCulling())};c.prototype.setFrontFace=function(a){this._frontFace!==a&&(this.gl.frontFace(a),
this._frontFace=a,this._stateTracker.invalidateCulling())};c.prototype.setScissorTestEnabled=function(a){this._scissorTestEnabled!==a&&(!0===a?this.gl.enable(this.gl.SCISSOR_TEST):this.gl.disable(this.gl.SCISSOR_TEST),this._scissorTestEnabled=a)};c.prototype.setScissorRect=function(a,c,b,d){if(this._scissorRect.x!==a||this._scissorRect.y!==c||this._scissorRect.width!==b||this._scissorRect.height!==d)this.gl.scissor(a,c,b,d),this._scissorRect.x=a,this._scissorRect.y=c,this._scissorRect.width=b,this._scissorRect.height=
d};c.prototype.setDepthTestEnabled=function(a){this._depthTestEnabled!==a&&(!0===a?this.gl.enable(this.gl.DEPTH_TEST):this.gl.disable(this.gl.DEPTH_TEST),this._depthTestEnabled=a,this._stateTracker.invalidateDepthTest())};c.prototype.setClearDepth=function(a){this._clearDepth!==a&&(this.gl.clearDepth(a),this._clearDepth=a)};c.prototype.setDepthFunction=function(a){this._depthFunction!==a&&(this.gl.depthFunc(a),this._depthFunction=a,this._stateTracker.invalidateDepthTest())};c.prototype.setDepthWriteEnabled=
function(a){this._depthWriteEnabled!==a&&(this.gl.depthMask(a),this._depthWriteEnabled=a,this._stateTracker.invalidateDepthWrite())};c.prototype.setDepthRange=function(a,c){if(this._depthRange.zNear!==a||this._depthRange.zFar!==c)this.gl.depthRange(a,c),this._depthRange.zNear=a,this._depthRange.zFar=c,this._stateTracker.invalidateDepthWrite()};c.prototype.setStencilTestEnabled=function(a){this._stencilTestEnabled!==a&&(!0===a?this.gl.enable(this.gl.STENCIL_TEST):this.gl.disable(this.gl.STENCIL_TEST),
this._stencilTestEnabled=a,this._stateTracker.invalidateStencilTest())};c.prototype.setClearStencil=function(a){a!==this._clearStencil&&(this.gl.clearStencil(a),this._clearStencil=a)};c.prototype.setStencilFunction=function(a,c,b){if(this._stencilFunction.func!==a||this._stencilFunction.ref!==c||this._stencilFunction.mask!==b)this.gl.stencilFunc(a,c,b),this._stencilFunction.face=1032,this._stencilFunction.func=a,this._stencilFunction.ref=c,this._stencilFunction.mask=b,this._stateTracker.invalidateStencilTest()};
c.prototype.setStencilFunctionSeparate=function(a,c,b,d){if(this._stencilFunction.face!==a||this._stencilFunction.func!==c||this._stencilFunction.ref!==b||this._stencilFunction.mask!==d)this.gl.stencilFuncSeparate(a,c,b,d),this._stencilFunction.face=a,this._stencilFunction.func=c,this._stencilFunction.ref=b,this._stencilFunction.mask=d,this._stateTracker.invalidateStencilTest()};c.prototype.setStencilWriteMask=function(a){this._stencilWriteMask!==a&&(this.gl.stencilMask(a),this._stencilWriteMask=
a,this._stateTracker.invalidateStencilWrite())};c.prototype.setStencilOp=function(a,c,b){if(this._stencilOperation.fail!==a||this._stencilOperation.zFail!==c||this._stencilOperation.zPass!==b)this.gl.stencilOp(a,c,b),this._stencilOperation.face=1032,this._stencilOperation.fail=a,this._stencilOperation.zFail=c,this._stencilOperation.zPass=b,this._stateTracker.invalidateStencilTest()};c.prototype.setStencilOpSeparate=function(a,c,b,d){if(this._stencilOperation.face!==a||this._stencilOperation.fail!==
c||this._stencilOperation.zFail!==b||this._stencilOperation.zPass!==d)this.gl.stencilOpSeparate(a,c,b,d),this._stencilOperation.face=a,this._stencilOperation.face=a,this._stencilOperation.fail=c,this._stencilOperation.zFail=b,this._stencilOperation.zPass=d,this._stateTracker.invalidateStencilTest()};c.prototype.setActiveTexture=function(a){var c=this._activeTextureUnit;0<=a&&a!==this._activeTextureUnit&&(this.gl.activeTexture(q.BASE_TEXTURE_UNIT+a),this._activeTextureUnit=a);return c};c.prototype.clear=
function(a){a&&this.gl.clear(a)};c.prototype.clearSafe=function(a,c){void 0===c&&(c=255);a&&(a&16384&&this.setColorMask(!0,!0,!0,!0),a&256&&this.setDepthWriteEnabled(!0),a&1024&&this.setStencilWriteMask(c),this.gl.clear(a))};c.prototype.drawArrays=function(a,c,b){this.gl.drawArrays(a,c,b)};c.prototype.drawElements=function(a,c,b,d){5123===b?this.gl.drawElements(a,c,b,d):5125===b&&this.gl.drawElements(a,c,b,d)};c.prototype.logIno=function(){};Object.defineProperty(c.prototype,"capabilities",{get:function(){return this._capabilities},
enumerable:!0,configurable:!0});c.prototype.setViewport=function(a,c,b,d){var f=this._viewport;if(f.x!==a||f.y!==c||f.width!==b||f.height!==d)f.x=a,f.y=c,f.width=b,f.height=d,this.gl.viewport(a,c,b,d)};c.prototype.getViewport=function(){return{x:this._viewport.x,y:this._viewport.y,width:this._viewport.width,height:this._viewport.height}};c.prototype.bindProgram=function(a){a?this._activeShaderProgram!==a&&(a.initialize(),this.gl.useProgram(a.glName),this._activeShaderProgram=a):(this.gl.useProgram(null),
this._activeShaderProgram=null)};c.prototype.bindTexture=function(a,b){void 0===b&&(b=0);-1===c._MAX_TEXTURE_IMAGE_UNITS&&(c._MAX_TEXTURE_IMAGE_UNITS=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS));(b>=c._MAX_TEXTURE_IMAGE_UNITS||0>b)&&console.error("Input texture unit is out of range of available units!");var d=this._textureUnitMap[b];this.setActiveTexture(b);null==a||null==a.glName?(null!=d&&(this.gl.bindTexture(d.descriptor.target,null),d.setBoundToUnit(b,!1)),this._textureUnitMap[b]=null):
d&&d.id===a.id?a.applyChanges():(d&&d.setBoundToUnit(b,!1),this.gl.bindTexture(a.descriptor.target,a.glName),a.setBoundToUnit(b,!0),a.applyChanges(),this._textureUnitMap[b]=a)};c.prototype.bindFramebuffer=function(a){l.isNone(a)?(this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this._activeFramebuffer=null):this._activeFramebuffer!==a&&(a.initialize()||this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,a.glName),this._activeFramebuffer=a)};c.prototype.bindBuffer=function(a){a&&(34962===a.bufferType?this._activeVertexBuffer=
c._bindBuffer(this.gl,a,a.bufferType,this._activeVertexBuffer):this._activeIndexBuffer=c._bindBuffer(this.gl,a,a.bufferType,this._activeIndexBuffer))};c.prototype.bindRenderbuffer=function(a){var c=this.gl;a||(c.bindRenderbuffer(c.RENDERBUFFER,null),this._activeRenderbuffer=null);this._activeRenderbuffer!==a&&(c.bindRenderbuffer(c.RENDERBUFFER,a.glName),this._activeRenderbuffer=a)};c.prototype.unbindBuffer=function(a){34962===a?this._activeVertexBuffer=c._bindBuffer(this.gl,null,a,this._activeVertexBuffer):
this._activeIndexBuffer=c._bindBuffer(this.gl,null,a,this._activeIndexBuffer)};c.prototype.bindVAO=function(a){a?this._activeVertexArrayObject&&this._activeVertexArrayObject.id===a.id||(a.bind(),this._activeVertexArrayObject=a):this._activeVertexArrayObject&&(this._activeVertexArrayObject.unbind(),this._activeVertexArrayObject=null)};c.prototype.getBoundTexture=function(a){return this._textureUnitMap[a]};c.prototype.getBoundFramebufferObject=function(){return this._activeFramebuffer};c.prototype.getBoundVAO=
function(){return this._activeVertexArrayObject};c.prototype.resetState=function(){this.bindProgram(null);this.bindVAO(null);this.bindFramebuffer(null);this.unbindBuffer(34962);this.unbindBuffer(34963);for(var a=0;a<this.parameters.maxTextureImageUnits;a++)this.bindTexture(null,a);this.setBlendingEnabled(!1);this.setBlendFunction(1,0);this.setBlendEquation(32774);this.setBlendColor(0,0,0,0);this.setFaceCullingEnabled(!1);this.setCullFace(1029);this.setFrontFace(2305);this.setPolygonOffsetFillEnabled(!1);
this.setPolygonOffset(0,0);this.setScissorTestEnabled(!1);this.setScissorRect(0,0,this.gl.canvas.width,this.gl.canvas.height);this.setDepthTestEnabled(!1);this.setDepthFunction(513);this.setDepthRange(0,1);this.setStencilTestEnabled(!1);this.setStencilFunction(519,0,0);this.setStencilOp(7680,7680,7680);this.setClearColor(0,0,0,0);this.setClearDepth(1);this.setClearStencil(0);this.setColorMask(!0,!0,!0,!0);this.setStencilWriteMask(4294967295);this.setDepthWriteEnabled(!0);this.setViewport(0,0,this.gl.canvas.width,
this.gl.canvas.height)};c.prototype.enforceState=function(){var a=this.gl,c=this.capabilities.vao;c&&c.bindVertexArray(null);for(var b=0;b<this.parameters.maxVertexAttributes;b++)a.disableVertexAttribArray(b);this._activeVertexBuffer?a.bindBuffer(this._activeVertexBuffer.bufferType,this._activeVertexBuffer.glName):a.bindBuffer(34962,null);this._activeIndexBuffer?a.bindBuffer(this._activeIndexBuffer.bufferType,this._activeIndexBuffer.glName):a.bindBuffer(34963,null);if(c&&this._activeVertexArrayObject){if(c=
this._activeVertexArrayObject)this._activeVertexArrayObject.unbind(),this._activeVertexArrayObject=null;this.bindVAO(c)}a.bindFramebuffer(a.FRAMEBUFFER,this._activeFramebuffer?this._activeFramebuffer.glName:null);a.useProgram(this._activeShaderProgram?this._activeShaderProgram.glName:null);a.blendColor(this._blendColorState.r,this._blendColorState.g,this._blendColorState.b,this._blendColorState.a);a.bindRenderbuffer(a.RENDERBUFFER,this._activeRenderbuffer?this._activeRenderbuffer.glName:null);!0===
this._blendEnabled?a.enable(this.gl.BLEND):a.disable(this.gl.BLEND);a.blendEquationSeparate(this._blendEquationState.mode,this._blendEquationState.modeAlpha);a.blendFuncSeparate(this._blendFunctionState.srcRGB,this._blendFunctionState.dstRGB,this._blendFunctionState.srcAlpha,this._blendFunctionState.dstAlpha);a.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearColor.a);a.clearDepth(this._clearDepth);a.clearStencil(this._clearStencil);a.colorMask(this._colorMaskState.r,
this._colorMaskState.g,this._colorMaskState.b,this._colorMaskState.a);a.cullFace(this._cullFace);a.depthFunc(this._depthFunction);a.depthRange(this._depthRange.zNear,this._depthRange.zFar);!0===this._depthTestEnabled?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST);a.depthMask(this._depthWriteEnabled);a.frontFace(this._frontFace);a.lineWidth(1);!0===this._polygonCullingEnabled?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE);a.polygonOffset(this._polygonOffset[0],this._polygonOffset[1]);!0===this._polygonOffsetFillEnabled?
a.enable(a.POLYGON_OFFSET_FILL):a.disable(a.POLYGON_OFFSET_FILL);a.scissor(this._scissorRect.x,this._scissorRect.y,this._scissorRect.width,this._scissorRect.height);!0===this._scissorTestEnabled?a.enable(a.SCISSOR_TEST):a.disable(a.SCISSOR_TEST);a.stencilFunc(this._stencilFunction.func,this._stencilFunction.ref,this._stencilFunction.mask);a.stencilOpSeparate(this._stencilOperation.face,this._stencilOperation.fail,this._stencilOperation.zFail,this._stencilOperation.zPass);!0===this._stencilTestEnabled?
a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST);a.stencilMask(this._stencilWriteMask);for(c=0;c<this.parameters.maxTextureImageUnits;c++)a.activeTexture(q.BASE_TEXTURE_UNIT+c),a.bindTexture(3553,null),(b=this._textureUnitMap[c])&&a.bindTexture(b.descriptor.target,b.glName);a.activeTexture(q.BASE_TEXTURE_UNIT+this._activeTextureUnit);a.viewport(this._viewport.x,this._viewport.y,this._viewport.width,this._viewport.height)};c._bindBuffer=function(a,c,b,d){if(!c)return a.bindBuffer(b,null),null;if(d===
c)return d;a.bindBuffer(b,c.glName);return c};c._MAX_TEXTURE_IMAGE_UNITS=-1;return c}()})},"esri/views/webgl/InstanceCounter":function(){define(["require","exports"],function(z,d){Object.defineProperty(d,"__esModule",{value:!0});z=function(){function d(){this._current=new t;this._max=new t}d.prototype.incrementCount=function(d){switch(d){case 0:this._current.textures++;this._max.textures=Math.max(this._max.textures,this._current.textures);break;case 1:this._current.buffers++;this._max.buffers=Math.max(this._max.buffers,
this._current.buffers);break;case 2:this._current.vaos++;this._max.vaos=Math.max(this._max.vaos,this._current.vaos);break;case 3:this._current.programs++;this._max.programs=Math.max(this._max.programs,this._current.programs);break;case 4:this._current.frameBuffers++;this._max.frameBuffers=Math.max(this._max.frameBuffers,this._current.frameBuffers);break;case 5:this._current.renderBuffers++,this._max.renderBuffers=Math.max(this._max.renderBuffers,this._current.renderBuffers)}};d.prototype.decrementCount=
function(d){switch(d){case 0:this._current.textures--;break;case 1:this._current.buffers--;break;case 2:this._current.vaos--;break;case 3:this._current.programs--;break;case 4:this._current.frameBuffers--;break;case 5:this._current.renderBuffers--}};Object.defineProperty(d.prototype,"max",{get:function(){return this._max},enumerable:!0,configurable:!0});d.prototype.printResourceCount=function(){console.log("Live objects:");console.log("Textures: "+this._current.textures);console.log("Buffers: "+this._current.buffers);
console.log("VAOs: "+this._current.vaos);console.log("Programs: "+this._current.programs);console.log("Framebuffers: "+this._current.frameBuffers);console.log("Renderbuffers: "+this._current.renderBuffers)};return d}();d.InstanceCounter=z;var t=function(){return function(){this.renderBuffers=this.frameBuffers=this.programs=this.vaos=this.buffers=this.textures=0}}()})},"esri/views/webgl/capabilities/isWebGL2Context":function(){define(["require","exports"],function(z,d){Object.defineProperty(d,"__esModule",
{value:!0});d.default=function(d){return window.WebGL2RenderingContext&&d instanceof window.WebGL2RenderingContext}})},"esri/views/webgl/capabilities/load":function(){define("require exports ./DisjointTimerQuery ./Instancing ./isWebGL2Context ./LoseContext ./VertexArrayObjects".split(" "),function(z,d,t,l,q,b,f){function h(b,c,a,d,f){if(d&&q.default(b))return!0;if(c[a])return!1;for(c=0;c<f.length;c++)if(b.getExtension(f[c]))return!0;return!1}Object.defineProperty(d,"__esModule",{value:!0});d.loadCapabilities=
function(d,c){var a=c&&c.disabledExtensions||{},m=c&&c.debugWebGLExtensions||{},r,D,w,v,E,C,z,K,G,I=null,x=null,N=null,O=null;return{get instancing(){r||(r=l.load(d));return r},get vao(){D||(D=f.load(d,a));return D},get compressedTextureS3TC(){if(!w)if(a.compressedTextureS3TC)w=null;else{var c=d.getExtension("WEBGL_compressed_texture_s3tc");w=c?{COMPRESSED_RGB_S3TC_DXT1:c.COMPRESSED_RGB_S3TC_DXT1_EXT,COMPRESSED_RGBA_S3TC_DXT1:c.COMPRESSED_RGBA_S3TC_DXT1_EXT,COMPRESSED_RGBA_S3TC_DXT3:c.COMPRESSED_RGBA_S3TC_DXT3_EXT,
COMPRESSED_RGBA_S3TC_DXT5:c.COMPRESSED_RGBA_S3TC_DXT5_EXT}:null}return w},get textureFilterAnisotropic(){if(!v)if(a.textureFilterAnisotropic)v=null;else{var c=d.getExtension("EXT_texture_filter_anisotropic")||d.getExtension("MOZ_EXT_texture_filter_anisotropic")||d.getExtension("WEBKIT_EXT_texture_filter_anisotropic");v=c?{MAX_TEXTURE_MAX_ANISOTROPY:c.MAX_TEXTURE_MAX_ANISOTROPY_EXT,TEXTURE_MAX_ANISOTROPY:c.TEXTURE_MAX_ANISOTROPY_EXT}:null}return v},get disjointTimerQuery(){E||(E=t.load(d,a));return E},
get textureFloat(){if(!C)if(q.default(d))C={textureFloat:!0,textureFloatLinear:!a.textureFloatLinear&&!!d.getExtension("OES_texture_float_linear"),textureHalfFloat:!0,textureHalfFloatLinear:!a.textureHalfFloatLinear&&!!d.getExtension("OES_texture_half_float_linear"),HALF_FLOAT:d.HALF_FLOAT};else if(d instanceof WebGLRenderingContext){var c=!a.textureHalfFloat&&d.getExtension("OES_texture_half_float");C={textureFloat:!a.textureFloat&&!!d.getExtension("OES_texture_float"),textureFloatLinear:!a.textureFloatLinear&&
!!d.getExtension("OES_texture_float_linear"),textureHalfFloat:!!c,textureHalfFloatLinear:!a.textureHalfFloatLinear&&!!d.getExtension("OES_texture_half_float_linear"),HALF_FLOAT:c?c.HALF_FLOAT_OES:void 0}}else C=null;return C},get colorBufferFloat(){if(!z)if(q.default(d)){var c=!a.colorBufferFloat&&d.getExtension("EXT_color_buffer_half_float"),b=!a.colorBufferFloat&&d.getExtension("EXT_color_buffer_float");z=c||b?{textureFloat:!!b,textureHalfFloat:!!c,R16F:d.R16F,RG16F:d.RG16F,RGBA16F:d.RGBA16F,R32F:d.R32F,
RG32F:d.RG32F,RGBA32F:d.RGBA32F,R11F_G11F_B10F:d.R11F_G11F_B10F,RGB16F:d.RGB16F}:null}else d instanceof WebGLRenderingContext?(c=!a.colorBufferFloat&&d.getExtension("EXT_color_buffer_half_float"),b=!a.colorBufferFloat&&d.getExtension("WEBGL_color_buffer_float"),z=c||b?{textureFloat:!!b,textureHalfFloat:!!c,RGBA16F:c?c.RGBA16F_EXT:void 0,RGB16F:c?c.RGB16F_EXT:void 0,RGBA32F:b?b.RGBA32F_EXT:void 0}:null):z=null;return z},get blendMinMax(){if(!K)if(q.default(d))K={MIN:d.MIN,MAX:d.MAX};else if(a.blendMinMax)K=
null;else{var c=d.getExtension("EXT_blend_minmax");K=c?{MIN:c.MIN_EXT,MAX:c.MAX_EXT}:null}return K},get depthTexture(){null===I&&(I=h(d,a,"depthTexture",!0,["WEBGL_depth_texture","MOZ_WEBGL_depth_texture","WEBKIT_WEBGL_depth_texture"]));return I},get standardDerivatives(){null===x&&(x=h(d,a,"standardDerivatives",!0,["OES_standard_derivatives"]));return x},get shaderTextureLOD(){null===N&&(N=h(d,a,"shaderTextureLOD",!0,["EXT_shader_texture_lod"]));return N},get fragDepth(){null===O&&(O=h(d,a,"fragDepth",
!0,["EXT_frag_depth"]));return O},get loseContext(){G||(G=b.load(d,m));return G}}}})},"esri/views/webgl/capabilities/DisjointTimerQuery":function(){define(["require","exports","./isWebGL2Context"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});d.load=function(d,q){if(q.disjointTimerQuery)return null;var b=d.getExtension("EXT_disjoint_timer_query")||d.getExtension("EXT_disjoint_timer_query_webgl2");return b?t.default(d)?{createQuery:function(){return d.createQuery()},resultAvailable:function(b){return d.getQueryParameter(b,
d.QUERY_RESULT_AVAILABLE)},getResult:function(b){return d.getQueryParameter(b,d.QUERY_RESULT)},disjoint:function(){return d.getParameter(b.GPU_DISJOINT_EXT)},beginTimeElapsed:function(f){return d.beginQuery(b.TIME_ELAPSED_EXT,f)},endTimeElapsed:function(){return d.endQuery(b.TIME_ELAPSED_EXT)},createTimestamp:function(d){return b.queryCounterEXT(d,b.TIMESTAMP_EXT)},timestampBits:function(){return d.getQuery(b.TIMESTAMP_EXT,b.QUERY_COUNTER_BITS_EXT)}}:{createQuery:function(){return b.createQueryEXT()},
resultAvailable:function(d){return b.getQueryObjectEXT(d,b.QUERY_RESULT_AVAILABLE_EXT)},getResult:function(d){return b.getQueryObjectEXT(d,b.QUERY_RESULT_EXT)},disjoint:function(){return d.getParameter(b.GPU_DISJOINT_EXT)},beginTimeElapsed:function(d){return b.beginQueryEXT(b.TIME_ELAPSED_EXT,d)},endTimeElapsed:function(){return b.endQueryEXT(b.TIME_ELAPSED_EXT)},createTimestamp:function(d){return b.queryCounterEXT(d,b.TIMESTAMP_EXT)},timestampBits:function(){return b.getQueryEXT(b.TIMESTAMP_EXT,
b.QUERY_COUNTER_BITS_EXT)}}:null}})},"esri/views/webgl/capabilities/Instancing":function(){define(["require","exports","./isWebGL2Context"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});d.load=function(d){return t.default(d)?{drawArraysInstanced:d.drawArraysInstanced.bind(d),drawElementsInstanced:d.drawElementsInstanced.bind(d),vertexAttribDivisor:d.vertexAttribDivisor.bind(d)}:(d=d.getExtension("ANGLE_instanced_arrays"))?{drawArraysInstanced:d.drawArraysInstancedANGLE.bind(d),
drawElementsInstanced:d.drawElementsInstancedANGLE.bind(d),vertexAttribDivisor:d.vertexAttribDivisorANGLE.bind(d)}:null}})},"esri/views/webgl/capabilities/LoseContext":function(){define(["require","exports"],function(z,d){Object.defineProperty(d,"__esModule",{value:!0});d.load=function(d,l){var q=l.loseContext&&d.getExtension("WEBGL_lose_context");return q?{loseRenderingContext:function(){return q.loseContext()}}:null}})},"esri/views/webgl/capabilities/VertexArrayObjects":function(){define(["require",
"exports","./isWebGL2Context"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});d.load=function(d,q){return t.default(d)?{createVertexArray:d.createVertexArray.bind(d),deleteVertexArray:d.deleteVertexArray.bind(d),bindVertexArray:d.bindVertexArray.bind(d)}:q.vao?null:(d=d.getExtension("OES_vertex_array_object")||d.getExtension("MOZ_OES_vertex_array_object")||d.getExtension("WEBKIT_OES_vertex_array_object"))?{createVertexArray:d.createVertexArrayOES.bind(d),deleteVertexArray:d.deleteVertexArrayOES.bind(d),
bindVertexArray:d.bindVertexArrayOES.bind(d)}:null}})},"esri/views/webgl/ShaderCompiler":function(){define(["require","exports"],function(z,d){return function(){function d(d){this.readFile=d}d.prototype.resolveIncludes=function(d){return this.resolve(d)};d.prototype.resolve=function(d,q){var b=this;void 0===q&&(q=new Map);if(q.has(d))return q.get(d);var f=this.read(d);if(!f)throw Error("cannot find shader file "+d);for(var h=/^[^\S\n]*#include\s+<(\S+)>[^\S\n]?/gm,l=h.exec(f),c=[];null!=l;)c.push({path:l[1],
start:l.index,length:l[0].length}),l=h.exec(f);var a=0,m="";c.forEach(function(c){m+=f.slice(a,c.start);m+=q.has(c.path)?"":b.resolve(c.path,q);a=c.start+c.length});m+=f.slice(a);q.set(d,m);return m};d.prototype.read=function(d){return this.readFile(d)};return d}()})},"esri/views/webgl/ProgramCache":function(){define(["require","exports","./programUtils"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});z=function(){function d(d){this._programCacheByTemplate=new Map;this._rctx=d}d.prototype.dispose=
function(){this._programCacheByTemplate.forEach(function(d){d.programs.forEach(function(b){b.dispose()})});this._programCacheByTemplate=null};d.prototype.getProgram=function(d,b){var f=this;this._programCacheByTemplate.has(d)||this.addProgramTemplate(d,function(b){return t.createProgram(f._rctx,d,b)});return this.getProgramTemplateInstance(d,b)};d.prototype.addProgramTemplate=function(d,b){this._programCacheByTemplate.set(d,{constructor:b,programs:new Map})};d.prototype.getProgramTemplateInstance=
function(d,b){if(d=this._programCacheByTemplate.get(d)){var f=b?JSON.stringify(b):"default";d.programs.has(f)||(b=d.constructor(b),d.programs.set(f,b));return d.programs.get(f)}return null};return d}();d.ProgramCache=z})},"esri/views/webgl/programUtils":function(){define(["require","exports","./Program"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});d.glslifyDefineMap=function(d){var l="",b;for(b in d){var f=d[b];if("boolean"===typeof f)f&&(l+="#define "+b+"\n");else if("number"===
typeof f)l+="#define "+b+" "+f.toFixed()+"\n";else if("object"===typeof f){var h=f.options,r=0,c;for(c in h)l+="#define "+h[c]+" "+(r++).toFixed()+"\n";l+="#define "+b+" "+h[f.value]+"\n"}}return l};d.createProgram=function(d,q,b,f){b=b||{};f=f||"";b="function"===typeof q.shaders?q.shaders(b):q.shaders;return new t(d,f+b.vertexShader,f+b.fragmentShader,q.attributes)}})},"esri/views/3d/webgl-engine/lib/RenderGeometry":function(){define("require exports ../../../../core/maybe ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../core/libs/gl-matrix-2/factories/mat4f64 ../../support/mathUtils ./ComponentUtils ./geometryDataUtils ./Object3DStateSet ./Util".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u){return function(){function d(a,c,b,d,h,m,l){this.uniqueName=null;this.shaderTransformationDirty=!0;this.data=a.toRenderData();this.componentOffsets=a.componentOffsets;this.boundingInfo=c;this.material=b;this.origin=null;this.center=f.vec3f64.create();this.bsRadius=0;this.transformation=null;this.calculateShaderTransformation=h;d&&this.updateTransformation(d,m);this.castShadow=l;this.instanceParameters={}}d.prototype.updateTransformation=function(a,c){this.transformation=
a;this.shaderTransformationDirty=!0;this.bsRadius=this.getBoundingSphere(a,c,this.center)};d.prototype.shaderTransformationChanged=function(){this.shaderTransformationDirty=!0};d.prototype.getBoundingSphere=function(a,c,d){c=c||r.maxScale(a);b.vec3.transformMat4(d,this.boundingInfo.getCenter(),a);return this.boundingInfo.getBSRadius()*c};Object.defineProperty(d.prototype,"hasShaderTransformation",{get:function(){return!!this.calculateShaderTransformation},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,
"componentCount",{get:function(){return c.componentCount(this.componentOffsets)},enumerable:!0,configurable:!0});d.prototype.getShaderTransformation=function(){if(!this.calculateShaderTransformation)return t.unwrapOr(this.transformation,h.IDENTITY);this.shaderTransformationDirty&&(this.shaderTransformation||(this.shaderTransformation=q.mat4f64.create()),l.mat4.copy(this.shaderTransformation,this.calculateShaderTransformation(t.unwrapOr(this.transformation,h.IDENTITY))),this.shaderTransformationDirty=
!1);return this.shaderTransformation};d.prototype.computeAttachmentOrigin=function(c){if(this.material.computeAttachmentOrigin)return this.material.computeAttachmentOrigin(this,c)?(t.isSome(this.transformation)&&b.vec3.transformMat4(c,c,this.transformation),!0):!1;var d=this.getIndices(u.VertexAttrConstants.POSITION),f=this.getAttribute(u.VertexAttrConstants.POSITION);return a.computeAttachmentOriginTriangles(f,d,c)?(t.isSome(this.transformation)&&b.vec3.transformMat4(c,c,this.transformation),!0):
!1};d.prototype.getIndices=function(a){return"indices"in this.data?this.data.indices[a]:null};d.prototype.getAttribute=function(a){return"vertexAttr"in this.data?this.data.vertexAttr[a]:null};d.prototype.addHighlight=function(){var a=m.generateObject3DStateId(0),b=this.instanceParameters;b.componentHighlights=c.addHighlight(b.componentHighlights,null,a);return a};d.prototype.removeHighlight=function(a){var b=this.instanceParameters;b.componentHighlights=c.removeHighlight(b.componentHighlights,a)};
return d}()})},"esri/views/3d/webgl-engine/lib/Texture":function(){define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/compilerUtils ../../../../core/Error ../../../../core/Evented ../../../../core/mathUtils ../../../../core/mathUtils ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/typedArrayUtil ../../../../core/urlUtils ../../../../support/requestUtils ../../support/imageUtils ./DDSUtil ./glUtil3D ./IdGen ./Util ../../../webgl/FramebufferObject ../../../webgl/Texture ../../../webgl/Util ../../../webgl/capabilities/isWebGL2Context".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u,D,w,v,E,C,J,K,G,I,x){return function(){function d(a,c,b){this.data=a;this.loadingController=this.loadingPromise=this.powerOfTwoStretchInfo=this.glTexture=null;this.events=new f;this.data=a;this.id=d.idGen.gen(c);this.params=b||{};this.params.mipmap=!1!==this.params.mipmap;this.params.noUnpackFlip=this.params.noUnpackFlip||!1;this.params.preMultiplyAlpha=this.params.preMultiplyAlpha||!1;this.params.wrap=this.params.wrap||{s:10497,t:10497};this.params.powerOfTwoResizeMode=
this.params.powerOfTwoResizeMode||1;this.estimatedTexMemRequired=d.estimateTexMemRequired(this.data,this.params);this.startPreload()}d.prototype.startPreload=function(){var a=this.data;c.isNone(a)||(a instanceof HTMLVideoElement?this.startPreloadVideoElement(a):a instanceof HTMLImageElement&&this.startPreloadImageElement(a))};d.prototype.startPreloadVideoElement=function(a){u.isBlobProtocol(a.src)||"auto"===a.preload&&a.crossOrigin||(a.preload="auto",a.crossOrigin="anonymous",a.src=a.src)};d.prototype.startPreloadImageElement=
function(a){u.isDataProtocol(a.src)||u.isBlobProtocol(a.src)||a.crossOrigin||(a.crossOrigin="anonymous",a.src=a.src)};d.getDataDimensions=function(a){return a instanceof HTMLVideoElement?{width:a.videoWidth,height:a.videoHeight}:a};d.estimateTexMemRequired=function(a,b){if(c.isNone(a))return 0;if(m.isArrayBuffer(a)||m.isUint8Array(a))return a.byteLength;a=a instanceof Image||a instanceof ImageData||a instanceof HTMLCanvasElement||a instanceof HTMLVideoElement?d.getDataDimensions(a):b;return(b.mipmap?
4/3:1)*a.width*a.height*(b.components||4)||0};d.prototype.dispose=function(){this.data=void 0};Object.defineProperty(d.prototype,"width",{get:function(){return this.params.width},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"height",{get:function(){return this.params.height},enumerable:!0,configurable:!0});d.prototype.createDescriptor=function(a){return{target:3553,pixelFormat:6408,dataType:5121,wrapMode:this.params.wrap,flipped:!this.params.noUnpackFlip,samplingMode:this.params.mipmap?
9987:9729,hasMipmap:this.params.mipmap,preMultiplyAlpha:this.params.preMultiplyAlpha,maxAnisotropy:this.params.mipmap&&!this.params.disableAnisotropy?a.parameters.maxMaxAnisotropy:void 0}};d.prototype.load=function(a,b){if(c.isSome(this.glTexture))return this.glTexture;if(c.isSome(this.loadingPromise))return this.loadingPromise;var f=this.data;if(c.isNone(f))return this.glTexture=new G(a,this.createDescriptor(a),null),a.bindTexture(this.glTexture),this.glTexture;if("string"===typeof f)return this.loadFromURL(a,
b,f);if(f instanceof Image)return this.loadFromImageElement(a,b,f);if(f instanceof HTMLVideoElement)return this.loadFromVideoElement(a,b,f);if(f instanceof ImageData||f instanceof HTMLCanvasElement)return this.loadFromImage(a,f,b);if((m.isArrayBuffer(f)||m.isUint8Array(f))&&this.params.encoding===d.DDS_ENCODING)return this.loadFromDDSData(a,f);if(m.isUint8Array(f))return this.loadFromPixelData(a,f);if(m.isArrayBuffer(f))return this.loadFromPixelData(a,new Uint8Array(f));q.neverReachedSilent(f);return null};
Object.defineProperty(d.prototype,"requiresFrameUpdates",{get:function(){return this.data instanceof HTMLVideoElement},enumerable:!0,configurable:!0});d.prototype.frameUpdate=function(a,b,d){if(!(this.data instanceof HTMLVideoElement)||c.isNone(this.glTexture)||2>this.data.readyState||d===this.data.currentTime)return d;if(c.isSome(this.powerOfTwoStretchInfo)){var f=this.powerOfTwoStretchInfo;d=f.framebuffer;var h=f.vao,f=f.sourceTexture;f.setData(this.data);this.drawStretchedTexture(a,b,d,h,f,this.glTexture)}else b=
this.data,a=b.width,b=b.height,h=this.glTexture.descriptor,d=h.width,h=h.height,a!==d||b!==h?this.glTexture.updateData(0,0,0,Math.min(a,d),Math.min(b,h),this.data):this.glTexture.setData(this.data);this.glTexture.descriptor.hasMipmap&&this.glTexture.generateMipmap();return this.data.currentTime};d.prototype.loadFromDDSData=function(a,c){this.glTexture=v.createDDSTexture(a,this.createDescriptor(a),c,this.params.mipmap);a.bindTexture(this.glTexture);return this.glTexture};d.prototype.loadFromPixelData=
function(a,c){J.assert(0<this.params.width&&0<this.params.height);var b=this.createDescriptor(a);b.pixelFormat=1===this.params.components?6409:3===this.params.components?6407:6408;b.width=this.params.width;b.height=this.params.height;this.glTexture=new G(a,b,c);a.bindTexture(this.glTexture);return this.glTexture};d.prototype.loadAsync=function(c){return l(this,void 0,void 0,function(){var b,d,f,h=this;return t(this,function(m){this.loadingController=b=a.createAbortController();this.loadingPromise=
d=c(b.signal);f=function(){h.loadingController===b&&(h.loadingController=null);h.loadingPromise===d&&(h.loadingPromise=null)};d.then(f,f);return[2,d]})})};d.prototype.loadFromURL=function(a,c,b){var d=this;return this.loadAsync(function(f){return l(d,void 0,void 0,function(){var d;return t(this,function(h){switch(h.label){case 0:return[4,w.requestImage(b,{signal:f})];case 1:return d=h.sent(),[2,this.loadFromImage(a,d,c)]}})})})};d.prototype.loadFromImageElement=function(a,c,b){var d=this;return b.complete?
this.loadFromImage(a,b,c):this.loadAsync(function(f){return l(d,void 0,void 0,function(){var d;return t(this,function(h){switch(h.label){case 0:return[4,D.loadImageAsync(b,b.src,!1,f)];case 1:return d=h.sent(),[2,this.loadFromImage(a,d,c)]}})})})};d.prototype.loadFromVideoElement=function(a,c,b){return 2<=b.readyState?this.loadFromImage(a,b,c):this.loadFromVideoElementAsync(a,c,b)};d.prototype.loadFromVideoElementAsync=function(d,f,h){var m=this;return this.loadAsync(function(l){return a.create(function(q,
r){var t=function(){h.removeEventListener("loadeddata",v);h.removeEventListener("error",u);c.isSome(w)&&w.remove()},v=function(){2<=h.readyState&&(t(),q(m.loadFromImage(d,h,f)))},u=function(a){t();r(a||new b("Failed to load video"))};h.addEventListener("loadeddata",v);h.addEventListener("error",u);var w=a.onAbort(l,function(){return u(a.createAbortError())})})})};d.prototype.loadFromImage=function(a,c,b){var f=d.getDataDimensions(c);this.params.width=f.width;this.params.height=f.height;var h=this.createDescriptor(a);
h.pixelFormat=3===this.params.components?6407:6408;if(this.requiresPowerOfTwo(a,h)&&(!r.isPowerOfTwo(f.width)||!r.isPowerOfTwo(f.height)))return this.glTexture=this.makePowerOfTwoTexture(a,c,f,h,b),a.bindTexture(this.glTexture),this.glTexture;h.width=f.width;h.height=f.height;this.glTexture=new G(a,h,c);a.bindTexture(this.glTexture);return this.glTexture};d.prototype.requiresPowerOfTwo=function(a,c){var b="number"===typeof c.wrapMode?33071===c.wrapMode:33071===c.wrapMode.s&&33071===c.wrapMode.t;return!x.default(a.gl)&&
(c.hasMipmap||!b)};d.prototype.makePowerOfTwoTexture=function(a,c,b,d,f){var m=b.width;b=b.height;var l=h.nextHighestPowerOfTwo(m),r=h.nextHighestPowerOfTwo(b);d.width=l;d.height=r;var t;switch(this.params.powerOfTwoResizeMode){case 2:d.textureCoordinateScaleFactor=[m/l,b/r];t=new G(a,d);t.updateData(0,0,0,m,b,c);break;case 1:case null:case void 0:t=this.stretchToPowerOfTwo(a,c,d,f);break;default:q.neverReached(this.params.powerOfTwoResizeMode)}d.hasMipmap&&t.generateMipmap();return t};d.prototype.stretchToPowerOfTwo=
function(a,c,b,d){var f=new G(a,b),h=new K(a,{colorTarget:0,depthStencilTarget:0},f);c=new G(a,{target:3553,pixelFormat:b.pixelFormat,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!!b.flipped,maxAnisotropy:8,preMultiplyAlpha:b.preMultiplyAlpha},c);b=E.createQuadVAO(a);this.drawStretchedTexture(a,d,h,b,c,f);this.requiresFrameUpdates?this.powerOfTwoStretchInfo={vao:b,sourceTexture:c,framebuffer:h}:(b.dispose(!0),c.dispose(),h.detachColorTexture(),a.bindFramebuffer(null),h.dispose());return f};
d.prototype.drawStretchedTexture=function(a,c,b,d,f,h){a.bindFramebuffer(b);b=a.getViewport();a.setViewport(0,0,h.descriptor.width,h.descriptor.height);h=c.program;a.bindProgram(h);h.setUniform4f("color",1,1,1,1);h.setUniform1i("tex",0);a.bindTexture(f,0);a.bindVAO(d);a.setPipelineState(c.pipeline);a.drawArrays(5,0,I.vertexCount(d,"geometry"));a.bindFramebuffer(null);a.setViewport(b.x,b.y,b.width,b.height)};d.prototype.unload=function(){if(c.isSome(this.powerOfTwoStretchInfo)){var a=this.powerOfTwoStretchInfo,
b=a.framebuffer,d=a.sourceTexture;a.vao.dispose(!0);d.dispose();b.dispose();this.powerOfTwoStretchInfo=this.glTexture=null}c.isSome(this.glTexture)&&(this.glTexture.dispose(),this.glTexture=null);c.isSome(this.loadingController)&&(a=this.loadingController,this.loadingPromise=this.loadingController=null,a.abort());this.events.emit("unloaded")};d.idGen=new C.IdGen;d.DDS_ENCODING="image/vnd-ms.dds";return d}()})},"esri/views/3d/webgl-engine/lib/DDSUtil":function(){define(["require","exports","../../../../core/Logger",
"../../../../core/mathUtils","../../../webgl/Texture"],function(z,d,t,l,q){function b(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}function f(b,d){var f=new Int32Array(b,0,31);if(542327876!==f[0])return h.error("Invalid magic number in DDS header"),null;if(!(f[20]&4))return h.error("Unsupported format, must contain a FourCC code"),null;var m=f[21],q;switch(m){case r:m=8;q=33776;break;case c:m=16;q=33778;break;case a:m=16;q=33779;break;default:return h.error("Unsupported FourCC code:",
String.fromCharCode(m&255,m>>8&255,m>>16&255,m>>24&255)),null}var t=1,u=f[4],z=f[3];if(0!==(u&3)||0!==(z&3))h.warn("Rounding up compressed texture size to nearest multiple of 4."),u=u+3&-4,z=z+3&-4;var K=u,G=z;f[2]&131072&&!1!==d&&(t=Math.max(1,f[7]));1===t||l.isPowerOfTwo(u)&&l.isPowerOfTwo(z)||(h.warn("Ignoring mipmaps of non power of two sized compressed texture."),t=1);for(var I=f[1]+4,x=[],N=0;N<t;++N)f=(u+3>>2)*(z+3>>2)*m,d=new Uint8Array(b,I,f),x.push(d),I+=f,u=Math.max(1,u>>1),z=Math.max(1,
z>>1);return{textureData:{type:"compressed",levels:x},internalFormat:q,width:K,height:G}}Object.defineProperty(d,"__esModule",{value:!0});var h=t.getLogger("esri.views.3d.webgl-engine.lib.DDSUtil"),r=b("DXT1"),c=b("DXT3"),a=b("DXT5");d.createDDSTexture=function(a,c,b,d){var h=f(b,d);b=h.textureData;d=h.internalFormat;var m=h.width,h=h.height;c.samplingMode=1<b.levels.length?9987:9729;c.hasMipmap=1<b.levels.length;c.internalFormat=d;c.width=m;c.height=h;c=new q(a,c,b);a.bindTexture(c);return c};d.createDDSTextureData=
f})},"esri/views/3d/webgl-engine/materials/HUDMaterial":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/assignHelper ../../../../core/screenUtils ../../../../core/libs/gl-matrix-2/mat3 ../../../../core/libs/gl-matrix-2/mat3f64 ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f64 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../core/libs/gl-matrix-2/types/mat4 ../../../../geometry/support/aaBoundingRect ../../support/buffer/InterleavedLayout ../lib/ComponentUtils ../lib/geometryDataUtils ../lib/GLMaterialTexture ../lib/Material ../lib/screenSizePerspectiveUtils ../lib/Util ./internal/bufferWriterUtils ./internal/MaterialUtil ./renderers/MergedRenderer ../shaders/HUDMaterial.glsl ../shaders/HUDMaterialTechnique".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u,D,w,v,E,C,J,K,G,I,x,N,O,P,S){function R(e,g,a,n,k,c,b,y){g=g-k-(0<y[0]?n[0]*y[0]:0);var p=g+n[0]+2*k;a=a-k-(0<y[1]?n[1]*y[1]:0);k=a+n[1]+2*k;b.textureIsSignedDistanceField&&(b=b.distanceFieldBoundingBox,g+=n[0]*b[0],a+=n[1]*b[1],p-=n[0]*(1-b[2]),k-=n[1]*(1-b[3]),g-=c,p+=c,a-=c,k+=c);return e[0]>g&&e[0]<p&&e[1]>a&&e[1]<k}z=function(a){function d(e,g){g=a.call(this,g)||this;g.techniqueConfig=new S.HUDMaterialTechniqueConfiguration;g.params=N.copyParameters(e,M);return g}
t(d,a);d.prototype.dispose=function(){};d.prototype.setParameterValues=function(e){for(var g in e)"textureId"===g&&I.assert(!!this.params.textureId,"Can only change texture of material that already has a texture"),this.params[g]=e[g];this.parametersChanged()};d.prototype.getParameters=function(){return this.params};d.prototype.getTechniqueConfig=function(e){this.techniqueConfig.output=e;this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled;this.techniqueConfig.verticalOffset=!!this.params.verticalOffset;
this.techniqueConfig.screenSizePerspective=!!this.params.screenSizePerspective;this.techniqueConfig.screenCenterOffsetUnitsEnabled="screen"===this.params.centerOffsetUnits?1:0;this.techniqueConfig.polygonOffsetEnabled=this.params.polygonOffset;this.techniqueConfig.occlusionTestEnabled=this.params.occlusionTest;this.techniqueConfig.sdf=this.params.textureIsSignedDistanceField;this.techniqueConfig.vvSize=!!this.params.vvSizeEnabled;this.techniqueConfig.vvColor=!!this.params.vvColorEnabled;0===e&&(this.techniqueConfig.debugDrawBorder=
!!this.params.debugDrawBorder);4===e&&(this.techniqueConfig.binaryHighlightOcclusion=this.params.binaryHighlightOcclusion);this.techniqueConfig.depthEnabled=this.params.depthEnabled;return this.techniqueConfig};d.prototype.intersect=function(e,g,a,n,k,c,b,y,p){p?this.intersectDrapedHudGeometry(e,c,b,y):this.intersectHudGeometry(e,g,a,n,b,y)};d.prototype.intersectDrapedHudGeometry=function(e,g,a,k){var c=e.getAttribute(I.VertexAttrConstants.POSITION),b=e.getAttribute(I.VertexAttrConstants.SIZE),y=
this.params,p=P.calculateAnchorPosForRendering(y),d=1,f=1;k&&(f=k(n),d=f[0],f=f[5]);d*=e.pixelRatio;f*=e.pixelRatio;k=B*e.pixelRatio;for(var H=0;H<c.data.length/c.size;H++){var M=H*c.size,A=c.data[M],M=c.data[M+1],h=H*b.size;F[0]=b.data[h]*d;F[1]=b.data[h+1]*f;h=void 0;y.textureIsSignedDistanceField&&(h=y.outlineSize*e.pixelRatio/2);R(g,A,M,F,k,h,y,p)&&a()}};d.prototype.intersectHudGeometry=function(g,a,c,p,B,d){if(p.options.selectionMode&&p.options.hud&&!E.isAllHidden(a.componentVisibilities,g.componentOffsets)){var f=
g.data;g=this.params;var H=a=1;b.mat3.fromMat4(A,c);if(d){H=d(n);a=H[0];H=H[5];d=A;var M=d[0],X=d[1],l=d[2],Z=d[3],q=d[4],r=d[5],ca=d[6],t=d[7],v=d[8],w=1/Math.sqrt(M*M+X*X+l*l),da=1/Math.sqrt(Z*Z+q*q+r*r),ba=1/Math.sqrt(ca*ca+t*t+v*v);d[0]=M*w;d[1]=X*w;d[2]=l*w;d[3]=Z*da;d[4]=q*da;d[5]=r*da;d[6]=ca*ba;d[7]=t*ba;d[8]=v*ba}d=f.getVertexAttr()[I.VertexAttrConstants.POSITION];M=f.getVertexAttr()[I.VertexAttrConstants.SIZE];X=f.getVertexAttr()[I.VertexAttrConstants.NORMAL];f=f.getVertexAttr()[I.VertexAttrConstants.AUXPOS1];
I.assert(3<=d.size);l=p.point;Z=p.camera;q=P.calculateAnchorPosForRendering(g);a*=Z.pixelRatio;H*=Z.pixelRatio;r="screen"===this.params.centerOffsetUnits;for(ca=0;ca<d.data.length/d.size;ca++)t=ca*d.size,m.vec3.set(T,d.data[t],d.data[t+1],d.data[t+2]),m.vec3.transformMat4(T,T,c),t=ca*M.size,F[0]=M.data[t]*a,F[1]=M.data[t+1]*H,m.vec3.transformMat4(T,T,Z.viewMatrix),t=ca*f.size,m.vec3.set(e,f.data[t+0],f.data[t+1],f.data[t+2]),r||(T[0]+=e[0],T[1]+=e[1],0!==e[2]&&(t=e[2],m.vec3.normalize(e,T),m.vec3.subtract(T,
T,m.vec3.scale(e,e,t)))),t=ca*X.size,m.vec3.set(aa,X.data[t],X.data[t+1],X.data[t+2]),this.applyVerticalOffsetTransformation(T,aa,A,Z,V),Z.applyProjection(T,W),-1<W[0]&&(t=Math.floor(W[0])+this.params.screenOffset[0],v=Math.floor(W[1])+this.params.screenOffset[1],r&&(t+=e[0],0!==e[1]&&(v+=G.applyScaleFactor(e[1],V.factorAlignment))),G.applyPrecomputedScaleFactorVec2(F,V.factor,F),w=y*Z.pixelRatio,da=void 0,g.textureIsSignedDistanceField&&(da=g.outlineSize*Z.pixelRatio/2),R(l,t,v,F,w,da,g,q)&&(v=p.ray,
m.vec3.transformMat4(L,T,h.mat4.invert(k,Z.viewMatrix)),W[0]=l[0],W[1]=l[1],Z.unprojectPoint(W,T),t=u.vec3f64.create(),m.vec3.copy(t,v.direction),w=1/m.vec3.length(t),m.vec3.scale(t,t,w),v=m.vec3.distance(v.origin,T)*w,B(v,t,-1,1,!0,L)))}};d.prototype.computeAttachmentOrigin=function(e,g){e=e.data;var a="getVertexAttr"in e?e.getVertexAttr():"vertexAttr"in e?e.vertexAttr:null;if(!a)return null;var n=I.VertexAttrConstants.POSITION,a=a[n];e="getIndices"in e?e.getIndices(n):"indices"in e?e.indices[n]:
null;return C.computeAttachmentOriginPoints(a,e,g)};d.prototype.createBufferWriter=function(){return new Z(this)};d.prototype.createRenderer=function(e,g){return new O(e,g,this)};d.prototype.normalAndViewAngle=function(e,a,n,k){void 0===k&&(k=g);m.vec3.transformMat3(k.normal,e,a);m.vec3.transformMat4(k.normal,k.normal,n.viewInverseTransposeMatrix);k.cosAngle=m.vec3.dot(p,H);return k};d.prototype.updateScaleInfo=function(e,a){var n=this.params;n.screenSizePerspective?e.factor=G.precomputeScaleFactor(g.cosAngle,
a,n.screenSizePerspective,e.factor):(e.factor.scale=1,e.factor.factor=0,e.factor.minPixelSize=0,e.factor.paddingPixels=0);n.screenSizePerspectiveAlignment?e.factorAlignment=G.precomputeScaleFactor(g.cosAngle,a,n.screenSizePerspectiveAlignment,e.factorAlignment):(e.factorAlignment.factor=e.factor.factor,e.factorAlignment.scale=e.factor.scale,e.factorAlignment.minPixelSize=e.factor.minPixelSize,e.factorAlignment.paddingPixels=e.factor.paddingPixels)};d.prototype.applyVerticalOffsetTransformation=function(e,
g,a,n,k,c){var y=this.params;D.isMat4(a)&&(a=b.mat3.fromMat4(A,a));if(!y.verticalOffset||!y.verticalOffset.screenLength)return k&&(y.screenSizePerspective||y.screenSizePerspectiveAlignment)?(n=m.vec3.length(e),this.updateScaleInfo(k,n)):k&&(k.factor.scale=1,k.factorAlignment.scale=1),c?m.vec3.copy(c,e):e;g=this.normalAndViewAngle(g,a,n);a=m.vec3.length(e);n=N.verticalOffsetAtDistance(n,a,y.verticalOffset,g.cosAngle,y.screenSizePerspectiveAlignment||y.screenSizePerspective);k&&this.updateScaleInfo(k,
a);return m.vec3.add(c||e,e,m.vec3.scale(g.normal,g.normal,n))};d.prototype.getGLMaterial=function(e){if(0===e.output)return new Q(e);if(4===e.output)return new U(e)};d.prototype.calculateRelativeScreenBounds=function(e,g,a){void 0===a&&(a=w.create());var n=this.params,k=a;void 0===k&&(k=Y);c.vec2.copy(k,n.anchorPos);k[0]*=-e[0];k[1]*=-e[1];k[0]+=n.screenOffset[0]*g;k[1]+=n.screenOffset[1]*g;a[2]=a[0]+e[0];a[3]=a[1]+e[1];return a};d.shouldRenderVisibilityDuringRenderPass=function(e){return 0===e||
4};return d}(K.Material);d=function(e){function g(g){g=e.call(this,J.makeCtorParameters(g,g.material.getParameters()))||this;g.updateParameters();return g}t(g,e);g.prototype.beginSlot=function(e){return e===(this.params.drawInSecondSlot?19:18)};g.prototype.updateParameters=function(){this.params=N.copyParameters(this.material.getParameters());this.updateTexture(this.params.textureId);this.selectProgram()};g.prototype.selectProgram=function(){this.technique=this.techniqueRep.acquireAndReleaseExisting(S.HUDMaterialTechnique,
this.material.getTechniqueConfig(this.output),this.technique)};g.prototype.bind=function(e,g){e.bindProgram(this.technique.program);this.bindTexture(e,this.technique.program);this.bindTextureScale(e,this.technique.program);this.technique.bindPass(e,this.params,g)};return g}(J);var Q=function(e){function g(g){g=e.call(this,l({},g,{output:0}))||this;g.isOcclusionSlot=!1;return g}t(g,e);g.prototype.beginSlot=function(e){var g=this.params.drawInSecondSlot?19:18;if(this.params.occlusionTest)return this.isOcclusionSlot=
12===e,12===e||e===g;this.isOcclusionSlot=!1;return e===g};g.prototype.getTechnique=function(){return this.isOcclusionSlot?this.occlusionTechnique:this.technique};g.prototype.selectProgram=function(){this.technique=this.techniqueRep.acquireAndReleaseExisting(S.HUDMaterialTechnique,this.material.getTechniqueConfig(this.output),this.technique);this.occlusionTechnique=this.techniqueRep.acquireAndReleaseExisting(S.HUDMaterialTechnique,this.material.getTechniqueConfig(6),this.occlusionTechnique)};g.prototype.bind=
function(e,g){var a=this.getTechnique();e.bindProgram(a.program);this.isOcclusionSlot||(this.bindTexture(e,a.program),this.bindTextureScale(e,a.program));a.bindPass(e,this.params,g)};return g}(d),U=function(e){function g(g){return e.call(this,l({},g,{output:4}))||this}t(g,e);return g}(d),V={factor:{scale:0,factor:0,minPixelSize:0,paddingPixels:0},factorAlignment:{scale:0,factor:0,minPixelSize:0,paddingPixels:0}},Y=a.vec2f64.create(),T=u.vec3f64.create(),aa=u.vec3f64.create(),W=q.createRenderScreenPointArray3(),
p=u.vec3f64.create(),L=u.vec3f64.create(),A=f.mat3f64.create(),k=r.mat4f64.create(),e=u.vec3f64.create(),g={normal:p,cosAngle:0},n=r.mat4f64.create(),y=1,B=2,F=[0,0],H=u.vec3f64.fromValues(0,0,1),M={texCoordScale:[1,1],occlusionTest:!0,binaryHighlightOcclusion:!0,drawInSecondSlot:!1,color:[1,1,1,1],outlineColor:[1,1,1,1],outlineSize:0,textureIsSignedDistanceField:!1,distanceFieldBoundingBox:null,vvSizeEnabled:!1,vvSizeMinSize:[1,1,1],vvSizeMaxSize:[100,100,100],vvSizeOffset:[0,0,0],vvSizeFactor:[1,
1,1],vvColorEnabled:!1,vvColorValues:[0,0,0,0,0,0,0,0],vvColorColors:[1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],screenOffset:[0,0],verticalOffset:null,screenSizePerspective:null,screenSizePerspectiveAlignment:null,slicePlaneEnabled:!1,anchorPos:a.vec2f64.fromValues(.5,.5),shaderPolygonOffset:1E-5,polygonOffset:!1,textureId:null,centerOffsetUnits:"world",depthEnabled:!0,debugDrawBorder:!1},X=v.newLayout().vec3f(I.VertexAttrConstants.POSITION).vec3f(I.VertexAttrConstants.NORMAL).vec2f(I.VertexAttrConstants.UV0).vec4u8(I.VertexAttrConstants.COLOR).vec2f(I.VertexAttrConstants.SIZE).vec4f(I.VertexAttrConstants.AUXPOS1).vec4f(I.VertexAttrConstants.AUXPOS2),
Z=function(){function e(e){this.material=e;this.vertexBufferLayout=X}e.prototype.allocate=function(e){return this.vertexBufferLayout.createBuffer(e)};e.prototype.elementCount=function(e){return 6*e.indices[I.VertexAttrConstants.POSITION].length};e.prototype.write=function(e,g,a,n){x.writePosition(g.indices[I.VertexAttrConstants.POSITION],g.vertexAttr[I.VertexAttrConstants.POSITION].data,e.transformation,a.position,n,6);x.writeNormal(g.indices[I.VertexAttrConstants.NORMAL],g.vertexAttr[I.VertexAttrConstants.NORMAL].data,
e.invTranspTransformation,a.normal,n,6);e=g.vertexAttr[I.VertexAttrConstants.UV0].data;var k=void 0,c=void 0,b=void 0,y=void 0;null==e||4>e.length?(e=this.material.getParameters(),c=k=0,b=e.texCoordScale[0],y=e.texCoordScale[1]):(k=e[0],c=e[1],b=e[2],y=e[3]);var b=Math.min(1.99999,b+1),y=Math.min(1.99999,y+1),p=g.indices[I.VertexAttrConstants.POSITION].length,B=a.uv0;e=n;for(var d=0;d<p;++d)B.set(e,0,k),B.set(e,1,c),e+=1,B.set(e,0,b),B.set(e,1,c),e+=1,B.set(e,0,b),B.set(e,1,y),e+=1,B.set(e,0,b),B.set(e,
1,y),e+=1,B.set(e,0,k),B.set(e,1,y),e+=1,B.set(e,0,k),B.set(e,1,c),e+=1;x.writeColor(g.indices[I.VertexAttrConstants.COLOR],g.vertexAttr[I.VertexAttrConstants.COLOR].data,4,a.color,n,6);k=g.indices[I.VertexAttrConstants.SIZE];c=g.vertexAttr[I.VertexAttrConstants.SIZE].data;b=k.length;y=a.size;e=n;for(d=0;d<b;++d)for(var p=c[2*k[d]],B=c[2*k[d]+1],F=0;6>F;++F)y.set(e,0,p),y.set(e,1,B),e+=1;g.indices[I.VertexAttrConstants.AUXPOS1]&&g.vertexAttr[I.VertexAttrConstants.AUXPOS1]&&x.writeBufferVec4(g.indices[I.VertexAttrConstants.AUXPOS1],
g.vertexAttr[I.VertexAttrConstants.AUXPOS1].data,a.auxpos1,n,6);g.indices[I.VertexAttrConstants.AUXPOS2]&&g.vertexAttr[I.VertexAttrConstants.AUXPOS2]&&x.writeBufferVec4(g.indices[I.VertexAttrConstants.AUXPOS2],g.vertexAttr[I.VertexAttrConstants.AUXPOS2].data,a.auxpos2,n,6)};return e}();return z})},"esri/core/libs/gl-matrix-2/types/mat4":function(){define(["require","exports"],function(z,d){function t(d){return d instanceof Float32Array&&16<=d.length}function l(d){return Array.isArray(d)&&16<=d.length}
Object.defineProperty(d,"__esModule",{value:!0});d.isMat4f32=t;d.isMat4f64=l;d.isMat4=function(d){return t(d)||l(d)}})},"esri/views/3d/webgl-engine/lib/GLMaterialTexture":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/tsSupport/extendsHelper ./DefaultTextureUnits ./GLMaterial ../materials/internal/MaterialUtil".split(" "),function(z,d,t,l,q,b,f){z=function(b){function d(c){var a=b.call(this,c)||this,d=c.textureRep;a.textureRep=d;a.textureId=c.textureId;
a.initTransparent=!!c.initTextureTransparent;var h=function(c){return f.acquireIfNotUndefined(c,d,a.initTransparent)};a.glTextureRef=h(a.textureId);c.normalTextureId&&(a.glTextureRefNormal=h(c.normalTextureId));c.emissiveTextureId&&(a.glTextureRefEmission=h(c.emissiveTextureId));c.occlusionTextureId&&(a.glTextureRefOcclusion=h(c.occlusionTextureId));c.metallicRoughnessTextureId&&(a.glTextureRefRoughnessMetallness=h(c.metallicRoughnessTextureId));return a}l(d,b);d.prototype.dispose=function(){f.releaseIfNotUndefined(this.textureId,
this.textureRep)};d.prototype.updateTexture=function(c){c!==this.textureId&&(f.releaseIfNotUndefined(this.textureId,this.textureRep),this.textureId=c,this.glTextureRef=f.acquireIfNotUndefined(this.textureId,this.textureRep,this.initTransparent))};d.prototype.bindTexture=function(c,a){null!=this.glTextureRef&&(a.setUniform1i("tex",q.DefaultTextureUnits.DIFFUSE),c.bindTexture(this.glTextureRef.glTexture,q.DefaultTextureUnits.DIFFUSE));this.glTextureRefNormal&&(a.setUniform1i("normalTexture",q.DefaultTextureUnits.NORMAL),
c.bindTexture(this.glTextureRefNormal.glTexture,q.DefaultTextureUnits.NORMAL));this.glTextureRefEmission&&(a.setUniform1i("texEmission",q.DefaultTextureUnits.EMISSION),c.bindTexture(this.glTextureRefEmission.glTexture,q.DefaultTextureUnits.EMISSION));this.glTextureRefOcclusion&&(a.setUniform1i("texOcclusion",q.DefaultTextureUnits.OCCLUSION),c.bindTexture(this.glTextureRefOcclusion.glTexture,q.DefaultTextureUnits.OCCLUSION));this.glTextureRefRoughnessMetallness&&(a.setUniform1i("texMetallicRoughness",
q.DefaultTextureUnits.METALLIC_ROUGHNESS),c.bindTexture(this.glTextureRefRoughnessMetallness.glTexture,q.DefaultTextureUnits.METALLIC_ROUGHNESS))};d.prototype.bindTextureScale=function(c,a){(c=this.glTextureRef&&this.glTextureRef.glTexture)&&c.descriptor.textureCoordinateScaleFactor?a.setUniform2fv("textureCoordinateScaleFactor",c.descriptor.textureCoordinateScaleFactor):a.setUniform2f("textureCoordinateScaleFactor",1,1)};return d}(b.GLMaterial);(function(b){b.makeCtorParameters=function(b,c){return t({},
b,c)}})(z||(z={}));return z})},"esri/views/3d/webgl-engine/materials/internal/bufferWriterUtils":function(){define(["require","exports","../../../support/buffer/BufferView","../../lib/Util"],function(z,d,t,l){function q(a,c,b,d,f){var h=b.typedBuffer;b=b.typedBufferStride;var m=a.length;d*=b;if(null==f||1===f)for(var l=0;l<m;++l){var q=2*a[l];h[d]=c[q];h[d+1]=c[q+1];d+=b}else for(l=0;l<m;++l)for(var q=2*a[l],r=0;r<f;++r)h[d]=c[q],h[d+1]=c[q+1],d+=b}function b(a,c,b,d,f){var h=b.typedBuffer;b=b.typedBufferStride;
var m=a.length;d*=b;if(null==f||1===f)for(var l=0;l<m;++l){var q=3*a[l];h[d]=c[q];h[d+1]=c[q+1];h[d+2]=c[q+2];d+=b}else for(l=0;l<m;++l)for(var q=3*a[l],r=0;r<f;++r)h[d]=c[q],h[d+1]=c[q+1],h[d+2]=c[q+2],d+=b}function f(a,c,b,d,f){var h=b.typedBuffer;b=b.typedBufferStride;var m=a.length;d*=b;if(null==f||1===f)for(var l=0;l<m;++l){var q=4*a[l];h[d]=c[q];h[d+1]=c[q+1];h[d+2]=c[q+2];h[d+3]=c[q+3];d+=b}else for(l=0;l<m;++l)for(var q=4*a[l],r=0;r<f;++r)h[d]=c[q],h[d+1]=c[q+1],h[d+2]=c[q+2],h[d+3]=c[q+3],
d+=b}function h(a,c,d,f,h,l){if(d){var m=f.typedBuffer;f=f.typedBufferStride;var q=a.length;h*=f;if(null==l||1===l)for(var r=0;r<q;++r){var t=3*a[r],v=c[t],u=c[t+1],w=c[t+2];m[h]=d[0]*v+d[4]*u+d[8]*w+d[12];m[h+1]=d[1]*v+d[5]*u+d[9]*w+d[13];m[h+2]=d[2]*v+d[6]*u+d[10]*w+d[14];h+=f}else for(r=0;r<q;++r)for(var t=3*a[r],v=c[t],u=c[t+1],w=c[t+2],t=d[0]*v+d[4]*u+d[8]*w+d[12],D=d[1]*v+d[5]*u+d[9]*w+d[13],v=d[2]*v+d[6]*u+d[10]*w+d[14],u=0;u<l;++u)m[h]=t,m[h+1]=D,m[h+2]=v,h+=f}else b(a,c,f,h,l)}function r(a,
c,d,f,h,l){if(d){var m=f.typedBuffer;f=f.typedBufferStride;var q=a.length,r=d[0],t=d[1],v=d[2],u=d[4],w=d[5],D=d[6],z=d[8],P=d[9];d=d[10];var S=1E-5<Math.abs(1-r*r+u*u+z*z)||1E-5<Math.abs(1-t*t+w*w+P*P)||1E-5<Math.abs(1-v*v+D*D+d*d);h*=f;if(null==l||1===l)for(var R=0;R<q;++R){var Q=3*a[R],U=c[Q],V=c[Q+1],Y=c[Q+2];l=r*U+u*V+z*Y;var Q=t*U+w*V+P*Y,T=v*U+D*V+d*Y;S&&(U=l*l+Q*Q+T*T,.999999>U&&1E-6<U&&(U=Math.sqrt(U),l/=U,Q/=U,T/=U));m[h+0]=l;m[h+1]=Q;m[h+2]=T;h+=f}else for(R=0;R<q;++R)for(Q=3*a[R],U=c[Q],
V=c[Q+1],Y=c[Q+2],Q=r*U+u*V+z*Y,T=t*U+w*V+P*Y,V=v*U+D*V+d*Y,S&&(U=Q*Q+T*T+V*V,.999999>U&&1E-6<U&&(U=Math.sqrt(U),Q/=U,T/=U,V/=U)),U=0;U<l;++U)m[h+0]=Q,m[h+1]=T,m[h+2]=V,h+=f}else b(a,c,f,h,l)}function c(a,c,b,d,f,h){var l=d.typedBuffer;d=d.typedBufferStride;var m=a.length;f*=d;if(null==h||1===h)if(4===b)for(b=0;b<m;++b){var q=4*a[b];l[f]=c[q];l[f+1]=c[q+1];l[f+2]=c[q+2];l[f+3]=c[q+3];f+=d}else{if(3===b)for(b=0;b<m;++b)q=3*a[b],l[f]=c[q],l[f+1]=c[q+1],l[f+2]=c[q+2],l[f+3]=255,f+=d}else if(4===b)for(b=
0;b<m;++b)for(var q=4*a[b],r=0;r<h;++r)l[f]=c[q],l[f+1]=c[q+1],l[f+2]=c[q+2],l[f+3]=c[q+3],f+=d;else if(3===b)for(b=0;b<m;++b)for(q=3*a[b],r=0;r<h;++r)l[f]=c[q],l[f+1]=c[q+1],l[f+2]=c[q+2],l[f+3]=255,f+=d}Object.defineProperty(d,"__esModule",{value:!0});d.writeBufferVec2=q;d.writeBufferVec3=b;d.writeBufferVec4=f;d.writeBufferMat3f=function(a,c,b,d){var f=b.typedBuffer;b=b.typedBufferStride;var h=a.length;d*=b;for(var l=0;l<h;++l){for(var m=9*a[l],q=0;9>q;++q)f[d+q]=c[m+q];d+=b}};d.writeBufferMat4f=
function(a,c,b,d){var f=b.typedBuffer;b=b.typedBufferStride;var h=a.length;d*=b;for(var l=0;l<h;++l){for(var m=16*a[l],q=0;16>q;++q)f[d+q]=c[m+q];d+=b}};d.writePosition=h;d.writeNormal=r;d.writeColor=c;d.writeMultipliedColor=function(a,c,b,d,f,h,l){var m=f.typedBuffer;f=f.typedBufferStride;var q=a.length;h*=f;if(null==l||1===l)if(4===b)for(b=0;b<q;++b){var r=4*a[b];m[h]=c[r]*d[0];m[h+1]=c[r+1]*d[1];m[h+2]=c[r+2]*d[2];m[h+3]=c[r+3]*d[3];h+=f}else{if(3===b){var t=255*d[3];for(b=0;b<q;++b)r=3*a[b],m[h]=
c[r]*d[0],m[h+1]=c[r+1]*d[1],m[h+2]=c[r+2]*d[2],m[h+3]=t,h+=f}}else if(4===b)for(b=0;b<q;++b)for(var r=4*a[b],v=0;v<l;++v)m[h]=c[r]*d[0],m[h+1]=c[r+1]*d[1],m[h+2]=c[r+2]*d[2],m[h+3]=c[r+3]*d[3],h+=f;else if(3===b)for(t=255*d[3],b=0;b<q;++b)for(r=3*a[b],v=0;v<l;++v)m[h]=c[r]*d[0],m[h+1]=c[r+1]*d[1],m[h+2]=c[r+2]*d[2],m[h+3]=t,h+=f};d.writeDefaultAttributes=function(a,b,d,D,w,v){var m=0;for(b=b.fieldNames;m<b.length;m++){var u=b[m],z=a.vertexAttr[u],K=a.indices[u];if(z&&K)switch(u){case l.VertexAttrConstants.POSITION:l.assert(3===
z.size);(u=w.getField(u,t.BufferViewVec3f))&&h(K,z.data,d,u,v);break;case l.VertexAttrConstants.NORMAL:l.assert(3===z.size);(u=w.getField(u,t.BufferViewVec3f))&&r(K,z.data,D,u,v);break;case l.VertexAttrConstants.UV0:l.assert(2===z.size);(u=w.getField(u,t.BufferViewVec2f))&&q(K,z.data,u,v);break;case l.VertexAttrConstants.REGION:l.assert(4===z.size);(u=w.getField(u,t.BufferViewVec4u16))&&f(K,z.data,u,v);break;case l.VertexAttrConstants.COLOR:l.assert(3===z.size||4===z.size);(u=w.getField(u,t.BufferViewVec4u8))&&
c(K,z.data,z.size,u,v);break;case l.VertexAttrConstants.SYMBOLCOLOR:l.assert(3===z.size||4===z.size);(u=w.getField(u,t.BufferViewVec4u8))&&c(K,z.data,z.size,u,v);break;case l.VertexAttrConstants.TANGENT:l.assert(4===z.size),(u=w.getField(u,t.BufferViewVec4f))&&f(K,z.data,u,v)}}}})},"esri/views/3d/webgl-engine/shaders/HUDMaterial.glsl":function(){define("require exports ../../../../core/tsSupport/makeTemplateObjectHelper ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f64 ../../../../core/libs/gl-matrix-2/vec4f64 ../core/shaderLibrary/Slice.glsl ../core/shaderLibrary/hud/AlignPixel.glsl ../core/shaderLibrary/hud/HUD.glsl ../core/shaderLibrary/hud/HUDOcclusionPass.glsl ../core/shaderLibrary/output/OutputHighlight.glsl ../core/shaderLibrary/shading/VisualVariables.glsl ../core/shaderLibrary/util/AlphaDiscard.glsl ../core/shaderLibrary/util/ColorConversion.glsl ../core/shaderLibrary/util/RgbaFloatEncoding.glsl ../core/shaderLibrary/util/ScreenSizePerspective.glsl ../core/shaderModules/interfaces ../core/shaderModules/ShaderBuilder".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u,D,w,v,E,C){function J(a,k){void 0===k&&(k=K);if(a.textureIsSignedDistanceField){var e=a.anchorPos;a=a.distanceFieldBoundingBox;var g=k;g[0]=e[0]*(a[2]-a[0])+a[0];g[1]=e[1]*(a[3]-a[1])+a[1]}else l.vec2.copy(k,a.anchorPos);return k}Object.defineProperty(d,"__esModule",{value:!0});d.build=function(b){var k=new C.ShaderBuilder,e=b.signedDistanceFieldEnabled;k.include(h.AlignPixel);k.include(r.HUD,b);k.include(f.Slice,b);if(6===b.output)return k.include(c.HUDOcclusionPass,
b),k;k.include(v.ScreenSizePerspective);k.include(w.RgbaFloatEncoding);k.include(D.ColorConversion,{stages:1});k.include(m.VisualVariables,b);k.varyings.add("vcolor","vec4");k.varyings.add("vtc","vec2");k.varyings.add("vsize","vec2");b.binaryHighlightOcclusionEnabled&&k.varyings.add("voccluded","float");k.vertex.uniforms.add("screenOffset","vec2").add("anchorPos","vec2").add("textureCoordinateScaleFactor","vec2").add("materialColor","vec4");e&&k.vertex.uniforms.add("outlineColor","vec4");b.screenSizePerspectiveEnabled&&
k.vertex.uniforms.add("screenSizePerspective","vec4");(b.debugDrawBorder||b.binaryHighlightOcclusionEnabled)&&k.varyings.add("debugBorderCoords","vec4");k.attributes.add("uv0","vec2");k.attributes.add("color","vec4");k.attributes.add("size","vec2");k.attributes.add("auxpos2","vec4");k.vertex.code.add(E.glsl(x||(x=t(["\n    void main(void) {\n      ProjectHUDAux projectAux;\n      vec4 posProj \x3d projectPositionHUD(projectAux);\n\n      if (rejectBySlice(projectAux.posModel)) {\n        // Project outside of clip plane\n        gl_Position \x3d vec4(1e038, 1e038, 1e038, 1.0);\n        return;\n      }\n      vec2 inputSize;\n      ",
"\n\n      ","\n\n      vec2 combinedSize \x3d inputSize * pixelRatio;\n      vec4 quadOffset \x3d vec4(0.0);\n\n      ","\n\n      ","\n    "],["\n    void main(void) {\n      ProjectHUDAux projectAux;\n      vec4 posProj \x3d projectPositionHUD(projectAux);\n\n      if (rejectBySlice(projectAux.posModel)) {\n        // Project outside of clip plane\n        gl_Position \x3d vec4(1e038, 1e038, 1e038, 1.0);\n        return;\n      }\n      vec2 inputSize;\n      ","\n\n      ","\n\n      vec2 combinedSize \x3d inputSize * pixelRatio;\n      vec4 quadOffset \x3d vec4(0.0);\n\n      ",
"\n\n      ","\n    "])),b.screenSizePerspectiveEnabled?E.glsl(G||(G=t(["\n      inputSize \x3d screenSizePerspectiveScaleVec2(size, projectAux.absCosAngle, projectAux.distanceToCamera, screenSizePerspective);\n      vec2 screenOffsetScaled \x3d screenSizePerspectiveScaleVec2(screenOffset, projectAux.absCosAngle, projectAux.distanceToCamera, screenSizePerspectiveAlignment);\n         "],["\n      inputSize \x3d screenSizePerspectiveScaleVec2(size, projectAux.absCosAngle, projectAux.distanceToCamera, screenSizePerspective);\n      vec2 screenOffsetScaled \x3d screenSizePerspectiveScaleVec2(screenOffset, projectAux.absCosAngle, projectAux.distanceToCamera, screenSizePerspectiveAlignment);\n         "]))):
E.glsl(I||(I=t(["\n      inputSize \x3d size;\n      vec2 screenOffsetScaled \x3d screenOffset;"],["\n      inputSize \x3d size;\n      vec2 screenOffsetScaled \x3d screenOffset;"]))),b.vvSize?"inputSize *\x3d vvScale(auxpos2).xx;":"",b.occlusionTestEnabled||b.binaryHighlightOcclusionEnabled?"bool visible \x3d testVisibilityHUD(posProj);":"",b.binaryHighlightOcclusionEnabled?"voccluded \x3d visible ? 0.0 : 1.0;":""));var g=E.glsl(N||(N=t(["\n      vec2 uv01 \x3d floor(uv0);\n      vec2 uv \x3d uv0 - uv01;\n      quadOffset.xy \x3d ((uv01 - anchorPos) * 2.0 * combinedSize + screenOffsetScaled) / viewport.zw * posProj.w;\n  "],
["\n      vec2 uv01 \x3d floor(uv0);\n      vec2 uv \x3d uv0 - uv01;\n      quadOffset.xy \x3d ((uv01 - anchorPos) * 2.0 * combinedSize + screenOffsetScaled) / viewport.zw * posProj.w;\n  "]))),n=e?E.glsl(O||(O=t(["\n  posProj \x3d alignToPixelOrigin(posProj, viewport.zw) + quadOffset;"],["\n  posProj \x3d alignToPixelOrigin(posProj, viewport.zw) + quadOffset;"]))):E.glsl(P||(P=t(["\n  posProj +\x3d quadOffset;\n  if (inputSize.x \x3d\x3d size.x) {\n    posProj \x3d alignToPixelOrigin(posProj, viewport.zw);\n  }"],
["\n  posProj +\x3d quadOffset;\n  if (inputSize.x \x3d\x3d size.x) {\n    posProj \x3d alignToPixelOrigin(posProj, viewport.zw);\n  }"])));k.vertex.code.add(E.glsl(R||(R=t(["\n      ","\n      ","\n      ","\n\n      bool alphaDiscard \x3d vcolor.a \x3c ",";\n      ",'\n      if (alphaDiscard) {\n        // "early discard" if both symbol color (\x3d fill) and outline color (if applicable) are transparent\n        gl_Position \x3d vec4(1e38, 1e38, 1e38, 1.0);\n        return;\n      } else {\n        ',
"\n        gl_Position \x3d posProj;\n      }\n\n      vtc \x3d uv * textureCoordinateScaleFactor;\n\n      ","\n      vsize \x3d inputSize;\n      ","\n    }\n    "],["\n      ","\n      ","\n      ","\n\n      bool alphaDiscard \x3d vcolor.a \x3c ",";\n      ",'\n      if (alphaDiscard) {\n        // "early discard" if both symbol color (\x3d fill) and outline color (if applicable) are transparent\n        gl_Position \x3d vec4(1e38, 1e38, 1e38, 1.0);\n        return;\n      } else {\n        ',
"\n        gl_Position \x3d posProj;\n      }\n\n      vtc \x3d uv * textureCoordinateScaleFactor;\n\n      ","\n      vsize \x3d inputSize;\n      ","\n    }\n    "])),b.occlusionTestEnabled?"if (visible) {":"",g,b.vvColor?"vcolor \x3d vvGetColor(auxpos2, vvColorValues, vvColorColors) * materialColor;":"vcolor \x3d color / 255.0 * materialColor;",E.glsl.float(u.symbolAlphaCutoff),e?"alphaDiscard \x3d alphaDiscard \x26\x26 outlineColor.a \x3c "+E.glsl.float(u.symbolAlphaCutoff)+";":"",n,b.debugDrawBorder?
"debugBorderCoords \x3d vec4(uv01, 1.5 / combinedSize);":"",b.occlusionTestEnabled?E.glsl(S||(S=t(["} else { vtc \x3d vec2(0.0);\n        ",""],["} else { vtc \x3d vec2(0.0);\n        ",""])),b.debugDrawBorder?"debugBorderCoords \x3d vec4(0.5, 0.5, 1.5 / combinedSize);}":"}"):""));k.fragment.uniforms.add("tex","sampler2D");e&&(k.fragment.uniforms.add("outlineColor","vec4"),k.fragment.uniforms.add("outlineSize","float"));g=b.debugDrawBorder?E.glsl(Q||(Q=t(["(isBorder \x3e 0.0 ? 0.0 : ",")"],["(isBorder \x3e 0.0 ? 0.0 : ",
")"])),E.glsl.float(u.defaultMaskAlphaCutoff)):E.glsl.float(u.defaultMaskAlphaCutoff);e=E.glsl(aa||(aa=t(["\n    ","\n\n    ","\n\n    ","\n  "],["\n    ","\n\n    ","\n\n    ","\n  "])),b.debugDrawBorder?E.glsl(U||(U=t(["\n      float isBorder \x3d float(any(lessThan(debugBorderCoords.xy, debugBorderCoords.zw)) || any(greaterThan(debugBorderCoords.xy, 1.0 - debugBorderCoords.zw)));"],["\n      float isBorder \x3d float(any(lessThan(debugBorderCoords.xy, debugBorderCoords.zw)) || any(greaterThan(debugBorderCoords.xy, 1.0 - debugBorderCoords.zw)));"]))):
"",e?E.glsl(V||(V=t(["\n      vec4 fillPixelColor \x3d vcolor;\n\n      // Attempt to sample texel centers to avoid that thin cross outlines\n      // disappear with large symbol sizes.\n      // see: https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/7058#issuecomment-603041\n      const float txSize \x3d 128.0;\n      const float texelSize \x3d 1.0 / txSize;\n      // Calculate how much we have to add/subtract to/from each texel to reach the size of an onscreen pixel\n      vec2 scaleFactor \x3d (vsize - txSize) * texelSize;\n      vec2 samplePos \x3d vtc + (vec2(1.0, -1.0) * texelSize) * scaleFactor;\n\n      // Get distance and map it into [-0.5, 0.5]\n      float d \x3d rgba2float(texture2D(tex, samplePos)) - 0.5;\n\n      // Distance in output units (i.e. pixels)\n      float dist \x3d d * vsize.x;\n\n      // Create smooth transition from the icon into its outline\n      float fillAlphaFactor \x3d clamp(0.5 - dist, 0.0, 1.0);\n      fillPixelColor.a *\x3d fillAlphaFactor;\n\n      if (outlineSize \x3e 0.25) {\n        vec4 outlinePixelColor \x3d outlineColor;\n        float clampedOutlineSize \x3d min(outlineSize, 0.5*vsize.x);\n\n        // Create smooth transition around outline\n        float outlineAlphaFactor \x3d clamp(0.5 - (abs(dist) - 0.5*clampedOutlineSize), 0.0, 1.0);\n        outlinePixelColor.a *\x3d outlineAlphaFactor;\n\n        if (\n          outlineAlphaFactor + fillAlphaFactor \x3c ",
" ||\n          fillPixelColor.a + outlinePixelColor.a \x3c ","\n        ) {\n          discard;\n        }\n\n        // perform un-premultiplied over operator (see https://en.wikipedia.org/wiki/Alpha_compositing#Description)\n        float compositeAlpha \x3d outlinePixelColor.a + fillPixelColor.a * (1.0 - outlinePixelColor.a);\n        vec3 compositeColor \x3d vec3(outlinePixelColor) * outlinePixelColor.a +\n          vec3(fillPixelColor) * fillPixelColor.a * (1.0 - outlinePixelColor.a);\n\n        gl_FragColor \x3d vec4(compositeColor, compositeAlpha);\n      } else {\n        if (fillAlphaFactor \x3c ",
") {\n          discard;\n        }\n\n        gl_FragColor \x3d premultiplyAlpha(fillPixelColor);\n      }\n\n      // visualize SDF:\n      // gl_FragColor \x3d vec4(clamp(-dist/vsize.x*2.0, 0.0, 1.0), clamp(dist/vsize.x*2.0, 0.0, 1.0), 0.0, 1.0);\n      "],["\n      vec4 fillPixelColor \x3d vcolor;\n\n      // Attempt to sample texel centers to avoid that thin cross outlines\n      // disappear with large symbol sizes.\n      // see: https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/7058#issuecomment-603041\n      const float txSize \x3d 128.0;\n      const float texelSize \x3d 1.0 / txSize;\n      // Calculate how much we have to add/subtract to/from each texel to reach the size of an onscreen pixel\n      vec2 scaleFactor \x3d (vsize - txSize) * texelSize;\n      vec2 samplePos \x3d vtc + (vec2(1.0, -1.0) * texelSize) * scaleFactor;\n\n      // Get distance and map it into [-0.5, 0.5]\n      float d \x3d rgba2float(texture2D(tex, samplePos)) - 0.5;\n\n      // Distance in output units (i.e. pixels)\n      float dist \x3d d * vsize.x;\n\n      // Create smooth transition from the icon into its outline\n      float fillAlphaFactor \x3d clamp(0.5 - dist, 0.0, 1.0);\n      fillPixelColor.a *\x3d fillAlphaFactor;\n\n      if (outlineSize \x3e 0.25) {\n        vec4 outlinePixelColor \x3d outlineColor;\n        float clampedOutlineSize \x3d min(outlineSize, 0.5*vsize.x);\n\n        // Create smooth transition around outline\n        float outlineAlphaFactor \x3d clamp(0.5 - (abs(dist) - 0.5*clampedOutlineSize), 0.0, 1.0);\n        outlinePixelColor.a *\x3d outlineAlphaFactor;\n\n        if (\n          outlineAlphaFactor + fillAlphaFactor \x3c ",
" ||\n          fillPixelColor.a + outlinePixelColor.a \x3c ","\n        ) {\n          discard;\n        }\n\n        // perform un-premultiplied over operator (see https://en.wikipedia.org/wiki/Alpha_compositing#Description)\n        float compositeAlpha \x3d outlinePixelColor.a + fillPixelColor.a * (1.0 - outlinePixelColor.a);\n        vec3 compositeColor \x3d vec3(outlinePixelColor) * outlinePixelColor.a +\n          vec3(fillPixelColor) * fillPixelColor.a * (1.0 - outlinePixelColor.a);\n\n        gl_FragColor \x3d vec4(compositeColor, compositeAlpha);\n      } else {\n        if (fillAlphaFactor \x3c ",
") {\n          discard;\n        }\n\n        gl_FragColor \x3d premultiplyAlpha(fillPixelColor);\n      }\n\n      // visualize SDF:\n      // gl_FragColor \x3d vec4(clamp(-dist/vsize.x*2.0, 0.0, 1.0), clamp(dist/vsize.x*2.0, 0.0, 1.0), 0.0, 1.0);\n      "])),g,E.glsl.float(u.symbolAlphaCutoff),g):E.glsl(Y||(Y=t(["\n          vec4 texColor \x3d texture2D(tex, vtc, -0.5);\n          if (texColor.a \x3c ",") {\n            discard;\n          }\n          gl_FragColor \x3d texColor * premultiplyAlpha(vcolor);\n          "],
["\n          vec4 texColor \x3d texture2D(tex, vtc, -0.5);\n          if (texColor.a \x3c ",") {\n            discard;\n          }\n          gl_FragColor \x3d texColor * premultiplyAlpha(vcolor);\n          "])),g),b.debugDrawBorder?E.glsl(T||(T=t(["gl_FragColor \x3d mix(gl_FragColor, vec4(1.0, 0.0, 1.0, 1.0), isBorder);"],["gl_FragColor \x3d mix(gl_FragColor, vec4(1.0, 0.0, 1.0, 1.0), isBorder);"]))):"");0===b.output&&k.fragment.code.add(E.glsl(W||(W=t(["\n    void main() {\n      ","\n    }\n    "],
["\n    void main() {\n      ","\n    }\n    "])),e));4===b.output&&(k.include(a.OutputHighlight),k.fragment.code.add(E.glsl(L||(L=t(["\n    void main() {\n      ","\n      ","\n    }\n    "],["\n    void main() {\n      ","\n      ","\n    }\n    "])),e,b.binaryHighlightOcclusionEnabled?E.glsl(p||(p=t(["\n          if (voccluded \x3d\x3d 1.0) {\n            gl_FragColor \x3d vec4(1.0, 1.0, 0.0, 1.0);\n          } else {\n            gl_FragColor \x3d vec4(1.0, 0.0, 1.0, 1.0);\n          }"],["\n          if (voccluded \x3d\x3d 1.0) {\n            gl_FragColor \x3d vec4(1.0, 1.0, 0.0, 1.0);\n          } else {\n            gl_FragColor \x3d vec4(1.0, 0.0, 1.0, 1.0);\n          }"]))):
"outputHighlight();")));return k};(function(a){a.bindUniforms=function(a,e,g){a.setUniform4fv("materialColor",e.color);e.textureIsSignedDistanceField&&(0>=e.outlineColor[3]||0>=e.outlineSize?(a.setUniform4fv("outlineColor",b.vec4f64.ZEROS),a.setUniform1f("outlineSize",0)):(a.setUniform4fv("outlineColor",e.outlineColor),a.setUniform1f("outlineSize",e.outlineSize)));g=g.pixelRatio||1;a.setUniform2f("screenOffset",2*e.screenOffset[0]*g,2*e.screenOffset[1]*g);a.setUniform2fv("anchorPos",J(e))}})(d.HUDMaterial||
(d.HUDMaterial={}));d.calculateAnchorPosForRendering=J;var K=q.vec2f64.create(),G,I,x,N,O,P,S,R,Q,U,V,Y,T,aa,W,p,L})},"esri/views/3d/webgl-engine/core/shaderLibrary/hud/AlignPixel.glsl":function(){define(["require","exports","../../../../../../core/tsSupport/makeTemplateObjectHelper","../../shaderModules/interfaces"],function(z,d,t,l){Object.defineProperty(d,"__esModule",{value:!0});d.AlignPixel=function(d){var f=l.glsl(q||(q=t(["\n    vec4 alignToPixelCenter(vec4 clipCoord, vec2 widthHeight) {\n      vec2 xy \x3d vec2(0.500123) + 0.5 * clipCoord.xy / clipCoord.w;\n      vec2 pixelSz \x3d vec2(1.0) / widthHeight;\n      vec2 ij \x3d (floor(xy * widthHeight) + vec2(0.5)) * pixelSz;\n      vec2 result \x3d (ij * 2.0 - vec2(1.0)) * clipCoord.w;\n      return vec4(result, clipCoord.zw);\n    }\n  "],
["\n    vec4 alignToPixelCenter(vec4 clipCoord, vec2 widthHeight) {\n      vec2 xy \x3d vec2(0.500123) + 0.5 * clipCoord.xy / clipCoord.w;\n      vec2 pixelSz \x3d vec2(1.0) / widthHeight;\n      vec2 ij \x3d (floor(xy * widthHeight) + vec2(0.5)) * pixelSz;\n      vec2 result \x3d (ij * 2.0 - vec2(1.0)) * clipCoord.w;\n      return vec4(result, clipCoord.zw);\n    }\n  "]))),r=l.glsl(b||(b=t(["\n\n    vec4 alignToPixelOrigin(vec4 clipCoord, vec2 widthHeight) {\n      vec2 xy \x3d vec2(0.5) + 0.5 * clipCoord.xy / clipCoord.w;\n      vec2 pixelSz \x3d vec2(1.0) / widthHeight;\n      vec2 ij \x3d floor((xy + 0.5 * pixelSz) * widthHeight) * pixelSz;\n      vec2 result \x3d (ij * 2.0 - vec2(1.0)) * clipCoord.w;\n      return vec4(result, clipCoord.zw);\n    }\n  "],
["\n\n    vec4 alignToPixelOrigin(vec4 clipCoord, vec2 widthHeight) {\n      vec2 xy \x3d vec2(0.5) + 0.5 * clipCoord.xy / clipCoord.w;\n      vec2 pixelSz \x3d vec2(1.0) / widthHeight;\n      vec2 ij \x3d floor((xy + 0.5 * pixelSz) * widthHeight) * pixelSz;\n      vec2 result \x3d (ij * 2.0 - vec2(1.0)) * clipCoord.w;\n      return vec4(result, clipCoord.zw);\n    }\n  "])));d.vertex.code.add(f);d.vertex.code.add(r);d.fragment.code.add(f);d.fragment.code.add(r)};var q,b})},"esri/views/3d/webgl-engine/core/shaderLibrary/hud/HUD.glsl":function(){define(["require",
"exports","../../../../../../core/tsSupport/makeTemplateObjectHelper","../util/ScreenSizePerspective.glsl","../../shaderModules/interfaces"],function(z,d,t,l,q){function b(b,d){b.include(l.ScreenSizePerspective);b.attributes.add("position","vec3");b.attributes.add("normal","vec3");b.attributes.add("auxpos1","vec4");b.vertex.uniforms.add("proj","mat4");b.vertex.uniforms.add("view","mat4");b.vertex.uniforms.add("viewNormal","mat4");b.vertex.uniforms.add("model","mat4");b.vertex.uniforms.add("modelNormal",
"mat4");b.vertex.uniforms.add("viewport","vec4");b.vertex.uniforms.add("camPos","vec3");b.vertex.uniforms.add("polygonOffset","float");b.vertex.uniforms.add("cameraGroundRelative","float");b.vertex.uniforms.add("pixelRatio","float");b.vertex.uniforms.add("perDistancePixelRatio","float");b.vertex.uniforms.add("uRenderTransparentlyOccludedHUD","float");d.verticalOffsetEnabled&&b.vertex.uniforms.add("verticalOffset","vec4");d.screenSizePerspectiveEnabled&&b.vertex.uniforms.add("screenSizePerspectiveAlignment",
"vec4");b.vertex.uniforms.add("hudVisibilityTexture","sampler2D");b.vertex.defines.addFloat("SMALL_OFFSET_ANGLE",.984807753012208);b.vertex.code.add(q.glsl(f||(f=t(["\n    struct ProjectHUDAux {\n      vec3 posModel;\n      vec3 posView;\n      vec3 vnormal;\n\n      float distanceToCamera;\n      float absCosAngle;\n    };\n  "],["\n    struct ProjectHUDAux {\n      vec3 posModel;\n      vec3 posView;\n      vec3 vnormal;\n\n      float distanceToCamera;\n      float absCosAngle;\n    };\n  "]))));
b.vertex.code.add(q.glsl(h||(h=t(["\n    float applyHUDViewDependentPolygonOffset(float pointGroundDistance, float absCosAngle, inout vec3 posView) {\n      float pointGroundSign \x3d sign(pointGroundDistance);\n\n      if (pointGroundSign \x3d\x3d 0.0) {\n        pointGroundSign \x3d cameraGroundRelative;\n      }\n\n      // cameraGroundRelative is -1 if camera is below ground, 1 if above ground\n      // groundRelative is 1 if both camera and symbol are on the same side of the ground, -1 otherwise\n      float groundRelative \x3d cameraGroundRelative * pointGroundSign;\n\n      // view angle dependent part of polygon offset emulation\n      // we take the absolute value because the sign that is dropped is\n      // instead introduced using the ground-relative position of the symbol and the camera\n      if (polygonOffset \x3e .0) {\n        float cosAlpha \x3d clamp(absCosAngle, 0.01, 1.0);\n\n        float tanAlpha \x3d sqrt(1.0 - cosAlpha * cosAlpha) / cosAlpha;\n        float factor \x3d (1.0 - tanAlpha / viewport[2]);\n\n        // same side of the terrain\n        if (groundRelative \x3e 0.0) {\n          posView *\x3d factor;\n        }\n        // opposite sides of the terrain\n        else {\n          posView /\x3d factor;\n        }\n      }\n\n      return groundRelative;\n    }\n  "],
["\n    float applyHUDViewDependentPolygonOffset(float pointGroundDistance, float absCosAngle, inout vec3 posView) {\n      float pointGroundSign \x3d sign(pointGroundDistance);\n\n      if (pointGroundSign \x3d\x3d 0.0) {\n        pointGroundSign \x3d cameraGroundRelative;\n      }\n\n      // cameraGroundRelative is -1 if camera is below ground, 1 if above ground\n      // groundRelative is 1 if both camera and symbol are on the same side of the ground, -1 otherwise\n      float groundRelative \x3d cameraGroundRelative * pointGroundSign;\n\n      // view angle dependent part of polygon offset emulation\n      // we take the absolute value because the sign that is dropped is\n      // instead introduced using the ground-relative position of the symbol and the camera\n      if (polygonOffset \x3e .0) {\n        float cosAlpha \x3d clamp(absCosAngle, 0.01, 1.0);\n\n        float tanAlpha \x3d sqrt(1.0 - cosAlpha * cosAlpha) / cosAlpha;\n        float factor \x3d (1.0 - tanAlpha / viewport[2]);\n\n        // same side of the terrain\n        if (groundRelative \x3e 0.0) {\n          posView *\x3d factor;\n        }\n        // opposite sides of the terrain\n        else {\n          posView /\x3d factor;\n        }\n      }\n\n      return groundRelative;\n    }\n  "]))));
b.vertex.code.add(q.glsl(r||(r=t(["\n    void applyHUDVerticalGroundOffset(vec3 normalModel, inout vec3 posModel, inout vec3 posView) {\n      float distanceToCamera \x3d length(posView);\n\n      // Compute offset in world units for a half pixel shift\n      float pixelOffset \x3d distanceToCamera * perDistancePixelRatio * 0.5;\n\n      // Apply offset along normal in the direction away from the ground surface\n      vec3 modelOffset \x3d normalModel * cameraGroundRelative * pixelOffset;\n\n      // Apply the same offset also on the view space position\n      vec3 viewOffset \x3d (viewNormal * vec4(modelOffset, 1.0)).xyz;\n\n      posModel +\x3d modelOffset;\n      posView +\x3d viewOffset;\n    }\n  "],
["\n    void applyHUDVerticalGroundOffset(vec3 normalModel, inout vec3 posModel, inout vec3 posView) {\n      float distanceToCamera \x3d length(posView);\n\n      // Compute offset in world units for a half pixel shift\n      float pixelOffset \x3d distanceToCamera * perDistancePixelRatio * 0.5;\n\n      // Apply offset along normal in the direction away from the ground surface\n      vec3 modelOffset \x3d normalModel * cameraGroundRelative * pixelOffset;\n\n      // Apply the same offset also on the view space position\n      vec3 viewOffset \x3d (viewNormal * vec4(modelOffset, 1.0)).xyz;\n\n      posModel +\x3d modelOffset;\n      posView +\x3d viewOffset;\n    }\n  "]))));
b.vertex.code.add(q.glsl(m||(m=t(["\n    vec4 projectPositionHUD(out ProjectHUDAux aux) {\n      // centerOffset is in view space and is used to implement world size offsetting\n      // of labels with respect to objects. It also pulls the label towards the viewer\n      // so that the label is visible in front of the object.\n      vec3 centerOffset \x3d auxpos1.xyz;\n\n      // The pointGroundDistance is the distance of the geometry to the ground and is\n      // negative if the point is below the ground, or positive if the point is above\n      // ground.\n      float pointGroundDistance \x3d auxpos1.w;\n\n      aux.posModel \x3d (model * vec4(position, 1.0)).xyz;\n      aux.posView \x3d (view * vec4(aux.posModel, 1.0)).xyz;\n      aux.vnormal \x3d (modelNormal * vec4(normal, 1.0)).xyz;\n\n      applyHUDVerticalGroundOffset(aux.vnormal, aux.posModel, aux.posView);\n\n      // Screen sized offset in world space, used for example for line callouts\n      // Note: keep this implementation in sync with the CPU implementation, see\n      //   - MaterialUtil.verticalOffsetAtDistance\n      //   - HUDMaterial.applyVerticalOffsetTransformation\n\n      aux.distanceToCamera \x3d length(aux.posView);\n\n      vec3 viewDirObjSpace \x3d normalize(camPos - aux.posModel);\n      float cosAngle \x3d dot(aux.vnormal, viewDirObjSpace);\n\n      aux.absCosAngle \x3d abs(cosAngle);\n\n      ",
"\n\n      ","\n\n      ","\n\n      float groundRelative \x3d applyHUDViewDependentPolygonOffset(pointGroundDistance, aux.absCosAngle, aux.posView);\n\n      ","\n\n      vec4 posProj \x3d proj * vec4(aux.posView, 1.0);\n\n      ","\n\n      ","\n\n      // constant part of polygon offset emulation\n      posProj.z -\x3d groundRelative * polygonOffset * posProj.w;\n      return posProj;\n    }\n  "],["\n    vec4 projectPositionHUD(out ProjectHUDAux aux) {\n      // centerOffset is in view space and is used to implement world size offsetting\n      // of labels with respect to objects. It also pulls the label towards the viewer\n      // so that the label is visible in front of the object.\n      vec3 centerOffset \x3d auxpos1.xyz;\n\n      // The pointGroundDistance is the distance of the geometry to the ground and is\n      // negative if the point is below the ground, or positive if the point is above\n      // ground.\n      float pointGroundDistance \x3d auxpos1.w;\n\n      aux.posModel \x3d (model * vec4(position, 1.0)).xyz;\n      aux.posView \x3d (view * vec4(aux.posModel, 1.0)).xyz;\n      aux.vnormal \x3d (modelNormal * vec4(normal, 1.0)).xyz;\n\n      applyHUDVerticalGroundOffset(aux.vnormal, aux.posModel, aux.posView);\n\n      // Screen sized offset in world space, used for example for line callouts\n      // Note: keep this implementation in sync with the CPU implementation, see\n      //   - MaterialUtil.verticalOffsetAtDistance\n      //   - HUDMaterial.applyVerticalOffsetTransformation\n\n      aux.distanceToCamera \x3d length(aux.posView);\n\n      vec3 viewDirObjSpace \x3d normalize(camPos - aux.posModel);\n      float cosAngle \x3d dot(aux.vnormal, viewDirObjSpace);\n\n      aux.absCosAngle \x3d abs(cosAngle);\n\n      ",
"\n\n      ","\n\n      ","\n\n      float groundRelative \x3d applyHUDViewDependentPolygonOffset(pointGroundDistance, aux.absCosAngle, aux.posView);\n\n      ","\n\n      vec4 posProj \x3d proj * vec4(aux.posView, 1.0);\n\n      ","\n\n      ","\n\n      // constant part of polygon offset emulation\n      posProj.z -\x3d groundRelative * polygonOffset * posProj.w;\n      return posProj;\n    }\n  "])),d.screenSizePerspectiveEnabled?d.verticalOffsetEnabled||1===d.screenCenterOffsetUnitsEnabled?"vec4 perspectiveFactor \x3d screenSizePerspectiveScaleFactor(aux.absCosAngle, aux.distanceToCamera, screenSizePerspectiveAlignment);":
"":"",d.verticalOffsetEnabled?d.screenSizePerspectiveEnabled?"float verticalOffsetScreenHeight \x3d applyScreenSizePerspectiveScaleFactorFloat(verticalOffset.x, perspectiveFactor);":"float verticalOffsetScreenHeight \x3d verticalOffset.x;":"",d.verticalOffsetEnabled?q.glsl(c||(c=t(["\n            float worldOffset \x3d clamp(verticalOffsetScreenHeight * verticalOffset.y * aux.distanceToCamera, verticalOffset.z, verticalOffset.w);\n            vec3 modelOffset \x3d aux.vnormal * worldOffset;\n            aux.posModel +\x3d modelOffset;\n            vec3 viewOffset \x3d (viewNormal * vec4(modelOffset, 1.0)).xyz;\n            aux.posView +\x3d viewOffset;\n            // Since we elevate the object, we need to take that into account\n            // in the distance to ground\n            pointGroundDistance +\x3d worldOffset;"],
["\n            float worldOffset \x3d clamp(verticalOffsetScreenHeight * verticalOffset.y * aux.distanceToCamera, verticalOffset.z, verticalOffset.w);\n            vec3 modelOffset \x3d aux.vnormal * worldOffset;\n            aux.posModel +\x3d modelOffset;\n            vec3 viewOffset \x3d (viewNormal * vec4(modelOffset, 1.0)).xyz;\n            aux.posView +\x3d viewOffset;\n            // Since we elevate the object, we need to take that into account\n            // in the distance to ground\n            pointGroundDistance +\x3d worldOffset;"]))):
"",1!==d.screenCenterOffsetUnitsEnabled?q.glsl(a||(a=t(["\n            // Apply x/y in view space, but z in screen space (i.e. along posView direction)\n            aux.posView +\x3d vec3(centerOffset.x, centerOffset.y, 0.0);\n\n            // Same material all have same z !\x3d 0.0 condition so should not lead to\n            // branch fragmentation and will save a normalization if it's not needed\n            if (centerOffset.z !\x3d 0.0) {\n              aux.posView -\x3d normalize(aux.posView) * centerOffset.z;\n            }\n          "],
["\n            // Apply x/y in view space, but z in screen space (i.e. along posView direction)\n            aux.posView +\x3d vec3(centerOffset.x, centerOffset.y, 0.0);\n\n            // Same material all have same z !\x3d 0.0 condition so should not lead to\n            // branch fragmentation and will save a normalization if it's not needed\n            if (centerOffset.z !\x3d 0.0) {\n              aux.posView -\x3d normalize(aux.posView) * centerOffset.z;\n            }\n          "]))):"",
1===d.screenCenterOffsetUnitsEnabled?d.screenSizePerspectiveEnabled?"float centerOffsetY \x3d applyScreenSizePerspectiveScaleFactorFloat(centerOffset.y, perspectiveFactor);":"float centerOffsetY \x3d centerOffset.y;":"",1===d.screenCenterOffsetUnitsEnabled?"posProj.xy +\x3d vec2(centerOffset.x, centerOffsetY) * pixelRatio * 2.0 / viewport.zw * posProj.w;":""));b.vertex.code.add(q.glsl(u||(u=t(["\n    bool testVisibilityHUD(vec4 posProj) {\n      // For occlusion testing, use the nearest pixel center to avoid\n      // subpixel filtering messing up the color we use to test for\n      vec4 posProjCenter \x3d alignToPixelCenter(posProj, viewport.zw);\n\n      vec4 occlusionPixel \x3d texture2D(hudVisibilityTexture, .5 + .5 * posProjCenter.xy / posProjCenter.w);\n\n      // the red pixel here indicates that the occlusion pixel passed the depth test against solid geometry and was written\n      // the green pixel stores transparency of transparent geometry (1.0 -\x3e fully transparent)\n      // note that we also check against green \x3d\x3d 0.0, i.e. transparent geometry that has opaque parts\n\n      // thus we render visible pixels that are occluded by semi-transparent (but not fully transparent!) geometry here\n      if (uRenderTransparentlyOccludedHUD \x3e 0.5) {\n        // multiplying by uRenderTransparentlyOccludedHUD allows us to ignore the second condition if\n        // uRenderTransparentlyOccludedHUD \x3d 0.75\n        return occlusionPixel.r * occlusionPixel.g \x3e 0.0 \x26\x26 occlusionPixel.g * uRenderTransparentlyOccludedHUD \x3c 1.0;\n      }\n\n      // and visible pixels that are not occluded by semi-transparent geometry here\n      return occlusionPixel.r * occlusionPixel.g \x3e 0.0 \x26\x26 occlusionPixel.g \x3d\x3d 1.0;\n    }\n  "],
["\n    bool testVisibilityHUD(vec4 posProj) {\n      // For occlusion testing, use the nearest pixel center to avoid\n      // subpixel filtering messing up the color we use to test for\n      vec4 posProjCenter \x3d alignToPixelCenter(posProj, viewport.zw);\n\n      vec4 occlusionPixel \x3d texture2D(hudVisibilityTexture, .5 + .5 * posProjCenter.xy / posProjCenter.w);\n\n      // the red pixel here indicates that the occlusion pixel passed the depth test against solid geometry and was written\n      // the green pixel stores transparency of transparent geometry (1.0 -\x3e fully transparent)\n      // note that we also check against green \x3d\x3d 0.0, i.e. transparent geometry that has opaque parts\n\n      // thus we render visible pixels that are occluded by semi-transparent (but not fully transparent!) geometry here\n      if (uRenderTransparentlyOccludedHUD \x3e 0.5) {\n        // multiplying by uRenderTransparentlyOccludedHUD allows us to ignore the second condition if\n        // uRenderTransparentlyOccludedHUD \x3d 0.75\n        return occlusionPixel.r * occlusionPixel.g \x3e 0.0 \x26\x26 occlusionPixel.g * uRenderTransparentlyOccludedHUD \x3c 1.0;\n      }\n\n      // and visible pixels that are not occluded by semi-transparent geometry here\n      return occlusionPixel.r * occlusionPixel.g \x3e 0.0 \x26\x26 occlusionPixel.g \x3d\x3d 1.0;\n    }\n  "]))))}
Object.defineProperty(d,"__esModule",{value:!0});d.HUD=b;(function(a){(function(a){a[a.OCCLUDED=0]="OCCLUDED";a[a.NOTOCCLUDED=1]="NOTOCCLUDED";a[a.BOTH=2]="BOTH";a[a.COUNT=3]="COUNT"})(a.TransparentRenderStyle||(a.TransparentRenderStyle={}));a.bindUniforms=function(c,b){c.setUniform1f("uRenderTransparentlyOccludedHUD",b.renderTransparentlyOccludedHUD===a.TransparentRenderStyle.OCCLUDED?1:b.renderTransparentlyOccludedHUD===a.TransparentRenderStyle.NOTOCCLUDED?0:.75)};a.bindVisibilityTexture=function(a,
c,b){c.setUniform1i("hudVisibilityTexture",1);a.bindTexture(b.hudVisibilityTexture,1);a.setActiveTexture(0)}})(b=d.HUD||(d.HUD={}));var f,h,r,c,a,m,u})},"esri/views/3d/webgl-engine/core/shaderLibrary/util/ScreenSizePerspective.glsl":function(){define(["require","exports","../../../../../../core/tsSupport/makeTemplateObjectHelper","../../shaderModules/interfaces","../../../materials/internal/MaterialUtil"],function(z,d,t,l,q){function b(b){b.vertex.code.add(l.glsl(f||(f=t(["\n    float screenSizePerspectiveMinSize(float size, vec4 factor) {\n      float nonZeroSize \x3d 1.0 - step(size, 0.0);\n\n      return (\n        factor.z * (\n          1.0 +\n          nonZeroSize *                // Multiply by nzs ensures if size is 0, then we ignore\n                                      // proportionally scaled padding\n          2.0 * factor.w / (\n            size + (1.0 - nonZeroSize) // Adding 1 - nzs ensures we divide either by size, or by 1\n          )\n        )\n      );\n    }\n  "],
["\n    float screenSizePerspectiveMinSize(float size, vec4 factor) {\n      float nonZeroSize \x3d 1.0 - step(size, 0.0);\n\n      return (\n        factor.z * (\n          1.0 +\n          nonZeroSize *                // Multiply by nzs ensures if size is 0, then we ignore\n                                      // proportionally scaled padding\n          2.0 * factor.w / (\n            size + (1.0 - nonZeroSize) // Adding 1 - nzs ensures we divide either by size, or by 1\n          )\n        )\n      );\n    }\n  "]))));
b.vertex.code.add(l.glsl(h||(h=t(["\n    float screenSizePerspectiveViewAngleDependentFactor(float absCosAngle) {\n      return absCosAngle * absCosAngle * absCosAngle;\n    }\n  "],["\n    float screenSizePerspectiveViewAngleDependentFactor(float absCosAngle) {\n      return absCosAngle * absCosAngle * absCosAngle;\n    }\n  "]))));b.vertex.code.add(l.glsl(r||(r=t(["\n    vec4 screenSizePerspectiveScaleFactor(float absCosAngle, float distanceToCamera, vec4 params) {\n      return vec4(min(params.x / (distanceToCamera - params.y), 1.0), screenSizePerspectiveViewAngleDependentFactor(absCosAngle), params.z, params.w);\n    }\n  "],
["\n    vec4 screenSizePerspectiveScaleFactor(float absCosAngle, float distanceToCamera, vec4 params) {\n      return vec4(min(params.x / (distanceToCamera - params.y), 1.0), screenSizePerspectiveViewAngleDependentFactor(absCosAngle), params.z, params.w);\n    }\n  "]))));b.vertex.code.add(l.glsl(c||(c=t(["\n    float applyScreenSizePerspectiveScaleFactorFloat(float size, vec4 factor) {\n      return max(mix(size * factor.x, size, factor.y), screenSizePerspectiveMinSize(size, factor));\n    }\n  "],
["\n    float applyScreenSizePerspectiveScaleFactorFloat(float size, vec4 factor) {\n      return max(mix(size * factor.x, size, factor.y), screenSizePerspectiveMinSize(size, factor));\n    }\n  "]))));b.vertex.code.add(l.glsl(a||(a=t(["\n    float screenSizePerspectiveScaleFloat(float size, float absCosAngle, float distanceToCamera, vec4 params) {\n      return applyScreenSizePerspectiveScaleFactorFloat(size, screenSizePerspectiveScaleFactor(absCosAngle, distanceToCamera, params));\n    }\n  "],
["\n    float screenSizePerspectiveScaleFloat(float size, float absCosAngle, float distanceToCamera, vec4 params) {\n      return applyScreenSizePerspectiveScaleFactorFloat(size, screenSizePerspectiveScaleFactor(absCosAngle, distanceToCamera, params));\n    }\n  "]))));b.vertex.code.add(l.glsl(m||(m=t(["\n    vec2 applyScreenSizePerspectiveScaleFactorVec2(vec2 size, vec4 factor) {\n      return mix(size * clamp(factor.x, screenSizePerspectiveMinSize(size.y, factor) / size.y, 1.0), size, factor.y);\n    }\n  "],
["\n    vec2 applyScreenSizePerspectiveScaleFactorVec2(vec2 size, vec4 factor) {\n      return mix(size * clamp(factor.x, screenSizePerspectiveMinSize(size.y, factor) / size.y, 1.0), size, factor.y);\n    }\n  "]))));b.vertex.code.add(l.glsl(u||(u=t(["\n    vec2 screenSizePerspectiveScaleVec2(vec2 size, float absCosAngle, float distanceToCamera, vec4 params) {\n      return applyScreenSizePerspectiveScaleFactorVec2(size, screenSizePerspectiveScaleFactor(absCosAngle, distanceToCamera, params));\n    }\n  "],
["\n    vec2 screenSizePerspectiveScaleVec2(vec2 size, float absCosAngle, float distanceToCamera, vec4 params) {\n      return applyScreenSizePerspectiveScaleFactorVec2(size, screenSizePerspectiveScaleFactor(absCosAngle, distanceToCamera, params));\n    }\n  "]))))}Object.defineProperty(d,"__esModule",{value:!0});d.ScreenSizePerspective=b;(function(a){a.bindUniforms=function(a,c){c.screenSizePerspective&&(q.bindScreenSizePerspective(c.screenSizePerspective,a,"screenSizePerspective"),q.bindScreenSizePerspective(c.screenSizePerspectiveAlignment||
c.screenSizePerspective,a))}})(b=d.ScreenSizePerspective||(d.ScreenSizePerspective={}));var f,h,r,c,a,m,u})},"esri/views/3d/webgl-engine/core/shaderLibrary/hud/HUDOcclusionPass.glsl":function(){define(["require","exports","../../../../../../core/tsSupport/makeTemplateObjectHelper","../../shaderModules/interfaces"],function(z,d,t,l){Object.defineProperty(d,"__esModule",{value:!0});d.HUDOcclusionPass=function(d){d.vertex.code.add(l.glsl(q||(q=t(["\n  void main(void) {\n    vec4 posProjCenter;\n    if (dot(position, position) \x3e 0.0) {\n      // Render single point to center of the pixel to avoid subpixel\n      // filtering to affect the marker color\n      ProjectHUDAux projectAux;\n      vec4 posProj \x3d projectPositionHUD(projectAux);\n      posProjCenter \x3d alignToPixelCenter(posProj, viewport.zw);\n\n      vec3 vpos \x3d projectAux.posModel;\n      if (rejectBySlice(vpos)) {\n        // Project out of clip space\n        posProjCenter \x3d vec4(1e038, 1e038, 1e038, 1.0);\n      }\n    }\n    else {\n      // Project out of clip space\n      posProjCenter \x3d vec4(1e038, 1e038, 1e038, 1.0);\n    }\n\n    gl_Position \x3d posProjCenter;\n    gl_PointSize \x3d 1.0;\n  }\n  "],
["\n  void main(void) {\n    vec4 posProjCenter;\n    if (dot(position, position) \x3e 0.0) {\n      // Render single point to center of the pixel to avoid subpixel\n      // filtering to affect the marker color\n      ProjectHUDAux projectAux;\n      vec4 posProj \x3d projectPositionHUD(projectAux);\n      posProjCenter \x3d alignToPixelCenter(posProj, viewport.zw);\n\n      vec3 vpos \x3d projectAux.posModel;\n      if (rejectBySlice(vpos)) {\n        // Project out of clip space\n        posProjCenter \x3d vec4(1e038, 1e038, 1e038, 1.0);\n      }\n    }\n    else {\n      // Project out of clip space\n      posProjCenter \x3d vec4(1e038, 1e038, 1e038, 1.0);\n    }\n\n    gl_Position \x3d posProjCenter;\n    gl_PointSize \x3d 1.0;\n  }\n  "]))));
d.fragment.uniforms.add("color","vec4");d.fragment.code.add(l.glsl(b||(b=t(["\n  void main() {\n    gl_FragColor \x3d color;\n  }\n  "],["\n  void main() {\n    gl_FragColor \x3d color;\n  }\n  "]))))};(function(b){b.bindUniforms=function(b){b.setUniform4f("color",1,1,1,1)}})(d.HUDOcclusion||(d.HUDOcclusion={}));var q,b})},"esri/views/3d/webgl-engine/core/shaderLibrary/util/AlphaDiscard.glsl":function(){define(["require","exports","../../../../../../core/tsSupport/makeTemplateObjectHelper","../../shaderModules/interfaces"],
function(z,d,t,l){Object.defineProperty(d,"__esModule",{value:!0});d.defaultMaskAlphaCutoff=.1;d.symbolAlphaCutoff=.001;d.DiscardOrAdjustAlpha=function(d,c){var a=d.fragment;switch(c.alphaDiscardMode){case 0:a.code.add(l.glsl(q||(q=t(["\n        void discardOrAdjustAlpha(inout vec4 color) {}\n      "],["\n        void discardOrAdjustAlpha(inout vec4 color) {}\n      "]))));break;case 1:a.code.add(l.glsl(b||(b=t(["\n        void discardOrAdjustAlpha(inout vec4 color) {\n          color.a \x3d 1.0;\n        }\n      "],
["\n        void discardOrAdjustAlpha(inout vec4 color) {\n          color.a \x3d 1.0;\n        }\n      "]))));break;case 2:a.uniforms.add("textureAlphaCutoff","float");a.code.add(l.glsl(f||(f=t(["\n        #define discardOrAdjustAlpha(color) { if (color.a \x3c textureAlphaCutoff) { discard; } else { color.a \x3d 1.0; } }\n      "],["\n        #define discardOrAdjustAlpha(color) { if (color.a \x3c textureAlphaCutoff) { discard; } else { color.a \x3d 1.0; } }\n      "]))));break;case 3:d.fragment.uniforms.add("textureAlphaCutoff",
"float"),d.fragment.code.add(l.glsl(h||(h=t(["\n        #define discardOrAdjustAlpha(color) { if (color.a \x3c textureAlphaCutoff) { discard; } }\n      "],["\n        #define discardOrAdjustAlpha(color) { if (color.a \x3c textureAlphaCutoff) { discard; } }\n      "]))))}};var q,b,f,h})},"esri/views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl":function(){define(["require","exports","../../../../../../core/tsSupport/makeTemplateObjectHelper","../../shaderModules/interfaces"],function(z,
d,t,l){Object.defineProperty(d,"__esModule",{value:!0});d.ColorConversion=function(d,c){var a=[l.glsl(q||(q=t(["\n      vec4 premultiplyAlpha(vec4 v) {\n        return vec4(v.rgb * v.a, v.a);\n      }\n    "],["\n      vec4 premultiplyAlpha(vec4 v) {\n        return vec4(v.rgb * v.a, v.a);\n      }\n    "]))),l.glsl(b||(b=t(["\n      vec3 rgb2hsv(vec3 c) {\n        vec4 K \x3d vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n        vec4 p \x3d c.g \x3c c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\n        vec4 q \x3d c.r \x3c p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n\n        float d \x3d q.x - min(q.w, q.y);\n        float e \x3d 1.0e-10;\n        return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);\n      }\n    "],
["\n      vec3 rgb2hsv(vec3 c) {\n        vec4 K \x3d vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n        vec4 p \x3d c.g \x3c c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\n        vec4 q \x3d c.r \x3c p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n\n        float d \x3d q.x - min(q.w, q.y);\n        float e \x3d 1.0e-10;\n        return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);\n      }\n    "]))),l.glsl(f||(f=t(["\n      vec3 hsv2rgb(vec3 c) {\n        vec4 K \x3d vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n        vec3 p \x3d abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n        return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n      }\n    "],
["\n      vec3 hsv2rgb(vec3 c) {\n        vec4 K \x3d vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n        vec3 p \x3d abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n        return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n      }\n    "]))),l.glsl(h||(h=t(["\n      float rgb2v(vec3 c) {\n        return max(c.x, max(c.y, c.z));\n      }\n    "],["\n      float rgb2v(vec3 c) {\n        return max(c.x, max(c.y, c.z));\n      }\n    "])))];switch(c.stages){case 0:a.forEach(function(a){return d.vertex.code.add(a)});
break;case 1:a.forEach(function(a){return d.fragment.code.add(a)});break;default:a.forEach(function(a){return d.vertex.code.add(a)}),a.forEach(function(a){return d.fragment.code.add(a)})}};var q,b,f,h})},"esri/views/3d/webgl-engine/shaders/HUDMaterialTechnique":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/tsSupport/assignHelper ../core/shaderLibrary/Slice.glsl ../core/shaderLibrary/Transform.glsl ../core/shaderLibrary/attributes/VerticalOffset.glsl ../core/shaderLibrary/hud/HUD.glsl ../core/shaderLibrary/hud/HUDOcclusionPass.glsl ../core/shaderLibrary/output/OutputHighlight.glsl ../core/shaderLibrary/shading/VisualVariables.glsl ../core/shaderLibrary/util/Camera.glsl ../core/shaderLibrary/util/ScreenSizePerspective.glsl ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../core/shaderTechnique/ShaderTechniqueConfiguration ../lib/DefaultVertexAttributeLocations ./HUDMaterial.glsl ./HUDMaterial.glsl ../../../webgl/Program ../../../webgl/renderState ../../../webgl/renderState".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u,D,w,v,E,C,J,K,G,I,x){Object.defineProperty(d,"__esModule",{value:!0});q=function(d){function l(){return null!==d&&d.apply(this,arguments)||this}t(l,d);l.prototype.initializeProgram=function(a){var c=l.shader.get(),b=this.configuration,c=c.build({output:b.output,viewingMode:a.viewingMode,occlusionTestEnabled:b.occlusionTestEnabled,signedDistanceFieldEnabled:b.sdf,slicePlaneEnabled:b.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!0,debugDrawBorder:b.debugDrawBorder,
binaryHighlightOcclusionEnabled:b.binaryHighlightOcclusion,screenCenterOffsetUnitsEnabled:b.screenCenterOffsetUnitsEnabled,screenSizePerspectiveEnabled:b.screenSizePerspective,verticalOffsetEnabled:b.verticalOffset,vvSize:b.vvSize,vvColor:b.vvColor,vvInstancingEnabled:!1});return new G(a.rctx,c.generateSource("vertex"),c.generateSource("fragment"),C.Default3D)};l.prototype.bindPass=function(b,d,f){this.program.setUniform1f("cameraGroundRelative",f.cameraAboveGround?1:-1);this.program.setUniform1f("perDistancePixelRatio",
Math.tan(f.fovY/2)/(f.viewport[2]/2));this.program.setUniformMatrix4fv("viewNormal",f.viewInvTransp);this.program.setUniform1f("polygonOffset",d.shaderPolygonOffset);h.VerticalOffset.bindUniforms(this.program,d,f);D.ScreenSizePerspective.bindUniforms(this.program,d);u.Viewport.bindUniforms(this.program,f);6===this.configuration.output?c.HUDOcclusion.bindUniforms(this.program):(r.HUD.bindUniforms(this.program,f),K.HUDMaterial.bindUniforms(this.program,d,f),m.VisualVariables.bindUniforms(this.program,
d),this.configuration.occlusionTestEnabled&&r.HUD.bindVisibilityTexture(b,this.program,f));4===this.configuration.output&&a.OutputHighlight.bindOutputHighlight(b,this.program,f)};l.prototype.bindDraw=function(a){f.Transform.bindUniforms(this.program,a);u.Camera.bindUniforms(this.program,a);b.Slice.bindUniformsWithOrigin(this.program,this.configuration,a)};l.prototype.initializePipeline=function(){return 4===this.configuration.output?x.makePipelineState({blending:I.separateBlendingParams(1,1,771,771),
polygonOffset:this.configuration.polygonOffsetEnabled&&{factor:0,units:-4},depthTest:{func:513},colorWrite:x.defaultColorWriteParams}):6===this.configuration.output?x.makePipelineState({depthTest:{func:515},depthWrite:x.defaultDepthWriteParams,colorWrite:x.defaultColorWriteParams}):x.makePipelineState({blending:I.simpleBlendingParams(1,771),polygonOffset:this.configuration.polygonOffsetEnabled&&{factor:0,units:-4},depthTest:{func:this.configuration.depthEnabled?515:519},depthWrite:this.configuration.depthEnabled?
x.defaultDepthWriteParams:void 0,colorWrite:x.defaultColorWriteParams})};Object.defineProperty(l.prototype,"primitiveType",{get:function(){return 6===this.configuration.output?0:4},enumerable:!0,configurable:!0});l.shader=new w.ReloadableShaderModule(J,"./HUDMaterial.glsl",z);return l}(v.ShaderTechnique);d.HUDMaterialTechnique=q;q=function(a){function c(){var c=null!==a&&a.apply(this,arguments)||this;c.output=0;c.occlusionTestEnabled=!0;c.sdf=!1;c.vvSize=!1;c.vvColor=!1;c.verticalOffset=!1;c.screenSizePerspective=
!1;c.screenCenterOffsetUnitsEnabled=0;c.debugDrawBorder=!0;c.binaryHighlightOcclusion=!0;c.slicePlaneEnabled=!1;c.polygonOffsetEnabled=!1;c.depthEnabled=!0;return c}t(c,a);l([E.parameter({count:7})],c.prototype,"output",void 0);l([E.parameter()],c.prototype,"occlusionTestEnabled",void 0);l([E.parameter()],c.prototype,"sdf",void 0);l([E.parameter()],c.prototype,"vvSize",void 0);l([E.parameter()],c.prototype,"vvColor",void 0);l([E.parameter()],c.prototype,"verticalOffset",void 0);l([E.parameter()],
c.prototype,"screenSizePerspective",void 0);l([E.parameter({count:2})],c.prototype,"screenCenterOffsetUnitsEnabled",void 0);l([E.parameter()],c.prototype,"debugDrawBorder",void 0);l([E.parameter()],c.prototype,"binaryHighlightOcclusion",void 0);l([E.parameter()],c.prototype,"slicePlaneEnabled",void 0);l([E.parameter()],c.prototype,"polygonOffsetEnabled",void 0);l([E.parameter()],c.prototype,"depthEnabled",void 0);return c}(E.ShaderTechniqueConfiguration);d.HUDMaterialTechniqueConfiguration=q})},"esri/views/3d/webgl-engine/core/shaderLibrary/attributes/VerticalOffset.glsl":function(){define(["require",
"exports","../../../../../../core/tsSupport/makeTemplateObjectHelper","../util/ScreenSizePerspective.glsl","../../shaderModules/interfaces"],function(z,d,t,l,q){function b(b,d){var f=b.vertex.code;d.verticalOffsetEnabled?(b.vertex.uniforms.add("verticalOffset","vec4"),d.screenSizePerspectiveEnabled&&(b.include(l.ScreenSizePerspective),b.vertex.uniforms.add("screenSizePerspectiveAlignment","vec4")),f.add(q.glsl(u||(u=t(["\n    vec3 calculateVerticalOffset(vec3 worldPos, vec3 localOrigin) {\n      float viewDistance \x3d length((view * vec4(worldPos, 1.0)).xyz);\n      ",
"\n      ","\n      // Screen sized offset in world space, used for example for line callouts\n      float worldOffset \x3d clamp(verticalOffsetScreenHeight * verticalOffset.y * viewDistance, verticalOffset.z, verticalOffset.w);\n      return worldNormal * worldOffset;\n    }\n\n    vec3 addVerticalOffset(vec3 worldPos, vec3 localOrigin) {\n      return worldPos + calculateVerticalOffset(worldPos, localOrigin);\n    }\n    "],["\n    vec3 calculateVerticalOffset(vec3 worldPos, vec3 localOrigin) {\n      float viewDistance \x3d length((view * vec4(worldPos, 1.0)).xyz);\n      ",
"\n      ","\n      // Screen sized offset in world space, used for example for line callouts\n      float worldOffset \x3d clamp(verticalOffsetScreenHeight * verticalOffset.y * viewDistance, verticalOffset.z, verticalOffset.w);\n      return worldNormal * worldOffset;\n    }\n\n    vec3 addVerticalOffset(vec3 worldPos, vec3 localOrigin) {\n      return worldPos + calculateVerticalOffset(worldPos, localOrigin);\n    }\n    "])),0===d.viewingMode?q.glsl(r||(r=t(["vec3 worldNormal \x3d normalize(worldPos + localOrigin);"],
["vec3 worldNormal \x3d normalize(worldPos + localOrigin);"]))):q.glsl(c||(c=t(["vec3 worldNormal \x3d vec3(0.0, 0.0, 1.0);"],["vec3 worldNormal \x3d vec3(0.0, 0.0, 1.0);"]))),d.screenSizePerspectiveEnabled?q.glsl(a||(a=t(["\n          float cosAngle \x3d dot(worldNormal, normalize(worldPos - camPos));\n          float verticalOffsetScreenHeight \x3d screenSizePerspectiveScaleFloat(verticalOffset.x, abs(cosAngle), viewDistance, screenSizePerspectiveAlignment);"],["\n          float cosAngle \x3d dot(worldNormal, normalize(worldPos - camPos));\n          float verticalOffsetScreenHeight \x3d screenSizePerspectiveScaleFloat(verticalOffset.x, abs(cosAngle), viewDistance, screenSizePerspectiveAlignment);"]))):
q.glsl(m||(m=t(["\n          float verticalOffsetScreenHeight \x3d verticalOffset.x;"],["\n          float verticalOffsetScreenHeight \x3d verticalOffset.x;"])))))):f.add(q.glsl(D||(D=t(["\n    vec3 addVerticalOffset(vec3 worldPos, vec3 localOrigin) { return worldPos; }\n    "],["\n    vec3 addVerticalOffset(vec3 worldPos, vec3 localOrigin) { return worldPos; }\n    "]))))}function f(a,c,b,d){void 0===d&&(d=h);d.screenLength=a.screenLength;d.perDistance=Math.tan(.5*c)/(.5*b);d.minWorldLength=a.minWorldLength;
d.maxWorldLength=a.maxWorldLength;return d}Object.defineProperty(d,"__esModule",{value:!0});d.VerticalOffset=b;(function(a){a.bindUniforms=function(a,c,b){c.verticalOffset&&(c=f(c.verticalOffset,b.fovY,b.viewport[3]),a.setUniform4f("verticalOffset",c.screenLength*(b.pixelRatio||1),c.perDistance,c.minWorldLength,c.maxWorldLength))}})(b=d.VerticalOffset||(d.VerticalOffset={}));d.calculateVerticalOffsetFactors=f;var h={screenLength:0,perDistance:0,minWorldLength:0,maxWorldLength:0},r,c,a,m,u,D})},"esri/views/3d/layers/graphics/objectResourceUtils":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/tsSupport/assignHelper ../../../../core/devEnvironmentUtils ../../../../core/maybe ../../../../core/libs/gl-matrix-2/mat3 ../../../../core/libs/gl-matrix-2/mat3f64 ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../geometry/support/aaBoundingBox ../../glTF/DefaultLoadingContext ../../glTF/loader ../../glTF/internal/indexUtils ./wosrLoader ../../support/buffer/BufferView ../../support/buffer/math ../../support/buffer/utils ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryData ../../webgl-engine/lib/Texture ../../webgl-engine/materials/DefaultMaterial".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u,D,w,v,E,C,J,K,G,I,x,N,O,P){function S(a){var c=a.match(/(.*\.(gltf|glb))(\?lod=([0-9]+))?$/);return c?{fileType:"gltf",url:c[1],specifiedLodIndex:null!=c[4]?Number(c[4]):null}:a.match(/(.*\.(json|json\.gz))$/)?{fileType:"wosr",url:a,specifiedLodIndex:null}:{fileType:"unknown",url:a,specifiedLodIndex:null}}function R(a,d,f,l){var m=a.model,q=c.mat3f64.create(),p=[],t=new Map,A=new Map;m.lods.forEach(function(a,e){if(void 0===l||e===l){var g=0,n={name:a.name,stageResources:{textures:[],
materials:[],geometries:[]},lodThreshold:h.isSome(a.lodThreshold)?a.lodThreshold:null,pivotOffset:[0,0,0],numberOfVertices:0,boundingBox:w.empty()};p.push(n);a.parts.forEach(function(e){var k=e.material+(e.attributes.normal?"_normal":"")+(e.attributes.color?"_color":"")+(e.attributes.texCoord0?"_texCoord0":"")+(e.attributes.tangent?"_tangent":""),c=m.materials.get(e.material),y=h.isSome(e.attributes.texCoord0),p=h.isSome(e.attributes.normal);if(!t.has(k)){if(y){if(h.isSome(c.textureColor)&&!A.has(c.textureColor)){var l=
m.textures.get(c.textureColor),Z=b({},l.parameters,{preMultiplyAlpha:!0});A.set(c.textureColor,new O(l.data,c.textureColor,Z))}h.isSome(c.textureNormal)&&!A.has(c.textureNormal)&&(l=m.textures.get(c.textureNormal),Z=b({},l.parameters,{preMultiplyAlpha:!0}),A.set(c.textureNormal,new O(l.data,c.textureNormal,Z)));h.isSome(c.textureOcclusion)&&!A.has(c.textureOcclusion)&&(l=m.textures.get(c.textureOcclusion),Z=b({},l.parameters,{preMultiplyAlpha:!0}),A.set(c.textureOcclusion,new O(l.data,c.textureOcclusion,
Z)));h.isSome(c.textureEmissive)&&!A.has(c.textureEmissive)&&(l=m.textures.get(c.textureEmissive),Z=b({},l.parameters,{preMultiplyAlpha:!0}),A.set(c.textureEmissive,new O(l.data,c.textureEmissive,Z)));h.isSome(c.textureMetallicRoughness)&&!A.has(c.textureMetallicRoughness)&&(l=m.textures.get(c.textureMetallicRoughness),Z=b({},l.parameters,{preMultiplyAlpha:!0}),A.set(c.textureMetallicRoughness,new O(l.data,c.textureMetallicRoughness,Z)))}var ca=P.COLOR_GAMMA,l=Math.pow(c.color[0],1/ca),Z=Math.pow(c.color[1],
1/ca),v=Math.pow(c.color[2],1/ca),u=Math.pow(c.emissiveFactor[0],1/ca),L=Math.pow(c.emissiveFactor[1],1/ca),ca=Math.pow(c.emissiveFactor[2],1/ca);t.set(k,new P(b({},d,{transparent:"BLEND"===c.alphaMode,textureAlphaMode:Q(c.alphaMode),textureAlphaCutoff:c.alphaCutoff,diffuse:[l,Z,v],ambient:[l,Z,v],opacity:c.opacity,doubleSided:c.doubleSided,doubleSidedType:"winding-order",cullFace:c.doubleSided?0:2,vertexColors:!!e.attributes.color,vertexTangents:!!e.attributes.tangent,normals:p?"default":"screenDerivative",
castShadows:!0,receiveSSAO:!0,textureId:h.isSome(c.textureColor)&&y?A.get(c.textureColor).id:void 0,colorMixMode:c.colorMixMode,normalTextureId:h.isSome(c.textureNormal)&&y?A.get(c.textureNormal).id:void 0,textureAlphaPremultiplied:!0,occlusionTextureId:h.isSome(c.textureOcclusion)&&y?A.get(c.textureOcclusion).id:void 0,emissiveTextureId:h.isSome(c.textureEmissive)&&y?A.get(c.textureEmissive).id:void 0,metallicRoughnessTextureId:h.isSome(c.textureMetallicRoughness)&&y?A.get(c.textureMetallicRoughness).id:
void 0,emissiveFactor:[u,L,ca],mrrFactors:[c.metallicFactor,c.roughnessFactor,d.mrrFactors[2]],isSchematic:!1},f),k))}a:{p=e.indices||e.attributes.position.count;switch(e.primitiveType){case 4:l=C.trianglesToTriangles(p);break a;case 5:l=C.triangleStripToTriangles(p);break a;case 6:l=C.triangleFanToTriangles(p);break a}l=void 0}Z={};v={};p=e.attributes.position.count;u=I.createBuffer(K.BufferViewVec3f,p);G.vec3.transformMat4(u,e.attributes.position,e.transform);v.position={data:u.typedBuffer,size:u.elementCount};
Z.position=l;h.isSome(e.attributes.normal)&&(u=I.createBuffer(K.BufferViewVec3f,p),r.mat3.normalFromMat4(q,e.transform),G.vec3.transformMat3(u,e.attributes.normal,q),v.normal={data:u.typedBuffer,size:u.elementCount},Z.normal=l);h.isSome(e.attributes.tangent)&&(u=I.createBuffer(K.BufferViewVec4f,p),r.mat3.normalFromMat4(q,e.transform),G.vec4.transformMat3(u,e.attributes.tangent,q),v.tangent={data:u.typedBuffer,size:u.elementCount},Z.tangent=l);h.isSome(e.attributes.texCoord0)&&(u=I.createBuffer(K.BufferViewVec2f,
p),I.vec2.normalizeIntegerBuffer(u,e.attributes.texCoord0),v.uv0={data:u.typedBuffer,size:u.elementCount},Z.uv0=l);h.isSome(e.attributes.color)&&(u=I.createBuffer(K.BufferViewVec4u8,p),4===e.attributes.color.elementCount?e.attributes.color instanceof K.BufferViewVec4f?G.vec4.scale(u,e.attributes.color,255):e.attributes.color instanceof K.BufferViewVec4u8?I.vec4.copy(u,e.attributes.color):e.attributes.color instanceof K.BufferViewVec4u16&&G.vec4.scale(u,e.attributes.color,1/256):(I.vec4.fill(u,255,
255,255,255),L=new K.BufferViewVec3u8(u.buffer,0,4),e.attributes.color instanceof K.BufferViewVec3f?G.vec3.scale(L,e.attributes.color,255):e.attributes.color instanceof K.BufferViewVec3u8?I.vec3.copy(L,e.attributes.color):e.attributes.color instanceof K.BufferViewVec3u16&&G.vec3.scale(L,e.attributes.color,1/256)),v.color={data:u.typedBuffer,size:u.elementCount},Z.color=l);e=new x(new N.GeometryData(v,Z),"gltf_"+a.name+"_"+g++);n.stageResources.geometries.push(e);n.stageResources.materials.push(t.get(k));
y&&(h.isSome(c.textureColor)&&n.stageResources.textures.push(A.get(c.textureColor)),h.isSome(c.textureNormal)&&n.stageResources.textures.push(A.get(c.textureNormal)),h.isSome(c.textureOcclusion)&&n.stageResources.textures.push(A.get(c.textureOcclusion)),h.isSome(c.textureEmissive)&&n.stageResources.textures.push(A.get(c.textureEmissive)),h.isSome(c.textureMetallicRoughness)&&n.stageResources.textures.push(A.get(c.textureMetallicRoughness)));n.numberOfVertices+=p;k=e.boundingInfo;w.expand(n.boundingBox,
k.getBBMin());w.expand(n.boundingBox,k.getBBMax())})}});return p}function Q(a){switch(a){case "BLEND":return"blend";case "MASK":return"mask";case "OPAQUE":return"opaque";default:return"blend"}}Object.defineProperty(d,"__esModule",{value:!0});d.fetch=function(c,d){return q(this,void 0,void 0,function(){var q,r,t,w,p,L,A,k,e,g,n,y;return l(this,function(B){switch(B.label){case 0:return q=S(f.adjustStaticAGOUrl(c)),"wosr"!==q.fileType?[3,2]:[4,d.cache?d.cache.loadWOSR(q.url,d):J.load(q.url,d)];case 1:return r=
B.sent(),t=J.processLoadResult(r,d),[2,{lods:[t],referenceBoundingBox:t.boundingBox,isEsriSymbolResource:!1,isWosr:!0,remove:r.remove}];case 2:return[4,d.cache?d.cache.loadGLTF(q.url,d):E.load(new v.DefaultLoadingContext(d.streamDataRequester),q.url,d)];case 3:w=B.sent();p=h.get(w.model.meta,"ESRI_proxyEllipsoid");if(w.meta.isEsriSymbolResource&&h.isSome(p)&&-1!==w.meta.uri.indexOf("/RealisticTrees/"))a:{B=w;for(var F=p,H=0;H<B.model.lods.length;++H){var M=B.model.lods[H];B.customMeta.esriTreeRendering=
!0;for(var l=0,M=M.parts;l<M.length;l++){var Z=M[l],ca=Z.attributes.normal;if(h.isNone(ca))break a;for(var da=Z.attributes.position,ba=da.count,x=D.vec3f64.create(),ea=D.vec3f64.create(),C=D.vec3f64.create(),z=I.createBuffer(K.BufferViewVec4u8,ba),ga=I.createBuffer(K.BufferViewVec3f,ba),G=a.mat4.invert(m.mat4f64.create(),Z.transform),P=0;P<ba;P++){da.getVec(P,ea);ca.getVec(P,x);u.vec3.transformMat4(ea,ea,Z.transform);u.vec3.subtract(C,ea,F.center);u.vec3.divide(C,C,F.radius);var Q=C[2],O=u.vec3.length(C),
O=Math.min(.45+.55*O*O,1);u.vec3.divide(C,C,F.radius);u.vec3.transformMat4(C,C,G);u.vec3.normalize(C,C);H+1!==B.model.lods.length&&1<B.model.lods.length&&(-1<Q?u.vec3.lerp(C,C,x,.2):u.vec3.lerp(C,C,x,Math.min(-4*Q-3.8,1)));ga.setVec(P,C);z.set(P,0,255*O);z.set(P,1,255*O);z.set(P,2,255*O);z.set(P,3,255)}Z.attributes.normal=ga;Z.attributes.color=z}}}L=w.meta.isEsriSymbolResource?{usePBR:d.usePBR,isSchematic:!1,treeRendering:w.customMeta.esriTreeRendering,mrrFactors:[0,1,.2]}:{usePBR:!0,isSchematic:!1,
mrrFactors:[0,1,.5]};A=b({},d.materialParamsMixin,{treeRendering:w.customMeta.esriTreeRendering});if(null!=q.specifiedLodIndex)return k=R(w,L,A,q.specifiedLodIndex),e=k[0].boundingBox,0!==q.specifiedLodIndex&&(g=R(w,L,A,0),e=g[0].boundingBox),[2,{lods:k,referenceBoundingBox:e,isEsriSymbolResource:w.meta.isEsriSymbolResource,isWosr:!1,remove:w.remove}];n=R(w,L,A);y=n[0].boundingBox;return[2,{lods:n,referenceBoundingBox:y,isEsriSymbolResource:w.meta.isEsriSymbolResource,isWosr:!1,remove:w.remove}]}})})};
d.parseUrl=S;d.gltfToEngineResources=R})},"esri/views/3d/glTF/DefaultLoadingContext":function(){define("require exports ../../../core/tsSupport/awaiterHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/assignHelper ../../../request ../../../core/asyncUtils ../../../core/Error ../../../core/maybe ../../../core/promiseUtils ../../../core/urlUtils".split(" "),function(z,d,t,l,q,b,f,h,r,c,a){Object.defineProperty(d,"__esModule",{value:!0});z=function(){function d(a){this.streamDataRequester=
a}d.prototype.loadJSON=function(a,c){return t(this,void 0,void 0,function(){return l(this,function(b){return[2,this.load("json",a,c)]})})};d.prototype.loadBinary=function(b,d){return t(this,void 0,void 0,function(){return l(this,function(f){return a.isDataProtocol(b)?(c.throwIfAborted(d),[2,a.dataToArrayBuffer(b)]):[2,this.load("binary",b,d)]})})};d.prototype.loadImage=function(a,c){return t(this,void 0,void 0,function(){return l(this,function(b){return[2,this.load("image",a,c)]})})};d.prototype.load=
function(a,d,q){return t(this,void 0,void 0,function(){var t;return l(this,function(l){switch(l.label){case 0:return r.isNone(this.streamDataRequester)?[4,b(d,{responseType:m[a]})]:[3,2];case 1:return[2,l.sent().data];case 2:return[4,f.result(this.streamDataRequester.request(d,a,q))];case 3:t=l.sent();if(!0===t.ok)return[2,t.value];c.throwIfAbortError(t.error);throw new h("","Request for resource failed: "+t.error);}})})};return d}();d.DefaultLoadingContext=z;var m={image:"image",binary:"array-buffer",
json:"json"}})},"esri/views/3d/glTF/loader":function(){define("require exports ../../../core/tsSupport/awaiterHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/assignHelper ../../../core/maybe ../../../core/promiseUtils ../../../core/libs/gl-matrix-2/mat4f64 ./DefaultErrorContext ./LoaderResult ./internal/Resource".split(" "),function(z,d,t,l,q,b,f,h,r,c,a){function m(a){var c=null;a.json.nodes.forEach(function(a){a=a.extras;b.isSome(a)&&(a.ESRI_proxyEllipsoid||a.ESRI_lod)&&(c=
a)});return c}function u(a,c){return t(this,void 0,void 0,function(){function b(f,h){return t(this,void 0,void 0,function(){var m,p,q,A,k,e,g,n,y;return l(this,function(B){switch(B.label){case 0:m=d.nodes[f];p=a.getNodeTransform(f);E.warnUnsupportedIf(null!=m.weights,"Morph targets are not supported.");if(null==m.mesh)return[3,4];q=d.meshes[m.mesh];A=0;k=q.primitives;B.label=1;case 1:if(!(A<k.length))return[3,4];e=k[A];return[4,c(e,p,h,q.name)];case 2:B.sent(),B.label=3;case 3:return A++,[3,1];case 4:g=
0,n=m.children||[],B.label=5;case 5:if(!(g<n.length))return[3,8];y=n[g];return[4,b(y,h)];case 6:B.sent(),B.label=7;case 7:return g++,[3,5];case 8:return[2]}})})}var d,h,m,q,r,v,u,w,C,D;return l(this,function(c){switch(c.label){case 0:d=a.json,h=d.scenes[d.scene||0],m=h.nodes,q=1<m.length,r=0,v=m,c.label=1;case 1:if(!(r<v.length))return[3,4];u=v[r];w=d.nodes[u];C=[b(u,0)];w.extensions&&w.extensions.MSFT_lod&&Array.isArray(w.extensions.MSFT_lod.ids)&&!q&&(D=w.extensions.MSFT_lod.ids,C.push.apply(C,
D.map(function(a,c){return b(a,c+1)})));return[4,f.all(C)];case 2:c.sent(),c.label=3;case 3:return r++,[3,1];case 4:return[2]}})})}function D(a,b,d){var f=function(b){var f=d+"_tex_"+(b&&b.id)+(b&&b.name?"_"+b.name:"");if(b&&!a.textures.has(f)){var h=c.makeTextureSource(b.data,{wrap:{s:w(b.wrapS),t:w(b.wrapT)},mipmap:C.some(function(a){return a===b.minFilter}),noUnpackFlip:!0});a.textures.set(f,h)}return f},h=d+"_mat_"+b.id+"_"+b.name;a.materials.has(h)||(b=c.makeMaterialParameters({color:[b.color[0],
b.color[1],b.color[2]],opacity:b.color[3],alphaMode:b.alphaMode,alphaCutoff:b.alphaCutoff,doubleSided:b.doubleSided,colorMixMode:b.ESRI_externalColorMixMode,textureColor:b.colorTexture?f(b.colorTexture):void 0,textureNormal:b.normalTexture?f(b.normalTexture):void 0,textureOcclusion:b.occlusionTexture?f(b.occlusionTexture):void 0,textureEmissive:b.emissiveTexture?f(b.emissiveTexture):void 0,textureMetallicRoughness:b.metallicRoughnessTexture?f(b.metallicRoughnessTexture):void 0,emissiveFactor:[b.emissiveFactor[0],
b.emissiveFactor[1],b.emissiveFactor[2]],metallicFactor:b.metallicFactor,roughnessFactor:b.roughnessFactor}),a.materials.set(h,b));return h}function w(a){if(33071===a||33648===a||10497===a)return a;E.error("Unexpected TextureSampler WrapMode: "+a)}Object.defineProperty(d,"__esModule",{value:!0});var v=0;d.load=function(c,d,f){void 0===f&&(f={});return t(this,void 0,void 0,function(){var q,r,w,C,z=this;return l(this,function(x){switch(x.label){case 0:return[4,a.Resource.load(c,E,d,f)];case 1:return q=
x.sent(),r="gltf_"+v++,w={lods:[],materials:new Map,textures:new Map,meta:m(q)},C=!(!q.json.asset.extras||"symbolResource"!==q.json.asset.extras.ESRI_type),[4,u(q,function(a,c,d,m){return t(z,void 0,void 0,function(){var t,v,u,p,L,A,k,e,g,n,y;return l(this,function(B){switch(B.label){case 0:t=void 0!==a.mode?a.mode:4;a:switch(t){case 4:case 5:case 6:v=t;break a;default:v=null}return b.isNone(v)?(E.warnUnsupported("Unsupported primitive mode ("+J[t]+"). Skipping primitive."),[2]):q.hasPositions(a)?
[4,q.getMaterial(a,f)]:(E.warn("Skipping primitive without POSITION vertex attribute."),[2]);case 1:return u=B.sent(),L={transform:h.mat4f64.clone(c)},A={},[4,q.getPositionData(a,f)];case 2:return L.attributes=(A.position=B.sent(),A.normal=null,A.texCoord0=null,A.color=null,A.tangent=null,A),[4,q.getIndexData(a,f)];case 3:p=(L.indices=B.sent(),L.primitiveType=v,L.material=D(w,u,r),L);if(!q.hasNormals(a))return[3,5];k=p.attributes;return[4,q.getNormalData(a,f)];case 4:k.normal=B.sent(),B.label=5;case 5:if(!q.hasTangents(a))return[3,
7];e=p.attributes;return[4,q.getTangentData(a,f)];case 6:e.tangent=B.sent(),B.label=7;case 7:if(!q.hasTextureCoordinates(a))return[3,9];g=p.attributes;return[4,q.getTextureCoordinates(a,f)];case 8:g.texCoord0=B.sent(),B.label=9;case 9:if(!q.hasVertexColors(a))return[3,11];n=p.attributes;return[4,q.getVertexColors(a,f)];case 10:n.color=B.sent(),B.label=11;case 11:return y=null,b.isSome(w.meta)&&b.isSome(w.meta.ESRI_lod)&&"screenSpaceRadius"===w.meta.ESRI_lod.metric&&(y=w.meta.ESRI_lod.thresholds[d]),
w.lods[d]=w.lods[d]||{parts:[],name:m,lodThreshold:y},w.lods[d].parts.push(p),[2]}})})})];case 2:return x.sent(),[2,{model:w,meta:{isEsriSymbolResource:C,uri:q.uri},customMeta:{}}]}})})};var E=new r.DefaultErrorContext,C=[9987,9985],J="POINTS LINES LINE_LOOP LINE_STRIP TRIANGLES TRIANGLE_STRIP TRIANGLE_FAN".split(" ")})},"esri/views/3d/glTF/DefaultErrorContext":function(){define(["require","exports","../../../core/Error","../../../core/Logger"],function(z,d,t,l){Object.defineProperty(d,"__esModule",
{value:!0});var q=l.getLogger("esri.views.3d.glTF");z=function(){function b(){}b.prototype.error=function(b){throw new t("gltf-loader-error",b);};b.prototype.errorUnsupported=function(b){throw new t("gltf-loader-unsupported-feature",b);};b.prototype.errorUnsupportedIf=function(b,d){b&&this.errorUnsupported(d)};b.prototype.assert=function(b,d){b||this.error(d)};b.prototype.warn=function(b){q.warn(b)};b.prototype.warnUnsupported=function(b){this.warn("[Unsupported Feature] "+b)};b.prototype.warnUnsupportedIf=
function(b,d){b&&this.warnUnsupported(d)};return b}();d.DefaultErrorContext=z})},"esri/views/3d/glTF/LoaderResult":function(){define(["require","exports","../../../core/tsSupport/assignHelper"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});d.makeMaterialParameters=function(d){void 0===d&&(d={});return t({color:[1,1,1],opacity:1,alphaMode:"OPAQUE",alphaCutoff:.5,doubleSided:!1,castShadows:!0,receiveShadows:!0,receiveAmbientOcclustion:!0,textureColor:null,textureNormal:null,textureOcclusion:null,
textureEmissive:null,textureMetallicRoughness:null,emissiveFactor:[0,0,0],metallicFactor:1,roughnessFactor:1,colorMixMode:"multiply"},d)};d.makeTextureSource=function(d,q){void 0===q&&(q={});return{data:d,parameters:t({wrap:t({s:10497,t:10497},q.wrap),noUnpackFlip:!0,mipmap:!1},q)}}})},"esri/views/3d/glTF/internal/Resource":function(){define("require exports ../../../../core/tsSupport/awaiterHelper ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/assignHelper ../../../../core/compilerUtils ../../../../core/promiseUtils ../../../../core/string ../../../../core/urlUtils ../../../../core/urlUtils ../../../../core/Version ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/quat ../../../../core/libs/gl-matrix-2/quatf64 ./BinaryStreamReader ./fillDefaults ./pathUtils ../../support/buffer/BufferView ../../support/buffer/utils".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u,D,w,v,E,C,J,K){function G(a){switch(a.componentType){case 5120:return new J.BufferViewVec2i8(a.raw,a.byteOffset,a.byteStride,a.byteOffset+a.byteStride*a.entryCount);case 5121:return new J.BufferViewVec2u8(a.raw,a.byteOffset,a.byteStride,a.byteOffset+a.byteStride*a.entryCount);case 5122:return new J.BufferViewVec2i16(a.raw,a.byteOffset,a.byteStride,a.byteOffset+a.byteStride*a.entryCount);case 5123:return new J.BufferViewVec2u16(a.raw,a.byteOffset,a.byteStride,a.byteOffset+
a.byteStride*a.entryCount);case 5125:return new J.BufferViewVec2u32(a.raw,a.byteOffset,a.byteStride,a.byteOffset+a.byteStride*a.entryCount);case 5126:return new J.BufferViewVec2f(a.raw,a.byteOffset,a.byteStride,a.byteOffset+a.byteStride*a.entryCount);default:b.neverReached(a.componentType)}}function I(a){return t(this,void 0,void 0,function(){return l(this,function(c){return[2,f.create(function(c,b){var d=new Blob([a]),p=new FileReader;p.onload=function(){c(JSON.parse(p.result))};p.onerror=function(a){b(a)};
p.readAsText(d)})]})})}function x(a,c){return t(this,void 0,void 0,function(){return l(this,function(b){return[2,f.create(function(b,d){var p=new Blob([a],{type:c}),f=URL.createObjectURL(p),h=new Image;h.addEventListener("load",function(){URL.revokeObjectURL(f);"decode"in h?h.decode().then(function(){return b(h)},function(){return b(h)}):b(h)});h.addEventListener("error",function(a){URL.revokeObjectURL(f);d(a)});h.src=f})]})})}Object.defineProperty(d,"__esModule",{value:!0});var N;z=function(){function b(a,
c,b,d,p){this.context=a;this.errorContext=c;this.uri=b;this.json=d;this.glbBuffer=p;this.bufferCache=new Map;this.textureCache=new Map;this.materialCache=new Map;this.nodeParentMap=new Map;this.nodeTransformCache=new Map;this.baseUri=C.splitURI(this.uri).dirPart;this.checkVersionSupported();this.checkRequiredExtensionsSupported();c.errorUnsupportedIf(null==d.scenes,"Scenes must be defined.");c.errorUnsupportedIf(null==d.meshes,"Meshes must be defined");c.errorUnsupportedIf(null==d.nodes,"Nodes must be defined.");
this.computeNodeParents()}b.load=function(a,d,f,m){return t(this,void 0,void 0,function(){var p,q,A,k,e,g;return l(this,function(n){switch(n.label){case 0:if(c.isDataProtocol(f)){p=c.dataComponents(f);if("model/gltf-binary"!==p.mediaType)try{return q=JSON.parse(p.isBase64?atob(p.data):p.data),[2,new b(a,d,f,q)]}catch(y){}A=c.dataToArrayBuffer(f);if(b.isGLBData(A))return[2,this.fromGLBData(a,d,f,A)]}return h.endsWith(f,".gltf")?[4,a.loadJSON(f,m)]:[3,2];case 1:return k=n.sent(),[2,new b(a,d,f,k)];
case 2:return[4,a.loadBinary(f,m)];case 3:return e=n.sent(),b.isGLBData(e)?[2,this.fromGLBData(a,d,f,e)]:[4,a.loadJSON(f,m)];case 4:return g=n.sent(),[2,new b(a,d,f,g)]}})})};b.isGLBData=function(a){a=new v.BinaryStreamReader(a);return 4<=a.remainingBytes()&&1179937895===a.readUint32()};b.fromGLBData=function(a,c,d,f){return t(this,void 0,void 0,function(){var p;return l(this,function(h){switch(h.label){case 0:return[4,b.parseGLBData(c,f)];case 1:return p=h.sent(),[2,new b(a,c,d,p.json,p.binaryData)]}})})};
b.parseGLBData=function(a,c){return t(this,void 0,void 0,function(){var b,d,p,f,h,k,e,g,n;return l(this,function(y){switch(y.label){case 0:b=new v.BinaryStreamReader(c),a.assert(12<=b.remainingBytes(),"GLB binary data is insufficiently large."),d=b.readUint32(),p=b.readUint32(),f=b.readUint32(),a.assert(1179937895===d,"Magic first 4 bytes do not fit to expected GLB value."),a.assert(c.byteLength>=f,"GLB binary data is smaller than header specifies."),a.errorUnsupportedIf(2!==p,"An unsupported GLB container version was detected. Only version 2 is supported."),
h=0,y.label=1;case 1:if(!(8<=b.remainingBytes()))return[3,5];g=b.readUint32();n=b.readUint32();if(0!==h)return[3,3];a.assert(1313821514===n,"First GLB chunk must be JSON.");a.assert(0<=g,"No JSON data found.");return[4,I(b.readUint8Array(g))];case 2:return k=y.sent(),[3,4];case 3:1===h?(a.errorUnsupportedIf(5130562!==n,"Second GLB chunk expected to be BIN."),e=b.readUint8Array(g)):a.warnUnsupported("More than 2 GLB chunks detected. Skipping."),y.label=4;case 4:return h+=1,[3,1];case 5:return k||a.error("No GLB JSON chunk detected."),
[2,{json:k,binaryData:e}]}})})};b.prototype.getBuffer=function(a,c){return t(this,void 0,void 0,function(){var b,d,p,f;return l(this,function(h){switch(h.label){case 0:return b=this.json.buffers[a],d=this.errorContext,null==b.uri?(d.assert(null!=this.glbBuffer,"GLB buffer not present"),[2,this.glbBuffer]):(p=this.bufferCache.get(a))?[3,2]:[4,this.context.loadBinary(this.resolveUri(b.uri),c)];case 1:f=h.sent(),p=new Uint8Array(f),this.bufferCache.set(a,p),d.assert(p.byteLength===b.byteLength,"Buffer byte lengths should match."),
h.label=2;case 2:return[2,p]}})})};b.prototype.getAccessor=function(a,c){return t(this,void 0,void 0,function(){var b,d,p,f,h,k,e,g;return l(this,function(n){switch(n.label){case 0:return b=this.json.accessors[a],d=this.errorContext,d.errorUnsupportedIf(null==b.bufferView,"Some accessor does not specify a bufferView."),d.errorUnsupportedIf(b.type in["MAT2","MAT3","MAT4"],"AttributeType "+b.type+" is not supported"),p=this.json.bufferViews[b.bufferView],[4,this.getBuffer(p.buffer,c)];case 1:return f=
n.sent(),h=R[b.type],k=Q[b.componentType],e=h*k,g=p.byteStride||e,[2,{raw:f.buffer,byteStride:g,byteOffset:f.byteOffset+(p.byteOffset||0)+(b.byteOffset||0),entryCount:b.count,isDenselyPacked:g===e,componentCount:h,componentByteSize:k,componentType:b.componentType,min:b.min,max:b.max,normalized:!!b.normalized}]}})})};b.prototype.getIndexData=function(a,c){return t(this,void 0,void 0,function(){var b;return l(this,function(d){switch(d.label){case 0:return null==a.indices?[2,null]:[4,this.getAccessor(a.indices,
c)];case 1:b=d.sent();if(b.isDenselyPacked)switch(b.componentType){case 5121:return[2,new Uint8Array(b.raw,b.byteOffset,b.entryCount)];case 5123:return[2,new Uint16Array(b.raw,b.byteOffset,b.entryCount)];case 5125:return[2,new Uint32Array(b.raw,b.byteOffset,b.entryCount)]}else switch(b.componentType){case 5121:return[2,K.scalar.makeDense(this.wrapAccessor(J.BufferViewUint8,b))];case 5123:return[2,K.scalar.makeDense(this.wrapAccessor(J.BufferViewUint16,b))];case 5125:return[2,K.scalar.makeDense(this.wrapAccessor(J.BufferViewUint32,
b))]}return[2,void 0]}})})};b.prototype.getPositionData=function(a,b){return t(this,void 0,void 0,function(){var c,d;return l(this,function(p){switch(p.label){case 0:return c=this.errorContext,c.errorUnsupportedIf(null==a.attributes.POSITION,"No POSITION vertex data found."),[4,this.getAccessor(a.attributes.POSITION,b)];case 1:return d=p.sent(),c.errorUnsupportedIf(5126!==d.componentType,"Expected type FLOAT for POSITION vertex attribute, but found "+U[d.componentType]),c.errorUnsupportedIf(3!==d.componentCount,
"POSITION vertex attribute must have 3 components, but found "+d.componentCount.toFixed()),[2,this.wrapAccessor(J.BufferViewVec3f,d)]}})})};b.prototype.getNormalData=function(a,b){return t(this,void 0,void 0,function(){var c,d;return l(this,function(p){switch(p.label){case 0:return c=this.errorContext,c.assert(null!=a.attributes.NORMAL,"No NORMAL vertex data found."),[4,this.getAccessor(a.attributes.NORMAL,b)];case 1:return d=p.sent(),c.errorUnsupportedIf(5126!==d.componentType,"Expected type FLOAT for NORMAL vertex attribute, but found "+
U[d.componentType]),c.errorUnsupportedIf(3!==d.componentCount,"NORMAL vertex attribute must have 3 components, but found "+d.componentCount.toFixed()),[2,this.wrapAccessor(J.BufferViewVec3f,d)]}})})};b.prototype.getTangentData=function(a,b){return t(this,void 0,void 0,function(){var c,d;return l(this,function(p){switch(p.label){case 0:return c=this.errorContext,c.assert(null!=a.attributes.TANGENT,"No TANGENT vertex data found."),[4,this.getAccessor(a.attributes.TANGENT,b)];case 1:return d=p.sent(),
c.errorUnsupportedIf(5126!==d.componentType,"Expected type FLOAT for TANGENT vertex attribute, but found "+U[d.componentType]),c.errorUnsupportedIf(4!==d.componentCount,"TANGENT vertex attribute must have 4 components, but found "+d.componentCount.toFixed()),[2,new J.BufferViewVec4f(d.raw,d.byteOffset,d.byteStride,d.byteOffset+d.byteStride*d.entryCount)]}})})};b.prototype.getTextureCoordinates=function(a,b){return t(this,void 0,void 0,function(){var c,d;return l(this,function(p){switch(p.label){case 0:return c=
this.errorContext,c.assert(null!=a.attributes.TEXCOORD_0,"No TEXCOORD_0 vertex data found."),[4,this.getAccessor(a.attributes.TEXCOORD_0,b)];case 1:d=p.sent();c.errorUnsupportedIf(2!==d.componentCount,"TEXCOORD_0 vertex attribute must have 2 components, but found "+d.componentCount.toFixed());if(5126===d.componentType)return[2,this.wrapAccessor(J.BufferViewVec2f,d)];c.errorUnsupportedIf(!d.normalized,"Integer component types are only supported for a normalized accessor for TEXCOORD_0.");return[2,
G(d)]}})})};b.prototype.getVertexColors=function(a,c){return t(this,void 0,void 0,function(){var b,d;return l(this,function(p){switch(p.label){case 0:return b=this.errorContext,b.assert(null!=a.attributes.COLOR_0,"No COLOR_0 vertex data found."),[4,this.getAccessor(a.attributes.COLOR_0,c)];case 1:d=p.sent();b.errorUnsupportedIf(4!==d.componentCount&&3!==d.componentCount,"COLOR_0 attribute must have 3 or 4 components, but found "+d.componentCount.toFixed());if(4===d.componentCount){if(5126===d.componentType)return[2,
this.wrapAccessor(J.BufferViewVec4f,d)];if(5121===d.componentType)return[2,this.wrapAccessor(J.BufferViewVec4u8,d)];if(5123===d.componentType)return[2,this.wrapAccessor(J.BufferViewVec4u16,d)]}else if(3===d.componentCount){if(5126===d.componentType)return[2,this.wrapAccessor(J.BufferViewVec3f,d)];if(5121===d.componentType)return[2,this.wrapAccessor(J.BufferViewVec3u8,d)];if(5123===d.componentType)return[2,this.wrapAccessor(J.BufferViewVec3u16,d)]}b.errorUnsupported("Unsupported component type for COLOR_0 attribute: "+
U[d.componentType]);return[2,void 0]}})})};b.prototype.hasPositions=function(a){return void 0!==a.attributes.POSITION};b.prototype.hasNormals=function(a){return void 0!==a.attributes.NORMAL};b.prototype.hasVertexColors=function(a){return void 0!==a.attributes.COLOR_0};b.prototype.hasTextureCoordinates=function(a){return void 0!==a.attributes.TEXCOORD_0};b.prototype.hasTangents=function(a){return void 0!==a.attributes.TANGENT};b.prototype.getMaterial=function(a,b){return t(this,void 0,void 0,function(){var c,
d,p,f,h,k,e,g,n,y,B;return l(this,function(F){switch(F.label){case 0:c=this.errorContext;if(d=this.materialCache.get(a.material))return[3,15];p=null!=a.material?E.material(this.json.materials[a.material]):E.material();f=p.pbrMetallicRoughness;h=this.hasVertexColors(a);k=void 0;if(!f.baseColorTexture)return[3,2];c.errorUnsupportedIf(0!==(f.baseColorTexture.texCoord||0),"Only TEXCOORD with index 0 is supported.");return[4,this.getTexture(f.baseColorTexture.index,b)];case 1:k=F.sent(),F.label=2;case 2:e=
void 0;if(!p.normalTexture)return[3,5];if(0===(p.normalTexture.texCoord||0))return[3,3];c.warnUnsupported("Only TEXCOORD with index 0 is supported for the normal map texture.");return[3,5];case 3:return[4,this.getTexture(p.normalTexture.index,b)];case 4:e=F.sent(),F.label=5;case 5:g=void 0;if(!p.occlusionTexture)return[3,8];if(0===(p.occlusionTexture.texCoord||0))return[3,6];c.warnUnsupported("Only TEXCOORD with index 0 is supported for the occlusion texture.");return[3,8];case 6:return[4,this.getTexture(p.occlusionTexture.index,
b)];case 7:g=F.sent(),F.label=8;case 8:n=void 0;if(!p.emissiveTexture)return[3,11];if(0===(p.emissiveTexture.texCoord||0))return[3,9];c.warnUnsupported("Only TEXCOORD with index 0 is supported for the emissive texture.");return[3,11];case 9:return[4,this.getTexture(p.emissiveTexture.index,b)];case 10:n=F.sent(),F.label=11;case 11:y=void 0;if(!f.metallicRoughnessTexture)return[3,14];if(0===(f.metallicRoughnessTexture.texCoord||0))return[3,12];c.warnUnsupported("Only TEXCOORD with index 0 is supported for the metallicRoughness texture.");
return[3,14];case 12:return[4,this.getTexture(f.metallicRoughnessTexture.index,b)];case 13:y=F.sent(),F.label=14;case 14:B=null!=a.material?a.material:-1,d={alphaMode:p.alphaMode,alphaCutoff:p.alphaCutoff,color:f.baseColorFactor,doubleSided:!!p.doubleSided,colorTexture:k,normalTexture:e,name:p.name,id:B,occlusionTexture:g,emissiveTexture:n,emissiveFactor:p.emissiveFactor,metallicFactor:f.metallicFactor,roughnessFactor:f.roughnessFactor,metallicRoughnessTexture:y,vertexColors:h,ESRI_externalColorMixMode:p.extras.ESRI_externalColorMixMode},
F.label=15;case 15:return[2,d]}})})};b.prototype.getTexture=function(a,b){return t(this,void 0,void 0,function(){var c,d,p,f,h,k,e,g;return l(this,function(n){switch(n.label){case 0:c=this.errorContext;d=this.json.textures[a];p=E.textureSampler(null!=d.sampler?this.json.samplers[d.sampler]:{});c.errorUnsupportedIf(null==d.source,"Source is expected to be defined for a texture.");f=this.json.images[d.source];if(h=this.textureCache.get(a))return[3,6];k=void 0;return f.uri?[4,this.context.loadImage(this.resolveUri(f.uri),
b)]:[3,2];case 1:return k=n.sent(),[3,5];case 2:return c.errorUnsupportedIf(null==f.bufferView,"Image bufferView must be defined."),c.errorUnsupportedIf(null==f.mimeType,"Image mimeType must be defined."),e=this.json.bufferViews[f.bufferView],[4,this.getBuffer(e.buffer,b)];case 3:return g=n.sent(),c.errorUnsupportedIf(null!=e.byteStride,"byteStride not supported for image buffer"),[4,x(new Uint8Array(g.buffer,g.byteOffset+(e.byteOffset||0),e.byteLength),f.mimeType)];case 4:k=n.sent(),n.label=5;case 5:h=
{data:k,wrapS:p.wrapS,wrapT:p.wrapT,minFilter:p.minFilter,name:f.name,id:a},this.textureCache.set(a,h),n.label=6;case 6:return[2,h]}})})};b.prototype.getNodeTransform=function(a){if(void 0===a)return P;var c=this.nodeTransformCache.get(a);if(!c){var c=this.getNodeTransform(this.getNodeParent(a)),b=this.json.nodes[a];if(b.matrix)c=m.mat4.multiply(u.mat4f64.create(),c,b.matrix);else if(b.translation||b.rotation||b.scale)c=u.mat4f64.clone(c),b.translation&&m.mat4.translate(c,c,b.translation),b.rotation&&
(S[3]=D.quat.getAxisAngle(S,b.rotation),m.mat4.rotate(c,c,S[3],S)),b.scale&&m.mat4.scale(c,c,b.scale);this.nodeTransformCache.set(a,c)}return c};b.prototype.wrapAccessor=function(a,c){return new a(c.raw,c.byteOffset,c.byteStride,c.byteOffset+c.byteStride*(c.entryCount-1)+c.componentByteSize*c.componentCount)};b.prototype.resolveUri=function(a){return r.makeAbsolute(a,this.baseUri)};b.prototype.getNodeParent=function(a){return this.nodeParentMap.get(a)};b.prototype.checkVersionSupported=function(){var c=
a.Version.parse(this.json.asset.version,"glTF");O.validate(c)};b.prototype.checkRequiredExtensionsSupported=function(){var a=this.json,c=this.errorContext;a.extensionsRequired&&0!==a.extensionsRequired.length&&c.errorUnsupported("gltf loader was not able to load unsupported feature. Required extensions: "+a.extensionsRequired.join(", "))};b.prototype.computeNodeParents=function(){var a=this;this.json.nodes.forEach(function(c,b){c.children&&c.children.forEach(function(c){a.nodeParentMap.set(c,b)})})};
return b}();d.Resource=z;var O=new a.Version(2,0,"glTF"),P=m.mat4.fromXRotation(u.mat4f64.create(),Math.PI/2),S=w.quatf64.create(),R={SCALAR:1,VEC2:2,VEC3:3,VEC4:4},Q=(N={},N[5120]=1,N[5121]=1,N[5122]=2,N[5123]=2,N[5126]=4,N[5125]=4,N),U={5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5125:"UNSIGNED_INT",5126:"FLOAT"}})},"esri/core/Version":function(){define(["require","exports","./Error"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});z=function(){function d(d,
b,f){void 0===f&&(f="");this.major=d;this.minor=b;this._context=f}d.prototype.lessThan=function(d,b){return this.major<d||d===this.major&&this.minor<b};d.prototype.since=function(d,b){return!this.lessThan(d,b)};d.prototype.validate=function(d){if(this.major!==d.major)throw new t((this._context&&this._context+":")+"unsupported-version","Required major "+(this._context&&this._context+" ")+"version is '"+this.major+"', but got '${version.major}.${version.minor}'",{version:d});};d.prototype.clone=function(){return new d(this.major,
this.minor,this._context)};d.parse=function(l,b){void 0===b&&(b="");var f=l.split("."),h=f[0],f=f[1],q=/^\s*\d+\s*$/;if(!h||!h.match||!h.match(q))throw new t((b&&b+":")+"invalid-version","Expected major version to be a number, but got '${version}'",{version:l});if(!f||!f.match||!f.match(q))throw new t((b&&b+":")+"invalid-version","Expected minor version to be a number, but got '${version}'",{version:l});l=parseInt(h,10);h=parseInt(f,10);return new d(l,h,b)};return d}();d.Version=z})},"esri/views/3d/glTF/internal/BinaryStreamReader":function(){define(["require",
"exports"],function(z,d){Object.defineProperty(d,"__esModule",{value:!0});z=function(){function d(d){this.data=d;this.offset4=0;this.dataUint32=new Uint32Array(this.data,0,Math.floor(this.data.byteLength/4))}d.prototype.readUint32=function(){var d=this.offset4;this.offset4+=1;return this.dataUint32[d]};d.prototype.readUint8Array=function(d){var l=4*this.offset4;this.offset4+=d/4;return new Uint8Array(this.data,l,d)};d.prototype.remainingBytes=function(){return this.data.byteLength-4*this.offset4};
return d}();d.BinaryStreamReader=z})},"esri/views/3d/glTF/internal/fillDefaults":function(){define(["require","exports","../../../../core/tsSupport/assignHelper","../../../../core/compilerUtils"],function(z,d,t,l){Object.defineProperty(d,"__esModule",{value:!0});var q={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1},b={pbrMetallicRoughness:q,emissiveFactor:[0,0,0],alphaMode:"OPAQUE",alphaCutoff:.5,doubleSided:!1},f={ESRI_externalColorMixMode:"tint"};d.material=function(d){void 0===d&&
(d={});var c=t({},q,d.pbrMetallicRoughness),a=t({},f,d.extras);switch(a.ESRI_externalColorMixMode){case "multiply":case "tint":case "ignore":case "replace":break;default:l.neverReached(a.ESRI_externalColorMixMode),a.ESRI_externalColorMixMode="tint"}return t({},b,d,{pbrMetallicRoughness:c,extras:a})};var h={magFilter:9729,minFilter:9987,wrapS:10497,wrapT:10497};d.textureSampler=function(b){return t({},h,b)}})},"esri/views/3d/glTF/internal/pathUtils":function(){define(["require","exports"],function(z,
d){Object.defineProperty(d,"__esModule",{value:!0});d.splitURI=function(d){var l,q;d.replace(/^(.*\/)?([^/]*)$/,function(b,d,h){l=d||"";q=h||"";return""});return{dirPart:l,filePart:q}}})},"esri/views/3d/support/buffer/utils":function(){define("require exports ./types ./utils/mat3 ./utils/mat4 ./utils/scalar ./utils/vec2 ./utils/vec3 ./utils/vec4".split(" "),function(z,d,t,l,q,b,f,h,r){Object.defineProperty(d,"__esModule",{value:!0});d.mat3=l;d.mat4=q;d.scalar=b;d.vec2=f;d.vec3=h;d.vec4=r;d.createBuffer=
function(c,a){return new c(new ArrayBuffer(a*c.ElementCount*t.elementTypeSize(c.ElementType)))}})},"esri/views/3d/support/buffer/utils/mat3":function(){define(["require","exports"],function(z,d){Object.defineProperty(d,"__esModule",{value:!0});d.copy=function(d,l,q){var b=d.typedBuffer;d=d.typedBufferStride;var f=l.typedBuffer,h=l.typedBufferStride;l=q?q.count:l.count;var r=(q&&q.dstIndex?q.dstIndex:0)*d;q=(q&&q.srcIndex?q.srcIndex:0)*h;for(var c=0;c<l;++c){for(var a=0;9>a;++a)b[r+a]=f[q+a];r+=d;
q+=h}}})},"esri/views/3d/support/buffer/utils/mat4":function(){define(["require","exports"],function(z,d){Object.defineProperty(d,"__esModule",{value:!0});d.copy=function(d,l,q){var b=d.typedBuffer;d=d.typedBufferStride;var f=l.typedBuffer,h=l.typedBufferStride;l=q?q.count:l.count;var r=(q&&q.dstIndex?q.dstIndex:0)*d;q=(q&&q.srcIndex?q.srcIndex:0)*h;for(var c=0;c<l;++c){for(var a=0;16>a;++a)b[r+a]=f[q+a];r+=d;q+=h}}})},"esri/views/3d/support/buffer/utils/scalar":function(){define(["require","exports"],
function(z,d){Object.defineProperty(d,"__esModule",{value:!0});d.copy=function(d,l,q){var b=d.typedBuffer;d=d.typedBufferStride;var f=l.typedBuffer,h=l.typedBufferStride;l=q?q.count:l.count;var r=(q&&q.dstIndex?q.dstIndex:0)*d;q=(q&&q.srcIndex?q.srcIndex:0)*h;for(var c=0;c<l;++c)b[r]=f[q],r+=d,q+=h};d.makeDense=function(d,l){var q=d.count;l||(l=new d.TypedArrayConstructor(q));for(var b=0;b<q;b++)l[b]=d.get(b);return l}})},"esri/views/3d/support/buffer/utils/vec2":function(){define(["require","exports",
"../types"],function(z,d,t){function l(d,b,f){var h=d.typedBuffer;d=d.typedBufferStride;var l=b.typedBuffer,c=b.typedBufferStride;b=f?f.count:b.count;var a=(f&&f.dstIndex?f.dstIndex:0)*d;f=(f&&f.srcIndex?f.srcIndex:0)*c;for(var m=0;m<b;++m)h[a]=l[f],h[a+1]=l[f+1],a+=d,f+=c}Object.defineProperty(d,"__esModule",{value:!0});d.copy=l;d.normalizeIntegerBuffer=function(d,b,f){var h=d.typedBuffer,q=d.typedBufferStride,c=b.typedBuffer,a=b.typedBufferStride,m=f?f.count:b.count,u=(f&&f.dstIndex?f.dstIndex:
0)*q,D=(f&&f.srcIndex?f.srcIndex:0)*a;if(t.isInteger(b.elementType))if(f=t.maximumValue(b.elementType),t.isSigned(b.elementType))for(b=0;b<m;++b)h[u]=Math.max(c[D]/f,-1),h[u+1]=Math.max(c[D+1]/f,-1),u+=q,D+=a;else for(b=0;b<m;++b)h[u]=c[D]/f,h[u+1]=c[D+1]/f,u+=q,D+=a;else l(d,b,f);return d}})},"esri/views/3d/support/buffer/utils/vec3":function(){define(["require","exports"],function(z,d){Object.defineProperty(d,"__esModule",{value:!0});d.copy=function(d,l,q){var b=d.typedBuffer;d=d.typedBufferStride;
var f=l.typedBuffer,h=l.typedBufferStride;l=q?q.count:l.count;var r=(q&&q.dstIndex?q.dstIndex:0)*d;q=(q&&q.srcIndex?q.srcIndex:0)*h;for(var c=0;c<l;++c)b[r]=f[q],b[r+1]=f[q+1],b[r+2]=f[q+2],r+=d,q+=h}})},"esri/views/3d/support/buffer/utils/vec4":function(){define(["require","exports"],function(z,d){Object.defineProperty(d,"__esModule",{value:!0});d.copy=function(d,l,q){var b=d.typedBuffer;d=d.typedBufferStride;var f=l.typedBuffer,h=l.typedBufferStride;l=q?q.count:l.count;var r=(q&&q.dstIndex?q.dstIndex:
0)*d;q=(q&&q.srcIndex?q.srcIndex:0)*h;for(var c=0;c<l;++c)b[r]=f[q],b[r+1]=f[q+1],b[r+2]=f[q+2],b[r+3]=f[q+3],r+=d,q+=h};d.fill=function(d,l,q,b,f,h){var r=d.typedBuffer,c=d.typedBufferStride;d=h?h.count:d.count;h=(h&&h.dstIndex?h.dstIndex:0)*c;for(var a=0;a<d;++a)r[h]=l,r[h+1]=q,r[h+2]=b,r[h+3]=f,h+=c}})},"esri/views/3d/glTF/internal/indexUtils":function(){define(["require","exports","../../../../core/typedArrayUtil","../../webgl-engine/lib/geometryDataUtils"],function(z,d,t,l){function q(b){return l.generateDefaultIndexArray(b)}
Object.defineProperty(d,"__esModule",{value:!0});d.linearIndexArray=q;d.trianglesToTriangles=function(b){return"number"===typeof b?q(b):t.isUint16Array(b)||t.isUint8Array(b)?new Uint32Array(b):b};d.triangleStripToTriangles=function(b){var d="number"===typeof b?b:b.length;if(3>d)return new Uint32Array(0);var d=d-2,h=new Uint32Array(3*d);if("number"===typeof b)for(var l=0,c=0;c<d;c+=1)0===c%2?(h[l++]=c,h[l++]=c+1):(h[l++]=c+1,h[l++]=c),h[l++]=c+2;else for(c=l=0;c<d;c+=1){if(0===c%2)var a=b[c],m=b[c+
1],q=b[c+2];else a=b[c+1],m=b[c],q=b[c+2];h[l++]=a;h[l++]=m;h[l++]=q}return h};d.triangleFanToTriangles=function(b){var d="number"===typeof b?b:b.length;if(3>d)return new Uint32Array(0);var d=d-2,h=new Uint32Array(3*d);if("number"===typeof b){for(var l=0,c=0;c<d;++c)h[l++]=0,h[l++]=c+1,h[l++]=c+2;return h}for(var a=b[0],m=b[1],c=l=0;c<d;++c){var q=b[c+2];h[l++]=a;h[l++]=m;m=h[l++]=q}return h}})},"esri/views/3d/layers/graphics/wosrLoader":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../request ../../../../core/asyncUtils ../../../../core/Error ../../../../core/lang ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/Version ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../geometry/support/aaBoundingBox ../../support/imageUtils ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryData ../../webgl-engine/lib/Texture ../../webgl-engine/materials/DefaultMaterial".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u,D,w,v,E,C,J,K){function G(c,d){return q(this,void 0,void 0,function(){var h,q;return l(this,function(l){switch(l.label){case 0:return(h=a.isSome(d)&&d.streamDataRequester)?[2,I(c,h,d)]:[4,f.result(b(c,a.unwrap(d)))];case 1:q=l.sent();if(!0===q.ok)return[2,q.value.data];m.throwIfAbortError(q.error);x(q.error);return[2,void 0]}})})}function I(a,c,b){return q(this,void 0,void 0,function(){var d;return l(this,function(h){switch(h.label){case 0:return[4,f.result(c.request(a,
"json",b))];case 1:d=h.sent();if(!0===d.ok)return[2,d.value];m.throwIfAbortError(d.error);x(d.error.details.url);return[2,void 0]}})})}function x(a){throw new h("","Request for object resource failed: "+a);}function N(a){var c=w.empty();a.forEach(function(a){a=a.boundingInfo;w.expand(c,a.getBBMin());w.expand(c,a.getBBMax())});return c}function O(c,b){return q(this,void 0,void 0,function(){var d,f,h,q,r,p,t,A;return l(this,function(k){switch(k.label){case 0:d=[];f=function(e){var g=c[e],n=g.images[0].data;
if(!n)return S.warn("Externally referenced texture data is not yet supported"),"continue";var n=g.encoding+";base64,"+n,k="/textureDefinitions/"+e,p={noUnpackFlip:!0,wrap:{s:10497,t:10497},preMultiplyAlpha:!0};e=a.isSome(b)&&b.disableTextures?m.resolve(null):v.requestImage(n,b);d.push(e.then(function(e){return{refId:k,image:e,params:p,alphaChannelUsage:"rgba"===g.channels?g.alphaChannelUsage||"transparency":"none"}}))};for(h in c)f(h);return[4,m.all(d)];case 1:q=k.sent();r={};p=0;for(t=q;p<t.length;p++)A=
t[p],r[A.refId]=A;return[2,r]}})})}function P(a){switch(a){case "mask":return"mask";case "maskAndTransparency":return"maskBlend";case "none":return"opaque";case "transparency":return"blend";default:return"blend"}}Object.defineProperty(d,"__esModule",{value:!0});var S=c.getLogger("esri.views.3d.layers.graphics.objectResourceUtils");d.load=function(a,c){return q(this,void 0,void 0,function(){var b,d;return l(this,function(f){switch(f.label){case 0:return[4,G(a,c)];case 1:return b=f.sent(),[4,O(b.textureDefinitions,
c)];case 2:return d=f.sent(),[2,{resource:b,textures:d}]}})})};d.processLoadResult=function(c,b){var d,f,h=[],l=[],m=[],p=[],q=c.resource,A=u.Version.parse(q.version||"1.0","wosr");R.validate(A);var A=q.model.name,k=q.model.geometries,e=q.materialDefinitions;c=c.textures;for(var g=0,n=new Map,y=0;y<k.length;y++){var B=k[y];f=B;var F=f.params,H=F.topology;d=!0;F.vertexAttributes||(S.warn("Geometry must specify vertex attributes"),d=!1);switch(F.topology){case "PerAttributeArray":break;case "Indexed":case null:case void 0:H=
F.faces;if(!H)S.warn("Indexed geometries must specify faces"),d=!1;else if(F.vertexAttributes){var M=void 0;for(M in F.vertexAttributes)(F=H[M])&&F.values?(null!=F.valueType&&"UInt32"!==F.valueType&&(S.warn("Unsupported indexed geometry indices type '"+F.valueType+"', only UInt32 is currently supported"),d=!1),null!=F.valuesPerElement&&1!==F.valuesPerElement&&(S.warn("Unsupported indexed geometry values per element '"+F.valuesPerElement+"', only 1 is currently supported"),d=!1)):(S.warn("Indexed geometry does not specify face indices for '"+
M+"' attribute"),d=!1)}break;default:S.warn("Unsupported topology '"+H+"'"),d=!1}f.params.material||(S.warn("Geometry requires material"),d=!1);f=f.params.vertexAttributes;F=void 0;for(F in f)f[F].values||(S.warn("Geometries with externally defined attributes are not yet supported"),d=!1);if(d){f=B.params;d=f.material;f=f.texture;var H=B.params.vertexAttributes,F={},X;for(X in H)M=H[X],F[X]={data:M.values,size:M.valuesPerElement};H={};if("PerAttributeArray"===B.params.topology){for(var B=F.position.data.length/
F.position.size,M=new Uint32Array(B),Z=0;Z<B;Z++)M[Z]=Z;var B=M,ca;for(ca in F)H[ca]=B}else{var B=B.params.faces,t;for(t in B)H[t]=new Uint32Array(B[t].values)}(B=c&&c[f])&&!n.has(f)&&(M=new J(B.image,A,B.params),p.push(M),n.set(f,M));M=(M=n.get(f))?M.id:void 0;Z=m[d]?m[d][f]:null;if(!Z){Z=d.substring(d.lastIndexOf("/")+1);Z=e[Z].params;1===Z.transparency&&(Z.transparency=0);var v=B&&B.alphaChannelUsage,v=0<Z.transparency||"transparency"===v||"maskAndTransparency"===v,B={ambient:D.vec3f64.fromArray(Z.diffuse),
diffuse:D.vec3f64.fromArray(Z.diffuse),opacity:1-(Z.transparency||0),transparent:v,textureAlphaMode:B?P(B.alphaChannelUsage):void 0,textureAlphaCutoff:.33,textureId:M,initTextureTransparent:!0,doubleSided:!0,cullFace:0,colorMixMode:Z.externalColorMixMode||"tint",textureAlphaPremultiplied:!0};a.isSome(b)&&b.materialParamsMixin&&r.mixin(B,b.materialParamsMixin);Z=new K(B,A);m[d]||(m[d]={});m[d][f]=Z}l.push(Z);d=new E(new C.GeometryData(F,H),A);g+=H.position?H.position.length:0;h.push(d)}}return{name:A,
stageResources:{textures:p,materials:l,geometries:h},pivotOffset:q.model.pivotOffset,boundingBox:N(h),numberOfVertices:g,lodThreshold:null}};d.createTextureResources=O;var R=new u.Version(1,2,"wosr")})},"esri/views/3d/webgl-engine/materials/DefaultMaterial":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/assignHelper ../../../../core/libs/gl-matrix-2/mat3f64 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../support/buffer/InterleavedLayout ../core/shaderLibrary/util/AlphaDiscard.glsl ../lib/GLMaterialTexture ../lib/intersectorUtils ../lib/Material ../lib/StencilUtils ../lib/Util ./internal/bufferWriterUtils ./internal/MaterialUtil ./renderers/MergedRenderer ../shaders/DefaultMaterialTechnique ../shaders/RealisticTreeTechnique ../../../webgl/renderState ../../../webgl/renderState".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u,D,w,v,E,C,J,K,G){var I=D.assert;z=function(c){function d(a,b){b=c.call(this,b)||this;b.supportsEdges=!0;b.techniqueConfig=new C.DefaultMaterialTechniqueConfiguration;b.params=v.copyParameters(a,N);b.vertexBufferLayout=d.getVertexBufferLayout(b.params);b.instanceBufferLayout=a.instanced?d.getInstanceBufferLayout(b.params):null;return b}t(d,c);d.prototype.isVisibleInPass=function(a){return 3===a?this.params.castShadows:!0};d.prototype.isVisible=function(){var a=this.params;
if(!c.prototype.isVisible.call(this)||0===a.layerOpacity)return!1;var b=a.instanced,d=a.vertexColors,k=a.symbolColors,b=!!b&&-1<b.indexOf("color"),e=a.vvColorEnabled,g="replace"===a.colorMixMode,n=0<a.opacity,a=a.externalColor&&0<a.externalColor[3];return d&&(b||e||k)?g?!0:n:d?g?a:n:b||e||k?g?!0:n:g?a:n};d.prototype.setParameterValues=function(a){var c=this.params,b;for(b in a)"instanced"===b&&I(a.instanced===c.instanced,"Can not change instanced attributes"),"textureId"===b&&I(c.textureId,"Can only change texture of material that already has a texture"),
"vertexColors"===b&&!0===a[b]&&a[b]!==c[b]&&I(c.vertexColors,"Can not enable vertex colors after DefaultMaterial creation"),c[b]=a[b];this.parametersChanged()};d.prototype.getParameters=function(){return this.params};d.prototype.getTechniqueConfig=function(a){this.techniqueConfig.output=a;this.techniqueConfig.hasNormalTexture=!!this.params.normalTextureId;this.techniqueConfig.hasColorTexture=!!this.params.textureId;this.techniqueConfig.vertexTangents=this.params.vertexTangents;this.techniqueConfig.instanced=
!!this.params.instanced;this.techniqueConfig.instancedDoublePrecision=this.params.instancedDoublePrecision;this.techniqueConfig.vvSize=this.params.vvSizeEnabled;this.techniqueConfig.verticalOffset=null!==this.params.verticalOffset;this.techniqueConfig.screenSizePerspective=null!==this.params.screenSizePerspective;this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled;this.techniqueConfig.sliceHighlightDisabled=this.params.sliceHighlightDisabled;this.techniqueConfig.alphaDiscardMode=
"opaque"===this.params.textureAlphaMode?1:"mask"===this.params.textureAlphaMode?2:"maskBlend"===this.params.textureAlphaMode?3:0;this.techniqueConfig.normalsTypeDerivate="screenDerivative"===this.params.normals?!0:!1;0===a&&(this.techniqueConfig.vertexColors=this.params.vertexColors,this.techniqueConfig.symbolColors=this.params.symbolColors,this.params.treeRendering||(this.techniqueConfig.doubleSidedMode=this.params.doubleSided&&"normal"===this.params.doubleSidedType?1:this.params.doubleSided&&"winding-order"===
this.params.doubleSidedType?2:0),this.techniqueConfig.instancedColor=!!this.params.instanced&&-1<this.params.instanced.indexOf("color"),this.techniqueConfig.receiveShadows=this.params.receiveShadows&&this.params.shadowMappingEnabled,this.techniqueConfig.receiveAmbientOcclusion=this.params.receiveSSAO,this.techniqueConfig.vvColor=this.params.vvColorEnabled,this.techniqueConfig.textureAlphaPremultiplied=!!this.params.textureAlphaPremultiplied,this.techniqueConfig.usePBR=this.params.usePBR,this.techniqueConfig.hasMetalnessAndRoughnessTexture=
!!this.params.metallicRoughnessTextureId,this.techniqueConfig.hasEmissionTexture=!!this.params.emissiveTextureId,this.techniqueConfig.hasOcclusionTexture=!!this.params.occlusionTextureId,this.techniqueConfig.offsetBackfaces=!(!this.params.transparent||!this.params.offsetTransparentBackfaces),this.techniqueConfig.isSchematic=this.params.usePBR&&this.params.isSchematic);return this.techniqueConfig};d.prototype.intersect=function(c,d,f,k,e,g,n){if(null!==this.params.verticalOffset){var y=k.camera;b.vec3.set(Y,
f[12],f[13],f[14]);f=null;switch(k.viewingMode){case "global":f=b.vec3.normalize(U,Y);break;case "local":f=b.vec3.copy(U,Q)}var p=0;if(null!==this.params.verticalOffset){var F=b.vec3.subtract(T,Y,y.eye),H=b.vec3.length(F),F=b.vec3.scale(F,F,1/H),M=null;this.params.screenSizePerspective&&(M=b.vec3.dot(f,F));p+=v.verticalOffsetAtDistance(y,H,this.params.verticalOffset,M,this.params.screenSizePerspective)}b.vec3.scale(f,f,p);b.vec3.transformMat3(V,f,k.transform.inverseRotation);e=b.vec3.subtract(S,e,
V);g=b.vec3.subtract(R,g,V)}v.intersectTriangleGeometry(c,d,k,e,g,a.getVerticalOffsetObject3D(k.verticalOffset),n)};d.prototype.getGLMaterial=function(a){if(0===a.output||1===a.output||2===a.output||3===a.output||4===a.output)return new x(a)};d.prototype.createRenderer=function(a,c){return new E(a,c,this)};d.prototype.createBufferWriter=function(){return new O(this.vertexBufferLayout,this.instanceBufferLayout)};d.getVertexBufferLayout=function(a){var c=a.textureId||a.normalTextureId||a.metallicRoughnessTextureId||
a.emissiveTextureId||a.occlusionTextureId,b=h.newLayout().vec3f("position").vec3f("normal");a.vertexTangents&&b.vec4f("tangent");c&&b.vec2f("uv0");a.vertexColors&&b.vec4u8("color");a.symbolColors&&b.vec4u8("symbolColor");return b};d.getInstanceBufferLayout=function(a){var c=h.newLayout(),c=a.instancedDoublePrecision?c.vec3f("modelOriginHi").vec3f("modelOriginLo").mat3f("model").mat3f("modelNormal"):c.mat4f("model").mat4f("modelNormal");a.instanced&&-1<a.instanced.indexOf("color")&&(c=c.vec4f("instanceColor"));
a.instanced&&-1<a.instanced.indexOf("featureAttribute")&&(c=c.vec4f("instanceFeatureAttribute"));return c};return d}(m.Material);var x=function(a){function b(b){var d=this,d=a.call(this,c.makeCtorParameters(b,b.material.getParameters()))||this;d.updateParameters();return d}t(b,a);b.prototype.updateParameters=function(){this.selectPipelines();this.selectSlot();var a=this.material.getParameters();this.updateTexture(a.textureId);this.technique=a.treeRendering?this.techniqueRep.acquireAndReleaseExisting(J.RealisticTreeTechnique,
this.material.getTechniqueConfig(this.output),this.technique):this.techniqueRep.acquireAndReleaseExisting(C.DefaultMaterialTechnique,this.material.getTechniqueConfig(this.output),this.technique)};b.prototype.selectSlot=function(){this.slot=this.material.getParameters().transparent?this.material.getParameters().writeDepth?5:8:3};b.prototype.selectPipelines=function(){var a=this.material.getParameters(),c=0===this.output?a.transparent&&K.separateBlendingParams(770,1,771,771):null,b=function(k){return G.makePipelineState({blending:c,
culling:P(a),depthTest:{func:513},depthWrite:a.writeDepth&&G.defaultDepthWriteParams,colorWrite:G.defaultColorWriteParams,stencilWrite:a.sceneHasOcludees?u.stencilWriteMaskOn:null,stencilTest:a.sceneHasOcludees?k?u.stencilToolMaskBaseParams:u.stencilBaseAllZerosParams:null})};this.pipelineState=b(!1);this.occludeePipelineState=b(!0)};b.prototype._updateShadowState=function(a){a.shadowMappingEnabled!==this.material.getParameters().shadowMappingEnabled&&(this.material.setParameterValues({shadowMappingEnabled:a.shadowMappingEnabled}),
this.updateParameters())};b.prototype._updateOccludeeState=function(a){a.hasOccludees!==this.material.getParameters().sceneHasOcludees&&(this.material.setParameterValues({sceneHasOcludees:a.hasOccludees}),this.updateParameters())};b.prototype.ensureParameters=function(a){0===this.output&&(this._updateShadowState(a),this._updateOccludeeState(a))};b.prototype.bind=function(a,c){a.bindProgram(this.technique.program);this.technique.bindPass(a,this.material.getParameters(),c);this.bindTexture(a,this.technique.program)};
b.prototype.beginSlot=function(a){return a===this.slot};b.prototype.getPipelineState=function(a,c){return c?this.occludeePipelineState:this.pipelineState};return b}(c);(z||(z={})).COLOR_GAMMA=2.1;var N={textureId:void 0,initTextureTransparent:!1,isSchematic:!1,usePBR:!1,normalTextureId:void 0,vertexTangents:!1,occlusionTextureId:void 0,emissiveTextureId:void 0,metallicRoughnessTextureId:void 0,emissiveFactor:[0,0,0],mrrFactors:[0,1,.5],ambient:[.2,.2,.2],diffuse:[.8,.8,.8],externalColor:[1,1,1,1],
colorMixMode:"multiply",opacity:1,layerOpacity:1,vertexColors:!1,symbolColors:!1,doubleSided:!1,doubleSidedType:"normal",cullFace:void 0,instanced:void 0,instancedDoublePrecision:!1,normals:"default",receiveSSAO:!0,receiveShadows:!0,castShadows:!0,shadowMappingEnabled:!1,verticalOffset:null,screenSizePerspective:null,slicePlaneEnabled:!1,sliceHighlightDisabled:!1,offsetTransparentBackfaces:!1,vvSizeEnabled:!1,vvSizeMinSize:[1,1,1],vvSizeMaxSize:[100,100,100],vvSizeOffset:[0,0,0],vvSizeFactor:[1,1,
1],vvSizeValue:[1,1,1],vvColorEnabled:!1,vvColorValues:[0,0,0,0,0,0,0,0],vvColorColors:[1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],vvSymbolAnchor:[0,0,0],vvSymbolRotationMatrix:q.mat3f64.create(),transparent:!1,writeDepth:!0,textureAlphaMode:"blend",textureAlphaCutoff:r.defaultMaskAlphaCutoff,textureAlphaPremultiplied:!1,sceneHasOcludees:!1},O=function(){function a(a,c){this.vertexBufferLayout=a;this.instanceBufferLayout=c}a.prototype.allocate=function(a){return this.vertexBufferLayout.createBuffer(a)};
a.prototype.elementCount=function(a){return a.indices.position.length};a.prototype.write=function(a,c,b,d){w.writeDefaultAttributes(c,this.vertexBufferLayout,a.transformation,a.invTranspTransformation,b,d)};return a}(),P=function(a){var c;c=a.cullFace?0!==a.cullFace:a.slicePlaneEnabled?!1:!a.transparent&&!a.doubleSided;return c&&{face:1===a.cullFace?1028:1029,mode:2305}},S=f.vec3f64.create(),R=f.vec3f64.create(),Q=f.vec3f64.fromValues(0,0,1),U=f.vec3f64.create(),V=f.vec3f64.create(),Y=f.vec3f64.create(),
T=f.vec3f64.create();return z})},"esri/views/3d/webgl-engine/shaders/DefaultMaterialTechnique":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/libs/gl-matrix-2/vec3f64 ../core/shaderLibrary/Slice.glsl ../core/shaderLibrary/Transform.glsl ../core/shaderLibrary/attributes/InstancedDoublePrecision.glsl ../core/shaderLibrary/attributes/VerticalOffset.glsl ../core/shaderLibrary/output/OutputHighlight.glsl ../core/shaderLibrary/shading/PhysicallyBasedRenderingParameters.glsl ../core/shaderLibrary/shading/ReadShadowMap.glsl ../core/shaderLibrary/shading/VisualVariables.glsl ../core/shaderLibrary/util/Camera.glsl ../core/shaderLibrary/util/DoublePrecision.glsl ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../core/shaderTechnique/ShaderTechniqueConfiguration ../lib/DefaultVertexAttributeLocations ../materials/internal/MaterialUtil ./DefaultMaterial.glsl ../../../webgl/Program".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u,D,w,v,E,C,J,K,G,I){Object.defineProperty(d,"__esModule",{value:!0});E=function(d){function l(){return null!==d&&d.apply(this,arguments)||this}t(l,d);l.prototype.initializeProgram=function(a){var c=l.shader.get(),b=this.configuration,c=c.build({output:b.output,viewingMode:a.viewingMode,receiveShadows:b.receiveShadows,slicePlaneEnabled:b.slicePlaneEnabled,sliceHighlightDisabled:b.sliceHighlightDisabled,sliceEnabledForVertexPrograms:!1,symbolColor:b.symbolColors,vvSize:b.vvSize,
vvColor:b.vvColor,vvInstancingEnabled:!0,instanced:b.instanced,instancedColor:b.instancedColor,instancedDoublePrecision:b.instancedDoublePrecision,useOldSceneLightInterface:!1,pbrMode:b.usePBR?b.isSchematic?2:1:0,hasMetalnessAndRoughnessTexture:b.hasMetalnessAndRoughnessTexture,hasEmissionTexture:b.hasEmissionTexture,hasOcclusionTexture:b.hasOcclusionTexture,hasNormalTexture:b.hasNormalTexture,hasColorTexture:b.hasColorTexture,receiveAmbientOcclusion:b.receiveAmbientOcclusion,useCustomDTRExponentForWater:!1,
normalType:b.normalsTypeDerivate?3:0,doubleSidedMode:b.doubleSidedMode,vertexTangets:b.vertexTangents,attributeTextureCoordinates:b.hasMetalnessAndRoughnessTexture||b.hasEmissionTexture||b.hasOcclusionTexture||b.hasNormalTexture||b.hasColorTexture?1:0,textureAlphaPremultiplied:b.textureAlphaPremultiplied,attributeColor:b.vertexColors,screenSizePerspectiveEnabled:b.screenSizePerspective,verticalOffsetEnabled:b.verticalOffset,offsetBackfaces:b.offsetBackfaces,doublePrecisionRequiresObfuscation:w.doublePrecisionRequiresObfuscation(a.rctx),
alphaDiscardMode:b.alphaDiscardMode,supportsTextureAtlas:!1});return new I(a.rctx,c.generateSource("vertex"),c.generateSource("fragment"),J.Default3D)};l.prototype.bindPass=function(b,d,f){var h=this.configuration.output;0===h?(this.program.setUniform3fv("ambient",d.ambient),this.program.setUniform3fv("diffuse",d.diffuse),this.program.setUniform4fv("externalColor",d.externalColor),this.program.setUniform1i("colorMixMode",K.colorMixModes[d.colorMixMode]),this.program.setUniform1f("opacity",d.opacity),
this.program.setUniform1f("layerOpacity",d.layerOpacity),this.configuration.usePBR&&a.PhysicallyBasedRenderingParameters.bindUniforms(this.program,d,this.configuration.isSchematic)):1===h||3===h?this.program.setUniform2fv("nearFar",f.nearFar):4===h&&c.OutputHighlight.bindOutputHighlight(b,this.program,f);u.VisualVariables.bindUniformsForSymbols(this.program,d);r.VerticalOffset.bindUniforms(this.program,d,f);K.bindScreenSizePerspective(d.screenSizePerspective,this.program);"mask"!==d.textureAlphaMode&&
"maskBlend"!==d.textureAlphaMode||this.program.setUniform1f("textureAlphaCutoff",d.textureAlphaCutoff)};l.prototype.bindDraw=function(a){var c=this.configuration.instancedDoublePrecision?q.vec3f64.fromValues(a.viewInvTransp[3],a.viewInvTransp[7],a.viewInvTransp[11]):a.origin;f.Transform.bindUniformsCustomOrigin(this.program,c,a.view);(0===this.configuration.output||1===this.configuration.output&&this.configuration.screenSizePerspective||2===this.configuration.output&&this.configuration.screenSizePerspective||
4===this.configuration.output&&this.configuration.screenSizePerspective)&&D.Camera.bindUniformsCustomOrigin(this.program,c,a.viewInvTransp);2===this.configuration.output&&this.program.setUniformMatrix4fv("viewNormal",a.viewInvTransp);this.configuration.instancedDoublePrecision&&h.InstancedDoublePrecision.bindCustomOrigin(this.program,c);b.Slice.bindUniforms(this.program,this.configuration,a.slicePlane,c);0===this.configuration.output&&m.ReadShadowMap.bindViewCustomOrigin(this.program,a,c)};l.prototype.bindInstance=
function(a){this.program.setUniformMatrix4fv("model",a.transformation);this.program.setUniformMatrix4fv("modelNormal",a.transformationNormal)};l.prototype.initializePipeline=function(){return null};l.shader=new v.ReloadableShaderModule(G,"./DefaultMaterial.glsl",z);return l}(E.ShaderTechnique);d.DefaultMaterialTechnique=E;E=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b.output=0;b.alphaDiscardMode=1;b.doubleSidedMode=0;b.isSchematic=!1;b.vertexColors=!1;b.offsetBackfaces=
!1;b.symbolColors=!1;b.vvSize=!1;b.vvColor=!1;b.verticalOffset=!1;b.receiveShadows=!1;b.slicePlaneEnabled=!1;b.sliceHighlightDisabled=!1;b.receiveAmbientOcclusion=!1;b.screenSizePerspective=!1;b.textureAlphaPremultiplied=!1;b.hasColorTexture=!1;b.usePBR=!1;b.hasMetalnessAndRoughnessTexture=!1;b.hasEmissionTexture=!1;b.hasOcclusionTexture=!1;b.hasNormalTexture=!1;b.instanced=!1;b.instancedColor=!1;b.instancedDoublePrecision=!1;b.vertexTangents=!1;b.normalsTypeDerivate=!1;return b}t(b,a);l([C.parameter({count:7})],
b.prototype,"output",void 0);l([C.parameter({count:4})],b.prototype,"alphaDiscardMode",void 0);l([C.parameter({count:3})],b.prototype,"doubleSidedMode",void 0);l([C.parameter()],b.prototype,"isSchematic",void 0);l([C.parameter()],b.prototype,"vertexColors",void 0);l([C.parameter()],b.prototype,"offsetBackfaces",void 0);l([C.parameter()],b.prototype,"symbolColors",void 0);l([C.parameter()],b.prototype,"vvSize",void 0);l([C.parameter()],b.prototype,"vvColor",void 0);l([C.parameter()],b.prototype,"verticalOffset",
void 0);l([C.parameter()],b.prototype,"receiveShadows",void 0);l([C.parameter()],b.prototype,"slicePlaneEnabled",void 0);l([C.parameter()],b.prototype,"sliceHighlightDisabled",void 0);l([C.parameter()],b.prototype,"receiveAmbientOcclusion",void 0);l([C.parameter()],b.prototype,"screenSizePerspective",void 0);l([C.parameter()],b.prototype,"textureAlphaPremultiplied",void 0);l([C.parameter()],b.prototype,"hasColorTexture",void 0);l([C.parameter()],b.prototype,"usePBR",void 0);l([C.parameter()],b.prototype,
"hasMetalnessAndRoughnessTexture",void 0);l([C.parameter()],b.prototype,"hasEmissionTexture",void 0);l([C.parameter()],b.prototype,"hasOcclusionTexture",void 0);l([C.parameter()],b.prototype,"hasNormalTexture",void 0);l([C.parameter()],b.prototype,"instanced",void 0);l([C.parameter()],b.prototype,"instancedColor",void 0);l([C.parameter()],b.prototype,"instancedDoublePrecision",void 0);l([C.parameter()],b.prototype,"vertexTangents",void 0);l([C.parameter()],b.prototype,"normalsTypeDerivate",void 0);
return b}(C.ShaderTechniqueConfiguration);d.DefaultMaterialTechniqueConfiguration=E})},"esri/views/3d/webgl-engine/core/shaderLibrary/attributes/InstancedDoublePrecision.glsl":function(){define("require exports ../../../../../../core/tsSupport/makeTemplateObjectHelper ../../../../../../core/libs/gl-matrix-2/vec3f64 ../util/DoublePrecision.glsl ../../shaderModules/interfaces ../../../lib/doublePrecisionUtils".split(" "),function(z,d,t,l,q,b,f){function h(c,d){d.instanced&&d.instancedDoublePrecision?
(c.attributes.add("modelOriginHi","vec3"),c.attributes.add("modelOriginLo","vec3"),c.attributes.add("model","mat3"),c.attributes.add("modelNormal","mat3")):(c.vertex.uniforms.add("model","mat4"),c.vertex.uniforms.add("modelNormal","mat4"));d.instancedDoublePrecision&&(c.include(q.DoublePrecision,d),c.vertex.uniforms.add("viewOriginHi","vec3"),c.vertex.uniforms.add("viewOriginLo","vec3"));var f=[b.glsl(a||(a=t(["\n    vec3 calculateVPos() {\n      ","\n    }\n    "],["\n    vec3 calculateVPos() {\n      ",
"\n    }\n    "])),d.instancedDoublePrecision?"return model * localPosition().xyz;":"return (model * localPosition()).xyz;"),b.glsl(u||(u=t(["\n    vec3 subtractOrigin(vec3 _pos) {\n      ","\n    }\n    "],["\n    vec3 subtractOrigin(vec3 _pos) {\n      ","\n    }\n    "])),d.instancedDoublePrecision?b.glsl(m||(m=t(["\n          vec3 originDelta \x3d dpAdd(viewOriginHi, viewOriginLo, -modelOriginHi, -modelOriginLo);\n          return _pos - originDelta;"],["\n          vec3 originDelta \x3d dpAdd(viewOriginHi, viewOriginLo, -modelOriginHi, -modelOriginLo);\n          return _pos - originDelta;"]))):
"return vpos;"),b.glsl(D||(D=t(["\n    vec3 dpNormal(vec4 _normal) {\n      ","\n    }\n    "],["\n    vec3 dpNormal(vec4 _normal) {\n      ","\n    }\n    "])),d.instancedDoublePrecision?"return normalize(modelNormal * _normal.xyz);":"return normalize((modelNormal * _normal).xyz);"),b.glsl(w||(w=t(["\n    vec3 dpNormalView(vec4 _normal) {\n      ","\n    }\n    "],["\n    vec3 dpNormalView(vec4 _normal) {\n      ","\n    }\n    "])),d.instancedDoublePrecision?"return normalize((viewNormal * vec4(modelNormal * _normal.xyz, 1.0)).xyz);":
"return normalize((viewNormal * modelNormal * _normal).xyz);")];c.vertex.code.add(f[0]);c.vertex.code.add(f[1]);c.vertex.code.add(f[2]);2===d.output&&c.vertex.code.add(f[3])}Object.defineProperty(d,"__esModule",{value:!0});d.InstancedDoublePrecision=h;(function(a){var b=function(){return function(){}}();a.Uniforms=b;a.bindCustomOrigin=function(a,b){f.encodeDoubleArraySplit(b,r,c,3);a.setUniform3fv("viewOriginHi",r);a.setUniform3fv("viewOriginLo",c)}})(h=d.InstancedDoublePrecision||(d.InstancedDoublePrecision=
{}));var r=l.vec3f64.create(),c=l.vec3f64.create(),a,m,u,D,w})},"esri/views/3d/webgl-engine/core/shaderLibrary/util/DoublePrecision.glsl":function(){define("require exports ../../../../../../core/tsSupport/makeTemplateObjectHelper ../../../../../../core/has ../../shaderModules/interfaces ../../../lib/WebGLDriverTest".split(" "),function(z,d,t,l,q,b){Object.defineProperty(d,"__esModule",{value:!0});d.DoublePrecision=function(b,c){c.doublePrecisionRequiresObfuscation?b.vertex.code.add(q.glsl(f||(f=
t(["\n      vec3 dpPlusFrc(vec3 a, vec3 b) {\n        return mix(a, a + b, vec3(notEqual(b, vec3(0))));\n      }\n\n      vec3 dpMinusFrc(vec3 a, vec3 b) {\n        return mix(vec3(0), a - b, vec3(notEqual(a, b)));\n      }\n\n      // based on https://www.thasler.com/blog/blog/glsl-part2-emu\n      vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\n        vec3 t1 \x3d dpPlusFrc(hiA, hiB);\n        vec3 e \x3d dpMinusFrc(t1, hiA);\n        vec3 t2 \x3d dpMinusFrc(hiB, e) + dpMinusFrc(hiA, dpMinusFrc(t1, e)) + loA + loB;\n        return t1 + t2;\n      }\n    "],
["\n      vec3 dpPlusFrc(vec3 a, vec3 b) {\n        return mix(a, a + b, vec3(notEqual(b, vec3(0))));\n      }\n\n      vec3 dpMinusFrc(vec3 a, vec3 b) {\n        return mix(vec3(0), a - b, vec3(notEqual(a, b)));\n      }\n\n      // based on https://www.thasler.com/blog/blog/glsl-part2-emu\n      vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\n        vec3 t1 \x3d dpPlusFrc(hiA, hiB);\n        vec3 e \x3d dpMinusFrc(t1, hiA);\n        vec3 t2 \x3d dpMinusFrc(hiB, e) + dpMinusFrc(hiA, dpMinusFrc(t1, e)) + loA + loB;\n        return t1 + t2;\n      }\n    "])))):
b.vertex.code.add(q.glsl(h||(h=t(["\n      vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\n        vec3 t1 \x3d hiA + hiB;\n        vec3 e \x3d t1 - hiA;\n        vec3 t2 \x3d ((hiB - e) + (hiA - (t1 - e))) + loA + loB;\n        return t1 + t2;\n      }\n    "],["\n      vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\n        vec3 t1 \x3d hiA + hiB;\n        vec3 e \x3d t1 - hiA;\n        vec3 t2 \x3d ((hiB - e) + (hiA - (t1 - e))) + loA + loB;\n        return t1 + t2;\n      }\n    "]))))};
d.doublePrecisionRequiresObfuscation=function(d){return l("force-double-precision-obfuscation")?!0:b.testWebGLDriver(d).doublePrecisionRequiresObfuscation};var f,h})},"esri/views/3d/webgl-engine/lib/WebGLDriverTest":function(){define("require exports ../../../../core/maybe ../../../../core/libs/gl-matrix-2/vec3f64 ../../../webgl ./doublePrecisionUtils ./Util".split(" "),function(z,d,t,l,q,b,f){function h(a,c){var d=new q.FramebufferObject(a,{colorTarget:0,depthStencilTarget:0},{target:3553,wrapMode:33071,
pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1}),h=q.BufferObject.createVertex(a,35044,new Uint16Array([0,0,1,0,0,1,1,1])),m=new q.VertexArrayObject(a,{a_pos:0},{geometry:[{name:"a_pos",count:2,type:5123,offset:0,stride:4,normalized:!1}]},{geometry:h}),r=l.vec3f64.fromValues(5633261.287538229,2626832.878767164,1434988.0495278358),t=l.vec3f64.fromValues(5633271.46742708,2626873.6381334523,1434963.231608387);a.bindFramebuffer(d);c=new q.Program(a,"\n\n  precision highp float;\n\n  attribute vec2 a_pos;\n\n  uniform vec3 u_highA;\n  uniform vec3 u_lowA;\n  uniform vec3 u_highB;\n  uniform vec3 u_lowB;\n\n  varying vec4 v_color;\n\n  "+
(c?"#define DOUBLE_PRECISION_REQUIRES_OBFUSCATION":"")+"\n\n  #ifdef DOUBLE_PRECISION_REQUIRES_OBFUSCATION\n\n  vec3 dpPlusFrc(vec3 a, vec3 b) {\n    return mix(a, a + b, vec3(notEqual(b, vec3(0))));\n  }\n\n  vec3 dpMinusFrc(vec3 a, vec3 b) {\n    return mix(vec3(0), a - b, vec3(notEqual(a, b)));\n  }\n\n  vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\n    vec3 t1 \x3d dpPlusFrc(hiA, hiB);\n    vec3 e \x3d dpMinusFrc(t1, hiA);\n    vec3 t2 \x3d dpMinusFrc(hiB, e) + dpMinusFrc(hiA, dpMinusFrc(t1, e)) + loA + loB;\n    return t1 + t2;\n  }\n\n  #else\n\n  vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\n    vec3 t1 \x3d hiA + hiB;\n    vec3 e \x3d t1 - hiA;\n    vec3 t2 \x3d ((hiB - e) + (hiA - (t1 - e))) + loA + loB;\n    return t1 + t2;\n  }\n\n  #endif\n\n  const float MAX_RGBA_FLOAT \x3d\n    255.0 / 256.0 +\n    255.0 / 256.0 / 256.0 +\n    255.0 / 256.0 / 256.0 / 256.0 +\n    255.0 / 256.0 / 256.0 / 256.0 / 256.0;\n\n  const vec4 FIXED_POINT_FACTORS \x3d vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);\n\n  vec4 float2rgba(const float value) {\n    // Make sure value is in the domain we can represent\n    float valueInValidDomain \x3d clamp(value, 0.0, MAX_RGBA_FLOAT);\n\n    // Decompose value in 32bit fixed point parts represented as\n    // uint8 rgba components. Decomposition uses the fractional part after multiplying\n    // by a power of 256 (this removes the bits that are represented in the previous\n    // component) and then converts the fractional part to 8bits.\n    vec4 fixedPointU8 \x3d floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);\n\n    // Convert uint8 values (from 0 to 255) to floating point representation for\n    // the shader\n    const float toU8AsFloat \x3d 1.0 / 255.0;\n\n    return fixedPointU8 * toU8AsFloat;\n  }\n\n  void main() {\n    vec3 val \x3d dpAdd(u_highA, u_lowA, -u_highB, -u_lowB);\n\n    v_color \x3d float2rgba(val.z / 25.0);\n\n    gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n  }\n  ",
"\n  precision highp float;\n\n  varying vec4 v_color;\n\n  void main() {\n    gl_FragColor \x3d v_color;\n  }\n  ",{a_pos:0});var C=new Float32Array(6);b.encodeDoubleArray(r,C,3);var z=new Float32Array(6);b.encodeDoubleArray(t,z,3);a.bindProgram(c);c.setUniform3f("u_highA",C[0],C[2],C[4]);c.setUniform3f("u_lowA",C[1],C[3],C[5]);c.setUniform3f("u_highB",z[0],z[2],z[4]);c.setUniform3f("u_lowB",z[1],z[3],z[5]);var K=a.getViewport(),C=K.x,z=K.y,G=K.width,K=K.height;a.setViewport(0,0,1,1);a.bindVAO(m);
a.drawArrays(5,0,4);a.setViewport(C,z,G,K);a=new Uint8Array(4);d.readPixels(0,0,1,1,6408,5121,a);c.dispose();m.dispose(!1);h.dispose();d.dispose();d=(r[2]-t[2])/25;h=f.unpackFloatRGBA(a);return Math.abs(d-h)}Object.defineProperty(d,"__esModule",{value:!0});var r=function(){function a(a){this.context=a;this._doublePrecisionRequiresObfuscation=null}Object.defineProperty(a.prototype,"doublePrecisionRequiresObfuscation",{get:function(){if(t.isNone(this._doublePrecisionRequiresObfuscation)){var a=h(this.context,
!1),b=h(this.context,!0);this._doublePrecisionRequiresObfuscation=0!==a&&(0===b||5<a/b)}return this._doublePrecisionRequiresObfuscation},enumerable:!0,configurable:!0});return a}(),c=null;d.testWebGLDriver=function(a){if(t.isNone(c)||c.context!==a)c=new r(a);return c}})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/PhysicallyBasedRenderingParameters.glsl":function(){define("require exports ../../../../../../core/tsSupport/makeTemplateObjectHelper ../../../../../../core/libs/gl-matrix-2/vec3f32 ../attributes/VertexTextureCoordinates.glsl ../../shaderModules/interfaces".split(" "),
function(z,d,t,l,q,b){function f(d,f){var l=d.fragment,v=f.hasMetalnessAndRoughnessTexture||f.hasEmissionTexture||f.hasOcclusionTexture;1===f.pbrMode&&v&&d.include(q.VertexTextureCoordinates,f);2===f.pbrMode?l.code.add(b.glsl(h||(h=t(["\n      const vec3 mrr \x3d vec3(0.0, 0.6, 0.2);\n      const vec3 emission \x3d vec3(0.0);\n      float occlusion \x3d 1.0;\n\n      void applyPBRFactors() {}\n\n      float getBakedOcclusion() { return 1.0; }\n    "],["\n      const vec3 mrr \x3d vec3(0.0, 0.6, 0.2);\n      const vec3 emission \x3d vec3(0.0);\n      float occlusion \x3d 1.0;\n\n      void applyPBRFactors() {}\n\n      float getBakedOcclusion() { return 1.0; }\n    "])))):
(0===f.pbrMode&&l.code.add(b.glsl(r||(r=t(["\n      float getBakedOcclusion() { return 1.0; }\n  "],["\n      float getBakedOcclusion() { return 1.0; }\n  "])))),1===f.pbrMode&&(l.uniforms.add("emissionFactor","vec3"),l.uniforms.add("mrrFactors","vec3"),l.code.add(b.glsl(c||(c=t(["\n      vec3 mrr;\n      vec3 emission;\n      float occlusion;\n    "],["\n      vec3 mrr;\n      vec3 emission;\n      float occlusion;\n    "])))),f.hasMetalnessAndRoughnessTexture&&(l.uniforms.add("texMetallicRoughness",
"sampler2D"),f.supportsTextureAtlas&&l.uniforms.add("texMetallicRoughnessSize","vec2"),l.code.add(b.glsl(a||(a=t(["\n      void applyMetallnessAndRoughness(TextureLookupParameter params) {\n        vec3 metallicRoughness \x3d textureLookup(texMetallicRoughness, params).rgb;\n\n        mrr[0] *\x3d metallicRoughness.b;\n        mrr[1] *\x3d metallicRoughness.g;\n      }"],["\n      void applyMetallnessAndRoughness(TextureLookupParameter params) {\n        vec3 metallicRoughness \x3d textureLookup(texMetallicRoughness, params).rgb;\n\n        mrr[0] *\x3d metallicRoughness.b;\n        mrr[1] *\x3d metallicRoughness.g;\n      }"]))))),
f.hasEmissionTexture&&(l.uniforms.add("texEmission","sampler2D"),f.supportsTextureAtlas&&l.uniforms.add("texEmissionSize","vec2"),l.code.add(b.glsl(m||(m=t(["\n      void applyEmission(TextureLookupParameter params) {\n        emission *\x3d textureLookup(texEmission, params).rgb;\n      }"],["\n      void applyEmission(TextureLookupParameter params) {\n        emission *\x3d textureLookup(texEmission, params).rgb;\n      }"]))))),f.hasOcclusionTexture?(l.uniforms.add("texOcclusion","sampler2D"),
f.supportsTextureAtlas&&l.uniforms.add("texOcclusionSize","vec2"),l.code.add(b.glsl(u||(u=t(["\n      void applyOcclusion(TextureLookupParameter params) {\n        occlusion *\x3d textureLookup(texOcclusion, params).r;\n      }\n\n      float getBakedOcclusion() {\n        return occlusion;\n      }\n      "],["\n      void applyOcclusion(TextureLookupParameter params) {\n        occlusion *\x3d textureLookup(texOcclusion, params).r;\n      }\n\n      float getBakedOcclusion() {\n        return occlusion;\n      }\n      "]))))):
l.code.add(b.glsl(D||(D=t(["\n      float getBakedOcclusion() { return 1.0; }\n      "],["\n      float getBakedOcclusion() { return 1.0; }\n      "])))),l.code.add(b.glsl(w||(w=t(["\n    void applyPBRFactors() {\n      mrr \x3d mrrFactors;\n      emission \x3d emissionFactor;\n      occlusion \x3d 1.0;\n      ","\n      ","\n      ","\n      ","\n    }\n  "],["\n    void applyPBRFactors() {\n      mrr \x3d mrrFactors;\n      emission \x3d emissionFactor;\n      occlusion \x3d 1.0;\n      ","\n      ",
"\n      ","\n      ","\n    }\n  "])),v?"vtc.uv \x3d vuv0;":"",f.hasMetalnessAndRoughnessTexture?f.supportsTextureAtlas?"vtc.size \x3d texMetallicRoughnessSize; applyMetallnessAndRoughness(vtc);":"applyMetallnessAndRoughness(vtc);":"",f.hasEmissionTexture?f.supportsTextureAtlas?"vtc.size \x3d texEmissionSize; applyEmission(vtc);":"applyEmission(vtc);":"",f.hasOcclusionTexture?f.supportsTextureAtlas?"vtc.size \x3d texOcclusionSize; applyOcclusion(vtc);":"applyOcclusion(vtc);":""))))}Object.defineProperty(d,
"__esModule",{value:!0});d.PBRSchematicMRRValues=l.vec3f32.fromValues(0,.6,.2);d.PhysicallyBasedRenderingParameters=f;(function(a){a.bindUniforms=function(a,b,c){void 0===c&&(c=!1);c||(a.setUniform3fv("mrrFactors",b.mrrFactors),a.setUniform3fv("emissionFactor",b.emissiveFactor))}})(f=d.PhysicallyBasedRenderingParameters||(d.PhysicallyBasedRenderingParameters={}));var h,r,c,a,m,u,D,w})},"esri/views/3d/webgl-engine/core/shaderLibrary/attributes/VertexTextureCoordinates.glsl":function(){define("require exports ../../../../../../core/tsSupport/makeTemplateObjectHelper ./TextureCoordinateAttribute.glsl ../util/TextureAtlasLookup.glsl ../../shaderModules/interfaces".split(" "),
function(z,d,t,l,q,b){Object.defineProperty(d,"__esModule",{value:!0});d.VertexTextureCoordinates=function(c,a){c.include(l.TextureCoordinateAttribute,a);c.fragment.code.add(b.glsl(f||(f=t(["\n  struct TextureLookupParameter {\n    vec2 uv;\n    ","\n  } vtc;\n  "],["\n  struct TextureLookupParameter {\n    vec2 uv;\n    ","\n  } vtc;\n  "])),a.supportsTextureAtlas?"vec2 size;":""));1===a.attributeTextureCoordinates&&c.fragment.code.add(b.glsl(h||(h=t(["\n      vec4 textureLookup(sampler2D tex, TextureLookupParameter params) {\n        return texture2D(tex, params.uv);\n      }\n    "],
["\n      vec4 textureLookup(sampler2D tex, TextureLookupParameter params) {\n        return texture2D(tex, params.uv);\n      }\n    "]))));2===a.attributeTextureCoordinates&&(c.include(q.TextureAtlasLookup),c.fragment.code.add(b.glsl(r||(r=t(["\n    vec4 textureLookup(sampler2D tex, TextureLookupParameter params) {\n        return textureAtlasLookup(tex, params.size, params.uv, vuvRegion);\n      }\n    "],["\n    vec4 textureLookup(sampler2D tex, TextureLookupParameter params) {\n        return textureAtlasLookup(tex, params.size, params.uv, vuvRegion);\n      }\n    "])))))};
var f,h,r})},"esri/views/3d/webgl-engine/core/shaderLibrary/attributes/TextureCoordinateAttribute.glsl":function(){define(["require","exports","../../../../../../core/tsSupport/makeTemplateObjectHelper","../../shaderModules/interfaces"],function(z,d,t,l){Object.defineProperty(d,"__esModule",{value:!0});d.TextureCoordinateAttribute=function(d,r){1===r.attributeTextureCoordinates&&(d.attributes.add("uv0","vec2"),d.varyings.add("vuv0","vec2"),d.vertex.code.add(l.glsl(q||(q=t(["\n      void forwardTextureCoordinates() {\n        vuv0 \x3d uv0;\n      }\n    "],
["\n      void forwardTextureCoordinates() {\n        vuv0 \x3d uv0;\n      }\n    "])))));2===r.attributeTextureCoordinates&&(d.attributes.add("uv0","vec2"),d.varyings.add("vuv0","vec2"),d.attributes.add("uvRegion","vec4"),d.varyings.add("vuvRegion","vec4"),d.vertex.code.add(l.glsl(b||(b=t(["\n      void forwardTextureCoordinates() {\n        vuv0 \x3d uv0;\n        vuvRegion \x3d uvRegion;\n      }\n    "],["\n      void forwardTextureCoordinates() {\n        vuv0 \x3d uv0;\n        vuvRegion \x3d uvRegion;\n      }\n    "])))));
0===r.attributeTextureCoordinates&&d.vertex.code.add(l.glsl(f||(f=t(["\n      void forwardTextureCoordinates() {}\n    "],["\n      void forwardTextureCoordinates() {}\n    "]))))};var q,b,f})},"esri/views/3d/webgl-engine/core/shaderLibrary/util/TextureAtlasLookup.glsl":function(){define(["require","exports","../../../../../../core/tsSupport/makeTemplateObjectHelper","../../shaderModules/interfaces"],function(z,d,t,l){Object.defineProperty(d,"__esModule",{value:!0});d.TextureAtlasLookup=function(b){b.extensions.add("GL_EXT_shader_texture_lod");
b.extensions.add("GL_OES_standard_derivatives");b.fragment.code.add(l.glsl(q||(q=t(["\n    #ifndef GL_EXT_shader_texture_lod\n      float calcMipMapLevel(const vec2 ddx, const vec2 ddy) {\n        float deltaMaxSqr \x3d max(dot(ddx, ddx), dot(ddy, ddy));\n        return max(0.0, 0.5 * log2(deltaMaxSqr));\n      }\n    #endif\n\n    vec4 textureAtlasLookup(sampler2D texture, vec2 textureSize, vec2 textureCoordinates, vec4 atlasRegion) {\n      //[umin, vmin, umax, vmax]\n      vec2 atlasScale \x3d atlasRegion.zw - atlasRegion.xy;\n      vec2 uvAtlas \x3d fract(textureCoordinates) * atlasScale + atlasRegion.xy;\n\n      // calculate derivative of continuous texture coordinate\n      // to avoid mipmapping artifacts caused by manual wrapping in shader\n      vec2 dUVdx \x3d dFdx(textureCoordinates) * atlasScale;\n      vec2 dUVdy \x3d dFdy(textureCoordinates) * atlasScale;\n\n      #ifdef GL_EXT_shader_texture_lod\n        return texture2DGradEXT(texture, uvAtlas, dUVdx, dUVdy);\n      #else\n        // use bias to compensate for difference in automatic vs desired mipmap level\n        vec2 dUVdxAuto \x3d dFdx(uvAtlas);\n        vec2 dUVdyAuto \x3d dFdy(uvAtlas);\n        float mipMapLevel \x3d calcMipMapLevel(dUVdx * textureSize, dUVdy * textureSize);\n        float autoMipMapLevel \x3d calcMipMapLevel(dUVdxAuto * textureSize, dUVdyAuto * textureSize);\n\n        return texture2D(texture, uvAtlas, mipMapLevel - autoMipMapLevel);\n      #endif\n    }\n  "],
["\n    #ifndef GL_EXT_shader_texture_lod\n      float calcMipMapLevel(const vec2 ddx, const vec2 ddy) {\n        float deltaMaxSqr \x3d max(dot(ddx, ddx), dot(ddy, ddy));\n        return max(0.0, 0.5 * log2(deltaMaxSqr));\n      }\n    #endif\n\n    vec4 textureAtlasLookup(sampler2D texture, vec2 textureSize, vec2 textureCoordinates, vec4 atlasRegion) {\n      //[umin, vmin, umax, vmax]\n      vec2 atlasScale \x3d atlasRegion.zw - atlasRegion.xy;\n      vec2 uvAtlas \x3d fract(textureCoordinates) * atlasScale + atlasRegion.xy;\n\n      // calculate derivative of continuous texture coordinate\n      // to avoid mipmapping artifacts caused by manual wrapping in shader\n      vec2 dUVdx \x3d dFdx(textureCoordinates) * atlasScale;\n      vec2 dUVdy \x3d dFdy(textureCoordinates) * atlasScale;\n\n      #ifdef GL_EXT_shader_texture_lod\n        return texture2DGradEXT(texture, uvAtlas, dUVdx, dUVdy);\n      #else\n        // use bias to compensate for difference in automatic vs desired mipmap level\n        vec2 dUVdxAuto \x3d dFdx(uvAtlas);\n        vec2 dUVdyAuto \x3d dFdy(uvAtlas);\n        float mipMapLevel \x3d calcMipMapLevel(dUVdx * textureSize, dUVdy * textureSize);\n        float autoMipMapLevel \x3d calcMipMapLevel(dUVdxAuto * textureSize, dUVdyAuto * textureSize);\n\n        return texture2D(texture, uvAtlas, mipMapLevel - autoMipMapLevel);\n      #endif\n    }\n  "]))))};
var q})},"esri/views/3d/webgl-engine/shaders/DefaultMaterial.glsl":function(){define("require exports ../../../../core/tsSupport/makeTemplateObjectHelper ../core/shaderLibrary/ForwardLinearDepth.glsl ../core/shaderLibrary/Offset.glsl ../core/shaderLibrary/Slice.glsl ../core/shaderLibrary/Transform.glsl ../core/shaderLibrary/attributes/InstancedDoublePrecision.glsl ../core/shaderLibrary/attributes/NormalAttribute.glsl ../core/shaderLibrary/attributes/PositionAttribute.glsl ../core/shaderLibrary/attributes/SymbolColor.glsl ../core/shaderLibrary/attributes/TextureCoordinateAttribute.glsl ../core/shaderLibrary/attributes/VertexColor.glsl ../core/shaderLibrary/attributes/VertexNormal.glsl ../core/shaderLibrary/attributes/VerticalOffset.glsl ../core/shaderLibrary/default/DefaultMaterialAuxiliaryPasses.glsl ../core/shaderLibrary/shading/ComputeNormalTexture.glsl ../core/shaderLibrary/shading/EvaluateAmbientOcclusion.glsl ../core/shaderLibrary/shading/EvaluateSceneLighting.glsl ../core/shaderLibrary/shading/Normals.glsl ../core/shaderLibrary/shading/PhysicallyBasedRendering.glsl ../core/shaderLibrary/shading/PhysicallyBasedRenderingParameters.glsl ../core/shaderLibrary/shading/ReadShadowMap.glsl ../core/shaderLibrary/shading/VisualVariables.glsl ../core/shaderLibrary/util/AlphaDiscard.glsl ../core/shaderLibrary/util/MixExternalColor.glsl ../core/shaderModules/interfaces ../core/shaderModules/ShaderBuilder".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u,D,w,v,E,C,J,K,G,I,x,N,O,P,S,R){Object.defineProperty(d,"__esModule",{value:!0});d.build=function(y){var d=new R.ShaderBuilder,F=d.vertex.code,H=d.fragment.code;d.vertex.uniforms.add("proj","mat4").add("view","mat4").add("camPos","vec3").add("localOrigin","vec3");d.include(c.PositionAttribute);d.varyings.add("vpos","vec3");d.include(N.VisualVariables,y);d.include(h.InstancedDoublePrecision,y);d.include(w.VerticalOffset,y);0===y.output&&(d.include(r.NormalAttribute,
y),d.include(f.Transform,{linearDepth:!1}),0===y.normalType&&y.offsetBackfaces&&d.include(q.Offset),d.include(E.ComputeNormalTexture,y),d.include(D.VertexNormal,y),y.instancedColor&&d.attributes.add("instanceColor","vec4"),d.varyings.add("localvpos","vec3"),d.include(m.TextureCoordinateAttribute,y),d.include(l.ForwardLinearDepth,y),d.include(a.SymbolColor,y),d.include(u.VertexColor,y),d.vertex.uniforms.add("externalColor","vec4"),d.varyings.add("vcolorExt","vec4"),F.add(S.glsl(U||(U=t(["\n      void main(void) {\n        forwardNormalizedVertexColor();\n        vcolorExt \x3d externalColor;\n        ",
"\n        vcolorExt *\x3d vvColor();\n        vcolorExt *\x3d getSymbolColor();\n        forwardColorMixMode();\n\n        if (vcolorExt.a \x3c ",") {\n          gl_Position \x3d vec4(1e38, 1e38, 1e38, 1.0);\n        }\n        else {\n          vpos \x3d calculateVPos();\n          localvpos \x3d vpos - view[3].xyz;\n          vpos \x3d subtractOrigin(vpos);\n          ","\n          vpos \x3d addVerticalOffset(vpos, localOrigin);\n          ","\n          gl_Position \x3d transformPosition(proj, view, vpos);\n          ",
"\n        }\n        forwardLinearDepth();\n        forwardTextureCoordinates();\n      }\n    "],["\n      void main(void) {\n        forwardNormalizedVertexColor();\n        vcolorExt \x3d externalColor;\n        ","\n        vcolorExt *\x3d vvColor();\n        vcolorExt *\x3d getSymbolColor();\n        forwardColorMixMode();\n\n        if (vcolorExt.a \x3c ",") {\n          gl_Position \x3d vec4(1e38, 1e38, 1e38, 1.0);\n        }\n        else {\n          vpos \x3d calculateVPos();\n          localvpos \x3d vpos - view[3].xyz;\n          vpos \x3d subtractOrigin(vpos);\n          ",
"\n          vpos \x3d addVerticalOffset(vpos, localOrigin);\n          ","\n          gl_Position \x3d transformPosition(proj, view, vpos);\n          ","\n        }\n        forwardLinearDepth();\n        forwardTextureCoordinates();\n      }\n    "])),y.instancedColor?"vcolorExt *\x3d instanceColor;":"",S.glsl.float(O.symbolAlphaCutoff),0===y.normalType?S.glsl(Q||(Q=t(["\n          vNormalWorld \x3d dpNormal(vvLocalNormal(normalModel()));"],["\n          vNormalWorld \x3d dpNormal(vvLocalNormal(normalModel()));"]))):
"",y.vertexTangets?"transformVertexTangent(mat3(modelNormal));":"",0===y.normalType&&y.offsetBackfaces?"gl_Position \x3d offsetBackfacingClipPosition(gl_Position, vpos, vNormalWorld, camPos);":"")),d.include(b.Slice,y),d.include(J.EvaluateSceneLighting,y),d.include(C.EvaluateAmbientOcclusion,y),d.include(O.DiscardOrAdjustAlpha,y),y.receiveShadows&&d.include(x.ReadShadowMap,y),d.fragment.uniforms.add("camPos","vec3").add("localOrigin","vec3").add("ambient","vec3").add("diffuse","vec3").add("opacity",
"float").add("layerOpacity","float"),y.hasColorTexture&&d.fragment.uniforms.add("tex","sampler2D"),d.include(I.PhysicallyBasedRenderingParameters,y),d.include(G.PhysicallyBasedRendering,y),d.include(P.MixExternalColor,{stages:1}),d.include(K.Normals,y),H.add(S.glsl(n||(n=t(["\n      void main() {\n        discardBySlice(vpos);\n        ","\n        shadingParams.viewDirection \x3d normalize(vpos - camPos);\n        ","\n        ","\n        float ssao \x3d evaluateAmbientOcclusionInverse();\n        ssao *\x3d getBakedOcclusion();\n\n        float additionalAmbientScale \x3d _oldHeuristicLighting(vpos + localOrigin);\n        vec3 additionalLight \x3d ssao * lightingMainIntensity * additionalAmbientScale * ambientBoostFactor * lightingGlobalFactor;\n        ",
"\n        vec3 matColor \x3d max(ambient, diffuse);\n        ","\n        ","\n        ","\n        ","\n        gl_FragColor \x3d highlightSlice(vec4(shadedColor, opacity_), vpos);\n      }\n    "],["\n      void main() {\n        discardBySlice(vpos);\n        ","\n        shadingParams.viewDirection \x3d normalize(vpos - camPos);\n        ","\n        ","\n        float ssao \x3d evaluateAmbientOcclusionInverse();\n        ssao *\x3d getBakedOcclusion();\n\n        float additionalAmbientScale \x3d _oldHeuristicLighting(vpos + localOrigin);\n        vec3 additionalLight \x3d ssao * lightingMainIntensity * additionalAmbientScale * ambientBoostFactor * lightingGlobalFactor;\n        ",
"\n        vec3 matColor \x3d max(ambient, diffuse);\n        ","\n        ","\n        ","\n        ","\n        gl_FragColor \x3d highlightSlice(vec4(shadedColor, opacity_), vpos);\n      }\n    "])),y.hasColorTexture?S.glsl(V||(V=t(["\n        vec4 texColor \x3d texture2D(tex, vuv0);\n        ","\n        discardOrAdjustAlpha(texColor);"],["\n        vec4 texColor \x3d texture2D(tex, vuv0);\n        ","\n        discardOrAdjustAlpha(texColor);"])),y.textureAlphaPremultiplied?"texColor.rgb /\x3d texColor.a;":
""):S.glsl(Y||(Y=t(["vec4 texColor \x3d vec4(1.0);"],["vec4 texColor \x3d vec4(1.0);"]))),3===y.normalType?S.glsl(T||(T=t(["\n        vec3 normal \x3d screenDerivativeNormal(localvpos);"],["\n        vec3 normal \x3d screenDerivativeNormal(localvpos);"]))):S.glsl(aa||(aa=t(["\n        shadingParams.normalView \x3d vNormalWorld;\n        vec3 normal \x3d shadingNormal(shadingParams);"],["\n        shadingParams.normalView \x3d vNormalWorld;\n        vec3 normal \x3d shadingNormal(shadingParams);"]))),
1===y.pbrMode?"applyPBRFactors();":"",y.receiveShadows?"float shadow \x3d readShadowMap(vpos, linearDepth);":0===y.viewingMode?"float shadow \x3d lightingGlobalFactor * (1.0 - additionalAmbientScale);":"float shadow \x3d 0.0;",y.attributeColor?S.glsl(W||(W=t(["\n        vec3 albedo_ \x3d mixExternalColor(vColor.rgb * matColor, texColor.rgb, vcolorExt.rgb, int(colorMixMode));\n        float opacity_ \x3d layerOpacity * mixExternalOpacity(vColor.a * opacity, texColor.a, vcolorExt.a, int(colorMixMode));"],
["\n        vec3 albedo_ \x3d mixExternalColor(vColor.rgb * matColor, texColor.rgb, vcolorExt.rgb, int(colorMixMode));\n        float opacity_ \x3d layerOpacity * mixExternalOpacity(vColor.a * opacity, texColor.a, vcolorExt.a, int(colorMixMode));"]))):S.glsl(p||(p=t(["\n        vec3 albedo_ \x3d mixExternalColor(matColor, texColor.rgb, vcolorExt.rgb, int(colorMixMode));\n        float opacity_ \x3d layerOpacity * mixExternalOpacity(opacity, texColor.a, vcolorExt.a, int(colorMixMode));\n        "],
["\n        vec3 albedo_ \x3d mixExternalColor(matColor, texColor.rgb, vcolorExt.rgb, int(colorMixMode));\n        float opacity_ \x3d layerOpacity * mixExternalOpacity(opacity, texColor.a, vcolorExt.a, int(colorMixMode));\n        "]))),y.hasNormalTexture?S.glsl(L||(L=t(["\n              mat3 tangentSpace \x3d ","\n              vec3 shadedNormal \x3d computeTextureNormal(tangentSpace, vuv0);"],["\n              mat3 tangentSpace \x3d ","\n              vec3 shadedNormal \x3d computeTextureNormal(tangentSpace, vuv0);"])),
y.vertexTangets?"computeTangentSpace(normal);":"computeTangentSpace(normal, vpos, vuv0);"):"vec3 shadedNormal \x3d normal;",1===y.pbrMode||2===y.pbrMode?0===y.viewingMode?S.glsl(A||(A=t(["vec3 normalGround \x3d normalize(vpos + localOrigin);"],["vec3 normalGround \x3d normalize(vpos + localOrigin);"]))):S.glsl(k||(k=t(["vec3 normalGround \x3d vec3(0.0, 0.0, 1.0);"],["vec3 normalGround \x3d vec3(0.0, 0.0, 1.0);"]))):S.glsl(e||(e=t([""],[""]))),1===y.pbrMode||2===y.pbrMode?S.glsl(g||(g=t(["\n            float additionalAmbientIrradiance \x3d additionalAmbientIrradianceFactor * lightingMainIntensity[2];\n            vec3 shadedColor \x3d evaluateSceneLightingPBR(shadedNormal, albedo_, shadow, 1.0 - ssao, additionalLight, shadingParams.viewDirection, normalGround, mrr, emission, additionalAmbientIrradiance);"],
["\n            float additionalAmbientIrradiance \x3d additionalAmbientIrradianceFactor * lightingMainIntensity[2];\n            vec3 shadedColor \x3d evaluateSceneLightingPBR(shadedNormal, albedo_, shadow, 1.0 - ssao, additionalLight, shadingParams.viewDirection, normalGround, mrr, emission, additionalAmbientIrradiance);"]))):"vec3 shadedColor \x3d evaluateSceneLighting(shadedNormal, albedo_, shadow, 1.0 - ssao, additionalLight);")));d.include(v.DefaultMaterialAuxiliaryPasses,y);return d};var Q,
U,V,Y,T,aa,W,p,L,A,k,e,g,n})},"esri/views/3d/webgl-engine/core/shaderLibrary/Offset.glsl":function(){define(["require","exports","../../../../../core/tsSupport/makeTemplateObjectHelper","../shaderModules/interfaces"],function(z,d,t,l){Object.defineProperty(d,"__esModule",{value:!0});d.Offset=function(b){b.vertex.code.add(l.glsl(q||(q=t(["\n    vec4 offsetBackfacingClipPosition(vec4 posClip, vec3 posWorld, vec3 normalWorld, vec3 camPosWorld) {\n      vec3 camToVert \x3d posWorld - camPosWorld;\n\n      bool isBackface \x3d dot(camToVert, normalWorld) \x3e 0.0;\n      if (isBackface) {\n        posClip.z +\x3d 0.0000003 * posClip.w;\n      }\n      return posClip;\n    }\n  "],
["\n    vec4 offsetBackfacingClipPosition(vec4 posClip, vec3 posWorld, vec3 normalWorld, vec3 camPosWorld) {\n      vec3 camToVert \x3d posWorld - camPosWorld;\n\n      bool isBackface \x3d dot(camToVert, normalWorld) \x3e 0.0;\n      if (isBackface) {\n        posClip.z +\x3d 0.0000003 * posClip.w;\n      }\n      return posClip;\n    }\n  "]))))};var q})},"esri/views/3d/webgl-engine/core/shaderLibrary/attributes/NormalAttribute.glsl":function(){define(["require","exports","../../../../../../core/tsSupport/makeTemplateObjectHelper",
"../util/DecodeNormal.glsl","../../shaderModules/interfaces"],function(z,d,t,l,q){Object.defineProperty(d,"__esModule",{value:!0});d.NormalAttribute=function(d,c){0===c.normalType&&(d.attributes.add("normal","vec3"),d.vertex.code.add(q.glsl(b||(b=t(["\n      vec3 normalModel() {\n        return normal;\n      }\n    "],["\n      vec3 normalModel() {\n        return normal;\n      }\n    "])))));1===c.normalType&&(d.include(l.DecodeNormal),d.attributes.add("normalCompressed","vec2"),d.vertex.code.add(q.glsl(f||
(f=t(["\n      vec3 normalModel() {\n        return decodeNormal(normalCompressed);\n      }\n    "],["\n      vec3 normalModel() {\n        return decodeNormal(normalCompressed);\n      }\n    "])))));3===c.normalType&&(d.extensions.add("GL_OES_standard_derivatives"),d.fragment.code.add(q.glsl(h||(h=t(["\n      vec3 screenDerivativeNormal(vec3 positionView) {\n        return normalize(cross(dFdx(positionView), dFdy(positionView)));\n      }\n    "],["\n      vec3 screenDerivativeNormal(vec3 positionView) {\n        return normalize(cross(dFdx(positionView), dFdy(positionView)));\n      }\n    "])))))};
var b,f,h})},"esri/views/3d/webgl-engine/core/shaderLibrary/util/DecodeNormal.glsl":function(){define(["require","exports","../../../../../../core/tsSupport/makeTemplateObjectHelper","../../shaderModules/interfaces"],function(z,d,t,l){Object.defineProperty(d,"__esModule",{value:!0});d.DecodeNormal=function(b){var d=l.glsl(q||(q=t(["\n    vec3 decodeNormal(vec2 f) {\n      float z \x3d 1.0 - abs(f.x) - abs(f.y);\n      return vec3(f + sign(f) * min(z, 0.0), z);\n    }\n  "],["\n    vec3 decodeNormal(vec2 f) {\n      float z \x3d 1.0 - abs(f.x) - abs(f.y);\n      return vec3(f + sign(f) * min(z, 0.0), z);\n    }\n  "])));
b.fragment.code.add(d);b.vertex.code.add(d)};var q})},"esri/views/3d/webgl-engine/core/shaderLibrary/attributes/PositionAttribute.glsl":function(){define(["require","exports","../../../../../../core/tsSupport/makeTemplateObjectHelper","../../shaderModules/interfaces"],function(z,d,t,l){Object.defineProperty(d,"__esModule",{value:!0});d.PositionAttribute=function(b){b.attributes.add("position","vec3");b.vertex.code.add(l.glsl(q||(q=t(["\n    vec3 positionModel() { return position; }\n  "],["\n    vec3 positionModel() { return position; }\n  "]))))};
var q})},"esri/views/3d/webgl-engine/core/shaderLibrary/attributes/SymbolColor.glsl":function(){define(["require","exports","../../../../../../core/tsSupport/makeTemplateObjectHelper","../../../collections/Component/Material/shader/DecodeSymbolColor.glsl","../../shaderModules/interfaces"],function(z,d,t,l,q){Object.defineProperty(d,"__esModule",{value:!0});d.SymbolColor=function(d,r){r.symbolColor?(d.include(l.DecodeSymbolColor),d.attributes.add("symbolColor","vec4"),d.varyings.add("colorMixMode",
"mediump float")):d.fragment.uniforms.add("colorMixMode","int");r.symbolColor?d.vertex.code.add(q.glsl(b||(b=t(["\n    int symbolColorMixMode;\n\n    vec4 getSymbolColor() {\n      return decodeSymbolColor(symbolColor, symbolColorMixMode) * 0.003921568627451;\n    }\n\n    void forwardColorMixMode() {\n      colorMixMode \x3d float(symbolColorMixMode) + 0.5;\n    }\n  "],["\n    int symbolColorMixMode;\n\n    vec4 getSymbolColor() {\n      return decodeSymbolColor(symbolColor, symbolColorMixMode) * 0.003921568627451;\n    }\n\n    void forwardColorMixMode() {\n      colorMixMode \x3d float(symbolColorMixMode) + 0.5;\n    }\n  "])))):
d.vertex.code.add(q.glsl(f||(f=t(["\n    vec4 getSymbolColor() { return vec4(1.0); }\n    void forwardColorMixMode() {}\n    "],["\n    vec4 getSymbolColor() { return vec4(1.0); }\n    void forwardColorMixMode() {}\n    "]))))};var b,f})},"esri/views/3d/webgl-engine/collections/Component/Material/shader/DecodeSymbolColor.glsl":function(){define(["require","exports","../../../../../../../core/tsSupport/makeTemplateObjectHelper","../../../../core/shaderModules/interfaces"],function(z,d,t,l){Object.defineProperty(d,
"__esModule",{value:!0});d.DecodeSymbolColor=function(b){b.vertex.code.add(l.glsl(q||(q=t(["\n    vec4 decodeSymbolColor(vec4 symbolColor, out int colorMixMode) {\n      float symbolAlpha \x3d 0.0;\n\n      const float maxTint \x3d 85.0;\n      const float maxReplace \x3d 170.0;\n      const float scaleAlpha \x3d 3.0;\n\n      if (symbolColor.a \x3e maxReplace) {\n        colorMixMode \x3d ",";\n        symbolAlpha \x3d scaleAlpha * (symbolColor.a - maxReplace);\n      } else if (symbolColor.a \x3e maxTint) {\n        colorMixMode \x3d ",
";\n        symbolAlpha \x3d scaleAlpha * (symbolColor.a - maxTint);\n      } else if (symbolColor.a \x3e 0.0) {\n        colorMixMode \x3d ",";\n        symbolAlpha \x3d scaleAlpha * symbolColor.a;\n      } else {\n        colorMixMode \x3d ",";\n        symbolAlpha \x3d 0.0;\n      }\n\n      return vec4(symbolColor.r, symbolColor.g, symbolColor.b, symbolAlpha);\n    }\n  "],["\n    vec4 decodeSymbolColor(vec4 symbolColor, out int colorMixMode) {\n      float symbolAlpha \x3d 0.0;\n\n      const float maxTint \x3d 85.0;\n      const float maxReplace \x3d 170.0;\n      const float scaleAlpha \x3d 3.0;\n\n      if (symbolColor.a \x3e maxReplace) {\n        colorMixMode \x3d ",
";\n        symbolAlpha \x3d scaleAlpha * (symbolColor.a - maxReplace);\n      } else if (symbolColor.a \x3e maxTint) {\n        colorMixMode \x3d ",";\n        symbolAlpha \x3d scaleAlpha * (symbolColor.a - maxTint);\n      } else if (symbolColor.a \x3e 0.0) {\n        colorMixMode \x3d ",";\n        symbolAlpha \x3d scaleAlpha * symbolColor.a;\n      } else {\n        colorMixMode \x3d ",";\n        symbolAlpha \x3d 0.0;\n      }\n\n      return vec4(symbolColor.r, symbolColor.g, symbolColor.b, symbolAlpha);\n    }\n  "])),
l.glsl.int(1),l.glsl.int(3),l.glsl.int(4),l.glsl.int(1)))};var q})},"esri/views/3d/webgl-engine/core/shaderLibrary/attributes/VertexColor.glsl":function(){define(["require","exports","../../../../../../core/tsSupport/makeTemplateObjectHelper","../../shaderModules/interfaces"],function(z,d,t,l){Object.defineProperty(d,"__esModule",{value:!0});d.VertexColor=function(d,r){r.attributeColor?(d.attributes.add("color","vec4"),d.varyings.add("vColor","vec4"),d.vertex.code.add(l.glsl(q||(q=t(["\n      void forwardVertexColor() { vColor \x3d color; }\n    "],
["\n      void forwardVertexColor() { vColor \x3d color; }\n    "])))),d.vertex.code.add(l.glsl(b||(b=t(["\n      void forwardNormalizedVertexColor() { vColor \x3d color * 0.003921568627451; }\n    "],["\n      void forwardNormalizedVertexColor() { vColor \x3d color * 0.003921568627451; }\n    "]))))):d.vertex.code.add(l.glsl(f||(f=t(["\n      void forwardVertexColor() {}\n      void forwardNormalizedVertexColor() {}\n    "],["\n      void forwardVertexColor() {}\n      void forwardNormalizedVertexColor() {}\n    "]))))};
var q,b,f})},"esri/views/3d/webgl-engine/core/shaderLibrary/attributes/VertexNormal.glsl":function(){define("require exports ../../../../../../core/tsSupport/makeTemplateObjectHelper ./NormalAttribute.glsl ./VertexPosition.glsl ../../shaderModules/interfaces".split(" "),function(z,d,t,l,q,b){function f(d,f){0===f.normalType||1===f.normalType?(d.include(l.NormalAttribute,f),d.varyings.add("vNormalWorld","vec3"),d.varyings.add("vNormalView","vec3"),d.vertex.uniforms.add("uTransformNormal_GlobalFromModel",
"mat3"),d.vertex.uniforms.add("uTransformNormal_ViewFromGlobal","mat3"),d.vertex.code.add(b.glsl(h||(h=t(["\n      void forwardNormal() {\n        vNormalWorld \x3d uTransformNormal_GlobalFromModel * normalModel();\n        vNormalView \x3d uTransformNormal_ViewFromGlobal * vNormalWorld;\n      }\n    "],["\n      void forwardNormal() {\n        vNormalWorld \x3d uTransformNormal_GlobalFromModel * normalModel();\n        vNormalView \x3d uTransformNormal_ViewFromGlobal * vNormalWorld;\n      }\n    "]))))):
2===f.normalType?(d.include(q.VertexPosition,f),d.varyings.add("vNormalWorld","vec3"),d.vertex.code.add(b.glsl(a||(a=t(["\n    void forwardNormal() {\n      vNormalWorld \x3d ","\n    }\n    "],["\n    void forwardNormal() {\n      vNormalWorld \x3d ","\n    }\n    "])),0===f.viewingMode?b.glsl(r||(r=t(["normalize(vPositionWorldCameraRelative);"],["normalize(vPositionWorldCameraRelative);"]))):b.glsl(c||(c=t(["vec3(0.0, 0.0, 1.0);"],["vec3(0.0, 0.0, 1.0);"])))))):d.vertex.code.add(b.glsl(m||(m=t(["\n      void forwardNormal() {}\n    "],
["\n      void forwardNormal() {}\n    "]))))}Object.defineProperty(d,"__esModule",{value:!0});d.VertexNormal=f;(function(a){a.bindUniforms=function(a,b){a.setUniformMatrix4fv("viewNormal",b.viewInvTransp)}})(f=d.VertexNormal||(d.VertexNormal={}));var h,r,c,a,m})},"esri/views/3d/webgl-engine/core/shaderLibrary/attributes/VertexPosition.glsl":function(){define("require exports ../../../../../../core/tsSupport/makeTemplateObjectHelper ../../../../../../core/libs/gl-matrix-2/mat3f64 ../../../../../../core/libs/gl-matrix-2/mat4f64 ../../../../../../core/libs/gl-matrix-2/vec3f64 ./PositionAttribute.glsl ../util/DoublePrecision.glsl ../../shaderModules/interfaces".split(" "),
function(z,d,t,l,q,b,f,h,r){function c(b,c){b.include(f.PositionAttribute);b.include(h.DoublePrecision,c);b.varyings.add("vPositionWorldCameraRelative","vec3");b.varyings.add("vPosition_view","vec3");b.vertex.uniforms.add("uTransform_WorldFromModel_RS","mat3");b.vertex.uniforms.add("uTransform_WorldFromModel_TH","vec3");b.vertex.uniforms.add("uTransform_WorldFromModel_TL","vec3");b.vertex.uniforms.add("uTransform_WorldFromView_TH","vec3");b.vertex.uniforms.add("uTransform_WorldFromView_TL","vec3");
b.vertex.uniforms.add("uTransform_ViewFromCameraRelative_RS","mat3");b.vertex.uniforms.add("uTransform_ProjFromView","mat4");b.vertex.code.add(r.glsl(a||(a=t(["\n    // compute position in world space orientation, but relative to the camera position\n    vec3 positionWorldCameraRelative() {\n      vec3 rotatedModelPosition \x3d uTransform_WorldFromModel_RS * positionModel();\n\n      vec3 transform_CameraRelativeFromModel \x3d dpAdd(\n        uTransform_WorldFromModel_TL,\n        uTransform_WorldFromModel_TH,\n        -uTransform_WorldFromView_TL,\n        -uTransform_WorldFromView_TH\n      );\n\n      return transform_CameraRelativeFromModel + rotatedModelPosition;\n    }\n\n    // position in view space, that is relative to the camera position and orientation\n    vec3 position_view() {\n      return uTransform_ViewFromCameraRelative_RS * positionWorldCameraRelative();\n    }\n\n    // compute gl_Position and forward related varyings to fragment shader\n    void forwardPosition() {\n      vPositionWorldCameraRelative \x3d positionWorldCameraRelative();\n      vPosition_view \x3d position_view();\n      gl_Position \x3d uTransform_ProjFromView * vec4(vPosition_view, 1.0);\n    }\n\n    vec3 positionWorld() {\n      return uTransform_WorldFromView_TL + vPositionWorldCameraRelative;\n    }\n  "],
["\n    // compute position in world space orientation, but relative to the camera position\n    vec3 positionWorldCameraRelative() {\n      vec3 rotatedModelPosition \x3d uTransform_WorldFromModel_RS * positionModel();\n\n      vec3 transform_CameraRelativeFromModel \x3d dpAdd(\n        uTransform_WorldFromModel_TL,\n        uTransform_WorldFromModel_TH,\n        -uTransform_WorldFromView_TL,\n        -uTransform_WorldFromView_TH\n      );\n\n      return transform_CameraRelativeFromModel + rotatedModelPosition;\n    }\n\n    // position in view space, that is relative to the camera position and orientation\n    vec3 position_view() {\n      return uTransform_ViewFromCameraRelative_RS * positionWorldCameraRelative();\n    }\n\n    // compute gl_Position and forward related varyings to fragment shader\n    void forwardPosition() {\n      vPositionWorldCameraRelative \x3d positionWorldCameraRelative();\n      vPosition_view \x3d position_view();\n      gl_Position \x3d uTransform_ProjFromView * vec4(vPosition_view, 1.0);\n    }\n\n    vec3 positionWorld() {\n      return uTransform_WorldFromView_TL + vPositionWorldCameraRelative;\n    }\n  "]))));
b.fragment.uniforms.add("uTransform_WorldFromView_TL","vec3");b.fragment.code.add(r.glsl(m||(m=t(["\n    vec3 positionWorld() {\n      return uTransform_WorldFromView_TL + vPositionWorldCameraRelative;\n    }\n  "],["\n    vec3 positionWorld() {\n      return uTransform_WorldFromView_TL + vPositionWorldCameraRelative;\n    }\n  "]))))}Object.defineProperty(d,"__esModule",{value:!0});d.VertexPosition=c;(function(a){var c=function(){return function(){this.worldFromModel_RS=l.mat3f64.create();this.worldFromModel_TH=
b.vec3f64.create();this.worldFromModel_TL=b.vec3f64.create()}}();a.ModelTransform=c;c=function(){return function(){this.worldFromView_TH=b.vec3f64.create();this.worldFromView_TL=b.vec3f64.create();this.viewFromCameraRelative_RS=l.mat3f64.create();this.projFromView=q.mat4f64.create()}}();a.ViewProjectionTransform=c;a.bindModelTransform=function(a,b){a.setUniformMatrix3fv("uTransform_WorldFromModel_RS",b.worldFromModel_RS);a.setUniform3fv("uTransform_WorldFromModel_TH",b.worldFromModel_TH);a.setUniform3fv("uTransform_WorldFromModel_TL",
b.worldFromModel_TL)};a.bindViewProjTransform=function(a,b){a.setUniform3fv("uTransform_WorldFromView_TH",b.worldFromView_TH);a.setUniform3fv("uTransform_WorldFromView_TL",b.worldFromView_TL);a.setUniformMatrix4fv("uTransform_ProjFromView",b.projFromView);a.setUniformMatrix3fv("uTransform_ViewFromCameraRelative_RS",b.viewFromCameraRelative_RS)}})(c=d.VertexPosition||(d.VertexPosition={}));var a,m})},"esri/views/3d/webgl-engine/core/shaderLibrary/default/DefaultMaterialAuxiliaryPasses.glsl":function(){define("require exports ../../../../../../core/tsSupport/makeTemplateObjectHelper ../Slice.glsl ../Transform.glsl ../attributes/NormalAttribute.glsl ../attributes/TextureCoordinateAttribute.glsl ../attributes/VertexNormal.glsl ../output/OutputDepth.glsl ../output/OutputHighlight.glsl ../shading/VisualVariables.glsl ../util/AlphaDiscard.glsl ../../shaderModules/interfaces".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u){Object.defineProperty(d,"__esModule",{value:!0});d.DefaultMaterialAuxiliaryPasses=function(d,z){var R=d.vertex.code,P=d.fragment.code;if(1===z.output||3===z.output)d.include(q.Transform,{linearDepth:!0}),d.include(f.TextureCoordinateAttribute,z),d.include(a.VisualVariables,z),d.include(r.OutputDepth,z),d.include(l.Slice,z),d.vertex.uniforms.add("nearFar","vec2"),d.varyings.add("depth","float"),z.hasColorTexture&&d.fragment.uniforms.add("tex","sampler2D"),R.add(u.glsl(D||
(D=t(["\n      void main(void) {\n        vpos \x3d calculateVPos();\n        vpos \x3d subtractOrigin(vpos);\n        vpos \x3d addVerticalOffset(vpos, localOrigin);\n        gl_Position \x3d transformPositionWithDepth(proj, view, vpos, nearFar, depth);\n        forwardTextureCoordinates();\n      }\n    "],["\n      void main(void) {\n        vpos \x3d calculateVPos();\n        vpos \x3d subtractOrigin(vpos);\n        vpos \x3d addVerticalOffset(vpos, localOrigin);\n        gl_Position \x3d transformPositionWithDepth(proj, view, vpos, nearFar, depth);\n        forwardTextureCoordinates();\n      }\n    "])))),
d.include(m.DiscardOrAdjustAlpha,z),P.add(u.glsl(v||(v=t(["\n      void main(void) {\n        discardBySlice(vpos);\n        ","\n        outputDepth(depth);\n      }\n    "],["\n      void main(void) {\n        discardBySlice(vpos);\n        ","\n        outputDepth(depth);\n      }\n    "])),z.hasColorTexture?u.glsl(w||(w=t(["\n        vec4 texColor \x3d texture2D(tex, vuv0);\n        discardOrAdjustAlpha(texColor);"],["\n        vec4 texColor \x3d texture2D(tex, vuv0);\n        discardOrAdjustAlpha(texColor);"]))):
""));2===z.output&&(d.include(q.Transform,{linearDepth:!1}),d.include(b.NormalAttribute,z),d.include(h.VertexNormal,z),d.include(f.TextureCoordinateAttribute,z),d.include(a.VisualVariables,z),z.hasColorTexture&&d.fragment.uniforms.add("tex","sampler2D"),d.vertex.uniforms.add("viewNormal","mat4"),d.varyings.add("vPositionView","vec3"),R.add(u.glsl(C||(C=t(["\n      void main(void) {\n        vpos \x3d calculateVPos();\n        vpos \x3d subtractOrigin(vpos);\n        ","\n        vpos \x3d addVerticalOffset(vpos, localOrigin);\n        gl_Position \x3d transformPosition(proj, view, vpos);\n        forwardTextureCoordinates();\n      }\n    "],
["\n      void main(void) {\n        vpos \x3d calculateVPos();\n        vpos \x3d subtractOrigin(vpos);\n        ","\n        vpos \x3d addVerticalOffset(vpos, localOrigin);\n        gl_Position \x3d transformPosition(proj, view, vpos);\n        forwardTextureCoordinates();\n      }\n    "])),0===z.normalType?u.glsl(E||(E=t(["\n        vNormalWorld \x3d dpNormalView(vvLocalNormal(normalModel()));"],["\n        vNormalWorld \x3d dpNormalView(vvLocalNormal(normalModel()));"]))):"")),d.include(l.Slice,
z),d.include(m.DiscardOrAdjustAlpha,z),P.add(u.glsl(I||(I=t(["\n      void main() {\n        discardBySlice(vpos);\n        ","\n\n        ","\n        gl_FragColor \x3d vec4(vec3(0.5) + 0.5 * normal, 1.0);\n      }\n    "],["\n      void main() {\n        discardBySlice(vpos);\n        ","\n\n        ","\n        gl_FragColor \x3d vec4(vec3(0.5) + 0.5 * normal, 1.0);\n      }\n    "])),z.hasColorTexture?u.glsl(J||(J=t(["\n        vec4 texColor \x3d texture2D(tex, vuv0);\n        discardOrAdjustAlpha(texColor);"],
["\n        vec4 texColor \x3d texture2D(tex, vuv0);\n        discardOrAdjustAlpha(texColor);"]))):"",3===z.normalType?u.glsl(K||(K=t(["\n            vec3 normal \x3d screenDerivativeNormal(vPositionView);"],["\n            vec3 normal \x3d screenDerivativeNormal(vPositionView);"]))):u.glsl(G||(G=t(["\n            vec3 normal \x3d normalize(vNormalWorld);\n            if (gl_FrontFacing \x3d\x3d false) normal \x3d -normal;"],["\n            vec3 normal \x3d normalize(vNormalWorld);\n            if (gl_FrontFacing \x3d\x3d false) normal \x3d -normal;"]))))));
4===z.output&&(d.include(q.Transform,{linearDepth:!1}),d.include(f.TextureCoordinateAttribute,z),d.include(a.VisualVariables,z),z.hasColorTexture&&d.fragment.uniforms.add("tex","sampler2D"),R.add(u.glsl(x||(x=t(["\n      void main(void) {\n        vpos \x3d calculateVPos();\n        vpos \x3d subtractOrigin(vpos);\n        vpos \x3d addVerticalOffset(vpos, localOrigin);\n        gl_Position \x3d transformPosition(proj, view, vpos);\n        forwardTextureCoordinates();\n      }\n    "],["\n      void main(void) {\n        vpos \x3d calculateVPos();\n        vpos \x3d subtractOrigin(vpos);\n        vpos \x3d addVerticalOffset(vpos, localOrigin);\n        gl_Position \x3d transformPosition(proj, view, vpos);\n        forwardTextureCoordinates();\n      }\n    "])))),
d.include(l.Slice,z),d.include(m.DiscardOrAdjustAlpha,z),d.include(c.OutputHighlight),P.add(u.glsl(O||(O=t(["\n      void main() {\n        discardBySlice(vpos);\n        ","\n        outputHighlight();\n      }\n    "],["\n      void main() {\n        discardBySlice(vpos);\n        ","\n        outputHighlight();\n      }\n    "])),z.hasColorTexture?u.glsl(N||(N=t(["\n        vec4 texColor \x3d texture2D(tex, vuv0);\n        discardOrAdjustAlpha(texColor);"],["\n        vec4 texColor \x3d texture2D(tex, vuv0);\n        discardOrAdjustAlpha(texColor);"]))):
"")))};var D,w,v,E,C,J,K,G,I,x,N,O})},"esri/views/3d/webgl-engine/core/shaderLibrary/output/OutputDepth.glsl":function(){define(["require","exports","../../../../../../core/tsSupport/makeTemplateObjectHelper","../util/RgbaFloatEncoding.glsl","../../shaderModules/interfaces"],function(z,d,t,l,q){Object.defineProperty(d,"__esModule",{value:!0});d.OutputDepth=function(d,r){d.include(l.RgbaFloatEncoding);3===r.output?(d.extensions.add("GL_OES_standard_derivatives"),d.fragment.code.add(q.glsl(b||(b=t(["\n      float _calculateFragDepth(const in float depth) {\n        // calc polygon offset\n        const float SLOPE_SCALE \x3d 2.0;\n        const float BIAS \x3d 2.0 * .000015259;    // 1 / (2^16 - 1)\n        float m \x3d max(abs(dFdx(depth)), abs(dFdy(depth)));\n        float result \x3d depth + SLOPE_SCALE * m + BIAS;\n        return clamp(result, .0, .999999);\n      }\n\n      void outputDepth(float _linearDepth) {\n        gl_FragColor \x3d float2rgba(_calculateFragDepth(_linearDepth));\n      }\n    "],
["\n      float _calculateFragDepth(const in float depth) {\n        // calc polygon offset\n        const float SLOPE_SCALE \x3d 2.0;\n        const float BIAS \x3d 2.0 * .000015259;    // 1 / (2^16 - 1)\n        float m \x3d max(abs(dFdx(depth)), abs(dFdy(depth)));\n        float result \x3d depth + SLOPE_SCALE * m + BIAS;\n        return clamp(result, .0, .999999);\n      }\n\n      void outputDepth(float _linearDepth) {\n        gl_FragColor \x3d float2rgba(_calculateFragDepth(_linearDepth));\n      }\n    "]))))):
1===r.output&&d.fragment.code.add(q.glsl(f||(f=t(["\n      void outputDepth(float _linearDepth) {\n        gl_FragColor \x3d float2rgba(_linearDepth);\n      }\n    "],["\n      void outputDepth(float _linearDepth) {\n        gl_FragColor \x3d float2rgba(_linearDepth);\n      }\n    "]))))};var b,f})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/ComputeNormalTexture.glsl":function(){define(["require","exports","../../../../../../core/tsSupport/makeTemplateObjectHelper","../attributes/VertexTextureCoordinates.glsl",
"../../shaderModules/interfaces"],function(z,d,t,l,q){Object.defineProperty(d,"__esModule",{value:!0});d.ComputeNormalTexture=function(a,d){var m=a.fragment;m.uniforms.add("normalTexture","sampler2D");m.uniforms.add("normalTextureSize","vec2");d.vertexTangets?(a.attributes.add("tangent","vec4"),a.varyings.add("vTangent","vec4"),a.vertex.code.add(q.glsl(b||(b=t(["\n      void transformVertexTangent(mat3 modelTransformForNormals) {\n        vTangent.xyz \x3d modelTransformForNormals * tangent.xyz;\n        vTangent.w \x3d tangent.w;\n      }\n    "],
["\n      void transformVertexTangent(mat3 modelTransformForNormals) {\n        vTangent.xyz \x3d modelTransformForNormals * tangent.xyz;\n        vTangent.w \x3d tangent.w;\n      }\n    "])))),2===d.doubleSidedMode?m.code.add(q.glsl(f||(f=t(["\n      mat3 computeTangentSpace(vec3 normal) {\n        float tangentHeadedness \x3d gl_FrontFacing ? vTangent.w : -vTangent.w;\n        vec3 tangent \x3d normalize(gl_FrontFacing ? vTangent.xyz : -vTangent.xyz);\n        vec3 bitangent \x3d cross(normal, tangent) * tangentHeadedness;\n        return mat3(tangent, bitangent, normal);\n      }\n    "],
["\n      mat3 computeTangentSpace(vec3 normal) {\n        float tangentHeadedness \x3d gl_FrontFacing ? vTangent.w : -vTangent.w;\n        vec3 tangent \x3d normalize(gl_FrontFacing ? vTangent.xyz : -vTangent.xyz);\n        vec3 bitangent \x3d cross(normal, tangent) * tangentHeadedness;\n        return mat3(tangent, bitangent, normal);\n      }\n    "])))):m.code.add(q.glsl(h||(h=t(["\n      mat3 computeTangentSpace(vec3 normal) {\n        float tangentHeadedness \x3d vTangent.w;\n        vec3 tangent \x3d normalize(vTangent.xyz);\n        vec3 bitangent \x3d cross(normal, tangent) * tangentHeadedness;\n        return mat3(tangent, bitangent, normal);\n      }\n    "],
["\n      mat3 computeTangentSpace(vec3 normal) {\n        float tangentHeadedness \x3d vTangent.w;\n        vec3 tangent \x3d normalize(vTangent.xyz);\n        vec3 bitangent \x3d cross(normal, tangent) * tangentHeadedness;\n        return mat3(tangent, bitangent, normal);\n      }\n    "]))))):(a.extensions.add("GL_OES_standard_derivatives"),m.code.add(q.glsl(r||(r=t(['\n    mat3 computeTangentSpace(vec3 normal, vec3 pos, vec2 st) {\n\n      vec3 Q1 \x3d dFdx(pos);\n      vec3 Q2 \x3d dFdy(pos);\n\n      vec2 stx \x3d dFdx(st);\n      vec2 sty \x3d dFdy(st);\n\n      float det \x3d stx.t * sty.s - sty.t * stx.s;\n\n      vec3 T \x3d stx.t * Q2 - sty.t * Q1; // compute tangent\n      T \x3d T - normal * dot(normal, T); // orthogonalize tangent\n      T *\x3d inversesqrt(max(dot(T,T), 1.e-10)); // "soft" normalize - goes to 0 when T goes to 0\n      vec3 B \x3d sign(det) * cross(normal, T); // assume normal is normalized, B has the same lenght as B\n      return mat3(T, B, normal); // T and B go to 0 when the tangent space is not well defined by the uv coordinates\n    }\n  '],
['\n    mat3 computeTangentSpace(vec3 normal, vec3 pos, vec2 st) {\n\n      vec3 Q1 \x3d dFdx(pos);\n      vec3 Q2 \x3d dFdy(pos);\n\n      vec2 stx \x3d dFdx(st);\n      vec2 sty \x3d dFdy(st);\n\n      float det \x3d stx.t * sty.s - sty.t * stx.s;\n\n      vec3 T \x3d stx.t * Q2 - sty.t * Q1; // compute tangent\n      T \x3d T - normal * dot(normal, T); // orthogonalize tangent\n      T *\x3d inversesqrt(max(dot(T,T), 1.e-10)); // "soft" normalize - goes to 0 when T goes to 0\n      vec3 B \x3d sign(det) * cross(normal, T); // assume normal is normalized, B has the same lenght as B\n      return mat3(T, B, normal); // T and B go to 0 when the tangent space is not well defined by the uv coordinates\n    }\n  '])))));
0!==d.attributeTextureCoordinates&&(a.include(l.VertexTextureCoordinates,d),m.code.add(q.glsl(c||(c=t(["\n    vec3 computeTextureNormal(mat3 tangentSpace, vec2 uv) {\n      vtc.uv \x3d uv;\n      ","\n      vec3 rawNormal \x3d textureLookup(normalTexture, vtc).rgb * 2.0 - 1.0;\n      return tangentSpace * rawNormal;\n    }\n  "],["\n    vec3 computeTextureNormal(mat3 tangentSpace, vec2 uv) {\n      vtc.uv \x3d uv;\n      ","\n      vec3 rawNormal \x3d textureLookup(normalTexture, vtc).rgb * 2.0 - 1.0;\n      return tangentSpace * rawNormal;\n    }\n  "])),
d.supportsTextureAtlas?"vtc.size \x3d normalTextureSize;":"")))};var b,f,h,r,c})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/EvaluateAmbientOcclusion.glsl":function(){define(["require","exports","../../../../../../core/tsSupport/makeTemplateObjectHelper","../../shaderModules/interfaces"],function(z,d,t,l){Object.defineProperty(d,"__esModule",{value:!0});d.EvaluateAmbientOcclusion=function(d,h){d=d.fragment;h.receiveAmbientOcclusion?(d.uniforms.add("ssaoTex","sampler2D"),d.uniforms.add("viewportPixelSz",
"vec4"),d.code.add(l.glsl(q||(q=t(["\n      float evaluateAmbientOcclusion() {\n        return 1.0 - texture2D(ssaoTex, (gl_FragCoord.xy - viewportPixelSz.xy) * viewportPixelSz.zw).a;\n      }\n\n      float evaluateAmbientOcclusionInverse() {\n        float ssao \x3d texture2D(ssaoTex, (gl_FragCoord.xy - viewportPixelSz.xy) * viewportPixelSz.zw).a;\n        return viewportPixelSz.z \x3c 0.0 ? 1.0 : ssao;\n      }\n    "],["\n      float evaluateAmbientOcclusion() {\n        return 1.0 - texture2D(ssaoTex, (gl_FragCoord.xy - viewportPixelSz.xy) * viewportPixelSz.zw).a;\n      }\n\n      float evaluateAmbientOcclusionInverse() {\n        float ssao \x3d texture2D(ssaoTex, (gl_FragCoord.xy - viewportPixelSz.xy) * viewportPixelSz.zw).a;\n        return viewportPixelSz.z \x3c 0.0 ? 1.0 : ssao;\n      }\n    "]))))):
d.code.add(l.glsl(b||(b=t(["\n      float evaluateAmbientOcclusion() { return 0.0; } // no occlusion\n      float evaluateAmbientOcclusionInverse() { return 1.0; }\n    "],["\n      float evaluateAmbientOcclusion() { return 0.0; } // no occlusion\n      float evaluateAmbientOcclusionInverse() { return 1.0; }\n    "]))))};var q,b})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/EvaluateSceneLighting.glsl":function(){define("require exports ../../../../../../core/tsSupport/makeTemplateObjectHelper ./EvaluateAmbientLighting.glsl ./EvaluateAmbientOcclusion.glsl ./EvaluateMainLighting.glsl ./PhysicallyBasedRendering.glsl ./PiUtils.glsl ./ReadShadowMap.glsl ../../shaderModules/interfaces".split(" "),
function(z,d,t,l,q,b,f,h,r,c){Object.defineProperty(d,"__esModule",{value:!0});d.EvaluateSceneLighting=function(d,z){var P=d.fragment;d.include(b.EvaluateMainLighting);d.include(q.EvaluateAmbientOcclusion,z);0!==z.pbrMode&&d.include(f.PhysicallyBasedRendering,z);d.include(l.EvaluateAmbientLighting,z);z.receiveShadows&&d.include(r.ReadShadowMap,z);P.uniforms.add("lightingGlobalFactor","float");P.uniforms.add("ambientBoostFactor","float");d.include(h.PiUtils);P.code.add(c.glsl(a||(a=t(["\n    const float GAMMA_SRGB \x3d 2.1;\n    const float INV_GAMMA_SRGB \x3d 0.4761904;\n    ",
"\n  "],["\n    const float GAMMA_SRGB \x3d 2.1;\n    const float INV_GAMMA_SRGB \x3d 0.4761904;\n    ","\n  "])),0===z.pbrMode?"":"const vec3 GROUND_REFLECTANCE \x3d vec3(0.2);"));if(z.useOldSceneLightInterface)P.code.add(c.glsl(m||(m=t(["\n    vec3 evaluateSceneLightingExt(vec3 normal, vec3 albedo, float shadow, float ssao, vec3 additionalLight) {\n      // evaluate the main light\n      #if defined(TREE_RENDERING)\n        // Special case for tree rendering:\n        // We shift the Lambert lobe to the back, allowing it to reach part of the hemisphere\n        // facing away from the light. The idea is to get an effect where light is transmitted\n        // through the tree.\n        float minDot \x3d -0.5;\n        float dotRange \x3d 1.0 - minDot;\n        float dotNormalization \x3d 0.66; // guessed \x26 hand tweaked value, for an exact value we could precompute an integral over the sphere\n\n        float dotVal \x3d dotNormalization * (clamp(-dot(normal, lightingMainDirection), 1.0 - dotRange, 1.0) - minDot) * (1.0 / dotRange);\n      #else\n        float dotVal \x3d clamp(-dot(normal, lightingMainDirection), 0.0, 1.0);\n      #endif\n\n      // move lighting towards (1.0, 1.0, 1.0) if requested\n      dotVal \x3d mix(dotVal, 1.0, lightingFixedFactor);\n\n      vec3 mainLight \x3d (1.0 - shadow) * lightingMainIntensity * dotVal;\n      vec3 ambientLight \x3d calculateAmbientIrradiance(normal, ssao);\n\n      // inverse gamma correction on the albedo color\n      vec3 albedoGammaC \x3d pow(albedo, vec3(GAMMA_SRGB));\n\n      // physically correct BRDF normalizes by PI\n      vec3 totalLight \x3d mainLight + ambientLight + additionalLight;\n      totalLight \x3d min(totalLight, vec3(PI));\n      vec3 outColor \x3d vec3((albedoGammaC / PI) * (totalLight));\n\n      // apply gamma correction to the computed color\n      outColor \x3d pow(outColor, vec3(INV_GAMMA_SRGB));\n\n      return outColor;\n    }\n  "],
["\n    vec3 evaluateSceneLightingExt(vec3 normal, vec3 albedo, float shadow, float ssao, vec3 additionalLight) {\n      // evaluate the main light\n      #if defined(TREE_RENDERING)\n        // Special case for tree rendering:\n        // We shift the Lambert lobe to the back, allowing it to reach part of the hemisphere\n        // facing away from the light. The idea is to get an effect where light is transmitted\n        // through the tree.\n        float minDot \x3d -0.5;\n        float dotRange \x3d 1.0 - minDot;\n        float dotNormalization \x3d 0.66; // guessed \x26 hand tweaked value, for an exact value we could precompute an integral over the sphere\n\n        float dotVal \x3d dotNormalization * (clamp(-dot(normal, lightingMainDirection), 1.0 - dotRange, 1.0) - minDot) * (1.0 / dotRange);\n      #else\n        float dotVal \x3d clamp(-dot(normal, lightingMainDirection), 0.0, 1.0);\n      #endif\n\n      // move lighting towards (1.0, 1.0, 1.0) if requested\n      dotVal \x3d mix(dotVal, 1.0, lightingFixedFactor);\n\n      vec3 mainLight \x3d (1.0 - shadow) * lightingMainIntensity * dotVal;\n      vec3 ambientLight \x3d calculateAmbientIrradiance(normal, ssao);\n\n      // inverse gamma correction on the albedo color\n      vec3 albedoGammaC \x3d pow(albedo, vec3(GAMMA_SRGB));\n\n      // physically correct BRDF normalizes by PI\n      vec3 totalLight \x3d mainLight + ambientLight + additionalLight;\n      totalLight \x3d min(totalLight, vec3(PI));\n      vec3 outColor \x3d vec3((albedoGammaC / PI) * (totalLight));\n\n      // apply gamma correction to the computed color\n      outColor \x3d pow(outColor, vec3(INV_GAMMA_SRGB));\n\n      return outColor;\n    }\n  "]))));
else if(0===z.viewingMode?P.code.add(c.glsl(u||(u=t(["\n      float _oldHeuristicLighting(vec3 vPosWorld) {\n        vec3 shadingNormalWorld \x3d normalize(vPosWorld);\n        float vndl \x3d -dot(shadingNormalWorld, lightingMainDirection);\n\n        return smoothstep(0.0, 1.0, clamp(vndl * 2.5, 0.0, 1.0));\n      }\n    "],["\n      float _oldHeuristicLighting(vec3 vPosWorld) {\n        vec3 shadingNormalWorld \x3d normalize(vPosWorld);\n        float vndl \x3d -dot(shadingNormalWorld, lightingMainDirection);\n\n        return smoothstep(0.0, 1.0, clamp(vndl * 2.5, 0.0, 1.0));\n      }\n    "])))):
P.code.add(c.glsl(D||(D=t(["\n      float _oldHeuristicLighting(vec3 vPosWorld) {\n        float vndl \x3d -dot(vec3(0.0, 0.0, 1.0), lightingMainDirection);\n        return smoothstep(0.0, 1.0, clamp(vndl * 2.5, 0.0, 1.0));\n      }\n    "],["\n      float _oldHeuristicLighting(vec3 vPosWorld) {\n        float vndl \x3d -dot(vec3(0.0, 0.0, 1.0), lightingMainDirection);\n        return smoothstep(0.0, 1.0, clamp(vndl * 2.5, 0.0, 1.0));\n      }\n    "])))),P.code.add(c.glsl(w||(w=t(["\n      vec3 evaluateAdditionalLighting(float ambientOcclusion, vec3 vPosWorld) {\n        float additionalAmbientScale \x3d _oldHeuristicLighting(vPosWorld);\n        return (1.0 - ambientOcclusion) * additionalAmbientScale * ambientBoostFactor * lightingGlobalFactor * lightingMainIntensity;\n      }\n    "],
["\n      vec3 evaluateAdditionalLighting(float ambientOcclusion, vec3 vPosWorld) {\n        float additionalAmbientScale \x3d _oldHeuristicLighting(vPosWorld);\n        return (1.0 - ambientOcclusion) * additionalAmbientScale * ambientBoostFactor * lightingGlobalFactor * lightingMainIntensity;\n      }\n    "])))),0===z.pbrMode||4===z.pbrMode)P.code.add(c.glsl(v||(v=t(["\n      vec3 evaluateSceneLighting(vec3 normalWorld, vec3 baseColor, float mainLightShadow, float ambientOcclusion, vec3 additionalLight)\n      {\n        vec3 mainLighting \x3d evaluateMainLighting(normalWorld, mainLightShadow);\n        vec3 ambientLighting \x3d calculateAmbientIrradiance(normalWorld, ambientOcclusion);\n        // inverse gamma correction on the base color\n        vec3 baseColorLinear \x3d pow(baseColor, vec3(GAMMA_SRGB));\n\n        // physically correct BRDF normalizes by PI\n        vec3 totalLight \x3d mainLighting + ambientLighting + additionalLight;\n        totalLight \x3d min(totalLight, vec3(PI));\n        vec3 outColor \x3d vec3((baseColorLinear / PI) * totalLight);\n\n        // apply gamma correction to the computed color\n        outColor \x3d pow(outColor, vec3(INV_GAMMA_SRGB));\n\n        return outColor;\n      }\n      "],
["\n      vec3 evaluateSceneLighting(vec3 normalWorld, vec3 baseColor, float mainLightShadow, float ambientOcclusion, vec3 additionalLight)\n      {\n        vec3 mainLighting \x3d evaluateMainLighting(normalWorld, mainLightShadow);\n        vec3 ambientLighting \x3d calculateAmbientIrradiance(normalWorld, ambientOcclusion);\n        // inverse gamma correction on the base color\n        vec3 baseColorLinear \x3d pow(baseColor, vec3(GAMMA_SRGB));\n\n        // physically correct BRDF normalizes by PI\n        vec3 totalLight \x3d mainLighting + ambientLighting + additionalLight;\n        totalLight \x3d min(totalLight, vec3(PI));\n        vec3 outColor \x3d vec3((baseColorLinear / PI) * totalLight);\n\n        // apply gamma correction to the computed color\n        outColor \x3d pow(outColor, vec3(INV_GAMMA_SRGB));\n\n        return outColor;\n      }\n      "]))));
else if(1===z.pbrMode||2===z.pbrMode)P.code.add(c.glsl(E||(E=t(["\n      const float fillLightIntensity \x3d 0.25;\n      const float horizonLightDiffusion \x3d 0.4;\n      const float additionalAmbientIrradianceFactor \x3d 0.02;\n\n      vec3 evaluateSceneLightingPBR(vec3 normal, vec3 albedo, float shadow, float ssao, vec3 additionalLight, vec3 viewDir, vec3 normalGround, vec3 mrr, vec3 _emission, float additionalAmbientIrradiance)\n      {\n        // Calculate half vector between view and light direction\n        vec3 viewDirection \x3d -viewDir;\n        vec3 mainLightDirection \x3d -lightingMainDirection;\n        vec3 h \x3d normalize(viewDirection + mainLightDirection);\n\n        PBRShadingInfo inputs;\n        inputs.NdotL \x3d clamp(dot(normal, mainLightDirection), 0.001, 1.0);\n        inputs.NdotV \x3d clamp(abs(dot(normal, viewDirection)), 0.001, 1.0);\n        inputs.NdotH \x3d clamp(dot(normal, h), 0.0, 1.0);\n        inputs.VdotH \x3d clamp(dot(viewDirection, h), 0.0, 1.0);\n        inputs.NdotNG \x3d clamp(dot(normal, normalGround), -1.0, 1.0);\n        vec3 reflectedView \x3d normalize(reflect(viewDirection, normal));\n        inputs.RdotNG \x3d clamp(dot(reflectedView, normalGround), -1.0, 1.0);\n\n        inputs.albedoLinear \x3d pow(albedo, vec3(GAMMA_SRGB));\n        inputs.ssao \x3d ssao;\n\n        inputs.metalness \x3d mrr[0];\n        inputs.roughness \x3d clamp(mrr[1] * mrr[1], 0.001, 0.99);\n      "],
["\n      const float fillLightIntensity \x3d 0.25;\n      const float horizonLightDiffusion \x3d 0.4;\n      const float additionalAmbientIrradianceFactor \x3d 0.02;\n\n      vec3 evaluateSceneLightingPBR(vec3 normal, vec3 albedo, float shadow, float ssao, vec3 additionalLight, vec3 viewDir, vec3 normalGround, vec3 mrr, vec3 _emission, float additionalAmbientIrradiance)\n      {\n        // Calculate half vector between view and light direction\n        vec3 viewDirection \x3d -viewDir;\n        vec3 mainLightDirection \x3d -lightingMainDirection;\n        vec3 h \x3d normalize(viewDirection + mainLightDirection);\n\n        PBRShadingInfo inputs;\n        inputs.NdotL \x3d clamp(dot(normal, mainLightDirection), 0.001, 1.0);\n        inputs.NdotV \x3d clamp(abs(dot(normal, viewDirection)), 0.001, 1.0);\n        inputs.NdotH \x3d clamp(dot(normal, h), 0.0, 1.0);\n        inputs.VdotH \x3d clamp(dot(viewDirection, h), 0.0, 1.0);\n        inputs.NdotNG \x3d clamp(dot(normal, normalGround), -1.0, 1.0);\n        vec3 reflectedView \x3d normalize(reflect(viewDirection, normal));\n        inputs.RdotNG \x3d clamp(dot(reflectedView, normalGround), -1.0, 1.0);\n\n        inputs.albedoLinear \x3d pow(albedo, vec3(GAMMA_SRGB));\n        inputs.ssao \x3d ssao;\n\n        inputs.metalness \x3d mrr[0];\n        inputs.roughness \x3d clamp(mrr[1] * mrr[1], 0.001, 0.99);\n      "])))),
P.code.add(c.glsl(C||(C=t(["\n        inputs.f0 \x3d (0.16 * mrr[2] * mrr[2]) * (1.0 - inputs.metalness) + inputs.albedoLinear * inputs.metalness;\n        inputs.f90 \x3d vec3(clamp(dot(inputs.f0, vec3(50.0 * 0.33)), 0.0, 1.0)); // more accurate then using  f90 \x3d 1.0\n        inputs.diffuseColor \x3d inputs.albedoLinear * (vec3(1.0) - inputs.f0) * (1.0 - inputs.metalness);\n      "],["\n        inputs.f0 \x3d (0.16 * mrr[2] * mrr[2]) * (1.0 - inputs.metalness) + inputs.albedoLinear * inputs.metalness;\n        inputs.f90 \x3d vec3(clamp(dot(inputs.f0, vec3(50.0 * 0.33)), 0.0, 1.0)); // more accurate then using  f90 \x3d 1.0\n        inputs.diffuseColor \x3d inputs.albedoLinear * (vec3(1.0) - inputs.f0) * (1.0 - inputs.metalness);\n      "])))),
P.code.add(c.glsl(J||(J=t(["\n        vec3 ambientDir \x3d vec3(5.0 * normalGround[1] - normalGround[0] * normalGround[2], - 5.0 * normalGround[0] - normalGround[2] * normalGround[1], normalGround[1] * normalGround[1] + normalGround[0] * normalGround[0]);\n        ambientDir \x3d ambientDir !\x3d vec3(0.0)? normalize(ambientDir) : normalize(vec3(5.0, -1.0, 0.0));\n\n        inputs.NdotAmbDir \x3d abs(dot(normal, ambientDir));\n\n        // Calculate the irradiance components: sun, fill lights and the sky.\n        vec3 mainLightIrradianceComponent  \x3d inputs.NdotL * (1.0 - shadow) * lightingMainIntensity;\n        vec3 fillLightsIrradianceComponent \x3d inputs.NdotAmbDir * lightingMainIntensity * fillLightIntensity;\n        // calculateAmbientIrradiance for localView and additionalLight for gloabalView\n        vec3 ambientLightIrradianceComponent \x3d calculateAmbientIrradiance(normal, ssao) + additionalLight;\n\n        // Assemble the overall irradiance of the sky that illuminates the surface\n        inputs.skyIrradianceToSurface    \x3d ambientLightIrradianceComponent + mainLightIrradianceComponent + fillLightsIrradianceComponent ;\n        // Assemble the overall irradiance of the ground that illuminates the surface. for this we use the simple model that changes only the sky irradiance by the groundReflectance\n        inputs.groundIrradianceToSurface \x3d GROUND_REFLECTANCE * ambientLightIrradianceComponent + mainLightIrradianceComponent + fillLightsIrradianceComponent ;\n      "],
["\n        vec3 ambientDir \x3d vec3(5.0 * normalGround[1] - normalGround[0] * normalGround[2], - 5.0 * normalGround[0] - normalGround[2] * normalGround[1], normalGround[1] * normalGround[1] + normalGround[0] * normalGround[0]);\n        ambientDir \x3d ambientDir !\x3d vec3(0.0)? normalize(ambientDir) : normalize(vec3(5.0, -1.0, 0.0));\n\n        inputs.NdotAmbDir \x3d abs(dot(normal, ambientDir));\n\n        // Calculate the irradiance components: sun, fill lights and the sky.\n        vec3 mainLightIrradianceComponent  \x3d inputs.NdotL * (1.0 - shadow) * lightingMainIntensity;\n        vec3 fillLightsIrradianceComponent \x3d inputs.NdotAmbDir * lightingMainIntensity * fillLightIntensity;\n        // calculateAmbientIrradiance for localView and additionalLight for gloabalView\n        vec3 ambientLightIrradianceComponent \x3d calculateAmbientIrradiance(normal, ssao) + additionalLight;\n\n        // Assemble the overall irradiance of the sky that illuminates the surface\n        inputs.skyIrradianceToSurface    \x3d ambientLightIrradianceComponent + mainLightIrradianceComponent + fillLightsIrradianceComponent ;\n        // Assemble the overall irradiance of the ground that illuminates the surface. for this we use the simple model that changes only the sky irradiance by the groundReflectance\n        inputs.groundIrradianceToSurface \x3d GROUND_REFLECTANCE * ambientLightIrradianceComponent + mainLightIrradianceComponent + fillLightsIrradianceComponent ;\n      "])))),
P.code.add(c.glsl(K||(K=t(["\n        vec3 horizonRingDir \x3d inputs.RdotNG * normalGround - reflectedView;\n        vec3 horizonRingH \x3d normalize(viewDirection + horizonRingDir);\n        inputs.NdotH_Horizon \x3d dot(normal, horizonRingH);\n\n        vec3 mainLightRadianceComponent  \x3d normalDistribution(inputs.NdotH, inputs.roughness) * lightingMainIntensity * (1.0 - shadow);\n        vec3 horizonLightRadianceComponent \x3d normalDistribution(inputs.NdotH_Horizon, min(inputs.roughness + horizonLightDiffusion, 1.0)) * lightingMainIntensity * fillLightIntensity;\n        vec3 ambientLightRadianceComponent \x3d calculateAmbientRadiance(ssao) + additionalLight; // calculateAmbientRadiance for localView and additionalLight for gloabalView\n\n        // Assemble the overall radiance of the sky that illuminates the surface\n        inputs.skyRadianceToSurface    \x3d  ambientLightRadianceComponent + mainLightRadianceComponent + horizonLightRadianceComponent;\n        // Assemble the overall radiance of the ground that illuminates the surface. for this we use the simple model that changes only the sky radince by the groundReflectance\n        inputs.groundRadianceToSurface \x3d GROUND_REFLECTANCE * (ambientLightRadianceComponent + horizonLightRadianceComponent) + mainLightRadianceComponent;\n\n        // Calculate average ambient radiance - this is used int the gamut mapping part to deduce the black level that is soft compressed\n        inputs.averageAmbientRadiance \x3d ambientLightIrradianceComponent[1] * (1.0 + GROUND_REFLECTANCE[1]);\n        "],
["\n        vec3 horizonRingDir \x3d inputs.RdotNG * normalGround - reflectedView;\n        vec3 horizonRingH \x3d normalize(viewDirection + horizonRingDir);\n        inputs.NdotH_Horizon \x3d dot(normal, horizonRingH);\n\n        vec3 mainLightRadianceComponent  \x3d normalDistribution(inputs.NdotH, inputs.roughness) * lightingMainIntensity * (1.0 - shadow);\n        vec3 horizonLightRadianceComponent \x3d normalDistribution(inputs.NdotH_Horizon, min(inputs.roughness + horizonLightDiffusion, 1.0)) * lightingMainIntensity * fillLightIntensity;\n        vec3 ambientLightRadianceComponent \x3d calculateAmbientRadiance(ssao) + additionalLight; // calculateAmbientRadiance for localView and additionalLight for gloabalView\n\n        // Assemble the overall radiance of the sky that illuminates the surface\n        inputs.skyRadianceToSurface    \x3d  ambientLightRadianceComponent + mainLightRadianceComponent + horizonLightRadianceComponent;\n        // Assemble the overall radiance of the ground that illuminates the surface. for this we use the simple model that changes only the sky radince by the groundReflectance\n        inputs.groundRadianceToSurface \x3d GROUND_REFLECTANCE * (ambientLightRadianceComponent + horizonLightRadianceComponent) + mainLightRadianceComponent;\n\n        // Calculate average ambient radiance - this is used int the gamut mapping part to deduce the black level that is soft compressed\n        inputs.averageAmbientRadiance \x3d ambientLightIrradianceComponent[1] * (1.0 + GROUND_REFLECTANCE[1]);\n        "])))),
P.code.add(c.glsl(x||(x=t(["\n        vec3 reflectedColorComponent \x3d evaluateEnvironmentIllumination(inputs);\n        vec3 additionalMaterialReflectanceComponent \x3d inputs.albedoLinear * additionalAmbientIrradiance;\n        vec3 emissionComponent \x3d pow(_emission, vec3(GAMMA_SRGB));\n        vec3 outColorLinear \x3d reflectedColorComponent + additionalMaterialReflectanceComponent + emissionComponent;\n        ","\n        return outColor;\n      }\n    "],["\n        vec3 reflectedColorComponent \x3d evaluateEnvironmentIllumination(inputs);\n        vec3 additionalMaterialReflectanceComponent \x3d inputs.albedoLinear * additionalAmbientIrradiance;\n        vec3 emissionComponent \x3d pow(_emission, vec3(GAMMA_SRGB));\n        vec3 outColorLinear \x3d reflectedColorComponent + additionalMaterialReflectanceComponent + emissionComponent;\n        ",
"\n        return outColor;\n      }\n    "])),2===z.pbrMode?c.glsl(G||(G=t(["vec3 outColor \x3d pow(outColorLinear - 0.005 * inputs.averageAmbientRadiance, vec3(INV_GAMMA_SRGB));"],["vec3 outColor \x3d pow(outColorLinear - 0.005 * inputs.averageAmbientRadiance, vec3(INV_GAMMA_SRGB));"]))):c.glsl(I||(I=t(["vec3 outColor \x3d pow(blackLevelSoftCompression(outColorLinear, inputs), vec3(INV_GAMMA_SRGB));"],["vec3 outColor \x3d pow(blackLevelSoftCompression(outColorLinear, inputs), vec3(INV_GAMMA_SRGB));"])))))};
var a,m,u,D,w,v,E,C,J,K,G,I,x})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/EvaluateAmbientLighting.glsl":function(){define(["require","exports","../../../../../../core/tsSupport/makeTemplateObjectHelper","../../shaderModules/interfaces"],function(z,d,t,l){Object.defineProperty(d,"__esModule",{value:!0});d.EvaluateAmbientLighting=function(d,c){d=d.fragment;var a=void 0!==c.lightingSphericalHarmonicsOrder?c.lightingSphericalHarmonicsOrder:2;0===a?(d.uniforms.add("lightingAmbientSH0","vec3"),
d.code.add(l.glsl(q||(q=t(["\n      vec3 calculateAmbientIrradiance(vec3 normal, float ambientOcclusion) {\n        vec3 ambientLight \x3d 0.282095 * lightingAmbientSH0;\n        return ambientLight * (1.0 - ambientOcclusion);\n      }\n    "],["\n      vec3 calculateAmbientIrradiance(vec3 normal, float ambientOcclusion) {\n        vec3 ambientLight \x3d 0.282095 * lightingAmbientSH0;\n        return ambientLight * (1.0 - ambientOcclusion);\n      }\n    "]))))):1===a?(d.uniforms.add("lightingAmbientSH_R",
"vec4"),d.uniforms.add("lightingAmbientSH_G","vec4"),d.uniforms.add("lightingAmbientSH_B","vec4"),d.code.add(l.glsl(b||(b=t(["\n      vec3 calculateAmbientIrradiance(vec3 normal, float ambientOcclusion) {\n        vec4 sh0 \x3d vec4(\n          0.282095,\n          0.488603 * normal.x,\n          0.488603 * normal.z,\n          0.488603 * normal.y\n        );\n        vec3 ambientLight \x3d vec3(\n          dot(lightingAmbientSH_R, sh0),\n          dot(lightingAmbientSH_G, sh0),\n          dot(lightingAmbientSH_B, sh0)\n        );\n        return ambientLight * (1.0 - ambientOcclusion);\n      }\n    "],
["\n      vec3 calculateAmbientIrradiance(vec3 normal, float ambientOcclusion) {\n        vec4 sh0 \x3d vec4(\n          0.282095,\n          0.488603 * normal.x,\n          0.488603 * normal.z,\n          0.488603 * normal.y\n        );\n        vec3 ambientLight \x3d vec3(\n          dot(lightingAmbientSH_R, sh0),\n          dot(lightingAmbientSH_G, sh0),\n          dot(lightingAmbientSH_B, sh0)\n        );\n        return ambientLight * (1.0 - ambientOcclusion);\n      }\n    "]))))):2===a&&(d.uniforms.add("lightingAmbientSH0",
"vec3"),d.uniforms.add("lightingAmbientSH_R1","vec4"),d.uniforms.add("lightingAmbientSH_G1","vec4"),d.uniforms.add("lightingAmbientSH_B1","vec4"),d.uniforms.add("lightingAmbientSH_R2","vec4"),d.uniforms.add("lightingAmbientSH_G2","vec4"),d.uniforms.add("lightingAmbientSH_B2","vec4"),d.code.add(l.glsl(f||(f=t(["\n      vec3 calculateAmbientIrradiance(vec3 normal, float ambientOcclusion) {\n        vec3 ambientLight \x3d 0.282095 * lightingAmbientSH0;\n\n        vec4 sh1 \x3d vec4(\n          0.488603 * normal.x,\n          0.488603 * normal.z,\n          0.488603 * normal.y,\n          1.092548 * normal.x * normal.y\n        );\n        vec4 sh2 \x3d vec4(\n          1.092548 * normal.y * normal.z,\n          0.315392 * (3.0 * normal.z * normal.z - 1.0),\n          1.092548 * normal.x * normal.z,\n          0.546274 * (normal.x * normal.x - normal.y * normal.y)\n        );\n        ambientLight +\x3d vec3(\n          dot(lightingAmbientSH_R1, sh1),\n          dot(lightingAmbientSH_G1, sh1),\n          dot(lightingAmbientSH_B1, sh1)\n        );\n        ambientLight +\x3d vec3(\n          dot(lightingAmbientSH_R2, sh2),\n          dot(lightingAmbientSH_G2, sh2),\n          dot(lightingAmbientSH_B2, sh2)\n        );\n        return ambientLight * (1.0 - ambientOcclusion);\n      }\n    "],
["\n      vec3 calculateAmbientIrradiance(vec3 normal, float ambientOcclusion) {\n        vec3 ambientLight \x3d 0.282095 * lightingAmbientSH0;\n\n        vec4 sh1 \x3d vec4(\n          0.488603 * normal.x,\n          0.488603 * normal.z,\n          0.488603 * normal.y,\n          1.092548 * normal.x * normal.y\n        );\n        vec4 sh2 \x3d vec4(\n          1.092548 * normal.y * normal.z,\n          0.315392 * (3.0 * normal.z * normal.z - 1.0),\n          1.092548 * normal.x * normal.z,\n          0.546274 * (normal.x * normal.x - normal.y * normal.y)\n        );\n        ambientLight +\x3d vec3(\n          dot(lightingAmbientSH_R1, sh1),\n          dot(lightingAmbientSH_G1, sh1),\n          dot(lightingAmbientSH_B1, sh1)\n        );\n        ambientLight +\x3d vec3(\n          dot(lightingAmbientSH_R2, sh2),\n          dot(lightingAmbientSH_G2, sh2),\n          dot(lightingAmbientSH_B2, sh2)\n        );\n        return ambientLight * (1.0 - ambientOcclusion);\n      }\n    "])))),
1!==c.pbrMode&&2!==c.pbrMode||d.code.add(l.glsl(h||(h=t(["\n        const vec3 skyTransmittance \x3d vec3(0.9, 0.9, 1.0);\n\n        vec3 calculateAmbientRadiance(float ambientOcclusion)\n        {\n          vec3 ambientLight \x3d 1.2 * (0.282095 * lightingAmbientSH0) - 0.2;\n          return ambientLight *\x3d (1.0 - ambientOcclusion) * skyTransmittance;\n        }\n      "],["\n        const vec3 skyTransmittance \x3d vec3(0.9, 0.9, 1.0);\n\n        vec3 calculateAmbientRadiance(float ambientOcclusion)\n        {\n          vec3 ambientLight \x3d 1.2 * (0.282095 * lightingAmbientSH0) - 0.2;\n          return ambientLight *\x3d (1.0 - ambientOcclusion) * skyTransmittance;\n        }\n      "])))))};
var q,b,f,h})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/EvaluateMainLighting.glsl":function(){define(["require","exports","../../../../../../core/tsSupport/makeTemplateObjectHelper","../../shaderModules/interfaces"],function(z,d,t,l){Object.defineProperty(d,"__esModule",{value:!0});d.EvaluateMainLighting=function(b){b=b.fragment;b.uniforms.add("lightingMainDirection","vec3");b.uniforms.add("lightingMainIntensity","vec3");b.uniforms.add("lightingFixedFactor","float");b.code.add(l.glsl(q||
(q=t(["\n    vec3 evaluateMainLighting(vec3 normal_global, float shadowing) {\n      float dotVal \x3d clamp(-dot(normal_global, lightingMainDirection), 0.0, 1.0);\n\n      // move lighting towards (1.0, 1.0, 1.0) if requested\n      dotVal \x3d mix(dotVal, 1.0, lightingFixedFactor);\n\n      return lightingMainIntensity * ((1.0 - shadowing) * dotVal);\n    }\n  "],["\n    vec3 evaluateMainLighting(vec3 normal_global, float shadowing) {\n      float dotVal \x3d clamp(-dot(normal_global, lightingMainDirection), 0.0, 1.0);\n\n      // move lighting towards (1.0, 1.0, 1.0) if requested\n      dotVal \x3d mix(dotVal, 1.0, lightingFixedFactor);\n\n      return lightingMainIntensity * ((1.0 - shadowing) * dotVal);\n    }\n  "]))))};
var q})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/Normals.glsl":function(){define(["require","exports","../../../../../../core/tsSupport/makeTemplateObjectHelper","../../shaderModules/interfaces"],function(z,d,t,l){Object.defineProperty(d,"__esModule",{value:!0});d.Normals=function(d,c){d=d.fragment;d.code.add(l.glsl(q||(q=t(["\n    struct ShadingNormalParameters {\n      vec3 normalView;\n      vec3 viewDirection;\n    } shadingParams;\n    "],["\n    struct ShadingNormalParameters {\n      vec3 normalView;\n      vec3 viewDirection;\n    } shadingParams;\n    "]))));
1===c.doubleSidedMode?d.code.add(l.glsl(b||(b=t(["\n      vec3 shadingNormal(ShadingNormalParameters params) {\n        return dot(params.normalView, params.viewDirection) \x3e 0.0 ? normalize(-params.normalView) : normalize(params.normalView);\n      }\n    "],["\n      vec3 shadingNormal(ShadingNormalParameters params) {\n        return dot(params.normalView, params.viewDirection) \x3e 0.0 ? normalize(-params.normalView) : normalize(params.normalView);\n      }\n    "])))):2===c.doubleSidedMode?
d.code.add(l.glsl(f||(f=t(["\n      vec3 shadingNormal(ShadingNormalParameters params) {\n        return gl_FrontFacing ? normalize(params.normalView) : normalize(-params.normalView);\n      }\n    "],["\n      vec3 shadingNormal(ShadingNormalParameters params) {\n        return gl_FrontFacing ? normalize(params.normalView) : normalize(-params.normalView);\n      }\n    "])))):d.code.add(l.glsl(h||(h=t(["\n      vec3 shadingNormal(ShadingNormalParameters params) {\n        return normalize(params.normalView);\n      }\n    "],
["\n      vec3 shadingNormal(ShadingNormalParameters params) {\n        return normalize(params.normalView);\n      }\n    "]))))};var q,b,f,h})},"esri/views/3d/webgl-engine/core/shaderLibrary/util/MixExternalColor.glsl":function(){define(["require","exports","../../../../../../core/tsSupport/makeTemplateObjectHelper","./ColorConversion.glsl","../../shaderModules/interfaces"],function(z,d,t,l,q){Object.defineProperty(d,"__esModule",{value:!0});d.MixExternalColor=function(d,h){d.include(l.ColorConversion,
h);var f=q.glsl(b||(b=t(["\n    vec3 mixExternalColor(vec3 internalColor, vec3 textureColor, vec3 externalColor, int mode) {\n      // workaround for artifacts in OSX using Intel Iris Pro\n      // see: https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/10475\n      vec3 internalMixed \x3d internalColor * textureColor;\n      vec3 allMixed \x3d internalMixed * externalColor;\n\n      if (mode \x3d\x3d ",") {\n        return allMixed;\n      }\n      else if (mode \x3d\x3d ",") {\n        return internalMixed;\n      }\n      else if (mode \x3d\x3d ",
") {\n        return externalColor;\n      }\n      else {\n        // tint (or something invalid)\n        float vIn \x3d rgb2v(internalMixed);\n        vec3 hsvTint \x3d rgb2hsv(externalColor);\n        vec3 hsvOut \x3d vec3(hsvTint.x, hsvTint.y, vIn * hsvTint.z);\n        return hsv2rgb(hsvOut);\n      }\n    }\n\n    float mixExternalOpacity(float internalOpacity, float textureOpacity, float externalOpacity, int mode) {\n      // workaround for artifacts in OSX using Intel Iris Pro\n      // see: https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/10475\n      float internalMixed \x3d internalOpacity * textureOpacity;\n      float allMixed \x3d internalMixed * externalOpacity;\n\n      if (mode \x3d\x3d ",
") {\n        return internalMixed;\n      }\n      else if (mode \x3d\x3d ",") {\n        return externalOpacity;\n      }\n      else {\n        // multiply or tint (or something invalid)\n        return allMixed;\n      }\n    }\n  "],["\n    vec3 mixExternalColor(vec3 internalColor, vec3 textureColor, vec3 externalColor, int mode) {\n      // workaround for artifacts in OSX using Intel Iris Pro\n      // see: https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/10475\n      vec3 internalMixed \x3d internalColor * textureColor;\n      vec3 allMixed \x3d internalMixed * externalColor;\n\n      if (mode \x3d\x3d ",
") {\n        return allMixed;\n      }\n      else if (mode \x3d\x3d ",") {\n        return internalMixed;\n      }\n      else if (mode \x3d\x3d ",") {\n        return externalColor;\n      }\n      else {\n        // tint (or something invalid)\n        float vIn \x3d rgb2v(internalMixed);\n        vec3 hsvTint \x3d rgb2hsv(externalColor);\n        vec3 hsvOut \x3d vec3(hsvTint.x, hsvTint.y, vIn * hsvTint.z);\n        return hsv2rgb(hsvOut);\n      }\n    }\n\n    float mixExternalOpacity(float internalOpacity, float textureOpacity, float externalOpacity, int mode) {\n      // workaround for artifacts in OSX using Intel Iris Pro\n      // see: https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/10475\n      float internalMixed \x3d internalOpacity * textureOpacity;\n      float allMixed \x3d internalMixed * externalOpacity;\n\n      if (mode \x3d\x3d ",
") {\n        return internalMixed;\n      }\n      else if (mode \x3d\x3d ",") {\n        return externalOpacity;\n      }\n      else {\n        // multiply or tint (or something invalid)\n        return allMixed;\n      }\n    }\n  "])),q.glsl.int(1),q.glsl.int(2),q.glsl.int(3),q.glsl.int(2),q.glsl.int(3));switch(h.stages){case 0:d.vertex.code.add(f);break;case 1:d.fragment.code.add(f);break;default:d.vertex.code.add(f),d.fragment.code.add(f)}};var b})},"esri/views/3d/webgl-engine/shaders/RealisticTreeTechnique":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/decorateHelper ../core/shaderLibrary/default/RealisticTree.glsl ../core/shaderLibrary/util/DoublePrecision.glsl ../core/shaderTechnique/ReloadableShaderModule ../lib/DefaultVertexAttributeLocations ./DefaultMaterialTechnique ../../../webgl/Program".split(" "),
function(z,d,t,l,q,b,f,h,r,c){Object.defineProperty(d,"__esModule",{value:!0});l=function(a){function d(){return null!==a&&a.apply(this,arguments)||this}t(d,a);d.prototype.initializeProgram=function(a){var f=d.shader.get(),l=this.configuration,f=f.build({output:l.output,viewingMode:a.viewingMode,receiveShadows:l.receiveShadows,slicePlaneEnabled:l.slicePlaneEnabled,sliceHighlightDisabled:l.sliceHighlightDisabled,sliceEnabledForVertexPrograms:!1,symbolColor:l.symbolColors,vvSize:l.vvSize,vvColor:l.vvColor,
vvInstancingEnabled:!0,instanced:l.instanced,instancedColor:l.instancedColor,instancedDoublePrecision:l.instancedDoublePrecision,useOldSceneLightInterface:!1,pbrMode:l.usePBR?1:0,hasMetalnessAndRoughnessTexture:!1,hasEmissionTexture:!1,hasOcclusionTexture:!1,hasNormalTexture:!1,hasColorTexture:l.hasColorTexture,receiveAmbientOcclusion:l.receiveAmbientOcclusion,useCustomDTRExponentForWater:!1,normalType:0,doubleSidedMode:2,vertexTangets:!1,attributeTextureCoordinates:l.hasColorTexture?1:0,textureAlphaPremultiplied:l.textureAlphaPremultiplied,
attributeColor:l.vertexColors,screenSizePerspectiveEnabled:l.screenSizePerspective,verticalOffsetEnabled:l.verticalOffset,offsetBackfaces:l.offsetBackfaces,doublePrecisionRequiresObfuscation:b.doublePrecisionRequiresObfuscation(a.rctx),alphaDiscardMode:l.alphaDiscardMode,supportsTextureAtlas:!1});return new c(a.rctx,f.generateSource("vertex"),f.generateSource("fragment"),h.Default3D)};d.shader=new f.ReloadableShaderModule(q,"../core/shaderLibrary/default/RealisticTree.glsl",z);return d}(r.DefaultMaterialTechnique);
d.RealisticTreeTechnique=l})},"esri/views/3d/webgl-engine/core/shaderLibrary/default/RealisticTree.glsl":function(){define("require exports ../../../../../../core/tsSupport/makeTemplateObjectHelper ../ForwardLinearDepth.glsl ../Offset.glsl ../Slice.glsl ../Transform.glsl ../attributes/InstancedDoublePrecision.glsl ../attributes/NormalAttribute.glsl ../attributes/PositionAttribute.glsl ../attributes/SymbolColor.glsl ../attributes/TextureCoordinateAttribute.glsl ../attributes/VertexColor.glsl ../attributes/VerticalOffset.glsl ./DefaultMaterialAuxiliaryPasses.glsl ../shading/EvaluateAmbientOcclusion.glsl ../shading/EvaluateSceneLighting.glsl ../shading/PhysicallyBasedRendering.glsl ../shading/PhysicallyBasedRenderingParameters.glsl ../shading/ReadShadowMap.glsl ../shading/VisualVariables.glsl ../util/AlphaDiscard.glsl ../util/MixExternalColor.glsl ../../shaderModules/interfaces ../../shaderModules/ShaderBuilder".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u,D,w,v,E,C,J,K,G,I,x,N,O){Object.defineProperty(d,"__esModule",{value:!0});d.build=function(d){var A=new O.ShaderBuilder,k=A.vertex.code,e=A.fragment.code;A.vertex.uniforms.add("proj","mat4").add("view","mat4").add("camPos","vec3").add("localOrigin","vec3");A.include(c.PositionAttribute);A.varyings.add("vpos","vec3");A.include(G.VisualVariables,d);A.include(h.InstancedDoublePrecision,d);A.include(D.VerticalOffset,d);0===d.output&&(A.include(r.NormalAttribute,d),A.include(f.Transform,
{linearDepth:!1}),d.offsetBackfaces&&A.include(q.Offset),d.instancedColor&&A.attributes.add("instanceColor","vec4"),A.varyings.add("vNormalWorld","vec3"),A.varyings.add("localvpos","vec3"),A.include(m.TextureCoordinateAttribute,d),A.include(l.ForwardLinearDepth,d),A.include(a.SymbolColor,d),A.include(u.VertexColor,d),A.vertex.uniforms.add("externalColor","vec4"),A.varyings.add("vcolorExt","vec4"),k.add(N.glsl(P||(P=t(["\n        void main(void) {\n          forwardNormalizedVertexColor();\n          vcolorExt \x3d externalColor;\n          ",
"\n          vcolorExt *\x3d vvColor();\n          vcolorExt *\x3d getSymbolColor();\n          forwardColorMixMode();\n\n          if (vcolorExt.a \x3c ",") {\n            gl_Position \x3d vec4(1e38, 1e38, 1e38, 1.0);\n          }\n          else {\n            vpos \x3d calculateVPos();\n            localvpos \x3d vpos - view[3].xyz;\n            vpos \x3d subtractOrigin(vpos);\n            vNormalWorld \x3d dpNormal(vvLocalNormal(normalModel()));\n            vpos \x3d addVerticalOffset(vpos, localOrigin);\n            gl_Position \x3d transformPosition(proj, view, vpos);\n            ",
"\n          }\n          forwardLinearDepth();\n          forwardTextureCoordinates();\n        }\n      "],["\n        void main(void) {\n          forwardNormalizedVertexColor();\n          vcolorExt \x3d externalColor;\n          ","\n          vcolorExt *\x3d vvColor();\n          vcolorExt *\x3d getSymbolColor();\n          forwardColorMixMode();\n\n          if (vcolorExt.a \x3c ",") {\n            gl_Position \x3d vec4(1e38, 1e38, 1e38, 1.0);\n          }\n          else {\n            vpos \x3d calculateVPos();\n            localvpos \x3d vpos - view[3].xyz;\n            vpos \x3d subtractOrigin(vpos);\n            vNormalWorld \x3d dpNormal(vvLocalNormal(normalModel()));\n            vpos \x3d addVerticalOffset(vpos, localOrigin);\n            gl_Position \x3d transformPosition(proj, view, vpos);\n            ",
"\n          }\n          forwardLinearDepth();\n          forwardTextureCoordinates();\n        }\n      "])),d.instancedColor?"vcolorExt *\x3d instanceColor;":"",N.glsl.float(I.symbolAlphaCutoff),d.offsetBackfaces?"gl_Position \x3d offsetBackfacingClipPosition(gl_Position, vpos, vNormalWorld, camPos);":"")),A.include(b.Slice,d),A.include(E.EvaluateSceneLighting,d),A.include(v.EvaluateAmbientOcclusion,d),A.include(I.DiscardOrAdjustAlpha,d),d.receiveShadows&&A.include(K.ReadShadowMap,d),A.fragment.uniforms.add("camPos",
"vec3").add("localOrigin","vec3").add("ambient","vec3").add("diffuse","vec3").add("opacity","float").add("layerOpacity","float"),A.fragment.uniforms.add("view","mat4"),d.hasColorTexture&&A.fragment.uniforms.add("tex","sampler2D"),A.include(J.PhysicallyBasedRenderingParameters,d),A.include(C.PhysicallyBasedRendering,d),A.include(x.MixExternalColor,{stages:1}),e.add(N.glsl(p||(p=t(["\n      void main() {\n        discardBySlice(vpos);\n        ","\n        vec3 viewDirection \x3d normalize(vpos - camPos);\n        ",
"\n        float ssao \x3d evaluateAmbientOcclusionInverse();\n        ssao *\x3d getBakedOcclusion();\n\n        float additionalAmbientScale \x3d _oldHeuristicLighting(vpos + localOrigin);\n        vec3 additionalLight \x3d ssao * lightingMainIntensity * additionalAmbientScale * ambientBoostFactor * lightingGlobalFactor;\n        ","\n        vec3 matColor \x3d max(ambient, diffuse);\n        ","\n        ","\n        ","\n        ","\n        gl_FragColor \x3d highlightSlice(vec4(shadedColor, opacity_), vpos);\n      }\n    "],
["\n      void main() {\n        discardBySlice(vpos);\n        ","\n        vec3 viewDirection \x3d normalize(vpos - camPos);\n        ","\n        float ssao \x3d evaluateAmbientOcclusionInverse();\n        ssao *\x3d getBakedOcclusion();\n\n        float additionalAmbientScale \x3d _oldHeuristicLighting(vpos + localOrigin);\n        vec3 additionalLight \x3d ssao * lightingMainIntensity * additionalAmbientScale * ambientBoostFactor * lightingGlobalFactor;\n        ","\n        vec3 matColor \x3d max(ambient, diffuse);\n        ",
"\n        ","\n        ","\n        ","\n        gl_FragColor \x3d highlightSlice(vec4(shadedColor, opacity_), vpos);\n      }\n    "])),d.hasColorTexture?N.glsl(S||(S=t(["\n        vec4 texColor \x3d texture2D(tex, vuv0);\n        ","\n        discardOrAdjustAlpha(texColor);"],["\n        vec4 texColor \x3d texture2D(tex, vuv0);\n        ","\n        discardOrAdjustAlpha(texColor);"])),d.textureAlphaPremultiplied?"texColor.rgb /\x3d texColor.a;":""):N.glsl(R||(R=t(["vec4 texColor \x3d vec4(1.0);"],
["vec4 texColor \x3d vec4(1.0);"]))),1===d.pbrMode?"applyPBRFactors();":"",d.receiveShadows?"float shadow \x3d readShadowMap(vpos, linearDepth);":0===d.viewingMode?"float shadow \x3d lightingGlobalFactor * (1.0 - additionalAmbientScale);":"float shadow \x3d 0.0;",d.attributeColor?N.glsl(Q||(Q=t(["\n        vec3 albedo_ \x3d mixExternalColor(vColor.rgb * matColor, texColor.rgb, vcolorExt.rgb, int(colorMixMode));\n        float opacity_ \x3d layerOpacity * mixExternalOpacity(vColor.a * opacity, texColor.a, vcolorExt.a, int(colorMixMode));"],
["\n        vec3 albedo_ \x3d mixExternalColor(vColor.rgb * matColor, texColor.rgb, vcolorExt.rgb, int(colorMixMode));\n        float opacity_ \x3d layerOpacity * mixExternalOpacity(vColor.a * opacity, texColor.a, vcolorExt.a, int(colorMixMode));"]))):N.glsl(U||(U=t(["\n        vec3 albedo_ \x3d mixExternalColor(matColor, texColor.rgb, vcolorExt.rgb, int(colorMixMode));\n        float opacity_ \x3d layerOpacity * mixExternalOpacity(opacity, texColor.a, vcolorExt.a, int(colorMixMode));\n        "],
["\n        vec3 albedo_ \x3d mixExternalColor(matColor, texColor.rgb, vcolorExt.rgb, int(colorMixMode));\n        float opacity_ \x3d layerOpacity * mixExternalOpacity(opacity, texColor.a, vcolorExt.a, int(colorMixMode));\n        "]))),N.glsl(V||(V=t(["\n        vec3 shadedNormal \x3d normalize(vNormalWorld);\n        albedo_ *\x3d 1.2;\n        vec3 viewForward \x3d - vec3(view[0][2], view[1][2], view[2][2]);\n        float alignmentLightView \x3d clamp(dot(-viewForward, lightingMainDirection), 0.0, 1.0);\n        float transmittance \x3d 1.0 - clamp(dot(-viewForward, shadedNormal), 0.0, 1.0);\n        float treeRadialFalloff \x3d vColor.r;\n        float backLightFactor \x3d 0.5 * treeRadialFalloff * alignmentLightView * transmittance * (1.0 - shadow);\n        additionalLight +\x3d backLightFactor * lightingMainIntensity;"],
["\n        vec3 shadedNormal \x3d normalize(vNormalWorld);\n        albedo_ *\x3d 1.2;\n        vec3 viewForward \x3d - vec3(view[0][2], view[1][2], view[2][2]);\n        float alignmentLightView \x3d clamp(dot(-viewForward, lightingMainDirection), 0.0, 1.0);\n        float transmittance \x3d 1.0 - clamp(dot(-viewForward, shadedNormal), 0.0, 1.0);\n        float treeRadialFalloff \x3d vColor.r;\n        float backLightFactor \x3d 0.5 * treeRadialFalloff * alignmentLightView * transmittance * (1.0 - shadow);\n        additionalLight +\x3d backLightFactor * lightingMainIntensity;"]))),
1===d.pbrMode||2===d.pbrMode?0===d.viewingMode?N.glsl(Y||(Y=t(["vec3 normalGround \x3d normalize(vpos + localOrigin);"],["vec3 normalGround \x3d normalize(vpos + localOrigin);"]))):N.glsl(T||(T=t(["vec3 normalGround \x3d vec3(0.0, 0.0, 1.0);"],["vec3 normalGround \x3d vec3(0.0, 0.0, 1.0);"]))):N.glsl(aa||(aa=t([""],[""]))),1===d.pbrMode||2===d.pbrMode?N.glsl(W||(W=t(["\n            float additionalAmbientIrradiance \x3d additionalAmbientIrradianceFactor * lightingMainIntensity[2];\n            vec3 shadedColor \x3d evaluateSceneLightingPBR(shadedNormal, albedo_, shadow, 1.0 - ssao, additionalLight, viewDirection, normalGround, mrr, emission, additionalAmbientIrradiance);"],
["\n            float additionalAmbientIrradiance \x3d additionalAmbientIrradianceFactor * lightingMainIntensity[2];\n            vec3 shadedColor \x3d evaluateSceneLightingPBR(shadedNormal, albedo_, shadow, 1.0 - ssao, additionalLight, viewDirection, normalGround, mrr, emission, additionalAmbientIrradiance);"]))):"vec3 shadedColor \x3d evaluateSceneLighting(shadedNormal, albedo_, shadow, 1.0 - ssao, additionalLight);")));A.include(w.DefaultMaterialAuxiliaryPasses,d);return A};var P,S,R,Q,U,V,Y,T,
aa,W,p})},"esri/views/3d/support/buffer/math":function(){define(["require","exports","./math/vec3","./math/vec4"],function(z,d,t,l){Object.defineProperty(d,"__esModule",{value:!0});d.vec3=t;d.vec4=l})},"esri/views/3d/support/buffer/math/vec3":function(){define(["require","exports","./common"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});d.transformMat4=function(d,q,b){if(d.count!==q.count)t.logger.error("source and destination buffers need to have the same number of elements");
else{var f=d.count,h=b[0],l=b[1],c=b[2],a=b[4],m=b[5],u=b[6],z=b[8],w=b[9],v=b[10],E=b[12],C=b[13];b=b[14];var J=d.typedBuffer;d=d.typedBufferStride;var K=q.typedBuffer;q=q.typedBufferStride;for(var G=0;G<f;G++){var I=G*d,x=G*q,N=K[x],O=K[x+1],x=K[x+2];J[I]=h*N+a*O+z*x+E;J[I+1]=l*N+m*O+w*x+C;J[I+2]=c*N+u*O+v*x+b}}};d.transformMat3=function(d,q,b){if(d.count!==q.count)t.logger.error("source and destination buffers need to have the same number of elements");else{var f=d.count,h=b[0],l=b[1],c=b[2],a=
b[3],m=b[4],u=b[5],z=b[6],w=b[7];b=b[8];var v=d.typedBuffer;d=d.typedBufferStride;var E=q.typedBuffer;q=q.typedBufferStride;for(var C=0;C<f;C++){var J=C*d,K=C*q,G=E[K],I=E[K+1],K=E[K+2];v[J]=h*G+a*I+z*K;v[J+1]=l*G+m*I+w*K;v[J+2]=c*G+u*I+b*K}}};d.scale=function(d,q,b){var f=Math.min(d.count,q.count),h=d.typedBuffer;d=d.typedBufferStride;var l=q.typedBuffer;q=q.typedBufferStride;for(var c=0;c<f;c++){var a=c*d,m=c*q;h[a]=b*l[m];h[a+1]=b*l[m+1];h[a+2]=b*l[m+2]}};d.shiftRight=function(d,q,b){var f=Math.min(d.count,
q.count),h=d.typedBuffer;d=d.typedBufferStride;var l=q.typedBuffer;q=q.typedBufferStride;for(var c=0;c<f;c++){var a=c*d,m=c*q;h[a]=l[m]>>b;h[a+1]=l[m+1]>>b;h[a+2]=l[m+2]>>b}}})},"esri/views/3d/support/buffer/math/common":function(){define(["require","exports","../../../../../core/Logger"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});d.logger=t.getLogger("esri.views.3d.support.buffer.math")})},"esri/views/3d/support/buffer/math/vec4":function(){define(["require","exports","./common"],
function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});d.transformMat4=function(d,q,b){if(d.count!==q.count)t.logger.error("source and destination buffers need to have the same number of elements");else{var f=d.count,h=b[0],l=b[1],c=b[2],a=b[3],m=b[4],u=b[5],z=b[6],w=b[7],v=b[8],E=b[9],C=b[10],J=b[11],K=b[12],G=b[13],I=b[14];b=b[15];var x=d.typedBuffer;d=d.typedBufferStride;var N=q.typedBuffer;q=q.typedBufferStride;for(var O=0;O<f;O++){var P=O*d,S=O*q,R=N[S],Q=N[S+1],U=N[S+2],S=N[S+3];x[P]=
h*R+m*Q+v*U+K*S;x[P+1]=l*R+u*Q+E*U+G*S;x[P+2]=c*R+z*Q+C*U+I*S;x[P+3]=a*R+w*Q+J*U+b*S}}};d.transformMat3=function(d,q,b){if(d.count!==q.count)t.logger.error("source and destination buffers need to have the same number of elements");else{var f=d.count,h=b[0],l=b[1],c=b[2],a=b[3],m=b[4],u=b[5],z=b[6],w=b[7];b=b[8];var v=d.typedBuffer;d=d.typedBufferStride;var E=q.typedBuffer;q=q.typedBufferStride;for(var C=0;C<f;C++){var J=C*d,K=C*q,G=E[K],I=E[K+1],x=E[K+2],K=E[K+3];v[J]=h*G+a*I+z*x;v[J+1]=l*G+m*I+w*
x;v[J+2]=c*G+u*I+b*x;v[J+3]=K}}};d.scale=function(d,q,b){var f=Math.min(d.count,q.count),h=d.typedBuffer;d=d.typedBufferStride;var l=q.typedBuffer;q=q.typedBufferStride;for(var c=0;c<f;c++){var a=c*d,m=c*q;h[a]=b*l[m];h[a+1]=b*l[m+1];h[a+2]=b*l[m+2];h[a+3]=b*l[m+3]}};d.shiftRight=function(d,q,b){var f=Math.min(d.count,q.count),h=d.typedBuffer;d=d.typedBufferStride;var l=q.typedBuffer;q=q.typedBufferStride;for(var c=0;c<f;c++){var a=c*d,m=c*q;h[a]=l[m]>>b;h[a+1]=l[m+1]>>b;h[a+2]=l[m+2]>>b;h[a+3]=l[m+
3]>>b}}})},"esri/views/support/drapedUtils":function(){define("require exports ../../geometry ../../core/maybe ../../core/unitUtils ../../renderers/support/clickToleranceUtils".split(" "),function(z,d,t,l,q,b){function f(b,c,a,d){void 0===d&&(d=new t.Extent);var f;if("2d"===a.type)f=c*a.resolution;else if("3d"===a.type){var h=a.basemapTerrain,l=h.overlayManager,l=l?l.overlayPixelSizeInMapUnits(b):1;f=h&&!h.spatialReference.equals(a.spatialReference)?q.getMetersPerUnitForSR(h.spatialReference)/q.getMetersPerUnitForSR(a.spatialReference):
c*l}c=b.x-f;h=b.y-f;l=b.x+f;b=b.y+f;a=a.spatialReference;d.xmin=Math.min(c,l);d.ymin=Math.min(h,b);d.xmax=Math.max(c,l);d.ymax=Math.max(h,b);d.spatialReference=a;return d}Object.defineProperty(d,"__esModule",{value:!0});d.createQueryGeometry=f;d.intersectsDrapedGeometry=function(d,c,a){d=a.toMap(d);if(l.isNone(d))return null;var m=b.calculateTolerance();return f(d,m,a,h).intersects(c)?d:null};var h=new t.Extent})},"esri/widgets/Editor/UpdateWorkflow":function(){define("require exports ../../core/tsSupport/generatorHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/awaiterHelper ../../core/tsSupport/declareExtendsHelper ../../core/arrayUtils ../../core/promiseUtils ../../core/watchUtils ../../core/accessorSupport/decorators ../../views/support/layerViewUtils ./Edits ./UpdateWorkflowData ./Workflow ./workflowUtils".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u,D,w){return function(d){function v(a){a=d.call(this,a)||this;a.type="update";return a}b(v,d);C=v;v.create=function(a,b,c){a=new u({edits:new m,viewModel:a});c=new C({data:a,afterCommit:c});c._set("steps",this._createWorkflowSteps(c,b));return c};v.prototype.highlight=function(b){var c=this.data.viewModel.view,c=b&&f.find(c.allLayerViews.items,function(a){return a.layer===b.layer});a.highlightsSupported(c)&&this.handles.add(c.highlight(b),"candidate-highlight")};
v.prototype.unhighlight=function(){this.handles.remove("candidate-highlight")};v._createWorkflowSteps=function(a,b){void 0===b&&(b="awaiting-feature-to-update");var c=a.data,d=a.handles,f={"awaiting-feature-to-update":function(){return{id:"awaiting-feature-to-update",setUp:function(){return q(this,void 0,void 0,function(){var a,b,f,l,m;return t(this,function(q){a=c.viewModel;b=a.spinnerViewModel;f=a.view;l=null;d.add({remove:function(){l&&(l.abort(),l=null)}},this.id);c.edits.feature=null;m=f.on("immediate-click",
function(a){a.stopPropagation();b.location=a.mapPoint;b.visible=!0;l&&l.abort();var d=c.viewModel.editableItems;l=h.createAbortController();h.create(function(b,c){h.onAbort(l.signal,function(){return c(h.createAbortError())});b(w.fetchCandidates(d,f,a))}).then(function(a){c.viewModel.spinnerViewModel.visible=!1;h.throwIfAborted(l);c.candidates=a.reduce(function(a,b){return b.error?a:a.concat(b.value)},[]);0!==c.candidates.length&&(1===c.candidates.length?(c.edits.feature=c.candidates[0],c.viewModel.activeWorkflow.go("editing-existing-feature")):
c.viewModel.activeWorkflow.next())})});d.add(m,this.id);return[2]})})},tearDown:function(){return q(this,void 0,void 0,function(){return t(this,function(a){d.remove(this.id);return[2]})})}}},"awaiting-update-feature-candidate":function(){return{id:"awaiting-update-feature-candidate",setUp:function(){return q(this,void 0,void 0,function(){var b;return t(this,function(f){b=c.edits;b.feature=null;d.add(r.watch(b,"feature",function(b){a.unhighlight();a.highlight(b)}),this.id);return[2]})})},tearDown:function(){return q(this,
void 0,void 0,function(){return t(this,function(b){a.unhighlight();d.remove(this.id);return[2]})})}}},"editing-existing-feature":function(){return{id:"editing-existing-feature",setUp:function(){return q(this,void 0,void 0,function(){var b,f,l,m=this;return t(this,function(r){b=c.edits.feature;f=c.viewModel;c.editableItem=f.editableItems.find(function(a){return a.layer===b.layer});l=h.createAbortController();d.add({remove:function(){return l.abort()}},this.id);return[2,w.fetchFullFeature(b,f.view,
l).then(function(b){return q(m,void 0,void 0,function(){var m,q,r,v,u,p,x,A,k;return t(this,function(e){switch(e.label){case 0:if(h.isAborted(l))return[2];c.edits.updateGeometry(b.geometry);c.edits.updateAttributes(b.attributes);c.edits.trackChanges();m=b.layer;r=(q=w.findLayerInfo(f.layerInfos,m))&&q.fieldConfig;f.attachmentsViewModel.set({graphic:b,mode:"view"});f.featureFormViewModel.set({feature:b,fieldConfig:r});v=[f.featureFormViewModel.on("value-change",function(){c.edits.updateAttributes(f.featureFormViewModel.getValues());
b.attributes=c.edits.feature.attributes}),f.attachmentsViewModel.watch("mode",function(e){"add"===e&&c.viewModel.activeWorkflow.go("adding-attachment");"edit"===e&&c.viewModel.activeWorkflow.go("editing-attachment")})];u=m.capabilities.editing.supportsGeometryUpdate;if(!u)return[3,2];p=w.getVisualVariableAttributes(b);return[4,w.setUpGeometryUpdate(b,p,f.sketchViewModel,f.view,function(e){var g=e.geometry;e=e.attributes;if(p.rotation){var a=p.rotation.field;f.featureFormViewModel.setValue(a,e[a])}p.size&&
(a=p.size.field,f.featureFormViewModel.setValue(a,e[a]));c.edits.updateAttributes(e);c.edits.updateGeometry(g)})];case 1:return x=e.sent(),A=x.interactive,k=x.visual,v.push(A,k),d.add(A,a._handleKeys.beforeCommit),d.add(k,a._handleKeys.afterCommit),[3,3];case 2:a.highlight(b),e.label=3;case 3:return d.add(v,this.id),[2]}})})})]})})},tearDown:function(){return q(this,void 0,void 0,function(){return t(this,function(b){c.editableItem=null;c.viewModel.featureFormViewModel.set({feature:null,fieldConfig:null});
d.remove(this.id);a.unhighlight();return[2]})})}}},"adding-attachment":function(){return{id:"adding-attachment",parent:"editing-existing-feature",setUp:function(){return q(this,void 0,void 0,function(){return t(this,function(a){return[2]})})},tearDown:function(){return q(this,void 0,void 0,function(){return t(this,function(a){return[2]})})}}},"editing-attachment":function(){return{id:"editing-attachment",parent:"editing-existing-feature",setUp:function(){return q(this,void 0,void 0,function(){return t(this,
function(a){return[2]})})},tearDown:function(){return q(this,void 0,void 0,function(){return t(this,function(a){return[2]})})}}}},l=!1;return["awaiting-feature-to-update","awaiting-update-feature-candidate","editing-existing-feature","adding-attachment","editing-attachment"].filter(function(a){return l?!0:l=a===b}).map(function(a){return f[a]()})};var C;return v=C=l([c.subclass("esri.widgets.Editor.UpdateWorkflow")],v)}(c.declared(D))})},"esri/widgets/Editor/UpdateWorkflowData":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators".split(" "),
function(z,d,t,l,q,b){return function(d){function f(){var b=null!==d&&d.apply(this,arguments)||this;b.candidates=null;b.editableItem=null;b.edits=null;b.viewModel=null;return b}t(f,d);l([b.property()],f.prototype,"candidates",void 0);l([b.property()],f.prototype,"editableItem",void 0);l([b.property()],f.prototype,"edits",void 0);l([b.property()],f.prototype,"viewModel",void 0);return f=l([b.subclass("esri.widgets.Editor.UpdateWorkflowData")],f)}(b.declared(q))})},"esri/widgets/Sketch/SketchViewModel":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../geometry ../../Graphic ../../symbols ../../core/Collection ../../core/compilerUtils ../../core/Error ../../core/Evented ../../core/Handles ../../core/Logger ../../core/maybe ../../core/screenUtils ../../core/watchUtils ../../core/accessorSupport/decorators ../../geometry/support/coordsUtils ../../layers/GraphicsLayer ../../support/elevationInfoUtils ../../symbols/SimpleFillSymbol ../../symbols/SimpleLineSymbol ../../symbols/SimpleMarkerSymbol ../../views/DOMContainer ../../views/3d/interactive/editingTools/isSupportedGraphicUtils ../../views/3d/interactive/editingTools/graphicMove3D/isSupportedGraphic ../../views/3d/interactive/editingTools/graphicReshape3D/isSupportedGraphic ../../views/3d/interactive/editingTools/graphicTransform3D/isSupportedGraphic ../../views/draw/Draw ../../views/draw/support/createUtils ../../views/draw/support/layerUtils ../../views/input/InputManager ./support/OperationHandle @dojo/framework/shim/Promise".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u,D,w,v,E,C,J,K,G,I,x,N,O,P,S,R,Q,U,V,Y,T,aa,W,p){function L(e,g){var a=e.history.undo.pop().updates,n=[];g.forEach(function(e,g){g=a[g];var k={};null!=g&&(E.isSome(g.geometry)&&(k.geometry=e.geometry,e.geometry=g.geometry),E.isSome(g.symbol)&&(k.symbol=e.symbol,e.symbol=g.symbol),n.push(k))});e.history.redo.push({updates:n})}function A(e,g){var a=e.history.redo.pop().updates,n=[];g.forEach(function(e,g){g=a[g];var k={};null!=g&&(E.isSome(g.geometry)&&(k.geometry=
e.geometry,e.geometry=g.geometry),E.isSome(g.symbol)&&(k.symbol=e.symbol,e.symbol=g.symbol),n.push(k))});e.history.undo.push({updates:n})}function k(e){return{updates:e.map(function(e){return{geometry:e.geometry}})}}function e(e){return{updates:e.map(function(e){return{symbol:e.symbol}})}}function g(e){return"requireError"in e&&"aborted"===e.requireError}var n=v.getLogger("esri.widgets.Sketch.SketchViewModel"),y=["Backspace","Delete"];return function(d){function B(e){e=d.call(this,e)||this;e._activeFillGraphic=
null;e._activeLineGraphic=null;e._centerIndicatorGraphic=null;e._centerSymbol=new P({style:"cross",size:6,color:[255,255,255]});e._defaultSegmentOffset=48;e._handles=new w;e._internalGraphicsLayer=new I({listMode:"hide"});e._lineGraphic=null;e._operationHandle=null;e._vertexGraphics=[];e._viewHandles=new w;e._doUnnormalization=!1;e.activeFillSymbol=new N({style:"solid",color:[150,150,150,.2],outline:{color:[0,0,0,0]}});e.activeLineSymbol=new O({color:[12,207,255,1],width:2,style:"dash"});e.activePointSymbol=
new P({style:"circle",size:6,color:[12,207,255],outline:{color:[50,50,50],width:1}});e.activeVertexSymbol=new P({style:"circle",size:6,color:[12,207,255],outline:{color:[50,50,50],width:1}});e.createGraphic=null;e.defaultCreateOptions={mode:"hybrid"};e.defaultUpdateOptions={enableMidpoints:!0,enableMoveAllGraphics:!0,enableRotation:!0,enableScaling:!0,multipleSelectionEnabled:!0,preserveAspectRatio:!1,toggleToolOnClick:!0,tool:"transform",enableZ:!0};e.layer=null;e.pointSymbol=new P({style:"circle",
size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}});e.polygonSymbol=new N({color:[150,150,150,.2],outline:{color:[50,50,50],width:2}});e.polylineSymbol=new O({color:[130,130,130,1],width:2});e.updateGraphics=new a;e.updateOnGraphicClick=!0;e.updatePointSymbol=new P({size:10,color:[0,200,255,.5],outline:{color:"black",width:1}});e.updatePolygonSymbol=new N({color:[12,207,255,.2],outline:{join:"round",color:[12,207,255],width:2}});e.updatePolylineSymbol=new O({color:[12,207,255],width:2});
e.vertexSymbol=new P({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}});return e}l(B,d);B.prototype.initialize=function(){var e=this;this._handles.add([J.watch(this,"layer",function(){e.cancel();e._internalGraphicsLayer.elevationInfo=E.isSome(e.layer)?e.layer.elevationInfo:null}),J.on(this,"view.map.layers","change",function(g){0<=g.removed.indexOf(e.layer)&&e.cancel()}),J.on(this,"layer.graphics","change",function(g){if(E.isSome(e._operationHandle)){var a=0;for(g=g.removed;a<
g.length;a++){var n=g[a];e.updateGraphics.includes(n)&&(1<e.updateGraphics.length?e._operationHandle.removeFromSelection(n):e._operationHandle.cancel())}}}),J.init(this,"layer.elevationInfo",function(){e.cancel();e._internalGraphicsLayer.elevationInfo=E.isSome(e.layer)?e.layer.elevationInfo:null},!0)])};B.prototype.destroy=function(){this.cancel();this._handles.removeAll();this._handles=null;this._viewHandles.removeAll();this._viewHandles=null;this._removeDefaultLayer();this._draw&&this._draw.destroy();
this._set("view",null);this.emit("destroy")};Object.defineProperty(B.prototype,"_defaultUpdateTool",{get:function(){return"3d"===this.view.type?"move":"transform"},enumerable:!0,configurable:!0});Object.defineProperty(B.prototype,"_draw",{get:function(){return"ready"===this.state||"active"===this.state?new Y({view:this.view}):null},enumerable:!0,configurable:!0});Object.defineProperty(B.prototype,"activeTool",{get:function(){return this._operationHandle&&this._operationHandle.tool?this._operationHandle.tool:
null},enumerable:!0,configurable:!0});Object.defineProperty(B.prototype,"activeComponent",{get:function(){return this._operationHandle?this._operationHandle.activeComponent:null},enumerable:!0,configurable:!0});Object.defineProperty(B.prototype,"state",{get:function(){var e=!(!this.get("view.ready")||!this.layer),g=this._operationHandle;return e&&g?"active":e?"ready":"disabled"},enumerable:!0,configurable:!0});Object.defineProperty(B.prototype,"view",{get:function(){return this._get("view")},set:function(e){var g=
this,a=this._get("view");if(a){var n=a.map;a.container&&(a.cursor=null);n&&n.remove(this._internalGraphicsLayer);this._viewHandles.removeAll();this.cancel()}this._doUnnormalization=null!=e&&"3d"===e.type&&"global"===e.viewingMode;this._handles.remove("view-ready");e&&this._handles.add(J.when(e,"ready",function(a){g._viewHandles.removeAll();a&&g._viewHandles.add(g._generateViewHandles(e))},!0),"view-ready");this._set("view",e)},enumerable:!0,configurable:!0});B.prototype.cancel=function(){this._moduleLoaderAbortController&&
(this._moduleLoaderAbortController.abort(),this._moduleLoaderAbortController=null);this._operationHandle&&this._operationHandle.cancel()};B.prototype.complete=function(){this._operationHandle&&this._operationHandle.complete()};B.prototype.delete=function(){var e=this.updateGraphics;if("active"===this.state&&e.length){var g=this.activeTool,a=this.layer,e=e.toArray();a.removeMany(e);this.cancel();this._emitDeleteEvent({graphics:e,tool:g})}};B.prototype.create=function(e,g){var a=this;if("disabled"===
this.state)this.layer||this._logError("sketch:missing-property","Property 'layer' is missing on SketchViewModel."),this.view||this._logError("sketch:missing-property","Property 'view' is missing on SketchViewModel.");else if(this.cancel(),e){var n=this._setupCreateOperation(e,g);E.isNone(n)||(aa.addUniqueLayer(this.view,this._internalGraphicsLayer),n.on("complete",function(){if(n===a._operationHandle){var g=a.createGraphic,k=a._operationHandle.cancelled;a._operationHandle.destroy();a._operationHandle=
null;a._set("createGraphic",null);a.view&&a.view.map&&a.view.map.remove(a._internalGraphicsLayer);n.cancelled||a.layer.add(g);a.emit("create",{graphic:g,state:k?"cancel":"complete",tool:e,toolEventInfo:null,type:"create"})}}),this._operationHandle=n,this.view.ready&&S.isDOMContainer(this.view)&&this.view.focus())}else this._logError("sketch:missing-parameter","Missing parameter 'tool'.")};B.prototype.update=function(e,a){return f(this,void 0,void 0,function(){var n,k,c,d,y,p,B,F=this;return b(this,
function(b){switch(b.label){case 0:n=this;k=n.layer;c=n.state;d=n.view;if("disabled"===c)return k||this._logError("sketch:missing-property","Property 'layer' is missing on SketchViewModel."),d||this._logError("sketch:missing-property","Property 'view' is missing on SketchViewModel."),[2];this.cancel();y=Array.isArray(e)?e:[e];return null!=e&&y&&y.length?(p=y.some(function(e){return e.layer!==k?(F._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics missing from the supplied GraphicsLayer."),
!0):E.isNone(e.geometry)?(F._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics with an unsupported geometry."),!0):"2d"!==d.type||d.spatialReference.equals(e.geometry.spatialReference)?!1:(F._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics with a spatial reference different from the supplied MapView."),!0)}))?[2]:[4,this._setupUpdateOperation(y,a)]:(this._logError("sketch:missing-parameter","Missing parameter 'graphics'."),
[2]);case 1:B=b.sent();if(E.isNone(B)||g(B))return[2];aa.addUniqueLayer(this.view,this._internalGraphicsLayer);this.emit("update",{graphics:y,state:"start",aborted:!1,tool:B.tool,toolEventInfo:null,type:"update"});this._setUpdateOperationHandle(B);return[2]}})})};B.prototype.undo=function(){this.canUndo()&&this._operationHandle.undo()};B.prototype.redo=function(){this.canRedo()&&this._operationHandle.redo()};B.prototype.canUndo=function(){return!(!this._operationHandle||!this._operationHandle.canUndo())};
B.prototype.canRedo=function(){return!(!this._operationHandle||!this._operationHandle.canRedo())};B.prototype.toggleUpdateTool=function(){this._operationHandle&&this._operationHandle.toggleTool&&this._operationHandle.toggleTool()};Object.defineProperty(B.prototype,"snapToScene",{set:function(e){this._operationHandle&&this._operationHandle.setSnapToScene&&this._operationHandle.setSnapToScene(e);this._set("snapToScene",e)},enumerable:!0,configurable:!0});B.prototype._getFirstHit=function(e){return f(this,
void 0,void 0,function(){var g;return b(this,function(a){switch(a.label){case 0:return[4,this.view.hitTest(e)];case 1:return g=a.sent(),0<g.results.length?[2,{screenPoint:e,results:[g.results[0]]}]:[2,{screenPoint:e,results:[]}]}})})};B.prototype._generateViewHandles=function(e){var g=this;return[e.on("immediate-click",function(e){var a=g._operationHandle,n=g.defaultUpdateOptions,k=g.layer,b=g.state,c=g.updateGraphics,d=g.updateOnGraphicClick,a="active"===b&&"create"===a.type;"disabled"!==b&&!a&&
d&&g._getFirstHit(C.createScreenPointFromEvent(e)).then(function(a){a=a.results;a.length?a.some(function(e){if(e.graphic){e=e.graphic;if(-1<c.indexOf(e))return!0;if(e.layer===k)return g.update([e],t({},n)),!0}return!1})&&e.stopPropagation():"active"===b&&g.cancel()})},W.ViewEventPriorities.WIDGET)]};B.prototype._setupCreateOperation=function(e,g){if(!e)return null;g=t({hasZ:"3d"===this.view.type,defaultZ:0},this.defaultCreateOptions,g);var a;switch(e){case "point":a=this._setupCreatePointOperation(e,
g);break;case "multipoint":a=this._setupCreateMultipointOperation(e,null);break;case "polygon":case "polyline":a=this._setupCreatePolyOperation(e,g);break;case "rectangle":a=this._setupCreateRectangleOperation(e,g);break;case "circle":a=this._setupCreateCircleOperation(e,g)}return a};B.prototype._setupCreatePointOperation=function(e,g){var a=this,n={elevationInfo:this.layer.elevationInfo,hasZ:g.hasZ,defaultZ:g.defaultZ,interactiveUndoDisabled:!0};g=this._draw.create(e,n);g.snapToScene=this._getDefaultSnapToScene(n.elevationInfo);
var n=[g.on("cursor-update",function(e){E.isSome(e.coordinates)?a._displayCrosshairCursor():a._displayDefaultCursor()}),g.on("draw-complete",function(e){e=a.createPointFromVertex(e.coordinates);e=new r(e,a.pointSymbol);a._set("createGraphic",e);b&&b.complete()})],k=[this.view.on("key-down",function(e){"Escape"===e.key&&(b&&b.cancel(),e.stopPropagation())},W.ViewEventPriorities.WIDGET)],b=this._operationHandleForCreateAction(g,n.concat(k),e);return b};B.prototype._setupCreateMultipointOperation=function(e,
g){var a=this;g=t({},g,{undoDisabled:!0});g=this._draw.create(e,g);var n=null,k=[],b=this._operationHandleForCreateAction(g,k,e);k.push(g.on("vertex-add",function(g){var k=g.type,b=g.vertexIndex,c=g.vertices,d=c[b];n=g;a._drawMultipointGraphic(c,!0);a.emit("create",{graphic:a.createGraphic,state:1===c.length?"start":"active",tool:e,toolEventInfo:{added:d,vertices:[{coordinates:d,componentIndex:0,vertexIndex:b}],type:k},type:"create"})}),g.on("vertex-remove",function(g){var k=g.type,b=g.vertexIndex,
c=g.vertices,d=c[b];n=g;a._drawMultipointGraphic(c,!0);a.emit("create",{graphic:a.createGraphic,state:"active",tool:e,toolEventInfo:{removed:d,vertices:[{coordinates:d,componentIndex:0,vertexIndex:b}],type:k},type:"create"})}),g.on("vertex-update",function(g){var k=g.type,b=g.vertexIndex,c=g.vertices,d=c[b];n=g;a._drawMultipointGraphic(c,!0);a.emit("create",{graphic:a.createGraphic,state:"active",tool:e,toolEventInfo:{type:k,updated:d,vertices:[{coordinates:d,componentIndex:0,vertexIndex:b}]},type:"create"})}),
g.on("cursor-update",function(e){n=e}),g.on("draw-complete",function(e){e=e.vertices.slice(0);(e=T.createMultipoint(e,a.view.spatialReference))&&a.createGraphic&&(a.createGraphic.geometry=e);b&&b.complete()}),g.on("undo",function(e){e=e.vertices;var g=n&&"cursor-update"!==n.type;a._resetCreateOperationGraphics();e.length&&a._drawMultipointGraphic(e,g)}),g.on("redo",function(e){e=e.vertices;var g=n&&"cursor-update"!==n.type;a._resetCreateOperationGraphics();e.length&&a._drawMultipointGraphic(e,g)}));
k.push(this.view.on("pointer-move",function(){return a._displayCrosshairCursor()},W.ViewEventPriorities.WIDGET),this.view.on("key-down",function(e){return a._getCommonUpdateOperationKeyDownHandlers(b,e)},W.ViewEventPriorities.WIDGET));return b};B.prototype._snapToScene3D=function(e,g){e=this.view.toMap(e,{exclude:[this._internalGraphicsLayer]});E.isSome(e)&&"3d"===this.view.type&&(e.z=x.getZForElevationMode(e,this.view,g));return e};B.prototype._getDefaultSnapToScene=function(e){var g=this;if("2d"===
this.view.type)return null;var a=null;return(a=E.isSome(this.snapToScene)?this.snapToScene:E.isSome(e)?"absolute-height"===e.mode:!0)?function(e,a){return g._snapToScene3D(e,a)}:null};B.prototype._setupCreatePolyOperation=function(e,g){var a=this;g=t({},g,{elevationInfo:this.layer.elevationInfo,interactiveUndoDisabled:!0});var n=null;"polyline"===e?n=this._draw.create(e,g):"polygon"===e&&(n=this._draw.create(e,g));var k=new h.Point,b=null,c=!1;n.snapToScene=this._getDefaultSnapToScene(g.elevationInfo);
g=[n.on("vertex-add",function(g){var n=g.type,k=g.vertexIndex,d=g.vertices,y=d[k];a._snap(e,d,c);b=g;a._drawVertexGraphics(e,d,{userClicked:!0});a.emit("create",{graphic:a.createGraphic,state:1===d.length?"start":"active",tool:e,toolEventInfo:{added:y,vertices:[{coordinates:y,componentIndex:0,vertexIndex:k}],type:n},type:"create"})}),n.on("vertex-remove",function(g){var n=g.type,k=g.vertexIndex,d=g.vertices,y=d[k];a._snap(e,d,c);b=g;a._drawVertexGraphics(e,d,{userClicked:!0});a.emit("create",{graphic:a.createGraphic,
state:"active",tool:e,toolEventInfo:{removed:y,vertices:[{coordinates:y,componentIndex:0,vertexIndex:k}],type:n},type:"create"})}),n.on("vertex-update",function(g){var n=g.type,k=g.vertexIndex,d=g.vertices,y=d[k];a._snap(e,d,c);b=g;a._drawVertexGraphics(e,d,{userClicked:!0});a.emit("create",{graphic:a.createGraphic,state:"active",tool:e,toolEventInfo:{type:n,updated:y,vertices:[{coordinates:y,componentIndex:0,vertexIndex:k}]},type:"create"})}),n.on("cursor-update",function(g){var n=g.type,d=g.vertices;
g.mapPoint&&(a._snap(e,d,c),b=g,k=g.mapPoint,a._drawVertexGraphics(e,d,{userClicked:!1}),1<d.length&&a.emit("create",{graphic:a.createGraphic,state:"active",tool:e,toolEventInfo:{coordinates:d[d.length-1],type:n},type:"create"}))}),n.on("draw-complete",function(g){g=g.vertices.slice(0);var n=null;"polyline"===e?n=T.createPolyline([g],a.view.spatialReference,a._doUnnormalization):"polygon"===e&&(n=T.createPolygon([g],a.view.spatialReference,a._doUnnormalization,!0));n&&(a.createGraphic.geometry=n);
B&&B.complete()}),n.on("undo",function(g){g=g.vertices;var n=b&&"cursor-update"!==b.type;a._resetCreateOperationGraphics();a._snap(e,g,c);g.length&&a._drawVertexGraphics(e,g,{userClicked:n})}),n.on("redo",function(g){g=g.vertices;var n=b&&"cursor-update"!==b.type;a._resetCreateOperationGraphics();a._snap(e,g,c);g.length&&a._drawVertexGraphics(e,g,{userClicked:n})})];var d=[this.view.on("pointer-move",function(e){a.view.toMap(C.createScreenPoint(e.x,e.y))?a._displayCrosshairCursor():a._displayDefaultCursor()},
W.ViewEventPriorities.WIDGET),this.view.on("key-down",function(g){var k=n.vertices.slice(0),d=b&&"cursor-update"!==b.type;"Control"===g.key?"2d"!==a.view.type||c||(c=!0,a._snap(e,k,!d),a._drawVertexGraphics(e,k,{userClicked:d})):"z"===g.key&&B&&B.canUndo()?(g.stopPropagation(),B.undo()):"r"===g.key&&B&&B.canRedo()?(g.stopPropagation(),B.redo()):"Escape"===g.key&&B&&B.cancel()},W.ViewEventPriorities.WIDGET),this.view.on("key-up",function(g){var d=n.vertices.slice(0),y=b&&"cursor-update"!==b.type;"Control"===
g.key&&c&&(y||(d.pop(),d.push([k.x,k.y]),a._drawVertexGraphics(e,d,{userClicked:y})),c=!1)},W.ViewEventPriorities.WIDGET)];if("polygon"===e){var y=function(e,g,n){if(!e||!e.layer||!e.visible)return!1;e=a.view.toScreen(e.geometry);return a._isWithinScreenDistance(e,g,n)},p=!1;d.push(this.view.on("pointer-move",function(){p=!1},W.ViewEventPriorities.WIDGET),this.view.on("pointer-down",function(e){var g;g=2>=a._vertexGraphics.length?void 0:y(a._vertexGraphics[0],e,a._getVertexIntersectDistance());g?
(p=!0,e.stopPropagation()):a._vertexGraphics.some(function(g){return y(g,e,a._getVertexIntersectDistance())})&&e.stopPropagation()},W.ViewEventPriorities.WIDGET),this.view.on("pointer-up",function(e){p&&(e.stopPropagation(),n.complete())}))}var B=this._operationHandleForCreateAction(n,g.concat(d),e);return B};B.prototype._setupCreateCircleOperation=function(e,g){var a=this;g=t({},g,{elevationInfo:this.layer.elevationInfo,interactiveUndoDisabled:!0});var n=this._draw.create(e,g),k=!1,b=!0;n.snapToScene=
this._getDefaultSnapToScene(g.elevationInfo);g=[n.on("vertex-add",function(g){var c=g.type,d=g.vertexIndex;g=g.vertices;var y=g[d];a._drawSegmentGraphic(e,g,{centered:b,constrained:k},n.viewAlignedCoordinateSystem);a.emit("create",{graphic:a.createGraphic,state:1===g.length?"start":"active",tool:e,toolEventInfo:{added:y,vertices:[{coordinates:y,componentIndex:0,vertexIndex:d}],type:c},type:"create"})}),n.on("cursor-update",function(g){var c=g.type;g=g.vertices;a._drawSegmentGraphic(e,g,{centered:b,
constrained:k},n.viewAlignedCoordinateSystem);2===g.length&&a.emit("create",{graphic:a.createGraphic,state:"active",tool:e,toolEventInfo:{coordinates:g[g.length-1],type:c},type:"create"})}),n.on("draw-complete",function(e){e=e.vertices.slice(0);var g=null;1===e.length?(e.push(n.viewAlignedCoordinateSystem.makeMapPoint(e[0][0]+a._defaultSegmentOffset*a.view.resolution,e[0][1])),g=T.createCircle(e,n.viewAlignedCoordinateSystem,!0)):g=k?T.createEllipse(e,n.viewAlignedCoordinateSystem,b):T.createCircle(e,
n.viewAlignedCoordinateSystem,b);a.createGraphic?a.createGraphic.geometry=g:(a._removeCreateGraphic(),a._set("createGraphic",new r(g,a.polygonSymbol)));d&&d.complete()})];var c=[this.view.on("pointer-move",function(e){E.isSome(n.getCoordsFromScreenPoint(C.createScreenPoint(e.x,e.y)))?a._displayCrosshairCursor():a._displayDefaultCursor()},W.ViewEventPriorities.WIDGET),this.view.on("key-down",function(g){"Control"===g.key?k||(k=!0,a._drawSegmentGraphic(e,n.vertices,{centered:b,constrained:k},n.viewAlignedCoordinateSystem)):
"Alt"===g.key?b&&(b=!1,a._drawSegmentGraphic(e,n.vertices,{centered:b,constrained:k},n.viewAlignedCoordinateSystem)):"Escape"===g.key&&d&&d.cancel()},W.ViewEventPriorities.WIDGET),this.view.on("key-up",function(g){"Control"===g.key?(k=!1,a._drawSegmentGraphic(e,n.vertices,{centered:b,constrained:k},n.viewAlignedCoordinateSystem)):"Alt"===g.key&&(b=!0,a._drawSegmentGraphic(e,n.vertices,{centered:b,constrained:k},n.viewAlignedCoordinateSystem))},W.ViewEventPriorities.WIDGET)],d=this._operationHandleForCreateAction(n,
g.concat(c),e);return d};B.prototype._setupCreateRectangleOperation=function(e,g){var a=this;g=t({},g,{elevationInfo:this.layer.elevationInfo,interactiveUndoDisabled:!0});var n=this._draw.create(e,g),k=!1,b=!1;n.snapToScene=this._getDefaultSnapToScene(g.elevationInfo);g=[n.on("vertex-add",function(g){var c=g.type,d=g.vertexIndex;g=g.vertices;var y=g[d];a._drawSegmentGraphic(e,g,{centered:b,constrained:k},n.viewAlignedCoordinateSystem);a.emit("create",{graphic:a.createGraphic,state:1===g.length?"start":
"active",tool:e,toolEventInfo:{added:y,vertices:[{coordinates:y,componentIndex:0,vertexIndex:d}],type:c},type:"create"})}),n.on("cursor-update",function(g){var c=g.type;g=g.vertices;a._drawSegmentGraphic(e,g,{centered:b,constrained:k},n.viewAlignedCoordinateSystem);2===g.length&&a.emit("create",{graphic:a.createGraphic,state:"active",tool:e,toolEventInfo:{coordinates:g[g.length-1],type:c},type:"create"})}),n.on("draw-complete",function(e){e=e.vertices.slice(0);var g=null;1===e.length&&(b=k=!1);g=
k?T.createSquare(e,n.viewAlignedCoordinateSystem,b):T.createRectangle(e,n.viewAlignedCoordinateSystem,b);a.createGraphic?a.createGraphic.geometry=g:(a._removeCreateGraphic(),a._set("createGraphic",new r(g,a.polygonSymbol)));d&&d.complete()})];var c=[this.view.on("pointer-move",function(e){E.isSome(n.getCoordsFromScreenPoint(C.createScreenPoint(e.x,e.y)))?a._displayCrosshairCursor():a._displayDefaultCursor()},W.ViewEventPriorities.WIDGET),this.view.on("key-down",function(g){"Control"===g.key?k||(k=
!0,a._drawSegmentGraphic(e,n.vertices,{centered:b,constrained:k},n.viewAlignedCoordinateSystem)):"Alt"===g.key?b||(b=!0,a._drawSegmentGraphic(e,n.vertices,{centered:b,constrained:k},n.viewAlignedCoordinateSystem)):"Escape"===g.key&&d&&d.cancel()},W.ViewEventPriorities.WIDGET),this.view.on("key-up",function(g){"Control"===g.key?(k=!1,a._drawSegmentGraphic(e,n.vertices,{centered:b,constrained:k},n.viewAlignedCoordinateSystem)):"Alt"===g.key&&(b=!1,a._drawSegmentGraphic(e,n.vertices,{centered:b,constrained:k},
n.viewAlignedCoordinateSystem))},W.ViewEventPriorities.WIDGET)],d=this._operationHandleForCreateAction(n,g.concat(c),e);return d};B.prototype._setupUpdateOperation=function(e,g){return f(this,void 0,void 0,function(){var a,n,k,c,d,y,B,p,F,f,H,M;return b(this,function(b){a=this;n=a._defaultUpdateTool;k=a.defaultUpdateOptions;c=a.layer;d=a.view;y=t({},k,g);B=y.tool||n;p=0;for(F=e;p<F.length;p++)f=F[p],c.remove(f),c.add(f);if("3d"===d.type){if(0===e.length)return[2,null];switch(B){case "move":return[2,
this._setupMove3DOperation(e,y,d,B)];case "reshape":if(1<e.length){this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics.");break}H=U.isSupportedGraphic(e[0]);if(0===H)return[2,this._setupReshape3DOperation(e[0],y,d)];this._logError("sketch:reshape","Reshape operation not supported for provided graphic(s) ("+R.isSupportedGraphicResultMessage(H)+").");break;case "transform":return 1===e.length&&0===V.isSupportedGraphic(e[0])?[2,this._setupPointTransform3DOperation(e[0],
y,d)]:[2,this._setupMove3DOperation(e,y,d,B)]}return[2,null]}if("move"===B)return[2,this._setupMoveOperation(e,y,d)];if(1<e.length)return"reshape"===B?(this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),[2,null]):[2,this._setupTransformOrReshapeOperation(e,B,y,d)];if(1===e.length){f=e[0];M=E.get(f.geometry,"type");if("point"===M||"multipoint"===M)return[2,this._setupMoveOperation(e,y,d)];if("transform"===B||"reshape"===B)return[2,this._setupTransformOrReshapeOperation(e,
B,y,d)]}return[2,null]})})};B.prototype._setupMove3DOperation=function(e,a,n,k,c){void 0===c&&(c=!1);return f(this,void 0,void 0,function(){var d,y,B,F,H,M,h,l,m=this;return b(this,function(X){switch(X.label){case 0:d=0;for(y=e;d<y.length;d++)if(B=y[d],F=Q.isSupportedGraphic(B),0!==F)return this._logError("sketch:move","Move operation not supported for provided graphic(s) ("+R.isSupportedGraphicResultMessage(F)+")."),[2,null];return[4,this._requireModule(new Promise(function(e,g){z(["../../views/3d/interactive/editingTools"],
e,g)}))];case 1:H=X.sent();if(g(H))return[2,H];M=new H.module.GraphicMove3DTool({view:n,enableZ:a.enableZ});this.view.tools.add(M);M.graphics.addMany(e);c||this.updateGraphics.addMany(e);h=[];l=new p.OperationHandle({activeComponent:M,tool:k,type:"update",onEnd:function(){h.forEach(function(e){return e.remove()});h.length=0;m.view.tools.remove(M);M.destroyed||M.destroy()},undo:function(){L(l,m.updateGraphics.toArray());m._emitUndoEvent({graphics:m.updateGraphics.toArray(),tool:k})},redo:function(){A(l,
m.updateGraphics.toArray());m._emitRedoEvent({graphics:m.updateGraphics.toArray(),tool:k})},addToSelection:function(e){m.updateGraphics.push(e);M.graphics.push(e);m.emit("update",{graphics:m.updateGraphics.toArray(),state:"active",aborted:!1,tool:m.activeTool,toolEventInfo:{added:[e],type:"selection-change"},type:"update"})},removeFromSelection:function(e){var g=m.updateGraphics.indexOf(e);l.history.undo.forEach(function(e){return e.updates.splice(g,1)});l.history.redo.forEach(function(e){return e.updates.splice(g,
1)});m.updateGraphics.remove(e);0===m.updateGraphics.length?l.complete():M.graphics.remove(e)},toggleTool:function(){return f(m,void 0,void 0,function(){var e,c;return b(this,function(b){switch(b.label){case 0:if(1!==this.updateGraphics.length||!1===a.toggleToolOnClick||"transform"!==k)return[2];e=this.updateGraphics.getItemAt(0);return 0!==U.isSupportedGraphic(e)?[2]:[4,this._setupReshape3DOperation(e,a,n,!0)];case 1:c=b.sent();if(g(c))return[2];l.onEnd();l.destroy();this._setUpdateOperationHandle(c);
return[2]}})})}});h.push.apply(h,this._getHandlesForComponent(l,a).concat([this.view.on("immediate-click",function(e){return m._getCommonUpdateOperationClickHandlers(l,e)},W.ViewEventPriorities.WIDGET),this.view.on("key-down",function(e){return m._getCommonUpdateOperationKeyDownHandlers(l,e)},W.ViewEventPriorities.WIDGET)]));return[2,l]}})})};B.prototype._setupPointTransform3DOperation=function(e,a,n){return f(this,void 0,void 0,function(){var k,c,d,y,B,F,H,M,h=this;return b(this,function(l){switch(l.label){case 0:return k=
"transform",c=a.enableRotation,d=a.enableScaling,y=a.enableZ,[4,this._requireModule(new Promise(function(e,g){z(["../../views/3d/interactive/editingTools"],e,g)}))];case 1:B=l.sent();if(g(B))return[2,B];F=new B.module.GraphicTransform3DTool({graphic:e,view:n,enableRotation:c,enableScaling:d,enableZ:y,snapToScene:this.snapToScene});this.view.tools.add(F);this.updateGraphics.add(e);H=[];M=new p.OperationHandle({activeComponent:F,tool:k,type:"update",onEnd:function(){H.forEach(function(e){return e.remove()});
H.length=0;h.view.tools.remove(F);F.destroyed||F.destroy()},undo:function(){L(M,h.updateGraphics.toArray());h._emitUndoEvent({graphics:h.updateGraphics.toArray(),tool:k})},redo:function(){A(M,h.updateGraphics.toArray());h._emitRedoEvent({graphics:h.updateGraphics.toArray(),tool:k})},addToSelection:function(e){return f(h,void 0,void 0,function(){var k;return b(this,function(b){switch(b.label){case 0:return this.updateGraphics.add(e),[4,this._setupMove3DOperation(this.updateGraphics.toArray(),a,n,"transform",
!0)];case 1:k=b.sent();if(g(k))return[2];M.onEnd();M.destroy();this._setUpdateOperationHandle(k);return[2]}})})},setSnapToScene:function(e){F.snapToScene=e}});H.push.apply(H,this._getHandlesForComponent(M,a).concat([this.view.on("immediate-click",function(e){return h._getCommonUpdateOperationClickHandlers(M,e)},W.ViewEventPriorities.WIDGET),this.view.on("key-down",function(e){return h._getCommonUpdateOperationKeyDownHandlers(M,e)},W.ViewEventPriorities.WIDGET)]));return[2,M]}})})};B.prototype._setupMoveOperation=
function(e,a,n){return f(this,void 0,void 0,function(){var k,c,d,y,B,F,f=this;return b(this,function(b){switch(b.label){case 0:return k=[],c="move",e.forEach(function(e){k.push(new r(e.geometry,e.symbol,e.attributes));e.symbol=f._getUpdateSymbol(e.geometry)}),this.updateGraphics.addMany(e),[4,this._getGraphicMover(e,a,n)];case 1:d=b.sent();if(g(d))return[2,d];y=new p.OperationHandle({activeComponent:d,tool:c,type:"update",onEnd:function(){F.forEach(function(e){return e.remove()});B.forEach(function(e){return e.remove()});
F=[];B=[];d.destroy();f._internalGraphicsLayer&&f._internalGraphicsLayer.removeMany(f.updateGraphics.toArray());f.updateGraphics.forEach(function(e,g){e.symbol=k[g].symbol})},undo:function(){L(y,f.updateGraphics.toArray());f._emitUndoEvent({graphics:f.updateGraphics.toArray(),tool:c})},redo:function(){A(y,f.updateGraphics.toArray());f._emitRedoEvent({graphics:f.updateGraphics.toArray(),tool:c})},addToSelection:function(e){k.push(new r(e.geometry,e.symbol,e.attributes));e.symbol=f._getUpdateSymbol(e.geometry);
f.updateGraphics.push(e);d.graphics=f.updateGraphics.toArray();f.emit("update",{graphics:f.updateGraphics.toArray(),state:"active",aborted:!1,tool:f.activeTool,toolEventInfo:{added:[e],type:"selection-change"},type:"update"})},removeFromSelection:function(e){var g=f.updateGraphics.indexOf(e);y.history.undo.forEach(function(e){return e.updates.splice(g,1)});y.history.redo.forEach(function(e){return e.updates.splice(g,1)});var a=k.splice(g,1)[0];e.symbol=a.symbol;f.updateGraphics.remove(e);0===f.updateGraphics.length?
y.complete():d.graphics=f.updateGraphics.toArray()}});B=[n.on("immediate-click",function(e){return f._getCommonUpdateOperationClickHandlers(y,e,a)},W.ViewEventPriorities.WIDGET),n.on("key-down",function(e){f._getCommonUpdateOperationKeyDownHandlers(y,e);"Control"!==e.key||e.repeat||(d.enableMoveAllGraphics=!d.enableMoveAllGraphics)},W.ViewEventPriorities.WIDGET),n.on("key-up",function(e){"Control"===e.key&&(d.enableMoveAllGraphics=!d.enableMoveAllGraphics)},W.ViewEventPriorities.WIDGET)];F=this._getHandlesForComponent(y,
a);return[2,y]}})})};B.prototype._setupReshape3DOperation=function(e,a,n,k){void 0===k&&(k=!1);return f(this,void 0,void 0,function(){var c,d,y,B,F,H=this;return b(this,function(M){switch(M.label){case 0:return c="reshape",[4,this._requireModule(new Promise(function(e,g){z(["../../views/3d/interactive/editingTools"],e,g)}))];case 1:d=M.sent();if(g(d))return[2,d];y=new d.module.GraphicReshape3DTool({view:n,graphic:e,enableZ:a.enableZ});n.tools.add(y);k||this.updateGraphics.add(e);B=[];F=new p.OperationHandle({activeComponent:y,
tool:c,type:"update",onEnd:function(){B.forEach(function(e){return e.remove()});B.length=0;n.tools.remove(y);y.destroyed||y.destroy()},undo:function(){L(F,H.updateGraphics.toArray());H._emitUndoEvent({graphics:H.updateGraphics.toArray(),tool:c})},redo:function(){A(F,H.updateGraphics.toArray());H._emitRedoEvent({graphics:H.updateGraphics.toArray(),tool:c})},addToSelection:function(e){return f(H,void 0,void 0,function(){var k;return b(this,function(b){switch(b.label){case 0:return this.updateGraphics.add(e),
[4,this._setupMove3DOperation(this.updateGraphics.toArray(),a,n,"transform",!0)];case 1:k=b.sent();if(g(k))return[2];F.onEnd();F.destroy();this._setUpdateOperationHandle(k);return[2]}})})},toggleTool:function(){return f(H,void 0,void 0,function(){var e;return b(this,function(k){switch(k.label){case 0:return!1===a.toggleToolOnClick?[2]:[4,this._setupMove3DOperation(this.updateGraphics.toArray(),a,n,"transform",!0)];case 1:e=k.sent();if(g(e))return[2];F.onEnd();F.destroy();this._setUpdateOperationHandle(e);
return[2]}})})}});B.push.apply(B,this._getHandlesForComponent(F,a).concat([n.on("immediate-click",function(e){return H._getCommonUpdateOperationClickHandlers(F,e)},W.ViewEventPriorities.WIDGET),n.on("key-down",function(e){return H._getCommonUpdateOperationKeyDownHandlers(F,e)},W.ViewEventPriorities.WIDGET)]));return[2,F]}})})};B.prototype._setupTransformOrReshapeOperation=function(e,a,n,k){return f(this,void 0,void 0,function(){var c,d,y,B,F,H,M,h,l,m,X=this;return b(this,function(q){switch(q.label){case 0:return c=
n.multipleSelectionEnabled,d=void 0===c?!0:c,y=n.toggleToolOnClick,B=void 0===y?!0:y,F=[],e.forEach(function(e){F.push(new r(e.geometry,e.symbol,e.attributes));e.symbol=X._getUpdateSymbol(e.geometry)}),this.updateGraphics.addMany(e),"transform"!==a?[3,2]:[4,this._getBox(e,n,k)];case 1:return M=q.sent(),[3,4];case 2:return[4,this._getReshape(e,n,k)];case 3:M=q.sent(),q.label=4;case 4:H=M;if(g(H))return[2,H];h=new p.OperationHandle({activeComponent:H,type:"update",onEnd:function(){m.forEach(function(e){return e.remove()});
l.forEach(function(e){return e.remove()});m=[];l=[];h.activeComponent&&!h.activeComponent.destroyed&&h.activeComponent.destroy();X._internalGraphicsLayer.removeMany(X.updateGraphics.toArray());X.updateGraphics.forEach(function(e,g){F[g]&&F[g].symbol&&(e.symbol=F[g].symbol)})},undo:function(){L(h,X.updateGraphics.toArray());h.refreshComponent();X._emitUndoEvent({graphics:X.updateGraphics.toArray(),tool:h.tool})},redo:function(){A(h,X.updateGraphics.toArray());h.refreshComponent();X._emitRedoEvent({graphics:X.updateGraphics.toArray(),
tool:h.tool})},addToSelection:function(e){var g=h.activeComponent;F.push(new r(e.geometry,e.symbol,e.attributes));e.symbol=X._getUpdateSymbol(e.geometry);X.updateGraphics.add(e);g.graphics=X.updateGraphics.toArray();g.refresh();h.resetHistory();X.emit("update",{graphics:X.updateGraphics.toArray(),state:"active",aborted:!1,tool:X.activeTool,toolEventInfo:{added:[e],type:"selection-change"},type:"update"})},removeFromSelection:function(e){var g=h.activeComponent,a=X.updateGraphics.indexOf(e);h.history.undo.forEach(function(e){return e.updates.splice(a,
1)});h.history.redo.forEach(function(e){return e.updates.splice(a,1)});var n=F.splice(a,1)[0];e.symbol=n.symbol;X.updateGraphics.remove(e);0===X.updateGraphics.length?h.complete():g.graphics=X.updateGraphics.toArray()},toggleTool:function(){return f(X,void 0,void 0,function(){var a;return b(this,function(b){switch(b.label){case 0:if(1<this.updateGraphics.length)return[2];a=null;return"transform"!==h.tool?[3,2]:[4,this._getReshape(e,n,k)];case 1:return a=b.sent(),[3,4];case 2:return"reshape"!==h.tool?
[3,4]:[4,this._getBox(e,n,k)];case 3:a=b.sent(),b.label=4;case 4:if(g(a))return[2];h.activeComponent.destroy();h.activeComponent=a;h.activeComponent&&(m.forEach(function(e){return e.remove()}),m=this._getHandlesForComponent(h,n));return[2]}})})}});l=[k.on("immediate-click",function(e){X._getFirstHit(C.createScreenPointFromEvent(e)).then(function(g){if(h)if(g=g.results,g.length){var a=h.activeComponent,n=e.native&&e.native.shiftKey;g.some(function(e){if(e.graphic){e=e.graphic;if(d&&n&&a&&"box"===a.type&&
!a.isUIGraphic(e))return h.addToSelection(e),!0;if(a&&"box"===a.type&&a.isUIGraphic(e))return!1!==B&&1===X.updateGraphics.length&&(e=X.updateGraphics.getItemAt(0).geometry,"extent"===E.get(e,"type")?X._logError("sketch:reshape-extent","Reshape operation does not support graphics with geometry of type 'extent'."):h.toggleTool()),!0;if(a&&"reshape"===a.type){if(e===a.graphic)return!1!==B&&h.toggleTool(),!0;if(a.isUIGraphic(e)||e.layer===X._internalGraphicsLayer)return!0}else e.layer===X.layer&&h.complete()}return!1})&&
e.stopPropagation()}else h.complete()})},W.ViewEventPriorities.WIDGET),k.on("key-down",function(e){X._getCommonUpdateOperationKeyDownHandlers(h,e);"Control"===e.key&&!e.repeat&&h&&(e=h.activeComponent)&&"box"===e.type&&(e.preserveAspectRatio=!e.preserveAspectRatio)},W.ViewEventPriorities.WIDGET),k.on("key-up",function(e){"Control"===e.key&&h&&(e=h.activeComponent)&&"box"===e.type&&(e.preserveAspectRatio=!e.preserveAspectRatio)},W.ViewEventPriorities.WIDGET)];m=this._getHandlesForComponent(h,n);return[2,
h]}})})};B.prototype._getGraphicMover=function(e,a,n){return f(this,void 0,void 0,function(){var k,c,d,y=this;return b(this,function(b){switch(b.label){case 0:return k=a.enableMoveAllGraphics,c=void 0===k?!0:k,[4,this._requireModule(new Promise(function(e,g){z(["../../views/draw/support/GraphicMover"],e,g)}))];case 1:return d=b.sent(),g(d)?[2,d]:[2,new d.module({enableMoveAllGraphics:c,graphics:e,view:n,callbacks:{onGraphicMoveStart:function(e){var g=e.dx,a=e.dy;e=e.graphic;return y.emit("update",
{graphics:y.updateGraphics.toArray(),state:"active",aborted:!1,tool:y.activeTool,toolEventInfo:{dx:g,dy:a,mover:e,type:"move-start"},type:"update"})},onGraphicMove:function(e){var g=e.dx,a=e.dy;e=e.graphic;return y.emit("update",{graphics:y.updateGraphics.toArray(),state:"active",aborted:!1,tool:y.activeTool,toolEventInfo:{dx:g,dy:a,mover:e,type:"move"},type:"update"})},onGraphicMoveStop:function(e){var g=e.dx,a=e.dy;e=e.graphic;return y.emit("update",{graphics:y.updateGraphics.toArray(),state:"active",
aborted:!1,tool:y.activeTool,toolEventInfo:{dx:g,dy:a,mover:e,type:"move-stop"},type:"update"})},onGraphicPointerOver:function(){return y._displayDefaultCursor()},onGraphicPointerOut:function(){return y._displayDefaultCursor()}}})]}})})};B.prototype._getBox=function(e,a,n){return f(this,void 0,void 0,function(){var k,c,d,y,B,p,F,f=this;return b(this,function(b){switch(b.label){case 0:return k=a.enableRotation,c=void 0===k?!0:k,d=a.enableScaling,y=void 0===d?!0:d,B=a.preserveAspectRatio,p=void 0===
B?!1:B,[4,this._requireModule(new Promise(function(e,g){z(["../../views/draw/support/Box"],e,g)}))];case 1:return F=b.sent(),g(F)?[2,F]:[2,new F.module({graphics:e,enableRotation:c,enableScaling:y,preserveAspectRatio:p,layer:this._internalGraphicsLayer,view:n,callbacks:{onMoveStart:function(e){return f.emit("update",{graphics:f.updateGraphics.toArray(),state:"active",aborted:!1,tool:f.activeTool,toolEventInfo:t({},e),type:"update"})},onMove:function(e){return f.emit("update",{graphics:f.updateGraphics.toArray(),
state:"active",aborted:!1,tool:f.activeTool,toolEventInfo:t({},e),type:"update"})},onMoveStop:function(e){return f.emit("update",{graphics:f.updateGraphics.toArray(),state:"active",aborted:!1,tool:f.activeTool,toolEventInfo:t({},e),type:"update"})},onScaleStart:function(e){return f.emit("update",{graphics:f.updateGraphics.toArray(),state:"active",aborted:!1,tool:f.activeTool,toolEventInfo:t({},e),type:"update"})},onScale:function(e){return f.emit("update",{graphics:f.updateGraphics.toArray(),state:"active",
aborted:!1,tool:f.activeTool,toolEventInfo:t({},e),type:"update"})},onScaleStop:function(e){return f.emit("update",{graphics:f.updateGraphics.toArray(),state:"active",aborted:!1,tool:f.activeTool,toolEventInfo:t({},e),type:"update"})},onRotateStart:function(e){return f.emit("update",{graphics:f.updateGraphics.toArray(),state:"active",aborted:!1,tool:f.activeTool,toolEventInfo:t({},e),type:"update"})},onRotate:function(e){return f.emit("update",{graphics:f.updateGraphics.toArray(),state:"active",aborted:!1,
tool:f.activeTool,toolEventInfo:t({},e),type:"update"})},onRotateStop:function(e){return f.emit("update",{graphics:f.updateGraphics.toArray(),state:"active",aborted:!1,tool:f.activeTool,toolEventInfo:t({},e),type:"update"})}}})]}})})};B.prototype._getReshape=function(e,a,n){return f(this,void 0,void 0,function(){var k,c,d,y=this;return b(this,function(b){switch(b.label){case 0:return k=a.enableMidpoints,c=void 0===k?!0:k,[4,this._requireModule(new Promise(function(e,g){z(["../../views/draw/support/Reshape"],
e,g)}))];case 1:return d=b.sent(),g(d)?[2,d]:[2,new d.module({enableMidpoints:c,graphic:e[0],layer:this._internalGraphicsLayer,view:n,callbacks:{onReshapeStart:function(e){return y.emit("update",{graphics:y.updateGraphics.toArray(),state:"active",aborted:!1,tool:y.activeTool,toolEventInfo:t({},e),type:"update"})},onReshape:function(e){return y.emit("update",{graphics:y.updateGraphics.toArray(),state:"active",aborted:!1,tool:y.activeTool,toolEventInfo:t({},e),type:"update"})},onReshapeStop:function(e){var g=
e.mover;e=e.type;return y.emit("update",{graphics:y.updateGraphics.toArray(),state:"active",aborted:!1,tool:y.activeTool,toolEventInfo:{mover:g,type:e},type:"update"})},onMoveStart:function(e){var g=e.dx,a=e.dy,n=e.mover;e=e.type;return y.emit("update",{graphics:y.updateGraphics.toArray(),state:"active",aborted:!1,tool:y.activeTool,toolEventInfo:{dx:g,dy:a,mover:n,type:e},type:"update"})},onMove:function(e){var g=e.dx,a=e.dy,n=e.mover;e=e.type;return y.emit("update",{graphics:y.updateGraphics.toArray(),
state:"active",aborted:!1,tool:y.activeTool,toolEventInfo:{dx:g,dy:a,mover:n,type:e},type:"update"})},onMoveStop:function(e){var g=e.dx,a=e.dy,n=e.mover;e=e.type;return y.emit("update",{graphics:y.updateGraphics.toArray(),state:"active",aborted:!1,tool:y.activeTool,toolEventInfo:{dx:g,dy:a,mover:n,type:e},type:"update"})},onVertexAdd:function(e){var g=e.type,a=e.vertices;e=e.added.map(function(e){return G.geometryToCoordinates(e.geometry)});y.emit("update",{graphics:y.updateGraphics.toArray(),state:"active",
aborted:!1,tool:y.activeTool,toolEventInfo:{added:e,vertices:a,type:g},type:"update"})},onVertexRemove:function(e){var g=e.type,a=e.vertices;e=e.removed.map(function(e){return G.geometryToCoordinates(e.geometry)});y.emit("update",{graphics:y.updateGraphics.toArray(),state:"active",aborted:!1,tool:y.activeTool,toolEventInfo:{removed:e,vertices:a,type:g},type:"update"})}}})]}})})};B.prototype._getHandlesForComponent=function(g,a){var n=this,b=g.activeComponent;switch(b.type){case "graphic-mover":return[b.on("graphic-move-start",
function(e){return g.addToHistory(k(e.allGraphics))})];case "box":return[b.on("move-start",function(e){return g.addToHistory(k(e.graphics))}),b.on("rotate-start",function(e){return g.addToHistory(k(e.graphics))}),b.on("scale-start",function(e){return g.addToHistory(k(e.graphics))})];case "reshape":return[b.on("move-start",function(e){return g.addToHistory(k([e.mover]))}),b.on("reshape-start",function(e){return g.addToHistory(k([e.graphic]))}),b.on("vertex-add",function(e){return g.addToHistory(k([e.oldGraphic]))}),
b.on("vertex-remove",function(e){return g.addToHistory(k([e.oldGraphic]))})];case "move-3d":return[b.on("graphic-move-start",function(e){g.addToHistory(k(e.allGraphics));n.emit("update",{graphics:n.updateGraphics.toArray(),state:"active",aborted:!1,tool:n.activeTool,toolEventInfo:{dx:0,dy:0,mover:0<e.allGraphics.length?e.allGraphics[0]:null,type:"move-start"},type:"update"})}),b.on("graphic-move",function(e){n.emit("update",{graphics:n.updateGraphics.toArray(),state:"active",aborted:!1,tool:n.activeTool,
toolEventInfo:{dx:e.dx,dy:e.dy,mover:0<e.allGraphics.length?e.allGraphics[0]:null,type:"move"},type:"update"})}),b.on("graphic-move-stop",function(e){n.emit("update",{graphics:n.updateGraphics.toArray(),state:"active",aborted:!1,tool:n.activeTool,toolEventInfo:{dx:0,dy:0,mover:0<e.allGraphics.length?e.allGraphics[0]:null,type:"move-stop"},type:"update"})}),b.on("immediate-click",function(e){e.shiftKey?n._toggleSelection([e.graphic],g,a):g.toggleTool()})];case "transform-3d":return[b.on("graphic-translate-start",
function(e){g.addToHistory(k([e.graphic]));n.emit("update",{graphics:n.updateGraphics.toArray(),state:"active",aborted:!1,tool:n.activeTool,toolEventInfo:{mover:e.graphic,dx:e.dxScreen,dy:e.dyScreen,type:"move-start"},type:"update"})}),b.on("graphic-translate-stop",function(e){n.emit("update",{graphics:n.updateGraphics.toArray(),state:"active",aborted:!1,tool:n.activeTool,toolEventInfo:{mover:e.graphic,dx:e.dxScreen,dy:e.dyScreen,type:"move-stop"},type:"update"})}),b.on("graphic-rotate-start",function(a){g.addToHistory(e([a.graphic]));
n.emit("update",{graphics:n.updateGraphics.toArray(),state:"active",aborted:!1,tool:n.activeTool,toolEventInfo:{mover:a.graphic,angle:a.angle,type:"rotate-start"},type:"update"})}),b.on("graphic-rotate-stop",function(e){n.emit("update",{graphics:n.updateGraphics.toArray(),state:"active",aborted:!1,tool:n.activeTool,toolEventInfo:{mover:e.graphic,angle:e.angle,type:"rotate-stop"},type:"update"})}),b.on("graphic-scale-start",function(a){g.addToHistory(e([a.graphic]));n.emit("update",{graphics:n.updateGraphics.toArray(),
state:"active",aborted:!1,tool:n.activeTool,toolEventInfo:{mover:a.graphic,xScale:a.scale,yScale:a.scale,type:"scale-start"},type:"update"})}),b.on("graphic-scale-stop",function(e){n.emit("update",{graphics:n.updateGraphics.toArray(),state:"active",aborted:!1,tool:n.activeTool,toolEventInfo:{mover:e.graphic,xScale:e.scale,yScale:e.scale,type:"scale-stop"},type:"update"})}),b.on("graphic-translate",function(e){n.emit("update",{graphics:n.updateGraphics.toArray(),state:"active",aborted:!1,tool:n.activeTool,
toolEventInfo:{mover:e.graphic,dx:e.dxScreen,dy:e.dyScreen,type:"move"},type:"update"})}),b.on("graphic-rotate",function(e){n.emit("update",{graphics:n.updateGraphics.toArray(),state:"active",aborted:!1,tool:n.activeTool,toolEventInfo:{mover:e.graphic,angle:e.angle,type:"rotate"},type:"update"})}),b.on("graphic-scale",function(e){n.emit("update",{graphics:n.updateGraphics.toArray(),state:"active",aborted:!1,tool:n.activeTool,toolEventInfo:{mover:e.graphic,xScale:e.scale,yScale:e.scale,type:"scale"},
type:"update"})})];case "reshape-3d":return[b.on("reshape",function(e){"reshape-start"===e.type&&g.addToHistory(k([e.mover]));n.emit("update",{graphics:n.updateGraphics.toArray(),state:"active",aborted:!1,tool:n.activeTool,toolEventInfo:e,type:"update"})}),b.on("move",function(e){"move-start"===e.type&&g.addToHistory(k([e.mover]));n.emit("update",{graphics:n.updateGraphics.toArray(),state:"active",aborted:!1,tool:n.activeTool,toolEventInfo:e,type:"update"})}),b.on("vertex-add",function(e){n.emit("update",
{graphics:n.updateGraphics.toArray(),state:"active",aborted:!1,tool:n.activeTool,toolEventInfo:e,type:"update"})}),b.on("vertex-remove",function(e){n.emit("update",{graphics:n.updateGraphics.toArray(),state:"active",aborted:!1,tool:n.activeTool,toolEventInfo:e,type:"update"})}),b.on("immediate-click",function(){return g.toggleTool()})];case "draw":return null;default:m.neverReached(b)}};B.prototype._setUpdateOperationHandle=function(e){var g=this;this._operationHandle=e;var a=this.view,n=a.map,k=
a.popup,b=!0;k&&(b=k.autoOpenEnabled,k.autoOpenEnabled=!1);e.on("complete",function(){if(e===g._operationHandle){var a=g.updateGraphics.toArray(),c=g._operationHandle.tool;g._operationHandle.destroy();g._operationHandle=null;g._internalGraphicsLayer.removeMany(g.updateGraphics.toArray());g.updateGraphics.removeAll();n&&n.remove(g._internalGraphicsLayer);k&&(k.autoOpenEnabled=b);g.emit("update",{graphics:a,state:"complete",aborted:e.cancelled,tool:c,toolEventInfo:null,type:"update"})}})};B.prototype._getCommonUpdateOperationClickHandlers=
function(e,g,a){var n=this,k=C.createScreenPointFromEvent(g);this._getFirstHit(k).then(function(k){k=k.results;k.length?g.native.shiftKey&&n._toggleSelection(k.map(function(e){return e.graphic}),e,a)?g.stopPropagation():k.some(function(e){return e.graphic&&-1<n.updateGraphics.indexOf(e.graphic)})?g.stopPropagation():e.complete():e.complete()})};B.prototype._toggleSelection=function(e,g,a){var n=this,k=a?!!a.multipleSelectionEnabled:!0;return e.some(function(e){return null==e?!1:k&&e.layer===n.layer?
(-1===n.updateGraphics.indexOf(e)?g.addToSelection(e):g.removeFromSelection(e),!0):!1})};B.prototype._getCommonUpdateOperationKeyDownHandlers=function(e,g){if(e){var a=g.key;"z"===a&&e.canUndo()?(g.stopPropagation(),e.undo()):"r"===a&&e.canRedo()?(g.stopPropagation(),e.redo()):"Escape"===a?(g.stopPropagation(),e.cancel()):0<=y.indexOf(a)&&this._onDeleteKey(g)}};B.prototype._onDeleteKey=function(e){if(this._operationHandle&&"update"===this._operationHandle.type){var g=this.activeComponent;g&&"reshape"!==
g.type&&"reshape-3d"!==g.type&&(e.stopPropagation(),e=this.updateGraphics.toArray(),this.layer.removeMany(e),this._emitDeleteEvent({graphics:e,tool:this.activeTool}))}};B.prototype._getCreateSymbol=function(e,g){void 0===g&&(g=!1);g="3d"!==this.view.type&&g;switch(e.type){case "point":case "multipoint":return g?this.activePointSymbol:this.pointSymbol;case "polyline":return g?this.activeLineSymbol:this.polylineSymbol;case "polygon":return g?this.activeFillSymbol:this.polygonSymbol}return null};B.prototype._getUpdateSymbol=
function(e){if(E.isNone(e))return null;switch(e.type){case "point":case "multipoint":return this.updatePointSymbol;case "polyline":return this.updatePolylineSymbol;case "polygon":case "extent":return this.updatePolygonSymbol}return null};B.prototype._drawMultipointGraphic=function(e,g){var a=null;!g&&1<e.length?(a=e.slice(0),a.pop(),a=T.createMultipoint(a,this.view.spatialReference)):a=T.createMultipoint(e,this.view.spatialReference);this.createGraphic?this.createGraphic.geometry=a:this._set("createGraphic",
new r(a,this.pointSymbol));g&&1===e.length&&this._internalGraphicsLayer.add(this.createGraphic)};B.prototype._drawVertexGraphics=function(e,g,a){a=!(!a||!a.userClicked);var n="polygon"===e,k=n?this.polygonSymbol:this.polylineSymbol;if(1===g.length){this._removeLineGraphic();this._removeActiveLineGraphic();var b=this.createPointFromVertex(g[0]),n=n?T.createPolygon([g],this.view.spatialReference,this._doUnnormalization,!0):T.createPolyline([g],this.view.spatialReference,this._doUnnormalization);this._vertexGraphics.length?
this._vertexGraphics[0].geometry=b:this._vertexGraphics.push(new r(b,this.activeVertexSymbol));this.createGraphic?this.createGraphic.geometry=n:this._set("createGraphic",new r(n,k));a&&this._internalGraphicsLayer.add(this._vertexGraphics[0])}else if(2===g.length){e=this.createPointFromVertex(g[1]);var c=this.vertexSymbol,k=T.createPolyline([g],this.view.spatialReference,this._doUnnormalization),n=n?T.createPolygon([g],this.view.spatialReference,this._doUnnormalization,!0):T.createPolyline([g],this.view.spatialReference,
this._doUnnormalization);this._vertexGraphics.length||(b=this.createPointFromVertex(g[0]),g=new r(b,c),this._vertexGraphics.push(g));1===this._vertexGraphics.length?(g=this._vertexGraphics[0],e=new r(e,c),this._removeLineGraphic(),this._removeActiveFillGraphic(),this._vertexGraphics.push(e),this._internalGraphicsLayer.remove(g),this._internalGraphicsLayer.add(g)):this._vertexGraphics[1].geometry=e;this._showActiveLineGraphic(k);g=this._vertexGraphics[0];a&&(this._activeLineGraphic.symbol=this.polylineSymbol,
g.symbol=this.vertexSymbol,this._internalGraphicsLayer.add(this._vertexGraphics[1]));this.createGraphic?this.createGraphic.geometry=n:this._set("createGraphic",new r(n,this.polygonSymbol));this._internalGraphicsLayer.remove(g);this._internalGraphicsLayer.add(g)}else if(2<g.length){n=n?T.createPolygon([g],this.view.spatialReference,this._doUnnormalization,!0):T.createPolyline([g],this.view.spatialReference,this._doUnnormalization);"polygon"===e&&this._showFillGraphic(n);e=g.map(function(e){return e.slice()});
c=e.pop();b=[e[e.length-1],c];c=T.createPolyline([e],this.view.spatialReference,this._doUnnormalization);b=T.createPolyline([b],this.view.spatialReference,this._doUnnormalization);this._showLineGraphic(c);this._showActiveLineGraphic(b);for(c=0;c<e.length;c++)(b=this._vertexGraphics[c])?b.symbol=a||c!==this._vertexGraphics.length-1?this.vertexSymbol:this.activeVertexSymbol:(b=this.createPointFromVertex(g[c]),this._showVertexGraphic(b));a?(this._activeLineGraphic.symbol=this.polylineSymbol,c=g.length-
1,b=this.createPointFromVertex(g[c]),this._showVertexGraphic(b)):this._activeLineGraphic.symbol=this.activeLineSymbol;this.createGraphic?this.createGraphic.geometry=n:(this._removeCreateGraphic(),this._set("createGraphic",new r(n,k)));a=0;for(n=this._vertexGraphics;a<n.length;a++)g=n[a],this._internalGraphicsLayer.remove(g),this._internalGraphicsLayer.add(g)}};B.prototype._drawSegmentGraphic=function(e,g,a,n){if(g.length){var k=!(!a||!a.centered);a=!(!a||!a.constrained);var b=null;1===g.length?this._removeCenterIndicatorGraphic():
("rectangle"===e?b=a?T.createSquare(g,n,k):T.createRectangle(g,n,k):"circle"===e&&(b=a?T.createEllipse(g,n,k):T.createCircle(g,n,k)),b.extent&&b.extent.center&&this._showCenterIndicatorGraphic(b.extent.center));b?this.createGraphic?this.createGraphic.geometry=b:(this._removeCreateGraphic(),this._set("createGraphic",new r(b,this.polygonSymbol)),this._internalGraphicsLayer.add(this.createGraphic)):this._removeCreateGraphic()}};B.prototype._showCenterIndicatorGraphic=function(e){this._centerIndicatorGraphic?
this._centerIndicatorGraphic.geometry=e:(this._centerIndicatorGraphic=new r(e,this._centerSymbol),this._internalGraphicsLayer.add(this._centerIndicatorGraphic))};B.prototype._removeCenterIndicatorGraphic=function(){this._centerIndicatorGraphic&&(this._internalGraphicsLayer.remove(this._centerIndicatorGraphic),this._centerIndicatorGraphic.destroy(),this._centerIndicatorGraphic=null)};B.prototype._showActiveLineGraphic=function(e){this._activeLineGraphic?this._activeLineGraphic.geometry=e:(this._activeLineGraphic=
new r(e,this.activeLineSymbol),this._internalGraphicsLayer.graphics.add(this._activeLineGraphic,0))};B.prototype._showFillGraphic=function(e){this._activeFillGraphic?this._activeFillGraphic.geometry=e:(this._activeFillGraphic=new r(e,this._getCreateSymbol(e,!0)),this._internalGraphicsLayer.add(this._activeFillGraphic))};B.prototype._showLineGraphic=function(e){this._lineGraphic?this._lineGraphic.geometry=e:(this._lineGraphic=new r(e,this.polylineSymbol),this._internalGraphicsLayer.graphics.add(this._lineGraphic,
0))};B.prototype._showVertexGraphic=function(e,g){e=new r(e,g?this.activeVertexSymbol:this.vertexSymbol);this._vertexGraphics.push(e);this._internalGraphicsLayer.add(e)};B.prototype._resetCreateOperationGraphics=function(){this._removeActiveFillGraphic();this._removeLineGraphic();this._removeActiveLineGraphic();this._removeVertexGraphics()};B.prototype._removeCreateGraphic=function(){this.createGraphic&&(this._internalGraphicsLayer.remove(this.createGraphic),this._set("createGraphic",null))};B.prototype._removeCreateOperationGraphics=
function(){this._removeCenterIndicatorGraphic();this._removeActiveLineGraphic();this._removeActiveFillGraphic();this._removeLineGraphic();this._removeVertexGraphics()};B.prototype._removeActiveLineGraphic=function(){this._activeLineGraphic&&(this._internalGraphicsLayer.remove(this._activeLineGraphic),this._activeLineGraphic.destroy(),this._activeLineGraphic=null)};B.prototype._removeActiveFillGraphic=function(){this._activeFillGraphic&&(this._internalGraphicsLayer.remove(this._activeFillGraphic),
this._activeFillGraphic.destroy(),this._activeFillGraphic=null)};B.prototype._removeLineGraphic=function(){this._lineGraphic&&(this._internalGraphicsLayer.remove(this._lineGraphic),this._lineGraphic.destroy(),this._lineGraphic=null)};B.prototype._removeVertexGraphics=function(){this._vertexGraphics.length&&(this._internalGraphicsLayer.removeMany(this._vertexGraphics),this._vertexGraphics.forEach(function(e){return e.destroy()}),this._vertexGraphics=[])};B.prototype._removeDefaultLayer=function(){this._internalGraphicsLayer&&
(this.view&&this.view.map&&this.view.map.remove(this._internalGraphicsLayer),this._internalGraphicsLayer.destroy(),this._internalGraphicsLayer=null)};B.prototype._operationHandleForCreateAction=function(e,g,a){var n=this;return new p.OperationHandle({activeComponent:this._draw,tool:a,type:"create",onEnd:function(){g.forEach(function(e){return e.remove()});g.length=0;n._removeCreateOperationGraphics();n._internalGraphicsLayer&&n._internalGraphicsLayer.remove(n.createGraphic);n._displayDefaultCursor()},
undo:function(){e.undo();n._emitUndoEvent({graphics:[n.createGraphic],tool:a})},redo:function(){e.redo();n._emitRedoEvent({graphics:[n.createGraphic],tool:a})},canUndo:function(){return e&&e.canUndo()},canRedo:function(){return e&&e.canRedo()},setSnapToScene:function(g){e.snapToScene=g?function(e,g){return n._snapToScene3D(e,g)}:null}})};B.prototype._snap=function(e,g,a){a&&this._snapLastVertexToAxis(g);"polygon"===e&&this._snapLastPolygonVertexToFirst(g)};B.prototype._snapLastPolygonVertexToFirst=
function(e){if(!(2>=e.length)){var g=e[0];e=e[e.length-1];var a=this.view.toScreen(new h.Point(g[0],g[1],this.view.spatialReference)),n=this.view.toScreen(new h.Point(e[0],e[1],this.view.spatialReference));this._isWithinScreenDistance(a,n,this._getVertexIntersectDistance())&&(e[0]=g[0],e[1]=g[1])}};B.prototype._getVertexIntersectDistance=function(){return this.vertexSymbol&&"simple-marker"===this.vertexSymbol.type?C.pt2px(this.vertexSymbol.size)/2+3:3};B.prototype._isWithinScreenDistance=function(e,
g,a){var n=e.x-g.x;e=e.y-g.y;return Math.sqrt(n*n+e*e)<=a};B.prototype._snapLastVertexToAxis=function(e){if(!(2>e.length)){var g=e.pop(),a=e[e.length-1],n=T.createViewAlignedCoordinateSystem(this.view,a),a=n.mapToLocal(a),g=n.mapToLocal(g),k=Math.abs(g.x-a.x),b=Math.abs(g.y-a.y),n=n.localToMap(T.makeSurfacePoint(k>b?g.x:a.x,k>b?a.y:g.y));e.push(n)}};B.prototype._displayCrosshairCursor=function(){this.view&&this.view.container&&"crosshair"!==this.view.cursor&&(this.view.cursor="crosshair")};B.prototype._displayDefaultCursor=
function(){this.view&&this.view.container&&null!==this.view.cursor&&(this.view.cursor=null)};B.prototype._logError=function(e,g,a){n.error(new u(e,g,a))};B.prototype._requireModule=function(e){return f(this,void 0,void 0,function(){var g,a;return b(this,function(n){switch(n.label){case 0:return this._moduleLoaderAbortController=g=new AbortController,[4,e];case 1:return a=n.sent(),this._moduleLoaderAbortController!==g||g.signal.aborted?[2,{requireError:"aborted"}]:[2,{module:a}]}})})};B.prototype._emitUndoEvent=
function(e){this.emit("undo",t({},e,{type:"undo"}))};B.prototype._emitRedoEvent=function(e){this.emit("redo",t({},e,{type:"redo"}))};B.prototype._emitDeleteEvent=function(e){this.emit("delete",t({},e,{type:"delete"}))};B.prototype.createPointFromVertex=function(e){return 2<e.length?new h.Point(e[0],e[1],e[2],this.view.spatialReference):new h.Point(e[0],e[1],this.view.spatialReference)};q([K.property({dependsOn:["state"],readOnly:!0})],B.prototype,"_draw",null);q([K.property()],B.prototype,"_operationHandle",
void 0);q([K.property({dependsOn:["_operationHandle","_operationHandle.tool"],readOnly:!0})],B.prototype,"activeTool",null);q([K.property()],B.prototype,"activeFillSymbol",void 0);q([K.property()],B.prototype,"activeLineSymbol",void 0);q([K.property()],B.prototype,"activePointSymbol",void 0);q([K.property()],B.prototype,"activeVertexSymbol",void 0);q([K.property({readOnly:!0})],B.prototype,"createGraphic",void 0);q([K.property()],B.prototype,"defaultCreateOptions",void 0);q([K.property()],B.prototype,
"defaultUpdateOptions",void 0);q([K.property()],B.prototype,"layer",void 0);q([K.property({types:c.symbolTypes})],B.prototype,"pointSymbol",void 0);q([K.property({types:c.symbolTypes})],B.prototype,"polygonSymbol",void 0);q([K.property({types:c.symbolTypes})],B.prototype,"polylineSymbol",void 0);q([K.property({dependsOn:["view.ready","layer","_operationHandle"],readOnly:!0})],B.prototype,"state",null);q([K.property({readOnly:!0})],B.prototype,"updateGraphics",void 0);q([K.property()],B.prototype,
"updateOnGraphicClick",void 0);q([K.property({types:c.symbolTypes})],B.prototype,"updatePointSymbol",void 0);q([K.property({types:c.symbolTypes})],B.prototype,"updatePolygonSymbol",void 0);q([K.property({types:c.symbolTypes})],B.prototype,"updatePolylineSymbol",void 0);q([K.property({types:c.symbolTypes})],B.prototype,"vertexSymbol",void 0);q([K.property({value:null})],B.prototype,"view",null);q([K.property()],B.prototype,"cancel",null);q([K.property()],B.prototype,"complete",null);q([K.property()],
B.prototype,"delete",null);q([K.property()],B.prototype,"create",null);q([K.property()],B.prototype,"update",null);q([K.property()],B.prototype,"undo",null);q([K.property()],B.prototype,"redo",null);q([K.property()],B.prototype,"canUndo",null);q([K.property()],B.prototype,"canRedo",null);q([K.property()],B.prototype,"toggleUpdateTool",null);q([K.property({value:null})],B.prototype,"snapToScene",null);return B=q([K.subclass("esri.widgets.Sketch.SketchViewModel")],B)}(K.declared(D.EventedAccessor))})},
"esri/support/elevationInfoUtils":function(){define(["require","exports","../core/maybe","../symbols/support/unitConversionUtils"],function(z,d,t,l){function q(b,d){b=t.isSome(b)?b.hasZ:!1;return t.isNone(d)?b?"absolute-height":"on-the-ground":d.mode}function b(b){var d=f(b);return q(b.geometry,d)}function f(b){return b.layer&&"elevationInfo"in b.layer?b.layer.elevationInfo:null}Object.defineProperty(d,"__esModule",{value:!0});d.getGeometryEffectiveElevationMode=q;d.getGraphicEffectiveElevationMode=
b;d.getGraphicEffectiveElevationInfo=function(b){var d=f(b);b=q(b.geometry,d);d=t.isSome(d)&&"on-the-ground"!==b?t.unwrapOr(d.offset,0)*l.getMetersPerUnit(t.unwrapOr(d.unit,"meters")):0;return{mode:b,offset:d}};d.hasGraphicFeatureExpressionInfo=function(d){if("on-the-ground"===b(d))return!1;d=f(d);d=t.isSome(d)&&d.featureExpressionInfo?d.featureExpressionInfo.expression:null;return!(!d||"0"===d)};d.getZForElevationMode=function(b,d,c){if(!t.isNone(c)){var a=b.hasZ?b.z:0,f=t.isSome(c.offset)?c.offset:
0;switch(c.mode){case "absolute-height":return a-f;case "on-the-ground":return 0;case "relative-to-ground":return b=(d.elevationProvider.getElevation(b.x,b.y,b.z,b.spatialReference,"ground")||0)+f,a-b;case "relative-to-scene":return b=(d.elevationProvider.getElevation(b.x,b.y,b.z,b.spatialReference,"scene")||0)+f,a-b}}}})},"esri/views/3d/interactive/editingTools/isSupportedGraphicUtils":function(){define(["require","exports","../../../../core/compilerUtils"],function(z,d,t){Object.defineProperty(d,
"__esModule",{value:!0});d.isSupportedGraphicResultMessage=function(d){switch(d){case 0:break;case 1:return"not owned by a graphics layer";case 2:return"no geometry";case 3:return"the geometry type is not supported";case 4:return"the elevation mode is not supported";case 5:return"the symbol type is not supported";default:t.neverReached(d)}return""}})},"esri/views/3d/interactive/editingTools/graphicMove3D/isSupportedGraphic":function(){define(["require","exports","../../../../../core/compilerUtils",
"../../../../../core/maybe","../../../../../support/elevationInfoUtils"],function(z,d,t,l,q){Object.defineProperty(d,"__esModule",{value:!0});d.isSupportedGraphic=function(b){if("graphics"!==b.layer.type)return 1;if(l.isNone(b.geometry))return 2;var d=b.geometry.type;switch(d){case "polygon":case "point":case "polyline":break;case "multipoint":case "extent":case "mesh":return 3;default:return t.neverReached(d),3}return"on-the-ground"!==q.getGraphicEffectiveElevationMode(b)&&q.hasGraphicFeatureExpressionInfo(b)?
4:0}})},"esri/views/3d/interactive/editingTools/graphicReshape3D/isSupportedGraphic":function(){define("require exports ../../../../../core/compilerUtils ../../../../../core/maybe ../../../../../geometry/Circle ../../../../../support/elevationInfoUtils".split(" "),function(z,d,t,l,q,b){Object.defineProperty(d,"__esModule",{value:!0});d.isSupportedGraphic=function(d){if("graphics"!==d.layer.type)return 1;var f=d.geometry;if(l.isNone(f))return 2;var r=f.type;switch(r){case "polygon":if(f instanceof
q)return 3;break;case "polyline":break;case "point":case "multipoint":case "extent":case "mesh":return 3;default:return t.neverReached(r),3}return"on-the-ground"!==b.getGraphicEffectiveElevationMode(d)&&b.hasGraphicFeatureExpressionInfo(d)?4:0}})},"esri/geometry/Circle":function(){define("require exports ../core/tsSupport/assignHelper ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/unitUtils ../core/accessorSupport/decorators ./Point ./Polygon ./support/geodesicUtils ./support/webMercatorUtils ./support/WKIDUnitConversion".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m){return function(d){function u(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];a=d.apply(this,a)||this;a.center=null;a.geodesic=!1;a.numberOfPoints=60;a.radius=1E3;a.radiusUnit="meters";return a}l(u,d);w=u;u.prototype.normalizeCtorArgs=function(a,b){var c;if(a&&a.center)c=a;else{if(a&&a.rings)return this.inherited(arguments);c={center:a}}return t({},this.inherited(arguments,[]),c,b)};u.prototype.initialize=function(){var c=this.center,d=this.numberOfPoints;
this.hasZ=c&&c.hasZ;if(0===this.rings.length&&c){var f=b.convertUnit(this.radius,this.radiusUnit,"meters"),h=c.spatialReference,l="geographic";if(h.isWebMercator)l="webMercator";else if(null!=m[h.wkid]||h.wkt&&0===h.wkt.indexOf("PROJCS"))l="projected";if(this.geodesic){h=void 0;switch(l){case "webMercator":h=a.webMercatorToGeographic(c);break;case "projected":console.error("Creating a geodesic circle requires the center to be specified in web mercator or geographic coordinate system");break;case "geographic":h=
c}c=this._createGeodesicCircle(h,f,d);"webMercator"===l&&(c=a.geographicToWebMercator(c))}else h=void 0,"webMercator"===l||"projected"===l?h=f/this._convert2Meters(1,c.spatialReference):"geographic"===l&&(h=b.lengthToDegrees(f,"meters")),c=this._createPlanarCircle(c,h,d);this.spatialReference=c.spatialReference;this.addRing(c.rings[0])}};u.prototype.clone=function(){var a=this.numberOfPoints,b=this.radius,c=this.radiusUnit,d=this.geodesic;return new w({center:this.center.clone(),numberOfPoints:a,
radius:b,radiusUnit:c,geodesic:d})};u.prototype._createGeodesicCircle=function(a,b,d){for(var f=0,h=[];360>f;){var l=[0,0];c.directGeodeticSolver(l,[a.x,a.y],f,b);this.hasZ&&l.push(a.z);h.push(l);f+=360/d}h.push(h[0]);return new r(h)};u.prototype._createPlanarCircle=function(a,b,c){for(var d=0,f=[];d<2*Math.PI;){var h=[a.x+Math.cos(-d)*b,a.y+Math.sin(-d)*b];this.hasZ&&h.push(a.z);f.push(h);d+=Math.PI/(c/2)}f.push(f[0]);return new r({spatialReference:a.spatialReference,rings:[f]})};u.prototype._convert2Meters=
function(a,b){if(null!=m[b.wkid])b=m.values[m[b.wkid]];else{b=b.wkt;var c=b.lastIndexOf(",")+1,d=b.lastIndexOf("]]");b=parseFloat(b.substring(c,d))}return a*b};var w;q([f.property({type:h})],u.prototype,"center",void 0);q([f.property()],u.prototype,"geodesic",void 0);q([f.property()],u.prototype,"numberOfPoints",void 0);q([f.property()],u.prototype,"radius",void 0);q([f.property()],u.prototype,"radiusUnit",void 0);return u=w=q([f.subclass("esri.geometry.Circle")],u)}(f.declared(r))})},"esri/geometry/support/geodesicUtils":function(){define("require exports @dojo/framework/shim/object ../. ../../core/Error ../../core/unitUtils".split(" "),
function(z,d,t,l,q,b){function f(a){if(!a||!a.isGeographic)return null;if(a.wkid){var b=E[a.wkid];if(b)return b}if(a.wkt){a=v.exec(a.wkt);if(!a||2!==a.length)return null;b=a[1].split(",");if(!b||3!==b.length)return null;a=parseFloat(b[1]);b=parseFloat(b[2]);return isNaN(a)||isNaN(b)?null:{a:a,f:0===b?0:1/b}}return null}function h(a){a=f(a||w);if("b"in a&&"eSq"in a&&"radius"in a)return a;var b=a.a*(1-a.f);return t.assign(a,{b:b,eSq:1-Math.pow(b/a.a,2),radius:(2*a.a+b)/3})}function r(a,b,c){var d=h(c);
c=d.a;var d=d.eSq,f=Math.sqrt(d),l=Math.sin(b[1]*D);b=c*b[0]*D;c=0<d?c*(1-d)*(l/(1-d*l*l)-1/(2*f)*Math.log((1-f*l)/(1+f*l)))*.5:c*l;a[0]=b;a[1]=c;return a}function c(a){return null!==f(a)}function a(a,b){if("polyline"!==a.type&&"polygon"!==a.type)throw new q("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");var d=a.spatialReference;if(!c(d))throw new q("geodesic-densify:invalid-spatial-reference","the input geometry spatial reference is not supported");var f=
h(d).radius/1E4;b<f&&(b=f);for(var f=[],t=[0,0],r={distance:null},v=0,w="polyline"===a.type?a.paths:a.rings;v<w.length;v++){var z=w[v],C=[];f.push(C);C.push([z[0][0],z[0][1]]);for(var D=z[0][0],E=z[0][1],J=void 0,V=void 0,Y=0;Y<z.length-1;Y++)if(J=z[Y+1][0],V=z[Y+1][1],D!==J||E!==V){var T=[D,E];u(r,[D,E],[J,V],d);D=r.azimuth;E=r.distance;J=E/b;if(1<J){for(V=1;V<=J-1;V++)m(t,T,D,V*b,d),C.push(t.slice(0));m(t,T,D,(E+Math.floor(J-1)*b)/2,d);C.push(t.slice(0))}m(t,T,D,E,d);C.push(t.slice(0));D=t[0];E=
t[1]}}return"polyline"===a.type?new l.Polyline({paths:f,spatialReference:d}):new l.Polygon({rings:f,spatialReference:d})}function m(a,b,c,d,f){var l=b[0]*D,m=b[1]*D;b=c*D;f=h(f);var q=f.a,t=f.b;f=f.f;c=Math.sin(b);b=Math.cos(b);for(var r=(1-f)*Math.tan(m),m=1/Math.sqrt(1+r*r),v=r*m,u=Math.atan2(r,b),r=m*c,w=r*r,z=1-w,q=z*(q*q-t*t)/(t*t),C=1+q/16384*(4096+q*(-768+q*(320-175*q))),E=q/1024*(256+q*(-128+q*(74-47*q))),q=d/(t*C),I=2*Math.PI,J,p,L,A;1E-12<Math.abs(q-I);)L=Math.cos(2*u+q),J=Math.sin(q),p=
Math.cos(q),A=E*J*(L+E/4*(p*(-1+2*L*L)-E/6*L*(-3+4*J*J)*(-3+4*L*L))),I=q,q=d/(t*C)+A;d=v*J-m*p*b;t=f/16*z*(4+f*(4-3*z));d=Math.atan2(v*p+m*J*b,(1-f)*Math.sqrt(w+d*d))/D;l=(l+(Math.atan2(J*c,m*p-v*J*b)-(1-t)*f*r*(q+t*J*(L+t*p*(-1+2*L*L)))))/D;a.splice(0,a.length);a.push(l,d);return a}function u(a,b,c,d){var f=b[0]*D;b=b[1]*D;var l=c[0]*D;c=c[1]*D;var m=h(d),q=m.a;d=m.b;var t=m.f,r=m.radius,v=l-f,u=Math.atan((1-t)*Math.tan(b)),w=Math.atan((1-t)*Math.tan(c)),m=Math.sin(u),u=Math.cos(u),z=Math.sin(w),
w=Math.cos(w),C=1E3,E=v,J,G,p,L,A,k,e,g;do{L=Math.sin(E);A=Math.cos(E);p=Math.sqrt(w*L*w*L+(u*z-m*w*A)*(u*z-m*w*A));if(0===p)return{distance:0};A=m*z+u*w*A;k=Math.atan2(p,A);e=u*w*L/p;G=1-e*e;L=A-2*m*z/G;isNaN(L)&&(L=0);g=t/16*G*(4+t*(4-3*G));J=E;E=v+(1-g)*t*e*(k+g*p*(L+g*A*(-1+2*L*L)))}while(1E-12<Math.abs(E-J)&&0<--C);if(0===C)return a=l-f,{azimuth:Math.atan2(Math.sin(a)*Math.cos(c),Math.cos(b)*Math.sin(c)-Math.sin(b)*Math.cos(c)*Math.cos(a))/D,distance:Math.acos(Math.sin(b)*Math.sin(c)+Math.cos(b)*
Math.cos(c)*Math.cos(l-f))*r};f=G*(q*q-d*d)/(d*d);b=f/1024*(256+f*(-128+f*(74-47*f)));l=Math.atan2(u*Math.sin(E),u*z*Math.cos(E)-m*w);a.azimuth=Math.atan2(w*Math.sin(E),u*z-m*w*Math.cos(E))/D;a.distance=d*(1+f/16384*(4096+f*(-768+f*(320-175*f))))*(k-b*p*(L+b/4*(A*(-1+2*L*L)-b/6*L*(-3+4*p*p)*(-3+4*L*L))));a.reverseAzimuth=l/D;return a}Object.defineProperty(d,"__esModule",{value:!0});var D=Math.PI/180,w=l.SpatialReference.WGS84,v=/SPHEROID\[([^\]]+)]/i,E={4326:{a:6378137,f:1/298.257223563},104900:{a:2439700,
f:0},104901:{a:6051E3,f:0},104902:{a:6051800,f:0},104903:{a:1737400,f:0},104904:{a:3393400,f:.005207166853303471},104905:{a:3396190,f:.005886007555525457},104906:{a:6200,f:0},104907:{a:11100,f:0},104908:{a:71492E3,f:.06487439154031222},104909:{a:8200,f:0},104910:{a:83500,f:0},104911:{a:1E4,f:0},104912:{a:2409300,f:0},104913:{a:15E3,f:0},104914:{a:4E4,f:0},104915:{a:1562090,f:0},104916:{a:2632345,f:0},104917:{a:85E3,f:0},104918:{a:1821460,f:0},104919:{a:5E3,f:0},104920:{a:12E3,f:0},104921:{a:3E4,f:3},
104922:{a:18E3,f:0},104923:{a:14E3,f:0},104924:{a:49300,f:0},104925:{a:60268E3,f:.09796243445941462},104926:{a:16E3,f:0},104927:{a:9500,f:0},104928:{a:56E4,f:0},104929:{a:249400,f:0},104930:{a:59500,f:0},104931:{a:16E3,f:0},104932:{a:133E3,f:0},104933:{a:718E3,f:0},104934:{a:888E3,f:0},104935:{a:1986300,f:0},104936:{a:1E4,f:0},104937:{a:41900,f:0},104938:{a:11E4,f:0},104939:{a:50100,f:0},104940:{a:764E3,f:0},104941:{a:11E3,f:0},104942:{a:529800,f:0},104943:{a:2575E3,f:0},104944:{a:25559E3,f:.022927344575296365},
104945:{a:578900,f:0},104946:{a:33E3,f:0},104947:{a:21E3,f:0},104948:{a:13E3,f:0},104949:{a:31E3,f:0},104950:{a:27E3,f:0},104951:{a:42E3,f:0},104952:{a:235800,f:0},104953:{a:761400,f:0},104954:{a:15E3,f:0},104955:{a:54E3,f:0},104956:{a:77E3,f:0},104957:{a:27E3,f:0},104958:{a:788900,f:0},104959:{a:584700,f:0},104960:{a:24764E3,f:.01708124697141011},104961:{a:74E3,f:0},104962:{a:79E3,f:0},104963:{a:104E3,f:.14423076923076922},104964:{a:29E3,f:0},104965:{a:17E4,f:0},104966:{a:208E3,f:0},104967:{a:4E4,
f:0},104968:{a:1352600,f:0},104969:{a:1195E3,f:0},104970:{a:593E3,f:0},104971:{a:3396190,f:0},104972:{a:47E4,f:0},104973:{a:255E3,f:0},104974:{a:2439400,f:0}};d.isSupported=c;d.geodesicAreas=function(d,f){void 0===f&&(f="square-meters");if(d.some(function(a){return!c(a.spatialReference)}))throw new q("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");for(var l=[],m=0;m<d.length;m++){var t=d[m],v=t.spatialReference,v=.0015696101447650193*h(v).radius;
l.push(a(t,v))}d=[];for(var m=[0,0],t=[0,0],u=0;u<l.length;u++){for(var v=l[u],w=v.rings,v=v.spatialReference,z=0,C=0;C<w.length;C++){var D=w[C];r(m,D[0],v);r(t,D[D.length-1],v);for(var E=t[0]*m[1]-m[0]*t[1],J=0;J<D.length-1;J++)r(m,D[J+1],v),r(t,D[J],v),E+=t[0]*m[1]-m[0]*t[1];z+=E}z=b.convertUnit(z,"square-meters",f);d.push(z/-2)}return d};d.geodesicLengths=function(a,d){void 0===d&&(d="meters");if(!a&&!a)throw new q("geodesic-lengths:invalid-geometries","the input geometries type is not supported");
if(a.some(function(a){return!c(a.spatialReference)}))throw new q("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");for(var f=[],h=0;h<a.length;h++){for(var l=a[h],m=l.spatialReference,l="polyline"===l.type?l.paths:l.rings,t=0,r=0;r<l.length;r++){for(var v=l[r],w=0,z=1;z<v.length;z++){var D=v[z-1][0],C=v[z][0],E=v[z-1][1],J=v[z][1];if(E!==J||D!==C){var T={distance:null};u(T,[D,E],[C,J],m);w+=T.distance}}t+=w}t=b.convertUnit(t,"meters",d);f.push(t)}return f};
d.geodesicDensify=a;d.directGeodeticSolver=m;d.inverseGeodeticSolver=u;d.geodesicDistance=function(a,d,f){void 0===f&&(f="meters");if(!a||!d)throw new q("geodesic-distance:missing-parameters","one or both input parameters are missing");if(!a.spatialReference||!d.spatialReference)throw new q("geodesic-distance:invalid-parameters","one or both input points do not have a spatial reference");if(!a.spatialReference.equals(d.spatialReference))throw new q("geodesic-distance:invalid-parameters","spatial references of input parameters do not match");
var h=a.spatialReference;if(!c(h))throw new q("geodesic-distance:not-supported","input geometry spatial reference is not supported");if(a.equals(d))return{distance:0,azimuth:0,reverseAzimuth:0};var l={distance:null};u(l,[a.x,a.y],[d.x,d.y],h);l.distance=b.convertUnit(l.distance,"meters",f);return l};d.pointFromDistance=function(a,b,d){if(!a||null==b||null==d)throw new q("point-from-distance:missing-parameters","one or more input parameters are missing or undefined");if(0>d||360<d)throw new q("point-from-distance:-of-bounds",
"azimuth is restricted to angles between, and including, 0\u00b0 to 360\u00b0 degrees");if(!a.spatialReference)throw new q("point-from-distance:missing-spatial-reference","the input point must have a spatial reference");var f=a.spatialReference;if(!c(f))throw new q("geodesic-distance:not-supported","input geometry spatial reference is not supported");var h=[0,0];m(h,[a.x,a.y],d,b,f);return new l.Point({x:h[0],y:h[1],spatialReference:f})}})},"esri/views/3d/interactive/editingTools/graphicTransform3D/isSupportedGraphic":function(){define(["require",
"exports","../../../../../core/compilerUtils","../../../../../core/maybe","../../../../../support/elevationInfoUtils"],function(z,d,t,l,q){Object.defineProperty(d,"__esModule",{value:!0});d.isSupportedGraphic=function(b){if("graphics"!==b.layer.type)return 1;if(l.isNone(b.geometry))return 2;var d=b.geometry.type;switch(d){case "point":break;case "polygon":case "polyline":case "multipoint":case "extent":case "mesh":return 3;default:return t.neverReached(d),3}return(d=l.isSome(b.symbol)&&"point-3d"===
b.symbol.type&&b.symbol.symbolLayers)&&0<d.length&&d.some(function(b){return"object"===b.type})?"on-the-ground"!==q.getGraphicEffectiveElevationMode(b)&&q.hasGraphicFeatureExpressionInfo(b)?4:0:5}})},"esri/views/draw/Draw":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/assignHelper ../../core/Accessor ../../core/accessorSupport/decorators ./MultipointDrawAction ./PointDrawAction ./PolygonDrawAction ./PolylineDrawAction ./SegmentDrawAction".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m){return function(b){function d(){var a=null!==b&&b.apply(this,arguments)||this;a.activeAction=null;a.type="draw";a.view=null;return a}t(d,b);d.prototype.destroy=function(){this.activeAction&&(this.activeAction.destroy(),this.activeAction=null)};d.prototype.create=function(b,d){this.reset();d=q({view:this.view},d);switch(b){case "point":this.activeAction=new r(d);break;case "polygon":this.activeAction=new c(d);break;case "polyline":this.activeAction=new a(d);break;
case "multipoint":this.activeAction=new h(d);break;case "rectangle":case "circle":case "ellipse":case "triangle":this.activeAction=new m(d)}return this.activeAction};d.prototype.complete=function(){this.activeAction&&this.activeAction.complete();this.activeAction=null};d.prototype.reset=function(){this.activeAction&&this.activeAction.destroy();this.activeAction=null};l([f.property()],d.prototype,"activeAction",void 0);l([f.property({readOnly:!0})],d.prototype,"type",void 0);l([f.property()],d.prototype,
"view",void 0);return d=l([f.subclass("esri.views.draw.Draw")],d)}(f.declared(b))})},"esri/views/draw/MultipointDrawAction":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Handles ../../core/maybe ../../core/screenUtils ../../core/accessorSupport/decorators ./DrawAction ./input/DrawEvents ./input/Keys ../input/InputManager".split(" "),function(z,d,t,l,q,b,f,h,r,c,a,m){return function(d){function r(a){a=d.call(this,a)||this;
a._cursorMoved=!1;a._cursorScreenPoint=null;a._dragEnabled=!0;a._pointerDownEvent=null;a._viewHandles=new q;a.vertices=[];a.view=null;return a}t(r,d);r.prototype.initialize=function(){this._addViewHandles()};r.prototype.destroy=function(){this._removeViewHandles();this._viewHandles.destroy();this.emit("destroy")};r.prototype.addVertex=function(a,b){var d=this;isNaN(b)?(b=this.vertices.length,this.vertices.push(a)):this.vertices.splice(b,0,a);this.history.push({vertex:a,vertexIndex:b,undo:function(){return d._undoVertexAdd(null,
b)},redo:function(){return d._redoVertexAdd(null,a,b)}});this._set("redoHistory",[]);var f=new c.VertexAddEvent(this.view,null,b,this.vertices);this.emit("vertex-add",f);f.defaultPrevented&&(this._cursorMoved=!0,this.history.pop())};r.prototype.removeVertex=function(a){var b=this,d=this.vertices.splice(a,1)[0];this.history.push({vertex:d,vertexIndex:a,undo:function(){return b._undoVertexRemove(null,d,a)},redo:function(){return b._redoVertexRemove(null,a)}});this._set("redoHistory",[]);this.emit("vertex-remove",
new c.VertexRemoveEvent(this.view,null,a,this.vertices))};r.prototype.updateVertex=function(a,b){var d=this,f=this.vertices[b];this.vertices[b]=a;this.history.push({vertex:a,vertexIndex:b,undo:function(){return d._undoVertexUpdate(null,f,b)},redo:function(){return d._redoVertexUpdate(null,a,b)}});this._set("redoHistory",[]);this.emit("vertex-update",new c.VertexUpdateEvent(this.view,null,b,this.vertices))};r.prototype.complete=function(){this._completeDrawing()};r.prototype._addViewHandles=function(){var b=
this;this._removeViewHandles();this._viewHandles.add([this.view.on("click",function(a){a.stopPropagation()},m.ViewEventPriorities.TOOL),this.view.on("pointer-down",function(a){b._cursorMoved&&b.vertices.pop();b._pointerDownEvent=a;b._cursorMoved=!1;b._cursorScreenPoint=f.createScreenPointFromEvent(a)},m.ViewEventPriorities.TOOL),this.view.on("pointer-move",function(a){b._cursorMoved&&b.vertices.pop();b._cursorMoved=!0;b._cursorScreenPoint=f.createScreenPointFromEvent(a);b._cursorUpdateHandler(a)},
m.ViewEventPriorities.TOOL),this.view.on("pointer-up",function(a){b._pointerDownEvent&&(b._cursorMoved?(b.vertices.pop(),b._cursorMoved=!1):(b._pointerDownEvent=null,b._vertexAddHandler(a)))},m.ViewEventPriorities.TOOL),this.view.on("drag",function(a){b._dragEnabled&&b._pointerDownEvent&&a.stopPropagation()},m.ViewEventPriorities.TOOL),this.view.on("drag",["Shift"],function(a){a.stopPropagation()},m.ViewEventPriorities.TOOL),this.view.on("double-click",function(a){a.stopPropagation();b._drawCompleteHandler(a)},
m.ViewEventPriorities.TOOL),this.view.on("double-click",["Control"],function(a){a.stopPropagation();b._drawCompleteHandler(a)},m.ViewEventPriorities.TOOL),this.view.on("key-down",function(c){c.key===a.KEYS.vertexAddKey&&!c.repeat&&b._cursorScreenPoint?(b._cursorMoved&&(b.vertices.pop(),b._cursorMoved=!1),b._vertexAddHandler(c)):c.key===a.KEYS.drawCompleteKey&&!c.repeat&&b._cursorScreenPoint?(b._cursorMoved&&(b.vertices.pop(),b._cursorMoved=!1),b._vertexAddHandler(c),b._drawCompleteHandler(c)):c.key!==
a.KEYS.undoKey||b.interactiveUndoDisabled||c.repeat?c.key!==a.KEYS.redoKey||b.interactiveUndoDisabled||c.repeat||(c.stopPropagation(),b.redo()):(c.stopPropagation(),b.undo())},m.ViewEventPriorities.TOOL)])};r.prototype._removeViewHandles=function(){this._viewHandles.removeAll()};r.prototype._addVertex=function(a,b){var d=this;this.vertices.push(a);var f=this.vertices.indexOf(a);this.history.push({vertex:a,vertexIndex:f,undo:function(){return d._undoVertexAdd(b,f)},redo:function(){return d._redoVertexAdd(b,
a,f)}});this._set("redoHistory",[]);var h=new c.VertexAddEvent(this.view,b,f,this.vertices);this.emit("vertex-add",h);h.defaultPrevented&&(this._cursorMoved=!0,this.history.pop())};r.prototype._updateCursor=function(a,b){this.vertices.push(a);a=this.vertices.indexOf(a);b=new c.CursorUpdateEvent(this.view,b,a,this.vertices);this.emit("cursor-update",b)};r.prototype._completeDrawing=function(a){this._cursorMoved=!1;this._pointerDownEvent=null;1>this.vertices.length||(a=new c.DrawCompleteEvent(a,this.vertices),
this.emit("draw-complete",a),a.defaultPrevented?this._cursorMoved=!0:this._removeViewHandles())};r.prototype._undoVertexAdd=function(a,b){this.vertices.splice(b,1);this.emit("undo",new c.VertexRemoveEvent(this.view,a,b,this.vertices))};r.prototype._redoVertexAdd=function(a,b,d){this.vertices.splice(d,0,b);this.emit("redo",new c.VertexAddEvent(this.view,a,d,this.vertices))};r.prototype._undoVertexRemove=function(a,b,d){this.vertices.splice(d,0,b);this.emit("undo",new c.VertexAddEvent(this.view,a,d,
this.vertices))};r.prototype._redoVertexRemove=function(a,b){this.vertices.splice(b,1);this.emit("redo",new c.VertexRemoveEvent(this.view,a,b,this.vertices))};r.prototype._undoVertexUpdate=function(a,b,d){this.vertices[d]=b;this.emit("undo",new c.VertexUpdateEvent(this.view,a,d,this.vertices))};r.prototype._redoVertexUpdate=function(a,b,d){this.vertices[d]=b;this.emit("redo",new c.VertexUpdateEvent(this.view,a,d,this.vertices))};r.prototype._vertexAddHandler=function(a){var c=this.getCoordsFromScreenPoint(this._cursorScreenPoint);
b.isSome(c)&&this._addVertex(c,a.native)};r.prototype._cursorUpdateHandler=function(a){var c=this.getCoordsFromScreenPoint(this._cursorScreenPoint);b.isSome(c)&&this._updateCursor(c,a.native)};r.prototype._drawCompleteHandler=function(a){this._completeDrawing(a.native)};l([h.property({readOnly:!0})],r.prototype,"vertices",void 0);l([h.property()],r.prototype,"view",void 0);return r=l([h.subclass("esri.views.draw.MultipointDrawAction")],r)}(h.declared(r))})},"esri/views/draw/DrawAction":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Evented ../../core/maybe ../../core/screenUtils ../../core/accessorSupport/decorators".split(" "),
function(z,d,t,l,q,b,f,h){var r={mode:"absolute-height",offset:0},c={mode:"on-the-ground",offset:0};return function(a){function d(){var b=null!==a&&a.apply(this,arguments)||this;b._hasZ=null;b.interactiveUndoDisabled=!1;b.history=[];b.redoHistory=[];b.snapToScene=null;b.view=null;b.elevationInfo=null;b.defaultZ=0;return b}t(d,a);Object.defineProperty(d.prototype,"hasZ",{get:function(){return b.isSome(this._hasZ)?this._hasZ:"3d"===this.view.type},set:function(a){this._hasZ=a;this.notifyChange("hasZ")},
enumerable:!0,configurable:!0});d.prototype.canUndo=function(){return 0<this.history.length};d.prototype.canRedo=function(){return 0<this.redoHistory.length};d.prototype.undo=function(){if(this.canUndo()){var a=this.history.pop();a.undo();this.redoHistory.push(a)}};d.prototype.redo=function(){if(this.canRedo()){var a=this.redoHistory.pop();a.redo();this.history.push(a)}};d.prototype.getCoordsFromScreenPoint=function(a){a=this.screenToMap(a);return b.isSome(a)?a.hasZ?[a.x,a.y,a.z]:[a.x,a.y]:null};
d.prototype.getCoordsAndPointFromScreenPoint=function(a){a=this.screenToMap(a);return b.isSome(a)?a.hasZ?{vertex:[a.x,a.y,a.z],mapPoint:a}:{vertex:[a.x,a.y],mapPoint:a}:null};d.prototype.isDuplicateVertex=function(a,b){if(a.length){a=a[a.length-1];var c=a[1];return a[0]===b[0]&&c===b[1]}return!1};d.prototype.getGeometryZValue=function(){return this.defaultZ};d.prototype.isSnapToSceneEnabled=function(a){return"on-the-ground"!==a.mode};d.prototype.screenToMap=function(a){var d=null;if("3d"===this.view.type)if(this.hasZ)var d=
b.unwrapOr(this.elevationInfo,r),h=this.isSnapToSceneEnabled(d)&&b.isSome(this.snapToScene)?this.snapToScene:null,d=b.isSome(h)?h(a,d):this.view.sceneIntersectionHelper.intersectElevationFromScreen(f.createScreenPointArray(a.x,a.y),d,this.getGeometryZValue());else d=b.unwrapOr(this.elevationInfo,c),d=this.view.sceneIntersectionHelper.intersectElevationFromScreen(f.createScreenPointArray(a.x,a.y),d,0),b.isSome(d)&&(d.z=void 0);else d=this.view.toMap(a),b.isSome(d)&&(d.z=this.hasZ?this.getGeometryZValue():
void 0);return d};l([h.property({type:Boolean,nonNullable:!0})],d.prototype,"interactiveUndoDisabled",void 0);l([h.property({readOnly:!0})],d.prototype,"history",void 0);l([h.property({readOnly:!0})],d.prototype,"redoHistory",void 0);l([h.property()],d.prototype,"snapToScene",void 0);l([h.property()],d.prototype,"view",void 0);l([h.property()],d.prototype,"elevationInfo",void 0);l([h.property({nonNullable:!0})],d.prototype,"defaultZ",void 0);l([h.property({dependsOn:["view"]})],d.prototype,"hasZ",
null);return d=l([h.subclass("esri.views.draw.DrawAction")],d)}(h.declared(q.EventedAccessor))})},"esri/views/draw/input/DrawEvents":function(){define(["require","exports","../../../core/tsSupport/declareExtendsHelper"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});z=function(){function d(d,b,f,h){this.view=d;this.native=b;this.vertexIndex=f;this.vertices=h;this.defaultPrevented=!1;this.type="vertex-add"}d.prototype.preventDefault=function(){this.defaultPrevented=!0};return d}();
d.VertexAddEvent=z;z=function(){function d(d,b,f,h){this.view=d;this.native=b;this.vertexIndex=f;this.vertices=h;this.defaultPrevented=!1;this.type="vertex-update"}d.prototype.preventDefault=function(){this.defaultPrevented=!0};return d}();d.VertexUpdateEvent=z;z=function(){function d(d,b,f,h){this.view=d;this.native=b;this.vertexIndex=f;this.vertices=h;this.defaultPrevented=!1;this.type="vertex-remove"}d.prototype.preventDefault=function(){this.defaultPrevented=!0};return d}();d.VertexRemoveEvent=
z;z=function(){function d(d,b,f,h,l){void 0===l&&(l=null);this.view=d;this.native=b;this.vertexIndex=f;this.vertices=h;this.mapPoint=l;this.defaultPrevented=!1;this.type="cursor-update"}d.prototype.preventDefault=function(){this.defaultPrevented=!0};return d}();d.CursorUpdateEvent=z;z=function(){function d(d,b){this.native=d;this.vertices=b;this.defaultPrevented=!1;this.type="draw-complete"}d.prototype.preventDefault=function(){this.defaultPrevented=!0};return d}();d.DrawCompleteEvent=z})},"esri/views/draw/input/Keys":function(){define(["require",
"exports"],function(z,d){Object.defineProperty(d,"__esModule",{value:!0});d.KEYS={drawCompleteKey:"c",redoKey:"r",undoKey:"z",vertexAddKey:"f",panKey:" "}})},"esri/views/draw/PointDrawAction":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Handles ../../core/maybe ../../core/screenUtils ../../core/accessorSupport/decorators ./DrawAction ./input/Keys ../input/InputManager ../input/recognizers/PointerClickHoldAndDrag".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m){var u=function(){function a(a,b,c){this.view=a;this.native=b;this.coordinates=c;this.defaultPrevented=!1;this.type="cursor-update"}a.prototype.preventDefault=function(){this.defaultPrevented=!0};return a}(),D=function(){function a(a,b){this.native=a;this.coordinates=b;this.defaultPrevented=!1;this.type="draw-complete"}a.prototype.preventDefault=function(){this.defaultPrevented=!0};return a}();return function(d){function r(a){a=d.call(this,a)||this;a._clickDelay=m.DefaultParameters.maximumClickDelay;
a._cursorMoved=!1;a._cursorScreenPoint=null;a._pointerDownEvent=null;a._viewHandles=new q;a.coordinates=[];a.view=null;return a}t(r,d);r.prototype.initialize=function(){this._addViewHandles()};r.prototype.destroy=function(){this._removeViewHandles();this._viewHandles.destroy();this.emit("destroy")};r.prototype.complete=function(){if(this._cursorScreenPoint){var a=this.getCoordsFromScreenPoint(this._cursorScreenPoint);b.isSome(a)&&(this._set("coordinates",a),this._completeDrawing())}};r.prototype._addViewHandles=
function(){var d=this;this._removeViewHandles();this._viewHandles.add([this.view.on("click",function(a){a.stopPropagation();var c=d.getCoordsFromScreenPoint(a.screenPoint);b.isSome(c)&&(d._set("coordinates",c),d._drawCompleteHandler(a))},a.ViewEventPriorities.TOOL),this.view.on("pointer-down",function(a){d._pointerDownEvent=a;d._cursorMoved=!1},a.ViewEventPriorities.TOOL),this.view.on("pointer-move",function(a){d._cursorMoved=!0;d._cursorScreenPoint=f.createScreenPointFromEvent(a);d._cursorUpdateHandler(a)},
a.ViewEventPriorities.TOOL),this.view.on("pointer-up",function(a){if(d._pointerDownEvent&&!d._cursorMoved&&a.timestamp-d._pointerDownEvent.timestamp>d._clickDelay){d._cursorScreenPoint=f.createScreenPointFromEvent(a);var c=d.getCoordsFromScreenPoint(d._cursorScreenPoint);b.isSome(c)&&(d._set("coordinates",c),d._drawCompleteHandler(a))}},a.ViewEventPriorities.TOOL),this.view.on("key-down",function(a){if(a.key===c.KEYS.drawCompleteKey&&d._cursorScreenPoint){var f=d.getCoordsFromScreenPoint(d._cursorScreenPoint);
b.isSome(f)&&(d._set("coordinates",f),d._drawCompleteHandler(a))}},a.ViewEventPriorities.TOOL)])};r.prototype._removeViewHandles=function(){this._viewHandles.removeAll()};r.prototype._updateCursor=function(a,b){this.emit("cursor-update",new u(this.view,b,a))};r.prototype._completeDrawing=function(a){this._cursorMoved=!1;this._pointerDownEvent=null;a=new D(a,this.coordinates);this.emit("draw-complete",a);a.defaultPrevented||this._removeViewHandles()};r.prototype._cursorUpdateHandler=function(a){this._updateCursor(this.getCoordsFromScreenPoint(this._cursorScreenPoint),
a.native)};r.prototype._drawCompleteHandler=function(a){this._completeDrawing(a.native)};l([h.property({readOnly:!0})],r.prototype,"coordinates",void 0);l([h.property()],r.prototype,"view",void 0);return r=l([h.subclass("esri.views.draw.PointDrawAction")],r)}(h.declared(r))})},"esri/views/input/recognizers/PointerClickHoldAndDrag":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/clock ../InputHandler ./support".split(" "),function(z,d,t,l,q,b){Object.defineProperty(d,
"__esModule",{value:!0});d.DefaultParameters={maximumClickDelay:300,movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500};z=function(f){function h(b,c,a,h,q,t){void 0===b&&(b=d.DefaultParameters.maximumClickDelay);void 0===c&&(c=d.DefaultParameters.movementUntilMouseDrag);void 0===a&&(a=d.DefaultParameters.movementUntilPenDrag);void 0===h&&(h=d.DefaultParameters.movementUntilTouchDrag);void 0===q&&(q=d.DefaultParameters.holdDelay);void 0===t&&(t=l.default);var m=
f.call(this,!1)||this;m.maximumClickDelay=b;m.movementUntilMouseDrag=c;m.movementUntilPenDrag=a;m.movementUntilTouchDrag=h;m.holdDelay=q;m._clock=t;m._pointerState=new Map;m._pointerDrag=m.registerOutgoing("pointer-drag");m._immediateClick=m.registerOutgoing("immediate-click");m._pointerHold=m.registerOutgoing("hold");m.registerIncoming("pointer-down",m._handlePointerDown.bind(m));m.registerIncoming("pointer-up",function(a){m._handlePointerLoss(a,"pointer-up")});m.registerIncoming("pointer-capture-lost",
function(a){m._handlePointerLoss(a,"pointer-capture-lost")});m.registerIncoming("pointer-cancel",function(a){m._handlePointerLoss(a,"pointer-cancel")});m._moveHandle=m.registerIncoming("pointer-move",m._handlePointerMove.bind(m));m._moveHandle.pause();return m}t(h,f);h.prototype.onUninstall=function(){this._pointerState.forEach(function(b){null!=b.holdTimeout&&(b.holdTimeout.remove(),b.holdTimeout=null)});f.prototype.onUninstall.call(this)};h.prototype._handlePointerDown=function(b){var c=this,a=
b.data,d=a.native.pointerId,f=null;0===this._pointerState.size&&(f=this._clock.setTimeout(function(){var a=c._pointerState.get(d);a&&(a.isDragging||(c._pointerHold.emit(a.previousEvent,void 0,b.modifiers),a.holdEmitted=!0),a.holdTimeout=null)},this.holdDelay));f={startEvent:a,previousEvent:a,startTimestamp:b.timestamp,isDragging:!1,downButton:a.native.button,holdTimeout:f,modifiers:new Set};this._pointerState.set(d,f);this.startCapturingPointer(a.native);this._moveHandle.resume();1<this._pointerState.size&&
this.startDragging(b)};h.prototype._createPointerDragData=function(b,c,a){return{action:b,startEvent:c.startEvent,previousEvent:c.previousEvent,currentEvent:a}};h.prototype._handlePointerMove=function(d){var c=d.data,a=this._pointerState.get(c.native.pointerId);if(a){if(a.isDragging)this._pointerDrag.emit(this._createPointerDragData("update",a,c),void 0,a.modifiers);else{var f=b.euclideanDistance(c,a.startEvent),h=this._getDragThreshold(c.native.pointerType);f>h&&this.startDragging(d)}a.previousEvent=
c}};h.prototype._getDragThreshold=function(b){switch(b){case "touch":return this.movementUntilTouchDrag;case "pen":return this.movementUntilPenDrag;default:return this.movementUntilMouseDrag}};h.prototype.startDragging=function(b){var c=this,a=b.data,d=a.native.pointerId;this._pointerState.forEach(function(f){null!=f.holdTimeout&&(f.holdTimeout.remove(),f.holdTimeout=null);f.isDragging||(f.modifiers=b.modifiers,f.isDragging=!0,d===f.startEvent.native.pointerId?c._pointerDrag.emit(c._createPointerDragData("start",
f,a)):c._pointerDrag.emit(c._createPointerDragData("start",f,f.previousEvent),b.timestamp))})};h.prototype._handlePointerLoss=function(b,c){var a=b.data,d=a.native.pointerId,f=this._pointerState.get(d);f&&(null!=f.holdTimeout&&(f.holdTimeout.remove(),f.holdTimeout=null),f.isDragging?this._pointerDrag.emit(this._createPointerDragData("end",f,"pointer-up"===c?a:f.previousEvent),void 0,f.modifiers):"pointer-up"===c&&f.downButton===a.native.button&&b.timestamp-f.startTimestamp<=this.maximumClickDelay&&
!f.holdEmitted&&this._immediateClick.emit(a),this._pointerState.delete(d),this.stopCapturingPointer(a.native),0===this._pointerState.size&&this._moveHandle.pause())};return h}(q.InputHandler);d.PointerClickHoldAndDrag=z})},"esri/views/input/recognizers/support":function(){define(["require","exports","../../../core/screenUtils"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});d.manhattanDistance=function(d,q){return Math.abs(q.x-d.x)+Math.abs(q.y-d.y)};d.euclideanDistance=function(d,
q){var b=q.x-d.x;d=q.y-d.y;return Math.sqrt(b*b+d*d)};d.fitCircleLSQ=function(d,q){q?(q.radius=0,q.center.x=0,q.center.y=0):q={radius:0,center:t.createScreenPoint()};if(0===d.length)return q;if(1===d.length)return q.center.x=d[0].x,q.center.y=d[0].y,q;if(2===d.length){var b=d[0];d=d[1];var f=[d.x-b.x,d.y-b.y],h=f[0],f=f[1];q.radius=Math.sqrt(h*h+f*f)/2;q.center.x=(b.x+d.x)/2;q.center.y=(b.y+d.y)/2;return q}for(var l=0,c=0,a=0;a<d.length;a++)l+=d[a].x,c+=d[a].y;for(var l=l/d.length,c=c/d.length,m=
d.map(function(a){return a.x-l}),u=d.map(function(a){return a.y-c}),z=b=q=0,w=0,v=h=0,a=f=0;a<m.length;a++){var E=m[a],C=u[a],J=E*E,K=C*C;q+=J;b+=K;z+=E*C;w+=J*E;h+=K*C;v+=E*K;f+=C*J}a=q;m=z;u=b;w=.5*(w+v);h=.5*(h+f);f=a*u-z*m;v=(w*u-h*m)/f;h=(a*h-z*w)/f;f=t.createScreenPoint(v+l,h+c);return{radius:Math.sqrt(v*v+h*h+(q+b)/d.length),center:f}}})},"esri/views/draw/PolygonDrawAction":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Handles ../../core/maybe ../../core/screenUtils ../../core/accessorSupport/decorators ./DrawAction ./input/DrawEvents ./input/Keys ../input/InputManager".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m){return function(d){function r(a){a=d.call(this,a)||this;a._cursorScreenPoint=null;a._panEnabled=!1;a._cursorVertexAdded=!1;a._popVertexOnPointerMove=!1;a._addVertexOnPointerUp=!1;a._activePointerId=null;a._viewHandles=new q;a.mode="hybrid";a.vertices=[];a.view=null;return a}t(r,d);r.prototype.initialize=function(){this._addViewHandles()};r.prototype.destroy=function(){this._removeViewHandles();this._viewHandles.destroy();this.emit("destroy")};Object.defineProperty(r.prototype,
"_clickEnabled",{get:function(){return-1!==["hybrid","click"].indexOf(this.mode)},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"_dragEnabled",{get:function(){return-1!==["hybrid","freehand"].indexOf(this.mode)},enumerable:!0,configurable:!0});r.prototype.addVertex=function(a,b){var d=this;this.vertices.splice(b,0,a);this.history.push({vertex:a,vertexIndex:b,undo:function(){return d._undoVertexAdd(null,b)},redo:function(){return d._redoVertexAdd(null,a,b)}});this._set("redoHistory",
[]);var f=new c.VertexAddEvent(this.view,null,b,this.vertices);this.emit("vertex-add",f);f.defaultPrevented&&(this._popVertexOnPointerMove=!0,this.history.pop())};r.prototype.removeVertex=function(a){var b=this,d=this.vertices.splice(a,1)[0];this.history.push({vertex:d,vertexIndex:a,undo:function(){return b._undoVertexRemove(null,d,a)},redo:function(){return b._redoVertexRemove(null,a)}});this._set("redoHistory",[]);this.emit("vertex-remove",new c.VertexRemoveEvent(this.view,null,a,this.vertices))};
r.prototype.updateVertex=function(a,b){var d=this,f=this.vertices[b];this.vertices[b]=a;this.history.push({vertex:a,vertexIndex:b,undo:function(){return d._undoVertexUpdate(null,f,b)},redo:function(){return d._redoVertexUpdate(null,a,b)}});this._set("redoHistory",[]);this.emit("vertex-update",new c.VertexUpdateEvent(this.view,null,b,this.vertices))};r.prototype.complete=function(){this._completeDrawing()};r.prototype.getGeometryZValue=function(){return 0<this.vertices.length&&2<this.vertices[0].length?
this.vertices[0][2]:this._get("defaultZ")};r.prototype.isSnapToSceneEnabled=function(a){return!("on-the-ground"===a.mode||0<this.vertices.length)};r.prototype._addViewHandles=function(){var c=this;this._removeViewHandles();this._viewHandles.add([this.view.on("click",function(a){a.stopPropagation()},m.ViewEventPriorities.TOOL),this.view.on("pointer-down",function(a){c._shouldHandlePointerEvent(a)&&!c._panEnabled&&(c._activePointerId=a.pointerId,c._addVertexOnPointerUp=!0,c._cursorScreenPoint=f.createScreenPointFromEvent(a),
"touch"===a.pointerType&&c._updateCursor(a.native))},m.ViewEventPriorities.TOOL),this.view.on("pointer-move",function(a){c._popVertexOnPointerMove&&(c.vertices.pop(),c._popVertexOnPointerMove=!1);c._cursorScreenPoint=f.createScreenPointFromEvent(a);"touch"!==a.pointerType&&c._updateCursor(a.native)},m.ViewEventPriorities.TOOL),this.view.on("pointer-drag",function(a){c._shouldHandlePointerEvent(a)&&(c._cursorScreenPoint=f.createScreenPointFromEvent(a),c._dragEnabled&&!c._panEnabled?c._vertexAddHandler(a):
c._addVertexOnPointerUp=!1)},m.ViewEventPriorities.TOOL),this.view.on("pointer-up",function(a){c._shouldHandlePointerEvent(a)&&(c._activePointerId=null,c._addVertexOnPointerUp?c._clickEnabled?c._vertexAddHandler(a):(1===c.vertices.length&&c.vertices.pop(),c._drawCompleteHandler(a)):c._updateCursor(a.native,"touch"===a.pointerType))},m.ViewEventPriorities.TOOL),this.view.on("drag",function(a){c._dragEnabled&&b.isSome(c._activePointerId)&&!c._panEnabled&&a.stopPropagation()},m.ViewEventPriorities.TOOL),
this.view.on("drag",["Shift"],function(a){a.stopPropagation()},m.ViewEventPriorities.TOOL),this.view.on("double-click",function(a){a.stopPropagation();c._drawCompleteHandler(a)},m.ViewEventPriorities.TOOL),this.view.on("double-click",["Control"],function(a){a.stopPropagation();c._drawCompleteHandler(a)},m.ViewEventPriorities.TOOL),this.view.on("key-down",function(b){var d=b.key,f=b.repeat;d===a.KEYS.vertexAddKey&&!f&&c._cursorScreenPoint?(b.stopPropagation(),c._vertexAddHandler(b)):d===a.KEYS.drawCompleteKey&&
!f&&c._cursorScreenPoint&&2<c.vertices.length?(b.stopPropagation(),c._vertexAddHandler(b),c._drawCompleteHandler(b)):d!==a.KEYS.undoKey||c.interactiveUndoDisabled||f?d!==a.KEYS.redoKey||c.interactiveUndoDisabled||f?d!==a.KEYS.panKey||f||(b.stopPropagation(),c._panEnabled=!0):(b.stopPropagation(),c.redo()):(b.stopPropagation(),c.undo())},m.ViewEventPriorities.TOOL),this.view.on("key-up",function(b){b.key===a.KEYS.panKey&&(b.stopPropagation(),c._panEnabled=!1)},m.ViewEventPriorities.TOOL)])};r.prototype._removeViewHandles=
function(){this._viewHandles.removeAll()};r.prototype._addVertex=function(a,b){var d=this;this._popCursorVertex();if(!this.isDuplicateVertex(this.vertices,a)){var f=this.vertices.length;this.vertices.push(a);this.history.push({vertex:a,vertexIndex:f,undo:function(){return d._undoVertexAdd(b,f)},redo:function(){return d._redoVertexAdd(b,a,f)}});this._set("redoHistory",[]);var h=new c.VertexAddEvent(this.view,b,f,this.vertices);this.emit("vertex-add",h);h.defaultPrevented&&(this._popVertexOnPointerMove=
!0,this.history.pop())}};r.prototype._updateCursor=function(a,d){void 0===d&&(d=!1);this._popCursorVertex();if(this._cursorScreenPoint){var f=null,h=null,l=this.getCoordsAndPointFromScreenPoint(this._cursorScreenPoint);b.isSome(l)&&(f=l.mapPoint,d||(h=this._pushCursorVertex(l.vertex)));a=new c.CursorUpdateEvent(this.view,a,h,this.vertices,f);this.emit("cursor-update",a)}};r.prototype._completeDrawing=function(a){this._activePointerId=null;this._popCursorVertex();3>this.vertices.length||(a=new c.DrawCompleteEvent(a,
this.vertices),this.emit("draw-complete",a),a.defaultPrevented||this._removeViewHandles())};r.prototype._undoVertexAdd=function(a,b){this.vertices.splice(b,1);this.emit("undo",new c.VertexRemoveEvent(this.view,a,b,this.vertices))};r.prototype._redoVertexAdd=function(a,b,d){this.vertices.splice(d,0,b);this.emit("redo",new c.VertexAddEvent(this.view,a,d,this.vertices))};r.prototype._undoVertexRemove=function(a,b,d){this.vertices.splice(d,0,b);this.emit("undo",new c.VertexAddEvent(this.view,a,d,this.vertices))};
r.prototype._redoVertexRemove=function(a,b){this.vertices.splice(b,1);this.emit("redo",new c.VertexRemoveEvent(this.view,a,b,this.vertices))};r.prototype._undoVertexUpdate=function(a,b,d){this.vertices[d]=b;this.emit("undo",new c.VertexUpdateEvent(this.view,a,d,this.vertices))};r.prototype._redoVertexUpdate=function(a,b,d){this.vertices[d]=b;this.emit("redo",new c.VertexUpdateEvent(this.view,a,d,this.vertices))};r.prototype._pushCursorVertex=function(a){this._popCursorVertex();this.vertices.push(a);
this._cursorVertexAdded=!0;return this.vertices.length-1};r.prototype._popCursorVertex=function(){this._cursorVertexAdded&&(this.vertices.pop(),this._cursorVertexAdded=!1)};r.prototype._shouldHandlePointerEvent=function(a){return("mouse"!==a.pointerType||0===a.button)&&(b.isNone(this._activePointerId)||this._activePointerId===a.pointerId)};r.prototype._vertexAddHandler=function(a){if(this._cursorVertexAdded)this._addVertex(this.vertices[this.vertices.length-1],a.native);else{var c=this.getCoordsFromScreenPoint(this._cursorScreenPoint);
b.isSome(c)&&this._addVertex(c,a.native)}};r.prototype._drawCompleteHandler=function(a){this._completeDrawing(a.native)};l([h.property({dependsOn:["mode"]})],r.prototype,"_clickEnabled",null);l([h.property({dependsOn:["mode"]})],r.prototype,"_dragEnabled",null);l([h.property({cast:function(a){return-1===["hybrid","freehand","click"].indexOf(a)?"hybrid":a}})],r.prototype,"mode",void 0);l([h.property({readOnly:!0})],r.prototype,"vertices",void 0);l([h.property()],r.prototype,"view",void 0);return r=
l([h.subclass("esri.views.draw.PolygonDrawAction")],r)}(h.declared(r))})},"esri/views/draw/PolylineDrawAction":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Handles ../../core/maybe ../../core/screenUtils ../../core/accessorSupport/decorators ./DrawAction ./input/DrawEvents ./input/Keys ../input/InputManager".split(" "),function(z,d,t,l,q,b,f,h,r,c,a,m){return function(d){function r(a){a=d.call(this,a)||this;a._cursorScreenPoint=
null;a._panEnabled=!1;a._cursorVertexAdded=!1;a._popVertexOnPointerMove=!1;a._addVertexOnPointerUp=!1;a._activePointerId=null;a._viewHandles=new q;a.mode="hybrid";a.vertices=[];a.view=null;return a}t(r,d);r.prototype.initialize=function(){this._addViewHandles()};r.prototype.destroy=function(){this._removeViewHandles();this._viewHandles.destroy();this.emit("destroy")};Object.defineProperty(r.prototype,"_clickEnabled",{get:function(){return-1!==["hybrid","click"].indexOf(this.mode)},enumerable:!0,configurable:!0});
Object.defineProperty(r.prototype,"_dragEnabled",{get:function(){return-1!==["hybrid","freehand"].indexOf(this.mode)},enumerable:!0,configurable:!0});r.prototype.addVertex=function(a,b){var d=this;this.vertices.splice(b,0,a);this.history.push({vertex:a,vertexIndex:b,undo:function(){return d._undoVertexAdd(null,b)},redo:function(){return d._redoVertexAdd(null,a,b)}});this._set("redoHistory",[]);var f=new c.VertexAddEvent(this.view,null,b,this.vertices);this.emit("vertex-add",f);f.defaultPrevented&&
(this._popVertexOnPointerMove=!0,this.history.pop())};r.prototype.removeVertex=function(a){var b=this,d=this.vertices.splice(a,1)[0];this.history.push({vertex:d,vertexIndex:a,undo:function(){return b._undoVertexRemove(null,d,a)},redo:function(){return b._redoVertexRemove(null,a)}});this._set("redoHistory",[]);this.emit("vertex-remove",new c.VertexRemoveEvent(this.view,null,a,this.vertices))};r.prototype.updateVertex=function(a,b){var d=this,f=this.vertices[b];this.vertices[b]=a;this.history.push({vertex:a,
vertexIndex:b,undo:function(){return d._undoVertexUpdate(null,f,b)},redo:function(){return d._redoVertexUpdate(null,a,b)}});this._set("redoHistory",[]);this.emit("vertex-update",new c.VertexUpdateEvent(this.view,null,b,this.vertices))};r.prototype.complete=function(){this._completeDrawing()};r.prototype._addViewHandles=function(){var c=this;this._removeViewHandles();this._viewHandles.add([this.view.on("click",function(a){a.stopPropagation()},m.ViewEventPriorities.TOOL),this.view.on("pointer-down",
function(a){c._shouldHandlePointerEvent(a)&&!c._panEnabled&&(c._activePointerId=a.pointerId,c._addVertexOnPointerUp=!0,c._cursorScreenPoint=f.createScreenPointFromEvent(a),"touch"===a.pointerType&&c._updateCursor(a.native))},m.ViewEventPriorities.TOOL),this.view.on("pointer-move",function(a){c._popVertexOnPointerMove&&(c.vertices.pop(),c._popVertexOnPointerMove=!1);c._cursorScreenPoint=f.createScreenPointFromEvent(a);"touch"!==a.pointerType&&c._updateCursor(a.native)},m.ViewEventPriorities.TOOL),
this.view.on("pointer-drag",function(a){c._shouldHandlePointerEvent(a)&&(c._cursorScreenPoint=f.createScreenPointFromEvent(a),c._dragEnabled&&!c._panEnabled?c._vertexAddHandler(a):c._addVertexOnPointerUp=!1)},m.ViewEventPriorities.TOOL),this.view.on("pointer-up",function(a){c._shouldHandlePointerEvent(a)&&(c._activePointerId=null,c._addVertexOnPointerUp?c._clickEnabled?c._vertexAddHandler(a):(1===c.vertices.length&&c.vertices.pop(),c._drawCompleteHandler(a)):c._updateCursor(a.native,"touch"===a.pointerType))},
m.ViewEventPriorities.TOOL),this.view.on("drag",function(a){c._dragEnabled&&b.isSome(c._activePointerId)&&!c._panEnabled&&a.stopPropagation()},m.ViewEventPriorities.TOOL),this.view.on("drag",["Shift"],function(a){a.stopPropagation()},m.ViewEventPriorities.TOOL),this.view.on("double-click",function(a){a.stopPropagation();c._drawCompleteHandler(a)},m.ViewEventPriorities.TOOL),this.view.on("double-click",["Control"],function(a){a.stopPropagation();c._drawCompleteHandler(a)},m.ViewEventPriorities.TOOL),
this.view.on("key-down",function(b){var d=b.key,f=b.repeat;d===a.KEYS.vertexAddKey&&!f&&c._cursorScreenPoint?(b.stopPropagation(),c._vertexAddHandler(b)):d===a.KEYS.drawCompleteKey&&!f&&c._cursorScreenPoint&&1<c.vertices.length?(b.stopPropagation(),c._vertexAddHandler(b),c._drawCompleteHandler(b)):d!==a.KEYS.undoKey||c.interactiveUndoDisabled||f?d!==a.KEYS.redoKey||c.interactiveUndoDisabled||f?d!==a.KEYS.panKey||f||(b.stopPropagation(),c._panEnabled=!0):(b.stopPropagation(),c.redo()):(b.stopPropagation(),
c.undo())},m.ViewEventPriorities.TOOL),this.view.on("key-up",function(b){b.key===a.KEYS.panKey&&(b.stopPropagation(),c._panEnabled=!1)},m.ViewEventPriorities.TOOL)])};r.prototype._removeViewHandles=function(){this._viewHandles.removeAll()};r.prototype._addVertex=function(a,b){var d=this;this._popCursorVertex();if(!this.isDuplicateVertex(this.vertices,a)){this.vertices.push(a);var f=this.vertices.length-1;this.history.push({vertex:a,vertexIndex:f,undo:function(){return d._undoVertexAdd(b,f)},redo:function(){return d._redoVertexAdd(b,
a,f)}});this._set("redoHistory",[]);var h=new c.VertexAddEvent(this.view,b,f,this.vertices);this.emit("vertex-add",h);h.defaultPrevented&&(this._popVertexOnPointerMove=!0,this.history.pop())}};r.prototype._updateCursor=function(a,d){void 0===d&&(d=!1);this._popCursorVertex();if(this._cursorScreenPoint){var f=null,h=null,l=this.getCoordsAndPointFromScreenPoint(this._cursorScreenPoint);b.isSome(l)&&(f=l.mapPoint,d||(h=this._pushCursorVertex(l.vertex)));a=new c.CursorUpdateEvent(this.view,a,h,this.vertices,
f);this.emit("cursor-update",a)}};r.prototype._completeDrawing=function(a){this._activePointerId=null;this._popCursorVertex();2>this.vertices.length||(a=new c.DrawCompleteEvent(a,this.vertices),this.emit("draw-complete",a),a.defaultPrevented||this._removeViewHandles())};r.prototype._undoVertexAdd=function(a,b){this.vertices.splice(b,1);this.emit("undo",new c.VertexRemoveEvent(this.view,a,b,this.vertices))};r.prototype._redoVertexAdd=function(a,b,d){this.vertices.splice(d,0,b);this.emit("redo",new c.VertexAddEvent(this.view,
a,d,this.vertices))};r.prototype._undoVertexRemove=function(a,b,d){this.vertices.splice(d,0,b);this.emit("undo",new c.VertexAddEvent(this.view,a,d,this.vertices))};r.prototype._redoVertexRemove=function(a,b){this.vertices.splice(b,1);this.emit("redo",new c.VertexRemoveEvent(this.view,a,b,this.vertices))};r.prototype._undoVertexUpdate=function(a,b,d){this.vertices[d]=b;this.emit("undo",new c.VertexUpdateEvent(this.view,a,d,this.vertices))};r.prototype._redoVertexUpdate=function(a,b,d){this.vertices[d]=
b;this.emit("redo",new c.VertexUpdateEvent(this.view,a,d,this.vertices))};r.prototype._pushCursorVertex=function(a){this._popCursorVertex();this.vertices.push(a);this._cursorVertexAdded=!0;return this.vertices.length-1};r.prototype._popCursorVertex=function(){this._cursorVertexAdded&&(this.vertices.pop(),this._cursorVertexAdded=!1)};r.prototype._shouldHandlePointerEvent=function(a){return("mouse"!==a.pointerType||0===a.button)&&(b.isNone(this._activePointerId)||this._activePointerId===a.pointerId)};
r.prototype._vertexAddHandler=function(a){if(this._cursorVertexAdded)this._addVertex(this.vertices[this.vertices.length-1],a.native);else{var c=this.getCoordsFromScreenPoint(this._cursorScreenPoint);b.isSome(c)&&this._addVertex(c,a.native)}};r.prototype._drawCompleteHandler=function(a){this._completeDrawing(a.native)};l([h.property({dependsOn:["mode"]})],r.prototype,"_clickEnabled",null);l([h.property({dependsOn:["mode"]})],r.prototype,"_dragEnabled",null);l([h.property({cast:function(a){return-1===
["hybrid","freehand","click"].indexOf(a)?"hybrid":a}})],r.prototype,"mode",void 0);l([h.property({readOnly:!0})],r.prototype,"vertices",void 0);l([h.property()],r.prototype,"view",void 0);return r=l([h.subclass("esri.views.draw.PolylineDrawAction")],r)}(h.declared(r))})},"esri/views/draw/SegmentDrawAction":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Handles ../../core/maybe ../../core/screenUtils ../../core/accessorSupport/decorators ./DrawAction ./input/DrawEvents ./input/Keys ./support/createUtils ../input/InputManager".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u){return function(d){function r(a){a=d.call(this,a)||this;a._isDragging=!1;a._panEnabled=!1;a._cursorScreenPoint=null;a._viewHandles=new q;a._cursorVertexAdded=!1;a._activePointerId=null;a.viewAlignedCoordinateSystem=null;a.mode="freehand";a.vertices=[];a.view=null;return a}t(r,d);r.prototype.initialize=function(){this._addViewHandles()};r.prototype.destroy=function(){this._removeViewHandles();this._viewHandles.destroy();this.emit("destroy")};r.prototype.complete=
function(){this._completeDrawing()};r.prototype.getGeometryZValue=function(){return 0<this.vertices.length&&2<this.vertices[0].length?this.vertices[0][2]:this._get("defaultZ")};r.prototype.isSnapToSceneEnabled=function(a){return!("on-the-ground"===a.mode||0<this.vertices.length)};r.prototype._addViewHandles=function(){this._removeViewHandles();"click"===this.mode?this._viewHandles.add(this._getClickModeViewHandles()):this._viewHandles.add(this._getDragModeViewHandles())};r.prototype._getDragModeViewHandles=
function(){var c=this;return[this.view.on("click",function(a){a.stopPropagation();if(a.mapPoint&&!c._panEnabled){var d=c.getCoordsFromScreenPoint(a.screenPoint);b.isSome(d)&&(c._set("vertices",[d]),c._drawCompleteHandler(a))}},u.ViewEventPriorities.TOOL),this.view.on("pointer-down",function(a){c._shouldHandlePointerEvent(a)&&!c._panEnabled&&(c._cursorScreenPoint=f.createScreenPointFromEvent(a),c._set("vertices",[]),c._activePointerId=a.pointerId,c._vertexAddHandler(a),c._isDragging=!1,"touch"===a.pointerType&&
c._cursorUpdateHandler(a))},u.ViewEventPriorities.TOOL),this.view.on("pointer-move",function(a){c._cursorScreenPoint=f.createScreenPointFromEvent(a);b.isNone(c._activePointerId)&&"touch"!==a.pointerType&&0===c.vertices.length&&c._cursorUpdateHandler(a)},u.ViewEventPriorities.TOOL),this.view.on("pointer-drag",function(a){c._shouldHandlePointerEvent(a)&&(c._isDragging=!0,c._cursorScreenPoint=f.createScreenPointFromEvent(a),c._cursorUpdateHandler(a))},u.ViewEventPriorities.TOOL),this.view.on("pointer-up",
function(a){c._shouldHandlePointerEvent(a)&&(c._activePointerId=null,c._popCursorVertex(),c._isDragging&&!c._panEnabled&&(c._vertexAddHandler(a),c._drawCompleteHandler(a)),c._isDragging=!1)},u.ViewEventPriorities.TOOL),this.view.on("key-down",function(b){b.key===a.KEYS.drawCompleteKey&&c._cursorScreenPoint?c._drawCompleteHandler(b):b.key===a.KEYS.panKey&&(c._panEnabled=!0)},u.ViewEventPriorities.TOOL),this.view.on("key-up",function(b){b.key===a.KEYS.panKey&&(c._panEnabled=!1)},u.ViewEventPriorities.TOOL),
this.view.on("drag",function(a){b.isSome(c._activePointerId)&&a.stopPropagation()},u.ViewEventPriorities.TOOL),this.view.on("drag",["Shift"],function(a){a.stopPropagation()},u.ViewEventPriorities.TOOL)]};r.prototype._getClickModeViewHandles=function(){var c=this;return[this.view.on("click",function(a){a.stopPropagation()},u.ViewEventPriorities.TOOL),this.view.on("pointer-down",function(a){c._cursorScreenPoint=f.createScreenPointFromEvent(a);c._activePointerId=a.pointerId;c._isDragging=!1;"touch"===
a.pointerType&&c._cursorUpdateHandler(a)},u.ViewEventPriorities.TOOL),this.view.on("pointer-move",function(a){c._cursorScreenPoint=f.createScreenPointFromEvent(a);b.isNone(c._activePointerId)&&"touch"!==a.pointerType&&c._cursorUpdateHandler(a)},u.ViewEventPriorities.TOOL),this.view.on("pointer-drag",function(a){c._shouldHandlePointerEvent(a)&&(c._isDragging=!0)},u.ViewEventPriorities.TOOL),this.view.on("pointer-up",function(a){c._shouldHandlePointerEvent(a)&&(c._activePointerId=null,c._isDragging||
c._vertexAddHandler(a),2!==c.vertices.length||c._isDragging||c._drawCompleteHandler(a),c._isDragging=!1)},u.ViewEventPriorities.TOOL),this.view.on("key-down",function(b){b.key===a.KEYS.vertexAddKey&&c._cursorScreenPoint&&(c._vertexAddHandler(b),2===c.vertices.length&&c._drawCompleteHandler(b));b.key===a.KEYS.drawCompleteKey&&c._cursorScreenPoint&&2===c.vertices.length&&c._drawCompleteHandler(b)},u.ViewEventPriorities.TOOL)]};r.prototype._removeViewHandles=function(){this._viewHandles.removeAll()};
r.prototype._addVertex=function(a,b){this._popCursorVertex();this.isDuplicateVertex(this.vertices,a)||(this.vertices.push(a),1===this.vertices.length&&(this.viewAlignedCoordinateSystem=m.createViewAlignedCoordinateSystem(this.view,this.vertices[0])),a=this.vertices.indexOf(a),b=new c.VertexAddEvent(this.view,b,a,this.vertices),this.emit("vertex-add",b))};r.prototype._updateCursor=function(a,d){var f=null;b.isSome(a)&&(f=this._pushCursorVertex(a));a=new c.CursorUpdateEvent(this.view,d,f,this.vertices);
this.emit("cursor-update",a)};r.prototype._completeDrawing=function(a){this._activePointerId=null;this._popCursorVertex();this._isDragging=!1;this._cursorScreenPoint=null;1>this.vertices.length||(a=new c.DrawCompleteEvent(a,this.vertices),this.emit("draw-complete",a),a.defaultPrevented||this._removeViewHandles())};r.prototype._pushCursorVertex=function(a){this._popCursorVertex();this.vertices.push(a);this._cursorVertexAdded=!0;return this.vertices.length-1};r.prototype._popCursorVertex=function(){this._cursorVertexAdded&&
(this.vertices.pop(),this._cursorVertexAdded=!1)};r.prototype._shouldHandlePointerEvent=function(a){return("mouse"!==a.pointerType||0===a.button)&&(b.isNone(this._activePointerId)||this._activePointerId===a.pointerId)};r.prototype._vertexAddHandler=function(a){var c=this.getCoordsFromScreenPoint(this._cursorScreenPoint);b.isSome(c)&&this._addVertex(c,a.native)};r.prototype._cursorUpdateHandler=function(a){var b=this.getCoordsFromScreenPoint(this._cursorScreenPoint);this._updateCursor(b,a.native)};
r.prototype._drawCompleteHandler=function(a){this._completeDrawing(a.native)};l([h.property({cast:function(a){return-1===["freehand","click"].indexOf(a)?"freehand":a}})],r.prototype,"mode",void 0);l([h.property({readOnly:!0})],r.prototype,"vertices",void 0);l([h.property()],r.prototype,"view",void 0);return r=l([h.subclass("esri/views/2d/engine/markup/SegmentDrawAction")],r)}(h.declared(r))})},"esri/views/draw/support/createUtils":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../../../geometry ../../../core/arrayUtils ../../../core/lang ../../../core/maybe ../../../core/unitUtils ../../../core/libs/gl-matrix-2/mat2d ../../../core/libs/gl-matrix-2/mat2df64 ../../../core/libs/gl-matrix-2/quat ../../../core/libs/gl-matrix-2/quatf64 ../../../core/libs/gl-matrix-2/vec3 ../../../core/libs/gl-matrix-2/vec3f64 ../../../geometry/Circle ../../../geometry/geometryEngine ../../../geometry/support/coordsUtils ../../../geometry/support/spatialReferenceUtils".split(" "),
function(z,d,t,l,q,b,f,h,r,c,a,m,u,D,w,v,E,C,J){function K(a,b,c){void 0===c&&(c=null);return h.isSome(c)?[a,b,c]:[a,b]}function G(a,b,c){void 0===c&&(c=null);return h.isSome(c)?{x:a,y:b,z:c}:{x:a,y:b}}function I(a,b){b=new q.Point({x:a[0],y:a[1],spatialReference:b});2<a.length&&(b.z=a[2]);return b}function x(a,c,d,h){void 0===h&&(h=!0);a=f.clone(a);a.forEach(function(a){b.equals(a[0],a[a.length-1])||a.push(a[0])});a=new q.Polygon({rings:a,spatialReference:c});a.rings.forEach(function(a){C.isClockwise(a,
!1,!1)||a.reverse()});d&&C.unnormalizeGeometryOnDatelineCrossing(a);h&&a.isSelfIntersecting&&J.isValid(c)&&(a=E.simplify(a));return a}Object.defineProperty(d,"__esModule",{value:!0});d.makeMapPoint=K;d.makeSurfacePoint=G;z=function(){function a(a){this.spatialReference=a}a.prototype.mapToLocalMultiple=function(a){var b=this;return a.map(function(a){return b.mapToLocal(a)})};Object.defineProperty(a.prototype,"doUnnormalization",{get:function(){return!1},enumerable:!0,configurable:!0});return a}();
d.SurfaceCoordinateSystem=z;var N=function(b){function d(d,f,h){void 0===h&&(h=null);f=b.call(this,f)||this;f.defaultZ=h;f.transform=a.mat2df64.create();f.transformInv=a.mat2df64.create();f.transform=a.mat2df64.clone(d);c.mat2d.invert(f.transformInv,f.transform);return f}t(d,b);d.prototype.makeMapPoint=function(a,b){return K(a,b,this.defaultZ)};d.prototype.mapToLocal=function(a){return G(this.transform[0]*a[0]+this.transform[2]*a[1]+this.transform[4],this.transform[1]*a[0]+this.transform[3]*a[1]+
this.transform[5])};d.prototype.localToMap=function(a){return K(this.transformInv[0]*a.x+this.transformInv[2]*a.y+this.transformInv[4],this.transformInv[1]*a.x+this.transformInv[3]*a.y+this.transformInv[5],this.defaultZ)};return d}(z);d.AffineCoordinateSystem=N;var O=function(a){function b(b,c){var d=a.call(this,b.spatialReference)||this;d.view=b;d.defaultZ=null;d.pWS=w.vec3f64.create();d.tangentFrameUpWS=w.vec3f64.create();d.tangentFrameRightWS=w.vec3f64.create();d.tangentFrameForwardWS=w.vec3f64.create();
d.localFrameRightWS=w.vec3f64.create();d.localFrameUpWS=w.vec3f64.create();d.worldToLocalTransform=u.quatf64.create();d.localToWorldTransform=u.quatf64.create();d.scale=1;d.scale=b.resolution;d.referenceMapPoint=c;d.defaultZ=c.hasZ?c.z:null;b=b.state.camera.viewRight;d.view.renderCoordsHelper.toRenderCoords(d.referenceMapPoint,d.pWS);d.view.renderCoordsHelper.worldBasisAtPosition(d.pWS,0,d.tangentFrameRightWS);d.view.renderCoordsHelper.worldBasisAtPosition(d.pWS,1,d.tangentFrameUpWS);d.view.renderCoordsHelper.worldBasisAtPosition(d.pWS,
2,d.tangentFrameForwardWS);c=w.vec3f64.create();D.vec3.scale(c,d.tangentFrameForwardWS,D.vec3.dot(b,d.tangentFrameForwardWS));D.vec3.subtract(d.localFrameRightWS,b,c);D.vec3.normalize(d.localFrameRightWS,d.localFrameRightWS);D.vec3.cross(d.localFrameUpWS,d.tangentFrameForwardWS,d.localFrameRightWS);m.quat.rotationTo(d.worldToLocalTransform,d.localFrameRightWS,d.tangentFrameRightWS);m.quat.invert(d.localToWorldTransform,d.worldToLocalTransform);return d}t(b,a);Object.defineProperty(b.prototype,"doUnnormalization",
{get:function(){return"global"===this.view.viewingMode},enumerable:!0,configurable:!0});b.prototype.makeMapPoint=function(a,b){return K(a,b,this.defaultZ)};b.prototype.mapToLocal=function(a){var b=w.vec3f64.create();this.view.renderCoordsHelper.toRenderCoords(new q.Point({x:a[0],y:a[1],spatialReference:this.spatialReference}),b);D.vec3.transformQuat(b,b,this.worldToLocalTransform);a=this.view.renderCoordsHelper.fromRenderCoords(b,this.view.spatialReference);return G(a.x/this.scale,a.y/this.scale)};
b.prototype.localToMap=function(a){var b=w.vec3f64.create();this.view.renderCoordsHelper.toRenderCoords(new q.Point({x:a.x*this.scale,y:a.y*this.scale,spatialReference:this.spatialReference}),b);D.vec3.transformQuat(b,b,this.localToWorldTransform);a=this.view.renderCoordsHelper.fromRenderCoords(b,this.view.spatialReference);return K(a.x,a.y,this.defaultZ)};return b}(z);d.SceneViewCoordinateSystem=O;d.createViewAlignedCoordinateSystem=function(a,b){return"2d"===a.type?new N(a.state.transform,a.spatialReference,
2<b.length?b[2]:null):"3d"===a.type?(b=2<b.length?new q.Point({x:b[0],y:b[1],z:b[2],spatialReference:a.spatialReference}):new q.Point({x:b[0],y:b[1],spatialReference:a.spatialReference}),new O(a,b)):null};d.createPoint=I;d.createMultipoint=function(a,b){return new q.Multipoint({points:a,spatialReference:b})};d.createPolyline=function(a,b,c){a=new q.Polyline({paths:a,spatialReference:b});c&&C.unnormalizeGeometryOnDatelineCrossing(a);return a};d.createPolygon=x;d.createSquare=function(a,b,c){var d=
b.mapToLocalMultiple(a);a=[];var f=d[0].x,h=d[0].y,l=Math.round(d[1].x-f),m=Math.round(d[1].y-h),d=Math.max(Math.abs(l),Math.abs(m));c?(c=f+d,l=h+d,f-=d,h-=d,a.push(G(c,h),G(f,h),G(f,l),G(c,l))):(c=0<l?f+d:f-d,d=0<m?h+d:h-d,a.push(G(f,h),G(c,h),G(c,d),G(f,d)));return x([a.map(function(a){return b.localToMap(a)})],b.spatialReference,b.doUnnormalization,!0)};d.createRectangle=function(a,b,c){var d=b.mapToLocalMultiple(a);1===d.length&&(a=d[0],d=[G(a.x-48,a.y+48),G(a.x+48,a.y-48),G(a.x+48,a.y-48),G(a.x-
48,a.y+48)]);a=[];var f=d[0].x,h=d[0].y,l=d[1].x,d=d[1].y;if(c){c=Math.round(l-f);var m=Math.round(d-h);a.push(G(f-c,h-m),G(l,h-m),G(l,d),G(f-c,d))}else a.push(G(f,h),G(l,h),G(l,d),G(f,d));return x([a.map(function(a){return b.localToMap(a)})],b.spatialReference,b.doUnnormalization,!0)};d.createCircle=function(a,b,c){var d=b.mapToLocalMultiple(a),f=a=null;c?(a=d[0],f=d[1]):(a=d[0],d=d[1],c=Math.round(d.x-a.x),d=Math.round(d.y-a.y),f=Math.max(Math.abs(c),Math.abs(d)),a=G(0<c?a.x+f/2:a.x-f/2,0<d?a.y+
f/2:a.y-f/2),f=G(Math.abs(c)>Math.abs(d)?a.x-f/2:a.x,Math.abs(c)>Math.abs(d)?a.y:a.y-f/2));a=b.localToMap(a);c=b.localToMap(f);b.doUnnormalization&&C.unnormalizeVerticesOnDatelineCrossing([[a,c]],b.spatialReference);a=I(a,b.spatialReference);c=I(c,b.spatialReference);c=r.getMetersPerUnitForSR(b.spatialReference)*E.distance(a,c,null);b=new v({center:a,radius:c,radiusUnit:"meters",spatialReference:b.spatialReference});return x(b.rings,b.spatialReference,!1)};d.createEllipse=function(a,b,c){var d=b.mapToLocalMultiple(a);
a=d[0];var f=d[1],d=Math.round(f.x-a.x),f=Math.round(f.y-a.y);a=G(c?a.x:a.x+d/2,c?a.y:a.y+f/2);d=c?d:d/2;c=c?f:f/2;for(var f=[],h=2*Math.PI/60,l=0;60>l;l++){var m=G(d*Math.cos(l*h)+a.x,c*Math.sin(l*h)+a.y);f.push(m)}f.push(f[0]);return x([f.map(function(a){return b.localToMap(a)})],b.spatialReference,b.doUnnormalization,!1)}})},"esri/core/libs/gl-matrix-2/mat2d":function(){define(["require","exports","./math/mat2d"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});d.mat2d=t})},"esri/core/libs/gl-matrix-2/mat2df64":function(){define(["require",
"exports","./factories/mat2df64"],function(z,d,t){Object.defineProperty(d,"__esModule",{value:!0});d.mat2df64=t})},"esri/core/libs/gl-matrix-2/factories/mat2df64":function(){define(["require","exports"],function(z,d){Object.defineProperty(d,"__esModule",{value:!0});d.create=function(){return[1,0,0,1,0,0]};d.clone=function(d){return[d[0],d[1],d[2],d[3],d[4],d[5]]};d.fromValues=function(d,l,q,b,f,h){return[d,l,q,b,f,h]};d.createView=function(d,l){return new Float64Array(d,l,6)}})},"esri/geometry/geometryEngine":function(){define("require exports ../kernel ../geometry/Geometry ../geometry/Polygon ../geometry/Polyline ../geometry/Point ../geometry/Extent ../geometry/Multipoint dojo/_base/lang".split(" "),
function(z,d,t,l,q,b,f,h,r,c){function a(a){if(void 0===f.fromJson){if(void 0!==a.x&&void 0!==a.y)return new f(a);if(void 0!==a.paths)return new b(a);if(void 0!==a.rings)return new q(a);if(void 0!==a.points)return new r(a);if(void 0!==a.xmin&&void 0!==a.ymin&&void 0!==a.xmax&&void 0!==a.ymax)return new h(a)}else{if(void 0!==a.x&&void 0!==a.y)return f.fromJson(a);if(void 0!==a.paths)return b.fromJson(a);if(void 0!==a.rings)return q.fromJson(a);if(void 0!==a.points)return r.fromJson(a);if(void 0!==
a.xmin&&void 0!==a.ymin&&void 0!==a.xmax&&void 0!==a.ymax)return h.fromJson(a)}}function m(a){if(void 0===f.fromJson){if(void 0!==a.x&&void 0!==a.y)return new f(a);if(void 0!==a.paths)return new b(a);if(void 0!==a.rings)return new q(a);if(void 0!==a.points)return new r(a);if(void 0!==a.xmin&&void 0!==a.ymin&&void 0!==a.xmax&&void 0!==a.ymax)return new h(a)}else{if(void 0!==a.x&&void 0!==a.y)return f.fromJSON(a);if(void 0!==a.paths)return b.fromJSON(a);if(void 0!==a.rings)return q.fromJSON(a);if(void 0!==
a.points)return r.fromJSON(a);if(void 0!==a.xmin&&void 0!==a.ymin&&void 0!==a.xmax&&void 0!==a.ymax)return h.fromJSON(a)}}function u(a,b){var c;if(null==a||void 0===a||"number"===typeof a)return a;var k=a.toString();if(""===k)return null;if(2==b){if(c=Y[k],void 0!==c)return c}else if(0==b){c=V[k];if(void 0!==c)return c;c=T[a];if(void 0!==c)return c}else if(3==b&&(c=V[k],void 0!==c))return c;if(1==b&&(c=T[a],void 0!==c))return c;if(!0===/^\d+$/.test(k))return parseInt(k);throw Error("Unrecognised Unit Type");
}function D(a){if(void 0!==a&&null!==a)switch(a){case "loxodrome":return 1;case "great-elliptic":return 2;case "normal-section":return 3;case "shape-preserving":return 4}return 0}function w(a,c){if(null===a||void 0===a||a.u())return null;switch(a.G()){case x.Fj.Point:var d=new f(a.Be(),a.nf(),c);if(Q){var k=a.hasAttribute(x.Wc.M);a.hasAttribute(x.Wc.Z)&&d.set("z",a.rH());k&&d.set("m",a.aH())}return d;case x.Fj.Polygon:var d=a.hasAttribute(x.Wc.Z),k=a.hasAttribute(x.Wc.M),e=v(a,d,k),d=new q({rings:e,
hasZ:d,hasM:k});Q?d.set("spatialReference",c):d.setSpatialReference(c);d.setCacheValue("_geVersion",a);return d;case x.Fj.Polyline:return d=a.hasAttribute(x.Wc.Z),k=a.hasAttribute(x.Wc.M),e=v(a,d,k),d=new b({paths:e,hasZ:d,hasM:k}),Q?d.set("spatialReference",c):d.setSpatialReference(c),d.setCacheValue("_geVersion",a),d;case x.Fj.MultiPoint:var d=a.hasAttribute(x.Wc.Z),k=a.hasAttribute(x.Wc.M),g=e=null;d&&(e=a.Pa(x.Wc.Z));k&&(g=a.Pa(x.Wc.M));var n=new x.b,y=a.D();c=new r(c);Q&&(c.set("hasZ",d),c.set("hasM",
k));for(var B=0;B<y;B++){a.w(B,n);var p=[n.x,n.y];d&&p.push(e.get(B));k&&p.push(g.get(B));c.addPoint(p)}c.setCacheValue("_geVersion",a);return c;case x.Fj.Envelope:return e=a.hasAttribute(x.Wc.Z),d=a.hasAttribute(x.Wc.M),k=new h(a.R.o,a.R.A,a.R.v,a.R.B,c),Q&&(e&&(e=a.xf(x.Wc.Z,0),k.set("zmin",e.ca),k.set("zmax",e.ha)),d&&(e=a.xf(x.Wc.M,0),k.set("mmin",e.ca),k.set("mmax",e.ha))),k.setCacheValue("_geVersion",a),k}return null}function v(a,b,c){var k=[],e=a.aa(),g=null,n=null;b&&(g=a.Pa(x.Wc.Z));c&&(n=
a.Pa(x.Wc.M));for(var d=new x.b,B=0;B<e;B++){for(var p=a.wa(B),f=a.La(B),M=0,h=0,l=NaN,A=NaN,m=NaN,q=NaN,r=a.Qb(B),t=[],u=p;u<p+f;u++){a.w(u,d);var q=m=NaN,v=[d.x,d.y];b&&(m=g.get(u),v.push(m));c&&(q=n.get(u),v.push(q));u==p&&r&&(M=d.x,h=d.y,l=m,A=q);t.push(v)}!r||M==d.x&&h==d.y&&(!b||isNaN(l)&&isNaN(m)||l==m)&&(!c||isNaN(A)&&isNaN(q)||A==q)||t.push(t[0].slice(0));k.push(t)}return k}function E(a){var b=a._geVersion;if(null==b||void 0==b){if(Object.freeze&&Object.isFrozen(a))return 102100===a.wkid?
W:4326===a.wkid?aa:b=x.Rd.create(a.wkid);-1!=a.wkid&&null!==a.wkid&&void 0!==a.wkid?(b=x.Rd.create(a.wkid),a._geVersion=b):""!==a.wkt&&void 0!==a.wkt&&null!==a.wkt&&(b=x.Rd.qR(a.wkt),a._geVersion=b)}return b}function C(a){if(null==a)return null;if(void 0===a.getCacheValue){var b=a._geVersion;if(null==b||void 0==b)b=x.cc.dG(a),a._geVersion=b}else if(b=a.getCacheValue("_geVersion"),null==b||void 0==b)b=x.cc.dG(a),a.setCacheValue("_geVersion",b);return b}function J(a){return null===a.spatialReference?
null:E(a.spatialReference)}function K(a){return"[object Array]"===Object.prototype.toString.call(a)}function G(a){if(null===a||void 0===a||a.u())return null;switch(a.G()){case x.Fj.Point:var b={};b.x=a.Be();b.y=a.nf();if(Q){var c=a.hasAttribute(x.Wc.M);a.hasAttribute(x.Wc.Z)&&(b.z=a.rH());c&&(b.m=a.aH())}return b;case x.Fj.Polygon:return b=a.hasAttribute(x.Wc.Z),c=a.hasAttribute(x.Wc.M),{rings:v(a,b,c),hasZ:b,hasM:c};case x.Fj.Polyline:return b=a.hasAttribute(x.Wc.Z),c=a.hasAttribute(x.Wc.M),{paths:v(a,
b,c),hasZ:b,hasM:c};case x.Fj.MultiPoint:var b=a.hasAttribute(x.Wc.Z),c=a.hasAttribute(x.Wc.M),k=null,e=null;b&&(k=a.Pa(x.Wc.Z));c&&(e=a.Pa(x.Wc.M));var g=new x.b,n=a.D(),d={points:[]};Q&&(d.hasZ=b,d.hasM=c);for(var B=0;B<n;B++){a.w(B,g);var p=[g.x,g.y];b&&p.push(k.get(B));c&&p.push(e.get(B));d.points.push(p)}return d;case x.Fj.Envelope:return k=a.hasAttribute(x.Wc.Z),b=a.hasAttribute(x.Wc.M),c={},c.xmin=a.R.o,c.ymin=a.R.A,c.xmax=a.R.v,c.ymax=a.R.B,Q&&(k&&(k=a.xf(x.Wc.Z,0),c.zmin=k.ca,c.zmax=k.ha),
b&&(k=a.xf(x.Wc.M,0),c.mmin=k.ca,c.mmax=k.ha)),c}return null}var I=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var k in b)b.hasOwnProperty(k)&&(a[k]=b[k]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},x;(function(a){var b=function(){function a(){}a.Bm=!1;a.jw=!1;a.yz="";return a}();a.Xh=b;if("undefined"!==typeof window)a.Xh.yz="browser","Float64Array"in window&&(a.Xh.jw=!0),"ArrayBuffer"in window&&(a.Xh.Bm=!0);else if("undefined"!==typeof process)b.yz=
"node",a.Xh.Bm=!0,a.Xh.jw=!0;else{b.yz="browser";try{var c=new ArrayBuffer(0);new Uint8Array(c);a.Xh.Bm=!0;a.Xh.jw=!0}catch(k){a.Xh.Bm=!1}}})(x||(x={}));(function(a){(function(a){a[a.Unknown=0]="Unknown";a[a.Point=33]="Point";a[a.Line=322]="Line";a[a.Envelope=197]="Envelope";a[a.MultiPoint=550]="MultiPoint";a[a.Polyline=1607]="Polyline";a[a.Polygon=1736]="Polygon"})(a.Fj||(a.Fj={}));(function(a){a[a.enumMild=0]="enumMild";a[a.enumMedium=1]="enumMedium";a[a.enumHot=2]="enumHot"})(a.uM||(a.uM={}));
var b=function(){function b(){this.description=null;this.CB=0}b.prototype.G=function(){return 0};b.prototype.tb=function(){return-1};b.prototype.Fg=function(a){this.Ac();a!=this.description&&this.mo(a)};b.prototype.mo=function(){};b.prototype.om=function(b){this.Ac();b!=this.description&&(b=a.ze.wT(this.description,b),b!=this.description&&this.mo(b))};b.prototype.hasAttribute=function(a){return this.description.hasAttribute(a)};b.prototype.Td=function(b){this.Ac();this.description.hasAttribute(b)||
(b=a.ze.vT(this.description,b),this.mo(b))};b.prototype.xf=function(){return null};b.prototype.Qn=function(){};b.prototype.s=function(){};b.prototype.Cp=function(){};b.prototype.ac=function(a){this.s(a)};b.prototype.u=function(){return!0};b.prototype.Oa=function(){};b.prototype.Xc=function(){};b.prototype.Ka=function(){return null};b.prototype.copyTo=function(){};b.prototype.hf=function(){return 0};b.prototype.Rb=function(){return 0};b.prototype.uH=function(){return this.hasAttribute(1)};b.lf=function(a){return((a&
192)>>6)+1>>1};b.Jo=function(a){return 0!=(a&32)};b.l_=function(a){return 0!=(a&64)};b.PU=function(a){return 0!=(a&128)};b.Oc=function(a){return 0!=(a&256)};b.gh=function(a){return 0!=(a&512)};b.Ic=function(a){return 0!=(a&1024)};b.prototype.Vf=function(){var a=this.Ka();this.copyTo(a);return a};b.prototype.Gg=function(){return null};b.oe=function(a){var e=a.Ka();a.copyTo(e);return e};b.prototype.Ac=function(){0<=this.CB&&(this.CB+=2147483649)};b.gy=function(k){var e=k.G();if(b.gh(e))return k.D();
if(k.u())return 0;if(197==e)return 4;if(33==e)return 1;if(b.Oc(e))return 2;throw a.g.X("missing type");};return b}();a.T=b})(x||(x={}));(function(a){var b=function(){function b(){this.y=this.x=0}b.pa=function(a,e){var g=new b;g.x=a;g.y=e;return g};b.El=function(a){var e=new b;e.x=a.x;e.y=a.y;return e};b.prototype.ka=function(a,e){this.x=a;this.y=e};b.prototype.L=function(a){this.x=a.x;this.y=a.y};b.prototype.Uq=function(a,e){return this.x===a&&this.y===e};b.prototype.xA=function(a){return 2.220446049250313E-16>=
Math.abs(this.x-a.x)&&2.220446049250313E-16>=Math.abs(this.y-a.y)};b.prototype.ub=function(a){return this.x===a.x&&this.y===a.y};b.prototype.Eb=function(a){return a==this?!0:a instanceof b?this.x==a.x&&this.y==a.y:!1};b.prototype.sub=function(a){this.x-=a.x;this.y-=a.y};b.prototype.yc=function(a,e){this.x=a.x-e.x;this.y=a.y-e.y};b.prototype.add=function(a,e){void 0!==e?(this.x=a.x+e.x,this.y=a.y+e.y):(this.x+=a.x,this.y+=a.y)};b.prototype.Lr=function(){this.x=-this.x;this.y=-this.y};b.prototype.bu=
function(a){this.x=-a.x;this.y=-a.y};b.prototype.JU=function(a,e,g){this.x=a.x*(1-g)+e.x*g;this.y=a.y*(1-g)+e.y*g};b.prototype.ru=function(a,e){this.x=this.x*a+e.x;this.y=this.y*a+e.y};b.prototype.FX=function(a,e,g){this.x=e.x*a+g.x;this.y=e.y*a+g.y};b.prototype.scale=function(a){this.x*=a;this.y*=a};b.prototype.compare=function(a){return this.y<a.y?-1:this.y>a.y?1:this.x<a.x?-1:this.x>a.x?1:0};b.prototype.normalize=function(){var a=this.length();0==a&&(this.x=1,this.y=0);this.x/=a;this.y/=a};b.prototype.length=
function(){return Math.sqrt(this.x*this.x+this.y*this.y)};b.prototype.qk=function(){return this.x*this.x+this.y*this.y};b.Cb=function(a,e){return Math.sqrt(this.sc(a,e))};b.xz=function(a,e,g,b){a-=g;e-=b;return Math.sqrt(a*a+e*e)};b.prototype.oi=function(a){return this.x*a.x+this.y*a.y};b.prototype.zE=function(a){return Math.abs(this.x*a.x)+Math.abs(this.y*a.y)};b.prototype.Ui=function(a){return this.x*a.y-this.y*a.x};b.prototype.qu=function(a,e){var g=-this.x*e+this.y*a;this.x=this.x*a+this.y*e;
this.y=g};b.prototype.uw=function(){var a=this.x;this.x=-this.y;this.y=a};b.prototype.aI=function(a){this.x=-a.y;this.y=a.x};b.prototype.Ur=function(){var a=this.x;this.x=this.y;this.y=-a};b.prototype.dv=function(){this.y=this.x=NaN};b.prototype.Hy=function(){return isNaN(this.x)};b.prototype.$u=function(){return 0<this.x?0<=this.y?1:4:0<this.y?2:0==this.x?4:3};b.vs=function(a,e){var g=a.$u(),b=e.$u();return b==g?(g=a.Ui(e),0>g?1:0<g?-1:0):g<b?-1:1};b.AZ=function(a,e){return b.vs(a,e)};b.sc=function(a,
e){var g=a.x-e.x;a=a.y-e.y;return g*g+a*a};b.prototype.toString=function(){return"("+this.x+" , "+this.y+")"};b.prototype.$c=function(){this.y=this.x=NaN};b.prototype.isNaN=function(){return isNaN(this.x)||isNaN(this.y)};b.prototype.SO=function(){return this.Hy()?NaN:Math.abs(this.x)>=Math.abs(this.y)?Math.abs(this.x):Math.abs(this.y)};b.prototype.offset=function(a,e){var g=b.Cb(a,e),n=b.pa(this.x,this.y);if(0==g)return b.Cb(n,a);var c=new b;c.L(e);c.sub(a);n.sub(a);return n.Ui(c)/g};b.zp=function(b,
e,g){var n=new a.Xb;n.set(e.x);n.sub(b.x);var c=new a.Xb;c.set(g.y);c.sub(b.y);var k=new a.Xb;k.set(e.y);k.sub(b.y);var d=new a.Xb;d.set(g.x);d.sub(b.x);n.Vg(c);k.Vg(d);n.sub(k);if(!n.lt())return g=n.value(),0>g?-1:0<g?1:0;n=new a.Tp(e.x);c=new a.Tp(b.x);k=new a.Tp(b.y);n=n.Zt(c);b=new a.Tp(g.y);b=b.Zt(k);e=new a.Tp(e.y);e=e.Zt(k);g=new a.Tp(g.x);g=g.Zt(c);n=n.ds(b);e=e.ds(g);n=n.ds(e);return n.pV()?-1:n.aU()?1:0};b.prototype.jc=function(){return a.J.Zi(a.J.Zi())};return b}();a.b=b})(x||(x={}));(function(a){var b=
function(){function a(a){this.kz=this.Au=0;this.IY=a}a.prototype.reset=function(){this.kz=this.Au=0};a.prototype.add=function(a){a-=this.kz;var e=this.Au+a;this.kz=e-this.Au-a;this.Au=e};a.prototype.sub=function(a){this.add(-a)};a.prototype.en=function(){return this.IY+this.Au};return a}();a.ry=b;b=function(){function a(){}a.Fl=function(a,e){return 0<=e?Math.abs(a):-Math.abs(a)};a.sign=function(a){return 0>a?-1:0<a?1:0};a.hM=function(a){return a-360*Math.floor(a/360)};a.round=function(a){return Math.floor(a+
.5)};a.Yx=function(a){return a*a};a.Xq=function(a,e,g){var b;.5>=g?b=a+(e-a)*g:b=e-(e-a)*(1-g);return b};a.cI=function(a,e,g,b){.5>=g?(b.x=a.x+(e.x-a.x)*g,b.y=a.y+(e.y-a.y)*g):(b.x=e.x-(e.x-a.x)*(1-g),b.y=e.y-(e.y-a.y)*(1-g))};a.nV=function(a,e,g,b,c,d){.5>=c?(d.x=a+(g-a)*c,d.y=e+(b-e)*c):(d.x=g-(g-a)*(1-c),d.y=b-(b-e)*(1-c))};return a}();a.Ub=b})(x||(x={}));(function(a){var b=function(b){function c(){b.call(this);this.oa=this.sa=this.ra=this.ua=0;this.la=null}I(c,b);c.prototype.ec=function(){return a.b.pa(this.ua,
this.ra)};c.prototype.Oq=function(e){e.x=this.ua;e.y=this.ra};c.prototype.Mc=function(e){this.Qm(0,e)};c.prototype.xC=function(e,g){this.Qm(0,a.b.pa(e,g))};c.prototype.Dp=function(e){this.BE(0,e)};c.prototype.setStart=function(e){this.LE(0,e)};c.prototype.dt=function(e,a){return this.ae(0,e,a)};c.prototype.Tx=function(e,a,b){this.oo(0,e,a,b)};c.prototype.Bc=function(){return a.b.pa(this.sa,this.oa)};c.prototype.Ps=function(e){e.x=this.sa;e.y=this.oa};c.prototype.Zc=function(e){this.Qm(1,e)};c.prototype.vm=
function(e,g){this.Qm(1,a.b.pa(e,g))};c.prototype.Bp=function(e){this.BE(1,e)};c.prototype.setEnd=function(e){this.LE(1,e)};c.prototype.Os=function(e,a){return this.ae(1,e,a)};c.prototype.Lx=function(e,a,b){this.oo(1,e,a,b)};c.prototype.tb=function(){return 1};c.prototype.u=function(){return this.Hc()};c.prototype.Oa=function(){};c.prototype.hf=function(){return 0};c.prototype.Ma=function(e,a,b,c,k){return this.QO(e,a,b,c,k)};c.prototype.Yb=function(e,a){return 0!=this.ys(e,a,!1)};c.prototype.mt=
function(e,a){return this.av(e,a,!1)};c.prototype.av=function(){return null};c.prototype.Hc=function(){return!1};c.prototype.Jy=function(e){this.Ac();if(null==this.la&&0<e)this.la=a.J.gf(2*e);else if(null!=this.la&&this.la.length<2*e){for(var g=this.la.slice(0),b=this.la.length;b<2*e;b++)g[b]=0;this.la=g}};c.cX=function(e,a,b){if(0<b)var g=0;for(var n=0;n<b;n++)a[0+g]=e[0],g++};c.prototype.Qm=function(e,a){0!=e?(this.sa=a.x,this.oa=a.y):(this.ua=a.x,this.ra=a.y)};c.prototype.mo=function(e){if(null!=
this.la){for(var g=a.ze.vx(e,this.description),b=[],k=c.ul(this.description,0),d=c.ul(this.description,1),p=c.ul(e,0),f=c.ul(e,1),M=0,h=1,l=e.Ga;h<l;h++){var m=e.qd(h),A=a.ma.Xa(m);if(-1==g[h])for(var q=a.ma.de(m),m=0;m<A;m++)b[p+M]=q,b[f+M]=q,M++;else for(q=this.description.wk(g[h])-2,m=0;m<A;m++)b[p+M]=this.la[k+q],b[f+M]=this.la[d+q],M++,q++}this.la=b}this.description=e};c.prototype.BE=function(e,g){if(this.Hc())throw a.g.X("empty geometry");g.Fg(this.description);g.Hc()&&g.nq();for(var b=0;b<
this.description.Ga;b++)for(var c=this.description.Sd(b),k=0,d=a.ma.Xa(c);k<d;k++){var p=this.ae(e,c,k);g.setAttribute(c,k,p)}};c.prototype.LE=function(e,g){this.Ac();if(g.Hc())throw a.g.X("empty geometry");for(var b=g.description,c=0,k=b.Ga;c<k;c++)for(var d=b.Sd(c),p=a.ma.Xa(d),f=0;f<p;f++){var h=g.Yc(d,f);this.oo(e,d,f,h)}};c.prototype.ae=function(e,g,b){if(this.Hc())throw a.g.X("This operation was performed on an Empty Geometry.");if(0==g)return 0!=e?0!=b?this.oa:this.sa:0!=b?this.ra:this.ua;
if(b>=a.ma.Xa(g))throw a.g.wd();var n=this.description.mg(g);return 0<=n?(null!=this.la&&this.Jy(this.description.af.length-2),this.la[c.ul(this.description,e)+this.description.wk(n)-2+b]):a.ma.de(g)};c.prototype.oo=function(e,g,b,k){this.Ac();if(b>=a.ma.Xa(g))throw a.g.wd();var n=this.description.mg(g);0>n&&(this.Td(g),n=this.description.mg(g));0==g?0!=e?0!=b?this.oa=k:this.sa=k:0!=b?this.ra=k:this.ua=k:(null==this.la&&this.Jy(this.description.af.length-2),this.la[c.ul(this.description,e)+this.description.wk(n)-
2+b]=k)};c.prototype.copyTo=function(e){if(e.G()!=this.G())throw a.g.F();e.description=this.description;e.Jy(this.description.af.length-2);c.cX(this.la,e.la,2*(this.description.af.length-2));e.ua=this.ua;e.ra=this.ra;e.sa=this.sa;e.oa=this.oa;e.Ac();this.iq(e)};c.prototype.xf=function(e,g){var b=new a.zc;if(this.Hc())return b.Oa(),b;b.ca=this.ae(0,e,g);b.ha=b.ca;b.ll(this.ae(1,e,g));return b};c.prototype.SJ=function(e){this.Hc()?e.Oa():(e.ca=this.ae(0,0,0),e.ha=e.ca,e.ll(this.ae(1,0,0)))};c.prototype.Fx=
function(e,g){g.Fg(this.description);g.rb(this.gc(e));for(var b=1,c=this.description.Ga;b<c;b++)for(var k=this.description.Sd(b),d=a.ma.Xa(k),p=0;p<d;p++){var f=this.Yc(e,k,p);g.setAttribute(k,p,f)}};c.prototype.NO=function(e){if(this.description!=e.description||this.ua!=e.ua||this.sa!=e.sa||this.ra!=e.ra||this.oa!=e.oa)return!1;for(var a=0;a<2*(this.description.af.length-2);a++)if(this.la[a]!=e.la[a])return!1;return!0};c.prototype.OH=function(){return this.ua==this.sa&&this.ra==this.oa};c.prototype.reverse=
function(){var e=this.ua;this.ua=this.sa;this.sa=e;e=this.ra;this.ra=this.oa;this.oa=e;for(var e=1,g=this.description.Ga;e<g;e++)for(var b=this.description.qd(e),c=0,k=a.ma.Xa(b);c<k;c++){var d=this.ae(0,b,c),p=this.ae(1,b,c);this.oo(0,b,c,p);this.oo(1,b,c,d)}};c.prototype.ys=function(e,g,b){var n=e.G();switch(this.G()){case 322:if(322==n)return a.Hb.RO(this,e,g,b);throw a.g.za();default:throw a.g.za();}};c.prototype.QO=function(e,g,b,c,k){var n=e.G();switch(this.G()){case 322:if(322==n)return a.Hb.Gy(this,
e,g,b,c,k);throw a.g.za();default:throw a.g.za();}};c.prototype.Cy=function(){return null};c.ul=function(e,a){return a*(e.af.length-2)};c.prototype.gc=function(e,g){if(void 0===g)return g=new a.b,this.gc(e,g),g;a.Ub.nV(this.ua,this.ra,this.sa,this.oa,e,g)};c.prototype.qe=function(){return null};c.prototype.qH=function(){return null};c.prototype.Tq=function(){return null};c.prototype.fh=function(){return null};c.prototype.Go=function(){return null};c.prototype.Eg=function(){return null};c.prototype.Dy=
function(e,a){return void 0!==a?this.cy(a)-this.cy(e):this.cy(e)};c.prototype.iq=function(){};c.prototype.Hl=function(){return null};c.prototype.yh=function(){};c.prototype.Yc=function(){return null};c.prototype.pf=function(){return null};c.prototype.cy=function(){return null};c.prototype.bI=function(){return null};c.prototype.Cb=function(e,a){if(!a&&0!=this.ys(e,0,!1))return 0;a=1.7976931348623157E308;var g,b;g=this.ec();b=e.qe(g,!1);g.sub(e.gc(b));g=g.length();g<a&&(a=g);g=this.Bc();b=e.qe(g,!1);
g.sub(e.gc(b));g=g.length();g<a&&(a=g);g=e.ec();b=this.qe(g,!1);g.sub(this.gc(b));g=g.length();g<a&&(a=g);g=e.Bc();b=this.qe(g,!1);g.sub(this.gc(b));g=g.length();g<a&&(a=g);return a};c.prototype.Gg=function(){return a.Pi.Rm(this,null)};return c}(a.T);a.dE=b})(x||(x={}));new x.b;(function(a){(function(a){a[a.Unknown=-1]="Unknown";a[a.Not=0]="Not";a[a.Weak=1]="Weak";a[a.Strong=2]="Strong"})(a.wM||(a.wM={}));(function(a){a[a.DirtyIsKnownSimple=1]="DirtyIsKnownSimple";a[a.IsWeakSimple=2]="IsWeakSimple";
a[a.IsStrongSimple=4]="IsStrongSimple";a[a.DirtyOGCFlags=8]="DirtyOGCFlags";a[a.DirtyVerifiedStreams=32]="DirtyVerifiedStreams";a[a.DirtyExactIntervals=64]="DirtyExactIntervals";a[a.DirtyLooseIntervals=128]="DirtyLooseIntervals";a[a.DirtyIntervals=192]="DirtyIntervals";a[a.DirtyIsEnvelope=256]="DirtyIsEnvelope";a[a.DirtyLength2D=512]="DirtyLength2D";a[a.DirtyRingAreas2D=1024]="DirtyRingAreas2D";a[a.DirtyCoordinates=1993]="DirtyCoordinates";a[a.DirtyAllInternal=65535]="DirtyAllInternal";a[a.DirtyAll=
16777215]="DirtyAll"})(a.aM||(a.aM={}));var b=function(b){function c(){b.call(this);this.tn=65535;this.qa=0;this.lh=-1;this.ob=null}I(c,b);c.prototype.iq=function(){};c.prototype.Iy=function(){};c.prototype.Py=function(){};c.prototype.D=function(){return this.qa};c.prototype.u=function(){return this.Hc()};c.prototype.Hc=function(){return 0==this.qa};c.prototype.xk=function(e){return 0!=(this.tn&e)};c.prototype.lg=function(e,a){this.tn=a?this.tn|e:this.tn&~e};c.prototype.wc=function(){this.xk(32)&&
this.$O()};c.prototype.Cu=function(){if(this.Hc())throw a.g.X("This operation was performed on an Empty Geometry.");};c.prototype.Ae=function(e,g){if(0>e||e>=this.qa)throw a.g.X("index out of bounds");this.wc();g.Fg(this.description);g.u()&&g.nq();for(var b=0;b<this.description.Ga;b++)for(var c=this.description.Sd(b),k=0,d=a.ma.Xa(c);k<d;k++){var p=this.ya[b].Of(d*e+k);g.setAttribute(c,k,p)}};c.prototype.vu=function(e,g){this.wc();for(var b=g.description,c=0;c<b.Ga;c++)for(var k=b.Sd(c),d=a.ma.Xa(k),
p=0;p<d;p++){var f=g.Yc(k,p);this.setAttribute(k,e,p,f)}};c.prototype.w=function(e,g){if(0>e||e>=this.D())throw a.g.wd();this.wc();this.ya[0].fc(2*e,g)};c.prototype.Ba=function(e){var g=new a.b;this.w(e,g);return g};c.prototype.Nc=function(e,a){this.ya[0].fc(2*e,a)};c.prototype.rb=function(e,g,b){if(0>e||e>=this.qa)throw a.g.wd();this.wc();var n=this.ya[0];void 0!==b?(n.write(2*e,g),n.write(2*e+1,b)):n.fo(2*e,g);this.Dc(1993)};c.prototype.mA=function(e){if(0>e||e>=this.D())throw a.g.wd();this.wc();
var g=this.ya[0],b=new a.pd;b.x=g.read(2*e);b.y=g.read(2*e+1);b.z=this.hasAttribute(1)?this.ya[1].Of(e):a.ma.de(1);return b};c.prototype.CC=function(e,g){if(0>e||e>=this.D())throw a.g.wd();this.Td(1);this.wc();this.Dc(1993);var b=this.ya[0];b.write(2*e,g.x);b.write(2*e+1,g.y);this.ya[1].Dm(e,g.z)};c.prototype.Yc=function(e,g,b){if(0>g||g>=this.qa)throw a.g.wd();var n=a.ma.Xa(e);if(b>=n)throw a.g.wd();this.wc();var c=this.description.mg(e);return 0<=c?this.ya[c].Of(g*n+b):a.ma.de(e)};c.prototype.KG=
function(e,a,b){return this.Yc(e,a,b)};c.prototype.setAttribute=function(e,g,b,c){if(0>g||g>=this.qa)throw a.g.wd();var n=a.ma.Xa(e);if(b>=n)throw a.g.wd();this.Td(e);this.wc();e=this.description.mg(e);this.Dc(1993);this.ya[e].Dm(g*n+b,c)};c.prototype.Pa=function(e){this.Cu();this.Td(e);this.wc();return this.ya[this.description.mg(e)]};c.prototype.Yn=function(e,g){if(null!=g&&a.ma.si(e)!=g.si())throw a.g.F();this.Td(e);e=this.description.mg(e);null==this.ya&&(this.ya=a.Uc.JB(this.description.Ga));
this.ya[e]=g;this.Dc(16777215)};c.prototype.mo=function(e){var g=null;if(null!=this.ya)for(var b=a.ze.vx(e,this.description),g=[],c=0,k=e.Ga;c<k;c++)-1!=b[c]&&(g[c]=this.ya[b[c]]);this.description=e;this.ya=g;this.lh=-1;this.Dc(16777215)};c.prototype.QE=function(e){this.fv(!0);e instanceof a.h?this.R.s(e):this.R.Cp(e)};c.prototype.ZO=function(e){this.fv(!1);e instanceof a.h?this.R.s(e):this.R.Cp(e)};c.prototype.Qn=function(e){this.fv(!0);this.R.copyTo(e)};c.prototype.s=function(e){this.QE(e)};c.prototype.Cp=
function(e){this.QE(e)};c.prototype.ac=function(e){this.ZO(e)};c.prototype.xf=function(e,g){var b=new a.zc;if(this.Hc())return b.Oa(),b;this.fv(!0);return this.R.xf(e,g)};c.prototype.jc=function(){var e=this.description.jc();if(!this.Hc())for(var g=this.D(),b=0,c=this.description.Ga;b<c;b++)e=this.ya[b].zk(e,0,g*a.ma.Xa(this.description.Sd(b)));return e};c.prototype.Eb=function(e){if(e==this)return!0;if(!(e instanceof c&&this.description.Eb(e.description))||this.Hc()!=e.Hc())return!1;if(this.Hc())return!0;
var g=this.D();if(g!=e.D())return!1;for(var b=0;b<this.description.Ga;b++){var k=this.description.qd(b),d=this.Pa(k),p=e.Pa(k);if(!d.Eb(p,0,g*a.ma.Xa(k)))return!1}return!0};c.prototype.copyTo=function(e){if(e.G()!=this.G())throw a.g.F();this.yE(e)};c.prototype.yE=function(e){this.wc();e.description=this.description;e.ya=null;var g=this.description.Ga,b=null;if(null!=this.ya)for(var b=[],c=0;c<g;c++)null!=this.ya[c]&&(b[c]=this.ya[c].Tr(this.D()*a.ma.Xa(this.description.Sd(c))));null!=this.R?(e.R=
this.R.Ka(),this.R.copyTo(e.R)):e.R=null;e.qa=this.qa;e.tn=this.tn;e.ya=b;try{this.iq(e)}catch(B){throw e.Oa(),a.g.UN();}};c.prototype.NE=function(){this.qa=0;this.lh=-1;this.ya=null;this.Dc(16777215)};c.prototype.Dc=function(e){16777215==e&&(this.lh=-1,this.Iy());this.tn|=e;this.EO();this.Ac()};c.prototype.fv=function(e){this.wc();if(this.xk(192))if(null==this.R?this.R=new a.ci(this.description):this.R.Fg(this.description),this.u())this.R.Oa();else{this.Oy(e);for(var g=1;g<this.description.Ga;g++)for(var b=
this.description.Sd(g),c=a.ma.Xa(b),k=this.ya[g],d=0;d<c;d++){var p=new a.zc;p.Oa();for(var f=0;f<this.qa;f++){var h=k.Of(f*c+d);p.Nb(h)}this.R.setInterval(b,d,p)}e&&this.lg(192,!1)}};c.prototype.Oy=function(){this.R.Oa();for(var e=this.ya[0],g=new a.b,b=0;b<this.qa;b++)e.fc(2*b,g),this.R.Nb(g)};c.prototype.uo=function(e){e.Oa();for(var g=this.ya[0],b=new a.b,c=0;c<this.qa;c++)g.fc(2*c,b),e.Nb(b)};c.prototype.$O=function(){if(this.lh<this.qa){null==this.ya&&(this.ya=a.Uc.JB(this.description.Ga));
this.lh=2147483647;for(var e=0;e<this.description.Ga;e++){var g=this.description.Sd(e);if(null!=this.ya[e]){var b=a.ma.Xa(g),c=a.J.truncate(this.ya[e].size/b);c<this.qa&&(c=a.J.truncate(this.lh>this.qa+5?(5*this.qa+3)/4:this.qa),this.ya[e].resize(c*b,a.ma.de(g)));c<this.lh&&(this.lh=c)}else this.ya[e]=a.Uc.qz(g,this.qa),this.lh=this.qa}}this.Py();this.lg(32,!1)};c.prototype.zl=function(e){if(0>e)throw a.g.F();e!=this.qa&&(this.qa=e,this.Dc(65535))};c.prototype.Kk=function(e){if(!this.xk(1)){if(!this.xk(2))return 0;
if(this.PV>=e)return this.xk(8)?1:2}return-1};c.prototype.Zg=function(e,g){this.PV=g;if(-1==e)this.lg(1,!0),this.lg(8,!0);else if(this.lg(1,!1),this.lg(8,!0),0==e)this.lg(2,!1),this.lg(4,!1);else if(1==e)this.lg(2,!0),this.lg(4,!1);else if(2==e)this.lg(2,!0),this.lg(4,!0);else throw a.g.X("internal error.");};c.prototype.EO=function(){null!=this.ob&&(this.ob=null)};c.prototype.EE=function(e,g,b,c){if(0>e||e>=this.qa)throw a.g.X("index out of bounds");if(0>g||g>=this.qa)throw a.g.X("index out of bounds");
this.wc();c.Fg(this.description);c.u()&&c.nq();for(var n=0;n<this.description.Ga;n++)for(var k=this.description.Sd(n),d=0,y=a.ma.Xa(k);d<y;d++){var p=this.ya[n].Of(y*e+d),f=this.ya[n].Of(y*g+d);c.setAttribute(k,d,a.Ub.Xq(p,f,b))}};c.prototype.xs=function(e,a){var g=this.ya[0].f,b=g[2*e]-g[2*a],g=g[2*e+1]-g[2*a+1];return Math.sqrt(b*b+g*g)};c.prototype.Yh=function(e,g){if(0>e||e>=this.qa)throw a.g.wd();if(g.u())throw a.g.F();this.wc();for(var b=g.description,c=0;c<b.Ga;c++)for(var k=b.qd(c),d=a.ma.Xa(k),
p=0;p<d;p++){var f=g.Yc(k,p);this.setAttribute(k,e,p,f)}};c.prototype.Xu=function(){return null};c.prototype.Hj=function(){return null};return c}(a.T);a.Mu=b})(x||(x={}));(function(a){var b=function(){function b(){this.pb=this.Oo=null;this.Gn=124234251;this.Dw=!0;this.qf=-1;this.pb=new a.ad(7);this.Oo=null}b.prototype.Ep=function(a){this.Oo=a};b.prototype.PR=function(){this.Dw=!1};b.prototype.Qe=function(a){this.pb.Qe(a)};b.prototype.Ks=function(a){var e=this.pb.Pe();this.nY(e);this.qY(a,e);return e};
b.prototype.JR=function(a){this.pb.kd(a)};b.prototype.addElement=function(a,e){var g;-1==e?(-1==this.qf&&(this.qf=this.Ks(-1)),g=this.qf):g=e;return this.XE(a,0,g)};b.prototype.aF=function(a){-1==this.qf&&(this.qf=this.Ks(-1));return this.XE(a,1,this.qf)};b.prototype.ro=function(a){var e;-1==this.qf&&(this.qf=this.Ks(-1));e=this.qf;var g=this.pb.f;if(-1==e||-1==g[7*e])return a=this.pb.ml([-1,-1,-1,a,this.Ll(),-1,-1]),g=this.pb.f,g[7*e]=a,this.pq(-1,a,e,g),a;var b=-1==e?-1:g[7*e+2];a=this.pb.ml([-1,
-1,b,a,this.Ll(),-1,-1]);g=this.pb.f;g[7*b+1]=a;this.Vy(a,g);-1===g[7*a+2]&&(g[7*e]=a);this.pq(-1,a,e,g);return a};b.prototype.jv=function(b,e,g,c){var n=-1;-1==n&&(-1==this.qf&&(this.qf=this.Ks(-1)),n=this.qf);var k=this.pb.f;if(-1==n||-1==k[7*n])return g=this.pb.ml([-1,-1,-1,g,this.Ll(),-1,-1]),k=this.pb.f,k[7*n]=g,this.pq(-1,g,n,k),g;var d;c?(c=-1!=e?this.Oo.compare(this,g,e):-1,d=-1!=b?this.Oo.compare(this,g,b):1):(c=-1,d=1);if(0==c||0==d)return k[7*n+3]=0==c?e:b,-1;(-1!=e&&-1!=b?this.Gn>a.J.IB(this.Gn)>>
1:-1!=e)?b=e:c=d;for(e=!0;;){if(0>c)if(d=k[7*b],-1!=d)b=d;else{c=b;g=this.pb.ml([-1,-1,b,g,this.Ll(),-1,-1]);k=this.pb.f;k[7*b]=g;break}else if(d=k[7*b+1],-1!=d)b=d;else{c=k[7*b+6];g=this.pb.ml([-1,-1,b,g,this.Ll(),-1,-1]);k=this.pb.f;k[7*b+1]=g;break}e&&(c*=-1,e=!1)}this.Vy(g,k);-1===k[7*g+2]&&(k[7*n]=g);this.pq(c,g,n,k);return g};b.prototype.QG=function(){return this.aT(this.qf)};b.prototype.Kd=function(a,e){e=-1==e?this.qf:e;this.Dw?this.IR(a,e):this.gZ(a,e)};b.prototype.search=function(a,e){for(e=
this.fw(e);-1!=e;){var g=this.Oo.compare(this,a,e);if(0==g)return e;e=0>g?this.Pl(e):this.Nq(e)}return-1};b.prototype.IX=function(a){for(var e=this.fw(-1),g=-1;-1!=e;){var b=a.compare(this,e);if(0==b)return e;0>b?e=this.Pl(e):(g=e,e=this.Nq(e))}return g};b.prototype.lK=function(a){for(var e=this.fw(-1),g=-1;-1!=e;){var b=a.compare(this,e);if(0==b)return e;0>b?(g=e,e=this.Pl(e)):e=this.Nq(e)}return g};b.prototype.ja=function(a){return this.pb.S(a,3)};b.prototype.Pl=function(a){return this.pb.S(a,0)};
b.prototype.Nq=function(a){return this.pb.S(a,1)};b.prototype.getParent=function(a){return this.pb.S(a,2)};b.prototype.nb=function(a){return this.pb.S(a,6)};b.prototype.Ve=function(a){return this.pb.S(a,5)};b.prototype.xc=function(a){return-1==a?this.Ol(this.qf):this.Ol(a)};b.prototype.Fc=function(a){return-1==a?this.Zs(this.qf):this.Zs(a)};b.prototype.TT=function(a){return-1==a?this.nH(this.qf):this.nH(a)};b.prototype.kk=function(a,e){this.oC(a,e)};b.prototype.fw=function(a){return-1==a?this.iH(this.qf):
this.iH(a)};b.prototype.clear=function(){this.pb.Vi(!1);this.qf=-1};b.prototype.size=function(a){return-1==a?this.kH(this.qf):this.kH(a)};b.prototype.PP=function(a,e){for(var g=e[7*a],b=e[7*a+1],c=e[7*a+4];-1!=g||-1!=b;){var k=-1!=g?e[7*g+4]:2147483647,b=-1!=b?e[7*b+4]:2147483647;if(c<=Math.min(k,b))break;k<=b?this.iK(g,e):this.hK(a,e);g=e[7*a];b=e[7*a+1]}};b.prototype.Vy=function(a,e){if(this.Dw)for(var g=e[7*a+4],b=e[7*a+2];-1!=b&&e[7*b+4]>g;)e[7*b]==a?this.iK(a,e):this.hK(b,e),b=e[7*a+2]};b.prototype.hK=
function(a,e){var g=e[7*a+1],b;e[7*g+2]=e[7*a+2];e[7*a+2]=g;b=e[7*g];e[7*a+1]=b;-1!=b&&(e[7*b+2]=a);e[7*g]=a;b=e[7*g+2];-1!=b&&(e[7*b]==a?e[7*b]=g:e[7*b+1]=g)};b.prototype.iK=function(a,e){var g=e[7*a+2],b;e[7*a+2]=e[7*g+2];e[7*g+2]=a;b=e[7*a+1];e[7*g]=b;-1!=b&&(e[7*b+2]=g);e[7*a+1]=g;b=e[7*a+2];-1!=b&&(e[7*b]===g?e[7*b]=a:e[7*b+1]=a)};b.prototype.rl=function(a,e){this.pb.P(a,2,e)};b.prototype.sC=function(a,e){this.pb.P(a,0,e)};b.prototype.wC=function(a,e){this.pb.P(a,1,e)};b.prototype.vC=function(a,
e){this.pb.P(a,5,e)};b.prototype.Qx=function(a,e){this.pb.P(a,6,e)};b.prototype.OK=function(a,e){this.pb.P(e,0,a)};b.prototype.nY=function(a){this.pb.P(a,4,0)};b.prototype.qY=function(a,e){this.pb.P(e,5,a)};b.prototype.iH=function(a){return-1==a?-1:this.pb.S(a,0)};b.prototype.Ol=function(a){return-1==a?-1:this.pb.S(a,1)};b.prototype.Zs=function(a){return-1==a?-1:this.pb.S(a,2)};b.prototype.aT=function(a){return-1==a?-1:this.pb.S(a,3)};b.prototype.kH=function(a){return-1==a?0:this.pb.S(a,4)};b.prototype.nH=
function(a){return this.pb.S(a,5)};b.prototype.Bx=function(a){return this.pb.ml([-1,-1,-1,a,this.Ll(),-1,-1])};b.prototype.Kl=function(a){-1!=a&&this.pb.kd(a)};b.prototype.Ll=function(){this.Gn=a.J.IB(this.Gn);return this.Gn&1073741823};b.prototype.XE=function(a,e,g){var b=this.pb.f;if(-1==g||-1==b[7*g])return a=this.pb.ml([-1,-1,-1,a,this.Ll(),-1,-1]),b=this.pb.f,b[7*g]=a,this.pq(-1,a,g,b),a;for(var c=-1==g?-1:b[7*g];;){var k=-1==e?1:this.Oo.compare(this,a,c);if(0>k)if(k=this.Pl(c),-1!=k)c=k;else{e=
c;a=this.pb.ml([-1,-1,c,a,this.Ll(),-1,-1]);b=this.pb.f;b[7*c]=a;break}else{if(1==e&&0==k)return b[7*g+3]=c,-1;k=b[7*c+1];if(-1!=k)c=k;else{e=b[7*c+6];a=this.pb.ml([-1,-1,c,a,this.Ll(),-1,-1]);b=this.pb.f;b[7*c+1]=a;break}}}this.Vy(a,b);-1===b[7*a+2]&&(b[7*g]=a);this.pq(e,a,g,b);return a};b.prototype.pq=function(a,e,g,b){var c;-1!=a?(c=b[7*a+5],b[7*a+5]=e):c=-1==g?-1:b[7*g+2];b[7*e+5]=c;-1!=c&&(b[7*c+6]=e);b[7*e+6]=a;a==(-1==g?-1:b[7*g+1])&&(b[7*g+1]=e);-1==a&&(b[7*g+2]=e);b[7*g+4]=(-1==g?0:b[7*g+
4])+1};b.prototype.aC=function(a,e){var g=this.pb.f,b=g[7*a+5];a=g[7*a+6];-1!=b?g[7*b+6]=a:g[7*e+1]=a;-1!=a?g[7*a+5]=b:g[7*e+2]=b;g[7*e+4]=-1===e?-1:g[7*e+4]-1};b.prototype.gZ=function(b,e){this.aC(b,e);var g=this.Pl(b),c=this.Nq(b),k=this.getParent(b),d=b;if(-1!=g&&-1!=c){this.Gn=a.J.IB(this.Gn);var p;p=1073741823<this.Gn?this.nb(b):this.Ve(b);var f=this.getParent(p)==b;this.pb.ay(b,p,0);this.pb.ay(b,p,1);this.pb.ay(b,p,2);-1!=k?this.Pl(k)==b?this.sC(k,p):this.wC(k,p):this.OK(p,e);f?(g==p?(this.sC(p,
b),this.rl(c,p)):c==p&&(this.wC(p,b),this.rl(g,p)),this.rl(b,p),k=p):(this.rl(g,p),this.rl(c,p),k=this.getParent(b),d=p);g=this.Pl(b);c=this.Nq(b);-1!=g&&this.rl(g,b);-1!=c&&this.rl(c,b)}g=-1!=g?g:c;-1==k?this.OK(g,e):this.Pl(k)==d?this.sC(k,g):this.wC(k,g);-1!=g&&this.rl(g,k);this.Kl(b,e)};b.prototype.IR=function(a,e){var g=this.pb.f;g[7*a+4]=2147483647;var b=-1,c=-1,k=-1===e?-1:g[7*e],d=k==a;d&&(b=g[7*k],c=g[7*k+1],-1==b&&-1==c)?(this.aC(k,e),this.Kl(k,e),g[7*e]=-1):(this.PP(a,g),k=g[7*a+2],-1!=
k&&(g[7*k]==a?g[7*k]=-1:g[7*k+1]=-1),this.aC(a,e),this.Kl(a,e),d&&(g[7*e]=-1==b||-1!=g[7*b+2]?c:b))};b.prototype.oC=function(a,e){this.pb.P(a,3,e)};return b}();a.uk=b})(x||(x={}));(function(a){var b=function(){function b(a,e){void 0!==a&&this.I(a,e)}b.prototype.I=function(a,e){this.ca=a;this.ha=e;this.normalize()};b.prototype.Yb=function(a){return this.ca<=a.ca?this.ha>=a.ca:a.ha>=this.ca};b.prototype.move=function(a){this.u()||(this.ca+=a,this.ha+=a)};b.prototype.normalize=function(){if(!isNaN(this.ca)){if(this.ca>
this.ha){var a=this.ca;this.ca=this.ha;this.ha=a}isNaN(this.ha)&&this.Oa()}};b.prototype.Oa=function(){this.ha=this.ca=NaN};b.prototype.u=function(){return isNaN(this.ca)};b.prototype.Nb=function(a){"number"===typeof a?this.u()?this.ha=this.ca=a:this.ll(a):a.u()||(this.u()?(this.ca=a.ca,this.ha=a.ha):(this.ca>a.ca&&(this.ca=a.ca),this.ha<a.ha&&(this.ha=a.ha),this.ca>this.ha&&this.Oa()))};b.prototype.ll=function(a){a<this.ca?this.ca=a:a>this.ha&&(this.ha=a)};b.prototype.contains=function(a){return"number"===
typeof a?a>=this.ca&&a<=this.ha:a.ca>=this.ca&&a.ha<=this.ha};b.prototype.Ma=function(a){this.u()||a.u()?this.Oa():(this.ca<a.ca&&(this.ca=a.ca),this.ha>a.ha&&(this.ha=a.ha),this.ca>this.ha&&this.Oa())};b.prototype.O=function(a){this.u()||(this.ca-=a,this.ha+=a,this.ha<this.ca&&this.Oa())};b.prototype.no=function(){return this.u()?2.220446049250313E-14:2.220446049250313E-14*(Math.abs(this.ca)+Math.abs(this.ha)+1)};b.prototype.lC=function(a,e){a>e?(this.ca=e,this.ha=a):(this.ca=a,this.ha=e)};b.prototype.wu=
function(b){return a.J.pk(b,this.ca,this.ha)};b.prototype.N=function(){return this.ha-this.ca};b.prototype.Wf=function(){return.5*(this.ca+this.ha)};b.prototype.Eb=function(a){return a==this?!0:a instanceof b?this.u()&&a.u()?!0:this.ca!=a.ca||this.ha!=a.ha?!1:!0:!1};b.prototype.jc=function(){return a.J.Zi(a.J.Zi())};return b}();a.zc=b})(x||(x={}));(function(a){var b=new a.zc,c=new a.zc,k=function(){return function(){this.Le=null;this.qb=-1;this.wb=new a.Hb;this.ZA=55555555;this.Fw=this.Iw=!1;this.rg=
new a.zc;this.rg.lC(0,0)}}();a.k_=k;var e=function(){function e(e,g,b){this.a=e;this.hl=NaN;this.aJ=this.Ar=0;this.bJ=NaN;this.ta=g;this.Dr=10*g;this.cJ=this.dJ=NaN;this.Ng=!1;this.rn=this.Yt=this.vp=this.St=this.Rt=-1;this.QA=b;this.AB=new k;this.kJ=new k;a.J.truncate(3*e.vd/2)}e.prototype.AH=function(e,a,g,b){e.Le=null===b?null:b[g[5*a]];e.Fw=null!=e.Le;e.Fw||(b=g[5*a+2],-1!==b&&this.a.hX(g[5*a],g[5*b],e.wb),e.Le=e.wb,e.rg.lC(e.wb.ua,e.wb.sa),e.rg.ha+=this.ta,e.wb.BJ(),e.Iw=e.wb.oa==e.wb.ra,e.Iw||
(e.ZA=(e.wb.sa-e.wb.ua)/(e.wb.oa-e.wb.ra)))};e.prototype.SQ=function(e,a){var g=e.ys(a,this.ta,!0);if(0!=g)return 2==g?this.Az():this.Wi();e.Oq(O);e.Ps(P);a.Oq(S);a.Ps(R);N.ka(this.Ar,this.hl);O.ub(S)&&this.hl==O.y?0>P.compare(R)?N.L(P):N.L(R):O.ub(R)&&this.hl==O.y?0>P.compare(S)?N.L(P):N.L(S):S.ub(P)&&this.hl==S.y?0>O.compare(R)?N.L(O):N.L(R):P.ub(R)&&this.hl==P.y&&(0>O.compare(S)?N.L(O):N.L(S));return e.pf(N.y,N.x)<a.pf(N.y,N.x)?-1:1};e.prototype.QQ=function(e,a){if(e.wb.ra==a.wb.ra&&e.wb.ua==a.wb.ua)return e.wb.oa==
a.wb.oa&&e.wb.sa==a.wb.sa?this.QA?this.Az():0:this.WF(e,a);if(e.wb.oa==a.wb.oa&&e.wb.sa==a.wb.sa)return this.VF(e,a);var g=this.VF(e,a);e=this.WF(e,a);return 0>g&&0>e?-1:0<g&&0<e?1:this.Wi()};e.prototype.MQ=function(e,a){if(e.sa>a.sa){if(a.sa>a.ua&&a.oa-a.ra<2*this.ta&&e.Si(a.sa,a.oa,this.ta))return this.Wi()}else if((a.oa-a.ra)/(a.sa-a.ua)*(e.sa-e.ua)<this.Dr&&a.Si(e.sa,e.oa,this.ta))return this.Wi();return 1};e.prototype.NQ=function(e,a){if(e.ua<a.ua){if(a.sa>a.ua&&a.oa-a.ra<2*this.ta&&e.Si(a.sa,
a.oa,this.ta))return this.Wi()}else if((a.oa-a.ra)/(a.sa-a.ua)*(e.ua-e.sa)<this.Dr&&a.Si(e.ua,e.ra,this.ta))return this.Wi();return-1};e.prototype.OQ=function(e,g){var b=new a.b;b.yc(g.Bc(),g.ec());b.Ur();b.normalize();var c=new a.b;c.yc(e.ec(),g.ec());var n=new a.b;n.yc(e.Bc(),g.ec());var c=c.oi(b),b=n.oi(b),n=Math.abs(c),k=Math.abs(b);if(n<k){if(n<this.Dr&&g.Si(e.ua,e.ra,this.ta))return this.Wi()}else if(k<this.Dr&&g.Si(e.sa,e.oa,this.ta))return this.Wi();return 0>c&&0>b?-1:0<c&&0<b?1:this.Wi()};
e.prototype.UF=function(e,a){return e.ra==a.ra&&e.ua==a.ua?this.MQ(e,a):e.oa==a.oa&&e.sa==a.sa?this.NQ(e,a):this.OQ(e,a)};e.prototype.PQ=function(e,a){return e.oa==a.oa&&e.sa==a.sa&&e.ra==a.ra&&e.ua==a.ua?this.QA?this.Az():0:this.Wi()};e.prototype.VF=function(e,a){var g=1;if(e.wb.ra<a.wb.ra){var g=-1,b=e;e=a;a=b}b=e.wb;e=a.wb;var c=b.ua-e.ua;a=a.ZA*(b.ra-e.ra);var n=this.Dr;return c<a-n?-g:c>a+n?g:e.Si(b.ua,b.ra,this.ta)?this.Wi():c<a?-g:g};e.prototype.WF=function(e,a){var g=1;if(a.wb.oa<e.wb.oa){var g=
-1,b=e;e=a;a=b}b=e.wb;e=a.wb;var c=b.sa-e.ua;a=a.ZA*(b.oa-e.ra);var n=this.Dr;return c<a-n?-g:c>a+n?g:e.Si(b.sa,b.oa,this.ta)?this.Wi():c<a?-g:g};e.prototype.Az=function(){this.Ng=!0;this.mj=new a.$d(5,this.vp,this.Yt);return-1};e.prototype.Wi=function(){this.Ng=!0;this.QA?this.mj=new a.$d(4,this.vp,this.Yt):this.Yt=this.vp=this.St=this.Rt=-1;return-1};e.prototype.RQ=function(e,a,g,k){if(this.Ng)return-1;var n=this.bJ==this.hl&&this.aJ==this.Ar,d;n&&e==this.Rt?d=this.cJ:(d=NaN,this.Rt=-1);n&&a==this.St?
n=this.dJ:(n=NaN,this.St=-1);g.Le.SJ(b);k.Le.SJ(c);if(b.ha<c.ca)return-1;if(c.ha<b.ca)return 1;this.bJ=this.hl;this.aJ=this.Ar;isNaN(d)&&(this.Rt=e,this.cJ=d=e=g.Le.pf(this.hl,this.Ar));isNaN(n)&&(this.St=a,this.dJ=n=e=k.Le.pf(this.hl,this.Ar));return Math.abs(d-n)<=this.ta?this.SQ(g.Le,k.Le):d<n?-1:d>n?1:0};e.prototype.Gs=function(){this.Ng=!1};e.prototype.en=function(){return this.mj};e.prototype.QK=function(e,a){this.hl=e;this.Ar=a;this.Yt=this.vp=this.St=this.Rt=-1};e.prototype.compare=function(e,
a,g){if(this.Ng)return-1;e=e.ja(g);this.rn=g;return this.YF(a,a,e,e)};e.prototype.YF=function(e,a,g,b){var c;this.vp==a?c=this.AB:(this.vp=a,c=this.AB,this.AB.qb=e,this.AH(c,a,this.a.Dd.f,this.a.wf));var n;null==n&&(this.Yt=b,n=this.kJ,this.kJ.qb=g,this.AH(n,b,this.a.Dd.f,this.a.wf));if(c.Fw||n.Fw)return this.RQ(a,b,c,n);if(c.rg.ha<n.rg.ca)return-1;if(n.rg.ha<c.rg.ca)return 1;e=c.Iw?1:0;e|=n.Iw?2:0;return 0==e?this.QQ(c,n):1==e?this.UF(c.wb,n.wb):2==e?-1*this.UF(n.wb,c.wb):this.PQ(c.wb,n.wb)};return e}();
a.gE=e})(x||(x={}));(function(a){var b=function(){function b(b,e){this.a=b;this.ta=e;this.Ng=!1;this.vp=-1;this.rg=new a.zc;this.wr=new a.b;this.wr.$c();this.Fe=new a.Hb;this.rn=-1;this.iB=1.7976931348623157E308}b.prototype.Gs=function(){this.Ng=!1;this.iB=1.7976931348623157E308};b.prototype.Yh=function(a){this.wr.L(a)};b.prototype.compare=function(a,e){return this.ZF(e,a.ja(e))};b.prototype.ZF=function(b,e){var g=null!=this.a.ic(e);g||(this.a.od(e,this.Fe),this.rg.lC(this.Fe.ua,this.Fe.sa));if(g)throw a.g.X("not implemented");
if(this.wr.x+this.ta<this.rg.ca)return-1;if(this.wr.x-this.ta>this.rg.ha)return 1;if(this.Fe.ra==this.Fe.oa)return this.rn=b,this.Ng=!0,0;this.Fe.BJ();e=this.Fe.ec();g=new a.b;g.yc(this.Fe.Bc(),e);g.Ur();var c=new a.b;c.yc(this.wr,e);e=g.oi(c);e/=g.length();return e<10*-this.ta?-1:e>10*this.ta?1:this.Fe.mt(this.wr,this.ta)&&(g=Math.abs(e),g<this.iB&&(this.rn=b,this.iB=g),this.Ng=!0,g<.25*this.ta)?0:0>e?-1:1};return b}();a.bO=b})(x||(x={}));(function(a){function b(a,e,g,b){g=new Float64Array(a.subarray(g,
b));a.set(g,e)}var c=function(){function b(e){this.xa=this.Ce=!1;this.f=[];var g=e;2>g&&(g=2);this.f=a.J.gf(g,b.Bb);this.size=e}b.prototype.rotate=function(e,g,b){if(this.xa)throw a.g.X("invalid_call");if(g<e||g>b||e>b)throw a.g.F();e!=g&&b!=g&&(this.Zd(e,g-e,1),this.Zd(g,b-g,1),this.Zd(e,b-e,1))};b.zd=function(e,a){b.Bb=a;e=new b(e);b.Bb=0;return e};b.Ak=function(e){var a=new b(0);a.f=e.f.slice(0);a.size=e.size;return a};b.$=function(e,a){var g=new b(0);g.size=e.size;g.size>a&&(g.size=a);g.f=e.f.slice(0,
g.size);return g};b.prototype.yb=function(){};b.prototype.read=function(e){return this.f[e]};b.prototype.fc=function(e,a){a.x=this.f[e];a.y=this.f[e+1]};b.prototype.pX=function(e,a){a.x=this.f[e];a.y=this.f[e+1]};b.prototype.get=function(e){return this.f[e]};b.prototype.write=function(e,g){if(this.xa)throw a.g.Da();this.f[e]=g};b.prototype.set=function(e,g){if(this.xa)throw a.g.Da();this.f[e]=g};b.prototype.fo=function(e,g){if(this.xa)throw a.g.Da();this.f[e]=g.x;this.f[e+1]=g.y};b.prototype.add=
function(e){this.resize(this.size+1);this.f[this.size-1]=e};b.prototype.Tr=function(e){return b.$(this,e)};b.prototype.Of=function(e){return this.read(e)};b.prototype.resize=function(e,g){void 0===g&&(g=0);if(this.Ce)throw a.g.X("invalid call. Attribute Stream is locked and cannot be resized.");if(e<=this.size){if(a.J.truncate(5*e/4)<this.f.length){var b=this.f.slice(0,e);this.f=b}}else if(e>this.f.length){a.J.truncate(64>e?Math.max(2*e,4):5*e/4);for(var b=this.f.slice(0),c=this.f.length;c<e;c++)b[c]=
g;this.f=b}this.size=e};b.prototype.yf=function(e){(null==this.f||e>this.f.length)&&this.resize(e);if(this.Ce)throw a.g.X("invalid call. Attribute Stream is locked and cannot be resized.");this.size=e};b.prototype.Dm=function(e,a){this.write(e,a)};b.prototype.zk=function(e,g,b){for(var c=this.size;g<c&&g<b;g++)e=a.J.Zi(this.read(g));return e};b.prototype.Eb=function(e,a,c){if(null==e||!(e instanceof b))return!1;var g=this.size,n=e.size;if(c>g||c>n&&g!=n)return!1;for(c>g&&(c=g);a<c;a++)if(this.read(a)!=
e.read(a))return!1;return!0};b.prototype.Sq=function(e,g,b,c,k,d){if(this.xa)throw a.g.Da();0>d&&(d=this.size);this.size+2*c>this.f.length?this.resize(this.size+2*c):this.size+=2*c;d-=e;for(var n=this.f.slice(e,e+d),y=0;y<d;y++)this.f[e+2*c+y]=n[y];if(k)for(k=0;k<c;k++)d=g[b++],this.f[e++]=d.x,this.f[e++]=d.y;else for(k=0,n=c-1;k<c;++k)d=g[b+n],this.f[e++]=d.x,this.f[e++]=d.y,n--};b.prototype.Qk=function(e,g,b,c,k,d,p){if(this.xa)throw a.g.Da();if(!k&&(1>d||0!=c%d))throw a.g.F();var n=this.size-p;
n<c&&this.resize(this.size+c-n);for(n=0;n<p-e;n++)this.f[e+c+n]=this.f[e+n];this.f==g.f&&e<b&&(b+=c);if(k)for(n=0;n<c;n++)this.f[n+e]=g.f[b+n];else for(k=c,p=0;p<c;p+=d)for(k-=d,n=0;n<d;n++)this.f[e+p+n]=g.f[b+k+n]};b.prototype.Vj=function(e,g,b,c){if(this.xa)throw a.g.Da();c-=e;for(var n=this.f.slice(e,e+c),k=0;k<c;k++)this.f[e+b+k]=n[k];for(c=0;c<b;c++)this.f[e+c]=g};b.prototype.eh=function(e,g,b){if(this.xa)throw a.g.Da();for(var c=this.f.slice(e,e+(b-e)),n=0;n<b-e;n++)this.f[n+e+2]=c[n];this.f[e]=
g.x;this.f[e+1]=g.y};b.prototype.js=function(e,g,b,c,k){if(0>e||0>g||0>c)throw a.g.F();if(b.length<c+g)throw a.g.F();if(0!=g)if(this.size<g+e&&this.resize(g+e),k)for(k=0;k<g;k++)this.f[e+k]=b[c+k];else for(k||(e+=g-1),g=c+g;c<g;c++)this.f[e]=b[c],e--};b.prototype.ho=function(e,g,b,c,k,d){if(0>e||0>g||0>c)throw a.g.F();if(!k&&(0>=d||0!=g%d))throw a.g.F();if(b.size<c+g)throw a.g.F();if(0!=g)if(this.size<g+e&&this.resize(g+e),b==this)this.Ij(e,g,c,k,d);else if(k)for(k=0;k<g;k++)this.f[e]=b.f[c],e++,
c++;else if(c=c+g-d,1==d)for(k=0;k<g;k++)this.f[e]=b.f[c],e++,c--;else for(k=0,g=a.J.truncate(g/d);k<g;k++){for(var n=0;n<d;n++)this.f[e+n]=b.f[c+n];e+=d;c-=d}};b.prototype.Ek=function(e,g,b){if(this.xa)throw a.g.Da();if(e+g>this.size)throw a.g.Da();if(0<b-(e+g)){b-=e+g;for(var c=this.f.slice(e+g,e+b+g),n=0;n<b;n++)this.f[e+n]=c[n]}this.size-=g};b.prototype.Zd=function(e,g,b){if(this.xa)throw a.g.Da();if(1>b||0!=g%b)throw a.g.Da();for(var c=g>>1,n=0;n<c;n+=b){g-=b;for(var k=0;k<b;k++){var d=this.f[e+
n+k];this.f[e+n+k]=this.f[e+g+k];this.f[e+g+k]=d}}};b.prototype.Zh=function(e,g,b){if(0>g||0>b||0>g||b+g>this.size)throw a.g.F();for(var c=g;c<g+b;c++)this.f[c]=e};b.prototype.Ij=function(e,g,b,c,k){if(!c||e!=b){for(var n=0;n<g;n++)this.f[e+n]=this.f[b+n];if(!c)for(b=e,e=e+g-k,c=0,g=a.J.truncate(g/2);c<g;c++){for(n=0;n<k;n++){var d=this.f[b+n];this.f[b+n]=this.f[e+n];this.f[e+n]=d}b+=k;e-=k}}};b.prototype.ks=function(e,g,b,c,k){if(0>e||0>g||0>c)throw a.g.F();if(0!=g)for(this.size<(g<<1)+e&&this.resize((g<<
1)+e),k||(e+=g-1<<1),k=k?2:-2,g+=c;c<g;c++)this.f[e]=b[c].x,this.f[e+1]=b[c].y,e+=k};b.prototype.hy=function(e,g,b,c,k){if(0>e||0>g||0>c)throw a.g.F();if(0!=g)for(this.size<(g<<1)+e&&this.resize((g<<1)+e),k||(e+=g-1<<1),k=k?2:-2,g+=c;c<g;c++)this.f[e]=b[c][0],this.f[e+1]=b[c][1],e+=k};b.prototype.ol=function(e,g,b,c,k){if(0>e||0>g||0>c||this.size<g+e)throw a.g.F();if(k)for(k=0;k<g;k++)b[c+k]=this.f[e+k];else for(c=c+g-1;e<g;e++)b[c]=this.f[e],c--};b.prototype.Hx=function(e,g,b,c,k){if(0>e||0>g||0>
c||this.size<(g>>1)+e)throw a.g.F();if(0!=g)for(k||(e+=g-1),k=k?2:-2,g=c+g;c<g;c++)b[c][0]=this.f[e],b[c][1]=this.f[e+1],e+=k};b.prototype.clear=function(e){e?this.resize(0):this.yf(0)};b.prototype.Mp=function(){this.Ce=this.xa=!0};b.prototype.Gd=function(e,a,b){var g=this.f.slice(0,e),c=this.f.slice(a);e=this.f.slice(e,a).sort(b);this.f.length=0;this.f.push.apply(this.f,g.concat(e).concat(c))};b.prototype.si=function(){return 1};b.Bb=0;return b}();a.Qd=c;c=function(){function c(e){this.xa=this.Ce=
!1;this.f=null;var a=e;2>a&&(a=2);this.f=new Float64Array(a);this.size=e}c.prototype.rotate=function(e,g,b){if(this.xa)throw a.g.X("invalid_call");if(g<e||g>b||e>b)throw a.g.F();e!=g&&b!=g&&(this.Zd(e,g-e,1),this.Zd(g,b-g,1),this.Zd(e,b-e,1))};c.zd=function(e,a){var g=new c(e),b=g.f;2>e&&(e=2);if(0!==a)for(var k=0;k<e;k++)b[k]=a;return g};c.Ak=function(e){var a=new c(0);a.f=new Float64Array(e.f);a.size=e.size;return a};c.$=function(e,a){var g=new c(0);g.size=e.size;g.size>a&&(g.size=a);a=g.size;2>
a&&(a=2);g.f=new Float64Array(a);g.f.set(e.f.length<=a?e.f:e.f.subarray(0,a),0);return g};c.prototype.yb=function(e){0>=e||(null==this.f?this.f=new Float64Array(e):e<=this.f.length||(0<this.f.length?(e=new Float64Array(e),e.set(this.f),this.f=e):this.f=new Float64Array(e)))};c.prototype.read=function(e){return this.f[e]};c.prototype.fc=function(e,a){a.x=this.f[e];a.y=this.f[e+1]};c.prototype.get=function(e){return this.f[e]};c.prototype.write=function(e,g){if(this.xa)throw a.g.Da();this.f[e]=g};c.prototype.set=
function(e,g){if(this.xa)throw a.g.Da();this.f[e]=g};c.prototype.fo=function(e,g){if(this.xa)throw a.g.Da();this.f[e]=g.x;this.f[e+1]=g.y};c.prototype.add=function(e){this.resize(this.size+1);this.f[this.size-1]=e};c.prototype.Tr=function(e){return c.$(this,e)};c.prototype.Of=function(e){return this.read(e)};c.prototype.resize=function(e,g){void 0===g&&(g=0);if(this.Ce)throw a.g.X("invalid call. Attribute Stream is locked and cannot be resized.");if(e<=this.size){if(30<this.f.length&&5*e/4<this.f.length){var b=
new Float64Array(this.f,0,e);this.f=b}}else{e>this.f.length&&(b=a.J.truncate(64>e?Math.max(2*e,4):5*e/4),b=new Float64Array(b),b.set(this.f),this.f=b);for(var b=this.f,c=this.size;c<e;c++)b[c]=g}this.size=e};c.prototype.yf=function(e){(null==this.f||e>this.f.length)&&this.resize(e);if(this.Ce)throw a.g.X("invalid call. Attribute Stream is locked and cannot be resized.");this.size=e};c.prototype.Dm=function(e,a){this.write(e,a)};c.prototype.zk=function(e,g,b){for(var c=this.size;g<c&&g<b;g++)e=a.J.Zi(this.read(g));
return e};c.prototype.Eb=function(e,a,b){if(null==e||!(e instanceof c))return!1;var g=this.size,n=e.size;if(b>g||b>n&&g!=n)return!1;for(b>g&&(b=g);a<b;a++)if(this.read(a)!=e.read(a))return!1;return!0};c.prototype.Qk=function(e,g,c,k,d,p,f){if(this.xa)throw a.g.Da();if(!d&&(1>p||0!=k%p))throw a.g.F();var n=this.size-f;n<k&&this.resize(this.size+k-n);b(this.f,e+k,e,e+(f-e));this.f==g.f&&e<c&&(c+=k);if(d)this.f.set(g.f.subarray(c,c+k),e);else for(d=k,f=0;f<k;f+=p)for(d-=p,n=0;n<p;n++)this.f[e+f+n]=g.f[c+
d+n]};c.prototype.Sq=function(e,g,c,k,d,p){if(this.xa)throw a.g.Da();0>p&&(p=this.size);this.size+2*k>this.f.length?this.resize(this.size+2*k):this.size+=2*k;b(this.f,e+2*k,e,e+(p-e));if(d)for(d=0;d<k;d++)p=g[c++],this.f[e++]=p.x,this.f[e++]=p.y;else{d=0;for(var n=k-1;d<k;++d)p=g[c+n],this.f[e++]=p.x,this.f[e++]=p.y,n--}};c.prototype.Vj=function(e,g,c,k){if(this.xa)throw a.g.Da();k-=e;b(this.f,e+k,e,e+k);for(k=0;k<c;k++)this.f[e+k]=g};c.prototype.eh=function(e,g,c){if(this.xa)throw a.g.Da();b(this.f,
e+2,e,e+(c-e));this.f[e]=g.x;this.f[e+1]=g.y};c.prototype.js=function(e,g,b,c,k){if(0>e||0>g||0>c)throw a.g.F();if(b.length<c+g)throw a.g.F();if(0!=g)if(this.size<g+e&&this.resize(g+e),k)this.f.set(b.subarray(c,g),e);else for(k||(e+=g-1),g=c+g;c<g;c++)this.f[e]=b[c],e--};c.prototype.ho=function(e,g,b,c,k,d){if(0>e||0>g||0>c)throw a.g.F();if(!k&&(0>=d||0!=g%d))throw a.g.F();if(b.size<c+g)throw a.g.F();if(0!=g)if(this.size<g+e&&this.resize(g+e),b==this)this.Ij(e,g,c,k,d);else if(k)for(k=0;k<g;k++)this.f[e]=
b.f[c],e++,c++;else if(c=c+g-d,1==d)for(k=0;k<g;k++)this.f[e]=b.f[c],e++,c--;else for(k=0,g=a.J.truncate(g/d);k<g;k++){for(var n=0;n<d;n++)this.f[e+n]=b.f[c+n];e+=d;c-=d}};c.prototype.Ek=function(e,g,c){if(this.xa)throw a.g.Da();if(e+g>this.size)throw a.g.Da();0<c-(e+g)&&b(this.f,e,e+g,e+(c-(e+g))+g);this.size-=g};c.prototype.Zd=function(e,g,b){if(this.xa)throw a.g.Da();if(1>b||0!=g%b)throw a.g.Da();for(var c=g>>1,n=0;n<c;n+=b){g-=b;for(var k=0;k<b;k++){var d=this.f[e+n+k];this.f[e+n+k]=this.f[e+
g+k];this.f[e+g+k]=d}}};c.prototype.Zh=function(e,g,b){if(0>g||0>b||0>g||b+g>this.size)throw a.g.F();for(var c=g;c<g+b;c++)this.f[c]=e};c.prototype.Ij=function(e,g,b,c,k){if(!c||e!=b)if(this.f.set(this.f.subarray(b,b+g),e),!c)for(b=e,e=e+g-k,c=0,g=a.J.truncate(g/2);c<g;c++){for(var n=0;n<k;n++){var d=this.f[b+n];this.f[b+n]=this.f[e+n];this.f[e+n]=d}b+=k;e-=k}};c.prototype.ks=function(e,g,b,c,k){if(0>e||0>g||0>c)throw a.g.F();if(0!=g)for(this.size<(g<<1)+e&&this.resize((g<<1)+e),k||(e+=g-1<<1),k=
k?2:-2,g+=c;c<g;c++)this.f[e]=b[c].x,this.f[e+1]=b[c].y,e+=k};c.prototype.hy=function(e,g,b,c,k){if(0>e||0>g||0>c)throw a.g.F();if(0!=g)for(this.size<(g<<1)+e&&this.resize((g<<1)+e),k||(e+=g-1<<1),k=k?2:-2,g+=c;c<g;c++)this.f[e]=b[c][0],this.f[e+1]=b[c][1],e+=k};c.prototype.ol=function(e,g,b,c,k){if(0>e||0>g||0>c||this.size<g+e)throw a.g.F();if(k)for(k=0;k<g;k++)b[c+k]=this.f[e+k];else for(c=c+g-1;e<g;e++)b[c]=this.f[e],c--};c.prototype.Hx=function(e,g,b,c,k){if(0>e||0>g||0>c||this.size<(g>>1)+e)throw a.g.F();
if(0!=g)for(k||(e+=g-1),k=k?2:-2,g=c+g;c<g;c++)b[c][0]=this.f[e],b[c][1]=this.f[e+1],e+=k};c.prototype.clear=function(e){e?this.resize(0):this.yf(0)};c.prototype.Mp=function(){this.Ce=this.xa=!0};c.prototype.Gd=function(e,a,b){Array.prototype.sort.call(this.f.subarray(e,a),b)};c.prototype.si=function(){return 1};return c}();a.LL=c})(x||(x={}));!0===x.Xh.Bm&&!0===x.Xh.jw&&(x.Qd=x.LL);(function(a){function b(a,e,g,b){g=new Int32Array(a.subarray(g,b));a.set(g,e)}a.BZ=function(){return function(){this.random=
1973}}();var c=function(){function b(e){this.xa=this.Ce=!1;this.f=[];var g=e;2>g&&(g=2);this.f=this.f=a.J.gf(g,b.Bb);this.size=e}b.prototype.rotate=function(e,g,b){if(this.xa)throw a.g.X("invalid_call");if(g<e||g>b||e>b)throw a.g.F();e!=g&&b!=g&&(this.Zd(e,g-e,1),this.Zd(g,b-g,1),this.Zd(e,b-e,1))};b.zd=function(e,a){b.Bb=a;e=new b(e);b.Bb=0;return e};b.Ak=function(e){var a=new b(0);a.f=e.f.slice(0);a.size=e.size;return a};b.$=function(e,a){var g=new b(0);g.size=e.size;g.size>a&&(g.size=a);g.f=e.f.slice(0,
g.size);return g};b.prototype.yb=function(){};b.prototype.read=function(e){return this.f[e]};b.prototype.fc=function(e,a){a.x=this.f[e];a.y=this.f[e+1]};b.prototype.get=function(a){return this.f[a]};b.prototype.write=function(e,g){if(this.xa)throw a.g.Da();this.f[e]=g};b.prototype.set=function(e,g){if(this.xa)throw a.g.Da();this.f[e]=g};b.prototype.fo=function(e,g){if(this.xa)throw a.g.Da();this.f[e]=g.x;this.f[e+1]=g.y};b.prototype.add=function(a){this.resize(this.size+1);this.f[this.size-1]=a};
b.prototype.Tr=function(a){return b.$(this,a)};b.prototype.Of=function(a){return this.read(a)};b.prototype.resize=function(e,g){void 0===g&&(g=0);if(this.Ce)throw a.g.X("invalid call. Attribute Stream is locked and cannot be resized.");if(e<=this.size){if(a.J.truncate(5*e/4)<this.f.length){var b=this.f.slice(0,e);this.f=b}}else if(e>this.f.length){a.J.truncate(64>e?Math.max(2*e,4):5*e/4);for(var b=this.f.slice(0),c=this.f.length;c<e;c++)b[c]=g;this.f=b}this.size=e};b.prototype.yf=function(e){(null==
this.f||e>this.f.length)&&this.resize(e);if(this.Ce)throw a.g.X("invalid call. Attribute Stream is locked and cannot be resized.");this.size=e};b.prototype.Dm=function(a,g){this.write(a,g)};b.prototype.zk=function(e,g,b){for(var c=this.size;g<c&&g<b;g++)e=a.J.dh(this.read(g),e);return e};b.prototype.Eb=function(a,g,c){if(null==a||!(a instanceof b))return!1;var e=this.size,n=a.size;if(c>e||c>n&&e!=n)return!1;for(c>e&&(c=e);g<c;g++)if(this.read(g)!=a.read(g))return!1;return!0};b.prototype.Qk=function(e,
g,b,c,k,d,p){if(this.xa)throw a.g.Da();if(!k&&(1>d||0!=c%d))throw a.g.F();for(var n=0;n<p-e;n++)this.f[e+c+n]=this.f[e+n];this.f==g.f&&e<b&&(b+=c);if(k)for(n=0;n<c;n++)this.f[n+e]=g.f[b+n];else for(k=c,p=0;p<c;p+=d)for(k-=d,n=0;n<d;n++)this.f[e+p+n]=g.f[b+k+n]};b.prototype.Sq=function(e,g,b,c,k,d){if(this.xa)throw a.g.Da();0>d&&(d=this.size);this.size+2*c>this.f.length?this.resize(this.size+2*c):this.size+=2*c;d-=e;for(var n=this.f.slice(e,e+d),y=0;y<d;y++)this.f[e+2*c+y]=n[y];if(k)for(k=0;k<c;k++)d=
g[b++],this.f[e++]=d.x,this.f[e++]=d.y;else for(k=0,n=c-1;k<c;++k)d=g[b+n],this.f[e++]=d.x,this.f[e++]=d.y,n--};b.prototype.Vj=function(e,g,b,c){if(this.xa)throw a.g.Da();c-=e;for(var n=this.f.slice(e,e+c),k=0;k<c;k++)this.f[e+b+k]=n[k];for(c=0;c<b;c++)this.f[e+c]=g};b.prototype.eh=function(e,g,b){if(this.xa)throw a.g.Da();for(var c=this.f.slice(e,e+(b-e)),n=0;n<b-e;n++)this.f[n+e+2]=c[n];this.f[e]=g.x;this.f[e+1]=g.y};b.prototype.js=function(e,g,b,c,k){if(0>e||0>g||0>c)throw a.g.F();if(b.length<
c+g)throw a.g.F();if(0!=g)if(this.size<g+e&&this.resize(g+e),k)for(k=0;k<g;k++)this.f[e+k]=b[c+k];else for(k||(e+=g-1),g=c+g;c<g;c++)this.f[e]=b[c],e--};b.prototype.ho=function(e,g,b,c,k,d){if(0>e||0>g||0>c)throw a.g.F();if(!k&&(0>=d||0!=g%d))throw a.g.F();if(b.size<c+g)throw a.g.F();if(0!=g)if(this.size<g+e&&this.resize(g+e),b==this)this.Ij(e,g,c,k,d);else if(k)for(k=0;k<g;k++)this.f[e]=b.f[c],e++,c++;else if(c=c+g-d,1==d)for(k=0;k<g;k++)this.f[e]=b.f[c],e++,c--;else for(k=0,g=a.J.truncate(g/d);k<
g;k++){for(var n=0;n<d;n++)this.f[e+n]=b.f[c+n];e+=d;c-=d}};b.prototype.Ek=function(e,g,b){if(this.xa)throw a.g.Da();if(e+g>this.size)throw a.g.Da();if(0<b-(e+g)){b-=e+g;for(var c=this.f.slice(e+g,e+b+g),n=0;n<b;n++)this.f[e+n]=c[n]}this.size-=g};b.prototype.Zd=function(e,g,b){if(this.xa)throw a.g.Da();if(1>b||0!=g%b)throw a.g.Da();for(var c=g>>1,n=0;n<c;n+=b){g-=b;for(var k=0;k<b;k++){var d=this.f[e+n+k];this.f[e+n+k]=this.f[e+g+k];this.f[e+g+k]=d}}};b.prototype.Zh=function(e,g,b){if(0>g||0>b||0>
g||b+g>this.size)throw a.g.F();for(var c=g;c<g+b;c++)this.f[c]=e};b.prototype.Ij=function(e,g,b,c,k){if(!c||e!=b){for(var n=0;n<g;n++)this.f[e+n]=this.f[b+n];if(!c)for(b=e,e=e+g-k,c=0,g=a.J.truncate(g/2);c<g;c++){for(n=0;n<k;n++){var d=this.f[b+n];this.f[b+n]=this.f[e+n];this.f[e+n]=d}b+=k;e-=k}}};b.prototype.ks=function(e,g,b,c,k){if(0>e||0>g||0>c)throw a.g.F();if(0!=g)for(this.size<(g<<1)+e&&this.resize((g<<1)+e),k||(e+=g-1<<1),k=k?2:-2,g+=c;c<g;c++)this.f[e]=b[c].x,this.f[e+1]=b[c].y,e+=k};b.prototype.ol=
function(e,g,b,c,k){if(0>e||0>g||0>c||this.size<g+e)throw a.g.F();if(k)for(k=0;k<g;k++)b[c+k]=this.f[e+k];else for(c=c+g-1;e<g;e++)b[c]=this.f[e],c--};b.prototype.clear=function(a){a?this.resize(0):this.yf(0)};b.prototype.Mp=function(){this.Ce=this.xa=!0};b.prototype.Gd=function(a,g,b){var e=this.f.slice(0,a),c=this.f.slice(g);a=this.f.slice(a,g).sort(b);this.f.length=0;this.f.push.apply(this.f,e.concat(a).concat(c))};b.prototype.si=function(){return 2};b.prototype.Fc=function(){return this.f[this.size-
1]};b.prototype.Pf=function(){this.resize(this.size-1)};b.prototype.CK=function(a){this.f[this.size-1]=a};b.prototype.HJ=function(a){a<this.size-1&&(this.f[a]=this.f[this.size-1]);this.resize(this.size-1)};b.prototype.Ov=function(a){for(var e=0,b=this.size;e<b;e++)if(this.f[e]==a)return e;return-1};b.prototype.oA=function(a){return 0<=this.Ov(a)};b.Bb=0;return b}();a.ia=c;c=function(){function c(a){this.xa=this.Ce=!1;this.f=null;var e=a;2>e&&(e=2);this.f=new Int32Array(e);this.size=a}c.prototype.rotate=
function(e,g,b){if(this.xa)throw a.g.X("invalid_call");if(g<e||g>b||e>b)throw a.g.F();e!=g&&b!=g&&(this.Zd(e,g-e,1),this.Zd(g,b-g,1),this.Zd(e,b-e,1))};c.zd=function(a,g){var e=new c(a),b=e.f;2>a&&(a=2);if(0!==g)for(var d=0;d<a;d++)b[d]=g;return e};c.Ak=function(a){var e=new c(0);e.f=new Int32Array(a.f);e.size=a.size;return e};c.$=function(a,g){var e=new c(0);e.size=a.size;e.size>g&&(e.size=g);g=e.size;2>g&&(g=2);e.f=new Int32Array(g);e.f.set(a.f.length<=g?a.f:a.f.subarray(0,g),0);return e};c.prototype.yb=
function(a){0>=a||(null==this.f?this.f=new Int32Array(a):a<=this.f.length||(0<this.f.length?(a=new Int32Array(a),a.set(this.f),this.f=a):this.f=new Int32Array(a)))};c.prototype.read=function(a){return this.f[a]};c.prototype.fc=function(a,g){g.x=this.f[a];g.y=this.f[a+1]};c.prototype.get=function(a){return this.f[a]};c.prototype.write=function(e,g){if(this.xa)throw a.g.Da();this.f[e]=g};c.prototype.set=function(e,g){if(this.xa)throw a.g.Da();this.f[e]=g};c.prototype.fo=function(e,g){if(this.xa)throw a.g.Da();
this.f[e]=g.x;this.f[e+1]=g.y};c.prototype.add=function(a){this.resize(this.size+1);this.f[this.size-1]=a};c.prototype.Tr=function(a){return c.$(this,a)};c.prototype.Of=function(a){return this.read(a)};c.prototype.resize=function(e,g){void 0===g&&(g=0);if(this.Ce)throw a.g.X("invalid call. Attribute Stream is locked and cannot be resized.");if(e<=this.size){if(30<this.f.length&&5*e/4<this.f.length){var b=new Int32Array(this.f,0,e);this.f=b}}else{e>this.f.length&&(b=a.J.truncate(64>e?Math.max(2*e,
4):5*e/4),b=new Int32Array(b),b.set(this.f),this.f=b);for(var b=this.f,c=this.size;c<e;c++)b[c]=g}this.size=e};c.prototype.yf=function(e){(null==this.f||e>this.f.length)&&this.resize(e);if(this.Ce)throw a.g.X("invalid call. Attribute Stream is locked and cannot be resized.");this.size=e};c.prototype.Dm=function(a,g){this.write(a,g)};c.prototype.zk=function(e,g,b){for(var c=this.size;g<c&&g<b;g++)e=a.J.dh(this.read(g),e);return e};c.prototype.Eb=function(a,g,b){if(null==a||!(a instanceof c))return!1;
var e=this.size,n=a.size;if(b>e||b>n&&e!=n)return!1;for(b>e&&(b=e);g<b;g++)if(this.read(g)!=a.read(g))return!1;return!0};c.prototype.Qk=function(e,g,c,d,k,p,f){if(this.xa)throw a.g.Da();if(!k&&(1>p||0!=d%p))throw a.g.F();b(this.f,e+d,e,e+(f-e));this.f==g.f&&e<c&&(c+=d);if(k)this.f.set(g.f.subarray(c,c+d),e);else for(k=d,f=0;f<d;f+=p){k-=p;for(var n=0;n<p;n++)this.f[e+f+n]=g.f[c+k+n]}};c.prototype.Sq=function(e,g,c,d,k,p){if(this.xa)throw a.g.Da();0>p&&(p=this.size);this.size+2*d>this.f.length?this.resize(this.size+
2*d):this.size+=2*d;b(this.f,e+2*d,e,e+(p-e));if(k)for(k=0;k<d;k++)p=g[c++],this.f[e++]=p.x,this.f[e++]=p.y;else{k=0;for(var n=d-1;k<d;++k)p=g[c+n],this.f[e++]=p.x,this.f[e++]=p.y,n--}};c.prototype.Vj=function(e,g,c,d){if(this.xa)throw a.g.Da();d-=e;b(this.f,e+d,e,e+d);for(d=0;d<c;d++)this.f[e+d]=g};c.prototype.eh=function(e,g,c){if(this.xa)throw a.g.Da();b(this.f,e+2,e,e+(c-e));this.f[e]=g.x;this.f[e+1]=g.y};c.prototype.js=function(e,g,b,c,d){if(0>e||0>g||0>c)throw a.g.F();if(b.length<c+g)throw a.g.F();
if(0!=g)if(this.size<g+e&&this.resize(g+e),d)this.f.set(b.subarray(c,g),e);else for(d||(e+=g-1),g=c+g;c<g;c++)this.f[e]=b[c],e--};c.prototype.ho=function(e,g,b,c,d,k){if(0>e||0>g||0>c)throw a.g.F();if(!d&&(0>=k||0!=g%k))throw a.g.F();if(b.size<c+g)throw a.g.F();if(0!=g)if(this.size<g+e&&this.resize(g+e),b==this)this.Ij(e,g,c,d,k);else if(d)for(d=0;d<g;d++)this.f[e]=b.f[c],e++,c++;else if(c=c+g-k,1==k)for(d=0;d<g;d++)this.f[e]=b.f[c],e++,c--;else for(d=0,g=a.J.truncate(g/k);d<g;d++){for(var n=0;n<
k;n++)this.f[e+n]=b.f[c+n];e+=k;c-=k}};c.prototype.Ek=function(e,g,c){if(this.xa)throw a.g.Da();if(e+g>this.size)throw a.g.Da();0<c-(e+g)&&b(this.f,e,e+g,e+(c-(e+g))+g);this.size-=g};c.prototype.Zd=function(e,g,b){if(this.xa)throw a.g.Da();if(1>b||0!=g%b)throw a.g.Da();for(var c=g>>1,n=0;n<c;n+=b){g-=b;for(var d=0;d<b;d++){var k=this.f[e+n+d];this.f[e+n+d]=this.f[e+g+d];this.f[e+g+d]=k}}};c.prototype.Zh=function(e,g,b){if(0>g||0>b||0>g||b+g>this.size)throw a.g.F();for(var c=g;c<g+b;c++)this.f[c]=
e};c.prototype.Ij=function(e,g,b,c,d){if(!c||e!=b)if(this.f.set(this.f.subarray(b,b+g),e),!c)for(b=e,e=e+g-d,c=0,g=a.J.truncate(g/2);c<g;c++){for(var n=0;n<d;n++){var k=this.f[b+n];this.f[b+n]=this.f[e+n];this.f[e+n]=k}b+=d;e-=d}};c.prototype.ks=function(e,g,b,c,d){if(0>e||0>g||0>c)throw a.g.F();if(0!=g)for(this.size<(g<<1)+e&&this.resize((g<<1)+e),d||(e+=g-1<<1),d=d?2:-2,g+=c;c<g;c++)this.f[e]=b[c].x,this.f[e+1]=b[c].y,e+=d};c.prototype.ol=function(e,g,b,c,d){if(0>e||0>g||0>c||this.size<g+e)throw a.g.F();
if(d)for(d=0;d<g;d++)b[c+d]=this.f[e+d];else for(c=c+g-1;e<g;e++)b[c]=this.f[e],c--};c.prototype.clear=function(a){a?this.resize(0):this.yf(0)};c.prototype.Mp=function(){this.Ce=this.xa=!0};c.prototype.Gd=function(a,g,b){10>g-a?c.tl(this.f,a,g,b):c.Oi(this.f,a,g-1,b)};c.prototype.si=function(){return 2};c.prototype.Fc=function(){return this.f[this.size-1]};c.prototype.Pf=function(){this.resize(this.size-1)};c.prototype.CK=function(a){this.f[this.size-1]=a};c.prototype.HJ=function(a){a<this.size-1&&
(this.f[a]=this.f[this.size-1]);this.resize(this.size-1)};c.prototype.Ov=function(a){for(var e=0,b=this.size;e<b;e++)if(this.f[e]==a)return e;return-1};c.prototype.oA=function(a){return 0<=this.Ov(a)};c.tl=function(a,g,b,c){for(var e=g;e<b;e++){for(var n=a[e],d=e-1;d>=g&&0<c(a[d],n);)a[d+1]=a[d],d--;a[d+1]=n}};c.Wg=function(a,g,b){var e=a[b];a[b]=a[g];a[g]=e};c.Oi=function(a,g,b,d){if(!(g>=b))for(;;){if(9>b-g){c.tl(a,g,b+1,d);break}var e=a[g];c.Wg(a,g,b);for(var n=g,k=g;k<b;k++)0>=d(a[k],e)&&(c.Wg(a,
n,k),n+=1);c.Wg(a,n,b);n-g<b-n?(c.Oi(a,g,n-1,d),g=n+1):(c.Oi(a,n+1,b,d),b=n-1)}};return c}();a.jy=c})(x||(x={}));!0===x.Xh.Bm&&(x.ia=x.jy);(function(a){function b(a,e,g,b){g=new Int8Array(a.subarray(g,b));a.set(g,e)}var c=function(){function b(e){this.xa=this.Ce=!1;this.f=[];var g=e;2>g&&(g=2);this.f=a.J.gf(g,b.Bb);this.size=e}b.prototype.rotate=function(e,g,b){if(this.xa)throw a.g.X("invalid_call");if(g<e||g>b||e>b)throw a.g.F();e!=g&&b!=g&&(this.Zd(e,g-e,1),this.Zd(g,b-g,1),this.Zd(e,b-e,1))};b.zd=
function(a,g){b.Bb=g;a=new b(a);b.Bb=0;return a};b.Ak=function(a){var e=new b(0);e.f=a.f.slice(0);e.size=a.size;return e};b.$=function(a,g){var e=new b(0);e.size=a.size;e.size>g&&(e.size=g);e.f=a.f.slice(0,e.size);return e};b.prototype.yb=function(){};b.prototype.read=function(a){return this.f[a]};b.prototype.fc=function(a,g){g.x=this.f[a];g.y=this.f[a+1]};b.prototype.get=function(a){return this.f[a]};b.prototype.write=function(e,g){if(this.xa)throw a.g.Da();this.f[e]=g};b.prototype.set=function(e,
g){if(this.xa)throw a.g.Da();this.f[e]=g};b.prototype.fo=function(e,g){if(this.xa)throw a.g.Da();this.f[e]=g.x;this.f[e+1]=g.y};b.prototype.add=function(a){this.resize(this.size+1);this.f[this.size-1]=a};b.prototype.Tr=function(a){return b.$(this,a)};b.prototype.Of=function(a){return this.read(a)};b.prototype.resize=function(e,g){void 0===g&&(g=0);if(this.Ce)throw a.g.X("invalid call. Attribute Stream is locked and cannot be resized.");if(e<=this.size){if(a.J.truncate(5*e/4)<this.f.length){var b=
this.f.slice(0,e);this.f=b}}else if(e>this.f.length){a.J.truncate(64>e?Math.max(2*e,4):5*e/4);for(var b=this.f.slice(0),c=this.f.length;c<e;c++)b[c]=g;this.f=b}this.size=e};b.prototype.yf=function(e){(null==this.f||e>this.f.length)&&this.resize(e);if(this.Ce)throw a.g.X("invalid call. Attribute Stream is locked and cannot be resized.");this.size=e};b.prototype.Dm=function(a,g){this.write(a,g)};b.prototype.zk=function(e,g,b){for(var c=this.size;g<c&&g<b;g++)e=a.J.dh(this.read(g),e);return e};b.prototype.Eb=
function(a,g,c){if(null==a||!(a instanceof b))return!1;var e=this.size,n=a.size;if(c>e||c>n&&e!=n)return!1;for(c>e&&(c=e);g<c;g++)if(this.read(g)!=a.read(g))return!1;return!0};b.prototype.Qk=function(e,g,b,c,d,k,p){if(this.xa)throw a.g.Da();if(!d&&(1>k||0!=c%k))throw a.g.F();for(var n=0;n<p-e;n++)this.f[e+c+n]=this.f[e+n];this.f==g.f&&e<b&&(b+=c);if(d)for(n=0;n<c;n++)this.f[n+e]=g.f[b+n];else for(d=c,p=0;p<c;p+=k)for(d-=k,n=0;n<k;n++)this.f[e+p+n]=g.f[b+d+n]};b.prototype.Sq=function(e,g,b,c,d,k){if(this.xa)throw a.g.Da();
0>k&&(k=this.size);this.size+2*c>this.f.length?this.resize(this.size+2*c):this.size+=2*c;k-=e;for(var n=this.f.slice(e,e+k),y=0;y<k;y++)this.f[e+2*c+y]=n[y];if(d)for(d=0;d<c;d++)k=g[b++],this.f[e++]=k.x,this.f[e++]=k.y;else for(d=0,n=c-1;d<c;++d)k=g[b+n],this.f[e++]=k.x,this.f[e++]=k.y,n--};b.prototype.Vj=function(e,g,b,c){if(this.xa)throw a.g.Da();c-=e;for(var n=this.f.slice(e,e+c),d=0;d<c;d++)this.f[e+b+d]=n[d];for(c=0;c<b;c++)this.f[e+c]=g};b.prototype.eh=function(e,g,b){if(this.xa)throw a.g.Da();
for(var c=this.f.slice(e,e+(b-e)),n=0;n<b-e;n++)this.f[n+e+2]=c[n];this.f[e]=g.x;this.f[e+1]=g.y};b.prototype.js=function(e,g,b,c,d){if(0>e||0>g||0>c)throw a.g.F();if(b.length<c+g)throw a.g.F();if(0!=g)if(this.size<g+e&&this.resize(g+e),d)for(d=0;d<g;d++)this.f[e+d]=b[c+d];else for(d||(e+=g-1),g=c+g;c<g;c++)this.f[e]=b[c],e--};b.prototype.ho=function(e,g,b,c,d,k){if(0>e||0>g||0>c)throw a.g.F();if(!d&&(0>=k||0!=g%k))throw a.g.F();if(b.size<c+g)throw a.g.F();if(0!=g)if(this.size<g+e&&this.resize(g+
e),b==this)this.Ij(e,g,c,d,k);else if(d)for(d=0;d<g;d++)this.f[e]=b.f[c],e++,c++;else if(c=c+g-k,1==k)for(d=0;d<g;d++)this.f[e]=b.f[c],e++,c--;else for(d=0,g=a.J.truncate(g/k);d<g;d++){for(var n=0;n<k;n++)this.f[e+n]=b.f[c+n];e+=k;c-=k}};b.prototype.Ek=function(e,g,b){if(this.xa)throw a.g.Da();if(e+g>this.size)throw a.g.Da();if(0<b-(e+g)){b-=e+g;for(var c=this.f.slice(e+g,e+b+g),n=0;n<b;n++)this.f[e+n]=c[n]}this.size-=g};b.prototype.Zd=function(e,g,b){if(this.xa)throw a.g.Da();if(1>b||0!=g%b)throw a.g.Da();
for(var c=g>>1,n=0;n<c;n+=b){g-=b;for(var d=0;d<b;d++){var k=this.f[e+n+d];this.f[e+n+d]=this.f[e+g+d];this.f[e+g+d]=k}}};b.prototype.Zh=function(e,g,b){if(0>g||0>b||0>g||b+g>this.size)throw a.g.F();for(var c=g;c<g+b;c++)this.f[c]=e};b.prototype.Ij=function(e,g,b,c,d){if(!c||e!=b){for(var n=0;n<g;n++)this.f[e+n]=this.f[b+n];if(!c)for(b=e,e=e+g-d,c=0,g=a.J.truncate(g/2);c<g;c++){for(n=0;n<d;n++){var k=this.f[b+n];this.f[b+n]=this.f[e+n];this.f[e+n]=k}b+=d;e-=d}}};b.prototype.ks=function(e,g,b,c,d){if(0>
e||0>g||0>c)throw a.g.F();if(0!=g)for(this.size<(g<<1)+e&&this.resize((g<<1)+e),d||(e+=g-1<<1),d=d?2:-2,g+=c;c<g;c++)this.f[e]=b[c].x,this.f[e+1]=b[c].y,e+=d};b.prototype.ol=function(e,g,b,c,d){if(0>e||0>g||0>c||this.size<g+e)throw a.g.F();if(d)for(d=0;d<g;d++)b[c+d]=this.f[e+d];else for(c=c+g-1;e<g;e++)b[c]=this.f[e],c--};b.prototype.clear=function(a){a?this.resize(0):this.yf(0)};b.prototype.Mp=function(){this.Ce=this.xa=!0};b.prototype.Gd=function(a,g,b){var e=this.f.slice(0,a),c=this.f.slice(g);
a=this.f.slice(a,g).sort(b);this.f.length=0;this.f.push.apply(this.f,e.concat(a).concat(c))};b.prototype.si=function(){return 1};b.prototype.jC=function(e,g){if(this.xa)throw a.g.X("invalid call. Attribute Stream is read only.");this.f[e]|=g};b.prototype.fz=function(e,g){if(this.xa)throw a.g.X("invalid call. Attribute Stream is read only.");this.f[e]&=~g};b.Bb=0;return b}();a.Fm=c;c=function(){function c(a){this.f=null;var e=a;2>e&&(e=2);this.f=new Int8Array(e);this.size=a}c.prototype.rotate=function(e,
g,b){if(this.xa)throw a.g.X("invalid_call");if(g<e||g>b||e>b)throw a.g.F();e!=g&&b!=g&&(this.Zd(e,g-e,1),this.Zd(g,b-g,1),this.Zd(e,b-e,1))};c.zd=function(a,g){var e=new c(a),b=e.f;2>a&&(a=2);if(0!==g)for(var d=0;d<a;d++)b[d]=g;return e};c.Ak=function(a){var e=new c(0);e.f=new Int8Array(a.f);e.size=a.size;return e};c.$=function(a,g){var e=new c(0);e.size=a.size;e.size>g&&(e.size=g);g=e.size;2>g&&(g=2);e.f=new Int8Array(g);e.f.set(a.f.length<=g?a.f:a.f.subarray(0,g),0);return e};c.prototype.yb=function(a){0>=
a||(null==this.f?this.f=new Int8Array(a):a<=this.f.length||(0<this.f.length?(a=new Int8Array(a),a.set(this.f),this.f=a):this.f=new Int8Array(a)))};c.prototype.read=function(a){return this.f[a]};c.prototype.fc=function(a,g){g.x=this.f[a];g.y=this.f[a+1]};c.prototype.get=function(a){return this.f[a]};c.prototype.write=function(e,g){if(this.xa)throw a.g.Da();this.f[e]=g};c.prototype.set=function(e,g){if(this.xa)throw a.g.Da();this.f[e]=g};c.prototype.fo=function(e,g){if(this.xa)throw a.g.Da();this.f[e]=
g.x;this.f[e+1]=g.y};c.prototype.add=function(a){this.resize(this.size+1);this.f[this.size-1]=a};c.prototype.Tr=function(a){return c.$(this,a)};c.prototype.Of=function(a){return this.read(a)};c.prototype.resize=function(e,g){void 0===g&&(g=0);if(this.Ce)throw a.g.X("invalid call. Attribute Stream is locked and cannot be resized.");if(e<=this.size){if(30<this.f.length&&5*e/4<this.f.length){var b=new Int8Array(this.f,0,e);this.f=b}}else{e>this.f.length&&(b=a.J.truncate(64>e?Math.max(2*e,4):5*e/4),b=
new Int8Array(b),b.set(this.f),this.f=b);for(var b=this.f,c=this.size;c<e;c++)b[c]=g}this.size=e};c.prototype.yf=function(e){(null==this.f||e>this.f.length)&&this.resize(e);if(this.Ce)throw a.g.X("invalid call. Attribute Stream is locked and cannot be resized.");this.size=e};c.prototype.Dm=function(a,g){this.write(a,g)};c.prototype.zk=function(e,g,b){for(var c=this.size;g<c&&g<b;g++)e=a.J.dh(this.read(g),e);return e};c.prototype.Eb=function(a,g,b){if(null==a||!(a instanceof c))return!1;var e=this.size,
d=a.size;if(b>e||b>d&&e!=d)return!1;for(b>e&&(b=e);g<b;g++)if(this.read(g)!=a.read(g))return!1;return!0};c.prototype.Qk=function(e,g,c,d,k,p,f){if(this.xa)throw a.g.Da();if(!k&&(1>p||0!=d%p))throw a.g.F();b(this.f,e+d,e,e+(f-e));this.f==g.f&&e<c&&(c+=d);if(k)this.f.set(g.f.subarray(c,c+d),e);else for(k=d,f=0;f<d;f+=p){k-=p;for(var n=0;n<p;n++)this.f[e+f+n]=g.f[c+k+n]}};c.prototype.Vj=function(e,g,c,d){if(this.xa)throw a.g.Da();d-=e;b(this.f,e+d,e,e+d);for(d=0;d<c;d++)this.f[e+d]=g};c.prototype.Sq=
function(e,g,c,d,k,p){if(this.xa)throw a.g.Da();0>p&&(p=this.size);this.size+2*d>this.f.length?this.resize(this.size+2*d):this.size+=2*d;b(this.f,e+2*d,e,e+(p-e));if(k)for(k=0;k<d;k++)p=g[c++],this.f[e++]=p.x,this.f[e++]=p.y;else{k=0;for(var n=d-1;k<d;++k)p=g[c+n],this.f[e++]=p.x,this.f[e++]=p.y,n--}};c.prototype.eh=function(e,g,c){if(this.xa)throw a.g.Da();b(this.f,e+2,e,e+(c-e));this.f[e]=g.x;this.f[e+1]=g.y};c.prototype.js=function(e,g,b,c,d){if(0>e||0>g||0>c)throw a.g.F();if(b.length<c+g)throw a.g.F();
if(0!=g)if(this.size<g+e&&this.resize(g+e),d)this.f.set(b.subarray(c,g),e);else for(d||(e+=g-1),g=c+g;c<g;c++)this.f[e]=b[c],e--};c.prototype.ho=function(e,g,b,c,d,k){if(0>e||0>g||0>c)throw a.g.F();if(!d&&(0>=k||0!=g%k))throw a.g.F();if(b.size<c+g)throw a.g.F();if(0!=g)if(this.size<g+e&&this.resize(g+e),b==this)this.Ij(e,g,c,d,k);else if(d)for(d=0;d<g;d++)this.f[e]=b.f[c],e++,c++;else if(c=c+g-k,1==k)for(d=0;d<g;d++)this.f[e]=b.f[c],e++,c--;else for(d=0,g=a.J.truncate(g/k);d<g;d++){for(var n=0;n<
k;n++)this.f[e+n]=b.f[c+n];e+=k;c-=k}};c.prototype.Ek=function(e,g,c){if(this.xa)throw a.g.Da();if(e+g>this.size)throw a.g.Da();0<c-(e+g)&&b(this.f,e,e+g,e+(c-(e+g))+g);this.size-=g};c.prototype.Zd=function(e,g,b){if(this.xa)throw a.g.Da();if(1>b||0!=g%b)throw a.g.Da();for(var c=g>>1,d=0;d<c;d+=b){g-=b;for(var n=0;n<b;n++){var k=this.f[e+d+n];this.f[e+d+n]=this.f[e+g+n];this.f[e+g+n]=k}}};c.prototype.Zh=function(e,g,b){if(0>g||0>b||0>g||b+g>this.size)throw a.g.F();for(var c=g;c<g+b;c++)this.f[c]=
e};c.prototype.Ij=function(e,g,b,c,d){if(!c||e!=b)if(this.f.set(this.f.subarray(b,b+g),e),!c)for(b=e,e=e+g-d,c=0,g=a.J.truncate(g/2);c<g;c++){for(var n=0;n<d;n++){var k=this.f[b+n];this.f[b+n]=this.f[e+n];this.f[e+n]=k}b+=d;e-=d}};c.prototype.ks=function(e,g,b,c,d){if(0>e||0>g||0>c)throw a.g.F();if(0!=g)for(this.size<(g<<1)+e&&this.resize((g<<1)+e),d||(e+=g-1<<1),d=d?2:-2,g+=c;c<g;c++)this.f[e]=b[c].x,this.f[e+1]=b[c].y,e+=d};c.prototype.ol=function(e,g,b,c,d){if(0>e||0>g||0>c||this.size<g+e)throw a.g.F();
if(d)for(d=0;d<g;d++)b[c+d]=this.f[e+d];else for(c=c+g-1;e<g;e++)b[c]=this.f[e],c--};c.prototype.clear=function(a){a?this.resize(0):this.yf(0)};c.prototype.Mp=function(){this.Ce=this.xa=!0};c.prototype.Gd=function(a,g,b){g=this.f.subarray(a,g);Array.prototype.sort.call(g,b);this.f.set(g,a)};c.prototype.jC=function(e,g){if(this.xa)throw a.g.X("invalid call. Attribute Stream is read only.");this.f[e]|=g};c.prototype.fz=function(e,g){if(this.xa)throw a.g.X("invalid call. Attribute Stream is read only.");
this.f[e]&=~g};c.prototype.si=function(){return 1};return c}();a.ky=c})(x||(x={}));!0===x.Xh.Bm&&(x.Fm=x.ky);(function(a){var b=function(){function b(){}b.vq=function(b,e){return a.Fm.zd(b,e)};b.Um=function(b,e){return a.Qd.zd(b,e)};b.pz=function(b,e,g){switch(b){case 1:b=a.Qd.zd(e,g);break;case 2:b=a.ia.zd(e,g);break;case 4:b=a.Fm.zd(e,g);break;default:throw a.g.za();}return b};b.qz=function(c,e){return b.pz(a.ma.si(c),e*a.ma.Xa(c),a.ma.de(c))};b.wh=function(b,e){return a.ia.zd(b,e)};b.JB=function(a){var e,
g=[];for(e=0;e<a;e++)g.push(null);return g};return b}();a.Uc=b})(x||(x={}));(function(a){var b=function(){function b(){}b.vq=function(b,e){return a.ky.zd(b,e)};b.Um=function(b,e){return a.Qd.zd(b,e)};b.pz=function(b,e,g){switch(b){case 1:b=a.Qd.zd(e,g);break;case 2:b=a.jy.zd(e,g);break;case 4:b=a.ky.zd(e,g);break;default:throw a.g.za();}return b};b.qz=function(b,e){return a.Uc.pz(a.ma.si(b),e*a.ma.Xa(b),a.ma.de(b))};b.wh=function(b,e){return a.jy.zd(b,e)};b.JB=function(a){var e,g=[];for(e=0;e<a;e++)g.push(null);
return g};return b}();a.ML=b})(x||(x={}));!0===x.Xh.Bm&&(x.Uc=x.ML);(function(a){a.ea=function(){return function(a){void 0===a&&(a=0);this.j=a}}()})(x||(x={}));(function(a){var b=function(){function b(){}b.bind=function(c){a.Vc=c.PeDefs;a.Tf=c.PeFactory;a.RD=c.PeVertcs;a.OD=c.PeCoordsys;a.fi=c.PeCSTransformations;a.QD=c.PeGTTransformations;a.zN=c.PeGeogtran;a.yN=c.PeFactoryCodechange;a.PD=c.PeGCSExtent;a.Bg=c.PePCSInfo;a.AN=c.PeHorizon;a.OD=c.PeCoordsys;a.fq=c.PeGTlistExtended;a.fq.PE_GTLIST_OPTS_USE_DEFAULT=
128;a.Tf.initialize(null);a.wy=c.PeGTlistExtendedEntry;b.RY=a.Tf.fromString(a.Vc.PE_TYPE_UNIT,'UNIT["Meter",1.0]')};b.w_=function(){};b.RY=null;return b}();a.BN=b;a.Tf=null;a.RD=null;a.OD=null;a.AN=null;a.Bg=null;a.fq=null;a.wy=null;a.PD=null;a.yN=null;a.zN=null;a.Vc=null;a.QD=null;a.fi=null})(x||(x={}));(function(a){var b=function(){function a(){}a.Ab=function(e,g){return 0<=g?a.K(e):-a.K(e)};a.K=function(a){return 0>a?-a:a};a.Qi=function(a){return 3.552713678800501E-15>a};a.ND=function(e,g,b){return a.K(e-
g)<=b*(1+(a.K(e)+a.K(g))/2)};a.W=function(e,g){return a.ND(e,g,3.552713678800501E-15)};a.kW=function(e){return 3.552713678800501E-15>=a.K(e)};a.xd=function(e){return a.kW(e)};return a}();a.l=b;var c=function(){function c(){}c.Sp=function(a,g){a=b.K(a);g=b.K(g);var e=0;0!=a+g&&(a>g?(e=g/a,e=a*Math.sqrt(1+e*e)):(e=a/g,e=g*Math.sqrt(1+e*e)));return e};c.Or=function(a,g,d,k,p){for(var e=[0,0,0],n=[0,0,0],y=0;2>=y;y++)g[y]-=a[y],d[y]-=g[y];d=e[1]*n[2]-e[2]*n[1];g=e[2]*n[0]-e[0]*n[2];e=e[0]*n[1]-e[1]*n[0];
a=-1*(d*a[0]+g*a[1]+e*a[2]);k[0]=d;k[1]=g;k[2]=e;k[3]=a;n=c.eo(k);k[0]/=n;k[1]/=n;k[2]/=n;k[3]/=n;0!=p&&(n=b.xd(e)?b.xd(a)?b.Ab(1,g):-b.Ab(1,a):b.Ab(1,e),n*=b.Ab(1,p),k[0]*=n,k[1]*=n,k[2]*=n,k[3]*=n)};c.fy=function(a,g,b){b[0]=a[1]*g[2]-g[1]*a[2];b[1]=a[2]*g[0]-g[2]*a[0];b[2]=a[0]*g[1]-g[0]*a[1]};c.Eu=function(a,g){return a[0]*g[0]+a[1]*g[1]+a[2]*g[2]};c.eo=function(a){return c.Sp(c.Sp(a[0],a[1]),a[2])};c.Ck=function(a,g,b,d,k,p,f,h){a=c.n(a,g,b);var e=Math.cos(b);p.j=(a+k)*e*Math.cos(d);f.j=(a+k)*
e*Math.sin(d);h.j=(a*(1-g)+k)*Math.sin(b)};c.kQ=function(a,g,d,k,p,f,H){var e=c.Sp(g,d),n=1*Math.sqrt(1-a),y=n/1;if(b.W(e,0))f.j=0,p.j=b.Ab(1.570796326794897,k),H.j=b.K(k)-n;else{f.j=Math.atan2(d,g);d=Math.atan2(1*k,n*e);f=Math.cos(d);var B=Math.sin(d);g=n*a/(1-a);a*=1;d=Math.atan2(k+g*B*B*B,e-a*f*f*f);3.141592653589793<b.K(d)&&(d=b.Ab(3.141592653589793,d)-d);d=Math.atan(y*Math.tan(d));B=Math.sin(d);f=Math.cos(d);p.j=Math.atan2(k+g*B*B*B,e-a*f*f*f);1.570796326794897<b.K(p.j)&&(p.j=b.Ab(3.141592653589793,
p.j)-p.j);d=Math.atan(y*Math.tan(p.j));B=Math.sin(d);f=Math.cos(d);H.j=(k-n*B)*Math.sin(p.j)+(e-1*f)*Math.cos(p.j)}};c.n=function(a,g,b){b=Math.sin(b);return a/Math.sqrt(1-g*b*b)};c.du=function(a,g){return Math.atan2(Math.sin(g)*(1-a),Math.cos(g))};c.ik=function(a,g){return Math.atan2(Math.sin(g),Math.cos(g)*(1-a))};c.xp=function(a,g){if(b.Qi(a)||0==g||b.W(b.K(g),1.570796326794897))return g;var e,d,k,p,f,h,l,m,A;if(.006884661117170036>a){p=Math.sqrt(1-a);f=(1-p)/(1+p);h=f*f;l=f*h;m=f*l;e=f*m;A=f*
e;d=f*A;k=1.572916666666667*l-3.2578125*e+4.295068359375*d;p=2.142578125*m-6.071484375*A;a=3.129296875*e-11.249837239583334*d;var q=4.775276692708333*A,r=7.958636765252976*d,t=Math.cos(2*g);return g+Math.sin(2*g)*(1.5*f-.84375*l+.525390625*e-.2688395182291667*d-k+a-r+t*(2*(1.3125*h-1.71875*m+1.650146484375*A)-4*p+6*q+t*(4*k-12*a+24*r+t*(8*p-32*q+t*(16*a-80*r+t*(32*q+64*t*r))))))}p=1-a;f=a/2;h=b.K(g);l=h*c.Tu(a)/(1.570796326794897*p);m=9999;A=h;for(h=0;1E-16<m&&50>h;h++)d=c.Cm(a,A),e=(c.EG(A,a)-f*
Math.sin(2*A)/d)/p-l,d=1/(d*d*d),k=e/d,e=A-k,m=b.K(k),A=e;return 0<=g?A:-A};c.qX=function(a,g){return b.Qi(g)?a:a*c.Tu(g)/1.570796326794897};c.da=function(a){a=c.rG(a,6.283185307179586);return 0>a?a+6.283185307179586:3.141592653589793>b.K(a)||b.W(b.K(a),3.141592653589793)?a:a-6.283185307179586};c.rG=function(a,g){return a-Math.floor(a/g)*g};c.Yg=function(a,g){if(.006884661117170036>g){g=Math.sqrt(1-g);g=(1-g)/(1+g);var e=g*g,b=e*e;return a/(1+g)*(1+.25*e+.015625*b+.00390625*e*b)*1.570796326794897}return a*
c.Tu(g)};c.Nr=function(a,g){var e=b.Ab(1,Math.sin(g));g=b.K(c.rG(g,3.141592653589793));g=1.570796326794897>=g?g:3.141592653589793-g;var d;b.W(g,1.570796326794897)?d=g:d=Math.atan(Math.sqrt(1-a)*Math.tan(g));return d*e};c.q=function(a,g,b){if(.006884661117170036>g){g=Math.sqrt(1-g);g=(1-g)/(1+g);var e=g*g,d=g*e,n=g*d,k=g*n,p=g*k,f=g*p,h=-.7291666666666666*d+.2278645833333333*k+.03987630208333334*f,l=.615234375*n-.21533203125*p,m=-.54140625*k+.20302734375*f,A=.48876953125*p,q=-.4488699776785715*f,r=
Math.cos(2*b);return a/(1+g)*((1+.25*e+.015625*n+.00390625*p)*b+Math.sin(2*b)*(-1.5*g+.1875*d+.0234375*k+.00732421875*f-h+m-q+r*(2*(.9375*e-.234375*n-.03662109375*p)-4*l+6*A+r*(4*h-12*m+24*q+r*(8*l-32*A+r*(16*m-80*q+r*(32*A+64*r*q)))))))}return a*(c.EG(b,g)-.5*g*Math.sin(2*b)/c.Cm(g,b))};c.Cm=function(a,g){g=Math.sin(g);return Math.sqrt(1-a*g*g)};c.Tu=function(a){return b.ND(a,1,2.220446049250313E-16)?1:1>a?c.Lv(0,1-a)-a/3*c.Iv(0,1-a):NaN};c.EG=function(e,g){var d=b.Ab(1,e);e=b.K(e);var k=Math.floor(e/
1.570796326794897),p;if(1<g)p=0==e?0:NaN;else if(b.xd(k))p=c.sin(e),p=p*c.Lv(1-p*p,1-g*p*p)-g/3*p*p*p*c.Iv(1-p*p,1-g*p*p);else{p=a.J.truncate(k%2);var f=c.Tu(g);0<p?(p=Math.sin(1.570796326794897*(k+1)-e),p=p*c.Lv(1-p*p,1-g*p*p)-g/3*p*p*p*c.Iv(1-p*p,1-g*p*p),p=f*(k+1)-p):(p=Math.sin(e-1.570796326794897*k),p=p*c.Lv(1-p*p,1-g*p*p)-g/3*p*p*p*c.Iv(1-p*p,1-g*p*p),p=f*k+p)}return p*d};c.sin=function(a){a=c.da(a);var e=b.Ab(1,a);a=b.K(a);return b.W(a,3.141592653589793)?0:b.W(a,1.570796326794897)?1*e:Math.sin(a)*
e};c.Iv=function(a,g){for(var e=1,c=0,d=1,k,p,f,h;;){k=.2*(a+g+3*e);p=(k-a)/k;f=(k-g)/k;h=(k-e)/k;if(1E-4>b.K(p)&&1E-4>b.K(f)&&1E-4>b.K(h))break;h=Math.sqrt(g);k=Math.sqrt(e);h=Math.sqrt(a)*(h+k)+h*k;c+=d/(k*(e+h));d*=.25;a=.25*(a+h);g=.25*(g+h);e=.25*(e+h)}a=p*f;e=h*h;g=a-e;e=a-6*e;p=e+g+g;return 3*c+d*(1+e*(-.2142857142857143+.10227272727272728*e-.1730769230769231*h*p)+h*(.1666666666666667*p+h*(-.4090909090909091*g+.1153846153846154*h*a)))/(k*Math.sqrt(k))};c.Lv=function(a,g){for(var e,c,d,k,p=
1;;p=.25*(p+e)){e=(a+g+p)/3;c=2-(e+a)/e;d=2-(e+g)/e;k=2-(e+p)/e;if(1E-4>b.K(c)&&1E-4>b.K(d)&&1E-4>b.K(k))break;e=Math.sqrt(g);c=Math.sqrt(p);e=Math.sqrt(a)*(e+c)+e*c;a=.25*(a+e);g=.25*(g+e)}a=c*d-k*k;g=c*d*k;return(1+(.04166666666666666*a-.1-.06818181818181818*g)*a+.07142857142857142*g)/Math.sqrt(e)};c.Cx=function(a,g){if(b.Qi(a)||0==g||b.W(b.K(g),1.570796326794897))return g;var e,c,d;if(.006884661117170036>a){e=a*a;c=a*e;d=a*c;var k=a*d,p=a*k,f=a*p,h=-(.02708333333333333*c+.03430059523809524*d+.03149181547619048*
k+.02634359154541446*p+.02156896735835538*f),l=.007669890873015873*d+.01299603174603175*k+.0148051353064374*p+.01454454953803912*f,m=-(.002275545634920635*k+.004830845032667949*p+.006558395368616723*f),A=6.957236677288761E-4*p+.001775193002406544*f,q=-(2.17324089394402E-4*f),r=Math.cos(2*g);return g+Math.sin(2*g)*(-(.5*a+.2083333333333333*e+.09375*c+.04878472222222222*d+.02916666666666667*k+.01938905423280423*p+.01388255931712963*f)-h+m-q+r*(2*(.1041666666666667*e+.0875*c+.06050347222222222*d+.04151785714285714*
k+.02958958540013228*p+.02203667534722222*f)-4*l+6*A+r*(4*h-12*m+24*q+r*(8*l-32*A+r*(16*m-80*q+r*(32*A+64*r*q))))))}0==g||b.W(b.K(g),1.570796326794897)?e=g:(c=Math.sqrt(a),d=c*Math.sin(g),e=Math.tan(.7853981633974483+g/2)*Math.pow((1-d)/(1+d),c/2),e=2*Math.atan(e)-1.570796326794897);return e};c.CQ=function(a,g){if(b.Qi(a)||0==g||b.W(b.K(g),1.570796326794897))return g;var e,c;if(.006884661117170036>a){r=a*a;m=a*r;A=a*m;e=a*A;q=a*e;c=a*q;var d=.05833333333333333*m+.07232142857142858*A+.05634300595238095*
e+.0355325796406526*q+.020235546186067*c,k=.02653149801587302*A+.04379960317460317*e+.0429211791776896*q+.03255384637546096*c,p=.01294022817460318*e+.02668104344536636*q+.03155651254609588*c,f=.00659454790965208*q+.0163075268674227*c,h=.003463473736911237*c,l=Math.cos(2*g);return g+Math.sin(2*g)*(.5*a+.2083333333333333*r+.08333333333333333*m+.03611111111111111*A+.01875*e+.01195601851851852*q+.008863673941798942*c-d+p-h+l*(2*(.1458333333333333*r+.1208333333333333*m+.07039930555555556*A+.03616071428571429*
e+.01839451058201058*q+.01017113095238095*c)-4*k+6*f+l*(4*d-12*p+24*h+l*(8*k-32*f+l*(16*p-80*h+l*(32*f+64*l*h))))))}for(var m=Math.sqrt(a),A=m/2,q=Math.tan(.7853981633974483+g/2),d=0,k=1,r=g;0!=k;r=c)if(e=m*Math.sin(r),c=q*Math.pow((1+e)/(1-e),A),c=2*Math.atan(c)-1.570796326794897,d++,b.W(c,r)||3E4<d)k=0;return r};return c}();a.C=c})(x||(x={}));(function(a){var b=function(){function b(b){this.Zl=this.Pt=null;this.vw=!1;this.nB=this.oB=0;this.lB=new a.b;this.yB=new a.b;this.ix=!1;this.kr=new a.h;this.II=
this.fx=0;this.gx=null;this.$k=!1;this.Fr=null;this.LA=0;this.uf=b;this.wt=a.Ib.iw(this.uf,0,!0);this.lB.$c();this.yB.$c();this.eJ=NaN;var e=b.getCode();0<e?(this.kl=e,a.Tf.getCode(b)):this.kl=a.Tf.getCode(b);0>this.kl&&(this.kl=0);var g=this.uf.getType();this.vI=g==a.Vc.PE_TYPE_PROJCS?2:1;if(g==a.Vc.PE_TYPE_PROJCS&&!b.loadConstants())throw a.g.F("PeProjcs.loadConstants failed");e=g==a.Vc.PE_TYPE_GEOGCS?this.uf:this.uf.getGeogcs();g!=a.Vc.PE_TYPE_GEOGCS&&a.Tf.getCode(e);this.Fr=b.getUnit();this.eJ=
e.getPrimem().getLongitude();this.II=b=e.getUnit().getUnitFactor();b=Math.PI/(180*b);1E-10>Math.abs(b-1)&&(b=1);this.nB=b;0!=(g&a.Vc.PE_TYPE_PROJCS)?(e=this.uf,this.oB=1/e.getUnit().getUnitFactor(),this.fx=.001/this.uf.getUnit().getUnitFactor(),this.gx=a.Bg.generate(e,a.Bg.PE_PCSINFO_OPTION_NONE),this.$k=this.gx.isPannableRectangle(),this.LA=a.Ib.rP(this.gx.getCentralMeridian(),this.nB)):(this.ix=this.$k=!0,this.oB=0,g=1/e.getUnit().getUnitFactor(),this.fx=.001/e.getDatum().getSpheroid().getAxis()*
g,this.LA=0);this.$k&&(this.dy(),this.uL(),this.vL(),this.tL(),this.jZ(),this.kZ())}b.prototype.$s=function(){return this.kl};b.prototype.Sj=function(){return this.gx};b.zz=function(a,e){return a==e?!0:null!=a&&null!=e&&0==a.kl&&0==e.kl?a.wt===e.wt:!1};b.prototype.Jc=function(){return this.$k};b.prototype.Bh=function(a){a.I(this.gp)};b.prototype.bw=function(){return this.gp.o};b.prototype.aw=function(){return this.gp.v};b.prototype.AT=function(a){a.I(this.hx)};b.prototype.jZ=function(){var b=this.uf.getType();
if(b==a.Vc.PE_TYPE_PROJCS){var b=this.uf,e=this.Sj().getCentralMeridian(),g=b.getGeogcs();if(null==g)throw a.g.X("internal error");g=1/g.getUnit().getUnitFactor()*Math.PI;e=[[e+g,0]];a.fi.geogToProj(b,1,e);var e=e[0][0],g=b.getParameters()[a.Vc.PE_PARM_X0].getValue(),c=this.Lk(),b=new a.h;c.s(b);var c=Math.abs(e-g),e=c+g,g=-1*c+g,c=b.B,b=b.A,d=new a.h;d.I(g,b,e,c);null==this.gp&&(this.gp=d)}else if(b==a.Vc.PE_TYPE_GEOGCS)g=1/this.uf.getUnit().getUnitFactor()*Math.PI,b=new a.h,b.I(-g,-g/2,g,g/2),null==
this.gp&&(this.gp=b);else throw a.g.X("internal error");};b.prototype.kZ=function(){var b=this.uf.getType();if(b==a.Vc.PE_TYPE_PROJCS){var e=this.uf,b=this.Sj().getCentralMeridian(),e=e.getGeogcs();if(null==e)throw a.g.X("internal error");var e=1/e.getUnit().getUnitFactor()*Math.PI,g=this.Vs(),c=new a.h;g.s(c);g=new a.h;g.I(b-e,c.A,b+e,c.B);null==this.hx&&(this.hx=g)}else if(b==a.Vc.PE_TYPE_GEOGCS)e=1/this.uf.getUnit().getUnitFactor()*Math.PI,b=new a.h,b.I(-e,-e/2,e,e/2),null==this.hx&&(this.hx=b);
else throw a.g.X("internal error");};b.prototype.ee=function(){return this.nB};b.prototype.bn=function(){return this.oB};b.prototype.Vs=function(){if(this.$k)return this.Zl;var a=this.Zl;if(null!=a)return a;this.dy();return this.Zl};b.prototype.Ws=function(){if(this.$k)return null;if(null!=this.Zl)return this.hI;this.dy();return this.hI};b.prototype.dy=function(){if(this.uf.getType()==a.Vc.PE_TYPE_PROJCS){var b;b=this.uf;var e=b.getGeogcs(),g=b.horizonGcsGenerate();if(null!=g){var c=g[0].getNump(),
d=g[0].getKind();b=0<g[0].getInclusive();var p=this.ee(),f=90*p,H=360*p,h=370*p,l=180*p*a.Vc.PE_HORIZON_DELTA/Math.PI,m=new a.h,A=null;if(1<c)for(var q=1;q<c;q++)if(g[q].getKind()==a.Vc.PE_HORIZON_LINE){null==A&&(A=new a.Ua);var r=g[q].getCoord();A.$x(r[0][0],r[0][1]);A.Xj(r[1][0],r[1][1])}if(d==a.Vc.PE_HORIZON_RECT)g=g[0].getCoord(),m.I(g[0][0],g[0][1]),m.Nb(g[1][0],g[1][1]),Math.abs(m.B-f)<1E-7*l&&(m.B=f),Math.abs(m.A+f)<1E-7*l&&(m.A=-f),m.N()>h&&(g=-400*p,m.I(g,m.A,g+5*H,m.B)),g=new a.ci(m),null==
this.Zl&&(this.Zl=g,this.vw=b);else{h=new a.Ja;H=this.Sj().isGcsHorizonMultiOverlap();m=a.Ou.jG(e,a.ts.Integer64);if(H){h=new a.RM;l=a.ei.local().V(h,m,null);for(q=0;q<c;q++)if(g[q].getKind()==a.Vc.PE_HORIZON_POLY){e=g[q].getSize();p=g[q].getCoord();d=[];for(f=0;f<e;f++)d[f]=a.b.pa(p[f][0],p[f][1]);g[q].getInclusive();H&&(p=new a.Ja,p.Bl(d,e-1),h.TY(p),l.Re())}h=l.next()}else for(q=0;q<c;q++)if(g[q].getKind()==a.Vc.PE_HORIZON_POLY){e=g[q].getSize();p=g[q].getCoord();H=[];for(f=0;f<e;f++)H[f]=a.b.pa(p[f][0],
p[f][1]);g[q].getInclusive();h.Bl(H,e-1)}b?a.tk.local().qo(h,m,1):a.cq.local().qo(h,m,1);a.Gj.local().qo(h,m,1);null==this.Zl&&(this.Zl=h,this.vw=b,this.hI=A)}}}};b.prototype.Uv=function(){if(this.$k)return this.vw;null==this.Zl&&this.dy();return this.vw};b.prototype.uL=function(){if(2==this.vI){var b=this.uf.horizonPcsGenerate();if(null!=b){var e=b[0].getKind();b[0].getInclusive();var g=b[0].getNump(),c=!1;if(e==a.Vc.PE_HORIZON_RECT)b=b[0].getCoord(),g=new a.h,g.I(b[0][0],b[0][1]),g.Nb(b[1][0],b[1][1]),
b=new a.ci(g);else{e=-1;for(c=0;c<g;c++)b[c].getKind()==a.Vc.PE_HORIZON_POLY&&(e=c);c=b[e].getSize()-1;b=b[e].getCoord();g=[];for(e=0;e<c;e++)g[e]=a.b.pa(b[e][0],b[e][1]);b=e=new a.Ja;e.Bl(g,c);c=!0}this.Sj().isDensificationNeeded()&&(g=1E5*this.bn(),b=a.Jm.local().V(b,g,null));c&&(c=new a.ci,b.Qn(c),b.hf(),b.Rb(),b.hT(),a.tk.local().qo(b,null,1));null==this.Pt&&(this.Pt=b)}}};b.prototype.Lk=function(){if(this.$k)return this.Pt;var a=this.Pt;if(null!=a)return a;this.uL();return this.Pt};b.prototype.vL=
function(){if(this.uf.getType()==a.Vc.PE_TYPE_PROJCS){var b=90*this.ee(),b=[[0,b],[0,-b]];a.fi.geogToProj(this.uf,2,b);var e=this.Sj(),g=e.getNorthPoleLocation()!=a.Bg.PE_POLE_OUTSIDE_BOUNDARY,e=e.getSouthPoleLocation()!=a.Bg.PE_POLE_OUTSIDE_BOUNDARY;this.ix||(g&&this.lB.ka(b[0][0],b[0][1]),e&&this.yB.ka(b[1][0],b[1][1]))}this.ix=!0};b.prototype.eA=function(a,e){this.$k||this.ix||this.vL();a?e.L(this.yB):e.L(this.lB)};b.prototype.tL=function(){if(1==this.vI){var b=400*this.ee();this.kr.I(-b,-b,b,
b)}else b=a.Bg.generate(this.uf,a.Bg.PE_PCSINFO_OPTION_DOMAIN),b=a.h.pa(b.getDomainMinx(),b.getDomainMiny(),b.getDomainMaxx(),b.getDomainMaxy()),this.kr.u()&&this.kr.I(b)};b.prototype.$S=function(a){this.$k&&a.I(this.kr);this.kr.u()&&this.tL();a.I(this.kr)};b.prototype.dn=function(){return this.eJ};b.prototype.pi=function(){return this.LA};b.prototype.Vd=function(){return this.Fr};b.prototype.Xs=function(){return this.II};return b}();a.UD=b})(x||(x={}));(function(a){var b=function(){function b(b){this.JV=
b;this.wt=a.Ib.iw(b,0,!0);var e=b.getCode();this.nt=0<e?e:a.Tf.getCode(b);0>this.nt&&(this.nt=0);this.Fr=e=this.JV.getUnit();this.XI=1/e.getUnitFactor();a.Tf.getCode(b)}b.zz=function(a,e){return a==e?!0:null!=a&&null!=e&&0==a.nt&&0==e.nt?a.wt===e.wt:!1};b.prototype.$s=function(){return this.nt};return b}();a.GN=b})(x||(x={}));(function(a){var b=function(){function b(){}b.Cb=function(b,e,g,c,d,p,f,H){if(null!=p||null!=f||null!=H){c=a.C.da(c);e=a.C.da(e);g=a.C.da(g);d=a.C.da(d);1.570796326794897<a.l.K(g)&&
(g=a.l.Ab(3.141592653589793,g)-g,e=a.C.da(e+3.141592653589793));1.570796326794897<a.l.K(d)&&(d=a.l.Ab(3.141592653589793,d)-d,c=a.C.da(c+3.141592653589793));var n=a.C.da(c-e);if(a.l.W(g,d)&&(a.l.W(e,c)||a.l.W(a.l.K(g),1.570796326794897)))null!=p&&(p.j=0),null!=f&&(f.j=0),null!=H&&(H.j=0);else{if(a.l.W(g,-d)){if(a.l.W(a.l.K(g),1.570796326794897)){null!=p&&(p.j=3.141592653589793*b);null!=f&&(f.j=0<g?a.C.da(3.141592653589793-a.C.da(c)):a.C.da(c));null!=H&&(H.j=0<g?a.C.da(c):a.C.da(3.141592653589793-a.C.da(c)));
return}if(a.l.W(a.l.K(n),3.141592653589793)){null!=p&&(p.j=3.141592653589793*b);null!=f&&(f.j=0);null!=H&&(H.j=0);return}}var k=1.570796326794897==a.l.K(g)?0:Math.cos(g),y=Math.sin(g),B=1.570796326794897==a.l.K(d)?0:Math.cos(d),F=Math.sin(d),h=1.570796326794897==a.l.K(n)?0:Math.cos(n),l=3.141592653589793==a.l.K(n)?0:Math.sin(n);if(null!=p){var m=Math.sin((d-g)/2),n=Math.sin(n/2);p.j=2*Math.asin(Math.sqrt(m*m+k*B*n*n))*b}null!=f&&(a.l.W(a.l.K(g),1.570796326794897)?f.j=0>g?c:a.C.da(3.141592653589793-
c):f.j=Math.atan2(B*l,k*F-y*B*h));null!=H&&(a.l.W(a.l.K(d),1.570796326794897)?H.j=0>d?e:a.C.da(3.141592653589793-e):(H.j=Math.atan2(k*l,F*k*h-B*y),H.j=a.C.da(H.j+3.141592653589793)))}}};b.Uf=function(b,e,g,c,d,p,f){if(null!=p||null!=f){e=a.C.da(e);g=a.C.da(g);1.570796326794897<a.l.K(g)&&(g=a.l.Ab(3.141592653589793,g)-g,e=a.C.da(e+3.141592653589793));a.l.W(a.l.K(g),1.570796326794897)&&(e=0);d=a.C.da(d);var n=a.l.W(a.l.K(d),1.570796326794897)?0:Math.cos(d),k=a.l.W(a.l.K(d),3.141592653589793)?0:Math.sin(d),
y=a.l.W(a.l.K(g),1.570796326794897)?0:Math.cos(g),B=Math.sin(g);b=c/b;c=a.l.W(a.l.K(b),1.570796326794897)?0:Math.cos(b);var F=a.l.W(a.l.K(b),3.141592653589793)?0:Math.sin(b),h=Math.asin(B*c+y*F*n);null!=f&&(f.j=h);null!=p&&(p.j=a.l.W(a.l.K(h),1.570796326794897)?a.l.W(g,-h)?0>h?d:a.C.da(3.141592653589793-d):e:a.l.W(a.l.K(g),1.570796326794897)&&a.l.W(b,3.141592653589793)?0>g?d:a.C.da(3.141592653589793-d):a.C.da(e+Math.atan2(F*k,y*c-B*F*n)))}};return b}();a.vh=b})(x||(x={}));(function(a){var b=function(){function b(){}
b.Cb=function(b,e,g,c,d,p,f,H,h){var n=new a.ea(0),k=new a.ea(0),y=[0,0,0],B=[0,0,0],F=[0,0,0],M=new a.ea(0),l=new a.ea(0),m=new a.ea(0),A=new a.ea(0),q=new a.ea(0);if(null!=f||null!=H||null!=h)if(a.l.Qi(e))a.vh.Cb(b,g,c,d,p,f,H,h);else{d=a.C.da(d);g=a.C.da(g);var r=a.C.da(d-g);if(a.l.W(c,p)&&(a.l.W(g,d)||a.l.W(a.l.K(c),1.570796326794897)))null!=f&&(f.j=0),null!=H&&(H.j=0),null!=h&&(h.j=0);else{if(a.l.W(c,-p)){if(a.l.W(a.l.K(c),1.570796326794897)){null!=f&&(f.j=2*a.C.Yg(b,e));null!=H&&(H.j=0<c?a.C.da(3.141592653589793-
a.C.da(d)):a.C.da(d));null!=h&&(h.j=0<c?a.C.da(d):a.C.da(3.141592653589793-a.C.da(d)));return}a.l.W(a.l.K(r),3.141592653589793)&&(null!=f&&(f.j=2*a.C.Yg(b,e)),null!=H&&(H.j=0),null!=h&&(h.j=0))}else if(a.l.W(a.l.K(c),1.570796326794897)||a.l.W(a.l.K(p),1.570796326794897))a.l.W(a.l.K(c),1.570796326794897)?g=d:d=g;var t=0,u;0>r&&(t=1,u=g,g=d,d=u,u=c,c=p,p=u);var r=a.C.du(e,c),v=a.C.du(e,p);if(null!=H||null!=h)a.vh.Cb(b,g,r,d,v,null,n,k),n=Math.atan2(Math.sin(n.j)*Math.cos(c-r),Math.cos(n.j)),k=Math.atan2(Math.sin(k.j)*
Math.cos(p-v),Math.cos(k.j)),0!=t&&(u=n,n=k,k=u),null!=H&&(H.j=n),null!=h&&(h.j=k);null!=f&&(a.C.Ck(1,e,c,g,0,m,A,q),y[0]=m.j,y[1]=A.j,y[2]=q.j,a.C.Ck(1,e,p,d,0,m,A,q),B[0]=m.j,B[1]=A.j,B[2]=q.j,F[0]=y[1]*B[2]-B[1]*y[2],F[1]=-(y[0]*B[2]-B[0]*y[2]),F[2]=y[0]*B[1]-B[0]*y[1],e=1-a.C.Cm(e,a.C.Nr(e,a.C.ik(e,Math.acos(F[2]/Math.sqrt(F[0]*F[0]+F[1]*F[1]+F[2]*F[2]))))),e*=2-e,H=Math.atan2(-F[1],-F[0]),F=a.C.da(H-1.570796326794897),H=a.C.da(H+1.570796326794897),F=a.l.K(a.C.da(g-F))<=a.l.K(a.C.da(g-H))?F:H,
a.vh.Cb(1,F,0,g,r,M,null,null),a.vh.Cb(1,F,0,d,v,l,null,null),3.141592653589793<M.j+l.j&&(F=a.C.da(F+3.141592653589793),a.vh.Cb(1,F,0,g,r,M,null,null),a.vh.Cb(1,F,0,d,v,l,null,null)),M.j*=a.l.Ab(1,c),l.j*=a.l.Ab(1,p),M.j=a.C.ik(e,M.j),l.j=a.C.ik(e,l.j),g=a.C.q(b,e,M.j),b=a.C.q(b,e,l.j),f.j=a.l.K(b-g))}}};b.Uf=function(b,e,g,c,d,p,f,H){var n=0,k=new a.ea(0),y=new a.ea(0),B=[0,0,0],F=[0,0,0],h=new a.ea(0),l=new a.ea(0),m=new a.ea(0);if(null!=f||null!=H)if(a.l.Qi(e))a.vh.Uf(b,g,c,d,p,f,H);else if(a.l.xd(d))null!=
f&&(f.j=g),null!=H&&(H.j=c);else{p=a.C.da(p);0>d&&(d=a.l.K(d),p=a.C.da(p+3.141592653589793));g=a.C.da(g);c=a.C.da(c);1.570796326794897<a.l.K(c)&&(g=a.C.da(g+3.141592653589793),c=a.l.Ab(3.141592653589793,c)-c);a.l.W(a.l.K(c),1.570796326794897)&&(g=0);var A;if(a.l.xd(c))A=a.l.K(1.570796326794897-a.l.K(p)),A=a.C.ik(e,A),A=1-a.C.Cm(e,a.C.Nr(e,A)),A*=2-A,b=d/a.C.Yg(b,A)*1.570796326794897,b=a.C.xp(A,b),b=a.C.du(A,b),a.vh.Uf(1,g,c,b,p,f,k),null!=H&&(n=k.j),null!=H&&(H.j=a.C.ik(e,n));else if(a.l.W(a.l.K(c),
1.570796326794897))n=a.C.Yg(b,e),k=2*n,b=a.l.Ab(1.570796326794897,c),p=0<b?a.C.da(3.141592653589793-p):p,c=n-d,a.l.K(c)<=n?null!=f&&(f.j=p):(c=Math.floor(d/k),0==a.J.truncate(c%2)?(null!=f&&(f.j=p),c=n-(d-c*k)):(null!=f&&(f.j=a.C.da(p+3.141592653589793)),c=n-((c+1)*k-d))),null!=H&&(H.j=a.C.xp(e,c/n*b));else{A=a.C.du(e,c);p=Math.atan2(Math.sin(p),Math.cos(p)*Math.cos(c-A));var q=a.J.truncate(a.l.Ab(1,A))*(1.570796326794897>=a.l.K(p)?1:-1);p=a.C.da(g+Math.atan(Math.tan(p)*-Math.sin(A)));a.vh.Cb(b,p,
0,g,A,null,y,null);A=a.l.K(1.570796326794897-a.l.K(y.j));A=a.C.ik(e,A);A=1-a.C.Cm(e,a.C.Nr(e,A));A*=2-A;a.C.Ck(1,e,0,p,0,h,l,m);B[0]=h.j;B[1]=l.j;B[2]=m.j;a.C.Ck(1,e,c,g,0,h,l,m);F[0]=h.j;F[1]=l.j;F[2]=m.j;c=Math.acos((B[0]*F[0]+B[1]*F[1]+B[2]*F[2])/Math.sqrt(F[0]*F[0]+F[1]*F[1]+F[2]*F[2]));c=a.C.ik(A,c);c=a.C.q(b,A,c)+d*q;d=0<c?y.j:a.C.da(y.j+3.141592653589793);b=a.l.K(c)/a.C.Yg(b,A)*1.570796326794897;b=a.C.xp(A,b);b=a.C.du(A,b);a.vh.Uf(1,p,0,b,d,f,k);null!=H&&(n=k.j);null!=H&&(H.j=a.C.ik(e,n))}}};
return b}();a.xl=b})(x||(x={}));(function(a){var b=function(){function b(){}b.Cb=function(b,e,g,c,d,p,f,H,h){var n=0,k=0,y=0;if(null!=f||null!=H||null!=h)if(a.l.Qi(e))a.vh.Cb(b,g,c,d,p,f,H,h);else{var B=a.C.da(d-g);if(a.l.W(c,p)&&(a.l.xd(B)||a.l.W(a.l.K(c),1.570796326794897)))null!=f&&(f.j=0),null!=H&&(H.j=0),null!=h&&(h.j=0);else{if(a.l.W(c,-p)){if(a.l.W(a.l.K(c),1.570796326794897)){null!=f&&(f.j=2*a.C.Yg(b,e));null!=H&&(H.j=0<c?a.C.da(3.141592653589793-a.C.da(d)):a.C.da(d));null!=h&&(h.j=0<c?a.C.da(d):
a.C.da(3.141592653589793-a.C.da(d)));return}a.l.W(a.l.K(B),3.141592653589793)&&(null!=f&&(f.j=2*a.C.Yg(b,e)),null!=H&&(H.j=0),null!=h&&(h.j=0))}else{if(a.l.W(a.l.K(c),1.570796326794897)||a.l.W(a.l.K(p),1.570796326794897)){a.xl.Cb(b,e,g,c,d,p,f,H,h);return}if(a.l.xd(B)||a.l.W(a.l.K(B),3.141592653589793)){a.xl.Cb(b,e,g,c,d,p,f,H,h);return}}var F=1-Math.sqrt(1-e),M=e/(1-e),l=b*(1-F);b=a.C.Nr(e,c);var m=a.C.Nr(e,p);e=1.570796326794897==a.l.K(b)?0:Math.cos(b);var A=Math.sin(b),q=1.570796326794897==a.l.K(m)?
0:Math.cos(m),r=Math.sin(m),t=B,u=Math.cos(t),v=Math.sin(t),w=1,x=0,L,z,C,D,E;do{L=t;z=Math.sqrt(Math.pow(q*v,2)+Math.pow(e*r-A*q*u,2));C=A*r+e*q*u;D=Math.atan2(z,C);if(0==z){w=0;break}E=e*q*v/z;n=Math.cos(Math.asin(E));n*=n;k=C-2*A*r/n;1<a.l.K(k)&&(k=a.l.Ab(1,k));y=k*k;t=F/16*n*(4+F*(4-3*n));t=B+(1-t)*F*E*(D+t*z*(k+t*C*(2*y-1)));u=Math.cos(t);v=Math.sin(t);x++;if(3.141592653589793<a.l.K(t)&&30<x){w=0;break}}while(5E3>=x&&!a.l.W(L,t));if(0!=w)M*=n,F=M*(256+M*(-128+M*(74-47*M)))/1024,null!=f&&(f.j=
l*(1+M*(4096+M*(-768+M*(320-175*M)))/16384)*(D-F*z*(k+F/4*(C*(2*y-1)-F/6*k*(4*z*z-3)*(4*y-3))))),null!=H&&(a.l.W(a.l.K(c),1.570796326794897)?H.j=0>c?d:a.C.da(3.141592653589793-d):H.j=Math.atan2(q*v,e*r-A*q*u)),null!=h&&(a.l.W(a.l.K(p),1.570796326794897)?h.j=0>p?g:a.C.da(3.141592653589793-g):(h.j=Math.atan2(e*v,e*r*u-A*q),h.j=a.C.da(h.j+3.141592653589793)));else{t=a.l.Ab(3.141592653589793,B);C=A*r-e*q;D=Math.acos(C);z=Math.sin(D);n=1;x=E=0;do y=E,n*=n,u=n*n,E=F*n*(1+F+F*F),k=F*F*u*(1+2.25*F),w=F*F*
F*u*n,u=1-.25*E+.1875*k-.1953125*w,E=.25*E-.25*k+.29296875*w,v=.03125*k-.05859375*w,w*=.00651041666666667,k=C-2*A*r/n,1<a.l.K(k)&&(k=a.l.Ab(1,k)),n=Math.acos(k),C=Math.cos(2*n),L=Math.cos(3*n),E=a.l.W(c,-p)?a.C.da(3.141592653589793-B)/(3.141592653589793*F*u):a.C.da(t-B)/(F*(u*D+E*z*k+v*Math.sin(2*D)*C+w*Math.sin(3*D)*L)),v=E*z/(e*q),t=1.570796326794897<a.l.K(B)?a.l.Ab(3.141592653589793,v)-Math.asin(v):Math.asin(v),u=Math.cos(t),z=Math.sqrt(Math.pow(q*v,2)+Math.pow(e*r-A*q*u,2)),D=3.141592653589793-
Math.asin(a.l.K(z)),C=Math.cos(D),n=Math.cos(Math.asin(E)),x++;while(70>=x&&!a.l.W(y,E));null!=f&&(n*=n,M*=n,u=1+M*(4096+M*(-768+M*(320-175*M)))/16384,a.l.W(c,-p)?f.j=3.141592653589793*l*u:(k=C-2*A*r/n,n=Math.acos(k),C=Math.cos(2*n),L=Math.cos(3*n),f.j=l*(u*D+M*(-512+M*(128+M*(-60+35*M)))/2048*z*k+M*(-4+5*M)/6144*M*M*Math.sin(2*D)*C+w*Math.sin(3*D)*L+-7.62939453125E-5*M*M*M*M*Math.sin(4*D)*Math.cos(4*n))));null!=H&&(a.l.xd(c)&&a.l.xd(p)?(n=Math.sqrt(1-E*E),H.j=Math.acos(n),0>B&&(H.j*=-1)):a.l.W(a.l.K(c),
1.570796326794897)?H.j=0>c?d:a.C.da(3.141592653589793-d):(f=E/e,l=Math.sqrt(1-f*f),0>e*r-A*q*Math.cos(t)&&(l*=-1),H.j=Math.atan2(f,l),a.l.W(c,-p)&&a.l.K(a.C.da(g-d))>3.141592653589793*(1-F*Math.cos(c))&&(0<c&&1.570796326794897>a.l.K(H.j)||0>c&&1.570796326794897<a.l.K(H.j))&&(H.j=a.l.Ab(3.141592653589793,H.j)-H.j)));if(null!=h)if(a.l.xd(c)&&a.l.xd(p))n=Math.sqrt(1-E*E),h.j=Math.acos(n),0<=B&&(h.j*=-1);else if(a.l.W(a.l.K(p),1.570796326794897))h.j=0>p?g:a.C.da(3.141592653589793-g);else if(B=E/q,f=Math.sqrt(1-
B*B),l=Math.sin(t/2),0>Math.sin(m-b)-2*e*r*l*l&&(f*=-1),h.j=Math.atan2(B,f),h.j=a.C.da(h.j+3.141592653589793),a.l.W(c,-p)&&!a.l.xd(c)&&!a.l.W(a.l.K(c),1.570796326794897)&&a.l.K(a.C.da(g-d))>3.141592653589793*(1-F*Math.cos(c))&&(null!=H?l=H.j:(f=E/e,l=Math.sqrt(1-f*f),0>e*r-A*q*Math.cos(t)&&(l*=-1),l=Math.atan2(f,l),a.l.W(c,-p)&&a.l.K(a.C.da(g-d))>3.141592653589793*(1-F*Math.cos(c))&&(0<c&&1.570796326794897>a.l.K(l)||0>c&&1.570796326794897<a.l.K(l))&&(l=a.l.Ab(3.141592653589793,l)-l)),1.570796326794897>=
a.l.K(l)&&1.570796326794897<a.l.K(h.j)||1.570796326794897<=a.l.K(l)&&1.570796326794897>a.l.K(h.j)))h.j=-1*a.C.da(h.j+3.141592653589793)}}}};b.Uf=function(b,e,g,c,d,p,f,H){if(null!=f||null!=H)if(a.l.Qi(e))a.vh.Uf(b,g,c,d,p,f,H);else if(p=a.C.da(p),a.l.W(a.l.K(c),1.570796326794897)||a.l.xd(p)||a.l.W(a.l.K(p),3.141592653589793))a.xl.Uf(b,e,g,c,d,p,f,H);else{var n=1.570796326794897==a.l.K(p)?0:Math.cos(p),k=3.141592653589793==a.l.K(p)?0:Math.sin(p);a.l.W(a.l.K(c),1.570796326794897)&&(g=0);p=1-Math.sqrt(1-
e);var y=a.C.Nr(e,c);c=1.570796326794897==a.l.K(y)?0:Math.cos(y);var B=Math.sin(y),y=Math.atan2(Math.tan(y),n),F=c*k,h=F*F,l=1-h,m=e/(1-e)*l;e=m*(256+m*(-128+m*(74-47*m)))/1024;var A=e/4,q=e/6,r=d/(b*(1-p)*(1+m*(4096+m*(-768+m*(320-175*m)))/16384)),t=r,u;do{u=t;d=1.570796326794897==a.l.K(t)?0:Math.cos(t);var m=3.141592653589793==a.l.K(t)?0:Math.sin(t),v=m*m;b=Math.cos(2*y+t);t=b*b;t=e*m*(b+A*(d*(2*t-1)-q*b*(4*v-3)*(4*t-3)))+r}while(!a.l.W(u,t));d=1.570796326794897==a.l.K(t)?0:Math.cos(t);m=3.141592653589793==
a.l.K(t)?0:Math.sin(t);null!=f&&(k=Math.atan2(m*k,c*d-B*m*n),l=p/16*l*(4+p*(4-3*l)),b=Math.cos(2*y+t),f.j=a.C.da(g+(k-(1-l)*p*F*(t+l*m*(b+l*d*(2*b*b-1))))));null!=H&&(l=B*m-c*d*n,l=(1-p)*Math.sqrt(h+l*l),H.j=Math.atan2(B*d+c*m*n,l))}};return b}();a.Nu=b})(x||(x={}));(function(a){var b=function(){function b(){}b.Cb=function(b,e,g,c,d,B,p,f,h){var n=a.C.da(d-g),k=a.l.W(a.l.K(c),1.570796326794897),y=a.l.W(a.l.K(B),1.570796326794897);if(a.l.W(c,B)&&(a.l.xd(n)||k))null!=p&&(p.j=0),null!=f&&(f.j=0),null!=
h&&(h.j=0);else{var F,H;a.l.Qi(e)?(F=Math.sin(c),H=Math.sin(B),F=Math.sqrt((1+F)/(1-F)),H=Math.sqrt((1+H)/(1-H)),F=Math.log(H)-Math.log(F),F=Math.atan2(n,F),null!=p&&(p.j=a.l.W(c,B)?a.l.K(b*Math.cos(c)*n):a.l.K((b*B-b*c)/Math.cos(F)))):(H=a.C.Cx(e,B),F=Math.sin(a.C.Cx(e,c)),H=Math.sin(H),F=Math.sqrt((1+F)/(1-F)),H=Math.sqrt((1+H)/(1-H)),F=Math.log(H)-Math.log(F),F=Math.atan2(n,F),null!=p&&(a.l.W(c,B)?p.j=a.l.K(b*n*Math.cos(c)/a.C.Cm(e,c)):(n=a.C.q(b,e,c),b=a.C.q(b,e,B),p.j=a.l.K((b-n)/Math.cos(F)))));
if(null!=f||null!=h)p=a.C.da(F+3.141592653589793),k&&y||!k&&!y||(k?F=0>c?d:a.C.da(3.141592653589793-d):y&&(p=0>B?g:a.C.da(3.141592653589793-g))),null!=f&&(f.j=F),null!=h&&(h.j=p)}};b.Uf=function(b,e,g,c,d,B,p,f){B=a.C.da(B);0>d&&(d=a.l.K(d),B=a.C.da(B+3.141592653589793));a.l.Qi(e)?a.l.W(a.l.K(c),1.570796326794897)?(g=0>c?B:a.C.da(3.141592653589793-B),B=d/b%6.283185307179586,3.141592653589793>=B?b=c-a.l.Ab(B,c):(g=a.C.da(g+3.141592653589793),b=-c+a.l.Ab(B-3.141592653589793,c))):a.l.W(a.l.K(B),1.570796326794897)?
(g=a.C.da(g+a.l.Ab(d,B)/(b*Math.cos(c))),b=c):(b=c+d*Math.cos(B)/b,1.570796326794897<a.l.K(b)&&(b=1.570796326794897),a.l.W(a.l.K(b),1.570796326794897)&&(a.l.xd(B)||a.l.W(a.l.K(B),3.141592653589793))||(1.570796316258184<a.l.K(b)&&(b=a.l.Ab(1.570796316258184,b)),e=Math.sin(c),c=Math.sin(b),e=Math.sqrt((1+e)/(1-e)),c=Math.sqrt((1+c)/(1-c)),e=Math.log(c)-Math.log(e),g=a.C.da(g+Math.tan(B)*e))):a.l.W(a.l.K(c),1.570796326794897)?(g=0>c?B:a.C.da(3.141592653589793-B),B=d/a.C.qX(b,e),B%=6.283185307179586,
3.141592653589793>=B?(b=c-a.l.Ab(B,c),b=a.C.xp(e,b)):(g=a.C.da(g+3.141592653589793),b=-c+a.l.Ab(B-3.141592653589793,c),b=a.C.xp(e,b))):a.l.W(a.l.K(B),1.570796326794897)?(g=a.C.da(g+a.l.Ab(d,B)*a.C.Cm(e,c)/(b*Math.cos(c))),b=c):(b=1.570796326794897*(d*Math.cos(B)+a.C.q(b,e,c))/a.C.Yg(b,e),1.570796326794897<a.l.K(b)&&(b=a.l.Ab(1.570796326794897,b)),b=a.C.xp(e,b),a.l.W(a.l.K(b),1.570796326794897)&&(a.l.xd(B)||a.l.W(a.l.K(B),3.141592653589793))||(d=a.C.Cx(e,c),c=a.C.Cx(e,b),1.570796316258184<a.l.K(c)&&
(c=a.l.Ab(1.570796316258184,b),b=a.C.CQ(e,c)),e=Math.sin(d),c=Math.sin(c),e=Math.sqrt((1+e)/(1-e)),c=Math.sqrt((1+c)/(1-c)),e=Math.log(c)-Math.log(e),g=a.C.da(g+Math.tan(B)*e)));null!=p&&(p.j=g);null!=f&&(f.j=b)};return b}();a.VD=b})(x||(x={}));(function(a){var b=function(){function b(){}b.Gz=function(b,e,g,c,d,B,p){a.Nu.Cb(b,e,g,c,d,B,null,p,null)};b.Xi=function(b,e,g,c,d,B,p,f){a.Nu.Uf(b,e,g,c,d,B,p,f)};b.Ld=function(b,e,g,c,d,B,p,f,h,l){switch(l){case 2:a.xl.Cb(b,e,g,c,d,B,p,f,h);break;case 3:a.WD.Cb(b,
e,g,c,d,B,p,f,h);break;case 1:a.VD.Cb(b,e,g,c,d,B,p,f,h);break;default:a.Nu.Cb(b,e,g,c,d,B,p,f,h)}};b.Oj=function(b,e,g,c,d,B,p,f,h){switch(h){case 2:a.xl.Uf(b,e,g,c,d,B,p,f);break;case 3:a.WD.Uf(b,e,g,c,d,B,p,f);break;case 1:a.VD.Uf(b,e,g,c,d,B,p,f);break;default:a.Nu.Uf(b,e,g,c,d,B,p,f)}};return b}();a.mb=b})(x||(x={}));(function(a){var b=function(){function e(){this.y=this.x=null}e.pa=function(g){var b=new e;b.x=new a.Xb;b.x.set(g.x);b.y=new a.Xb;b.y.set(g.y);return b};e.bG=function(g,b){var c=
new e;c.x=new a.Xb;c.x.set(g);c.y=new a.Xb;c.y.set(b);return c};e.prototype.Lg=function(){return this.x.Lg()&&this.y.Lg()};e.prototype.value=function(){return a.b.pa(this.x.value(),this.y.value())};return e}();a.IZ=b;var c=function(){function e(){this.z=this.y=this.x=null}e.pa=function(g){var b=new e;b.x=new a.Xb;b.x.set(g.x);b.y=new a.Xb;b.y.set(g.y);b.z=new a.Xb;b.z.set(g.z);return b};e.bG=function(g,b,c){var d=new e;d.x=new a.Xb;d.x.set(g);d.y=new a.Xb;d.y.set(b);d.z=new a.Xb;d.z.set(c);return d};
e.prototype.Lg=function(){return this.x.Lg()&&this.y.Lg()&&this.z.Lg()};e.prototype.value=function(){return new a.pd(this.x.value(),this.y.value(),this.z.value())};e.prototype.oi=function(e){var g=new a.Xb,b=new a.Xb,c=new a.Xb;g.pm(this.x,e.x);b.pm(this.y,e.y);c.pm(this.z,e.z);e=new a.Xb;e.cP(g,b);e.add(c);return e};e.prototype.kG=function(g){var b=new e;b.x.pm(this.y,g.z);b.y.pm(this.z,g.x);b.z.pm(this.x,g.y);var c=new a.Xb,d=new a.Xb,k=new a.Xb;c.pm(this.z,g.y);d.pm(this.x,g.z);k.pm(this.y,g.x);
b.x.sub(c);b.y.sub(d);b.z.sub(k);return b};return e}();a.JZ=c;var d=function(){function e(){}e.qO=function(a,b,c){var g=b.x;b=b.y;e.Ck(1,a,Math.cos(g),Math.sin(g),Math.cos(b),Math.sin(b),c)};e.nO=function(g,b){var c=new a.pd;e.qO(g,b,c);return c};e.HZ=function(g,b,c,d,k,p){var n=new a.pd;e.Ck(g,b,c,d,k,p,n);return n};e.Ck=function(a,e,b,c,d,k,p){a/=Math.sqrt(1-e*k*k);p.I(a*d*b,a*d*c,a*(1-e)*k)};e.Su=function(e,b){var g=new a.Xb,d=new a.Xb,n=new a.Xb,k=new a.Xb;g.cos(b.x);d.sin(b.x);n.cos(b.y);k.sin(b.y);
b=new a.Xb;b.set(k);b.Vg(k);b.yp(e);b.yp(-1);b.jP();b.sqrt();var p=new a.Xb;p.set(1);p.Wm(b);b=new a.Xb;b.set(p);b.Vg(n);b.Vg(g);g=new a.Xb;g.set(p);g.Vg(n);g.Vg(d);d=new a.Xb;d.set(p);d.yp(1-e);d.Vg(k);return c.bG(b,g,d)};e.MN=function(a,e,b){var g=e.x,c=e.y;b.ka(Math.atan2(c,g),Math.atan2(e.z,(1-a)*Math.sqrt(g*g+c*c)))};e.Y_=function(g,b,c){g=new a.b;e.MN(b,c,g);return g};e.NU=function(g,c,d,k){if(Math.abs(c.x-d.x)>Math.PI||Math.abs(c.y)>.5*Math.PI||Math.abs(d.y)>.5*Math.PI||(Math.abs(c.y)==.5*
Math.PI||Math.abs(d.y)==.5*Math.PI)&&c.x!=d.x)return NaN;k=e.SC(k,Math.min(c.x,d.x),Math.max(c.x,d.x));if(!(new a.zc(c.x,d.x)).contains(k))return NaN;var n=b.pa(c);d=b.pa(d);n=e.Su(g,n);d=e.Su(g,d);d=n.kG(d);if(d.z.Lg())return c=c.y;var y=new a.Xb;y.set(d.x);y.Wm(d.z);y.yp(-1);var p=new a.Xb;p.set(d.y);p.Wm(d.z);p.yp(-1);var B=new a.Xb;B.set(p);B.Vg(p);n=new a.Xb;n.set(y);n.Vg(y);n.add(B);n.sqrt();if(n.Lg()||y.Lg()&&p.Lg())return c=c.y;c=Math.atan2(p.value(),y.value());c=Math.atan2(n.value()*Math.cos(c-
k),1-g);k=e.nO(g,a.b.pa(k,c));g=new a.pd(k.x,k.y,-k.z);k=d.value().oi(k);g=d.value().oi(g);Math.abs(g)<Math.abs(k)&&(c=-c);return c};e.vA=function(g,c,d,k,p,f){f[0]=NaN;f[1]=NaN;if(Math.abs(d.x-k.x)>Math.PI||Math.abs(d.y)>.5*Math.PI||Math.abs(k.y)>.5*Math.PI||(Math.abs(d.y)==.5*Math.PI||Math.abs(k.y)==.5*Math.PI)&&d.x!=k.x||Math.abs(p)>=.5*Math.PI||0<d.y&&0<k.y&&d.y>p&&k.y>p||0>d.y&&0>k.y&&d.y<p&&k.y<p)return 0;var n=b.pa(d);g=b.pa(k);n=e.Su(c,n);g=e.Su(c,g);var y=n.kG(g);if(y.z.Lg())return(new a.zc(d.y,
k.y)).contains(p)?(f[0]=d.x,1):0;g=new a.Xb;g.set(y.x);g.Wm(y.z);g.yp(-1);n=new a.Xb;n.set(y.y);n.Wm(y.z);n.yp(-1);y=new a.Xb;y.set(n);y.Vg(n);var B=new a.Xb;B.set(g);B.Vg(g);B.add(y);B.sqrt();if(B.Lg()||g.Lg()&&n.Lg())return 0==p?(f[0]=d.x,f[1]=k.x,2):0;c=(1-c)*Math.tan(p)/B.value();if(1<Math.abs(c))return 0;c=Math.acos(c);y=Math.atan2(n.value(),g.value());g=Math.min(d.x,k.x);n=Math.max(d.x,k.x);k=e.SC(y-c,g,n);c=0!=p?e.SC(y+c,g,n):k;p=0;g<=k&&k<=n&&(f[p]=k,p++);c!=k&&g<=c&&c<=n&&(f[p]=c,p++,2==
p&&Math.abs(f[0]-d.x)>Math.abs(f[1]-d.x)&&(d=f[0],f[0]=f[1],f[1]=d));return p};e.SC=function(a,e,b){a>b?(e=Math.ceil((a-b)/(2*Math.PI)),a-=2*e*Math.PI):a<e&&(e=Math.ceil((e-a)/(2*Math.PI)),a+=2*e*Math.PI);return a};e.LB=function(a,e){e[0]>.5*Math.PI?(a[0]+=Math.PI,e[0]=Math.PI-e[0]):e[0]<-.5*Math.PI&&(a[0]-=Math.PI,e[0]=-Math.PI-e[0])};return e}();a.yy=d})(x||(x={}));(function(a){var b=function(){function b(){}b.UY=function(c,e){var g=8;0>g&&(g=8);var d=[0,0,0,0],k=new a.b;k.L(e);k.scale(9102==a.fb.lc(c).Vd().Cc()?
1:a.fb.lc(c).Vd().Ai/3.141592653589793*180);-180>k.x?(k.x-=k.x%360,-180>k.x&&(k.x+=360)):180<k.x&&(k.x-=k.x%360,180<k.x&&(k.x-=360));90<k.y&&(k.y=90);-90>k.y&&(k.y=-90);c=5*g;e=(c+31)/32;for(var p=-180,f=180,H=c-1,h=e-1;0<=h;h--)for(var l=H-32*h,m=Math.min(32,c-32*h),A=1;A<m;A+=2){var q=.5*(f+p);k.x>=q?(d[h]|=1<<l,p=q):f=q;l-=2;H-=2}p=-90;f=90;H=c-2;for(h=e-1;0<=h;h--)for(l=H-32*h,m=Math.min(32,c-32*h),A=0;A<m;A+=2)q=.5*(f+p),k.y>=q?(d[h]|=1<<l,p=q):f=q,l-=2,H-=2;return b.wO(d,g,g)};b.wO=function(a,
e,g){for(var b=[],c=0;c<e;c++)b[c]="";for(var d=c=0,k=0;k<e;k++){var p=a[c]>>d&31,d=d+5;if(31<d){var f=37-d,p=p&(1<<f)-1,d=d-32;c++;p|=(a[c]&(1<<d)-1)<<f}b[e-1-k]="0123456789bcdefghjkmnpqrstuvwxyz".split("")[p]}if(g>e)for(k=0;k<g-e;k++)b.push("0");else g<e&&(b.length=g);return b.join("")};return b}();a.tM=b})(x||(x={}));(function(a){var b={gcstol:[0,2E-9,1,2.241706620489156E-9,2,2.313672246530541E-9,3,8.98240164660333E-9,4,8.982433838020134E-9,5,8.982439417325895E-9,6,8.982466029667677E-9,7,8.982476760268133E-9,
8,8.982492642167149E-9,9,8.98251968292634E-9,10,8.98253685210448E-9,11,8.982546725256576E-9,12,8.982557456049832E-9,13,8.98257333682596E-9,14,8.982575482995276E-9,15,8.982578488197342E-9,16,8.982579775336987E-9,17,8.9825840676828E-9,18,8.982599090925448E-9,19,8.982605529473397E-9,20,8.982609220517402E-9,21,8.982611968030573E-9,22,8.982616260407152E-9,23,8.982620552787834E-9,24,8.982633429954492E-9,25,8.982637722351582E-9,26,8.98264416095491E-9,27,8.982646307158072E-9,28,8.982654891980968E-9,29,8.982667769246082E-9,
30,8.982674207892485E-9,31,8.982680646548117E-9,32,8.982682792768713E-9,33,8.982685798042582E-9,34,8.982689231436652E-9,35,8.98269137766135E-9,36,8.98269266624163E-9,37,8.982705114087017E-9,38,8.982706830791106E-9,39,8.982711958374661E-9,40,8.982712839964735E-9,41,8.982717991496125E-9,42,8.982721424914803E-9,43,8.982723571154887E-9,44,8.982727863638127E-9,45,8.982730868942154E-9,46,8.982734302370678E-9,47,8.982745033612112E-9,48,8.982751472369276E-9,49,8.982755764879183E-9,50,8.982762203651733E-9,
51,8.982764776628385E-9,52,8.982766496171896E-9,53,8.98277722749025E-9,54,8.98278152002477E-9,55,8.98279933943848E-9,56,8.9829143024805E-9,57,8.982922161948598E-9,58,8.98292327314211E-9,59,8.982925667349601E-9,60,8.982932222965576E-9,61,8.982961298941316E-9,62,8.982965524049989E-9,63,8.982994818246099E-9,64,8.982994895706967E-9,65,8.98299489597736E-9,66,8.983000733443498E-9,67,8.983055097289157E-9,68,8.983064111047368E-9,69,8.983111996941178E-9,70,8.983120447446023E-9,71,8.98312748954554E-9,72,8.983134531656096E-9,
73,8.983141573777694E-9,74,8.983148615910332E-9,75,8.983152841195215E-9,76,8.983153545409748E-9,77,8.983153827095593E-9,78,8.98315396793852E-9,79,8.983154249624393E-9,80,8.983155658054012E-9,81,8.983960794340072E-9,82,8.984061344391998E-9,83,8.984072829255685E-9,84,8.984194981201908E-9,85,8.984275233099427E-9,86,8.984326127007554E-9,87,8.984330099816539E-9,88,8.98433275258421E-9,89,8.984333047023206E-9,90,8.984333885258723E-9,91,8.984337959508212E-9,92,8.984365176209457E-9,93,8.984727360418079E-9,
94,8.984901041679577E-9,95,8.98542662091587E-9,96,8.98610024130669E-9,97,8.992894229037531E-9,98,8.993203677616635E-9,99,8.993206178094346E-9,100,8.993216059187305E-9,101,8.99322029394808E-9,102,8.994627867045891E-9,103,9.467559984315793E-9,104,9.46881168618118E-9,105,9.980888154931644E-9,106,9.981105353606775E-9,107,9.983807356573187E-9,108,1.687060485811522E-8,109,1.688447560354875E-8,110,2.176606011487185E-8,111,2.225078816042032E-8,112,2.348476432064694E-8,113,2.348765250187846E-8,114,2.378108974103778E-8,
115,3.14559636297708E-8,116,3.297788621680806E-8,117,3.667892343788279E-8,118,4.235973644320739E-8,119,4.794625900676345E-8,120,7.262742998235812E-8,121,7.499447580246377E-8,122,7.525056410964318E-8,123,7.979913581209237E-8,124,9.662020153976783E-8,125,9.799175562353741E-8,126,9.897353517547472E-8,127,1.02313891987647E-7,128,1.081460541960784E-7,129,1.21905913857622E-7,130,2.246893314238523E-7,131,2.297344808062643E-7,132,2.42984645941825E-7,133,2.754604784282804E-7,134,2.884548130346993E-7,135,3.370339971357784E-7,
136,4.307953346848296E-7,137,5.208707228462029E-7,138,5.509209568565608E-7,139,6.452227422644406E-7,140,6.740679942715567E-7,141,6.861770001566745E-7,142,7.252630318111686E-7,143,7.441010326374328E-7,144,7.742672907173287E-7,145,9.629542775307953E-7,146,1.061032953945969E-6,147,1.143628333594458E-6,148,1.162186197019925E-6,149,1.36418522650196E-6,150,1.367441038498385E-6,151,1.432394487827058E-6,152,1.736235742820677E-6,153,1.848250952034914E-6,154,1.909859317102744E-6,155,1.975716534933873E-6,156,
2.122065907891938E-6,157,2.72837045300392E-6,158,3.183098861837907E-6,159,3.580986219567645E-6,160,3.819718634205488E-6,161,4.09255567950588E-6,162,4.407367654852486E-6,163,4.774648292756861E-6,164,5.161781938115525E-6,165,5.20870722846203E-6,166,5.729577951308232E-6,167,6.031134685587613E-6,168,6.987290184522236E-6,169,9.241254760174569E-6,170,1.145915590261646E-5],pcstol:[0,6.666666666666667E-9,1,2E-8,2,4.970973863636364E-5,3,4.970978156565657E-5,4,4.970980410559237E-5,5,.001,6,.001093615055555556,
7,.001093615194444445,8,.001093619003239988,9,.001093623110088878,10,.003280833333333333,11,.003280839895013123,12,.003280843014596366,13,.003280845583333334,14,.003280869330266636,15,.00497101413676763],newtoold:[2154,102110,2195,102200,2204,32036,2205,26979,2225,102641,2226,102642,2227,102643,2228,102644,2229,102645,2230,102646,2231,102653,2232,102654,2233,102655,2234,102656,2235,102657,2236,102658,2237,102659,2238,102660,2239,102666,2240,102667,2241,102668,2242,102669,2243,102670,2246,102679,2247,
102680,2248,102685,2249,102686,2250,102687,2254,102694,2255,102695,2257,102712,2258,102713,2259,102714,2260,102715,2261,102716,2262,102717,2263,102718,2264,102719,2267,102724,2268,102725,2271,102728,2272,102729,2274,102736,2275,102737,2276,102738,2277,102739,2278,102740,2279,102741,2283,102746,2284,102747,2285,102748,2286,102749,2287,102752,2288,102753,2289,102754,2312,23433,2326,102140,2395,2091,2396,2092,2397,2166,2398,2167,2399,2168,2759,102229,2760,102230,2761,102248,2762,102249,2763,102250,2764,
102251,2765,102252,2766,102241,2767,102242,2768,102243,2769,102244,2770,102245,2771,102246,2772,102253,2773,102254,2774,102255,2775,102256,2776,102257,2777,102258,2778,102259,2779,102260,2780,102266,2781,102267,2782,102261,2783,102262,2784,102263,2785,102264,2786,102265,2787,102268,2788,102269,2789,102270,2790,102271,2791,102272,2792,102273,2793,102274,2794,102275,2795,102276,2796,102277,2797,102278,2798,102279,2799,102280,2800,102281,2801,102282,2802,102283,2803,102284,2804,102285,2805,102286,2806,
102287,2807,102288,2808,102289,2809,102290,2810,102291,2811,102292,2812,102293,2813,102294,2814,102295,2815,102296,2816,102297,2817,102298,2818,102300,2819,102304,2820,102307,2821,102308,2822,102309,2823,102310,2824,102311,2825,102312,2826,102313,2827,102314,2828,102315,2829,102316,2830,102317,2831,102318,2832,102320,2833,102321,2834,102322,2835,102323,2836,102324,2837,102325,2838,102326,2839,102327,2840,102330,2841,102334,2842,102335,2843,102336,2844,102337,2845,102338,2846,102339,2847,102340,2848,
102341,2849,102342,2850,102343,2851,102344,2852,102345,2853,102346,2854,102347,2855,102348,2856,102349,2857,102350,2858,102351,2859,102352,2860,102353,2861,102354,2862,102355,2863,102356,2864,102357,2865,102358,2866,102361,2942,102167,2943,102169,2944,2139,2945,2140,2946,2141,2947,2142,2948,2143,2949,2144,2950,2145,2951,2146,2952,2147,2953,2036,2954,2291,2955,2153,2956,2152,2957,2151,2958,2150,2959,2149,2960,2037,2961,2038,2962,2148,2965,2244,2966,2245,3003,102091,3004,102092,3005,102190,3060,2982,
3067,102139,3072,102606,3074,102608,3075,102208,3077,102210,3078,102123,3080,102119,3081,102603,3082,102602,3083,102601,3088,65163,3089,102763,3090,102363,3092,102151,3093,102152,3094,102153,3095,102154,3096,102155,3097,102145,3098,102146,3099,102147,3100,102148,3101,102149,3102,2155,3107,102172,3110,102170,3111,102171,3119,2214,3158,102234,3159,102235,3160,102236,3336,2979,3338,102006,3346,2600,3370,102126,3371,102127,3372,102130,3373,102131,3389,2577,3390,2694,3400,102184,3401,102185,3404,3359,
3407,3366,3417,102675,3418,102676,3419,102677,3420,102678,3421,102707,3422,102708,3423,102709,3424,102711,3433,102651,3434,102652,3435,102671,3436,102672,3437,102710,3438,102730,3448,102095,3451,102681,3452,102682,3455,102735,3461,2063,3462,2064,3463,3073,3464,3076,3560,102742,3566,102743,3567,102744,3734,102722,3735,102723,3736,102755,3737,102756,3738,102757,3739,102758,3741,102205,3742,102206,3743,102207,3748,102211,3750,102202,3751,102203,3759,102663,3760,102463,3764,102112,3770,102090,3771,102180,
3772,102181,3773,102182,3775,102186,3776,102187,3777,102188,3800,102183,3801,102189,3812,102199,3814,102609,3815,102469,3819,104990,3821,104136,3824,104137,3825,102444,3826,102443,3827,102442,3828,102441,3857,102100,3889,104991,3906,104992,4048,103201,4049,103202,4050,103203,4051,103204,4056,103205,4057,103206,4058,103207,4059,103208,4060,103209,4061,103210,4062,103211,4063,103212,4071,103213,4082,103214,4083,103215,4093,103216,4094,103217,4095,103218,4096,103219,4167,104108,4169,37252,4171,104107,
4189,104110,4197,4234,4223,37223,4304,104304,4414,102201,4415,102762,4417,102764,4434,102765,4437,102647,4455,32029,4456,32018,4457,3454,4462,102439,4463,4466,4470,4469,4484,103794,4485,103795,4486,103796,4487,103797,4488,103798,4489,103799,4611,104104,4612,104111,4613,37255,4615,37247,4616,37250,4617,4140,4618,4291,4620,37211,4626,37235,4647,102362,4658,37204,4668,37201,4669,4126,4672,37217,4673,104125,4675,37220,4684,37232,4698,4631,4707,37213,4708,37231,4709,37212,4710,37238,4711,37214,4712,37237,
4713,37208,4714,37215,4715,37253,4716,37216,4717,37239,4719,37219,4722,37242,4724,37233,4725,37222,4727,37224,4728,37246,4729,37226,4730,37227,4731,37228,4732,37229,4733,37230,4734,37251,4735,37259,4736,37254,4739,37205,4758,104133,4760,37001,4762,104114,4826,102214,5013,104142,5014,102331,5015,102332,5016,102333,5173,102085,5174,102086,5175,102087,5176,102088,5177,102089,5178,102040,5179,102080,5185,102081,5186,102082,5187,102083,5188,102084,5221,102066,5246,104100,5247,102490,5324,104144,5325,102420,
5329,2934,5365,104143,5367,102305,5451,104132,5513,102065,5514,102067,5519,102111,5520,31461,5646,102745,5839,5388,5858,5532,5879,4474,6207,104256,6244,102769,6245,102790,6246,102770,6247,102771,6248,102793,6249,102796,6250,102772,6251,102788,6252,102775,6253,102795,6254,102781,6255,102767,6256,102774,6257,102768,6258,102797,6259,102789,6260,102780,6261,102783,6262,102787,6263,102791,6264,102777,6265,102798,6266,102779,6267,102784,6268,102792,6269,102782,6270,102785,6271,102794,6272,102773,6273,102778,
6274,102786,6275,102776,6311,104141,6318,104145,6322,104287,6325,104286,6328,102046,6329,102047,6330,102048,6331,102049,6332,102050,6333,102051,6334,102052,6335,102053,6336,102054,6337,102055,6338,102056,6339,102057,6340,102058,6341,102059,6342,102382,6343,102383,6344,102384,6345,102385,6346,102386,6347,102387,6348,102388,6350,102965,6355,102975,6356,102976,6391,6141,6393,102966,6394,102977,6395,102978,6396,102979,6397,102980,6398,102981,6399,102982,6400,102983,6401,102984,6402,102985,6403,102986,
6404,102988,6405,102991,6406,102987,6407,102990,6408,102989,6409,102992,6410,102993,6411,102995,6412,102994,6413,102996,6414,102962,6415,102997,6416,103003,6417,102998,6418,103004,6419,102999,6420,103005,6421,103E3,6422,103006,6423,103001,6424,103007,6425,103002,6426,103008,6427,103010,6428,103013,6429,103009,6430,103012,6431,103011,6432,103014,6433,103015,6434,103016,6435,103017,6436,103018,6437,103019,6438,103022,6439,102967,6440,103021,6441,103024,6442,103020,6443,103023,6444,103025,6445,103027,
6446,103026,6447,103028,6448,103030,6449,103033,6450,103029,6451,103032,6452,103031,6453,103034,6454,103035,6455,103037,6456,103036,6457,103038,6458,103039,6459,103041,6460,103040,6461,103042,6462,103043,6463,103045,6464,103044,6465,103046,6466,103047,6467,103049,6468,103048,6469,103050,6470,103051,6471,103052,6472,103053,6473,103054,6474,103055,6475,103056,6476,103057,6477,103059,6478,103058,6479,103060,6480,103066,6481,103065,6482,103067,6483,103061,6484,103063,6485,103062,6486,103064,6487,103068,
6488,103069,6489,103071,6490,103073,6491,103070,6492,103072,6493,103075,6494,103078,6495,103074,6496,103077,6497,102968,6498,103076,6499,103079,6500,103081,6501,103084,6502,103080,6503,103083,6504,103082,6505,103085,6506,103086,6507,103088,6508,102963,6509,103087,6510,103089,6511,103091,6512,103090,6513,103092,6514,103093,6515,103094,6516,103095,6518,103098,6519,103101,6520,103097,6521,103100,6522,103099,6523,103102,6524,103103,6525,103104,6526,103105,6527,103106,6528,103108,6529,103111,6530,103107,
6531,103110,6532,103109,6533,103112,6534,103114,6535,103118,6536,103113,6537,103117,6538,103116,6539,103120,6540,103115,6541,103119,6542,103121,6543,103122,6544,103123,6545,103125,6546,103124,6547,103126,6548,103127,6549,103129,6550,103128,6551,103130,6552,103131,6553,103133,6554,103132,6555,103134,6556,102969,6557,102970,6558,103135,6559,103137,6560,103136,6561,103138,6562,103139,6563,103140,6564,103141,6565,103142,6566,103200,6567,103143,6568,103144,6569,103145,6570,103146,6571,103147,6572,103149,
6573,103148,6574,103150,6575,103151,6576,103152,6577,103155,6578,103160,6579,102971,6580,102972,6581,103153,6582,103158,6583,103154,6584,103159,6585,103157,6586,103162,6587,103156,6588,103161,6589,103172,6590,103173,6592,103174,6593,103176,6594,103175,6595,103177,6596,103178,6597,103180,6598,103179,6599,103181,6600,103182,6601,103184,6602,103183,6603,103185,6605,103190,6606,103186,6607,103189,6608,103188,6609,103191,6610,102973,6611,103192,6612,103196,6613,103193,6614,103197,6615,103195,6616,103199,
6617,103194,6618,103198,6619,103164,6620,103163,6621,103165,6625,103170,6626,103169,6627,103171,6628,102520,6629,102521,6630,102522,6631,102523,6632,102524,6633,102527,6634,102493,6635,102494,6636,102496,6637,102495,6668,104020,6669,102610,6670,102611,6671,102612,6672,102613,6673,102614,6674,102615,6675,102616,6676,102617,6677,102618,6678,102619,6679,102620,6680,102621,6681,102622,6682,102623,6683,102624,6684,102625,6685,102626,6686,102627,6687,102628,6688,102593,6689,102594,6690,102595,6691,102596,
6692,102597,6783,104223,6784,102530,6785,102500,6788,102532,6789,102502,6792,102533,6793,102503,6796,102531,6797,102501,6800,102534,6801,102504,6804,102535,6805,102505,6808,102536,6809,102506,6812,102537,6813,102507,6816,102538,6817,102508,6820,102539,6821,102509,6824,102540,6825,102510,6828,102541,6829,102511,6832,102542,6833,102512,6836,102543,6837,102513,6840,102544,6841,102514,6844,102546,6845,102516,6848,102545,6849,102515,6852,102547,6853,102517,6856,102548,6857,102518,6860,102549,6861,102519,
6867,102380,6868,102381,6879,103187,6880,103096,6884,102376,6885,102378,6886,102377,6887,102379,7136,6980,7139,6987,7142,102706,7692,102557,7693,102558,7694,102559,7695,102560,7696,102561,8090,103318,8091,103418,8092,103317,8093,103417,8095,103371,8096,103471,8097,103369,8098,103469,8099,103368,8100,103468,8101,103367,8102,103467,8103,103366,8104,103466,8105,103365,8106,103465,8107,103364,8108,103464,8109,103363,8110,103463,8111,103362,8112,103462,8113,103361,8114,103461,8115,103360,8116,103460,8117,
103359,8118,103459,8119,103357,8120,103457,8121,103356,8122,103456,8123,103355,8124,103455,8125,103354,8126,103454,8127,103353,8128,103453,8129,103352,8130,103452,8131,103350,8132,103450,8133,103349,8134,103449,8135,103348,8136,103448,8139,103343,8140,103443,8141,103342,8142,103442,8143,103341,8144,103441,8145,103339,8146,103439,8147,103337,8148,103437,8149,103336,8150,103436,8151,103334,8152,103434,8153,103333,8154,103433,8155,103331,8156,103431,8161,103326,8162,103426,8163,103325,8164,103425,8165,
103324,8166,103424,8171,103321,8172,103421,8173,103320,8177,103420,8179,103316,8180,103416,8181,103315,8182,103415,8184,103314,8185,103414,8191,103312,8193,103412,8196,103311,8197,103411,8198,103310,8200,103410,8201,103309,8202,103409,8203,103308,8204,103408,8207,103306,8208,103406,8209,103305,8210,103405,8212,103304,8213,103404,8214,103303,8216,103403,8218,103302,8220,103402,8222,103301,8224,103401,8431,104248,8441,102590,8693,102449,8826,102605,8857,54035,8858,54036,8859,54037,8860,8449,8988,104115,
8989,104116,8990,104117,8991,104118,8992,104119,8993,104120,8994,104121,8995,104122,8996,104123,8997,104124,8998,104896,8999,104257,9E3,104019,9014,104010,9019,104021,9053,104011,9054,104012,9055,104013,9056,104014,9057,104015,9059,104258,9060,104179,9061,104180,9062,104181,9063,104182,9064,104183,9065,104184,9066,104185,9067,104186,21896,21891,21897,21892,21898,21893,21899,21894,26701,102124,26702,102125,26799,26747,26847,102683,26848,102684,26849,102691,26850,102692,26851,102693,26852,102704,26853,
102750,26854,102751,26857,102466,26858,102467,26859,102468,26901,102128,26902,102129,27493,27492,29101,29100,29168,29118,29169,29119,29170,29120,29171,29121,29172,29122,29187,29177,29188,29178,29189,29179,29190,29180,29191,29181,29192,29182,29193,29183,29194,29184,29195,29185,29902,29900,31279,31278,31281,31291,31282,31292,31283,31293,31284,31294,31285,31295,31286,31296,31287,31297,31466,31462,31467,31463,31468,31464,31469,31465,31986,31917,31987,31918,31988,31919,31989,31920,31990,31921,31991,31922,
32064,32074,32065,32075,32066,32076,32067,32077,102550,2181,102551,2182,102552,2183,102553,2184,102554,2185,102555,2186,102556,2187],pcsid:[2066,15,2136,12,2155,10,2157,5,2158,5,2159,12,2160,12,2219,5,2220,5,2244,10,2245,10,2256,11,2265,11,2266,11,2269,11,2270,11,2273,11,2290,5,2291,5,2294,5,2295,5,2313,5,2314,14,2899,10,2900,10,2901,11,2909,11,2910,11,2911,10,2912,10,2913,11,2914,11,2964,10,2967,10,2968,10,2991,5,2992,11,2993,5,2994,11,3073,5,3076,5,3079,5,3091,10,3106,5,3108,5,3109,5,3141,5,3142,
5,3167,4,3337,5,3347,5,3348,5,3359,10,3360,5,3361,11,3362,5,3363,10,3364,5,3365,10,3366,14,3402,5,3403,5,3405,5,3406,5,3439,5,3440,5,3447,5,3449,5,3450,5,3453,10,3454,10,3460,5,3479,11,3480,5,3481,11,3482,5,3483,11,3484,5,3485,10,3486,5,3487,10,3488,5,3489,5,3490,10,3491,5,3492,10,3493,5,3494,10,3495,5,3496,10,3497,5,3498,10,3499,5,3500,10,3501,5,3502,10,3503,5,3504,10,3505,5,3506,10,3507,5,3508,10,3509,5,3510,10,3511,5,3512,10,3513,5,3514,5,3515,10,3516,5,3517,10,3518,5,3519,10,3520,5,3521,10,3522,
5,3523,10,3524,5,3525,10,3526,5,3527,10,3528,5,3529,10,3530,5,3531,10,3532,5,3533,10,3534,5,3535,10,3536,5,3537,10,3538,5,3539,10,3540,5,3541,10,3542,5,3543,10,3544,5,3545,10,3546,5,3547,10,3548,5,3549,10,3550,5,3551,10,3552,5,3553,10,3582,10,3583,5,3584,10,3585,5,3586,10,3587,5,3588,11,3589,5,3590,11,3591,5,3592,5,3593,11,3598,10,3599,5,3600,10,3605,11,3606,5,3607,5,3608,10,3609,5,3610,10,3611,5,3612,10,3613,5,3614,10,3615,5,3616,10,3617,5,3618,10,3619,5,3620,10,3621,5,3622,10,3623,5,3624,10,3625,
5,3626,10,3627,5,3628,10,3629,5,3630,10,3631,5,3632,10,3633,5,3634,11,3635,5,3636,11,3640,10,3641,5,3642,10,3643,5,3644,11,3645,5,3646,11,3647,5,3648,11,3649,5,3650,10,3651,5,3652,10,3653,5,3654,10,3655,5,3656,11,3657,5,3658,10,3659,5,3660,10,3661,5,3662,10,3663,5,3664,10,3668,10,3669,5,3670,10,3671,5,3672,10,3673,5,3674,10,3675,5,3676,11,3677,10,3678,5,3679,11,3680,10,3681,5,3682,11,3683,10,3684,5,3685,5,3686,10,3687,5,3688,10,3689,5,3690,10,3691,5,3692,10,3696,10,3697,5,3698,10,3699,5,3700,10,3740,
5,3749,5,3783,5,3784,5,3793,5,3794,5,3802,5,3816,5,3829,5,3854,5,3911,5,3912,5,3920,5,3978,5,3979,5,3991,10,3992,10,4026,5,4037,5,4038,5,4087,5,4088,5,4217,10,4438,10,4439,10,4467,5,4471,5,4474,5,4559,5,4822,5,4839,5,5018,5,5048,5,5167,5,5168,5,5223,5,5234,5,5235,5,5243,5,5266,5,5316,5,5320,5,5321,5,5330,5,5331,5,5337,5,5361,5,5362,5,5382,5,5383,5,5396,5,5456,5,5457,5,5469,5,5472,9,5490,5,5518,5,5523,5,5559,5,5588,11,5589,14,5596,5,5627,5,5629,5,5641,5,5643,5,5644,5,5654,10,5655,10,5659,5,5700,5,
5825,5,5836,5,5837,5,5842,5,5844,5,5880,5,5887,5,5890,5,6128,11,6129,11,6141,11,6204,5,6210,5,6211,5,6307,5,6312,5,6316,5,6362,5,6591,5,6646,5,6703,5,6786,5,6787,11,6790,5,6791,11,6794,5,6795,11,6798,5,6799,11,6802,5,6803,11,6806,5,6807,11,6810,5,6811,11,6814,5,6815,11,6818,5,6819,11,6822,5,6823,11,6826,5,6827,11,6830,5,6831,11,6834,5,6835,11,6838,5,6839,11,6842,5,6843,11,6846,5,6847,11,6850,5,6851,11,6854,5,6855,11,6858,5,6859,11,6862,5,6863,11,6870,5,6875,5,6876,5,6915,5,6922,5,6923,10,6924,5,6925,
10,6962,5,6984,5,6991,5,7128,10,7131,5,7132,10,7257,5,7258,10,7259,5,7260,10,7261,5,7262,10,7263,5,7264,10,7265,5,7266,10,7267,5,7268,10,7269,5,7270,10,7271,5,7272,10,7273,5,7274,10,7275,5,7276,10,7277,5,7278,10,7279,5,7280,10,7281,5,7282,10,7283,5,7284,10,7285,5,7286,10,7287,5,7288,10,7289,5,7290,10,7291,5,7292,10,7293,5,7294,10,7295,5,7296,10,7297,5,7298,10,7299,5,7300,10,7301,5,7302,10,7303,5,7304,10,7305,5,7306,10,7307,5,7308,10,7309,5,7310,10,7311,5,7312,10,7313,5,7314,10,7315,5,7316,10,7317,
5,7318,10,7319,5,7320,10,7321,5,7322,10,7323,5,7324,10,7325,5,7326,10,7327,5,7328,10,7329,5,7330,10,7331,5,7332,10,7333,5,7334,10,7335,5,7336,10,7337,5,7338,10,7339,5,7340,10,7341,5,7342,10,7343,5,7344,10,7345,5,7346,10,7347,5,7348,10,7349,5,7350,10,7351,5,7352,10,7353,5,7354,10,7355,5,7356,10,7357,5,7358,10,7359,5,7360,10,7361,5,7362,10,7363,5,7364,10,7365,5,7366,10,7367,5,7368,10,7369,5,7370,10,7877,5,7878,5,7882,5,7883,5,7887,5,7899,5,7991,5,7992,5,8035,10,8036,10,8058,5,8059,5,8082,5,8083,5,8088,
5,8137,5,8138,10,8157,5,8158,10,8159,5,8160,10,8167,5,8168,10,8169,5,8170,10,8187,5,8189,10,8205,5,8206,10,8225,5,8226,10,8311,5,8312,11,8313,5,8314,11,8315,5,8316,11,8317,5,8318,11,8319,5,8320,11,8321,5,8322,11,8323,5,8324,11,8325,5,8326,11,8327,5,8328,11,8329,5,8330,11,8331,5,8332,11,8333,5,8334,11,8335,5,8336,11,8337,5,8338,11,8339,5,8340,11,8341,5,8342,11,8343,5,8344,11,8345,5,8346,11,8347,5,8348,11,8352,5,8353,5,8379,5,8380,10,8381,5,8382,10,8383,5,8384,10,8385,5,8387,10,8391,5,8395,5,8433,5,
8455,5,8456,5,8531,10,8682,5,8687,5,8692,5,8903,5,8950,5,8951,5,9039,5,9040,5,9141,5,9149,5,9150,5,9191,5,9221,5,9222,5,20499,5,20538,5,20539,5,20790,5,20791,5,21291,5,21292,5,21500,5,21817,5,21818,5,22032,5,22033,5,22091,5,22092,5,22332,5,22391,5,22392,5,22700,5,22770,5,22780,5,22832,5,23090,5,23095,5,23239,5,23240,5,23433,5,23700,5,24047,5,24048,5,24100,14,24200,5,24305,5,24306,5,24382,6,24383,5,24500,5,24547,5,24548,5,24571,2,24600,5,25E3,5,25231,5,25884,5,25932,5,26237,5,26331,5,26332,5,26591,
5,26592,5,26632,5,26692,5,26855,10,26856,10,27120,5,27200,5,27291,7,27292,7,27429,5,27492,5,27500,5,27700,5,28232,5,28600,5,28991,5,28992,5,29100,5,29220,5,29221,5,29333,5,29635,5,29636,5,29701,5,29738,5,29739,5,29849,5,29850,5,29871,3,29872,13,29873,5,29900,5,29901,5,29903,5,30200,15,30339,5,30340,5,30791,5,30792,5,31028,5,31121,5,31154,5,31170,5,31171,5,31370,5,31528,5,31529,5,31600,5,31700,5,31838,5,31839,5,31901,5,32061,5,32062,5,32098,5,32099,10,32100,5,32104,5,32161,5,32766,5,53048,5,53049,
5,54090,5,54091,5,65061,10,65062,10,65161,5,65163,5,102041,10,102064,8,102068,1,102069,0,102118,10,102119,11,102120,10,102121,10,102217,10,102218,5,102219,10,102220,10,102378,11,102379,11,102380,5,102381,11,102498,5,102499,5,102589,10,102590,5,102599,10,102600,10,102604,10,102605,5,102606,5,102647,5,102704,10,102705,10,102706,5,102733,10,102761,10,102762,5,102763,10,102764,5,102765,5,102766,10,102962,5,102963,5,102970,11,102974,10,102993,5,102994,5,102995,10,102996,10,103015,5,103016,10,103017,5,
103018,10,103025,5,103026,5,103027,10,103028,10,103035,5,103036,5,103037,10,103038,10,103039,5,103040,5,103041,10,103042,10,103043,5,103044,5,103045,10,103046,10,103047,5,103048,5,103049,10,103050,10,103051,5,103052,10,103053,5,103054,10,103055,5,103056,10,103057,5,103058,5,103059,10,103060,10,103061,5,103062,5,103063,10,103064,10,103069,10,103070,5,103071,5,103072,10,103073,10,103086,5,103087,5,103088,10,103089,10,103094,11,103095,5,103096,10,103103,5,103104,10,103105,5,103106,10,103121,5,103122,
10,103123,5,103124,5,103125,11,103126,11,103127,5,103128,5,103129,10,103130,10,103131,5,103132,5,103133,10,103134,10,103135,5,103136,5,103137,11,103138,11,103139,5,103140,10,103141,5,103142,10,103143,5,103144,10,103145,5,103146,11,103147,5,103148,5,103149,10,103150,10,103151,5,103152,10,103172,5,103173,10,103174,5,103175,5,103176,10,103177,10,103178,5,103179,5,103180,10,103181,10,103182,5,103183,5,103184,10,103185,10,103228,5,103229,5,103230,10,103231,10,103250,5,103251,10,103252,5,103253,10,103260,
5,103261,5,103262,10,103263,10,103270,5,103271,5,103272,10,103273,10,103274,5,103275,5,103276,10,103277,10,103278,5,103279,5,103280,10,103281,10,103282,5,103283,5,103284,10,103285,10,103286,5,103287,10,103288,5,103289,10,103290,5,103291,10,103292,5,103293,5,103294,10,103295,10,103296,5,103297,5,103298,10,103299,10,103376,10,103377,5,103378,5,103379,10,103380,10,103393,5,103394,5,103395,10,103396,10,103472,5,103473,11,103474,5,103475,10,103482,5,103483,10,103484,5,103485,10,103500,5,103501,10,103502,
5,103503,5,103504,11,103505,11,103506,5,103507,5,103508,10,103509,10,103510,5,103511,5,103512,10,103513,10,103514,5,103515,10,103516,5,103517,10,103518,5,103519,10,103520,5,103521,11,103522,5,103523,5,103524,10,103525,10,103526,5,103527,10,103561,10,103562,10,103563,5,103564,5,103565,10,103566,10,103567,5,103568,5,103569,10,103570,10,103585,10,103586,5,103587,10,103588,11,103589,5,103590,10,103591,11,103592,5,103593,10,103594,11,103695,10,103846,5,103946,10],pcsidc:[[2E3,2045,5],[2056,2065,5],[2067,
2135,5],[2137,2153,5],[2161,2170,5],[2172,2193,5],[2196,2198,5],[2200,2203,5],[2206,2217,5],[2222,2224,11],[2251,2253,11],[2280,2282,11],[2308,2311,5],[2315,2325,5],[2327,2394,5],[2400,2491,5],[2494,2758,5],[2867,2869,11],[2870,2888,10],[2891,2895,10],[2896,2898,11],[2902,2908,10],[2915,2920,10],[2921,2923,11],[2924,2930,10],[2931,2941,5],[2969,2973,5],[2975,2982,5],[2984,2988,5],[2995,3002,5],[3006,3051,5],[3054,3059,5],[3061,3066,5],[3068,3071,5],[3084,3087,5],[3112,3118,5],[3120,3138,5],[3146,
3151,5],[3153,3157,5],[3161,3166,5],[3168,3172,5],[3174,3203,5],[3294,3313,5],[3315,3335,5],[3339,3345,5],[3350,3358,5],[3367,3369,5],[3374,3388,5],[3391,3399,5],[3408,3416,5],[3425,3432,10],[3441,3446,10],[3456,3459,10],[3465,3478,5],[3554,3559,5],[3561,3565,10],[3568,3570,10],[3571,3581,5],[3594,3597,5],[3601,3604,5],[3637,3639,5],[3665,3667,5],[3693,3695,5],[3701,3727,5],[3728,3733,10],[3744,3747,5],[3753,3758,10],[3761,3763,5],[3765,3769,5],[3779,3781,5],[3788,3791,5],[3797,3799,5],[3832,3841,
5],[3844,3852,5],[3873,3885,5],[3890,3893,5],[3942,3950,5],[3968,3970,5],[3973,3976,5],[3986,3989,5],[3994,3997,5],[4390,4398,5],[4399,4413,10],[4418,4433,10],[4491,4554,5],[4568,4589,5],[4652,4656,5],[4766,4800,5],[5069,5072,5],[5105,5130,5],[5180,5184,5],[5253,5259,5],[5269,5275,5],[5292,5311,5],[5343,5349,5],[5355,5357,5],[5387,5389,5],[5459,5463,5],[5479,5482,5],[5530,5539,5],[5550,5552,5],[5562,5583,5],[5623,5625,10],[5631,5639,5],[5649,5653,5],[5663,5680,5],[5682,5685,5],[5875,5877,5],[5896,
5899,5],[5921,5940,5],[6050,6125,5],[6351,6354,5],[6366,6372,5],[6381,6387,5],[6622,6624,5],[6707,6709,5],[6720,6723,5],[6732,6738,5],[6931,6933,5],[7005,7007,5],[7057,7070,10],[7074,7082,5],[7109,7118,5],[7119,7127,11],[7374,7376,5],[7528,7586,5],[7587,7645,10],[7755,7787,5],[7791,7795,5],[7799,7801,5],[7803,7805,5],[7825,7831,5],[7845,7859,5],[8013,8032,5],[8065,8068,11],[8518,8529,10],[8533,8536,10],[8538,8540,10],[8677,8679,5],[8836,8840,5],[8908,8910,5],[9154,9159,5],[9205,9218,5],[20002,20032,
5],[20062,20092,5],[20135,20138,5],[20248,20258,5],[20348,20358,5],[20436,20440,5],[20822,20824,5],[20934,20936,5],[21035,21037,5],[21095,21097,5],[21148,21150,5],[21413,21423,5],[21473,21483,5],[21780,21782,5],[21891,21894,5],[22171,22177,5],[22181,22187,5],[22191,22197,5],[22234,22236,5],[22521,22525,5],[22991,22994,5],[23028,23038,5],[23830,23853,5],[23866,23872,5],[23877,23884,5],[23886,23894,5],[23946,23948,5],[24311,24313,5],[24342,24347,5],[24370,24374,6],[24375,24381,5],[24718,24721,5],[24817,
24821,5],[24877,24882,5],[24891,24893,5],[25391,25395,5],[25828,25838,5],[26191,26195,5],[26391,26393,5],[26703,26722,5],[26729,26760,10],[26766,26798,10],[26860,26870,10],[26891,26899,5],[26903,26923,5],[26929,26946,5],[26948,26998,5],[27037,27040,5],[27205,27232,5],[27258,27260,5],[27391,27398,5],[27561,27564,5],[27571,27574,5],[27581,27584,5],[27591,27594,5],[28191,28193,5],[28348,28358,5],[28402,28432,5],[28462,28492,5],[29118,29122,5],[29177,29185,5],[30161,30179,5],[30491,30494,5],[30729,30732,
5],[31251,31259,5],[31265,31268,5],[31275,31278,5],[31288,31297,5],[31461,31465,5],[31491,31495,5],[31917,31922,5],[31965,31985,5],[31992,32E3,5],[32001,32003,10],[32005,32031,10],[32033,32060,10],[32074,32077,10],[32081,32086,5],[32107,32130,5],[32133,32158,5],[32164,32167,10],[32180,32199,5],[32201,32260,5],[32301,32360,5],[32601,32662,5],[32664,32667,10],[32701,32761,5],[53001,53004,5],[53008,53019,5],[53021,53032,5],[53034,53037,5],[53042,53046,5],[53074,53080,5],[54001,54004,5],[54008,54019,
5],[54021,54032,5],[54034,54037,5],[54042,54046,5],[54048,54053,5],[54074,54080,5],[54098,54101,5],[102001,102040,5],[102042,102063,5],[102065,102067,5],[102070,102112,5],[102114,102117,5],[102122,102208,5],[102210,102216,5],[102221,102300,5],[102304,102377,5],[102382,102388,5],[102389,102398,10],[102399,102444,5],[102445,102447,10],[102448,102458,5],[102459,102468,10],[102469,102496,5],[102500,102519,11],[102520,102524,5],[102525,102529,10],[102530,102549,5],[102557,102588,5],[102593,102598,5],[102601,
102603,5],[102608,102628,5],[102629,102646,10],[102648,102672,10],[102675,102700,10],[102701,102703,5],[102707,102730,10],[102735,102758,10],[102767,102900,5],[102965,102969,5],[102971,102973,5],[102975,102989,5],[102990,102992,11],[102997,103002,5],[103003,103008,10],[103009,103011,5],[103012,103014,10],[103019,103021,5],[103022,103024,10],[103029,103031,5],[103032,103034,10],[103065,103068,5],[103074,103076,5],[103077,103079,11],[103080,103082,5],[103083,103085,10],[103090,103093,5],[103097,103099,
5],[103100,103102,10],[103107,103109,5],[103110,103112,10],[103113,103116,5],[103117,103120,10],[103153,103157,5],[103158,103162,10],[103163,103165,5],[103166,103168,11],[103169,103171,10],[103186,103188,5],[103189,103191,10],[103192,103195,5],[103196,103199,10],[103200,103224,5],[103225,103227,11],[103232,103237,5],[103238,103243,10],[103244,103246,5],[103247,103249,10],[103254,103256,5],[103257,103259,10],[103264,103266,5],[103267,103269,10],[103300,103375,5],[103381,103383,5],[103384,103386,11],
[103387,103389,5],[103390,103392,10],[103397,103399,5],[103400,103471,10],[103476,103478,5],[103479,103481,10],[103486,103488,5],[103489,103491,10],[103492,103495,5],[103496,103499,10],[103539,103543,5],[103544,103548,10],[103549,103551,5],[103552,103554,11],[103555,103557,10],[103558,103560,5],[103571,103573,5],[103574,103576,10],[103577,103580,5],[103581,103583,10],[103595,103597,5],[103600,103694,5],[103696,103698,5],[103700,103793,10],[103794,103799,5]],gcsid:[4001,81,4002,85,4003,70,4004,84,
4005,82,4006,83,4007,60,4008,67,4009,39,4010,57,4011,63,4012,64,4013,64,4014,63,4015,92,4016,90,4018,86,4019,75,4020,68,4021,70,4022,55,4023,75,4024,66,4025,73,4027,95,4028,59,4029,58,4031,75,4032,78,4033,77,4034,65,4035,100,4036,70,4042,88,4044,87,4045,89,4046,75,4047,99,4052,101,4053,97,4054,61,4075,75,4081,75,4120,84,4121,75,4122,80,4123,55,4124,84,4126,75,4130,75,4131,92,4132,64,4133,75,4134,64,4140,75,4141,75,4142,64,4143,64,4144,92,4145,87,4146,89,4147,66,4148,75,4149,84,4150,84,4151,75,4152,
75,4153,55,4154,55,4155,63,4156,84,4157,60,4162,84,4163,75,4164,66,4165,55,4166,75,4168,58,4170,75,4172,75,4173,75,4174,58,4175,64,4176,75,4178,66,4179,66,4180,75,4188,81,4190,75,4191,66,4192,55,4193,63,4198,64,4199,55,4200,66,4201,64,4202,70,4203,70,4204,55,4205,66,4206,63,4207,55,4208,55,4209,64,4210,64,4211,84,4212,64,4213,63,4214,66,4215,55,4216,67,4218,55,4219,84,4220,64,4221,55,4222,64,4224,55,4225,55,4229,68,4230,55,4231,55,4232,64,4234,64,4235,55,4236,55,4237,70,4238,70,4239,92,4240,92,4241,
65,4242,67,4243,88,4244,92,4245,86,4246,64,4250,64,4251,64,4252,63,4253,67,4254,55,4255,55,4256,64,4257,84,4258,75,4259,55,4260,64,4261,106,4262,84,4263,64,4265,55,4266,63,4267,67,4269,75,4270,64,4271,55,4272,55,4273,82,4274,55,4275,63,4276,73,4280,84,4281,57,4282,63,4283,75,4284,66,4285,55,4286,68,4288,55,4289,84,4291,70,4292,55,4293,83,4294,84,4295,84,4296,63,4297,55,4298,90,4299,85,4300,85,4301,84,4302,60,4303,68,4306,84,4307,64,4308,84,4309,55,4310,63,4311,55,4312,84,4313,55,4314,84,4315,63,4316,
55,4317,66,4318,75,4319,75,4322,80,4324,80,4326,75,4466,75,4469,75,4475,55,4483,75,4490,75,4555,66,4558,75,4608,67,4609,67,4610,74,4614,55,4619,75,4624,75,4625,55,4627,75,4636,55,4637,55,4638,67,4639,55,4657,93,4659,75,4660,55,4661,75,4666,84,4667,75,4670,75,4671,63,4674,75,4679,64,4680,64,4682,92,4683,67,4686,75,4687,75,4693,75,4694,75,4695,67,4696,64,4697,64,4702,75,4703,64,4704,55,4705,55,4706,68,4718,55,4720,80,4721,55,4723,67,4726,67,4737,75,4738,60,4740,79,4741,55,4742,75,4743,64,4744,64,4745,
84,4746,84,4747,75,4748,56,4749,75,4750,75,4751,91,4752,56,4753,55,4754,55,4759,75,4761,75,4801,84,4802,55,4803,55,4804,84,4805,84,4806,55,4807,106,4808,84,4809,55,4810,105,4811,106,4816,106,4817,82,4818,84,4820,84,4821,106,4823,55,4824,55,4901,107,4902,107,4903,59,4904,84,5228,84,5229,84,5233,92,5252,75,5264,75,5340,75,5354,75,5360,75,5371,75,5373,75,5381,75,5393,75,5464,60,5467,67,5489,75,5524,55,5527,70,5546,75,5561,66,5593,75,5681,84,5886,75,6135,75,6365,75,6706,75,6881,64,6882,64,6883,55,6892,
64,6894,64,6980,75,6983,75,6987,75,6990,75,7035,75,7037,75,7039,75,7041,75,7073,75,7084,75,7086,75,7133,75,7373,75,7683,76,7798,75,7844,75,7881,75,7886,75,8042,96,8043,96,8086,75,8232,75,8237,75,8240,75,8246,75,8249,75,8252,75,8255,75,8351,84,8427,75,8428,55,8449,75,8545,75,8685,75,8694,64,8699,75,8818,75,8888,75,8900,75,8902,75,8907,75,8949,75,9003,75,9006,75,9009,75,9012,75,9017,75,9068,75,9069,75,9140,75,9148,75,9153,75,37001,73,37002,69,37003,72,37004,71,37005,62,37006,91,37007,94,37008,101,37201,
55,37202,92,37203,87,37204,55,37205,55,37206,64,37207,71,37208,64,37211,64,37220,67,37221,55,37222,55,37223,63,37224,55,37225,106,37226,55,37227,55,37228,64,37229,62,37230,55,37231,70,37232,55,37233,55,37235,55,37237,55,37238,55,37239,67,37240,64,37241,55,37242,55,37243,67,37252,67,37253,55,37254,64,37255,84,37257,66,37259,55,37260,67,104017,79,104018,79,104024,75,104027,75,104047,98,104050,75,104100,75,104101,84,104102,84,104103,64,104104,55,104105,84,104106,55,104107,75,104108,75,104109,67,104110,
75,104111,75,104112,67,104113,67,104128,102,104129,75,104130,55,104131,84,104132,67,104133,75,104134,75,104135,66,104136,70,104137,75,104138,55,104139,106,104140,106,104223,75,104248,55,104256,92,104261,63,104286,75,104287,75,104304,63,104700,49,104701,9,104702,24,104703,15,104704,28,104705,32,104706,53,104707,46,104708,37,104709,54,104710,11,104711,14,104712,30,104713,52,104714,4,104715,4,104716,23,104717,14,104718,48,104719,29,104720,22,104721,21,104722,35,104723,21,104724,46,104725,22,104726,49,
104727,45,104728,52,104729,10,104730,10,104731,21,104732,31,104733,26,104734,40,104735,19,104736,30,104737,34,104738,27,104739,46,104740,5,104741,12,104742,50,104743,9,104744,43,104745,21,104746,26,104747,25,104748,21,104749,7,104750,53,104751,6,104752,33,104753,29,104754,19,104755,41,104756,31,104757,3,104758,41,104759,25,104760,49,104761,41,104762,44,104763,50,104764,46,104765,6,104766,40,104767,16,104768,8,104769,17,104770,48,104771,42,104772,50,104773,25,104774,29,104775,25,104776,32,104777,13,
104778,36,104779,47,104780,14,104781,29,104782,23,104783,38,104784,42,104785,18,104786,20,104808,51,104896,75,104900,112,104901,104,104902,103,104903,116,104904,109,104905,108,104906,169,104907,164,104908,0,104909,168,104910,141,104911,166,104912,114,104913,160,104914,151,104915,117,104916,110,104917,140,104918,115,104919,170,104920,163,104921,154,104922,158,104923,161,104924,148,104925,0,104926,159,104927,167,104928,127,104929,131,104930,145,104931,159,104932,136,104933,123,104934,139,104935,134,
104936,166,104937,150,104938,137,104939,147,104940,121,104941,165,104942,128,104943,111,104944,1,104945,126,104946,152,104947,157,104948,162,104949,153,104950,156,104951,149,104952,132,104953,122,104954,160,104955,146,104956,143,104957,156,104958,120,104959,125,104960,2,104961,144,104962,142,104963,138,104964,155,104965,135,104966,133,104967,151,104968,118,104969,119,104970,124,104971,108,104972,129,104973,130,104974,113,104975,0,104990,84,104991,75,104992,84],gcsidc:[[4127,4129,67],[4135,4139,67],
[4158,4161,55],[4181,4185,55],[4194,4196,55],[4226,4228,63],[4247,4249,55],[4277,4279,81],[4600,4607,64],[4621,4623,55],[4628,4633,55],[4641,4646,55],[4662,4665,55],[4676,4678,66],[4688,4692,55],[4699,4701,64],[4755,4757,75],[4763,4765,75],[4813,4815,84],[8972,8987,75],[37212,37219,55],[37245,37247,55],[37249,37251,55],[104009,104015,75],[104019,104022,75],[104114,104124,75],[104125,104127,55],[104141,104145,75],[104179,104186,75],[104257,104260,75]]},c={c:[[2E3,2035,9001],[2039,2045,9001],[2056,
2062,9001],[2067,2090,9001],[2093,2135,9001],[2161,2165,9001],[2172,2180,9001],[2188,2193,9001],[2195,2198,9001],[2200,2203,9001],[2205,2213,9001],[2215,2217,9001],[2222,2224,9002],[2225,2243,9003],[2246,2250,9003],[2251,2253,9002],[2257,2264,9003],[2274,2279,9003],[2280,2282,9002],[2283,2289,9003],[2308,2313,9001],[2315,2491,9001],[2494,2576,9001],[2578,2599,9001],[2601,2693,9001],[2695,2866,9001],[2867,2869,9002],[2870,2888,9003],[2891,2895,9003],[2896,2898,9002],[2902,2908,9003],[2915,2920,9003],
[2921,2923,9002],[2924,2930,9003],[2931,2933,9001],[2935,2962,9001],[2964,2968,9003],[2969,2973,9001],[2975,2978,9001],[2984,2988,9001],[2995,3051,9001],[3054,3072,9001],[3077,3079,9001],[3081,3088,9001],[3092,3101,9001],[3106,3138,9001],[3146,3151,9001],[3153,3166,9001],[3168,3172,9001],[3174,3203,9001],[3294,3313,9001],[3315,3348,9001],[3350,3358,9001],[3367,3403,9001],[3408,3416,9001],[3417,3438,9003],[3441,3446,9003],[3447,3450,9001],[3451,3453,9003],[3455,3459,9003],[3460,3478,9001],[3554,3559,
9001],[3560,3570,9003],[3571,3581,9001],[3594,3597,9001],[3601,3604,9001],[3637,3639,9001],[3665,3667,9001],[3693,3695,9001],[3701,3727,9001],[3728,3739,9003],[3740,3751,9001],[3753,3760,9003],[3761,3773,9001],[3775,3777,9001],[3779,3781,9001],[3788,3791,9001],[3797,3802,9001],[3814,3816,9001],[3825,3829,9001],[3832,3841,9001],[3844,3852,9001],[3873,3885,9001],[3890,3893,9001],[3942,3950,9001],[3968,3970,9001],[3973,3976,9001],[3986,3989,9001],[3994,3997,9001],[4001,4016,9102],[4018,4025,9102],[4027,
4029,9102],[4031,4036,9102],[4044,4047,9102],[4048,4051,9001],[4052,4054,9102],[4056,4063,9001],[4093,4096,9001],[4120,4124,9102],[4127,4139,9102],[4141,4176,9102],[4178,4185,9102],[4188,4216,9102],[4218,4232,9102],[4235,4260,9102],[4265,4267,9102],[4269,4286,9102],[4292,4304,9102],[4306,4319,9102],[4390,4398,9001],[4399,4413,9003],[4418,4433,9003],[4455,4457,9003],[4484,4489,9001],[4491,4554,9001],[4568,4589,9001],[4600,4630,9102],[4636,4639,9102],[4641,4646,9102],[4652,4656,9001],[4657,4680,9102],
[4682,4684,9102],[4686,4765,9102],[4766,4800,9001],[4801,4806,9102],[4813,4815,9102],[5014,5016,9001],[5069,5072,9001],[5105,5130,9001],[5173,5188,9001],[5253,5259,9001],[5269,5275,9001],[5292,5311,9001],[5329,5331,9001],[5343,5349,9001],[5355,5357,9001],[5459,5463,9001],[5479,5482,9001],[5518,5520,9001],[5533,5539,9001],[5550,5552,9001],[5562,5583,9001],[5623,5625,9003],[5631,5639,9001],[5649,5653,9001],[5663,5680,9001],[5682,5685,9001],[5875,5877,9001],[5896,5899,9001],[5921,5940,9001],[6050,6125,
9001],[6244,6275,9001],[6328,6348,9001],[6350,6356,9001],[6366,6372,9001],[6381,6387,9001],[6393,6404,9001],[6480,6483,9001],[6511,6514,9001],[6579,6581,9001],[6619,6624,9001],[6625,6627,9003],[6628,6632,9001],[6634,6637,9001],[6669,6692,9001],[6707,6709,9001],[6720,6723,9001],[6732,6738,9001],[6881,6883,9102],[6931,6933,9001],[7005,7007,9001],[7057,7070,9003],[7074,7082,9001],[7109,7118,9001],[7119,7127,9002],[7374,7376,9001],[7528,7586,9001],[7587,7645,9003],[7692,7696,9001],[7755,7787,9001],[7791,
7795,9001],[7799,7801,9001],[7803,7805,9001],[7825,7831,9001],[7845,7859,9001],[8013,8032,9001],[8065,8068,9002],[8518,8529,9003],[8533,8536,9003],[8538,8540,9003],[8677,8679,9001],[8836,8840,9001],[8857,8859,9001],[8908,8910,9001],[8972,9E3,9102],[9053,9057,9102],[9059,9069,9102],[9154,9159,9001],[9205,9218,9001],[20002,20032,9001],[20062,20092,9001],[20135,20138,9001],[20248,20258,9001],[20348,20358,9001],[20436,20440,9001],[20822,20824,9001],[20934,20936,9001],[21035,21037,9001],[21095,21097,9001],
[21148,21150,9001],[21413,21423,9001],[21473,21483,9001],[21780,21782,9001],[21896,21899,9001],[22171,22177,9001],[22181,22187,9001],[22191,22197,9001],[22234,22236,9001],[22521,22525,9001],[22991,22994,9001],[23028,23038,9001],[23830,23853,9001],[23866,23872,9001],[23877,23884,9001],[23886,23894,9001],[23946,23948,9001],[24311,24313,9001],[24342,24347,9001],[24370,24374,9084],[24375,24381,9001],[24718,24721,9001],[24817,24821,9001],[24877,24882,9001],[24891,24893,9001],[25391,25395,9001],[25828,
25838,9001],[26191,26195,9001],[26391,26393,9001],[26701,26722,9001],[26729,26746,9003],[26748,26760,9003],[26766,26799,9003],[26847,26870,9003],[26891,26899,9001],[26901,26923,9001],[26929,26946,9001],[26948,26978,9001],[26980,26998,9001],[27037,27040,9001],[27205,27232,9001],[27258,27260,9001],[27391,27398,9001],[27561,27564,9001],[27571,27574,9001],[27581,27584,9001],[27591,27594,9001],[28191,28193,9001],[28348,28358,9001],[28402,28432,9001],[28462,28492,9001],[29168,29172,9001],[29187,29195,9001],
[29901,29903,9001],[30161,30179,9001],[30491,30494,9001],[30729,30732,9001],[31251,31259,9001],[31265,31268,9001],[31275,31277,9001],[31281,31290,9001],[31466,31469,9001],[31491,31495,9001],[31965,32E3,9001],[32001,32003,9003],[32005,32017,9003],[32019,32028,9003],[32033,32035,9003],[32037,32060,9003],[32064,32067,9003],[32081,32086,9001],[32107,32130,9001],[32133,32158,9001],[32164,32167,9003],[32180,32199,9001],[32201,32260,9001],[32301,32360,9001],[32601,32662,9001],[32664,32667,9003],[32701,32761,
9001],[37002,37008,9102],[53001,53004,9001],[53008,53019,9001],[53021,53032,9001],[53034,53037,9001],[53042,53046,9001],[53074,53080,9001],[54001,54004,9001],[54008,54019,9001],[54021,54032,9001],[54042,54046,9001],[54048,54053,9001],[54074,54080,9001],[54098,54101,9001],[102001,102005,9001],[102007,102039,9001],[102042,102045,9001],[102060,102063,9001],[102070,102079,9001],[102096,102099,9001],[102101,102109,9001],[102114,102117,9001],[102132,102138,9001],[102141,102144,9001],[102156,102166,9001],
[102173,102179,9001],[102191,102198,9001],[102221,102228,9001],[102231,102233,9001],[102237,102240,9001],[102364,102375,9001],[102389,102398,9003],[102399,102419,9001],[102421,102438,9001],[102445,102447,9003],[102450,102458,9001],[102459,102462,9003],[102470,102489,9001],[102550,102556,9001],[102562,102588,9001],[102629,102640,9003],[102648,102650,9003],[102688,102690,9003],[102696,102700,9003],[102701,102703,9001],[102799,102900,9001],[103166,103168,9002],[103220,103224,9001],[103225,103227,9002],
[103232,103237,9001],[103238,103243,9003],[103244,103246,9001],[103247,103249,9003],[103254,103256,9001],[103257,103259,9003],[103264,103266,9001],[103267,103269,9003],[103327,103330,9001],[103344,103347,9001],[103372,103375,9001],[103381,103383,9001],[103384,103386,9002],[103387,103389,9001],[103390,103392,9003],[103397,103399,9001],[103427,103430,9003],[103444,103447,9003],[103476,103478,9001],[103479,103481,9003],[103486,103488,9001],[103489,103491,9003],[103492,103495,9001],[103496,103499,9003],
[103539,103543,9001],[103544,103548,9003],[103549,103551,9001],[103552,103554,9002],[103555,103557,9003],[103558,103560,9001],[103571,103573,9001],[103574,103576,9003],[103577,103580,9001],[103581,103583,9003],[103595,103597,9001],[103600,103694,9001],[103696,103698,9001],[103700,103793,9003],[104101,104103,9102],[104126,104131,9102],[104259,104261,9102],[104700,104786,9102],[104900,104975,9102]],nc:[2065,9001,2066,9039,2136,9094,2137,9001,2138,9001,2154,9001,2157,9001,2158,9001,2159,9094,2160,9094,
2169,9001,2170,9001,2204,9003,2219,9001,2220,9001,2254,9003,2255,9003,2256,9002,2265,9002,2266,9002,2267,9003,2268,9003,2269,9002,2270,9002,2271,9003,2272,9003,2273,9002,2290,9001,2294,9001,2295,9001,2314,9005,2899,9003,2900,9003,2901,9002,2909,9002,2910,9002,2911,9003,2912,9003,2913,9002,2914,9002,2980,9001,2981,9001,2991,9001,2992,9002,2993,9001,2994,9002,3074,9001,3075,9001,3080,9002,3089,9003,3090,9001,3091,9003,3102,9003,3141,9001,3142,9001,3167,9301,3360,9001,3361,9002,3362,9001,3363,9003,3364,
9001,3365,9003,3404,9003,3405,9001,3406,9001,3407,9005,3439,9001,3440,9001,3479,9002,3480,9001,3481,9002,3482,9001,3483,9002,3484,9001,3485,9003,3486,9001,3487,9003,3488,9001,3489,9001,3490,9003,3491,9001,3492,9003,3493,9001,3494,9003,3495,9001,3496,9003,3497,9001,3498,9003,3499,9001,3500,9003,3501,9001,3502,9003,3503,9001,3504,9003,3505,9001,3506,9003,3507,9001,3508,9003,3509,9001,3510,9003,3511,9001,3512,9003,3513,9001,3514,9001,3515,9003,3516,9001,3517,9003,3518,9001,3519,9003,3520,9001,3521,9003,
3522,9001,3523,9003,3524,9001,3525,9003,3526,9001,3527,9003,3528,9001,3529,9003,3530,9001,3531,9003,3532,9001,3533,9003,3534,9001,3535,9003,3536,9001,3537,9003,3538,9001,3539,9003,3540,9001,3541,9003,3542,9001,3543,9003,3544,9001,3545,9003,3546,9001,3547,9003,3548,9001,3549,9003,3550,9001,3551,9003,3552,9001,3553,9003,3582,9003,3583,9001,3584,9003,3585,9001,3586,9003,3587,9001,3588,9002,3589,9001,3590,9002,3591,9001,3592,9001,3593,9002,3598,9003,3599,9001,3600,9003,3605,9002,3606,9001,3607,9001,3608,
9003,3609,9001,3610,9003,3611,9001,3612,9003,3613,9001,3614,9003,3615,9001,3616,9003,3617,9001,3618,9003,3619,9001,3620,9003,3621,9001,3622,9003,3623,9001,3624,9003,3625,9001,3626,9003,3627,9001,3628,9003,3629,9001,3630,9003,3631,9001,3632,9003,3633,9001,3634,9002,3635,9001,3636,9002,3640,9003,3641,9001,3642,9003,3643,9001,3644,9002,3645,9001,3646,9002,3647,9001,3648,9002,3649,9001,3650,9003,3651,9001,3652,9003,3653,9001,3654,9003,3655,9001,3656,9002,3657,9001,3658,9003,3659,9001,3660,9003,3661,9001,
3662,9003,3663,9001,3664,9003,3668,9003,3669,9001,3670,9003,3671,9001,3672,9003,3673,9001,3674,9003,3675,9001,3676,9002,3677,9003,3678,9001,3679,9002,3680,9003,3681,9001,3682,9002,3683,9003,3684,9001,3685,9001,3686,9003,3687,9001,3688,9003,3689,9001,3690,9003,3691,9001,3692,9003,3696,9003,3697,9001,3698,9003,3699,9001,3700,9003,3783,9001,3784,9001,3793,9001,3794,9001,3812,9001,3819,9102,3821,9102,3824,9102,3854,9001,3857,9001,3889,9102,3906,9102,3911,9001,3912,9001,3920,9001,3978,9001,3979,9001,3991,
9003,3992,9003,4026,9001,4037,9001,4038,9001,4042,9102,4071,9001,4075,9102,4081,9102,4082,9001,4083,9001,4087,9001,4088,9001,4217,9003,4261,9105,4262,9102,4263,9102,4288,9102,4289,9102,4322,9102,4324,9102,4326,9102,4414,9001,4415,9001,4417,9001,4434,9001,4437,9001,4438,9003,4439,9003,4462,9001,4463,9102,4467,9001,4470,9102,4471,9001,4475,9102,4483,9102,4490,9102,4555,9102,4558,9102,4559,9001,4632,9102,4633,9102,4647,9001,4807,9105,4808,9102,4809,9102,4810,9105,4811,9105,4816,9105,4817,9102,4818,9102,
4820,9102,4821,9105,4822,9001,4823,9102,4824,9102,4826,9001,4839,9001,4901,9105,4902,9105,4903,9102,4904,9102,5013,9102,5018,9001,5048,9001,5167,9001,5168,9001,5221,9001,5223,9001,5228,9102,5229,9102,5233,9102,5234,9001,5235,9001,5243,9001,5246,9102,5247,9001,5252,9102,5264,9102,5266,9001,5316,9001,5320,9001,5321,9001,5324,9102,5325,9001,5337,9001,5340,9102,5354,9102,5360,9102,5361,9001,5362,9001,5365,9102,5367,9001,5371,9102,5373,9102,5381,9102,5382,9001,5383,9001,5387,9001,5389,9001,5393,9102,5396,
9001,5451,9102,5456,9001,5457,9001,5464,9102,5467,9102,5469,9001,5472,9037,5489,9102,5490,9001,5513,9001,5514,9001,5523,9001,5524,9102,5527,9102,5530,9001,5531,9001,5546,9102,5559,9001,5561,9102,5588,9002,5589,9005,5593,9102,5596,9001,5627,9001,5629,9001,5641,9001,5643,9001,5644,9001,5646,9003,5654,9003,5655,9003,5659,9001,5681,9102,5700,9001,5825,9001,5836,9001,5837,9001,5839,9001,5842,9001,5844,9001,5858,9001,5879,9001,5880,9001,5886,9102,5887,9001,5890,9001,6128,9002,6129,9002,6135,9102,6204,9001,
6207,9102,6210,9001,6211,9001,6307,9001,6311,9102,6312,9001,6316,9001,6318,9102,6322,9102,6325,9102,6362,9001,6365,9102,6391,9002,6405,9002,6406,9001,6407,9002,6408,9001,6409,9002,6410,9001,6411,9003,6412,9001,6413,9003,6414,9001,6415,9001,6416,9003,6417,9001,6418,9003,6419,9001,6420,9003,6421,9001,6422,9003,6423,9001,6424,9003,6425,9001,6426,9003,6427,9001,6428,9003,6429,9001,6430,9003,6431,9001,6432,9003,6433,9001,6434,9003,6435,9001,6436,9003,6437,9001,6438,9003,6439,9001,6440,9001,6441,9003,6442,
9001,6443,9003,6444,9001,6445,9003,6446,9001,6447,9003,6448,9001,6449,9003,6450,9001,6451,9003,6452,9001,6453,9003,6454,9001,6455,9003,6456,9001,6457,9003,6458,9001,6459,9003,6460,9001,6461,9003,6462,9001,6463,9003,6464,9001,6465,9003,6466,9001,6467,9003,6468,9001,6469,9003,6470,9001,6471,9003,6472,9001,6473,9003,6474,9001,6475,9003,6476,9001,6477,9003,6478,9001,6479,9003,6484,9003,6485,9001,6486,9003,6487,9001,6488,9003,6489,9001,6490,9003,6491,9001,6492,9003,6493,9001,6494,9002,6495,9001,6496,9002,
6497,9001,6498,9001,6499,9002,6500,9001,6501,9003,6502,9001,6503,9003,6504,9001,6505,9003,6506,9001,6507,9003,6508,9001,6509,9001,6510,9003,6515,9002,6516,9001,6518,9001,6519,9003,6520,9001,6521,9003,6522,9001,6523,9003,6524,9001,6525,9003,6526,9001,6527,9003,6528,9001,6529,9003,6530,9001,6531,9003,6532,9001,6533,9003,6534,9001,6535,9003,6536,9001,6537,9003,6538,9001,6539,9003,6540,9001,6541,9003,6542,9001,6543,9003,6544,9001,6545,9002,6546,9001,6547,9002,6548,9001,6549,9003,6550,9001,6551,9003,6552,
9001,6553,9003,6554,9001,6555,9003,6556,9001,6557,9002,6558,9001,6559,9002,6560,9001,6561,9002,6562,9001,6563,9003,6564,9001,6565,9003,6566,9001,6567,9001,6568,9003,6569,9001,6570,9002,6571,9001,6572,9003,6573,9001,6574,9003,6575,9001,6576,9003,6577,9001,6578,9003,6582,9003,6583,9001,6584,9003,6585,9001,6586,9003,6587,9001,6588,9003,6589,9001,6590,9003,6591,9001,6592,9001,6593,9003,6594,9001,6595,9003,6596,9001,6597,9003,6598,9001,6599,9003,6600,9001,6601,9003,6602,9001,6603,9003,6605,9003,6606,9001,
6607,9003,6608,9001,6609,9003,6610,9001,6611,9001,6612,9003,6613,9001,6614,9003,6615,9001,6616,9003,6617,9001,6618,9003,6633,9003,6646,9001,6668,9102,6703,9001,6706,9102,6783,9102,6784,9001,6785,9002,6786,9001,6787,9002,6788,9001,6789,9002,6790,9001,6791,9002,6792,9001,6793,9002,6794,9001,6795,9002,6796,9001,6797,9002,6798,9001,6799,9002,6800,9001,6801,9002,6802,9001,6803,9002,6804,9001,6805,9002,6806,9001,6807,9002,6808,9001,6809,9002,6810,9001,6811,9002,6812,9001,6813,9002,6814,9001,6815,9002,6816,
9001,6817,9002,6818,9001,6819,9002,6820,9001,6821,9002,6822,9001,6823,9002,6824,9001,6825,9002,6826,9001,6827,9002,6828,9001,6829,9002,6830,9001,6831,9002,6832,9001,6833,9002,6834,9001,6835,9002,6836,9001,6837,9002,6838,9001,6839,9002,6840,9001,6841,9002,6842,9001,6843,9002,6844,9001,6845,9002,6846,9001,6847,9002,6848,9001,6849,9002,6850,9001,6851,9002,6852,9001,6853,9002,6854,9001,6855,9002,6856,9001,6857,9002,6858,9001,6859,9002,6860,9001,6861,9002,6862,9001,6863,9002,6867,9001,6868,9002,6870,9001,
6875,9001,6876,9001,6879,9001,6880,9003,6884,9001,6885,9002,6886,9001,6887,9002,6892,9102,6894,9102,6915,9001,6922,9001,6923,9003,6924,9001,6925,9003,6962,9001,6983,9102,6984,9001,6990,9102,6991,9001,7035,9102,7037,9102,7039,9102,7041,9102,7073,9102,7084,9102,7086,9102,7128,9003,7131,9001,7132,9003,7133,9102,7136,9102,7139,9102,7142,9001,7257,9001,7258,9003,7259,9001,7260,9003,7261,9001,7262,9003,7263,9001,7264,9003,7265,9001,7266,9003,7267,9001,7268,9003,7269,9001,7270,9003,7271,9001,7272,9003,7273,
9001,7274,9003,7275,9001,7276,9003,7277,9001,7278,9003,7279,9001,7280,9003,7281,9001,7282,9003,7283,9001,7284,9003,7285,9001,7286,9003,7287,9001,7288,9003,7289,9001,7290,9003,7291,9001,7292,9003,7293,9001,7294,9003,7295,9001,7296,9003,7297,9001,7298,9003,7299,9001,7300,9003,7301,9001,7302,9003,7303,9001,7304,9003,7305,9001,7306,9003,7307,9001,7308,9003,7309,9001,7310,9003,7311,9001,7312,9003,7313,9001,7314,9003,7315,9001,7316,9003,7317,9001,7318,9003,7319,9001,7320,9003,7321,9001,7322,9003,7323,9001,
7324,9003,7325,9001,7326,9003,7327,9001,7328,9003,7329,9001,7330,9003,7331,9001,7332,9003,7333,9001,7334,9003,7335,9001,7336,9003,7337,9001,7338,9003,7339,9001,7340,9003,7341,9001,7342,9003,7343,9001,7344,9003,7345,9001,7346,9003,7347,9001,7348,9003,7349,9001,7350,9003,7351,9001,7352,9003,7353,9001,7354,9003,7355,9001,7356,9003,7357,9001,7358,9003,7359,9001,7360,9003,7361,9001,7362,9003,7363,9001,7364,9003,7365,9001,7366,9003,7367,9001,7368,9003,7369,9001,7370,9003,7373,9102,7683,9102,7798,9102,7844,
9102,7877,9001,7878,9001,7881,9102,7882,9001,7883,9001,7886,9102,7887,9001,7899,9001,7991,9001,7992,9001,8035,9003,8036,9003,8042,9102,8043,9102,8058,9001,8059,9001,8082,9001,8083,9001,8086,9102,8088,9001,8090,9001,8091,9003,8092,9001,8093,9003,8095,9001,8096,9003,8097,9001,8098,9003,8099,9001,8100,9003,8101,9001,8102,9003,8103,9001,8104,9003,8105,9001,8106,9003,8107,9001,8108,9003,8109,9001,8110,9003,8111,9001,8112,9003,8113,9001,8114,9003,8115,9001,8116,9003,8117,9001,8118,9003,8119,9001,8120,9003,
8121,9001,8122,9003,8123,9001,8124,9003,8125,9001,8126,9003,8127,9001,8128,9003,8129,9001,8130,9003,8131,9001,8132,9003,8133,9001,8134,9003,8135,9001,8136,9003,8137,9001,8138,9003,8139,9001,8140,9003,8141,9001,8142,9003,8143,9001,8144,9003,8145,9001,8146,9003,8147,9001,8148,9003,8149,9001,8150,9003,8151,9001,8152,9003,8153,9001,8154,9003,8155,9001,8156,9003,8157,9001,8158,9003,8159,9001,8160,9003,8161,9001,8162,9003,8163,9001,8164,9003,8165,9001,8166,9003,8167,9001,8168,9003,8169,9001,8170,9003,8171,
9001,8172,9003,8173,9001,8177,9003,8179,9001,8180,9003,8181,9001,8182,9003,8184,9001,8185,9003,8187,9001,8189,9003,8191,9001,8193,9003,8196,9001,8197,9003,8198,9001,8200,9003,8201,9001,8202,9003,8203,9001,8204,9003,8205,9001,8206,9003,8207,9001,8208,9003,8209,9001,8210,9003,8212,9001,8213,9003,8214,9001,8216,9003,8218,9001,8220,9003,8222,9001,8224,9003,8225,9001,8226,9003,8232,9102,8237,9102,8240,9102,8246,9102,8249,9102,8252,9102,8255,9102,8311,9001,8312,9002,8313,9001,8314,9002,8315,9001,8316,9002,
8317,9001,8318,9002,8319,9001,8320,9002,8321,9001,8322,9002,8323,9001,8324,9002,8325,9001,8326,9002,8327,9001,8328,9002,8329,9001,8330,9002,8331,9001,8332,9002,8333,9001,8334,9002,8335,9001,8336,9002,8337,9001,8338,9002,8339,9001,8340,9002,8341,9001,8342,9002,8343,9001,8344,9002,8345,9001,8346,9002,8347,9001,8348,9002,8351,9102,8352,9001,8353,9001,8379,9001,8380,9003,8381,9001,8382,9003,8383,9001,8384,9003,8385,9001,8387,9003,8391,9001,8395,9001,8427,9102,8428,9102,8431,9102,8433,9001,8441,9001,8455,
9001,8456,9001,8531,9003,8545,9102,8682,9001,8685,9102,8687,9001,8692,9001,8693,9001,8694,9102,8699,9102,8818,9102,8826,9001,8860,9102,8888,9102,8900,9102,8902,9102,8903,9001,8907,9102,8949,9102,8950,9001,8951,9001,9003,9102,9006,9102,9009,9102,9012,9102,9014,9102,9017,9102,9019,9102,9039,9001,9040,9001,9140,9102,9141,9001,9148,9102,9149,9001,9150,9001,9153,9102,9191,9001,9221,9001,9222,9001,20499,9001,20538,9001,20539,9001,20790,9001,20791,9001,21291,9001,21292,9001,21500,9001,21817,9001,21818,9001,
22032,9001,22033,9001,22091,9001,22092,9001,22332,9001,22391,9001,22392,9001,22700,9001,22770,9001,22780,9001,22832,9001,23090,9001,23095,9001,23239,9001,23240,9001,23700,9001,24047,9001,24048,9001,24100,9005,24200,9001,24305,9001,24306,9001,24382,9084,24383,9001,24500,9001,24547,9001,24548,9001,24571,9062,24600,9001,25E3,9001,25231,9001,25884,9001,25932,9001,26237,9001,26331,9001,26332,9001,26591,9001,26592,9001,26632,9001,26692,9001,27120,9001,27200,9001,27291,9040,27292,9040,27429,9001,27493,9001,
27500,9001,27700,9001,28232,9001,28600,9001,28991,9001,28992,9001,29101,9001,29220,9001,29221,9001,29333,9001,29635,9001,29636,9001,29701,9001,29738,9001,29739,9001,29849,9001,29850,9001,29871,9042,29872,9041,29873,9001,30200,9039,30339,9001,30340,9001,30791,9001,30792,9001,31028,9001,31121,9001,31154,9001,31170,9001,31171,9001,31279,9001,31370,9001,31528,9001,31529,9001,31600,9001,31700,9001,31838,9001,31839,9001,31901,9001,32030,9003,32031,9003,32061,9001,32062,9001,32098,9001,32099,9003,32100,
9001,32104,9001,32161,9001,32766,9001,37202,9102,37203,9102,37206,9102,37207,9102,37218,9102,37221,9102,37225,9105,37240,9102,37241,9102,37243,9102,37245,9102,37249,9102,37257,9102,37260,9102,53048,9001,53049,9001,54034,9001,54090,9001,54091,9001,65061,9003,65062,9003,65161,9001,102041,9003,102064,9085,102068,109030,102069,109031,102093,9001,102094,9001,102118,9003,102120,9003,102121,9003,102122,9001,102150,9001,102168,9001,102204,9001,102212,9001,102213,9001,102215,9001,102216,9001,102217,9003,102218,
9001,102219,9003,102220,9003,102247,9001,102299,9001,102306,9001,102319,9001,102328,9001,102329,9001,102359,9001,102360,9001,102440,9001,102448,9001,102464,9003,102465,9003,102491,9001,102492,9001,102498,9001,102499,9001,102525,9003,102526,9003,102528,9003,102529,9003,102589,9003,102598,9001,102599,9003,102600,9003,102604,9003,102661,9003,102662,9003,102664,9003,102665,9003,102705,9003,102720,9003,102721,9003,102726,9003,102727,9003,102733,9003,102761,9003,102766,9003,102974,9003,103228,9001,103229,
9001,103230,9003,103231,9003,103250,9001,103251,9003,103252,9001,103253,9003,103260,9001,103261,9001,103262,9003,103263,9003,103270,9001,103271,9001,103272,9003,103273,9003,103274,9001,103275,9001,103276,9003,103277,9003,103278,9001,103279,9001,103280,9003,103281,9003,103282,9001,103283,9001,103284,9003,103285,9003,103286,9001,103287,9003,103288,9001,103289,9003,103290,9001,103291,9003,103292,9001,103293,9001,103294,9003,103295,9003,103296,9001,103297,9001,103298,9003,103299,9003,103300,9001,103307,
9001,103313,9001,103319,9001,103322,9001,103323,9001,103332,9001,103335,9001,103338,9001,103340,9001,103351,9001,103358,9001,103370,9001,103376,9003,103377,9001,103378,9001,103379,9003,103380,9003,103393,9001,103394,9001,103395,9003,103396,9003,103400,9003,103407,9003,103413,9003,103419,9003,103422,9003,103423,9003,103432,9003,103435,9003,103438,9003,103440,9003,103451,9003,103458,9003,103470,9003,103472,9001,103473,9002,103474,9001,103475,9003,103482,9001,103483,9003,103484,9001,103485,9003,103500,
9001,103501,9003,103502,9001,103503,9001,103504,9002,103505,9002,103506,9001,103507,9001,103508,9003,103509,9003,103510,9001,103511,9001,103512,9003,103513,9003,103514,9001,103515,9003,103516,9001,103517,9003,103518,9001,103519,9003,103520,9001,103521,9002,103522,9001,103523,9001,103524,9003,103525,9003,103526,9001,103527,9003,103561,9003,103562,9003,103563,9001,103564,9001,103565,9003,103566,9003,103567,9001,103568,9001,103569,9003,103570,9003,103585,9003,103586,9001,103587,9003,103588,9002,103589,
9001,103590,9003,103591,9002,103592,9001,103593,9003,103594,9002,103695,9003,103846,9001,103946,9003,104009,9102,104017,9102,104018,9102,104022,9102,104024,9102,104027,9102,104047,9102,104050,9102,104105,9102,104106,9102,104109,9102,104112,9102,104113,9102,104134,9102,104135,9102,104138,9102,104139,9105,104140,9105,104808,9102]},d=function(){function a(){}a.Cz=function(e){!1===a.tl&&a.hq();var g=a.fU(e);if(-1==g){var b=a.Qv(e);b!=e&&(g=a.Cz(b))}-1==g&&(b=a.AL(e),b!=e&&(g=a.Cz(b)));return g};a.fU=
function(e){return void 0!==a.hv[e]?a.hv[e]:-1};a.vS=function(e){!1===a.tl&&a.hq();var g=a.LF(e);if(1E38==g){var b=a.Qv(e);b!=e&&(g=a.LF(b));if(1E38==g)return 1E-10}return g};a.TU=function(e){if(void 0!==a.$p[e])return!0;var g=a.Qv(e);return g!=e&&void 0!==a.$p[g]?!0:!1};a.VU=function(e){if(void 0!==a.Dj[e])return!0;var g=a.Qv(e);return g!=e&&void 0!==a.Dj[g]?!0:!1};a.LF=function(e){!1===a.tl&&a.hq();return void 0!==a.$p[e]?a.$p[e]:void 0!==a.Dj[e]?a.Dj[e]:1E38};a.AL=function(e){!1===a.tl&&a.hq();
return void 0!==a.IC[e]?a.IC[e]:e};a.Qv=function(e){!1===a.tl&&a.hq();return void 0!==a.QC[e]?a.QC[e]:e};a.hq=function(){for(var e=b,d,k=0;k<e.pcsid.length;k+=2)a.Dj[e.pcsid[k]]=e.pcstol[2*e.pcsid[k+1]+1];for(k=0;k<e.pcsidc.length;k+=1){d=e.pcsidc[k];for(var p=d[0];p<=d[1];p++)a.Dj[p]=e.pcstol[2*d[2]+1]}for(k=0;k<e.gcsid.length;k+=2)a.$p[e.gcsid[k]]=e.gcstol[2*e.gcsid[k+1]+1];for(k=0;k<e.gcsidc.length;k+=1)for(d=e.gcsidc[k],p=d[0];p<=d[1];p++)a.Dj[p]=e.gcstol[2*d[2]+1];for(k=0;k<c.c.length;k+=1)for(d=
c.c[k],p=d[0];p<=d[1];p++)a.hv[p]=d[2];for(k=0;k<c.nc.length;k+=2)a.hv[c.nc[k]]=c.nc[k+1];c=null;for(k=0;k<e.newtoold.length;k+=2)a.IC[e.newtoold[k+1]]=e.newtoold[k],a.QC[e.newtoold[k]]=e.newtoold[k+1];b=null;a.tl=!0};a.tl=!1;a.$p=[];a.Dj=[];a.IC=[];a.QC=[];a.hv=[];return a}();a.us=d})(x||(x={}));(function(a){function b(a){return 0===a.length?'""':'"'==a[0]||"."==a[0]||"0"<=a[0]&&"9">=a[0]?a:'"'+a.trim()+'"'}var c=[],d=function(){function e(){}e.xS=function(g){try{for(var d=0;d<c.length;d++)if(c[d].wkttext===
g)return c[d].unit;for(var k,p=d="",f=!1,H=0;H<g.length;H++){var h=g[H];!0===f?'"'==h?'"'==g[H+1]?d+=h:f=!1:d+=h:/[\s]/.test(h)||(","==h?(p=""!==d?p+(b(d)+","):p+",",d=""):")"==h||"]"==h?(p=""!==d?p+(b(d)+"]}"):p+"]}",d=""):"("==h||"["==h?(p+='{ "entity": "'+d.toUpperCase().trim()+'", "values":[',d=""):'"'==h?(f=!0,d=""):d+=h)}k=JSON.parse(p);var l=e.qF(k);if(null===l)return null;k=null;for(h=0;h<l.values.length;h++)if("object"===typeof l.values[h]&&"UNIT"===l.values[h].entity){k=l.values[h];break}if(null===
k)return null;var m=a.kc.cR("GEOGCS"===l.entity?1:0,k.values[1],k.values[2]);c.push({wkttext:g,unit:m});10<c.length&&c.shift();return m}catch(ca){return null}};e.qF=function(a){if(null===a)return null;if("GEOGCS"===a.entity||"PROJCS"===a.entity)return a;for(var b=[],g=0;g<a.values.length;g++)if("object"===typeof a.values[g]&&void 0!==a.values[g].entity){if("GEOGCS"===a.values[g].entity||"PROJCS"==a.values[g].entity)return a.values[g];b.push(a.values[g])}for(a=0;a<b.length;a++)if(g=e.qF(b[a]),null!==
g)return g;return null};e.wS=function(a){var e=-1;if(null!=a&&0<a.length){var b,g;b=a.indexOf("PROJCS");if(0<=b){var c=0;b=a.lastIndexOf("UNIT");if(0<=b&&(b=a.indexOf(",",b+4),0<b&&(b++,g=a.indexOf("]",b+1),0<g)))try{c=parseFloat(a.substring(b,g))}catch(M){c=0}0<c&&(e=.001/c)}else if(b=a.indexOf("GEOGCS"),0<=b){var d=0,c=0;b=a.indexOf("SPHEROID",b+6);if(0<b&&(b=a.indexOf(",",b+8),0<b)){b++;g=a.indexOf(",",b+1);if(0<g)try{d=parseFloat(a.substring(b,g))}catch(M){d=0}if(0<d&&(b=a.indexOf("UNIT",g+1),
0<=b&&(b=a.indexOf(",",b+4),0<b&&(b++,g=a.indexOf("]",b+1),0<g))))try{c=parseFloat(a.substring(b,g))}catch(M){c=0}}0<d&&0<c&&(e=.001/(d*c))}}return e};return e}();a.pE=d})(x||(x={}));(function(a){(function(a){a[a.NONE=0]="NONE";a[a.LINEAR=1]="LINEAR";a[a.ANGULAR=2]="ANGULAR"})(a.GM||(a.GM={}));(function(a){a[a.enumFloat=0]="enumFloat";a[a.enumDouble=1]="enumDouble";a[a.enumInt32=2]="enumInt32";a[a.enumInt64=3]="enumInt64";a[a.enumInt8=4]="enumInt8";a[a.enumInt16=5]="enumInt16"})(a.HN||(a.HN={}));
(function(a){a[a.POSITION=0]="POSITION";a[a.Z=1]="Z";a[a.M=2]="M";a[a.ID=3]="ID";a[a.NORMAL=4]="NORMAL";a[a.TEXTURE1D=5]="TEXTURE1D";a[a.TEXTURE2D=6]="TEXTURE2D";a[a.TEXTURE3D=7]="TEXTURE3D";a[a.ID2=8]="ID2";a[a.MAXSEMANTICS=10]="MAXSEMANTICS"})(a.Wc||(a.Wc={}));var b=function(){function b(a,e){this.Qt=this.af=null;this.Er=this.Ga=0;this.Sh=this.wg=null;this.bm=0;if(void 0!==e){this.Ga=e.Ga;this.Er=e.Er;this.wg=e.wg.slice(0);this.Sh=e.Sh.slice(0);this.bm=e.bm;this.Qt=[];for(e=a=0;e<this.Ga;e++)this.Qt[e]=
a,a+=b.Xa(this.wg[e]);this.Er=a;this.af=[];for(e=0;e<this.Ga;e++){a=b.Xa(this.qd(e));for(var g=b.de(this.qd(e)),c=0;c<a;c++)this.af[this.Qt[e]+c]=g}}else this.Er=this.Ga=0}b.prototype.qd=function(b){if(0>b||b>this.Ga)throw a.g.F();return this.wg[b]};b.prototype.mg=function(a){return this.Sh[a]};b.Xz=function(a){return b.tc[a]};b.si=function(a){return b.bd[a]};b.Mg=function(a){return b.fe[a]};b.Cj=function(a){return b.Mg(b.si(a))*b.Xa(a)};b.Xa=function(a){return b.Bb[a]};b.Wg=function(a){return 2>
a};b.rk=function(a){return b.Wg(b.si(a))};b.prototype.hasAttribute=function(a){return 0<=this.Sh[a]};b.prototype.uH=function(){return this.hasAttribute(1)};b.de=function(a){return b.$[a]};b.prototype.FT=function(a){return this.Qt[a]};b.PH=function(a,e){return b.$[a]===e};b.Oi=function(b){if(4==b)return 2;if(8==b)return 3;throw a.g.F();};b.prototype.Eb=function(a){return this===a};b.prototype.zk=function(){for(var b=a.J.dh(this.wg[0]),e=1;e<this.Ga;e++)b=a.J.dh(this.wg[e],b);return b};b.prototype.wk=
function(a){return this.Qt[a]};b.prototype.jc=function(){return this.bm};b.prototype.Sd=function(a){return this.wg[a]};b.$=[0,0,NaN,0,0,0,0,0,0];b.tc=[1,1,1,0,2,1,1,1,0];b.bd=[1,1,1,2,0,0,0,0,2];b.fe=[4,8,4,8,1,2];b.Bb=[2,1,1,1,3,1,2,3,2];return b}();a.ma=b})(x||(x={}));(function(a){function b(a,e,b,d){var g=a.Jd,k=a.e+e+1;1===b?d=5<=g[k]:2===b?d=5<g[k]||5==g[k]&&(d||0>k||void 0!==g[k+1]||g[k-1]&1):3===b?d=d||void 0!==g[k]||0>k:(d=!1,0!==b&&c("!Big.RM!"));if(1>k||!g[0])d?(a.e=-e,a.Jd=[1]):a.Jd=[a.e=
0];else{g.length=k--;if(d)for(;9<++g[k];)g[k]=0,k--||(++a.e,g.unshift(1));for(k=g.length;!g[--k];g.pop());}}function c(a){a=Error(a);a.name="BigError";throw a;}var d=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,e=function(){function a(e){if(e instanceof a)this.me=e.me,this.e=e.e,this.Jd=e.Jd.slice();else{var b,g,k;0===e&&0>1/e?e="-0":d.test(e+="")||c(NaN);this.me="-"==e.charAt(0)?(e=e.slice(1),-1):1;-1<(b=e.indexOf("."))&&(e=e.replace(".",""));0<(g=e.search(/e/i))?(0>b&&(b=g),b+=+e.slice(g+1),e=e.substring(0,
g)):0>b&&(b=e.length);for(g=0;"0"==e.charAt(g);g++);if(g==(k=e.length))this.Jd=[this.e=0];else{for(;"0"==e.charAt(--k););this.e=b-g-1;this.Jd=[];for(b=0;g<=k;this.Jd[b++]=+e.charAt(g++));}}}a.prototype.abs=function(){var e=new a(this);e.me=1;return e};a.prototype.SF=function(){var e=0,b=this.Jd,g=(e=new a(e)).Jd,c=this.me,d=e.me,k=this.e,p=e.e;if(!b[0]||!g[0])return b[0]?c:g[0]?-d:0;if(c!=d)return c;e=0>c;if(k!=p)return k>(p^e)?1:-1;c=-1;for(d=(k=b.length)<(p=g.length)?k:p;++c<d;)if(b[c]!=g[c])return b[c]>
(g[c]^e)?1:-1;return k==p?0:k>(p^e)?1:-1};a.prototype.Wm=function(e){var g=this.Jd,d=(e=new a(e)).Jd,k=this.me==e.me?1:-1,n=a.bd;(n!==~~n||0>n||1E6<n)&&c("!Big.DP!");if(!g[0]||!d[0])return g[0]==d[0]&&c(NaN),d[0]||c(k/0),new a(0*k);var p,f,h,l,m=d.slice(),A=p=d.length,q=g.length,r=g.slice(0,p),t=r.length,u=e,v=u.Jd=[],w=0,x=n+(u.e=this.e-e.e)+1;u.me=k;k=0>x?0:x;for(m.unshift(0);t++<p;r.push(0));do{for(f=0;10>f;f++){if(p!=(t=r.length))h=p>t?1:-1;else for(l=-1,h=0;++l<p;)if(d[l]!=r[l]){h=d[l]>r[l]?
1:-1;break}if(0>h){for(e=t==p?d:m;t;){if(r[--t]<e[t]){for(l=t;l&&!r[--l];r[l]=9);--r[l];r[t]+=10}r[t]-=e[t]}for(;!r[0];r.shift());}else break}v[w++]=h?f:++f;r[0]&&h?r[t]=g[A]||0:r=[g[A]]}while((A++<q||void 0!==r[0])&&k--);v[0]||1==w||(v.shift(),u.e--);w>x&&b(u,n,a.Mg,void 0!==r[0]);return u};a.prototype.aU=function(){return 0<this.SF()};a.prototype.pV=function(){return 0>this.SF()};a.prototype.Zt=function(e){var b,g,c=this.me,d=(e=new a(e)).me;if(c!=d)return e.me=-d,this.EJ(e);var k=this.Jd.slice();
g=this.e;var n=e.Jd,p=e.e;if(!k[0]||!n[0])return n[0]?(e.me=-d,e):new a(k[0]?this:0);if(c=g-p){(b=0>c)?(c=-c,g=k):(p=g,g=n);g.reverse();for(d=c;d--;g.push(0));g.reverse()}else for(g=((b=k.length<n.length)?k:n).length,c=d=0;d<g;d++)if(k[d]!=n[d]){b=k[d]<n[d];break}b&&(g=k,k=n,n=g,e.me=-e.me);if(0<(d=(g=n.length)-(b=k.length)))for(;d--;k[b++]=0);for(d=b;g>c;){if(k[--g]<n[g]){for(b=g;b&&!k[--b];k[b]=9);--k[b];k[g]+=10}k[g]-=n[g]}for(;0==k[--d];k.pop());for(;0==k[0];)k.shift(),--p;k[0]||(e.me=1,k=[p=
0]);e.Jd=k;e.e=p;return e};a.prototype.EJ=function(e){var b,g=this.me;b=(e=new a(e)).me;if(g!=b)return e.me=-b,this.Zt(e);b=this.e;var c=this.Jd,d=e.e,k=e.Jd;if(!c[0]||!k[0])return k[0]?e:new a(c[0]?this:0*g);c=c.slice();if(g=b-d){0<g?(d=b,b=k):(g=-g,b=c);for(b.reverse();g--;b.push(0));b.reverse()}0>c.length-k.length&&(b=k,k=c,c=b);g=k.length;for(b=0;g;)b=(c[--g]=c[g]+k[g]+b)/10|0,c[g]%=10;b&&(c.unshift(b),++d);for(g=c.length;0==c[--g];c.pop());e.Jd=c;e.e=d;return e};a.prototype.pow=function(e){var b=
this,g=new a(1),d=g,k=0>e;(e!==~~e||-1E6>e||1E6<e)&&c("!pow!");for(e=k?-e:e;;){e&1&&(d=d.ds(b));e>>=1;if(!e)break;b=b.ds(b)}return k?g.Wm(d):d};a.prototype.round=function(e,g){var d=this;null==e?e=0:(e!==~~e||0>e||1E6<e)&&c("!round!");b(d=new a(d),e,null==g?a.Mg:g);return d};a.prototype.sqrt=function(){var e,g,d;g=this.Jd;e=this.me;d=this.e;var k=new a("0.5");if(!g[0])return new a(this);0>e&&c(NaN);e=Math.sqrt(this.toString());0==e||e==1/0?(e=g.join(""),e.length+d&1||(e+="0"),g=new a(Math.sqrt(e).toString()),
g.e=((d+1)/2|0)-(0>d||d&1)):g=new a(e.toString());e=g.e+(a.bd+=4);do d=g,g=k.ds(d.EJ(this.Wm(d)));while(d.Jd.slice(0,e).join("")!==g.Jd.slice(0,e).join(""));b(g,a.bd-=4,a.Mg);return g};a.prototype.ds=function(e){var b,g=this.Jd,c=(e=new a(e)).Jd,d=g.length,k=c.length,n=this.e,p=e.e;e.me=this.me==e.me?1:-1;if(!g[0]||!c[0])return new a(0*e.me);e.e=n+p;d<k&&(b=g,g=c,c=b,p=d,d=k,k=p);for(b=Array(p=d+k);p--;b[p]=0);for(n=k;n--;){k=0;for(p=d+n;p>n;)k=b[p]+c[n]*g[p-n-1]+k,b[p--]=k%10,k=k/10|0;b[p]=(b[p]+
k)%10}k&&++e.e;b[0]||b.shift();for(n=b.length;!b[--n];b.pop());e.Jd=b;return e};a.prototype.toString=function(){var a=this.e,e=this.Jd.join(""),b=e.length;if(-7>=a||21<=a)e=e.charAt(0)+(1<b?"."+e.slice(1):"")+(0>a?"e":"e+")+a;else if(0>a){for(;++a;e="0"+e);e="0."+e}else if(0<a)if(++a>b)for(a-=b;a--;e+="0");else a<b&&(e=e.slice(0,a)+"."+e.slice(a));else 1<b&&(e=e.charAt(0)+"."+e.slice(1));return 0>this.me&&this.Jd[0]?"-"+e:e};a.bd=20;a.Mg=1;return a}();a.Tp=e})(x||(x={}));(function(a){var b=function(){function b(a){this.Nf=
a}b.prototype.hs=function(e,b,c){var g=new a.b,d=new a.b,k=this.Nf;c.Gd(e,b,function(a,e){k.fc(2*a,g);k.fc(2*e,d);return g.compare(d)})};b.prototype.Qq=function(a){return this.Nf.read(2*a+1)};return b}(),c=function(){function c(){}c.Rq=function(e){if(e.u())return!1;var b=e.G();return 1736==b?0==e.hf()?!1:!0:1607==b?(b=[!1],c.nE(e,!0,b),b[0]):197==b||a.T.Oc(b)&&!e.OH()?!0:!1};c.Rm=function(e){var b=e.G();if(1736==b)return b=new a.Ua(e.description),e.u()||e.yE(b),b;if(1607==b)return c.nE(e,!1,null);
if(197==b)return b=new a.Ua(e.description),e.u()||b.jd(e,!1),b;if(a.T.Oc(b)){b=new a.Ed(e.description);if(!e.u()&&!e.OH()){var d=new a.Wa;e.Dp(d);b.add(d);e.Bp(d);b.add(d)}return b}if(a.T.Jo(b))return null;throw a.g.F();};c.nE=function(e,g,c){null!=c&&(c[0]=!1);var d=null;g||(d=new a.Ed(e.description));if(!e.u()){var k=new a.ia(0);k.yb(2*e.aa());for(var n=0,p=e.aa();n<p;n++)if(0<e.La(n)&&!e.Eo(n)){var f=e.wa(n);k.add(f);f=e.Gc(n)-1;k.add(f)}if(0<k.size){p=new a.Hu;n=e.Pa(0);p.sort(k,0,k.size,new b(n));
p=new a.b;n.fc(2*k.get(0),p);for(var f=0,h=1,l=new a.Wa,m=new a.b,A=1,q=k.size;A<q;A++)if(n.fc(2*k.get(A),m),m.ub(p))k.get(f)>k.get(A)?(k.set(f,2147483647),f=A):k.set(A,2147483647),h++;else{if(0==(h&1))k.set(f,2147483647);else if(g)return null!=c&&(c[0]=!0),null;p.L(m);f=A;h=1}if(0==(h&1))k.set(f,2147483647);else if(g)return null!=c&&(c[0]=!0),null;if(!g)for(k.Gd(0,k.size,function(a,e){return a-e}),A=0,q=k.size;A<q&&2147483647!=k.get(A);A++)e.Ae(k.get(A),l),d.add(l)}}return g?null:d};return c}();
a.Pi=c})(x||(x={}));(function(a){var b=function(){function b(){this.ag=new a.ia(0);this.ut=new a.ia(0);this.UI=1;this.At=NaN}b.prototype.sort=function(a,e,b,c){if(32>b-e)c.hs(e,b,a);else{var g=!0;try{for(var d=Infinity,k=-Infinity,n=e;n<b;n++){var p=c.Qq(a.get(n));p<d&&(d=p);p>k&&(k=p)}if(this.reset(b-e,d,k,b-e)){for(n=e;n<b;n++){var f=a.get(n),p=c.Qq(f),h=this.LG(p);this.ag.set(h,this.ag.get(h)+1);this.ut.write(n-e,f)}var l=this.ag.get(0);this.ag.set(0,0);for(var n=1,m=this.ag.size;n<m;n++){var A=
this.ag.get(n);this.ag.set(n,l);l+=A}for(n=e;n<b;n++){var f=this.ut.read(n-e),p=c.Qq(f),h=this.LG(p),q=this.ag.get(h);a.set(q+e,f);this.ag.set(h,q+1)}g=!1}}catch(ea){this.ag.resize(0),this.ut.resize(0)}if(g)c.hs(e,b,a);else{n=b=0;for(m=this.ag.size;n<m;n++)g=b,b=this.ag.get(n),b>g&&c.hs(e+g,e+b,a);100<this.ag.size&&(this.ag.resize(0),this.ut.resize(0))}}};b.prototype.reset=function(a,e,g,c){if(2>a||g==e)return!1;a=Math.min(b.RV,a);this.ag.yb(a);this.ag.resize(a);this.ag.Zh(0,0,this.ag.size);this.UI=
e;this.ut.resize(c);this.At=(g-e)/(a-1);return!0};b.prototype.LG=function(b){return a.J.truncate((b-this.UI)/this.At)};b.RV=65536;return b}();a.Hu=b})(x||(x={}));(function(a){var b;(function(a){a[a.enum_line=1]="enum_line";a[a.enum_arc=2]="enum_arc";a[a.enum_dummy=4]="enum_dummy";a[a.enum_concave_dip=8]="enum_concave_dip";a[a.enum_connection=3]="enum_connection"})(b||(b={}));var c=function(){function e(){}e.Ev=function(b,g,c,d,k,n){var y=new e;y.un=new a.b;y.In=new a.b;y.Ow=new a.b;y.un.L(b);y.In.L(g);
y.Ow.L(c);y.qp=d;y.Nh=k;y.Qh=n;return y};e.pa=function(b,g,c,d){var k=new e;k.un=new a.b;k.In=new a.b;k.Ow=new a.b;k.un.L(b);k.In.L(g);k.Ow.$c();k.qp=4;k.Nh=c;k.Qh=d;return k};return e}(),d=function(){function e(a,e,b,g,c,d){this.Lw=null;this.Ca=0;this.kB=a;this.oJ=this.mJ=0;this.Qa=e;this.fk=b;this.Wk=g;this.tr=c;this.mc=d}e.prototype.next=function(){for(var e=new a.Wa;;){if(this.Ca==this.kB.D())return null;this.kB.Ae(this.Ca,e);this.Ca++;if(!e.u())break}var b=!1;null==this.Lw&&(this.mJ=e.Be(),this.oJ=
e.nf(),this.Lw=n.buffer(e,this.Qa,this.fk,this.Wk,this.tr,this.mc),b=!0);var g;this.Ca<this.kB.D()?(g=new a.Ja,this.Lw.copyTo(g)):g=this.Lw;if(!b){var b=new a.Hd,c=e.Be()-this.mJ,e=e.nf()-this.oJ;b.Ag(c,e);g.Xc(b)}return g};e.prototype.Ia=function(){return 0};e.prototype.Re=function(){return!0};return e}(),e=function(){function e(a,e){this.$a=a;this.Ca=0;this.dr=e}e.prototype.next=function(){var e=this.$a.Y;if(this.Ca<e.aa()){var b=this.Ca;this.Ca++;if(!e.Eo(b))for(var g=e.Ba(e.Gc(b)-1);this.Ca<e.aa();){var c=
e.Ba(e.wa(this.Ca));if(e.Eo(this.Ca))break;if(c!=g)break;g=e.Ba(e.Gc(this.Ca)-1);this.Ca++}if(1==this.Ca-b)return this.$a.yF(this.$a.Y,b,this.dr);g=new a.Ua(this.$a.Y.description);g.Ti(this.$a.Y,b,!0);for(b+=1;b<this.Ca;b++)g.Bs(this.$a.Y,b,0,e.ew(b),!1);return this.$a.yF(g,0,this.dr)}return null};e.prototype.Ia=function(){return 0};e.prototype.Re=function(){return!0};return e}(),g=function(){function a(a){this.$a=a;this.Ca=0}a.prototype.next=function(){var a=this.$a.Y;if(this.Ca<a.aa()){var e=this.Ca;
a.Sm(this.Ca);for(this.Ca++;this.Ca<a.aa()&&!(0<a.Sm(this.Ca));)this.Ca++;return 0==e&&this.Ca==a.aa()?this.$a.Wy(a,0,a.aa()):this.$a.Wy(a,e,this.Ca)}return null};a.prototype.Ia=function(){return 0};a.prototype.Re=function(){return!0};return a}(),n=function(){function b(a){this.Ft=this.Zw=this.Gt=this.Wd=null;this.ue=[];this.mc=a;this.vb=this.xw=this.IV=this.Qa=this.$A=this.Vt=this.ta=0;this.XA=this.Wk=-1;this.dr=!0}b.buffer=function(e,g,c,d,k,n){if(null==e)throw a.g.F();if(0>d)throw a.g.F();if(e.u())return new a.Ja(e.description);
var y=new a.h;e.ac(y);0<g&&y.O(g,g);n=new b(n);n.fk=c;n.Y=e;n.ta=a.na.be(c,y,!0);n.Vt=a.na.be(null,y,!0);n.Qa=g;n.IV=e.G();0>=k&&(k=96);n.vb=Math.abs(n.Qa);n.xw=0!=n.vb?1/n.vb:0;isNaN(d)||0==d?d=1E-5*n.vb:d>.5*n.vb&&(d=.5*n.vb);12>k&&(k=12);e=Math.abs(g)*(1-Math.cos(Math.PI/k));e>d?d=e:(e=Math.PI/Math.acos(1-d/Math.abs(g)),e<k-1&&(k=a.J.truncate(e),12>k&&(k=12,d=Math.abs(g)*(1-Math.cos(Math.PI/k)))));n.Wk=d;n.tr=k;n.$A=Math.min(n.Vt,.25*d);return n.zF()};b.prototype.Rv=function(){if(null==this.Wd)this.Wd=
[];else if(0!==this.Wd.length)return;var e=this.DF(),e=a.J.truncate((e+3)/4),b=.5*Math.PI/e;this.XA=b;for(var g=0;g<4*e;g++)this.Wd.push(null);for(var c=Math.cos(b),b=Math.sin(b),d=a.b.pa(0,1),g=0;g<e;g++)this.Wd[g+0*e]=a.b.pa(d.y,-d.x),this.Wd[g+1*e]=a.b.pa(-d.x,-d.y),this.Wd[g+2*e]=a.b.pa(-d.y,d.x),this.Wd[g+3*e]=d,d=a.b.pa(d.x,d.y),d.qu(c,b)};b.prototype.zF=function(){var e=this.Y.G();if(a.T.Oc(e))return e=new a.Ua(this.Y.description),e.dc(this.Y,!0),this.Y=e,this.zF();if(this.Qa<=this.ta)if(a.T.PU(e)){if(0>=
this.Qa&&(e=new a.h,this.Y.s(e),e.N()<=2*-this.Qa||e.fa()<=2*this.Qa))return new a.Ja(this.Y.description)}else return new a.Ja(this.Y.description);switch(this.Y.G()){case 33:return this.TP();case 550:return this.SP();case 1607:return this.VP();case 1736:return this.UP();case 197:return this.QP();default:throw a.g.za();}};b.prototype.VP=function(){if(this.QH(this.Y)){var b=new a.Wa;this.Y.Ae(0,b);var g=new a.h;this.Y.s(g);b.rb(g.Wf());return this.rv(b)}this.Y=this.PW(this.Y);b=new e(this,this.dr);
return a.ei.local().V(b,this.fk,this.mc).next()};b.prototype.UP=function(){if(0==this.Qa)return this.Y;var e=a.Km.local();this.Rv();this.Y=e.V(this.Y,null,!1,this.mc);if(0>this.Qa){var b=this.Y,b=this.Wy(b,0,b.aa());return e.V(b,this.fk,!1,this.mc)}if(this.QH(this.Y))return e=new a.Wa,this.Y.Ae(0,e),b=new a.h,this.Y.s(b),e.rb(b.Wf()),this.rv(e);e=new g(this);return a.ei.local().V(e,this.fk,this.mc).next()};b.prototype.Wy=function(e,g,c){for(var d=new a.Ja(e.description);g<c;g++)if(!(1>e.La(g))){var k=
e.Sm(g),n=new a.h;e.jk(g,n);if(0<this.Qa)if(0<k)if(this.RH(e,g))k=new a.Wa,e.Ae(e.wa(g),k),k.rb(n.Wf()),this.iv(d,k);else{var y=k=new a.Ua(e.description),y=a.Ju.VH(this.Y,g)||2==this.to(this.Y,g,y,!0,1)?this.xF(e,g):this.so(k);d.add(y,!1)}else{if(!(n.N()+this.ta<=2*this.vb||n.fa()+this.ta<=2*this.vb||(y=k=new a.Ua(e.description),this.to(this.Y,g,y,!0,1),k.u()))){var f=new a.h;f.I(n);f.O(this.vb,this.vb);y.oq(f);y=this.so(k);n=1;for(k=y.aa();n<k;n++)d.Ti(y,n,!0)}}else if(0<k){if(!(n.N()+this.ta<=2*
this.vb||n.fa()+this.ta<=2*this.vb||(y=k=new a.Ua(e.description),this.to(this.Y,g,y,!0,-1),k.u())))for(f=new a.h,y.ac(f),f.O(this.vb,this.vb),y.oq(f),y=this.so(k),n=1,k=y.aa();n<k;n++)d.Ti(y,n,!0)}else for(y=k=new a.Ua(e.description),this.to(this.Y,g,y,!0,-1),y=this.so(k),n=0,k=y.aa();n<k;n++)d.Ti(y,n,!0)}if(0<this.Qa)return 1<d.aa()?d=this.so(d):b.We(d);e=new a.h;d.ac(e);if(d.u())return b.We(d);e.O(this.vb,this.vb);d.oq(e);d=this.so(d);e=new a.Ja(d.description);n=1;for(k=d.aa();n<k;n++)e.Ti(d,n,
!1);return b.We(e)};b.prototype.TP=function(){return this.rv(this.Y)};b.prototype.rv=function(e){var b=new a.Ja(this.Y.description);this.iv(b,e);return this.oY(b)};b.prototype.SP=function(){var e=new d(this.Y,this.Qa,this.fk,this.Wk,this.tr,this.mc);return a.ei.local().V(e,this.fk,this.mc).next()};b.prototype.QP=function(){var e=new a.Ja(this.Y.description);if(0>=this.Qa){if(0==this.Qa)e.jd(this.Y,!1);else{var b=new a.ci;this.Y.Qn(b);b.O(this.Qa,this.Qa);e.jd(b,!1)}return e}e.jd(this.Y,!1);this.Y=
e;return this.xF(e,0)};b.prototype.xF=function(e,g){this.Rv();var c=new a.Ja(e.description),d=new a.b,k=new a.b,n=new a.b,y=new a.b,f=new a.b,p=new a.b,B=new a.b,F=new a.b,h=e.La(g),l=e.wa(g),m=0;for(g=e.La(g);m<g;m++){e.w(l+m,k);e.w(l+(m+1)%h,y);e.w(l+(m+2)%h,p);B.yc(y,k);if(0==B.length())throw a.g.za();B.uw();B.normalize();B.scale(this.vb);d.add(B,k);n.add(B,y);0==m?c.zu(d):c.aj(d);c.aj(n);F.yc(p,y);if(0==F.length())throw a.g.za();F.uw();F.normalize();F.scale(this.vb);f.add(F,y);this.YE(c,y,n,f,
!1)}return b.We(c)};b.prototype.yF=function(e,b,g){this.Rv();if(1>e.La(b))return null;if(this.RH(e,b)&&0<this.Qa){g=new a.Wa;e.Ae(e.wa(b),g);var c=new a.h;e.jk(b,c);g.rb(c.Wf());return this.rv(g)}c=new a.Ua(e.description);if(e.Eo(b))this.to(e,b,c,g,1),this.to(e,b,c,g,-1);else{var d=new a.Ua(e.description);d.Ti(e,b,!1);d.Bs(e,b,0,e.ew(b),!1);this.to(d,0,c,g,1)}return this.so(c)};b.prototype.Pr=function(){this.kx++};b.prototype.so=function(e){return a.Dg.nl(e,this.Vt,!0,!0,this.mc)};b.prototype.DF=
function(){if(0==this.Wk)return this.tr;var e=1-this.Wk*Math.abs(this.xw),b;-1>e?b=4:b=2*Math.PI/Math.acos(e)+.5;4>b?b=4:b>this.tr&&(b=this.tr);return a.J.truncate(b)};b.prototype.YE=function(e,b,g,c,d){this.Rv();var k=new a.b;k.yc(g,b);k.scale(this.xw);var n=new a.b;n.yc(c,b);n.scale(this.xw);k=Math.atan2(k.y,k.x)/this.XA;0>k&&(k=this.Wd.length+k);k=this.Wd.length-k;n=Math.atan2(n.y,n.x)/this.XA;0>n&&(n=this.Wd.length+n);n=this.Wd.length-n;n<k&&(n+=this.Wd.length);var y=a.J.truncate(n),n=a.J.truncate(Math.ceil(k)),
k=new a.b;k.L(this.Wd[n%this.Wd.length]);k.ru(this.vb,b);var f=10*this.ta;k.sub(g);k.length()<f&&(n+=1);k.L(this.Wd[y%this.Wd.length]);k.ru(this.vb,b);k.sub(c);k.length()<f&&--y;g=y-n;g++;y=0;for(n%=this.Wd.length;y<g;y++,n=(n+1)%this.Wd.length)k.L(this.Wd[n]),k.ru(this.vb,b),e.aj(k),this.Pr();d&&e.aj(c)};b.prototype.to=function(e,b,g,d,k){var n=new a.fd,y=n.lP(e,b);n.zq(this.$A,!1,!1);if(2>n.D(y)){if(0>k)return 1;k=e;n=new a.Wa;k.Ae(k.wa(b),n);this.iv(g,n);return 1}var f=n.Ba(n.cb(n.Pb(y))),p=new a.Hd;
p.Ag(-f.x,-f.y);n.Xc(p);if(d&&(this.pS(n,y,k),2>n.D(y))){if(0>k)return 1;k=e;n=new a.Wa;k.Ae(k.wa(b),n);this.iv(g,n);return 1}this.ue.length=0;var B=n.Pb(y);b=n.cb(B);var F=1==k?n.Ra(b):n.U(b);e=1==k?n.U(b):n.Ra(b);var H=!0;d=new a.b;for(var y=new a.b,h=new a.b,l=new a.b,m=new a.b,M=new a.b,A=new a.b,q=new a.b,X=new a.b,r=new a.b,t=this.vb,B=n.La(B),u=0;u<B;u++)n.w(e,y),H&&(n.w(b,d),n.w(F,h),q.yc(d,h),q.normalize(),r.aI(q),r.scale(t),l.add(r,d)),A.yc(y,d),A.normalize(),X.aI(A),X.scale(t),m.add(d,
X),F=q.Ui(A),H=q.oi(A),0>F||0>H&&0==F?this.ue.push(c.Ev(l,m,d,2,this.ue.length+1,this.ue.length-1)):l.ub(m)||(this.ue.push(c.pa(l,d,this.ue.length+1,this.ue.length-1,"dummy")),this.ue.push(c.pa(d,m,this.ue.length+1,this.ue.length-1,"dummy"))),M.add(y,X),this.ue.push(c.Ev(m,M,d,1,this.ue.length+1,this.ue.length-1)),l.L(M),r.L(X),h.L(d),d.L(y),q.L(A),F=b,b=e,H=!1,e=1==k?n.U(b):n.Ra(b);this.ue[this.ue.length-1].Nh=0;this.ue[0].Qh=this.ue.length-1;this.RW(g);p.Ag(f.x,f.y);g.lF(p,g.aa()-1);return 1};b.prototype.RW=
function(a){for(var e=this.DQ(),b=!0,g=e+1,c=e;g!=e;c=g){var d=this.ue[c],g=-1!=d.Nh?d.Nh:(c+1)%this.ue.length;0!=d.qp&&(b&&a.zu(d.un),2==d.qp?this.YE(a,d.Ow,d.un,d.In,!0):a.aj(d.In),b=!1)}};b.prototype.DQ=function(){null==this.Ft&&(this.Ft=[null,null,null,null,null,null,null,null,null]);for(var e=0,b=0,g=this.ue.length;b<g;){var c=this.ue[b];if(0!=(c.qp&3)){e=b;break}b=c.Nh}g=e+1;for(b=e;g!=e;b=g){for(var c=this.ue[b],g=c.Nh,d=1,k=null;g!=b;){k=this.ue[g];if(0!=(k.qp&3))break;g=k.Nh;d++}1!=d&&1==
(c.qp&k.qp)&&(null==this.Gt&&(this.Gt=new a.Hb,this.Zw=new a.Hb),this.Gt.Mc(c.un),this.Gt.Zc(c.In),this.Zw.Mc(k.un),this.Zw.Zc(k.In),1==this.Gt.Ma(this.Zw,this.Ft,null,null,this.Vt)&&(c.In.L(this.Ft[0]),k.un.L(this.Ft[0]),c.Nh=g,k.Qh=b))}return e};b.prototype.sw=function(e,b,g){var c=new a.b;c.yc(g,e);g=c.length();g=this.vb*this.vb-g*g*.25;if(0<g){g=Math.sqrt(g);c.normalize();c.Ur();var d=new a.b;d.yc(b,e);if(d.oi(c)+g>=this.vb)return!0}return!1};b.prototype.pS=function(e,b,g){for(var c=0;1>c;c++){var d=
!1,k=e.Pb(b),n=e.La(k);if(0==n)break;var y=n;if(3>n)break;!e.Qb(k)&&(y=n-1);for(var k=e.cb(k),n=0<g?e.Ra(k):e.U(k),f=0<g?e.U(k):e.Ra(k),p=n,B=!0,F=new a.b,H=new a.b,h=new a.b,l=new a.b,m=new a.b,A=a.b.pa(0,0),q=new a.b,r=new a.b,t=new a.b,u=new a.b,v=this.vb,w=0,x=0;x<y;){e.w(f,H);B&&(e.w(k,F),e.w(n,h),p=n);r.yc(F,h);r.normalize();q.yc(H,F);q.normalize();if(p==f)break;var z=r.Ui(q),L=r.oi(q),C=!0;0>z||0>L&&0==z||!this.sw(h,F,H)||(A.L(H),C=!1,++w,d=!0);if(C){if(0<w)for(;;){z=0<g?e.Ra(p):e.U(p);if(z==
k)break;e.w(z,l);if(this.sw(l,h,A))h.L(l),p=z,C=!1,++w;else{z!=f&&this.sw(l,h,H)&&this.sw(l,F,H)&&(h.L(l),p=z,C=!1,++w);break}}if(!C)continue;if(0<w){p=0<g?e.Ra(n):e.U(n);for(B=1;B<w;B++)C=0<g?e.Ra(p):e.U(p),e.ud(p,!0),p=C;t.yc(F,h);w=t.length();w=v*v-w*w*.25;w=Math.sqrt(w);v-w>.5*this.Wk?(m.add(h,F),m.scale(.5),t.normalize(),t.Ur(),u.L(t),u.scale(v-w),m.add(u),e.Qf(n,m)):e.ud(n,!0);w=0}h.L(F);p=k}F.L(H);n=k;k=f;f=0<g?e.U(k):e.Ra(k);x++;B=!1}if(0<w){p=0<g?e.Ra(n):e.U(n);for(B=1;B<w;B++)C=0<g?e.Ra(p):
e.U(p),e.ud(p,!0),p=C;m.add(h,F);m.scale(.5);t.yc(F,h);w=t.length();w=v*v-w*w*.25;w=Math.sqrt(w);t.normalize();t.Ur();u.L(t);u.scale(v-w);m.add(u);e.Qf(n,m)}e.zq(this.$A,!1,!1);if(!d)break}};b.prototype.RH=function(e,b){if(1==e.La(b))return!0;var g=new a.h;e.jk(b,g);return Math.max(g.N(),g.fa())<.5*this.Wk?!0:!1};b.prototype.QH=function(e){var b=new a.h;e.s(b);return Math.max(b.N(),b.fa())<.5*this.Wk?!0:!1};b.prototype.PW=function(e){e=a.HD.local().V(e,.25*this.Wk,!1,this.mc);for(var b=0,g=0,c=e.aa();g<
c;g++)b=Math.max(e.La(g),b);if(32>b)return this.dr=!1,e;this.dr=!0;return a.Dg.nl(e,this.Vt,!1,!0,this.mc)};b.prototype.iv=function(e,b){b=b.w();if(null!=this.Wd&&0!==this.Wd.length){var g=new a.b;g.L(this.Wd[0]);g.ru(this.vb,b);e.zu(g);for(var c=1,d=this.Wd.length;c<d;c++)g.L(this.Wd[c]),g.ru(this.vb,b),e.aj(g)}else for(var c=this.DF(),g=a.J.truncate((c+3)/4),c=.5*Math.PI/g,d=Math.cos(c),k=Math.sin(c),n=new a.b,y=3;0<=y;y--){n.ka(0,this.vb);switch(y){case 0:for(c=0;c<g;c++)e.Xj(n.x+b.x,n.y+b.y),
n.qu(d,k);break;case 1:for(c=0;c<g;c++)e.Xj(-n.y+b.x,n.x+b.y),n.qu(d,k);break;case 2:for(c=0;c<g;c++)e.Xj(-n.x+b.x,-n.y+b.y),n.qu(d,k);break;default:for(e.$x(n.y+b.x,-n.x+b.y),c=1;c<g;c++)n.qu(d,k),e.Xj(n.y+b.x,-n.x+b.y)}this.Pr()}};b.We=function(a){a.Zg(1,0);return a};b.prototype.oY=function(a){a.Zg(2,this.ta);a.Al();return a};return b}();a.QL=n})(x||(x={}));(function(a){var b=function(){function b(b){this.Ha=b;this.a=new a.fd;this.nd=new a.ia(0)}b.prototype.ji=function(a,e,b){switch(e){case 0:if(a.o<
b&&a.v<=b)break;else return a.o>=b?1:-1;case 1:if(a.A<b&&a.B<=b)break;else return a.A>=b?1:-1;case 2:if(a.o>=b&&a.v>b)break;else return a.v<=b?1:-1;case 3:if(!(a.A>=b&&a.B>b))return a.B<=b?1:-1}return 0};b.prototype.hz=function(a,e,b){return 1736==a.G()?this.iz(a,e,b):this.jz(a,e)};b.prototype.iz=function(b,e,g){if(0==this.Ha.N()||0==this.Ha.fa())return b.Ka();e=new a.h;b.ac(e);this.Y=this.a.Jb(b);var c=new a.h,d=new a.h,k=new a.b,f=new a.b,p=[0,0,0,0,0,0,0,0,0],h=[0,0,0,0,0,0,0,0,0];new a.Cg;var l=
new a.Hb,m=new a.ia(0);m.yb(Math.min(100,b.D()));for(var A=!1,q=0;!A&&4>q;q++){var r=!1,t=0!=(q&1),u=0;switch(q){case 0:u=this.Ha.o;r=e.o<=u&&e.v>=u;break;case 1:u=this.Ha.A;r=e.A<=u&&e.B>=u;break;case 2:u=this.Ha.v;r=e.o<=u&&e.v>=u;break;case 3:u=this.Ha.B,r=e.A<=u&&e.B>=u}if(r)for(A=!0,r=this.a.Pb(this.Y);-1!=r;){var v=-1,w=-1,x=this.a.cb(r),z=x;do{var L=this.a.ic(z);null==L&&(L=l,this.a.w(z,k),L.Mc(k),this.a.w(this.a.U(z),f),L.Zc(f));L.s(c);var C=this.ji(c,q,u),D=0,E=-1;if(-1==C){L=L.Tq(t,u,p,
h);0<L?D=this.a.zm(z,h,L):D=0;for(var D=D+1,G=z,J=this.a.U(G),L=0;L<D;L++){this.a.w(G,k);this.a.w(J,f);E=this.a.ic(G);null==E&&(E=l,E.Mc(k),E.Zc(f));E.s(d);E=this.ji(d,q,u);if(-1==E){if(t)E=Math.abs(k.y-u),I=Math.abs(f.y-u),E<I?(k.y=u,this.a.Qf(G,k)):(f.y=u,this.a.Qf(J,f));else{var E=Math.abs(k.x-u),I=Math.abs(f.x-u);E<I?(k.x=u,this.a.Qf(G,k)):(f.x=u,this.a.Qf(J,f))}E=this.a.ic(G);null==E&&(E=l,E.Mc(k),E.Zc(f));E.s(d);E=this.ji(d,q,u)}I=v;v=E;-1==w&&(w=v);if(0!=I||1!=v)1==I&&0==v||0!=I||0!=v||m.add(G);
1==v&&(A=!1);E=G=J;J=this.a.U(J)}}if(0==D){I=v;v=C;-1==w&&(w=v);if(0!=I||1!=v)1==I&&0==v||0!=I||0!=v||m.add(z);1==v&&(A=!1);E=this.a.U(z)}z=E}while(z!=x);0==w&&0==v&&m.add(x);L=0;for(v=m.size;L<v;L++)w=m.get(L),this.a.ud(w,!1);m.clear(!1);r=3>this.a.La(r)?this.a.Rr(r):this.a.Sb(r)}}if(A)return b.Ka();this.gC();0<g&&this.vz(g);return this.a.Se(this.Y)};b.prototype.jz=function(b){var e=new a.h,g=new a.h,c=[0,0,0,0,0,0,0,0,0],d=[0,0,0,0,0,0,0,0,0],k=new a.Cg,f=b,p=new a.h;b.ac(p);for(var h=0;4>h;h++){var l=
!1,m=0!=(h&1),A=0;switch(h){case 0:A=this.Ha.o;l=p.o<=A&&p.v>=A;break;case 1:A=this.Ha.A;l=p.A<=A&&p.B>=A;break;case 2:A=this.Ha.v;l=p.o<=A&&p.v>=A;break;case 3:A=this.Ha.B,l=p.A<=A&&p.B>=A}if(l){l=f;f=b.Ka();l=l.Fa();l.yj();for(var q,r=new a.b;l.Ya();)for(var t,u=!0;l.Ea();){var v=l.ba();v.s(e);var w=this.ji(e,h,A);if(-1==w){if(w=v.Tq(m,A,c,d),0<w){var x=0;q=v.ec();for(var z=0;z<=w;z++)if(t=z<w?d[z]:1,x!=t){v.yh(x,t,k);var L=k.get();L.Mc(q);z<w&&(m?(r.x=c[z],r.y=A):(r.x=A,r.y=c[z]),L.Zc(r));L.s(g);
var C=this.ji(g,h,A);if(-1==C){q=L.ec();x=L.Bc();if(m)C=Math.abs(q.y-A),D=Math.abs(x.y-A),C<D?(q.y=A,L.Mc(q)):(x.y=A,L.Zc(x));else{var C=Math.abs(q.x-A),D=Math.abs(x.x-A);C<D?(q.x=A,L.Mc(q)):(x.x=A,L.Zc(x))}L.s(g);C=this.ji(g,h,A)}q=L.Bc();x=t;t=C;1==t?(f.dc(L,u),u=!1):u=!0}}}else t=w,1==t?(f.dc(v,u),u=!1):u=!0}}}return f};b.prototype.gC=function(){this.Ki=-1;this.Am(!1,this.Ha.o);this.Am(!1,this.Ha.v);this.Am(!0,this.Ha.A);this.Am(!0,this.Ha.B);this.nd.resize(0);this.nd.yb(100);this.Ki=this.a.Ud();
for(var b=new a.b,e=this.a.Pb(this.Y);-1!=e;e=this.a.Sb(e))for(var g=this.a.cb(e),c=0,d=this.a.La(e);c<d;c++,g=this.a.U(g))if(this.a.w(g,b),this.Ha.o==b.x||this.Ha.v==b.x||this.Ha.A==b.y||this.Ha.B==b.y)this.a.Va(g,this.Ki,this.nd.size),this.nd.add(g);this.sm(!1,this.Ha.o);this.sm(!1,this.Ha.v);this.sm(!0,this.Ha.A);this.sm(!0,this.Ha.B);this.Dz()};b.prototype.vz=function(b){for(var e=new a.b,g=new a.b,c=a.J.gf(2048,0),d=this.a.Pb(this.Y);-1!=d;d=this.a.Sb(d)){var k=this.a.cb(d),f=k;do{var p=this.a.U(f);
this.a.w(f,e);var h=-1;e.x==this.Ha.o?(this.a.w(p,g),g.x==this.Ha.o&&(h=1)):e.x==this.Ha.v&&(this.a.w(p,g),g.x==this.Ha.v&&(h=1));e.y==this.Ha.A?(this.a.w(p,g),g.y==this.Ha.A&&(h=0)):e.y==this.Ha.B&&(this.a.w(p,g),g.y==this.Ha.B&&(h=0));if(-1!=h&&(h=a.b.Cb(e,g),h=a.J.truncate(Math.min(Math.ceil(h/b),2048)),!(1>=h))){for(var l=1;l<h;l++)c[l-1]=1*l/h;this.a.zm(f,c,h-1)}f=p}while(f!=k)}};b.prototype.Am=function(b,e){var g=this.a.Ud(),c=new a.b,d=new a.ia(0);d.yb(100);for(var k=this.a.Pb(this.Y);-1!=
k;k=this.a.Sb(k))for(var f=this.a.cb(k),p=0,h=this.a.La(k);p<h;p++){var l=this.a.U(f);this.a.w(f,c);if(b?c.y==e:c.x==e)if(this.a.w(l,c),b?c.y==e:c.x==e)1!=this.a.Sa(f,g)&&(d.add(f),this.a.Va(f,g,1)),1!=this.a.Sa(l,g)&&(d.add(l),this.a.Va(l,g,1));f=l}this.a.le(g);if(!(3>d.size)){var m=this;d.Gd(0,d.size,function(a,e){return m.ki(a,e)});g=new a.b;k=new a.b;f=new a.b;k.$c();for(var A=-1,p=new a.ia(0),h=new a.ia(0),l=this.a.Ud(),q=this.a.Ud(),r=0,t=d.size;r<t;r++){var u=d.get(r);this.a.w(u,c);if(!c.ub(k)){if(-1!=
A){for(var v=A;v<r;v++){var A=d.get(v),w=this.a.U(A),u=this.a.Ra(A),x=!1;0>this.ki(A,w)&&(this.a.w(w,g),b?g.y==e:g.x==e)&&(p.add(A),x=!0,this.a.Va(A,q,1));0>this.ki(A,u)&&(this.a.w(u,g),b?g.y==e:g.x==e)&&(x||p.add(A),this.a.Va(A,l,1))}v=0;for(x=p.size;v<x;v++){A=p.get(v);u=this.a.Sa(A,l);w=this.a.Sa(A,q);if(1==u){u=this.a.Ra(A);this.a.w(u,f);var z=[0];z[0]=0;if(!f.ub(c)){var L=a.b.Cb(k,f);z[0]=a.b.Cb(f,c)/L;0==z[0]?z[0]=2.220446049250313E-16:1==z[0]&&(z[0]=.9999999999999998);this.a.zm(u,z,1);u=this.a.Ra(A);
this.a.Qf(u,c);h.add(u);this.a.Va(u,l,1);this.a.Va(u,q,-1)}}1==w&&(w=this.a.U(A),this.a.w(w,f),z=[0],z[0]=0,f.ub(c)||(L=a.b.Cb(k,f),z[0]=a.b.Cb(k,c)/L,0==z[0]?z[0]=2.220446049250313E-16:1==z[0]&&(z[0]=.9999999999999998),this.a.zm(A,z,1),u=this.a.U(A),this.a.Qf(u,c),h.add(u),this.a.Va(u,l,-1),this.a.Va(u,q,1)))}A=p;p=h;h=A;h.clear(!1)}A=r;k.L(c)}}this.a.le(l);this.a.le(q)}};b.prototype.sm=function(b,e){var g=new a.b,c=new a.ia(0);c.yb(100);for(var d=this.a.Ud(),k=0,f=this.nd.size;k<f;k++){var p=this.nd.get(k);
if(-1!=p){var h=this.a.U(p);this.a.w(p,g);if(b?g.y==e:g.x==e)if(this.a.w(h,g),b?g.y==e:g.x==e)-2!=this.a.Sa(p,d)&&(c.add(p),this.a.Va(p,d,-2)),-2!=this.a.Sa(h,d)&&(c.add(h),this.a.Va(h,d,-2))}}if(0!=c.size){var l=this;c.Gd(0,c.size,function(a,e){return l.ki(a,e)});k=0;for(f=c.size;k<f;k++){var m=c.get(k);this.a.Va(m,d,k)}p=new a.b;h=new a.b;h.$c();for(var A=-1,k=0,f=c.size;k<f;k++)if(m=c.get(k),-1!=m&&(this.a.w(m,g),!g.ub(h))){if(-1!=A)for(;;){for(var m=!1,q=1<k-A?k-1:k,r=A;r<q;r++){var t=c.get(r);
if(-1!=t){var u=-1,v=this.a.U(t);0>this.ki(t,v)&&(this.a.w(v,p),b?p.y==e:p.x==e)&&(u=v);var v=-1,w=this.a.Ra(t);0>this.ki(t,w)&&(this.a.w(w,p),b?p.y==e:p.x==e)&&(v=w);if(-1!=u&&-1!=v)this.ii(t,c,d),this.a.ud(t,!1),this.ii(u,c,d),this.a.ud(u,!1),m=!0;else if(-1!=u||-1!=v){for(w=r+1;w<k;w++){var x=c.get(w);if(-1!=x){var z=this.a.U(x),L=-1;0>this.ki(x,z)&&(this.a.w(z,p),b?p.y==e:p.x==e)&&(L=z);var z=this.a.Ra(x),C=-1;0>this.ki(x,z)&&(this.a.w(z,p),b?p.y==e:p.x==e)&&(C=z);if(-1!=L&&-1!=C){this.ii(x,c,
d);this.a.ud(x,!1);this.ii(L,c,d);this.a.ud(L,!1);m=!0;break}if(-1!=u&&-1!=C){this.ou(c,t,u,x,C,d);m=!0;break}else if(-1!=v&&-1!=L){this.ou(c,x,L,t,v,d);m=!0;break}}}if(m)break}}}if(!m)break}A=k;h.L(g)}}this.a.le(d)};b.prototype.ii=function(a,e,b){b=this.a.Sa(a,b);e.set(b,-1);b=this.a.Sa(a,this.Ki);this.nd.set(b,-1);e=this.a.ld(a);-1!=e&&this.a.cb(e)==a&&(this.a.jg(e,-1),this.a.sh(e,-1))};b.prototype.ou=function(a,e,b,c,d,f){this.a.Kc(e,c);this.a.Lc(c,e);this.a.Lc(b,d);this.a.Kc(d,b);this.ii(c,a,
f);this.a.Mi(c,!1);this.ii(d,a,f);this.a.Mi(d,!0)};b.prototype.Dz=function(){for(var a=0,e=this.nd.size;a<e;a++){var b=this.nd.get(a);-1!=b&&this.a.Aj(b,-1)}for(var c=0,d=0,f=this.a.Pb(this.Y);-1!=f;){var p=this.a.cb(f);if(-1==p||f!=this.a.ld(p)){var h=f,f=this.a.Sb(f);this.a.jg(h,-1);this.a.Sr(h)}else{b=p;h=0;do this.a.Aj(b,f),h++,b=this.a.U(b);while(b!=p);2>=h?(b=this.a.Sa(p,this.Ki),this.nd.set(b,-1),p=this.a.ud(p,!1),2==h&&(b=this.a.Sa(p,this.Ki),this.nd.set(b,-1),this.a.ud(p,!1)),h=f,f=this.a.Sb(f),
this.a.jg(h,-1),this.a.Sr(h)):(this.a.Np(f,!1),this.a.sh(f,this.a.Ra(p)),this.a.nk(f,h),d+=h,c++,f=this.a.Sb(f))}}a=0;for(e=this.nd.size;a<e;a++)if(b=this.nd.get(a),-1!=b&&(f=this.a.ld(b),-1==f)){f=this.a.Yf(this.Y,-1);h=0;p=b;do this.a.Aj(b,f),h++,b=this.a.U(b);while(b!=p);2>=h?(b=this.a.Sa(p,this.Ki),this.nd.set(b,-1),p=this.a.ud(p,!1),2==h&&(b=this.a.Sa(p,this.Ki),0<=b&&this.nd.set(b,-1),this.a.ud(p,!1)),h=f,this.a.jg(h,-1),this.a.Sr(h)):(this.a.$n(f,!0),this.a.nk(f,h),this.a.jg(f,p),this.a.sh(f,
this.a.Ra(p)),this.a.Np(f,!1),d+=h,c++)}this.a.wm(this.Y,c);this.a.lk(this.Y,d);a=0;for(e=this.a.rd;-1!=e;e=this.a.Ue(e))a+=this.a.D(e);this.a.AC(a)};b.Hm=function(a,e,g,c){return(new b(e)).hz(a,g,c)};b.clip=function(c,e,g,d){if(c.u())return c;if(e.u())return c.Ka();var k=c.G();if(33==k)return g=c.w(),e.contains(g)?c:c.Ka();if(197==k)return g=new a.h,c.s(g),g.Ma(e)?(e=new a.ci,c.copyTo(e),e.Gp(g),e):c.Ka();var n=new a.h;c.ac(n);if(e.contains(n))return c;if(!e.Yb(n))return c.Ka();n=c.ob;if(null!=n&&
(n=n.Hi,null!=n)){n=n.Rn(e);if(1==n){if(1736!=k)throw a.g.za();c=new a.Ja(c.description);c.oq(e);return c}if(0==n)return c.Ka()}switch(k){case 550:d=null;for(var k=c.D(),n=c.Pa(0),f=0,p=0;p<k;p++)g=new a.b,n.fc(2*p,g),e.contains(g)||(0==f&&(d=c.Ka()),f<p&&d.Id(c,f,p),f=p+1);0<f&&d.Id(c,f,k);return 0==f?c:d;case 1736:case 1607:return b.Hm(c,e,g,d);default:throw a.g.za();}};b.prototype.ki=function(b,e){var g=new a.b;this.a.w(b,g);b=new a.b;this.a.w(e,b);return g.compare(b)};return b}();a.ne=b})(x||
(x={}));(function(a){var b=function(){function b(b,e){this.Ha=b;this.a=new a.fd;this.nd=new a.ia(0);this.ke=e}b.prototype.ji=function(a,e,b){switch(e){case 0:if(a.o<b&&a.v<=b)break;else return a.o>=b?1:-1;case 1:if(a.A<b&&a.B<=b)break;else return a.A>=b?1:-1;case 2:if(a.o>=b&&a.v>b)break;else return a.v<=b?1:-1;case 3:if(!(a.A>=b&&a.B>b))return a.B<=b?1:-1}return 0};b.prototype.hz=function(a,e,b){return 1736==a.G()?this.iz(a,e,b):this.jz(a,e)};b.prototype.iz=function(b,e,g){if(0==this.Ha.N()||0==
this.Ha.fa())return b.Ka();e=new a.h;b.ac(e);this.Y=this.a.Jb(b);var c=new a.h,d=new a.h,k=new a.b,f=new a.b,p=[0,0,0,0,0,0,0,0,0],h=[0,0,0,0,0,0,0,0,0],l=new a.Hb,m=new a.ia(0);m.yb(256);for(var A=!1,q=0;!A&&4>q;q++){var r=!1,t=0!=(q&1),u=0;switch(q){case 0:u=this.Ha.o;r=e.o<=u&&e.v>=u;break;case 1:u=this.Ha.A;r=e.A<=u&&e.B>=u;break;case 2:u=this.Ha.v;r=e.o<=u&&e.v>=u;break;case 3:u=this.Ha.B,r=e.A<=u&&e.B>=u}if(r)for(A=!0,r=this.a.Pb(this.Y);-1!=r;){var v=!0,w=-1,x=-1,z=this.a.cb(r),L=z;do{var C=
this.a.ic(L);null==C&&(C=l,this.a.w(L,k),C.Mc(k),this.a.w(this.a.U(L),f),C.Zc(f));C.s(c);var D=this.ji(c,q,u),E=0,G=-1;if(-1==D){C=C.Tq(t,u,p,h);0<C?E=this.a.FY(L,h,C):E=0;for(var E=E+1,I=L,J=this.a.U(I),C=0;C<E;C++){this.a.w(I,k);this.a.w(J,f);G=this.a.ic(I);null==G&&(G=l,G.Mc(k),G.Zc(f));G.s(d);G=this.ji(d,q,u);if(-1==G){if(t)G=Math.abs(k.y-u),K=Math.abs(f.y-u),G<K?(k.y=u,this.a.Qf(I,k)):(f.y=u,this.a.Qf(J,f));else{var G=Math.abs(k.x-u),K=Math.abs(f.x-u);G<K?(k.x=u,this.a.Qf(I,k)):(f.x=u,this.a.Qf(J,
f))}G=this.a.ic(I);null==G&&(G=l,G.Mc(k),G.Zc(f));G.s(d);G=this.ji(d,q,u)}K=w;w=G;-1==x&&(x=w);if(0!=K||1!=w)1==K&&0==w||0!=K||0!=w||m.add(I);1==w&&(v=A=!1);G=I=J;J=this.a.U(J)}}if(0==E){K=w;w=D;-1==x&&(x=w);if(0!=K||1!=w)1==K&&0==w||0!=K||0!=w||m.add(L);1==w&&(v=A=!1);G=this.a.U(L)}L=G;if(256<=m.size){C=1;for(D=m.size-1;C<D;C++)E=m.get(C),this.a.ud(E,!1);m.set(1,m.Fc());m.yf(2)}}while(L!=z);if(!v)for(0==x&&0==w&&m.add(z),C=0,D=m.size;C<D;C++)E=m.get(C),this.a.ud(E,!1);m.clear(!1);r=v||0==this.a.La(r)?
this.a.Rr(r):this.a.Sb(r)}}if(A)return b.Ka();this.gC();0<g&&this.vz(g);return this.a.Se(this.Y)};b.prototype.jz=function(b){var e=new a.h,g=new a.h,c=[0,0,0,0,0,0,0,0,0],d=[0,0,0,0,0,0,0,0,0],k=new a.Cg,f=b,p=new a.h;b.ac(p);for(var h=new a.b,l=new a.b,m=null,A=null,q=0;4>q;q++){var r=!1,t=0!=(q&1),u=0;switch(q){case 0:u=this.Ha.o;r=p.o<=u&&p.v>=u;break;case 1:u=this.Ha.A;r=p.A<=u&&p.B>=u;break;case 2:u=this.Ha.v;r=p.o<=u&&p.v>=u;break;case 3:u=this.Ha.B,r=p.A<=u&&p.B>=u}if(r)for(r=f,f=b.Ka(),r=
r.Fa(),r.yj();r.Ya();)for(var v,w=!0;r.Ea();){var x=r.ba();x.s(e);var z=this.ji(e,q,u);if(-1==z){if(z=x.Tq(t,u,c,d),0<z){var L=0;x.Oq(h);for(var C=0;C<=z;C++)if(v=C<z?d[C]:1,L!=v){x.yh(L,v,k);var D=k.get();D.Mc(h);C<z&&(t?(l.x=c[C],l.y=u):(l.x=u,l.y=c[C]),D.Zc(l));D.s(g);var E=this.ji(g,q,u);-1==E&&(null==m&&(m=new a.b),null==A&&(A=new a.b),D.Oq(m),D.Ps(A),t?(L=Math.abs(m.y-u),E=Math.abs(A.y-u),L<E?(m.y=u,D.Mc(m)):(A.y=u,D.Zc(A))):(L=Math.abs(m.x-u),E=Math.abs(A.x-u),L<E?(m.x=u,D.Mc(m)):(A.x=u,D.Zc(A))),
D.s(g),E=this.ji(g,q,u));D.Ps(h);L=v;v=E;1==v?(f.dc(D,w),w=!1):w=!0}}}else v=z,1==v?(f.dc(x,w),w=!1):w=!0}}return f};b.prototype.gC=function(){this.Ki=-1;this.Am(!1,this.Ha.o);this.Am(!1,this.Ha.v);this.Am(!0,this.Ha.A);this.Am(!0,this.Ha.B);this.nd.resize(0);this.nd.yb(100);this.Ki=this.a.Ud();for(var b=new a.b,e=this.a.Pb(this.Y);-1!=e;e=this.a.Sb(e))for(var g=this.a.cb(e),c=0,d=this.a.La(e);c<d;c++,g=this.a.U(g))if(this.a.w(g,b),this.Ha.o==b.x||this.Ha.v==b.x||this.Ha.A==b.y||this.Ha.B==b.y)this.a.Va(g,
this.Ki,this.nd.size),this.nd.add(g);this.sm(!1,this.Ha.o);this.sm(!1,this.Ha.v);this.sm(!0,this.Ha.A);this.sm(!0,this.Ha.B);this.Dz()};b.prototype.vz=function(b){for(var e=new a.b,g=new a.b,c=null,d=null,k=a.J.gf(2048,0),f=this.a.Pb(this.Y);-1!=f;f=this.a.Sb(f)){var p=this.a.cb(f),h=p;do{var l=this.a.U(h);this.a.w(h,e);var m=-1;e.x==this.Ha.o?(this.a.w(l,g),g.x==this.Ha.o&&(m=1)):e.x==this.Ha.v&&(this.a.w(l,g),g.x==this.Ha.v&&(m=1));e.y==this.Ha.A?(this.a.w(l,g),g.y==this.Ha.A&&(m=0)):e.y==this.Ha.B&&
(this.a.w(l,g),g.y==this.Ha.B&&(m=0));if(-1!=m){null==c&&(c=new a.b);null==d&&(d=new a.b);c.L(e);d.ka(0,0);if(0==m){var A=e.x-this.Ha.o;d.x=a.Ub.sign(g.x-e.x);c.x=b*a.Ub.Fl(Math.floor(Math.abs(A/b)),A)+this.Ha.o;0>c.x&&(c.x+=b)}else A=e.y-this.Ha.A,d.y=a.Ub.sign(g.y-e.y),c.y=b*a.Ub.Fl(Math.floor(Math.abs(A/b)),A)+this.Ha.A,0>c.y&&(c.y+=b);var A=0!=m?g.y-e.y:g.x-e.x,q=Math.abs(A);if(65536<q/b)throw a.g.X("internal error");if(0<q){q=a.J.truncate(q/b)+2;k.length<q&&(k=a.J.gf(q));for(var r=q=0;;r++){var t=
new a.b;t.x=c.x+d.x*r*b;t.y=c.y+d.y*r*b;t=(0!=m?t.y-e.y:t.x-e.x)/A;if(1<=t)break;0>=t||(k[q]=t,q++)}0!=q&&this.a.zm(h,k,q)}}h=l}while(h!=p)}};b.prototype.Am=function(b,e){for(var g=-1,c=new a.b,d=null,k=this.a.Pb(this.Y);-1!=k;k=this.a.Sb(k))for(var f=this.a.cb(k),p=0,h=this.a.La(k);p<h;p++){var l=this.a.U(f);this.a.w(f,c);if(b?c.y==e:c.x==e)if(this.a.w(l,c),b?c.y==e:c.x==e)-1==g&&(g=this.a.Ud()),null==d&&(d=new a.ia(0),d.yb(100)),1!=this.a.Sa(f,g)&&(d.add(f),this.a.Va(f,g,1)),1!=this.a.Sa(l,g)&&
(d.add(l),this.a.Va(l,g,1));f=l}-1!=g&&this.a.le(g);if(!(null==d||3>d.size)){var m=this;d.Gd(0,d.size,function(a,e){return m.ki(a,e)});g=new a.b;k=new a.b;f=new a.b;k.$c();for(var A=-1,p=new a.ia(0),h=new a.ia(0),l=null,q=this.a.Ud(),r=this.a.Ud(),t=0,u=d.size;t<u;t++){var v=d.get(t);this.a.w(v,c);if(!c.ub(k)){if(-1!=A){for(var w=A;w<t;w++){var A=d.get(w),x=this.a.U(A),v=this.a.Ra(A),z=!1;this.a.w(x,g);0>k.compare(g)&&(b?g.y==e:g.x==e)&&(p.add(A),z=!0,this.a.Va(A,r,1));this.a.w(v,g);0>k.compare(g)&&
(b?g.y==e:g.x==e)&&(z||p.add(A),this.a.Va(A,q,1))}w=0;for(z=p.size;w<z;w++){A=p.get(w);v=this.a.Sa(A,q);x=this.a.Sa(A,r);if(1==v&&(v=this.a.Ra(A),this.a.w(v,f),!f.ub(c))){null==l&&(l=[]);var L=a.b.Cb(k,f);l[0]=a.b.Cb(f,c)/L;0==l[0]?l[0]=2.220446049250313E-16:1==l[0]&&(l[0]=.9999999999999998);this.a.zm(v,l,1);v=this.a.Ra(A);this.a.Qf(v,c);h.add(v);this.a.Va(v,q,1);this.a.Va(v,r,-1)}1==x&&(x=this.a.U(A),this.a.w(x,f),f.ub(c)||(null==l&&(l=[]),L=a.b.Cb(k,f),l[0]=a.b.Cb(k,c)/L,0==l[0]?l[0]=2.220446049250313E-16:
1==l[0]&&(l[0]=.9999999999999998),this.a.zm(A,l,1),v=this.a.U(A),this.a.Qf(v,c),h.add(v),this.a.Va(v,q,-1),this.a.Va(v,r,1)))}A=p;p=h;h=A;h.clear(!1)}A=t;k.L(c)}}this.a.le(q);this.a.le(r)}};b.prototype.sm=function(b,e){for(var g=new a.b,c=null,d=-1,k=0,f=this.nd.size;k<f;k++){var p=this.nd.get(k);if(-1!=p){var h=this.a.U(p);this.a.w(p,g);if(b?g.y==e:g.x==e)if(this.a.w(h,g),b?g.y==e:g.x==e)-1==d&&(d=this.a.Ud()),null==c&&(c=new a.ia(0),c.yb(100)),-2!=this.a.Sa(p,d)&&(c.add(p),this.a.Va(p,d,-2)),-2!=
this.a.Sa(h,d)&&(c.add(h),this.a.Va(h,d,-2))}}if(null==c)-1!=d&&this.a.le(d);else{var l=this;c.Gd(0,c.size,function(a,e){return l.ki(a,e)});k=0;for(f=c.size;k<f;k++){var m=c.get(k);this.a.Va(m,d,k)}p=new a.b;h=new a.b;h.$c();for(var A=-1,k=0,f=c.size;k<f;k++)if(m=c.get(k),-1!=m&&(this.a.w(m,g),!g.ub(h))){if(-1!=A)for(;;){for(var m=!1,q=1<k-A?k-1:k,r=A;r<q;r++){var t=c.get(r);if(-1!=t){var u=-1,v=this.a.U(t);this.a.w(v,p);0>h.compare(p)&&(b?p.y==e:p.x==e)&&(u=v);var v=-1,w=this.a.Ra(t);this.a.w(w,
p);0>h.compare(p)&&(b?p.y==e:p.x==e)&&(v=w);if(-1!=u&&-1!=v)this.ii(t,c,d),this.a.ud(t,!1),this.ii(u,c,d),this.a.ud(u,!1),m=!0;else if(-1!=u||-1!=v){for(w=r+1;w<k;w++){var x=c.get(w);if(-1!=x){var z=this.a.U(x),L=-1;this.a.w(z,p);0>h.compare(p)&&(b?p.y==e:p.x==e)&&(L=z);var z=this.a.Ra(x),C=-1;this.a.w(z,p);0>h.compare(p)&&(b?p.y==e:p.x==e)&&(C=z);if(-1!=L&&-1!=C){this.ii(x,c,d);this.a.ud(x,!1);this.ii(L,c,d);this.a.ud(L,!1);m=!0;break}if(-1!=u&&-1!=C){this.ou(c,t,u,x,C,d);m=!0;break}else if(-1!=
v&&-1!=L){this.ou(c,x,L,t,v,d);m=!0;break}}}if(m)break}}}if(!m)break}A=k;h.L(g)}this.a.le(d)}};b.prototype.ii=function(a,e,b){b=this.a.Sa(a,b);e.set(b,-1);b=this.a.Sa(a,this.Ki);this.nd.set(b,-1);e=this.a.ld(a);-1!=e&&this.a.cb(e)==a&&(this.a.jg(e,-1),this.a.sh(e,-1))};b.prototype.ou=function(a,e,b,c,d,f){this.a.Kc(e,c);this.a.Lc(c,e);this.a.Lc(b,d);this.a.Kc(d,b);this.ii(c,a,f);this.a.Mi(c,!1);this.ii(d,a,f);this.a.Mi(d,!0)};b.prototype.Dz=function(){for(var a=0,e=this.nd.size;a<e;a++){var b=this.nd.get(a);
-1!=b&&this.a.Aj(b,-1)}for(var c=0,d=0,f=this.a.Pb(this.Y);-1!=f;){var p=this.a.cb(f);if(-1==p||f!=this.a.ld(p)){var h=f,f=this.a.Sb(f);this.a.jg(h,-1);this.a.Sr(h)}else{b=p;h=0;do this.a.Aj(b,f),h++,b=this.a.U(b);while(b!=p);this.a.Np(f,!1);this.a.sh(f,this.a.Ra(p));this.a.nk(f,h);d+=h;c++;f=this.a.Sb(f)}}a=0;for(e=this.nd.size;a<e;a++)if(b=this.nd.get(a),-1!=b&&(f=this.a.ld(b),-1==f)){f=this.a.Yf(this.Y,-1);h=0;p=b;do this.a.Aj(b,f),h++,b=this.a.U(b);while(b!=p);2>=h?(b=this.a.Sa(p,this.Ki),this.nd.set(b,
-1),p=this.a.ud(p,!1),2==h&&(b=this.a.Sa(p,this.Ki),0<=b&&this.nd.set(b,-1),this.a.ud(p,!1)),h=f,this.a.jg(h,-1),this.a.Sr(h)):(this.a.$n(f,!0),this.a.nk(f,h),this.a.jg(f,p),this.a.sh(f,this.a.Ra(p)),this.a.Np(f,!1),d+=h,c++)}this.a.wm(this.Y,c);this.a.lk(this.Y,d);a=0;for(e=this.a.rd;-1!=e;e=this.a.Ue(e))a+=this.a.D(e);this.a.AC(a)};b.We=function(a,e,g,c,d){return(new b(e,d)).hz(a,g,c)};b.clip=function(a,e,g,c,d){return b.rq(a,e,null,g,c,d)};b.rq=function(c,e,g,d,f,p){var k=c.G();if(33==k)return f=
c.w(),e.contains(f)?c:c.Ka();if(197==k)return f=new a.h,c.s(f),f.Ma(e)?(e=new a.ci,c.copyTo(e),e.Gp(f),e):c.Ka();if(c.u())return c;if(e.u())return c.Ka();var n=new a.h;c.ac(n);if(e.contains(n))return c;if(!e.Yb(n))return c.Ka();if(null!=g||isNaN(d))d=a.na.Zy(g,e,!1);if(!a.T.gh(k))throw a.g.F();g=c.ob;if(null!=g&&(g=g.Hi,null!=g)){g=g.Rn(e);if(1==g){if(1736!=k)throw a.g.X("internal error");c=new a.Ja(c.description);c.oq(e);return c}if(0==g)return c.Ka()}switch(k){case 550:p=null;k=c.D();d=c.Pa(0);
g=0;f=new a.b;for(n=0;n<k;n++)d.fc(2*n,f),e.contains(f)||(0==g&&(p=c.Ka()),g<n&&p.Id(c,g,n),g=n+1);0<g&&p.Id(c,g,k);return 0==g?c:p;case 1736:case 1607:return b.We(c,e,d,f,p);default:throw a.g.X("internal error");}};b.prototype.ki=function(b,e){var g=new a.b;this.a.w(b,g);b=new a.b;this.a.w(e,b);return g.compare(b)};return b}();a.uh=b})(x||(x={}));(function(a){var b=new a.b,c=function(){function e(e,b,c,d,k){this.Cn=new a.b;this.el=new a.b;this.oj=new a.b;this.a=e;this.px=c;this.ap=d;this.Cn=b;this.dm=
k;this.el.$c();this.oj.$c()}e.prototype.HF=function(e){this.a.w(e,this.el);e=a.J.truncate((this.el.x-this.Cn.x)*this.ap+.5);var b=a.J.truncate((this.el.y-this.Cn.y)*this.ap+.5);return d.vH(e,b)};e.prototype.Wz=function(a){return this.a.Sa(a,this.dm)};e.prototype.zz=function(a,e){this.a.w(a,this.el);this.a.w(e,this.oj);return d.pw(this.el.x,this.el.y,this.oj.x,this.oj.y,this.px)};return e}();a.EZ=function(){return function(){}}();var d=function(){function e(){this.Cn=new a.b;this.er=[0,0,0,0];this.tt=
[0,0,0,0];this.ep=this.dm=-1}e.cS=function(a,b){var g=new e;g.a=a;g.ta=b;g.px=b*b;g.Nw=2*b;g.ap=1/g.Nw;return g.FQ()};e.pw=function(a,e,b,c,d){a-=b;e-=c;return a*a+e*e<=d};e.vH=function(e,b){return a.J.dh(b,a.J.dh(e))};e.prototype.HQ=function(g,c){this.a.Nc(g,b);for(var d=(b.y-this.Cn.y)*this.ap,k=a.J.truncate((b.x-this.Cn.x)*this.ap),n=a.J.truncate(d),f=d=0;1>=f;f+=1)for(var p=0;1>=p;p+=1){var h=e.vH(k+f,n+p),l=this.cm.iT(h);-1!=l&&(this.er[d]=l,this.tt[d]=h,d++)}for(k=d-1;1<=k;k--)for(l=this.er[k],
n=k-1;0<=n;n--)if(l==this.er[n]){this.tt[n]=-1;d--;k!=d&&(this.tt[k]=this.tt[d],this.er[k]=this.er[d]);break}for(n=0;n<d;n++)this.IQ(g,this.tt[n],b,this.er[n],c)};e.prototype.IQ=function(b,c,d,k,f){for(var g=new a.b;-1!=k;k=this.cm.yT(k)){var n=this.cm.ja(k);b==n||-1!=c&&this.a.Sa(n,this.dm)!=c||(this.a.Nc(n,g),e.pw(d.x,d.y,g.x,g.y,this.px)&&f.add(k))}};e.prototype.Ln=function(a,e,b){var g=this.a.Sa(a,this.ep),c=this.a.Sa(e,this.ep);-1==g&&(g=this.Nd.mi(),this.Nd.addElement(g,a),this.a.Va(a,this.ep,
g));-1==c?this.Nd.addElement(g,e):this.Nd.mz(g,c);this.a.Va(e,this.ep,-2);e=this.XV(a,e);b&&(b=this.Yw.HF(a),this.a.Va(a,this.dm,b));return e};e.WV=function(b,c,d){b.Eb(c);d=b;var g=new a.b;e.GX(b.w(),c.w(),g);d.rb(g)};e.GX=function(a,e,b){var g=a.x;a.x!=e.x&&(g=(1*a.x+1*e.x)/2);var c=a.y;a.y!=e.y&&(c=(1*a.y+1*e.y)/2);b.ka(g,c)};e.prototype.XV=function(e,b){var g=new a.b;this.a.w(e,g);var c=new a.b;this.a.w(b,c);var d=this.a.oH(e);b=this.a.oH(b);var k=d+b,n=0,f=g.x;g.x!=c.x&&(f=(g.x*d+c.x*b)/k,n++);
var p=g.y;g.y!=c.y&&(p=(g.y*d+c.y*b)/k,n++);0<n&&this.a.rb(e,f,p);this.a.rY(e,k);return 0!=n};e.prototype.FQ=function(){var e=this.a.vd,b=this.a.TG();this.Cn=b.Zz();b=Math.max(b.fa(),b.N())/2147483646;this.Nw<b&&(this.Nw=b,this.ap=1/this.Nw);this.Nd=new a.Lu;this.Nd.pu(a.J.truncate(this.a.vd/3+1));this.Nd.Vn(a.J.truncate(this.a.vd/3+1));this.dm=this.a.Ud();this.ep=this.a.Ud();this.Yw=new c(this.a,this.Cn,this.px,this.ap,this.dm);this.cm=new a.FM(a.J.truncate(4*e/3),this.Yw);this.cm.yX(this.a.vd);
e=!1;for(b=this.a.rd;-1!=b;b=this.a.Ue(b))for(var d=this.a.Pb(b);-1!=d;d=this.a.Sb(d))for(var k=this.a.cb(d),f=0,p=this.a.La(d);f<p;f++){var h=this.Yw.HF(k);this.a.Va(k,this.dm,h);this.cm.addElement(k,h);k=this.a.U(k)}var l=new a.ia(0);l.yb(10);for(b=this.a.rd;-1!=b;b=this.a.Ue(b))for(d=this.a.Pb(b);-1!=d;d=this.a.Sb(d))for(k=this.a.cb(d),f=0,p=this.a.La(d);f<p;f++){if(-2!=this.a.Sa(k,this.ep))for(h=this.a.Sa(k,this.dm),this.cm.kd(k,h);;){this.HQ(k,l);if(0==l.size)break;for(var h=!1,m=0,A=l.size;m<
A;m++){var q=l.get(m),r=this.cm.ja(q);this.cm.Kd(q);h=this.Ln(k,r,m+1==A)||h}e=e||h;l.clear(!1);if(!h)break}k=this.a.U(k)}e&&this.yP();this.Yw=this.cm=null;this.a.le(this.dm);this.a.le(this.ep);return e};e.prototype.yP=function(){for(var e=new a.b,b=this.Nd.Ge;-1!=b;b=this.Nd.cA(b)){var c=this.Nd.xc(b);this.a.w(this.Nd.ja(c),e);for(c=this.Nd.nb(c);-1!=c;c=this.Nd.nb(c))this.a.Qf(this.Nd.ja(c),e)}};return e}();a.Iu=d})(x||(x={}));(function(a){var b=function(){function b(a){void 0===a&&(a=null);this.Oe=
null;this.xa=!1;null===a?this.Oe=[]:this.Oe=a}b.prototype.copyTo=function(b){if(b.xa)throw a.g.X("CompositeGeographicTransformation is read-only");for(var e=0;e<this.Oe.length;e++)b.Oe.push(this.Oe[e].Vf())};b.prototype.count=function(){return this.Oe.length};b.prototype.kT=function(a){return this.Oe[a]};b.prototype.add=function(b){if(this.xa)throw a.g.X("CompositeGeographicTransformation is read-only");this.Oe.push(b.Vf())};b.prototype.clear=function(){if(this.xa)throw a.g.X("CompositeGeographicTransformation is read-only");
this.Oe.length=0};b.prototype.remove=function(b){if(this.xa)throw a.g.X("CompositeGeographicTransformation is read-only");this.Oe.splice(b,1)};b.prototype.Wv=function(){for(var a=this.oe(),e=0;e<a.count();e++)a.kT(e).kt();a.Oe=a.Oe.reverse();return a};b.prototype.oe=function(){var a=new b;this.copyTo(a);return a};b.prototype.Vf=function(){return this.oe()};b.prototype.transform=function(b,e,g,c){if(b.length<e)throw a.g.X("invalid Argument");var d=g;for(g=0;g<this.Oe.length;g++){var k=this.Oe[g];if(null!=
k.cn()){var n=k.nn,f=n?1:0,p=n?k.cn().getGeogcs2():k.cn().getGeogcs1(),p=p.getUnit().getUnitFactor(),p=d/p;if(3.552713678800501E-15<Math.abs(p-1))for(d=0;d<e;d++)b[d][0]*=p,b[d][1]*=p;a.QD.geogToGeog(k.cn(),e,b,null,f);d=(n?k.cn().getGeogcs1():k.cn().getGeogcs2()).getUnit().getUnitFactor()}}p=d/c;if(3.552713678800501E-15<Math.abs(p-1))for(d=0;d<e;d++)b[d][0]*=p,b[d][1]*=p;return e};b.prototype.getName=function(){if(0==this.Oe.length)return"";for(var a="",e=0,b=this.Oe.length;e<b;++e)""!==a&&(a+=" + "),
a+=this.Oe[e].getName();return a};b.prototype.Eb=function(a){if(a==this)return!0;if(!(a instanceof b)||this.Oe.length!=a.Oe.length)return!1;for(var e=0;e<this.Oe.length;e++)if(!this.Oe[e].Eb(a.Oe[e]))return!1;return!0};b.prototype.Mp=function(){this.xa=!0};b.prototype.toString=function(){var a=toString();return 200<a.length?a.substring(0,197)+"... ("+a.length.toString()+" characters)":a};b.create=function(){return new b};b.aq=function(c,e){var g=new b;g.add(a.io.create(c,e));return g};b.bq=function(c,
e){var g=new b;g.add(a.io.gG(c,e));return g};return b}();a.ny=b})(x||(x={}));(function(a){var b=Math.PI,c=2*Math.PI,d=Math.PI/2,e=function(){function a(){}a.XQ=function(e,b){var g=new a;g.x=e;g.y=b;g.type=0;g.ui=0;return g};a.El=function(e){var b=new a;b.x=e.x;b.y=e.y;b.type=0;b.ui=0;return b};a.WQ=function(e){var b=new a;b.x=e.x;b.y=e.y;b.type=e.type;b.ui=e.ui;return b};a.ce=function(e,b,g){var c=new a;c.x=e.x+b*Math.cos(g);c.y=e.y+b*Math.sin(g);c.type=e.type;c.ui=e.ui;return c};a.Dv=function(e,
b){var g=new a;g.x=.5*(e.x+b.x);g.y=.5*(e.y+b.y);g.type=e.type;g.ui=e.ui;return g};a.$F=function(e,b){var g=new a;g.x=e.x+.001*(b.x-e.x);g.y=e.y+.001*(b.y-e.y);g.type=e.type;g.ui=e.ui;return g};return a}(),g=function(){return function(){}}();(function(a){a[a.Round=0]="Round";a[a.Bevel=1]="Bevel";a[a.Miter=2]="Miter";a[a.Square=3]="Square"})(a.KM||(a.KM={}));var n=function(){function k(a){this.tB=this.$b=this.Sg=null;this.ke=a}k.V=function(e,b,g,c,d,n){if(null==e)throw a.g.F();if(1>e.tb())throw a.g.F();
if(0==b||e.u())return e;n=new k(n);n.Yo=e;n.Qa=b;n.ta=d;n.jj=g;n.jB=c;return n.Ay()};k.prototype.AO=function(){var e=this.Yo,b=e.ec(),g=e.Bc(),c=new a.b;c.yc(g,b);c.normalize();c.uw();c.scale(this.Qa);b.add(c);g.add(c);c=e.Ka();e.Mc(b);e.Zc(g);return c};k.prototype.zO=function(){var e=this.Yo;if(0<this.Qa&&2!=this.jj){var b=new a.Ja;b.jd(e,!1);this.Yo=b;return this.Ay()}e=new a.ci(e.R);e.O(this.Qa,this.Qa);return e};k.prototype.kK=function(a,e,b,g){return(e.x-a.x)*(g.x-b.x)+(e.y-a.y)*(g.y-b.y)};k.prototype.pc=
function(a,b){if(void 0===b)this.$b.push(a),this.Kf++;else if(0==this.Kf)this.pc(a);else{var g=this.qx,c,k;c=this.Sg[0==b?g-1:b-1];k=this.Sg[b];var n=this.kK(c,k,this.$b[this.Kf-1],a);0<n?this.pc(a):0>n&&(0<this.kK(c,k,k,this.$b[this.Kf-1])?(k=this.Sg[0==b?g-2:1==b?g-1:b-2],g=e.ce(c,this.Qa,Math.atan2(c.y-k.y,c.x-k.x)-d),this.$b[this.Kf-1]=g,1==this.jj||2==this.jj?(g=e.Dv(g,c),this.pc(g),g=e.ce(c,this.Qa,this.ww+d),c=e.Dv(g,c),c.type|=256,this.pc(c)):(g=e.ce(c,this.Qa,this.ww+d),g.type|=256),this.pc(g),
this.pc(a,b)):(g=e.ce(k,this.Qa,this.ww+d),this.pc(g),1==this.jj||2==this.jj?(g=e.Dv(g,k),this.pc(g),g=e.ce(k,this.Qa,this.KA-d),c=e.Dv(g,k),c.type|=256,this.pc(c)):(g=e.ce(k,this.Qa,this.KA-d),g.type|=256),this.pc(g)))}};k.prototype.AF=function(){var g,k,n,f,y,p,h=this.qx;this.Kf=0;var l=.5*this.ta,m=0,A=0;for(g=0;g<h;g++){f=this.Sg[g];y=0==g?this.Sg[h-1]:this.Sg[g-1];p=g==h-1?this.Sg[0]:this.Sg[g+1];var q=y.x-f.x,r=y.y-f.y,t=p.x-f.x,u=p.y-f.y;k=Math.atan2(r,q);n=Math.atan2(u,t);this.ww=k;this.KA=
n;0==g&&(m=k,A=n);q=q*u-t*r;r=n;n<k&&(n+=c);if(0<q*this.Qa)1==this.jj||2==this.jj?(k=e.ce(f,this.Qa,k+d),this.pc(k),k=e.$F(f,k),this.pc(k),k=e.ce(f,this.Qa,n-d),f=e.$F(f,k),f.type|=256,this.pc(f),this.pc(k)):(q=.5*(n-k),q=this.Qa/Math.abs(Math.sin(q)),k=e.ce(f,q,.5*(k+n)),this.pc(k,g));else if(0!=(f.type&512)){q=1-l/Math.abs(this.Qa);y=1;p=0>this.Qa?-b:b;-1<q&&1>q&&(r=2*Math.acos(q),.017453292519943295>r&&(r=.017453292519943295),y=a.J.truncate(b/r+1.5),1<y&&(p/=y));r=k+d;k=e.ce(f,this.Qa,r);0==g&&
(k.type|=1024);this.pc(k,g);q=this.Qa/Math.cos(p/2);r+=p/2;k=e.ce(f,q,r);k.type|=1024;for(this.pc(k);0<--y;)r+=p,k=e.ce(f,q,r),k.type|=1024,this.pc(k);k=e.ce(f,this.Qa,n-d);k.type|=1024;this.pc(k)}else if(1==this.jj)k=e.ce(f,this.Qa,k+d),this.pc(k,g),k=e.ce(f,this.Qa,n-d),this.pc(k);else if(0==this.jj)for(q=1-l/Math.abs(this.Qa),y=1,p=n-d-(k+d),-1<q&&1>q&&(r=2*Math.acos(q),.017453292519943295>r&&(r=.017453292519943295),y=a.J.truncate(Math.abs(p)/r+1.5),1<y&&(p/=y)),q=this.Qa/Math.cos(.5*p),r=k+d+
.5*p,k=e.ce(f,q,r),this.pc(k,g);0<--y;)r+=p,k=e.ce(f,q,r),this.pc(k);else 2==this.jj?(q=y.x-f.x,r=y.y-f.y,t=p.x-f.x,u=p.y-f.y,y=(q*t+r*u)/Math.sqrt(q*q+r*r)/Math.sqrt(t*t+u*u),.99999999<y?(k=e.ce(f,1.4142135623730951*this.Qa,n-.25*b),this.pc(k,g),k=e.ce(f,1.4142135623730951*this.Qa,n+.25*b),this.pc(k)):(y=Math.abs(this.Qa/Math.sin(.5*Math.acos(y))),p=Math.abs(this.jB*this.Qa),y>p?(q=.5*(n-k),q=this.Qa/Math.abs(Math.sin(q)),k=e.ce(f,q,.5*(k+n)),n=a.b.pa(k.x,k.y),k=a.b.pa(f.x,f.y),f=new a.b,f.yc(n,
k),n=new a.b,n.FX(p/f.length(),f,k),k=(y-p)*Math.abs(this.Qa)/Math.sqrt(y*y-this.Qa*this.Qa),0<this.Qa?f.uw():f.Ur(),f.scale(k/f.length()),k=new a.b,k.add(n,f),y=new a.b,y.yc(n,f),k=e.El(k),this.pc(k,g),k=e.El(y),this.pc(k)):(q=.5*(n-k),q=this.Qa/Math.abs(Math.sin(q)),k=e.ce(f,q,.5*(k+n)),this.pc(k,g)))):(n=r,0<this.Qa?(n>k&&(n-=c),y=k-n<d):(n<k&&(n+=c),y=n-k<d),y?(q=1.4142135623730951*this.Qa,r=0>q?k+.25*b:k+.75*b,k=e.ce(f,q,r),this.pc(k,g),r=0>q?n-.25*b:n-.75*b,k=e.ce(f,q,r),this.pc(k)):(q=.5*(n-
k),q=this.Qa/Math.abs(Math.sin(q)),n<k&&(n+=c),k=e.ce(f,q,(k+n)/2),this.pc(k,g)))}this.ww=m;this.KA=A;this.pc(this.$b[0],0);f=e.WQ(this.$b[this.Kf-1]);this.$b[0]=f;return this.uX()};k.prototype.kv=function(e,b){if(!(2>b))for(var g=0;g<b;g++){var c=this.$b[e+g];0!=g?this.tB.aj(a.b.pa(c.x,c.y)):this.tB.zu(a.b.pa(c.x,c.y))}};k.prototype.BO=function(a,b,g){var c=a.wa(b),d=a.Gc(b);this.$b=[];this.tB=g;if(a.Qb(b)){for(b=a.Ba(c);a.Ba(d-1).ub(b);)d--;if(2<=d-c){this.qx=d-c;this.Sg=[];for(b=c;b<d;b++)this.Sg.push(e.El(a.Ba(b)));
this.AF()&&this.kv(0,this.Kf-1)}}else{for(b=a.Ba(c);c<d&&a.Ba(c+1).ub(b);)c++;for(b=a.Ba(d-1);c<d&&a.Ba(d-2).ub(b);)d--;if(2<=d-c){this.qx=2*(d-c)-2;this.Sg=[];g=e.El(a.Ba(c));g.type|=1536;this.Sg.push(g);for(b=c+1;b<d-1;b++)g=e.El(a.Ba(b)),this.Sg.push(g);g=e.El(a.Ba(d-1));g.type|=512;this.Sg.push(g);for(b=d-2;b>=c+1;b--)g=e.El(a.Ba(b)),g.type|=1024,this.Sg.push(g);if(this.AF())if(2<=this.$b.length){a=-1;(d=0!=(this.$b[this.Kf-1].type&1024))||(a=0);for(b=1;b<this.Kf;b++)(c=0!=(this.$b[b].type&1024))?
d||(d=b-1,1<d-a+1&&this.kv(a,d-a+1)):d&&(a=b-1),d=c;d||(d=this.Kf-1,1<d-a+1&&this.kv(a,d-a+1))}else a=0,d=this.Kf-1,0<=a&&1<=d-a&&this.kv(a,d-a+1)}}this.Sg=null;this.qx=0;this.$b=null;this.Kf=0};k.prototype.uX=function(){for(var a=!1,e=0;e<this.Kf;e++){var b=this.$b[e];b.Nh=e+1;b.Qh=e-1;this.$b[e]=b}b=this.$b[0];b.Qh=this.Kf-2;this.$b[0]=b;b=this.$b[this.Kf-2];b.Nh=0;this.$b[this.Kf-2]=b;for(e=b=0;e<this.Kf;e++)if(0!=(this.$b[b].type&256)){var g=this.DR(b);if(-1!=g)b=g;else{a=!0;break}}else b=this.$b[b].Nh;
if(a)return!1;this.UQ(b);return!0};k.prototype.DR=function(a){for(var e=this.Kf-1,b=a,g,c,d=1;d<=e-2;d++){g=b=this.$b[b].Nh;c=a;for(var k=1;k<=d;k++){c=this.$b[c].Qh;if(0==(this.$b[c].type&256)&&0==(this.$b[g].type&256)){var n=this.bU(c,g);if(-1!=n)return n}g=this.$b[g].Qh}}return-1};k.prototype.bU=function(e,b){var c,d,k,n;c=this.$b[this.$b[e].Qh];d=this.$b[e];k=this.$b[this.$b[b].Qh];n=this.$b[b];if(!this.JX(c,d,k,n))return-1;var f=new g;return this.qS(c,d,k,n,f)&&!f.pF&&a.J.SK((d.x-c.x)*(n.y-k.y)-
(d.y-c.y)*(n.x-k.x))!=a.J.SK(this.Qa)?(c=this.$b[e].Qh,f.Pn.type=d.type,f.Pn.Nh=b,f.Pn.Qh=c,this.$b[e]=f.Pn,f.Pn=this.$b[b],f.Pn.Qh=e,this.$b[b]=f.Pn,b):-1};k.prototype.JX=function(a,e,b,g){return Math.max(a.x,e.x)>=Math.min(b.x,g.x)&&Math.max(b.x,g.x)>=Math.min(a.x,e.x)&&Math.max(a.y,e.y)>=Math.min(b.y,g.y)&&Math.max(b.y,g.y)>=Math.min(a.y,e.y)};k.prototype.qS=function(a,b,g,c,d){d.pF=!1;var k,n,f;k=(b.y-a.y)*(c.x-g.x)-(b.x-a.x)*(c.y-g.y);n=(g.y-a.y)*(b.x-a.x)-(g.x-a.x)*(b.y-a.y);k=0==k?2:n/k;return 0<=
k&&1>=k&&(f=k,k=(c.y-g.y)*(b.x-a.x)-(c.x-g.x)*(b.y-a.y),n=(a.y-g.y)*(c.x-g.x)-(a.x-g.x)*(c.y-g.y),k=0==k?2:n/k,0<=k&&1>=k)?(d.Pn=e.XQ(a.x+k*(b.x-a.x),a.y+k*(b.y-a.y)),d.Pn.ui=g.ui+f*(c.ui-g.ui),0!=f&&1!=f||0!=k&&1!=k||(d.pF=!0),d.N_=k,d.O_=f,(0==f||1==f)&&0<k&&1>k||(0==k||1==k)&&0<f&&1>f?!1:!0):!1};k.prototype.UQ=function(a){for(;this.$b[a].Qh<a;)a=this.$b[a].Qh;var e=0,b=a;do b=this.$b[b],this.$b[e]=b,b=b.Nh,e++;while(b!=a);this.$b[e]=this.$b[0];this.Kf=e+1};k.prototype.wE=function(a){var e=this.Yo,
b=e.Fa();if(null!=b){b.yj();for(var g=-1;b.Ya();)g++,this.BO(e,g,a)}};k.prototype.Ay=function(){var e=this.Yo.G();return 322==e?this.AO():197==e?this.zO():a.T.Oc(e)?(e=new a.Ua,e.dc(this.Yo,!0),this.Yo=e,this.Ay()):1607==e?(e=new a.Ua,this.wE(e),e):1736==e?(e=new a.Ja,this.wE(e),e):null};return k}();a.UL=n})(x||(x={}));(function(a){var b=function(){function a(a){this.Rk=a}a.prototype.w=function(a,e){this.Rk.a.w(a,e)};a.prototype.Kd=function(a){var e=this.Rk.Na.ja(a);this.Rk.Na.Kd(a,-1);this.Rk.a.ud(e,
!1)};return a}(),c=function(){function a(a){this.Rk=a}a.prototype.w=function(a,e){this.Rk.HV.w(a,e)};a.prototype.Kd=function(a){this.Rk.Na.Kd(a,-1)};return a}(),d=function(){function a(a){this.Rk=a}a.prototype.w=function(a,e){e.L(this.Rk.KV[a])};a.prototype.Kd=function(a){this.Rk.Na.Kd(a,-1)};return a}(),e=function(){function e(e){void 0===e?(this.Na=new a.uk,this.Na.Qe(20),this.a=new a.fd,this.yV=this.a.bh(550),this.Nt=this.a.Yf(this.yV,-1),this.wi=new b(this)):e instanceof Array?(this.Na=new a.uk,
this.Na.Qe(20),this.KV=e,this.wi=new d(this)):(this.Na=new a.uk,this.Na.Qe(20),this.HV=e,this.wi=new c(this))}e.prototype.Jb=function(e){var b=e.G();if(a.Mu.gh(b))this.iP(e);else if(a.wl.Oc(b))this.pP(e);else if(197==b)this.fP(e);else if(33==b)this.mP(e);else throw a.g.F("invalid shape type");};e.prototype.VS=function(){var e=new a.Wa,b=this.Na.xc(-1),g=new a.Ja(this.a.Hr);this.a.wj(this.Na.ja(b),e);g.Rf(e);for(b=this.Na.nb(b);-1!=b;b=this.Na.nb(b))this.a.wj(this.Na.ja(b),e),g.lineTo(e);return g};
e.VQ=function(b){var g=new e(b),c=b.D(),d=1,k=new a.b,n=new a.b,f=new a.b;for(b.w(0,k);;){b.w(d,n);if(!(n.xA(k)&&d<c-1))break;d++}g.Na.addElement(0,-1);g.Na.ro(d);for(c=d+1;c<b.D();c++)b.w(c,f),d=g.PC(f),-1!=d&&g.Na.kk(d,c);f=new a.Wa;d=g.Na.xc(-1);c=new a.Ja(b.description);b.Ae(g.Na.ja(d),f);c.Rf(f);for(d=g.Na.nb(d);-1!=d;d=g.Na.nb(d))b.Ae(g.Na.ja(d),f),c.lineTo(f);return c};e.pa=function(a,b,g){for(var c=new e(a),d=1,k=a[0];a[d].xA(k)&&d<b-1;)d++;c.Na.addElement(0,-1);c.Na.ro(d);for(d+=1;d<b;d++)k=
c.PC(a[d]),-1!=k&&c.Na.kk(k,d);a=0;for(b=c.Na.xc(-1);-1!=b;b=c.Na.nb(b))g[a++]=c.Na.ja(b);return a};e.VH=function(b,g){var c=b.wa(g),d=b.Gc(g);g=!b.Qb(g)&&b.Eo(g);b=b.Pa(0);c*=2;d*=2;g&&(d-=2);if(6>d-c)return!0;g=new a.b;var k=new a.b,n=new a.b;b.fc(c,g);b.fc(c+2,k);b.fc(c+4,n);var f=e.fe(k,n,g);if(f.lt()||!e.tc(f.value()))return!1;for(var y=a.b.pa(k.x,k.y),p=new a.b,c=c+6;c<d;c+=2){p.L(k);k.L(n);b.fc(c,n);f=e.fe(k,n,g);if(f.lt()||!e.tc(f.value()))return!1;f=e.fe(y,n,g);if(f.lt()||!e.tc(f.value()))return!1;
f=e.fe(k,n,p);if(f.lt()||!e.tc(f.value()))return!1}return!0};e.prototype.iP=function(e){for(var b=new a.Wa,g=new a.b,c=0;c<e.D();c++){e.w(c,g);var d=this.As(g);if(-1!=d){e.Ae(c,b);var k=this.a.pc(this.Nt,b);this.Na.kk(d,k)}}};e.prototype.fP=function(e){for(var b=new a.Wa,g=new a.b,c=0;4>c;c++){e.Gx(c,g);var d=this.As(g);if(-1!=d){e.ig(c,b);var k=this.a.pc(this.Nt,b);this.Na.kk(d,k)}}};e.prototype.pP=function(e){var b=new a.Wa,g=e.ec(),g=this.As(g);if(-1!=g){e.Dp(b);var c=this.a.pc(this.Nt,b);this.Na.kk(g,
c)}g=e.Bc();g=this.As(g);-1!=g&&(e.Bp(b),e=this.a.pc(this.Nt,b),this.Na.kk(g,e))};e.prototype.mP=function(a){var e=a.w(),e=this.As(e);-1!=e&&(a=this.a.pc(this.Nt,a),this.Na.kk(e,a))};e.prototype.As=function(a){var e=-1;if(0==this.Na.size(-1))return e=this.Na.addElement(-4,-1);if(1==this.Na.size(-1)){var b=this.a.Ba(this.Na.ja(this.Na.xc(-1)));a.xA(b)||(e=this.Na.ro(-5));return e}return e=this.PC(a)};e.prototype.PC=function(b){var g=-1,c=this.Na.xc(-1),d=this.Na.Fc(-1),k=this.Na.ja(c),n=this.Na.ja(d),
f=new a.b,p=new a.b;this.wi.w(k,f);this.wi.w(n,p);k=a.b.zp(p,b,f);if(e.tc(k))g=this.Na.ro(-1),f=this.NC(b,d,c),f!=c&&this.OC(b,c,this.Na.Ve(f));else if(e.ul(k)){for(var p=this.Na.fw(-1),h=this.Na.xc(-1),l=this.Na.Fc(-1),m,k=new a.b,n=new a.b;h!=this.Na.Ve(l);)m=this.Na.ja(p),this.wi.w(m,k),m=a.b.zp(k,b,f),e.ul(m)?(l=p,p=this.Na.Pl(p)):(h=p,p=this.Na.Nq(p));p=l;f=h;m=this.Na.ja(p);h=this.Na.ja(f);this.wi.w(m,k);this.wi.w(h,n);if(f==c||(k=a.b.zp(n,b,k),e.tc(k)))g=this.Na.jv(f,p,-2,!1),this.OC(b,p,d),
this.NC(b,f,c)}else null==this.wb&&(this.wb=new a.Hb),this.wb.Mc(p),this.wb.Zc(f),f=this.wb.qe(b,!0),0>f?(f=this.Na.Ve(d),this.Na.Kd(d,-1),g=this.Na.ro(-3),this.NC(b,f,c)):1<f&&(f=this.Na.nb(c),this.Na.Kd(c,-1),g=this.Na.jv(-1,f,-3,!1),this.OC(b,f,d));return g};e.prototype.OC=function(b,g,c){if(g!=c){var d=this.Na.ja(g),k=this.Na.nb(g),n=new a.b,f=new a.b;for(this.wi.w(d,n);g!=c&&2<this.Na.size(-1);){this.wi.w(this.Na.ja(k),f);d=a.b.zp(f,b,n);if(e.tc(d))break;d=g;g=k;n.L(f);k=this.Na.nb(g);this.wi.Kd(d)}}};
e.prototype.NC=function(b,g,c){if(g==c)return c;var d=this.Na.ja(g),k=this.Na.Ve(g),n=new a.b,f=new a.b;for(this.wi.w(d,n);g!=c&&2<this.Na.size(-1);){this.wi.w(this.Na.ja(k),f);d=a.b.zp(n,b,f);if(e.tc(d))break;d=g;g=k;n.L(f);k=this.Na.Ve(g);this.wi.Kd(d)}return g};e.fe=function(e,b,g){var c=new a.Xb;c.set(b.x);c.sub(e.x);var d=new a.Xb;d.set(g.y);d.sub(e.y);var k=new a.Xb;k.set(b.y);k.sub(e.y);b=new a.Xb;b.set(g.x);b.sub(e.x);c.Vg(d);k.Vg(b);c.sub(k);return c};e.tc=function(a){return 0>a};e.ul=function(a){return 0<
a};e.hq=function(a){return 0==a};return e}();a.Ju=e})(x||(x={}));(function(a){var b=function(){function b(a){this.ke=this.a=null;this.FI=!0;this.ke=a}b.yJ=function(b,e,g){b=a.na.Cs(b);return a.Iu.pw(e.Be(),e.nf(),g.Be(),g.nf(),a.Ub.Yx(b))};b.GQ=function(b,e){var g=new a.Wa;a.Iu.WV(b,e,g);return g};b.V=function(a,e,g,c){g=new b(g);g.a=a;g.ta=e;g.FI=c;return g.MO()};b.prototype.GO=function(b){return a.Iu.cS(this.a,b)};b.prototype.JO=function(b){return a.Ku.V(this.a,b,this.ke)};b.prototype.MO=function(){for(var b=
this.ta,e=a.na.Cs(b),b=a.na.sP(b),g=1.00001*b,b=1.000001*b,c=!1,d=30<this.a.vd+10?1E3:(this.a.vd+10)*(this.a.vd+10),f=0,p=this.a.eU();;f++){if(f>d)throw a.g.X("Internal Error: max number of iterations exceeded");var h=this.GO(e),c=c||h;this.FI&&(h=0!=this.a.zq(e,!0,!1),c=c||h);h=!1;if(0==f||p||a.Ku.tJ(!0,this.a,b,null,this.ke))h=this.JO(g),c=c||h;if(!h)break}return c};return b}();a.sk=b})(x||(x={}));(function(a){var b=function(){function b(a){this.xe=this.Tc=null;this.kx=0;this.mc=a;this.MA=!0}b.prototype.gw=
function(a,b){var e=this.a.ic(a);if(null==e){if(!this.a.od(a,b))return null;e=b}return e};b.prototype.Pr=function(a){void 0===a&&(a=!1);this.kx++;if(a||0==(this.kx&4095))this.kx=0};b.prototype.nR=function(){var e=this.a.Qr(!1),b=!1,c=new a.Hb,d=new a.Hb,k=new a.h;k.Oa();var f=new a.h;f.Oa();for(var p=new a.Wa,h=new a.eE,l=e.next();-1!=l;l=e.next()){var m=null,A=!1;if(!a.T.Jo(this.a.hc(e.Bk))){m=this.gw(l,c);if(null==m)continue;m.s(k);k.O(this.ta,this.ta);if(m.fh(this.ta))if(m.fh(0))A=!0,m=null;else continue}var q=
this.a.Qr(e),r=q.next();for(-1!=r&&(r=q.next());-1!=r;r=q.next()){var t=null,u=!1;if(!a.T.Jo(this.a.hc(q.Bk))){t=this.gw(r,d);if(null==t)continue;t.s(f);if(t.fh(this.ta))if(t.fh(0))u=!0,t=null;else continue}var v=0,w=0;if(null!=m&&null!=t)k.TH(f)&&(h.Ap(m),h.Ap(t),h.Ma(this.ta,!1),v=h.Rl(0),w=h.Rl(1),0<v+w&&(this.a.bs(l,h,0,!0),this.a.bs(r,h,1,!0)),h.clear());else if(null!=m){var x=new a.b;this.a.w(r,x);if(k.contains(x)){h.Ap(m);this.a.wj(r,p);h.tA(this.ta,p,!1);v=h.Rl(0);if(0<v)if(this.a.bs(l,h,
0,!0),u){u=-1;for(x=this.a.U(r);-1!=x&&x!=r&&(t=this.gw(x,d),u=x,null!=t&&t.fh(0));x=this.a.U(x));for(x=r;-1!=x&&(this.a.Yh(x,h.cg),x!=u);x=this.a.U(x));}else this.a.Yh(r,h.cg);h.clear()}}else if(null!=t){if(x=new a.b,this.a.w(l,x),f.O(this.ta,this.ta),f.contains(x)){h.Ap(t);this.a.wj(l,p);h.tA(this.ta,p,!1);w=h.Rl(0);if(0<w)if(this.a.bs(r,h,0,!0),A){u=-1;for(x=this.a.U(l);-1!=x&&x!=l&&(t=this.gw(x,d),u=x,null!=t&&t.fh(0));x=this.a.U(x));for(x=l;-1!=x&&(this.a.Yh(x,h.cg),x!=u);x=this.a.U(x));}else this.a.Yh(l,
h.cg);h.clear()}}else continue;if(0!=v+w){if(0!=v){m=this.a.ic(l);if(null==m){if(!this.a.od(l,c))continue;m=c;c.s(k)}else m.s(k);if(m.fh(this.ta))break}b=!0}}}return b};b.prototype.oR=function(){return this.EW()};b.prototype.EW=function(){return(new a.XD).JY(this.a,this.ta)};b.prototype.uJ=function(){var e=!1,b,c;null==this.Tc&&(this.Tc=new a.uk);var d=new a.ia(0);d.yb(this.a.vd+1);for(var k=this.a.Qr(),f=k.next();-1!=f;f=k.next())d.add(f);this.a.Xx(d,d.size);d.add(-1);k=this.a.Ud();f=this.a.Ud();
this.xe=new a.gE(this.a,this.ta,!this.MA);this.Tc.Ep(this.xe);var p=new a.ia(0),h=new a.ia(0),l=0;new a.b;var m=this.a.Dd;this.a.xb.wc();for(var A=this.a.xb.ya[0].f,q,r,t=d.get(l++);-1!=t;){r=m.S(t,0);q=A[2*r];r=A[2*r+1];var u=q,v=r;do{var w=m.S(t,2),x=m.S(t,1);-1!=w&&(b=m.S(w,0),c=A[2*b],b=A[2*b+1],0>(v<b?-1:v>b?1:u<c?-1:u>c?1:0)&&(h.add(t),h.add(w)));-1!=x&&(b=m.S(x,0),c=A[2*b],b=A[2*b+1],0>(v<b?-1:v>b?1:u<c?-1:u>c?1:0)&&(h.add(x),h.add(x)));c=this.a.Sa(t,k);-1!=c&&(p.add(c),this.a.Va(t,k,-1));
c=this.a.Sa(t,f);-1!=c&&(p.add(c),this.a.Va(t,f,-1));t=d.get(l++);-1!==t&&(v=m.S(t,0),u=A[2*v],v=A[2*v+1])}while(-1!=t&&u===q&&v===r);u=1==p.size&&2==h.size;c=v=-1;w=0;for(x=p.size;w<x;w++){b=p.get(w);var z=this.Tc.Ve(b);-1==z||p.oA(z)||(v=z);b=this.Tc.nb(b);-1==b||p.oA(b)||(c=b);if(-1!=v&&-1!=c)break}this.xe.QK(r,q);w=0;for(x=p.size;w<x;w++)b=p.get(w),this.Tc.Kd(b,-1);p.clear(!1);if(!u&&-1!=v&&-1!=c&&this.uQ(v,c)){e=!0;this.mj=this.xe.en();break}w=0;for(x=h.size;w<x;w+=2){r=h.get(w);q=h.get(w+1);
u?(r=this.Tc.jv(v,c,r,!0),u=!1):r=this.Tc.addElement(r,-1);if(this.xe.Ng){this.mj=this.xe.en();e=!0;break}-1==this.a.Sa(q,k)?this.a.Va(q,k,r):this.a.Va(q,f,r)}if(e)break;h.yf(0)}this.a.le(k);this.a.le(f);return e};b.prototype.uQ=function(a,b){this.xe.compare(this.Tc,this.Tc.ja(a),b);a=this.xe.Ng;this.xe.Gs();return a};b.Cj=function(e){for(var b=e.rd;-1!=b;b=e.Ue(b))if(a.T.Ic(e.hc(b)))return!0;return!1};b.Gm=function(a,g,c,d){if(!b.Cj(a))return!1;g=new b(d);g.a=a;g.ta=c;if(15>a.vd)a=g.nR();else return g.oR();
return a};b.V=function(a,g,c){return b.Gm(a,a.TG(),g,c)};b.tJ=function(e,g,c,d,k){if(!b.Cj(g))return!1;var n=new b(k);n.a=g;n.ta=c;n.MA=e;if(n.uJ())return null!=d&&d.ms(n.mj),!0;var f=new a.Hd;f.yC();g.Xc(f);n=new b(k);n.a=g;n.ta=c;n.MA=e;e=n.uJ();f.yC();g.Xc(f);return e?(null!=d&&d.ms(n.mj),!0):!1};b.qm=function(a,b){a=a.D();return 16>a?!1:2*a+Math.log(a)*Math.LOG10E/Math.log(2)*1*b<1*a*b};b.lR=function(e,g,c,d){if(a.T.Ic(g.G()))return(new b(d)).mR(e,g,c);throw a.g.X("crack_A_with_B");};b.prototype.mR=
function(e,g,d){var k=new a.h;e.ac(k);var n=new a.h;g.ac(n);n.O(d,d);if(!n.Yb(k))return e;var f=e.ob,p=null;null!=f&&(p=f.Mb);b.qm(e,e.D())&&(p=a.na.Lj(e,n));var h=null!=p?p.mf():null,l=g.Fa();g=e.Fa();for(var m=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],n=[];l.Ya();)for(;l.Ea();){var A=l.ba();if(null!=p)for(h.Wn(A,d),f=h.next();-1!=f;f=h.next()){if(this.Pr(),g.Tb(p.ja(f),-1),g.Ea())for(var f=g.ba(),q=f.Ma(A,null,m,null,d),f=0;f<q;++f){var r=m[f];if(0!=r&&1!=r){var t=g.Db(),u=new c;u.t=r;u.index=t;n.push(u)}}}else{var v=
new a.h;A.ac(v);v.O(d,d);if(k.Yb(v))for(g.yj();g.Ya();)for(;g.Ea();)if(this.Pr(),f=g.ba(),r=new a.h,f.ac(r),r.Yb(v))for(q=f.Ma(A,null,m,null,d),f=0;f<q;++f)r=m[f],0!=r&&1!=r&&(t=g.Db(),u=new c,u.t=r,u.index=t,n.push(u))}}if(0==n.length)return e;n=n.sort(c.Hs);e=e.Ka();for(g.yj();g.Ya()&&!g.Ea(););d=g.ba();k=new a.Cg;p=-1;f=0;for(h=n.length;f<h;){m=n[f].index;for(l=f+1;l<h&&n[l].index==m;)++l;for(;g.Db()<m;){this.Pr();A=g.Ea();r=g.Ta;(v=A||!g.Fo()||g.Go())&&e.dc(d,p!=r);p=r;if(!A)for(;g.Ya()&&!g.Ea(););
d=g.ba()}for(m=0;f<l;f++)r=n[f].t,r!=m&&(d.yh(m,r,k),m=r,r=g.Ta,e.dc(k.get(),p!=r),p=r);if(v=(A=g.Ea())||!g.Fo()||g.Go())d.yh(m,1,k),e.dc(k.get(),!1);if(A)d=g.ba();else{for(;g.Ya()&&!g.Ea(););g.Ea()?d=g.ba():d=null}f=l}null!=d&&(r=g.Ta,(v=(A=g.Ea())||!g.Fo()||g.Go())&&e.dc(d,p!=r),p=r);for(A=g.Ea();;){if(!A){for(;g.Ya()&&!(A=g.Ea()););if(!A)break}d=g.ba();r=g.Ta;(v=(A=g.Ea())||!g.Fo()||g.Go())&&e.dc(d,p!=r);p=r}return e};return b}();a.Ku=b;var c=function(){function a(){}a.Hs=function(a,b){return a.index==
b.index?a.t>b.t?1:a.t<b.t?-1:0:a.index>b.index?1:-1};return a}()})(x||(x={}));(function(a){(function(a){a[a.Left=0]="Left";a[a.Right=1]="Right";a[a.Coincident=2]="Coincident";a[a.Undefined=3]="Undefined";a[a.Uncut=4]="Uncut"})(a.WL||(a.WL={}));var b=function(){return function(a,e,b,c,d,k,f,p,h,l,m){this.Y=a;this.nx=e;this.It=b;this.Pg=c;this.yn=l;this.em=m}}();a.GZ=b;var c=function(){function e(a,e){this.YI=a;this.gj=e}e.prototype.IO=function(e,b){var g=new a.b;this.gj.w(e,g);var c=new a.b;this.gj.w(b,
c);g=g.compare(c);if(0!=g)return g;g=this.gj.Sa(e,this.YI);c=this.gj.Sa(b,this.YI);return g<c?-1:g==c?0:1};return e}(),d=function(){return function(a,e,b,c,d,k,f,p,h){this.Pg=a;this.It=e;this.uB=b;this.hJ=c;this.dj=d;this.em=k;this.yn=f;this.iJ=p;this.NV=h}}();a.FZ=d;var e=function(){function e(){}e.VL=function(g,c,d,k,f,p){if(c.u())g=new b(c,4,-1,-1,NaN,4,-1,-1,NaN,-1,-1,NaN,-1,-1,NaN),f.push(g);else{var n=new a.fd;n.Jb(c);n.Jb(d);a.sk.V(n,k,p,!0);c=0;d=n.Ud();for(k=n.rd;-1!=k;k=n.Ue(k))for(p=n.Pb(k);-1!=
p;p=n.Sb(p))for(var y=n.cb(p),B=0,F=n.La(p);B<F;y=n.U(y),B++)n.Va(y,d,c++);c=e.mM(d,n);e.uW(g,c,n,f)}};e.mM=function(b,g){for(var d=g.vd,k=new a.ia(0),n=g.rd;-1!=n;n=g.Ue(n))for(var f=g.Pb(n);-1!=f;f=g.Sb(f))for(var p=g.cb(f),y=0,h=g.La(f);y<h;p=g.U(p),y++)k.add(p);var l=new c(b,g);k.Gd(0,d,function(a,e){return l.IO(a,e)});b=[];var m=[],A=g.Ud(),q=g.Ud(),n=g.rd,f=g.Ue(n),h=new a.b,r=new a.b,t=k.get(0),u=g.ld(t),v=g.ng(u);g.w(t,h);for(var w=1,p=0;w<d-1;){for(var x=!1,y=w;y<d;y++)if(y!=p){var z=k.get(y),
L=g.ld(z),C=g.ng(L);g.w(z,r);if(h.ub(r))v==n&&C==f&&(x=e.oZ(A,q,g,b,m,u,t,L,z));else break}if(x||p==w-1){x&&p==w-1&&w--;if(++p==d)break;t=k.get(p);u=g.ld(t);v=g.ng(u);g.w(t,h)}x||(w=p+1)}d=[];for(n=g.rd;-1!=n;n=g.Ue(n))for(f=g.Pb(n);-1!=f;f=g.Sb(f))for(k=g.cb(f),y=0,h=g.La(f);y<h;k=g.U(k),y++){p=g.Sa(k,q);if(0<=p)for(;p<m.length&&m[p].Pg==k;)d.push(m[p++]);p=g.Sa(k,A);if(0<=p)for(;p<b.length&&b[p].Pg==k;)d.push(b[p++])}g.le(A);g.le(q);return d};e.oZ=function(a,b,g,c,d,k,f,p,h){var n=g.Rj(k),y=g.Rj(p),
B=g.cb(k),F=g.cb(p),l=g.Ra(f),m=g.Ra(h),H=!1,A=!1,q=!1,M=!1;f!=B&&(h!=F&&(H=e.tZ(a,g,c,k,l,p,m)),h!=y&&(A=e.vZ(a,g,c,k,l,p,h)));f!=n&&(h!=F&&(q=e.xZ(b,g,d,k,f,p,m,B)),h!=y&&(M=e.HL(b,g,d,k,f,p,h,B)));H&&A&&q?(a=c.length-1,2==d[M?d.length-2:d.length-1].dj&&(c[a-1]=c[a],--c.length)):H&&A&&M&&2==d[d.length-1].dj&&(d=c[c.length-1],--c.length,g.Sa(d.Pg,a)==c.length&&g.Va(d.Pg,a,-1));return H||A||q||M};e.tZ=function(e,b,g,c,k,f,p){var n,y;y=new a.Hb;var B=new a.Hb,h=[0,0],F=[0,0];n=b.ic(k);null==n&&(b.od(k,
y),n=y);y=b.ic(p);null==y&&(b.od(p,B),y=B);n=n.Ma(y,null,h,F,0);2>n&&(c=new d(k,c,h[0],NaN,n,p,f,F[0],NaN),g.push(c),c=b.Sa(k,e),0>c&&b.Va(k,e,g.length-1));return!0};e.vZ=function(e,b,g,c,k,f,p){var n,y;y=new a.Hb;var B=new a.Hb,h=[0,0],F=[0,0];n=b.ic(k);null==n&&(b.od(k,y),n=y);y=b.ic(p);null==y&&(b.od(p,B),y=B);n=n.Ma(y,null,h,F,0);return 2>n?(c=new d(k,c,h[0],NaN,n,p,f,F[0],NaN),g.push(c),c=b.Sa(k,e),0>c&&b.Va(k,e,g.length-1),!0):!1};e.xZ=function(e,b,g,c,k,f,p,h){var n,y;y=new a.Hb;var B=new a.Hb,
F=[0,0],l=[0,0];n=b.ic(k);null==n&&(b.od(k,y),n=y);y=b.ic(p);null==y&&(b.od(p,B),y=B);n=n.Ma(y,null,F,l,0);if(2==n)return c=new d(k,c,F[0],F[1],n,p,f,l[0],l[1]),g.push(c),c=b.Sa(k,e),0>c&&b.Va(k,e,g.length-1),!0;B=!1;k==h&&(c=new d(k,c,F[0],NaN,n,p,f,l[0],NaN),g.push(c),c=b.Sa(k,e),0>c&&b.Va(k,e,g.length-1),B=!0);return B};e.HL=function(e,b,g,c,k,f,p,h){var n,y;y=new a.Hb;var B=new a.Hb,F=[0,0],l=[0,0];n=b.ic(k);null==n&&(b.od(k,y),n=y);y=b.ic(p);null==y&&(b.od(p,B),y=B);n=n.Ma(y,null,F,l,0);if(2==
n)return c=new d(k,c,F[0],F[1],n,p,f,l[0],l[1]),g.push(c),c=b.Sa(k,e),0>c&&b.Va(k,e,g.length-1),!0;B=!1;k==h&&(c=new d(k,c,F[0],NaN,n,p,f,l[0],NaN),g.push(c),c=b.Sa(k,e),0>c&&b.Va(k,e,g.length-1),B=!0);return B};e.uW=function(g,c,d,k){var n,f=[];f[0]=new a.b;f[1]=new a.b;f[2]=new a.b;f[3]=new a.b;var p=new a.b,y=new a.b,B=new a.b,h=new a.b,F=null;null!=k&&(F=new a.Cg,F.Js());var l,m=0,A=null,q=new a.Hb;new a.Hb;for(var r=d.Pb(d.rd);-1!=r;r=d.Sb(r)){var t,u=4,v=-1,w,x,z,L=-1,C,D,E,G,I=-1,J=-1,K=NaN;
t=!0;var R=!1,S=!0,N=!0,Q=!0,P=0;z=r;C=0;for(var O=d.cb(r),U=d.La(r),V=0;V<U;O=d.U(O),V++){l=d.ic(O);if(null==l){if(!d.od(O,q))continue;l=q}-1==L&&(L=O);for(var T=0;m<c.length&&O==c[m].Pg;){v=c[m].It;w=c[m].Pg;x=c[m].uB;D=c[m].yn;E=c[m].em;G=c[m].iJ;if(2==c[m].dj){if(R||(z=v,L=w,C=x,I=D,J=E,K=G,u=2,null!=k?A=new a.Ua:P=0,Q=!1,N=!0),x=c[m].hJ,G=c[m].NV,null!=k?(l.yh(T,c[m].hJ,F),A.dc(F.get(),N)):P++,T=x,R=!0,N=t=!1,m+1==c.length||2!=c[m+1].dj||c[m+1].Pg==w&&c[m+1].uB!=T)null!=k?(n=new b(A,2,v,w,x,
u,z,L,C,D,E,G,I,J,K),k.push(n)):null.add(P),z=v,L=w,C=x,I=D,J=E,K=G,u=2,R=t=!1,N=Q=!0}else{var Y=d.U(w);if(m<c.length-1&&c[m+1].Pg==Y&&c[m+1].em==E&&2==c[m+1].dj)x!=T&&(Q&&(null!=k?A=new a.Ua:P=0),t=0<m&&c[m-1].It==v?1==u?0:0==u?1:3:3,null!=k?(l.yh(T,x,F),A.dc(F.get(),N),n=new b(A,t,v,w,x,u,z,L,C,D,E,G,I,J,K),k.push(n)):(P++,null.add(P)),T=x,z=v,L=w,C=x,I=D,J=E,K=G,u=t,t=S=!1,N=Q=!0);else if(!e.bM(g,d,c,m,p,y)){e.NL(d,c,m,r,O,B,h);var W=!1,Y=!1;n=!0;if(!(p.ub(B)||y.ub(B)||p.ub(h)||y.ub(h))){f[0].L(p);
f[1].L(y);f[2].L(B);f[3].L(h);f.sort(a.b.vs);var aa=f[0],ha=f[1],ia=f[2],ja=f[3];aa.ub(p)?ha.ub(y)?g?(Y=W=!0,n=!1):W=!1:ja.ub(y)?g?n=Y=W=!0:W=!1:(W=!0,n=ha.ub(B)):ha.ub(p)?ia.ub(y)?g?(Y=W=!0,n=!1):W=!1:aa.ub(y)?g?n=Y=W=!0:W=!1:(W=!0,n=ia.ub(B)):ia.ub(p)?ja.ub(y)?g?(Y=W=!0,n=!1):W=!1:ha.ub(y)?g?n=Y=W=!0:W=!1:(W=!0,n=ja.ub(B)):aa.ub(y)?g?(Y=W=!0,n=!1):W=!1:ia.ub(y)?g?n=Y=W=!0:W=!1:(W=!0,n=aa.ub(B))}if(W){W=O==w;if(x!=T||W&&0==T)Q&&(null!=k?A=new a.Ua:P=0),null!=k?(l.yh(T,x,F),A.dc(F.get(),N)):P++;if(n)if(1!=
u){if(x!=T||W&&0==T)null!=k?(n=new b(A,1,v,w,x,u,z,L,C,D,E,G,I,J,K),k.push(n)):null.add(P);if(!Y)u=1;else if(m==c.length-2||c[m+2].It!=v)u=0}else{if(x!=T||W&&0==T)null!=k?(n=new b(A,3,v,w,x,u,z,L,C,D,E,G,I,J,K),k.push(n)):null.add(P);u=1}else if(0!=u){if(x!=T||W&&0==T)null!=k?(n=new b(A,0,v,w,x,u,z,L,C,D,E,G,I,J,K),k.push(n)):null.add(P);if(!Y)u=0;else if(m==c.length-2||c[m+2].It!=v)u=1}else{if(x!=T||W&&0==T)null!=k?(n=new b(A,3,v,w,x,u,z,L,C,D,E,G,I,J,K),k.push(n)):null.add(P);u=0}if(x!=T||W&&0==
T)T=x,z=v,L=w,C=x,I=D,J=E,K=G,t=S=!1,N=Q=!0}}}m++}1!=T&&(Q&&(null!=k?A=new a.Ua:P=0),null!=k?(l.yh(T,1,F),A.dc(F.get(),N)):P++,N=Q=!1,S=!0)}S&&(x=1,w=d.Rj(r),w=d.Ra(w),E=D=-1,G=NaN,t?null!=k?(n=new b(A,4,v,w,x,u,z,L,C,D,E,G,I,J,K),k.push(n)):null.add(P):(t=1==u?0:0==u?1:3,null!=k?(n=new b(A,t,v,w,x,u,z,L,C,D,E,G,I,J,K),k.push(n)):null.add(P)))}};e.bM=function(b,g,c,d,k,f){var n=c[d].iJ;if(1==n)return e.RL(b,g,c,d,k,f);if(0==n)return e.YL(b,g,c,d,k,f);throw a.g.za();};e.RL=function(e,b,g,c,d,k){var n=
new a.Hb,f=g[c].Pg,p=g[c].yn,y=g[c].em,B=-1,h=-1,F=-1,l=-1;if(!e&&0<c)var m=g[c-1],B=m.Pg,h=m.yn,F=m.em,l=m.dj;var H=-1,A=-1,q=-1,M=-1;c<g.length-1&&(m=g[c+1],H=m.Pg,A=m.yn,q=m.em,M=m.dj);var r=b.U(f),m=b.U(y);if(!e)return 0<c&&B==f&&h==p&&F==m&&2==l||c<g.length-1&&H==r&&A==p&&q==m&&2==M?(e=b.ic(y),null==e&&(b.od(y,n),e=n),k.L(e.Eg(1)),d.bu(k),k.normalize(),d.normalize(),!1):c<g.length-1&&H==f&&A==p&&q==m?(e=b.ic(y),null==e&&(b.od(y,n),e=n),d.L(e.Eg(1)),e=b.ic(m),null==e&&(b.od(m,n),e=n),k.L(e.Eg(0)),
d.Lr(),k.normalize(),d.normalize(),!1):!0;if(c==g.length-1||H!=f||A!=p||q!=m||2==M)return e=b.ic(y),null==e&&(b.od(y,n),e=n),k.L(e.Eg(1)),d.bu(k),k.normalize(),d.normalize(),!1;e=b.ic(y);null==e&&(b.od(y,n),e=n);d.L(e.Eg(1));e=b.ic(m);null==e&&(b.od(m,n),e=n);k.L(e.Eg(0));d.Lr();k.normalize();d.normalize();return!1};e.YL=function(e,b,g,c,d,k){var n=new a.Hb,f=g[c].Pg,p=g[c].yn,y=g[c].em,B=-1,h=-1,F=-1,l=-1;if(!e&&c<g.length-1)var m=g[c+1],B=m.Pg,h=m.yn,F=m.em,l=m.dj;var H=-1,A=-1,q=-1,m=-1;0<c&&(m=
g[c-1],H=m.Pg,A=m.yn,q=m.em,m=m.dj);var M=b.U(f),r=b.Ra(y);return e?0==c||H!=f||A!=p||q!=r||2==m?(e=b.ic(y),null==e&&(b.od(y,n),e=n),k.L(e.Eg(0)),d.bu(k),k.normalize(),d.normalize(),!1):!0:0<c&&H==f&&A==p&&q==r&&2==m||c<g.length-1&&B==M&&h==p&&F==r&&2==l?(e=b.ic(y),null==e&&(b.od(y,n),e=n),k.L(e.Eg(0)),d.bu(k),k.normalize(),d.normalize(),!1):!0};e.NL=function(e,b,g,c,d,k,f){var n=new a.Hb,p=e.ic(d);null==p&&(e.od(d,n),p=n);g=b[g];b=g.Pg;g=g.uB;d=e.U(b);if(1==g)k.L(p.Eg(1)),-1!=d&&d!=e.Rj(c)?(p=e.ic(d),
null==p&&(e.od(d,n),p=n),f.L(p.Eg(0)),p=e.ic(b),null==p&&e.od(b,n)):f.L(k),k.Lr(),f.normalize(),k.normalize();else if(0==g)f.L(p.Eg(g)),k.bu(f),f.normalize(),k.normalize();else throw a.g.za();};return e}();a.XL=e})(x||(x={}));(function(a){(function(a){a[a.Linear=0]="Linear";a[a.Angular=1]="Angular";a[a.Area=2]="Area"})(a.jO||(a.jO={}));var b=function(){function e(a,e,b){this.td=e;this.Ai=b;this.cB=a}e.prototype.Eb=function(a){return a instanceof e?this.Ai===a.Ai:!1};e.lH=function(a){return 0!==a.td?
null:-1===a.cB?new e(-1,2,a.Ai*a.Ai):e.pe(n[a.cB])};e.pe=function(a){a=g[a];return void 0===a?null:a};e.cR=function(a,b,g){var c=null;if(void 0!==g&&null!==g)try{"EPSG"===g.values[0]&&(c=e.pe(parseInt(g.values[1])))}catch(Z){}null===c&&(c=new e(-1,a,b));return c};e.prototype.Cc=function(){return this.cB};e.prototype.OG=function(e){if(e.td!=this.td)throw a.g.Da();return this.Ai/e.Ai};e.li=function(a,e,b){return e.OG(b)*a};e.eG=function(a,e,b,g,c){b=b.OG(g);for(g=0;g<e;g++)c[g]=a[g]*b};return e}();
a.kc=b;for(var c=[109401,1E4,109402,4046.8564224,109403,4046.87260987425,109404,1,109405,.09290304,109406,.09290341161327487,109407,.09290137299531805,109408,3.34450944,109409,3429904,109410,1.000027193184865,109411,404.6872609874253,109412,.04046872609874253,109413,2589998.4703195216,109414,1E6,109415,.8361123569578626,109416,404.67838076760535,109417,.04046783807676053,109418,.8361244606523066,109419,.09290271785025629,109420,404.68423895571647,109421,.04046842389557164,109422,.83612589696064,109423,
.0929028774400711,109424,404.6849341289498,109425,.04046849341289498,109426,.836125904805842,109427,.09290287831176021,109428,404.68493792602754,109429,.04046849379260275,109430,.09290354800069446,109431,.09290274144751023,109432,.09290207073852812,109433,.09290279616016,109434,.09290273520025,109435,.836124673027592,109436,.836118636646753,109437,.8361251654414399,109438,.83612461680225,109439,2589988.110336,109440,.09290286332673177,109441,.09290349665192114,109442,.83612736,109443,.8361307045194736,
109444,404.68564224000005,109445,.04046856422400001,109446,.8361237024040001,109447,.0929026336004445,109448,404.683871963536,109449,.0404683871963536,109450,.01,109451,1E-4,109452,1E-6,109453,6.4516E-4,109454,6.451625806477421E-4,109455,25.292852640000003,109456,25.29295381171408,109457,3434528.1495040003,109458,3434290.937856,109459,2.89612324,109460,25E8,109461,225E8,109462,.7168473118308245,109463,100,109464,1.244521604938272E-7,109465,1E-12,109466,1E-18],d=[1031,4.84813681109536E-9,9101,1,9102,
.0174532925199433,9103,2.908882086657216E-4,9104,4.84813681109536E-6,9105,.01570796326794897,9106,.01570796326794897,9109,1E-6,9112,1.570796326794897E-4,9113,1.570796326794897E-6,9114,9.817477042468104E-4],e=[1025,.001,109452,1033,.01,109451,9001,1,109404,9002,.3048,109405,9003,.3048006096012192,109406,9005,.3047972654,109407,9014,1.8288,109408,9030,1852,109409,9031,1.0000135965,109410,9033,20.11684023368047,109411,9034,.2011684023368047,109412,9035,1609.3472186944375,109413,9036,1E3,109414,9037,
.9143917962000001,109415,9038,20.1166195164,109416,9039,.201166195164,109417,9040,.9143984146160287,109418,9041,.304799471538676,109419,9042,20.116765121552632,109420,9043,.2011676512155263,109421,9050,.9143992,109422,9051,.3047997333333333,109423,9052,20.1167824,109424,9053,.201167824,109425,9060,.9143992042898124,109426,9061,.3047997347632708,109427,9062,20.116782494375872,109428,9063,.2011678249437587,109429,9070,.3048008333333334,109430,9080,.3047995102481469,109431,9081,.30479841,109432,9082,
.3047996,109433,9083,.3047995,109434,9084,.9143985307444408,109435,9085,.91439523,109436,9086,.9143988,109437,9087,.9143985,109438,9093,1609.344,109439,9094,.3047997101815088,109440,9095,.3048007491,109441,9096,.9144,109442,9097,20.1168,109444,9098,.201168,109445,9099,.914398,109446,9300,.3047993333333334,109447,9301,20.116756,109448,9302,.20116756,109449,109001,.9144,109442,109002,.9144018288036576,109443,109003,20.1168,109444,109004,.201168,109445,109005,.1,109450,109006,.01,109451,109007,.001,
109452,109008,.0254,109453,109009,.0254000508001016,109454,109010,5.0292,109455,109011,5.029210058420118,109456,109012,1853.248,109457,109013,1853.184,109458,109014,1.7018,109459,109015,.8466683600033867,109462,109016,3.527777777777778E-4,109464,109017,1E-6,109465,109018,1E-9,109466,109030,5E4,109460,109031,15E4,109461],g=[],n=[],f=0;f<c.length;f+=2)g[c[f]]=new b(c[f],2,c[f+1]);c=null;for(f=0;f<d.length;f+=2)g[d[f]]=new b(d[f],1,d[f+1]);d=null;for(f=0;f<e.length;f+=3)g[e[f]]=new b(e[f],0,e[f+1]),
n[e[f]]=e[f+2];e=null})(x||(x={}));(function(a){var b=function(){function a(){this.Gb=this.qb=0}a.prototype.set=function(a,e){void 0!==e?(this.qb=a,this.Gb=e):"number"===typeof a?(this.qb=a,this.Gb=0):(this.qb=a.qb,this.Gb=a.Gb)};a.prototype.value=function(){return this.qb};a.prototype.add=function(a){var e=this.qb+a.qb;a=this.Gb+a.Gb+2.220446049250313E-16*Math.abs(e);this.qb=e;this.Gb=a};a.prototype.jP=function(){var a=this.qb+1,e=this.Gb+2.220446049250313E-16*Math.abs(a);this.qb=a;this.Gb=e};a.prototype.cP=
function(a,e){this.qb=a.qb+e.qb;this.Gb=a.Gb+e.Gb+2.220446049250313E-16*Math.abs(this.qb)};a.prototype.sub=function(a){if("number"===typeof a){var e=this.qb-a;a=this.Gb+2.220446049250313E-16*Math.abs(e)}else e=this.qb-a.qb,a=this.Gb+a.Gb+2.220446049250313E-16*Math.abs(e);this.qb=e;this.Gb=a};a.prototype.Vg=function(a){var e=this.qb*a.qb;this.Gb=this.Gb*Math.abs(a.qb)+a.Gb*Math.abs(this.qb)+this.Gb*a.Gb+2.220446049250313E-16*Math.abs(e);this.qb=e};a.prototype.yp=function(a){var e=this.qb*a;this.Gb=
this.Gb*Math.abs(a)+2.220446049250313E-16*Math.abs(e);this.qb=e};a.prototype.pm=function(a,e){var b=Math.abs(a.qb)*Math.abs(e.qb);this.Gb=a.Gb*Math.abs(e.qb)+e.Gb*Math.abs(a.qb)+a.Gb*e.Gb+2.220446049250313E-16*Math.abs(b);this.qb=b};a.prototype.Wm=function(a){var e=Math.abs(a.qb),b=this.qb/a.qb,c=(this.Gb+Math.abs(b)*a.Gb)/e;a.Gb>.01*e&&(a=a.Gb/e,c*=1+(1+a)*a);this.qb=b;this.Gb=c+2.220446049250313E-16*Math.abs(b)};a.prototype.sqrt=function(){var a,e;0<=this.qb?(a=Math.sqrt(this.qb),e=this.qb>10*this.Gb?
.5*this.Gb/a:this.qb>this.Gb?a-Math.sqrt(this.qb-this.Gb):Math.max(a,Math.sqrt(this.qb+this.Gb)-a),e+=2.220446049250313E-16*Math.abs(a)):this.qb<-1*this.Gb?e=a=NaN:(a=0,e=Math.sqrt(this.Gb));this.qb=a;this.Gb=e};a.prototype.sin=function(a){var e=Math.sin(a.qb),b=Math.cos(a.qb);this.qb=e;e=Math.abs(e);this.Gb=(Math.abs(b)+.5*e*a.Gb)*a.Gb+2.220446049250313E-16*e};a.prototype.cos=function(a){var e=Math.sin(a.qb),b=Math.cos(a.qb);this.qb=b;b=Math.abs(b);this.Gb=(Math.abs(e)+.5*b*a.Gb)*a.Gb+2.220446049250313E-16*
b};a.prototype.Lg=function(){return Math.abs(this.qb)<=this.Gb};a.prototype.lt=function(){return this.Lg()&&0!=this.Gb};return a}();a.Xb=b})(x||(x={}));var N=new x.b,O=new x.b,P=new x.b,S=new x.b,R=new x.b;(function(a){var b;(function(a){a[a.closedPath=1]="closedPath";a[a.exteriorPath=2]="exteriorPath";a[a.ringAreaValid=4]="ringAreaValid"})(b||(b={}));var c=function(){function b(a,b,c,d,k,f,p){void 0!==b?(this.bb=a,this.Bk=b,this.Gl=c,this.Ji=d,this.Ca=f,this.RA=p,this.Uw=k):(this.bb=a.bb,this.Bk=
a.Bk,this.Gl=a.Gl,this.Ji=a.Ji,this.Ca=a.Ca,this.RA=a.RA,this.Uw=a.Uw);this.nI=!0}b.prototype.next=function(){return this.nI?(this.nI=!1,this.Ji):-1!=this.Ji?(this.Ji=this.bb.U(this.Ji),this.Ca++,-1!=this.Ji&&this.Ji!=this.Uw?this.Ji:this.ZV()):-1};b.prototype.ZV=function(){this.Gl=this.bb.Sb(this.Gl);for(this.Ca=0;-1!=this.Bk;){for(;-1!=this.Gl;this.Gl=this.bb.Sb(this.Gl))if(this.Uw=this.Ji=this.bb.cb(this.Gl),-1!=this.Ji)return this.Ji;this.Bk=this.bb.Ue(this.Bk);if(-1==this.Bk)break;if(!this.RA||
a.T.Ic(this.bb.hc(this.Bk)))this.Gl=this.bb.Pb(this.Bk)}return-1};b.yR=function(a,g,c,d,k,f,p){return new b(a,g,c,d,k,f,p)};return b}();a.MZ=c;b=function(){function b(){this.Xo=this.on=this.Xk=this.md=this.dl=this.jp=this.nj=this.sd=this.Bi=this.ph=this.wf=this.Hr=this.Kr=this.xb=this.nm=null;this.cx=this.rd=-1;this.vd=0;this.PA=!1;this.Hr=this.Kr=this.xb=null}b.prototype.ti=function(a){return null!=this.wf?this.wf[a]:null};b.prototype.th=function(a,b){if(null==this.wf){if(null==b)return;this.wf=
[];for(var e=0,g=this.xb.D();e<g;e++)this.wf.push(null)}this.wf[a]=b};b.prototype.Lp=function(a,b){this.sd.P(a,1,b)};b.prototype.Kp=function(a,b){this.sd.P(a,2,b)};b.prototype.uC=function(a,b){this.sd.P(a,6,b)};b.prototype.Lq=function(a){return this.sd.S(a,6)};b.prototype.Rx=function(a,b){this.sd.P(a,7,b)};b.prototype.dw=function(a){return this.sd.S(a,0)};b.prototype.FK=function(a,b){this.md.P(a,1,b)};b.prototype.JK=function(a,b){this.md.P(a,0,b)};b.prototype.UG=function(a){return this.md.S(a,7)};
b.prototype.Ip=function(a,b){this.md.P(a,3,b)};b.prototype.Jp=function(a,b){this.md.P(a,4,b)};b.prototype.fW=function(e){null==this.md&&(this.md=new a.ad(8));var b=this.md.Pe();this.md.P(b,2,e);this.md.P(b,5,0);this.md.P(b,6,0);this.md.P(b,7,b);return b};b.prototype.DS=function(a){this.md.kd(a)};b.prototype.hW=function(e){null==this.sd&&(this.sd=new a.ad(8),this.Dd=new a.ad(5),this.nj=new a.Qd(0),this.jp=new a.Qd(0));var b=this.sd.Pe();this.sd.P(b,0,b);this.sd.P(b,3,0);this.sd.P(b,6,0);this.Rx(b,
e);b>=this.nj.size&&(e=16>b?16:a.J.truncate(3*b/2),this.nj.resize(e),this.jp.resize(e));this.nj.set(b,0);this.jp.set(b,0);return b};b.prototype.DG=function(a){this.sd.kd(a)};b.prototype.Ez=function(a){this.Dd.kd(a);this.vd--};b.prototype.xJ=function(e){null==this.sd&&(this.sd=new a.ad(8),this.Dd=new a.ad(5),this.nj=new a.Qd(0),this.jp=new a.Qd(0));var b=this.Dd.Pe(),c=0<=e?e:b;this.Dd.P(b,0,c);if(0>e){if(c>=this.xb.D()){e=16>c?16:a.J.truncate(3*c/2);this.xb.resize(e);if(null!=this.wf)for(var d=0;d<
e;d++)this.wf.push(null);null!=this.ph&&this.ph.resize(e);this.Kr=this.xb.Pa(0)}this.xb.rb(c,-1E38,-1E38);null!=this.wf&&(this.wf[c]=null);null!=this.ph&&this.ph.write(c,1)}this.Dd.P(b,4,2*c);this.vd++;return b};b.prototype.Wj=function(a,b,c){var e=-1!=b?this.Ra(b):this.Rj(a),g=-1!=e?this.U(e):-1,d=this.xJ(null==c?this.vd:-1),k=this.Za(d);null!=c&&this.xb.vu(k,c);this.Aj(d,a);this.Kc(d,g);this.Lc(d,e);-1!=g&&this.Lc(g,d);-1!=e&&this.Kc(e,d);c=this.Qb(a);e=this.cb(a);-1==b&&this.sh(a,d);b==e&&this.jg(a,
d);c&&-1==g&&(this.Kc(d,d),this.Lc(d,d));this.nk(a,this.La(a)+1);a=this.ng(a);this.lk(a,this.D(a)+1);return d};b.prototype.an=function(){null==this.Xo&&(this.Xo=new a.Wa(this.xb.description));return this.Xo};b.prototype.Hp=function(a,b){this.md.P(a,2,this.md.S(a,2)&-134217729||(1==b?134217728:0))};b.prototype.xo=function(a){return 0!=(this.md.S(a,2)&134217728)?1:0};b.prototype.gP=function(a){var e=this.bh(a.G(),a.description);1736==a.G()&&this.Hp(e,a.xo());this.hF(e,a);return e};b.prototype.hP=function(a){var e=
this.bh(a.G(),a.description);this.iF(e,a);return e};b.prototype.QW=function(e,b){null==this.sd&&(this.sd=new a.ad(8),this.Dd=new a.ad(5),this.nj=new a.Qd(0),this.jp=new a.Qd(0));this.sd.Qe(this.sd.yd+e);this.Dd.Qe(this.Dd.yd+b);this.nj.yb(this.nj.size+e);this.jp.yb(this.jp.size+e)};b.prototype.hF=function(e,b){this.QW(b.aa(),b.D());this.nm.Id(b,0,b.D());this.Kr=this.xb.Pa(0);for(var c=null!=this.wf&&null!=b.cf,g=0,d=b.aa();g<d;g++)if(!(2>b.La(g))){var k=this.Yf(e,-1);this.$n(k,b.Qb(g));for(var f=
b.wa(g),p=b.Gc(g);f<p;f++){var h=this.Wj(k,-1,null);if(c)if(h=this.Za(h),0!=(b.jH(f)&1))this.th(h,null);else{var l=new a.Cg;b.ic(f,l,!0);this.th(h,l.get())}}}};b.prototype.iF=function(a,b){this.nm.Id(b,0,b.D());this.Kr=this.xb.Pa(0);a=this.Yf(a,-1);var e=0;for(b=b.D();e<b;e++)this.Wj(a,-1,null)};b.prototype.HY=function(e,b,c){var g=this.U(e);if(-1==g)throw a.g.za();for(var d=this.an(),k=this.ld(e),n=0,f=b.Rl(c);n<f;n++){var p=this.Za(e),h=this.U(e),l=b.Mq(c,n);0==n&&(l.Dp(d),this.Yh(e,d));322==l.G()?
this.th(p,null):this.th(p,a.T.oe(l));l.Bp(d);n<f-1?e=this.Wj(k,h,d):this.Yh(g,d)}};b.prototype.GY=function(e,b,c){var g=this.U(e);if(-1==g)throw a.g.za();for(var d=this.an(),k=this.ld(e),n=0,f=b.Rl(c);n<f;n++){var p=this.Za(e),h=this.U(e),l=b.Mq(c,f-n-1);0==n&&(l.Bp(d),this.Yh(e,d));322==l.G()?this.th(p,null):this.th(p,a.T.oe(l));l.Dp(d);n<f-1?e=this.Wj(k,h,d):this.Yh(g,d)}};b.prototype.TG=function(){var e=new a.h;e.Oa();for(var b=this.Qr(),c=new a.b,d=!0,k=b.next();-1!=k;k=b.next())this.w(k,c),d?
e.Nb(c.x,c.y):e.ll(c.x,c.y),d=!1;return e};b.prototype.Jb=function(e){var b=e.G();if(a.T.Ic(b))return this.gP(e);if(550==b)return this.hP(e);throw a.g.za();};b.prototype.xP=function(e,b){var c=b.G();if(a.T.Ic(c))this.hF(e,b);else if(550==c)this.iF(e,b);else throw a.g.za();};b.prototype.lP=function(e,b){var c=this.bh(1736,e.description);if(2>e.La(b))return c;this.nm.Id(e,e.wa(b),e.Gc(b));this.Kr=this.xb.Pa(0);var g=this.Yf(c,-1);this.$n(g,e.Qb(b)||!0);var d=null!=this.wf&&null!=e.cf,k=e.wa(b);for(b=
e.Gc(b);k<b;k++){var f=this.Wj(g,-1,null);if(d)if(f=this.Za(f),0!=(e.jH(k)&1))this.th(f,null);else{var p=new a.Cg;e.ic(k,p,!0);this.th(f,p.get())}}return c};b.prototype.Se=function(e){var b=this.hc(e),c=a.vM.bh(b,this.nm.description),d=this.D(e);if(0==d)return c;if(a.T.Ic(b)){for(var b=this.aa(e),k=a.Uc.wh(b+1),f=a.Uc.vq(b+1,0),p=c.description,h=0,l=p.Ga;h<l;h++){for(var m=p.qd(h),A=a.ma.Xa(m),q=a.Uc.qz(m,d),r=this.xb.Pa(m),t=0,u=0,v=0,w=this.Pb(e);-1!=w;w=this.Sb(w)){var x=0;this.Qb(w)&&(x|=1);this.SU(w)&&
(x|=4);0!=x&&f.jC(u,x);var z=this.La(w);k.write(u++,v);v+=z;if(0==m)for(var z=r,L=q,C=new a.b,x=this.cb(w);t<v;x=this.U(x),t++){var D=this.Za(x);z.fc(2*D,C);L.fo(2*t,C)}else for(x=this.cb(w);t<v;x=this.U(x),t++)for(D=this.Za(x),L=0;L<A;L++)C=r.Of(D*A+L),q.Dm(t*A+L,C)}c.Yn(m,q);k.write(b,d)}c.GK(f);c.HK(k);c.Dc(16777215)}else if(550==b){p=c.description;c.resize(d);h=0;for(l=p.Ga;h<l;h++){m=p.qd(h);A=a.ma.Xa(m);q=c.Pa(m);r=this.xb.Pa(m);t=0;w=this.Pb(e);z=this.La(w);for(x=this.cb(w);t<z;x=this.U(x),
t++)for(D=this.Za(x),L=0;L<A;L++)C=r.Of(D*A+L),q.Dm(t*A+L,C);c.Yn(m,q)}c.Dc(16777215)}return c};b.prototype.bC=function(a){for(var e=this.Pb(a);-1!=e;e=this.Rr(e));var e=this.JT(a),b=this.Ue(a);-1!=e?this.FK(e,b):this.rd=b;-1!=b?this.JK(b,e):this.cx=e;this.DS(a)};b.prototype.bh=function(e,b){return void 0===b?this.hG(e,a.ze.Ig()):this.hG(e,b)};b.prototype.hG=function(e,b){e=this.fW(e);null==this.xb?this.xb=this.nm=new a.Ed(b):this.nm.om(b);this.Hr=this.nm.description;this.PA=1<this.Hr.Ga;-1==this.rd?
this.rd=e:(this.JK(e,this.cx),this.FK(this.cx,e));return this.cx=e};b.prototype.Ue=function(a){return this.md.S(a,1)};b.prototype.JT=function(a){return this.md.S(a,0)};b.prototype.hc=function(a){return this.md.S(a,2)&2147483647};b.prototype.xK=function(e,b,c){b=this.Xk[b];e=this.UG(e);e>=b.size&&b.resize(Math.max(a.J.truncate(1.25*e),16),-1);b.write(e,c)};b.prototype.VG=function(a,b){a=this.UG(a);b=this.Xk[b];return a<b.size?b.read(a):-1};b.prototype.iG=function(){null==this.Xk&&(this.Xk=[]);for(var e=
0;e<this.Xk.length;e++)if(null==this.Xk[e])return this.Xk[e]=a.Uc.wh(0),e;this.Xk.push(a.Uc.wh(0));return this.Xk.length-1};b.prototype.vX=function(a){this.Xk[a]=null};b.prototype.Pb=function(a){return this.md.S(a,3)};b.prototype.Xv=function(a){return this.md.S(a,4)};b.prototype.D=function(a){return this.md.S(a,5)};b.prototype.aa=function(a){return this.md.S(a,6)};b.prototype.zq=function(e,b,c){for(var g=0,d=this.rd;-1!=d;d=this.Ue(d)){var k=this.hc(d);if(a.T.Ic(k)&&(!c||1736==k))for(var k=1736==
this.hc(d),n=this.Pb(d);-1!=n;){for(var f=0,p=this.cb(n);f<a.J.truncate(this.La(n)/2);){var h=this.U(p);if(-1==h)break;var l=this.Za(p),m=this.ti(l);null!=m?l=m.Rb():(m=this.Za(h),l=this.xb.xs(l,m));l<=e?(0==l?0==g&&(g=-1):g=1,h!=this.Rj(n)&&(this.KC(h,p),this.ud(h,!0))):p=this.U(p);f++}f=this.cb(n);for(p=this.Qb(n)?f:this.Rj(n);0<this.La(n);)if(h=this.Ra(p),-1!=h){var A=this.Za(h),m=this.ti(A);null!=m?l=m.Rb():(l=this.Za(p),l=this.xb.xs(l,A));if(l<=e)0==l?0==g&&(g=-1):g=1,this.KC(h,p),this.ud(h,
!1),f==h&&(f=this.cb(n));else if(p=this.Ra(p),p==f)break}else{this.ud(p,!0);0==g&&(g=-1);break}p=this.La(n);b&&(k?3>p:2>p)?(n=this.Rr(n),g=0<p?1:0==g?-1:g):n=this.Sb(n)}}return g};b.prototype.KC=function(a,b){var e=this.Za(a),c=this.Za(b);null!=this.ph&&(e=this.ph.read(e),this.ph.write(c,e));if(null!=this.Bi)for(c=0,e=this.Bi.length;c<e;c++)if(null!=this.Bi[c]){var g=this.Sa(a,c);-1!=g&&this.Va(b,c,g)}};b.prototype.zm=function(e,b,c){var g=0,d=this.U(e);if(-1==d)throw a.g.za();for(var k=this.Za(e),
n=this.Za(d),f=this.ti(k),p=null==f?this.xb.xs(k,n):f.Rb(),h=0;h<c;h++){var l=b[h];if(0<l&&1>l){var m=l;null!=f&&(m=0<p?f.Dy(l)/p:0);this.xb.EE(k,n,m,this.an());var A=this.Wj(this.ld(e),d,this.an());g++;if(null!=f){var q=f.Hl(0,l),m=this.Za(this.Ra(A));this.th(m,q);this.Qf(A,q.Bc());if(h==c-1||1==b[h+1])l=f.Hl(l,1),this.th(m,l)}}}return g};b.prototype.FY=function(e,b,c){var g=0,d=this.U(e);if(-1==d)throw a.g.X("internal error");var k=this.Za(e),n=this.Za(d),f=this.ti(k),p=null==f?this.xb.xs(k,n):
f.Rb(),h=0;e=this.ld(e);for(var l=0;l<c;l++){var m=b[l];if(h<m&&1>m){var A=m;null!=f&&(A=0<p?f.Dy(m)/p:0);this.xb.EE(k,n,A,this.an());A=this.uU(e,d,this.an());g++;if(null!=f){var h=f.Hl(h,m),q=this.Za(this.Ra(A));this.th(q,h);this.rb(A,h.sa,h.oa);if(l==c-1||1==b[l+1])h=f.Hl(m,1),A=this.Za(A),this.th(A,h)}}h=m}return g};b.prototype.uU=function(a,b,c){var e=-1!=b?this.Ra(b):this.Rj(a),g=-1!=e?this.U(e):-1,d=this.xJ(null==c?this.vd:-1),k=this.Za(d);null!=c&&this.xb.vu(k,c);this.Aj(d,a);this.Kc(d,g);
this.Lc(d,e);-1!=g&&this.Lc(g,d);-1!=e&&this.Kc(e,d);c=this.Qb(a);e=this.cb(a);-1==b&&this.sh(a,d);b==e&&(c&&-1!=e||this.jg(a,d));c&&-1==g&&(this.Kc(d,d),this.Lc(d,d));this.nk(a,this.La(a)+1);a=this.ng(a);this.lk(a,this.D(a)+1);return d};b.prototype.FF=function(e,b,c){var g=this.Za(b),d=this.Za(c);if(0>g||d>this.vd-1)throw a.g.F("invalid call");if(g>d&&!this.Qb(e))throw a.g.F("cannot iterate across an open path");for(e=0;b!=c;b=this.U(b))g=this.Za(b),d=this.ti(g),null!=d?e+=d.Rb():(d=this.Za(this.U(b)),
e+=this.xb.xs(g,d));return e};b.prototype.Yh=function(a,b){var e=this.Za(a);this.xb.vu(e,b);e=this.ti(e);null!=e&&e.setStart(b);a=this.Ra(a);-1!=a&&(a=this.Za(a),null!=this.ti(a)&&e.setEnd(b))};b.prototype.wj=function(a,b){a=this.Za(a);this.xb.Ae(a,b)};b.prototype.Qf=function(a,b){this.rb(a,b.x,b.y)};b.prototype.rb=function(a,b,c){var e=this.Za(a);this.xb.rb(e,b,c);e=this.ti(e);null!=e&&e.xC(b,c);a=this.Ra(a);-1!=a&&(a=this.Za(a),null!=this.ti(a)&&e.vm(b,c))};b.prototype.w=function(a,b){this.xb.w(this.Dd.S(a,
0),b)};b.prototype.Nc=function(a,b){this.xb.ya[0].fc(2*this.Dd.S(a,0),b)};b.prototype.Ba=function(e){var b=new a.b;this.xb.w(this.Dd.S(e,0),b);return b};b.prototype.pH=function(a,b){this.Kr.fc(2*a,b)};b.prototype.Yc=function(a,b,c){return this.xb.Yc(a,this.Za(b),c)};b.prototype.setAttribute=function(a,b,c,d){this.xb.setAttribute(a,this.Za(b),c,d)};b.prototype.Za=function(a){return this.Dd.S(a,0)};b.prototype.nf=function(e){var b=new a.b;this.w(e,b);return b.y};b.prototype.Uq=function(a,b){a=this.Za(a);
b=this.Za(b);var e=this.xb.ya[0].f;return e[2*a]===e[2*b]&&e[2*a+1]===e[2*b+1]};b.prototype.qw=function(a,b){a=this.Za(a);var e=this.xb.ya[0].f;return e[2*a]===b.x&&e[2*a+1]===b.y};b.prototype.rY=function(e,b){1>b&&(b=1);if(null==this.ph){if(1==b)return;this.ph=a.Uc.Um(this.xb.D(),1)}e=this.Za(e);e>=this.ph.size&&this.ph.resize(e+1,1);this.ph.write(e,b)};b.prototype.oH=function(a){a=this.Za(a);return null==this.ph||a>=this.ph.size?1:this.ph.read(a)};b.prototype.Va=function(a,b,c){b=this.Bi[b];a=this.Za(a);
b.size<this.xb.D()&&b.resize(this.xb.D(),-1);b.write(a,c)};b.prototype.Sa=function(a,b){a=this.Za(a);b=this.Bi[b];return a<b.size?b.read(a):-1};b.prototype.Ud=function(){null==this.Bi&&(this.Bi=[]);for(var e=0;e<this.Bi.length;e++)if(null==this.Bi[e])return this.Bi[e]=a.Uc.wh(0,-1),e;this.Bi.push(a.Uc.wh(0,-1));return this.Bi.length-1};b.prototype.le=function(a){this.Bi[a]=null};b.prototype.ic=function(a){return null!=this.wf?(a=this.Za(a),this.wf[a]):null};b.prototype.od=function(e,b){var c=this.Dd.S(e,
2);if(-1==c)return!1;if(this.PA){var g=new a.Wa;this.wj(e,g);b.setStart(g);this.wj(c,g);b.setEnd(g)}else this.xb.Nc(this.Dd.S(e,0),N),b.Qm(0,N),this.xb.Nc(this.Dd.S(c,0),N),b.Qm(1,N);return!0};b.prototype.hX=function(e,b,c){if(this.PA){var g=new a.Wa;this.wj(e,g);c.setStart(g);this.wj(b,g);c.setEnd(g)}else this.xb.Nc(e,N),c.Qm(0,N),this.xb.Nc(b,N),c.Qm(1,N)};b.prototype.Yf=function(e,b){var c;if(-1!=b){if(e!=this.ng(b))throw a.g.za();c=this.ct(b)}else c=this.Xv(e);var g=this.hW(e);-1!=b&&this.Lp(b,
g);this.Kp(g,b);this.Lp(g,c);-1!=c?this.Kp(c,g):this.Ip(e,g);-1==b&&this.Jp(e,g);this.wm(e,this.aa(e)+1);return g};b.prototype.BH=function(a,b,c,d){a=this.Yf(a,-1);for(var e=0,g=b,k=!1;g==c&&(k=!0),this.Aj(g,a),e++,g=this.U(g),g!=b;);this.$n(a,!0);this.nk(a,e);k&&(b=c);this.jg(a,b);this.sh(a,this.Ra(b));this.Np(a,!1);null!=d&&(d[0]=k);return a};b.prototype.Rr=function(a){var e=this.ct(a),b=this.Sb(a),c=this.ng(a);-1!=e?this.Kp(e,b):this.Ip(c,b);-1!=b?this.Lp(b,e):this.Jp(c,e);this.EQ(a);this.wm(c,
this.aa(c)-1);this.DG(a);return b};b.prototype.EQ=function(a){var e=this.cb(a);if(-1!=e){for(var b=0,c=this.La(a);b<c;b++){var d=e,e=this.U(e);this.Ez(d)}e=this.ng(a);this.lk(e,this.D(e)-this.La(a))}this.nk(a,0)};b.prototype.Sb=function(a){return this.sd.S(a,2)};b.prototype.ct=function(a){return this.sd.S(a,1)};b.prototype.La=function(a){return this.sd.S(a,3)};b.prototype.Qb=function(a){return 0!=(this.Lq(a)&1)};b.prototype.$n=function(a,b){if(this.Qb(a)!=b){if(0<this.La(a)){var e=this.cb(a),c=this.Rj(a);
b?(this.Kc(c,e),this.Lc(e,c)):(this.Kc(c,-1),this.Lc(e,-1));e=this.Za(c);this.th(e,null)}this.uC(a,(this.Lq(a)|1)-1|(b?1:0))}};b.prototype.ng=function(a){return this.sd.S(a,7)};b.prototype.SU=function(a){return 0!=(this.Lq(a)&2)};b.prototype.pC=function(a,b){this.uC(a,(this.Lq(a)|2)-2|(b?2:0))};b.prototype.hA=function(e){if(this.YU(e))return this.nj.get(this.dw(e));var b=new a.Hb,c=this.cb(e);if(-1==c)return 0;var d=new a.b;this.w(c,d);for(var k=0,f=0,p=this.La(e);f<p;f++,c=this.U(c)){var h=this.ic(c);
if(null==h){if(!this.od(c,b))continue;h=b}k+=h.Cy(d.x,d.y)}this.Np(e,!0);this.nj.set(this.dw(e),k);return k};b.prototype.$r=function(a,b,c){b=this.dl[b];a=this.dw(a);b.size<this.nj.size&&b.resize(this.nj.size,-1);b.write(a,c)};b.prototype.Tj=function(a,b){a=this.dw(a);b=this.dl[b];return a<b.size?b.read(a):-1};b.prototype.rz=function(){null==this.dl&&(this.dl=[]);for(var e=0;e<this.dl.length;e++)if(null==this.dl[e])return this.dl[e]=a.Uc.wh(0),e;this.dl.push(a.Uc.wh(0));return this.dl.length-1};b.prototype.cC=
function(a){this.dl[a]=null};b.prototype.YV=function(e,b,c){if(-1==c)throw a.g.F();if(b!=c){var g=this.Sb(c),d=this.ct(c),k=this.ng(c);-1==d?this.Ip(k,g):this.Kp(d,g);-1==g?this.Jp(k,d):this.Lp(g,d);this.lk(k,this.D(k)-this.La(c));this.wm(k,this.aa(k)-1);d=-1==b?this.Xv(e):this.ct(b);this.Lp(c,d);this.Kp(c,b);-1==b?this.Jp(e,c):this.Lp(b,c);-1==d?this.Ip(e,c):this.Kp(d,c);this.lk(e,this.D(e)+this.La(c));this.wm(e,this.aa(e)+1);this.Rx(c,e)}};b.prototype.Kj=function(a,b){this.xb.Ae(this.Za(b),this.an());
this.Wj(a,-1,this.an())};b.prototype.ud=function(e,b){var c=this.ld(e),g=this.Ra(e),d=this.U(e);-1!=g&&this.Kc(g,d);var k=this.La(c);e==this.cb(c)&&this.jg(c,1<k?d:-1);-1!=d&&this.Lc(d,g);e==this.Rj(c)&&this.sh(c,1<k?g:-1);if(-1!=g&&-1!=d){var g=this.Za(g),f=this.Za(d);b?(b=this.ti(g),null!=b&&(g=new a.b,this.xb.w(f,g),b.Zc(g))):(f=this.Za(e),b=this.ti(f),this.th(g,b),null!=b&&(g=this.xb.Ba(g),b.Mc(g)))}this.nk(c,k-1);c=this.ng(c);this.lk(c,this.D(c)-1);this.Ez(e);return d};b.prototype.cb=function(a){return this.sd.S(a,
4)};b.prototype.Rj=function(a){return this.sd.S(a,5)};b.prototype.U=function(a){return this.Dd.S(a,2)};b.prototype.Ra=function(a){return this.Dd.S(a,1)};b.prototype.ld=function(a){return this.Dd.S(a,3)};b.prototype.pc=function(a,b){return this.Wj(a,-1,b)};b.prototype.Qr=function(e){if(void 0===e)return this.Qr(!1);if(e instanceof c)return new c(e);var b,d=-1,k=-1,f=-1,p=0,h=!1;for(b=this.rd;-1!=b;b=this.Ue(b))if(!e||a.T.Ic(this.hc(b))){for(d=this.Pb(b);-1!=d;d=this.Sb(d))if(f=k=this.cb(d),p=0,-1!=
k){h=!0;break}if(h)break}return c.yR(this,b,d,k,f,p,e)};b.prototype.Xc=function(a){this.nm.Xc(a);if(null!=this.wf)for(var e=0,b=this.wf.length;e<b;e++)null!=this.wf[e]&&this.wf[e].Xc(a)};b.prototype.bs=function(a,b,c,d){d?this.HY(a,b,c):this.GY(a,b,c)};b.prototype.Lc=function(a,b){this.Dd.P(a,1,b)};b.prototype.Kc=function(a,b){this.Dd.P(a,2,b)};b.prototype.Aj=function(a,b){this.Dd.P(a,3,b)};b.prototype.nk=function(a,b){this.sd.P(a,3,b)};b.prototype.jg=function(a,b){this.sd.P(a,4,b)};b.prototype.sh=
function(a,b){this.sd.P(a,5,b)};b.prototype.wm=function(a,b){this.md.P(a,6,b)};b.prototype.lk=function(a,b){this.md.P(a,5,b)};b.prototype.fK=function(a){var e=a;do{var b=this.U(e);this.Kc(e,this.Ra(e));this.Lc(e,b);e=b}while(e!=a)};b.prototype.AC=function(a){this.vd=a};b.prototype.Sr=function(a){var e=this.ct(a),b=this.Sb(a),c=this.ng(a);-1!=e?this.Kp(e,b):this.Ip(c,b);-1!=b?this.Lp(b,e):this.Jp(c,e);this.jg(a,-1);this.sh(a,-1);this.DG(a)};b.prototype.Mi=function(e,b){var c=this.Ra(e),g=this.U(e);
-1!=c&&this.Kc(c,g);-1!=g&&this.Lc(g,c);if(-1!=c&&-1!=g)if(c=this.Za(c),g=this.Za(g),b){if(b=this.ti(c),null!=b){var d=new a.b;this.xb.w(g,d);b.Zc(d)}}else g=this.Za(e),b=this.ti(g),this.th(c,b),null!=b&&(d=new a.b,this.xb.w(c,d),b.Mc(d));this.Ez(e)};b.prototype.YU=function(a){return 0!=(this.Lq(a)&4)};b.prototype.Np=function(a,b){this.uC(a,(this.Lq(a)|4)-4|(b?4:0))};b.prototype.Xx=function(a,b){var e=this.Dd.f;this.xb.wc();var c=this.xb.ya[0].f;a.Gd(0,b,function(a,b){a=e[5*a];b=e[5*b];var g=c[2*
a];a=c[2*a+1];var d=c[2*b];b=c[2*b+1];return a<b?-1:a>b?1:g<d?-1:g>d?1:0})};b.prototype.eU=function(){for(var e=this.rd;-1!=e;e=this.Ue(e))if(!a.T.Ic(this.hc(e)))return!0;return!1};b.prototype.FC=function(a,b){for(var e=this.Pb(a),c=this.Pb(b),g=this.Xv(a),d=this.Xv(b),k=this.Pb(a);-1!=k;k=this.Sb(k))this.Rx(k,b);for(k=this.Pb(b);-1!=k;k=this.Sb(k))this.Rx(k,a);this.Ip(a,c);this.Ip(b,e);this.Jp(a,d);this.Jp(b,g);e=this.D(a);c=this.aa(a);g=this.aa(b);this.lk(a,this.D(b));this.lk(b,e);this.wm(a,g);
this.wm(b,c);e=this.md.S(a,2);this.md.P(a,2,this.md.S(b,2));this.md.P(b,2,e)};return b}();a.fd=b})(x||(x={}));(function(a){var b=function(b){function c(e,c,d,k){b.call(this);this.R=new a.h;void 0===e?this.aG():"number"===typeof e?this.ZQ(e,c,d,k):e instanceof a.Wa?void 0!==c?this.Ev(e,c,d):this.$Q(e):e instanceof a.ma?void 0!==c?this.bR(e,c):this.aR(e):e instanceof a.h?this.YQ(e):this.aG()}I(c,b);c.prototype.Ev=function(e,b,c){this.description=a.ze.Ig();this.R.Oa();e.u()||this.cv(e,b,c)};c.prototype.YQ=
function(e){this.description=a.ze.Ig();this.R.I(e);this.R.normalize()};c.prototype.aR=function(e){if(null==e)throw a.g.F();this.description=e;this.R.Oa()};c.prototype.bR=function(e,b){if(null==e)throw a.g.F();this.description=e;this.R.I(b);this.R.normalize()};c.prototype.aG=function(){this.description=a.ze.Ig();this.R.Oa()};c.prototype.$Q=function(e){this.description=a.ze.Ig();this.R.Oa();e.u()||this.cv(e)};c.prototype.ZQ=function(e,b,c,d){this.description=a.ze.Ig();this.I(e,b,c,d)};c.prototype.I=
function(a,b,c,d){this.Ac();if("number"===typeof a)this.R.I(a,b,c,d);else for(this.Oa(),b=0,c=a.length;b<c;b++)this.Nb(a[b])};c.prototype.Gp=function(e){this.Ac();if(!e.$U())throw a.g.F();this.R.I(e)};c.prototype.Oa=function(){this.Ac();this.R.Oa()};c.prototype.u=function(){return this.R.u()};c.prototype.N=function(){return this.R.N()};c.prototype.fa=function(){return this.R.fa()};c.prototype.Gk=function(){return this.R.Gk()};c.prototype.Cq=function(){return this.R.Cq()};c.prototype.Bq=function(){return this.R.Wf()};
c.prototype.Nb=function(e){if(e instanceof a.b)this.Ac(),this.R.Nb(e);else if(e instanceof a.h)this.Ac(),this.R.Nb(e);else if(e instanceof a.Wa){if(this.Ac(),!e.Hc()){var b=e.description;this.description!=b&&this.om(b);if(this.u())this.cv(e);else{this.R.Nb(e.w());for(var d=1,k=b.Ga;d<k;d++)for(var f=b.Sd(d),p=a.ma.Xa(f),h=0;h<p;h++){var l=e.Yc(f,h),m=this.xf(f,h);m.Nb(l);setInterval(f,h,m)}}}}else if(e instanceof c&&!e.u())for(b=e.description,b!=this.description&&this.om(b),this.R.Nb(e.R),d=1,k=b.Ga;d<
k;d++)for(f=b.qd(d),p=a.ma.Xa(f),h=0;h<p;h++)l=e.xf(f,h),m=this.xf(f,h),m.Nb(l),setInterval(f,h,m)};c.prototype.cv=function(e,b,c){if(void 0!==b){this.R.I(e.w(),b,c);b=e.description;c=1;for(var g=b.Ga;c<g;c++)for(var d=b.Sd(c),k=a.ma.Xa(d),n=0;n<k;n++){var f=e.Yc(d,n);this.setInterval(d,n,f,f)}}else for(this.R.I(e.la[0],e.la[1]),b=e.description,c=1,g=b.Ga;c<g;c++)for(d=b.Sd(c),k=a.ma.Xa(d),n=0;n<k;n++)f=e.Yc(d,n),this.setInterval(d,n,f,f)};c.prototype.setInterval=function(e,b,c,d){var g=null;"number"===
typeof c?g=new a.zc(c,d):g=c;this.Ac();if(0==e)if(0==b)this.R.o=g.ca,this.R.v=g.ha;else if(1==b)this.R.A=g.ca,this.R.B=g.ha;else throw a.g.wd();else this.ME(0,e,b,g.ca),this.ME(1,e,b,g.ha)};c.prototype.O=function(a,b){this.Ac();this.R.O(a,b)};c.prototype.Xc=function(e){if(e instanceof a.Hd)this.Ac(),e.LC(this.R);else if(this.Ac(),!this.R.u()){var b=new a.eM;this.Cp(b);b.RU()?b.Oa():e.LC(b)}};c.prototype.copyTo=function(e){if(e.G()!=this.G())throw a.g.F();e.Ac();e.description=this.description;e.R.I(this.R);
e.la=null;if(null!=this.la){e.Yu();for(var b=0;b<2*(this.description.af.length-2);b++)e.la[b]=this.la[b]}};c.prototype.Ka=function(){return new c(this.description)};c.prototype.hf=function(){return this.R.IG()};c.prototype.Rb=function(){return this.R.ZG()};c.prototype.G=function(){return 197};c.prototype.tb=function(){return 2};c.prototype.Qn=function(a){this.copyTo(a)};c.prototype.s=function(a){a.o=this.R.o;a.A=this.R.A;a.v=this.R.v;a.B=this.R.B};c.prototype.Cp=function(a){a.o=this.R.o;a.A=this.R.A;
a.v=this.R.v;a.B=this.R.B;a.I(this.R.o,this.R.A,this.ae(0,1,0),this.R.v,this.R.B,this.ae(1,1,0))};c.prototype.xf=function(e,b){var c=new a.zc;c.I(this.ae(0,e,b),this.ae(1,e,b));return c};c.prototype.ig=function(e,b){b.Fg(this.description);var c=this.description.Ga-1;switch(e){case 0:for(e=0;e<c;e++)for(var g=this.description.qd(e),d=a.ma.Xa(g),k=0;k<d;k++)b.setAttribute(g,k,this.ae(0,g,k));b.rb(this.R.o,this.R.A);break;case 1:for(e=0;e<c;e++)for(g=this.description.qd(e),d=a.ma.Xa(g),k=0;k<d;k++)b.setAttribute(g,
k,this.ae(1,g,k));b.rb(this.R.o,this.R.B);break;case 2:for(e=0;e<c;e++)for(g=this.description.qd(e),d=a.ma.Xa(g),k=0;k<d;k++)b.setAttribute(g,k,this.ae(0,g,k));b.rb(this.R.v,this.R.B);break;case 3:for(e=0;e<c;e++)for(g=this.description.qd(e),d=a.ma.Xa(g),k=0;k<d;k++)b.setAttribute(g,k,this.ae(1,g,k));b.rb(this.R.v,this.R.A);break;default:throw a.g.wd();}};c.prototype.Gx=function(a,b){a=this.R.Gx(a);b.ka(a.x,a.y)};c.prototype.cT=function(a,b){return b*(a.Er-2)};c.prototype.JG=function(e,b,c){if(this.R.u())throw a.g.X("empty geometry");
if(0==b)return 0!=e?0!=c?this.R.B:this.R.v:0!=c?this.R.A:this.R.o;if(c>=a.ma.Xa(b))throw a.g.F();var g=this.description.mg(b);this.Yu();return 0<=g?this.la[this.cT(this.description,e)+this.description.FT(g)-2+c]:a.ma.de(b)};c.prototype.Yu=function(){this.Ac();if(null==this.la&&2<this.description.af.length){this.la=[];for(var e=c.$(this.description,0),b=c.$(this.description,1),d=0,k=1,f=this.description.Ga;k<f;k++)for(var p=this.description.qd(k),h=a.ma.Xa(p),p=a.ma.de(p),l=0;l<h;l++)this.la[e+d]=
p,this.la[b+d]=p,d++}};c.prototype.mo=function(e){if(null!=this.la)if(2<e.af.length){for(var b=a.ze.vx(e,this.description),d=[],k=c.$(this.description,0),f=c.$(this.description,1),p=c.$(e,0),h=c.$(e,1),l=0,m=1,A=e.Ga;m<A;m++){var q=e.qd(m),r=a.ma.Xa(q);if(-1==b[m])for(var t=a.ma.de(q),q=0;q<r;q++)d[p+l]=t,d[h+l]=t,l++;else for(t=this.description.wk(b[m])-2,q=0;q<r;q++)d[p+l]=this.la[k+t],d[h+l]=this.la[f+t],l++,t++}this.la=d}else this.la=null;this.description=e};c.prototype.ae=function(e,b,d){if(this.R.u())throw a.g.X("This operation was performed on an Empty Geometry.");
if(0==b)return 0!=e?0!=d?this.R.B:this.R.v:0!=d?this.R.A:this.R.o;if(d>=a.ma.Xa(b))throw a.g.wd();var g=this.description.mg(b);return 0<=g?(this.Yu(),this.la[c.$(this.description,e)+this.description.wk(g)-2+d]):a.ma.de(b)};c.prototype.ME=function(e,b,d,k){this.Ac();if(0==b)0!=e?0!=d?this.R.B=k:this.R.v=k:0!=d?this.R.A=k:this.R.o=k;else{if(d>=a.ma.Xa(b))throw a.g.wd();if(!this.hasAttribute(b)){if(a.ma.PH(b,k))return;this.Td(b)}b=this.description.mg(b);this.Yu();this.la[c.$(this.description,e)+this.description.wk(b)-
2+d]=k}};c.$=function(a,b){return b*(a.af.length-2)};c.prototype.Ma=function(e){this.Ac();var b=new a.h;e.s(b);return this.R.Ma(b)};c.prototype.Yb=function(e){return e instanceof a.h?this.R.Yb(e):this.R.Yb(e.R)};c.prototype.xv=function(a,b,c){this.Ac();a.u()?this.Oa():void 0!==b?this.cv(a,b,c):this.R.xv(a.Be(),a.nf())};c.prototype.offset=function(a,b){this.Ac();this.R.offset(a,b)};c.prototype.normalize=function(){this.Ac();this.R.normalize()};c.prototype.Wf=function(e){if(void 0!==e)if(e.Fg(this.description),
this.u())e.Oa();else{for(var b=this.description.Ga,c=1;c<b;c++)for(var d=this.description.qd(c),k=a.ma.Xa(d),f=0;f<k;f++){var p=.5*(this.JG(0,d,f)+this.JG(1,d,f));e.setAttribute(d,f,p)}e.rb(this.R.Wf())}else{e=new a.Wa(this.description);if(this.u())return e;b=this.description.Ga;for(c=1;c<b;c++)for(d=this.description.Sd(c),k=a.ma.Xa(d),f=0;f<k;f++)p=.5*(this.ae(0,d,f)+this.ae(1,d,f)),e.setAttribute(d,f,p);e.rb(this.R.Gk(),this.R.Cq());return e}};c.prototype.Zz=function(){return new a.Wa(this.R.Zz())};
c.prototype.contains=function(e){return e instanceof a.Wa?e.u()?!1:this.R.contains(e.Be(),e.nf()):this.R.contains(e.R)};c.prototype.hR=function(a){return this.R.contains(a)};c.prototype.Eb=function(a){if(a==this)return!0;if(!(a instanceof c)||this.description!=a.description)return!1;if(this.u())return a.u()?!0:!1;if(!this.R.Eb(a.R))return!1;for(var e=0,b=2*(this.description.af.length-2);e<b;e++)if(this.la[e]!=a.la[e])return!1;return!0};c.prototype.jc=function(){var e=this.description.jc(),e=a.J.dh(e,
this.R.jc());if(!this.u()&&null!=this.la)for(var b=0,c=2*(this.description.af.length-2);b<c;b++)e=a.J.dh(e,this.la[b]);return e};c.prototype.Gg=function(){return a.Pi.Rm(this,null)};c.prototype.toString=function(){return this.u()?"Envelope: []":"Envelope: ["+this.R.o+", "+this.R.A+", "+this.R.v+", "+this.R.B+"]"};return c}(a.T);a.ci=b})(x||(x={}));(function(a){var b=function(){function b(a,e,b,c){void 0===a?this.Oa():(this.o=a,this.A=e,this.v=b,this.B=c)}b.pa=function(a,e,c,d){var g=new b;g.o=a;g.A=
e;g.v=c;g.B=d;return g};b.prototype.I=function(c,e,g,d){"number"===typeof c?void 0!==g?(this.o=c,this.A=e,this.v=g,this.B=d,this.normalize()):(this.o=c,this.A=e,this.v=c,this.B=e):c instanceof a.b?void 0!==e?(this.o=c.x-.5*e,this.v=this.o+e,this.A=c.y-.5*g,this.B=this.A+g,this.normalize()):(this.o=c.x,this.A=c.y,this.v=c.x,this.B=c.y):c instanceof b?this.I(c.o,c.A,c.v,c.B):c instanceof a.zc&&(c.u()||e.u()?this.Oa():(this.o=c.ca,this.v=c.ha,this.A=e.ca,this.B=e.ha))};b.prototype.oT=function(a,e){var c=
new b;c.I(this.o,this.A,this.v,this.B);c.O(a,e);return c};b.prototype.Mx=function(a,e){if(void 0!==e)if(0==e)this.Oa();else{this.o=a[0].x;this.A=a[0].y;this.v=this.o;this.B=this.A;for(var b=1;b<e;b++){var c=a[b];c.x<this.o?this.o=c.x:c.x>this.v&&(this.v=c.x);c.y<this.A?this.A=c.y:c.y>this.B&&(this.B=c.y)}}else if(null==a||0==a.length)this.Oa();else for(c=a[0],this.I(c.x,c.y),b=1;b<a.length;b++)c=a[b],this.ll(c.x,c.y)};b.prototype.Oa=function(){this.B=this.v=this.A=this.o=NaN};b.prototype.u=function(){return isNaN(this.o)};
b.prototype.Nb=function(c,e){"number"===typeof c?this.u()?(this.o=c,this.A=e,this.v=c,this.B=e):(this.o>c?this.o=c:this.v<c&&(this.v=c),this.A>e?this.A=e:this.B<e&&(this.B=e)):c instanceof a.b?this.Nb(c.x,c.y):c instanceof a.pd?this.Nb(c.x,c.y):c instanceof b&&!c.u()&&(this.Nb(c.o,c.A),this.Nb(c.v,c.B))};b.prototype.ll=function(a,e){this.o>a?this.o=a:this.v<a&&(this.v=a);this.A>e?this.A=e:this.B<e&&(this.B=e)};b.prototype.O=function(a,e){this.u()||(this.o-=a,this.v+=a,this.A-=e,this.B+=e,(this.o>
this.v||this.A>this.B)&&this.Oa())};b.prototype.scale=function(a){0>a&&this.Oa();this.u()||(this.o*=a,this.v*=a,this.A*=a,this.B*=a)};b.prototype.Yb=function(a){return!this.u()&&!a.u()&&(this.o<=a.o?this.v>=a.o:a.v>=this.o)&&(this.A<=a.A?this.B>=a.A:a.B>=this.A)};b.prototype.TH=function(a){return(this.o<=a.o?this.v>=a.o:a.v>=this.o)&&(this.A<=a.A?this.B>=a.A:a.B>=this.A)};b.prototype.Ma=function(a){if(this.u()||a.u())return!1;a.o>this.o&&(this.o=a.o);a.v<this.v&&(this.v=a.v);a.A>this.A&&(this.A=a.A);
a.B<this.B&&(this.B=a.B);(a=this.o<=this.v&&this.A<=this.B)||this.Oa();return a};b.prototype.Gx=function(b){switch(b){case 0:return a.b.pa(this.o,this.A);case 1:return a.b.pa(this.o,this.B);case 2:return a.b.pa(this.v,this.B);case 3:return a.b.pa(this.v,this.A);default:throw a.g.wd();}};b.prototype.QB=function(b){if(null==b||4>b.length)throw a.g.F();null!=b[0]?b[0].ka(this.o,this.A):b[0]=a.b.pa(this.o,this.A);null!=b[1]?b[1].ka(this.o,this.B):b[1]=a.b.pa(this.o,this.B);null!=b[2]?b[2].ka(this.v,this.B):
b[2]=a.b.pa(this.v,this.B);null!=b[3]?b[3].ka(this.v,this.A):b[3]=a.b.pa(this.v,this.A)};b.prototype.IG=function(){return this.u()?0:this.N()*this.fa()};b.prototype.ZG=function(){return this.u()?0:2*(this.N()+this.fa())};b.prototype.Gk=function(){return(this.v+this.o)/2};b.prototype.Cq=function(){return(this.B+this.A)/2};b.prototype.N=function(){return this.v-this.o};b.prototype.fa=function(){return this.B-this.A};b.prototype.move=function(a,e){this.u()||(this.o+=a,this.A+=e,this.v+=a,this.B+=e)};
b.prototype.xv=function(b,e){if(void 0!==e)this.move(b-this.Gk(),e-this.Cq());else if(b instanceof a.b)this.xv(b.x,b.y);else if(b instanceof a.Wa){e=(this.v-this.o)/2;var c=(this.B-this.A)/2;this.o=b.Be()-e;this.v=b.Be()+e;this.A=b.nf()-c;this.B=b.nf()+c}else throw a.g.F();};b.prototype.offset=function(a,e){this.o+=a;this.v+=a;this.A+=e;this.B+=e};b.prototype.normalize=function(){if(!this.u()){var a=Math.min(this.o,this.v),e=Math.max(this.o,this.v);this.o=a;this.v=e;a=Math.min(this.A,this.B);e=Math.max(this.A,
this.B);this.A=a;this.B=e}};b.prototype.Tn=function(a){a.ka(this.o,this.A)};b.prototype.TJ=function(a){a.ka(this.v,this.A)};b.prototype.WJ=function(a){a.ka(this.o,this.B)};b.prototype.Un=function(a){a.ka(this.v,this.B)};b.prototype.$U=function(){return this.u()||this.o<=this.v&&this.A<=this.B};b.prototype.Wf=function(){return a.b.pa((this.v+this.o)/2,(this.B+this.A)/2)};b.prototype.Zz=function(){return a.b.pa(this.o,this.A)};b.prototype.contains=function(c,e){if(void 0!==e)return c>=this.o&&c<=this.v&&
e>=this.A&&e<=this.B;if(c instanceof a.Wa)return this.contains(c.Be(),c.nf());if(c instanceof a.b)return this.contains(c.x,c.y);if(c instanceof b)return c.o>=this.o&&c.v<=this.v&&c.A>=this.A&&c.B<=this.B;throw a.g.F();};b.prototype.Tm=function(c,e){if(void 0!==e)return c>this.o&&c<this.v&&e>this.A&&e<this.B;if(c instanceof a.b)return this.Tm(c.x,c.y);if(c instanceof b)return c.o>this.o&&c.v<this.v&&c.A>this.A&&c.B<this.B;throw a.g.F();};b.prototype.Eb=function(a){return a==this?!0:a instanceof b?
this.u()&&a.u()?!0:this.o!=a.o||this.A!=a.A||this.v!=a.v||this.B!=a.B?!1:!0:!1};b.prototype.jc=function(){var b=this.o,b=a.J.truncate(b^b>>>32),e=a.J.dh(b),b=this.v,b=a.J.truncate(b^b>>>32),e=a.J.dh(b,e),b=this.A,b=a.J.truncate(b^b>>>32),e=a.J.dh(b,e),b=this.B,b=a.J.truncate(b^b>>>32);return e=a.J.dh(b,e)};b.prototype.Ny=function(b){var e=new a.b;e.L(b);if(e.Hy())return e;if(this.u())return e.dv(),e;e.x<this.o?e.x=this.o:e.x>this.v&&(e.x=this.v);e.y<this.A?e.y=this.A:e.y>this.B&&(e.y=this.B);if(!e.Eb(b))return e;
b=this.Wf();(e.x<b.x?e.x-this.o:this.v-e.x)<(e.y<b.y?e.y-this.A:this.B-e.y)?e.x=e.x<b.x?this.o:this.v:e.y=e.y<b.y?this.A:this.B;return e};b.prototype.Wu=function(a){if(this.u())return NaN;if(a.x==this.o)return a.y-this.A;var e=this.B-this.A,b=this.v-this.o;return a.y==this.B?e+a.x-this.o:a.x==this.v?e+b+this.B-a.y:a.y==this.A?2*e+b+this.v-a.x:this.Wu(this.Ny(a))};b.prototype.AE=function(a){if(this.u())return-1;a=this.Wu(a);var e=this.B-this.A,b=this.v-this.o;return a<e?0:(a-=e)<b?1:a-b<e?2:3};b.prototype.no=
function(){return this.u()?2.220446049250313E-14:2.220446049250313E-14*(Math.abs(this.o)+Math.abs(this.v)+Math.abs(this.A)+Math.abs(this.B)+1)};b.prototype.gz=function(a,e){var c=this.vk(a),d=this.vk(e);if(0!=(c&d))return 0;if(0==(c|d))return 4;var k=(0!=c?1:0)|(0!=d?2:0);do{var f=e.x-a.x,p=e.y-a.y;f>p?0!=(c&b.bd)?(0!=(c&b.Bb)?(a.y+=p*(this.o-a.x)/f,a.x=this.o):(a.y+=p*(this.v-a.x)/f,a.x=this.v),c=this.vk(a)):0!=(d&b.bd)?(0!=(d&b.Bb)?(e.y+=p*(this.o-e.x)/f,e.x=this.o):(e.y+=p*(this.v-e.x)/f,e.x=this.v),
d=this.vk(e)):0!=c?(0!=(c&b.tc)?(a.x+=f*(this.A-a.y)/p,a.y=this.A):(a.x+=f*(this.B-a.y)/p,a.y=this.B),c=this.vk(a)):(0!=(d&b.tc)?(e.x+=f*(this.A-e.y)/p,e.y=this.A):(e.x+=f*(this.B-e.y)/p,e.y=this.B),d=this.vk(e)):0!=(c&b.fe)?(0!=(c&b.tc)?(a.x+=f*(this.A-a.y)/p,a.y=this.A):(a.x+=f*(this.B-a.y)/p,a.y=this.B),c=this.vk(a)):0!=(d&b.fe)?(0!=(d&b.tc)?(e.x+=f*(this.A-e.y)/p,e.y=this.A):(e.x+=f*(this.B-e.y)/p,e.y=this.B),d=this.vk(e)):0!=c?(0!=(c&b.Bb)?(a.y+=p*(this.o-a.x)/f,a.x=this.o):(a.y+=p*(this.v-a.x)/
f,a.x=this.v),c=this.vk(a)):(0!=(d&b.Bb)?(e.y+=p*(this.o-e.x)/f,e.x=this.o):(e.y+=p*(this.v-e.x)/f,e.x=this.v),d=this.vk(e));if(0!=(c&d))return 0}while(0!=(c|d));return k};b.prototype.vk=function(a){return(a.x<this.o?1:0)|(a.x>this.v?1:0)<<1|(a.y<this.A?1:0)<<2|(a.y>this.B?1:0)<<3};b.prototype.fh=function(a){return!this.u()&&(this.N()<=a||this.fa()<=a)};b.prototype.Cb=function(b){return b instanceof a.b?Math.sqrt(this.ZK(b)):Math.sqrt(this.Zx(b))};b.prototype.Zx=function(a){var e=0,b=0,c;c=this.o-
a.v;c>e&&(e=c);c=this.A-a.B;c>b&&(b=c);c=a.o-this.v;c>e&&(e=c);c=a.A-this.B;c>b&&(b=c);return e*e+b*b};b.prototype.ZK=function(a){var e=0,b=0,c;c=this.o-a.x;c>e&&(e=c);c=this.A-a.y;c>b&&(b=c);c=a.x-this.v;c>e&&(e=c);c=a.y-this.B;c>b&&(b=c);return e*e+b*b};b.prototype.Sn=function(a){this.u()?a.Oa():a.I(this.o,this.v)};b.DO=function(a,e,b,c){var g=1;isNaN(a)||(g+=Math.abs(a));isNaN(e)||(g+=Math.abs(e));isNaN(b)||(g+=Math.abs(b));isNaN(c)||(g+=Math.abs(c));return 2.220446049250313E-14*g};b.Bb=1;b.tc=
4;b.bd=3;b.fe=12;return b}();a.h=b})(x||(x={}));(function(a){var b;(function(a){a[a.initialize=0]="initialize";a[a.initializeRed=1]="initializeRed";a[a.initializeBlue=2]="initializeBlue";a[a.initializeRedBlue=3]="initializeRedBlue";a[a.sweep=4]="sweep";a[a.sweepBruteForce=5]="sweepBruteForce";a[a.sweepRedBlueBruteForce=6]="sweepRedBlueBruteForce";a[a.sweepRedBlue=7]="sweepRedBlue";a[a.sweepRed=8]="sweepRed";a[a.sweepBlue=9]="sweepBlue";a[a.iterate=10]="iterate";a[a.iterateRed=11]="iterateRed";a[a.iterateBlue=
12]="iterateBlue";a[a.iterateBruteForce=13]="iterateBruteForce";a[a.iterateRedBlueBruteForce=14]="iterateRedBlueBruteForce";a[a.resetRed=15]="resetRed";a[a.resetBlue=16]="resetBlue"})(b||(b={}));var c=function(){function a(a,b){this.Ci=a;this.pI=b}a.prototype.hs=function(a,b,c){this.Ci.EY(c,a,b,this.pI)};a.prototype.Qq=function(a){return this.Ci.Ms(a,this.pI)};return a}();b=function(){function b(){this.ax=this.bp=this.If=this.Bd=null;this.lr=new a.h;this.on=this.ck=this.dk=this.Pd=this.fg=this.Yd=
this.Qw=this.Uo=this.Ad=this.Lb=null;this.Zb=-1;this.ta=0;this.pl()}b.prototype.cs=function(){this.pl();this.Bw=!0;null==this.Lb?(this.Uo=new a.ia(0),this.Lb=[]):(this.Uo.yf(0),this.Lb.length=0)};b.prototype.jd=function(b,c){if(!this.Bw)throw a.g.Da();var e=new a.h;e.I(c);this.Uo.add(b);this.Lb.push(e)};b.prototype.yq=function(){if(!this.Bw)throw a.g.Da();this.Bw=!1;null!=this.Lb&&0<this.Lb.length&&(this.Zb=0,this.Pc=!1)};b.prototype.bL=function(){this.pl();this.Aw=!0;null==this.Lb?(this.Uo=new a.ia(0),
this.Lb=[]):(this.Uo.yf(0),this.Lb.length=0)};b.prototype.$E=function(b,c){if(!this.Aw)throw a.g.Da();var e=new a.h;e.I(c);this.Uo.add(b);this.Lb.push(e)};b.prototype.uG=function(){if(!this.Aw)throw a.g.Da();this.Aw=!1;null!=this.Lb&&0<this.Lb.length&&null!=this.Ad&&0<this.Ad.length&&(-1==this.Zb?this.Zb=3:2==this.Zb?this.Zb=3:3!=this.Zb&&(this.Zb=1),this.Pc=!1)};b.prototype.aL=function(){this.pl();this.zw=!0;null==this.Ad?(this.Qw=new a.ia(0),this.Ad=[]):(this.Qw.yf(0),this.Ad.length=0)};b.prototype.WE=
function(b,c){if(!this.zw)throw a.g.Da();var e=new a.h;e.I(c);this.Qw.add(b);this.Ad.push(e)};b.prototype.tG=function(){if(!this.zw)throw a.g.Da();this.zw=!1;null!=this.Lb&&0<this.Lb.length&&null!=this.Ad&&0<this.Ad.length&&(-1==this.Zb?this.Zb=3:1==this.Zb?this.Zb=3:3!=this.Zb&&(this.Zb=2),this.Pc=!1)};b.prototype.next=function(){if(this.Pc)return!1;for(var b=!0;b;)switch(this.Zb){case 0:b=this.rA();break;case 1:b=this.nU();break;case 2:b=this.kU();break;case 3:b=this.mU();break;case 4:b=this.OY();
break;case 5:b=this.KY();break;case 6:b=this.LY();break;case 7:b=this.MY();break;case 8:b=this.by();break;case 9:b=this.GC();break;case 10:b=this.DA();break;case 11:b=this.dV();break;case 12:b=this.aV();break;case 13:b=this.bV();break;case 14:b=this.cV();break;case 15:b=this.$J();break;case 16:b=this.ZJ();break;default:throw a.g.za();}return this.Pc?!1:!0};b.prototype.zC=function(a){this.ta=a};b.prototype.fA=function(a){return this.Lb[a]};b.prototype.Jz=function(a){return this.Ad[a]};b.prototype.Ql=
function(a){return this.Uo.read(a)};b.prototype.Ml=function(a){return this.Qw.read(a)};b.KB=function(a){return 1==(a&1)};b.Gm=function(a){return 0==(a&1)};b.prototype.pl=function(){this.Bw=this.zw=this.Aw=!1;this.dg=this.eg=this.nh=this.Ne=-1;this.Pc=!0};b.prototype.rA=function(){this.bg=this.sg=-1;if(10>this.Lb.length)return this.Ne=this.Lb.length,this.Zb=5,!0;null==this.Bd&&(this.Bd=new a.ns(!0),this.bp=this.Bd.mf(),this.Yd=new a.ia(0));this.Bd.cs();for(var b=0;b<this.Lb.length;b++){var c=this.Lb[b];
this.Bd.zs(c.o,c.v)}this.Bd.yq();this.Yd.yb(2*this.Lb.length);this.Yd.resize(0);for(b=0;b<2*this.Lb.length;b++)this.Yd.add(b);this.yu(this.Yd,2*this.Lb.length,!0);this.Ne=2*this.Lb.length;this.Zb=4;return!0};b.prototype.nU=function(){this.bg=this.sg=-1;if(10>this.Lb.length||10>this.Ad.length)return this.Ne=this.Lb.length,this.Zb=6,!0;null==this.Bd&&(this.Bd=new a.ns(!0),this.bp=this.Bd.mf(),this.Yd=new a.ia(0));this.Bd.cs();for(var b=0;b<this.Lb.length;b++){var c=this.Lb[b];this.Bd.zs(c.o,c.v)}this.Bd.yq();
this.Yd.yb(2*this.Lb.length);this.Yd.resize(0);for(b=0;b<2*this.Lb.length;b++)this.Yd.add(b);this.yu(this.Yd,this.Yd.size,!0);this.Ne=this.Yd.size;-1!=this.eg&&(this.Pd.zh(this.eg),this.dk.resize(0),this.eg=-1);this.Zb=7;return this.ZJ()};b.prototype.kU=function(){this.bg=this.sg=-1;if(10>this.Lb.length||10>this.Ad.length)return this.Ne=this.Lb.length,this.Zb=6,!0;null==this.If&&(this.If=new a.ns(!0),this.ax=this.If.mf(),this.fg=new a.ia(0));this.If.cs();for(var b=0;b<this.Ad.length;b++){var c=this.Ad[b];
this.If.zs(c.o,c.v)}this.If.yq();this.fg.yb(2*this.Ad.length);this.fg.resize(0);for(b=0;b<2*this.Ad.length;b++)this.fg.add(b);this.yu(this.fg,this.fg.size,!1);this.nh=this.fg.size;-1!=this.dg&&(this.Pd.zh(this.dg),this.ck.resize(0),this.dg=-1);this.Zb=7;return this.$J()};b.prototype.mU=function(){this.bg=this.sg=-1;if(10>this.Lb.length||10>this.Ad.length)return this.Ne=this.Lb.length,this.Zb=6,!0;null==this.Bd&&(this.Bd=new a.ns(!0),this.bp=this.Bd.mf(),this.Yd=new a.ia(0));null==this.If&&(this.If=
new a.ns(!0),this.ax=this.If.mf(),this.fg=new a.ia(0));this.Bd.cs();for(var b=0;b<this.Lb.length;b++){var c=this.Lb[b];this.Bd.zs(c.o,c.v)}this.Bd.yq();this.If.cs();for(b=0;b<this.Ad.length;b++)c=this.Ad[b],this.If.zs(c.o,c.v);this.If.yq();this.Yd.yb(2*this.Lb.length);this.fg.yb(2*this.Ad.length);this.Yd.resize(0);this.fg.resize(0);for(b=0;b<2*this.Lb.length;b++)this.Yd.add(b);for(b=0;b<2*this.Ad.length;b++)this.fg.add(b);this.yu(this.Yd,this.Yd.size,!0);this.yu(this.fg,this.fg.size,!1);this.Ne=this.Yd.size;
this.nh=this.fg.size;-1!=this.eg&&(this.Pd.zh(this.eg),this.dk.resize(0),this.eg=-1);-1!=this.dg&&(this.Pd.zh(this.dg),this.ck.resize(0),this.dg=-1);this.Zb=7;return!0};b.prototype.OY=function(){var a=this.Yd.get(--this.Ne),c=a>>1;if(b.Gm(a))return this.Bd.remove(c),0==this.Ne?(this.bg=this.sg=-1,this.Pc=!0,!1):!0;this.bp.eC(this.Lb[c].o,this.Lb[c].v,this.ta);this.sg=c;this.Zb=10;return!0};b.prototype.KY=function(){if(-1==--this.Ne)return this.bg=this.sg=-1,this.Pc=!0,!1;this.nh=this.sg=this.Ne;this.Zb=
13;return!0};b.prototype.LY=function(){if(-1==--this.Ne)return this.bg=this.sg=-1,this.Pc=!0,!1;this.sg=this.Ne;this.nh=this.Ad.length;this.Zb=14;return!0};b.prototype.MY=function(){var a=this.Yd.get(this.Ne-1),c=this.fg.get(this.nh-1),d=this.Ms(a,!0),k=this.Ms(c,!1);return d>k?this.by():d<k?this.GC():b.KB(a)?this.by():b.KB(c)?this.GC():this.by()};b.prototype.by=function(){var e=this.Yd.get(--this.Ne),c=e>>1;if(b.Gm(e))return-1!=this.eg&&-1!=this.dk.get(c)?(this.Pd.kd(this.eg,this.dk.get(c)),this.dk.set(c,
-1)):this.Bd.remove(c),0==this.Ne?(this.bg=this.sg=-1,this.Pc=!0,!1):!0;if(-1!=this.dg&&0<this.Pd.at(this.dg))for(e=this.Pd.xc(this.dg);-1!=e;){var d=this.Pd.getData(e);this.If.eh(d);this.ck.set(d,-1);d=this.Pd.nb(e);this.Pd.kd(this.dg,e);e=d}0<this.If.size()?(this.ax.eC(this.Lb[c].o,this.Lb[c].v,this.ta),this.sg=c,this.Zb=12):(-1==this.eg&&(null==this.Pd&&(this.Pd=new a.Xp),this.dk=new a.ia(0),this.dk.resize(this.Lb.length,-1),this.dk.Zh(-1,0,this.Lb.length),this.eg=this.Pd.mi(1)),this.dk.set(c,
this.Pd.addElement(this.eg,c)),this.Zb=7);return!0};b.prototype.GC=function(){var e=this.fg.get(--this.nh),c=e>>1;if(b.Gm(e))return-1!=this.dg&&-1!=this.ck.get(c)?(this.Pd.kd(this.dg,this.ck.get(c)),this.ck.set(c,-1)):this.If.remove(c),0==this.nh?(this.bg=this.sg=-1,this.Pc=!0,!1):!0;if(-1!=this.eg&&0<this.Pd.at(this.eg))for(e=this.Pd.xc(this.eg);-1!=e;){var d=this.Pd.getData(e);this.Bd.eh(d);this.dk.set(d,-1);d=this.Pd.nb(e);this.Pd.kd(this.eg,e);e=d}0<this.Bd.size()?(this.bp.eC(this.Ad[c].o,this.Ad[c].v,
this.ta),this.bg=c,this.Zb=11):(-1==this.dg&&(null==this.Pd&&(this.Pd=new a.Xp),this.ck=new a.ia(0),this.ck.resize(this.Ad.length,-1),this.ck.Zh(-1,0,this.Ad.length),this.dg=this.Pd.mi(0)),this.ck.set(c,this.Pd.addElement(this.dg,c)),this.Zb=7);return!0};b.prototype.DA=function(){this.bg=this.bp.next();if(-1!=this.bg)return!1;var a=this.Yd.get(this.Ne)>>1;this.Bd.eh(a);this.Zb=4;return!0};b.prototype.dV=function(){this.sg=this.bp.next();if(-1!=this.sg)return!1;this.bg=this.sg=-1;var a=this.fg.get(this.nh)>>
1;this.If.eh(a);this.Zb=7;return!0};b.prototype.aV=function(){this.bg=this.ax.next();if(-1!=this.bg)return!1;var a=this.Yd.get(this.Ne)>>1;this.Bd.eh(a);this.Zb=7;return!0};b.prototype.bV=function(){if(-1==--this.nh)return this.Zb=5,!0;this.lr.I(this.Lb[this.Ne]);var a=this.Lb[this.nh];this.lr.O(this.ta,this.ta);return this.lr.Yb(a)?(this.bg=this.nh,!1):!0};b.prototype.cV=function(){if(-1==--this.nh)return this.Zb=6,!0;this.lr.I(this.Lb[this.Ne]);var a=this.Ad[this.nh];this.lr.O(this.ta,this.ta);
return this.lr.Yb(a)?(this.bg=this.nh,!1):!0};b.prototype.$J=function(){if(null==this.Bd)return this.Pc=!0,!1;this.Ne=this.Yd.size;0<this.Bd.size()&&this.Bd.reset();-1!=this.eg&&(this.Pd.zh(this.eg),this.dk.resize(0),this.eg=-1);this.Pc=!1;return!0};b.prototype.ZJ=function(){if(null==this.If)return this.Pc=!0,!1;this.nh=this.fg.size;0<this.If.size()&&this.If.reset();-1!=this.dg&&(this.Pd.zh(this.dg),this.ck.resize(0),this.dg=-1);this.Pc=!1;return!0};b.prototype.yu=function(b,g,d){null==this.on&&(this.on=
new a.Hu);d=new c(this,d);this.on.sort(b,0,g,d)};b.prototype.EY=function(a,c,d,k){var e=this;a.Gd(c,d,function(a,c){var g=e.Ms(a,k),d=e.Ms(c,k);return g<d||g==d&&b.Gm(a)&&b.KB(c)?-1:1})};b.prototype.Ms=function(a,c){var e=.5*this.ta;if(c)return c=this.Lb[a>>1],e=b.Gm(a)?c.A-e:c.B+e;c=this.Ad[a>>1];return e=b.Gm(a)?c.A-e:c.B+e};return b}();a.gD=b})(x||(x={}));(function(a){var b=function(){function b(){}b.pa=function(a,e,c,d,f,p){var g=new b;g.o=a;g.A=e;g.Bf=c;g.v=d;g.B=f;g.$g=p;return g};b.prototype.Oa=
function(){this.Bf=this.o=NaN};b.prototype.u=function(){return isNaN(this.o)};b.prototype.RU=function(){return isNaN(this.Bf)};b.prototype.I=function(a,b,c,d,f,p){void 0!==d?"number"===typeof a?(this.o=a,this.A=b,this.Bf=c,this.v=d,this.B=f,this.$g=p):(this.o=a.x-.5*b,this.v=this.o+b,this.A=a.y-.5*c,this.B=this.A+c,this.Bf=a.z-.5*d,this.$g=this.Bf+d):(this.o=a,this.A=b,this.Bf=c,this.v=a,this.B=b,this.$g=c)};b.prototype.move=function(a){this.o+=a.x;this.A+=a.y;this.Bf+=a.z;this.v+=a.x;this.B+=a.y;
this.$g+=a.z};b.prototype.copyTo=function(a){a.o=this.o;a.A=this.A;a.v=this.v;a.B=this.B};b.prototype.ll=function(a,b,c){this.o>a?this.o=a:this.v<a&&(this.v=a);this.A>b?this.A=b:this.B<b&&(this.B=b);0==isNaN(this.Bf)?this.Bf>c?this.Bf=c:this.$g<c&&(this.$g=c):this.$g=this.Bf=c};b.prototype.Nb=function(c,e,g,d,f,p){if("number"===typeof c)d?(this.Nb(c,e,g),this.Nb(d,f,p)):this.u()?(this.o=c,this.A=e,this.Bf=g,this.v=c,this.B=e,this.$g=g):this.ll(c,e,g);else if(c instanceof a.pd)this.Nb(c.x,c.y,c.z);
else if(c instanceof b)c.u()||(this.Nb(c.o,c.A,c.Bf),this.Nb(c.v,c.B,c.$g));else throw a.g.F();};b.prototype.pa=function(a,b,c){a.u()||b.u()?this.Oa():(this.o=a.ca,this.v=a.ha,this.A=b.ca,this.B=b.ha,this.Bf=c.ca,this.$g=c.ha)};b.prototype.QB=function(b){if(null==b||8>b.length)throw a.g.F();b[0]=new a.pd(this.o,this.A,this.Bf);b[1]=new a.pd(this.o,this.B,this.Bf);b[2]=new a.pd(this.v,this.B,this.Bf);b[3]=new a.pd(this.v,this.A,this.Bf);b[4]=new a.pd(this.o,this.A,this.$g);b[5]=new a.pd(this.o,this.B,
this.$g);b[6]=new a.pd(this.v,this.B,this.$g);b[7]=new a.pd(this.v,this.A,this.$g)};b.prototype.Mx=function(a){if(null==a||0==a.length)this.Oa();else{var b=a[0];this.I(b.x,b.y,b.z);for(b=1;b<a.length;b++){var c=a[b];this.ll(c.x,c.y,c.z)}}};return b}();a.eM=b})(x||(x={}));(function(a){(function(a){a.za=function(){var a=Error();a.message="Internal Error";return a};a.df=function(){var a=Error();a.message="Not Implemented";return a};a.yl=function(){var a=Error();a.message="The input unit and the spatial reference unit are not of the same unit type.ie Linear vs.Angular";
return a};a.Da=function(){var a=Error();a.message="Invalid Call";return a};a.F=function(a){var b=Error();b.message="Illegal Argument Exception";void 0!==a&&(b.message+=": "+a);return b};a.UN=function(){var a=Error();a.message="Runtime Exception.";return a};a.X=function(a){var b=Error();b.message="Geometry Exception: "+a;return b};a.KL=function(){var a=Error();a.message="Assert Failed Exception";return a};a.wd=function(){var a=Error();a.message="IndexOutOfBoundsException";return a};a.n_=function(a){a.message=
"UserCancelException";return a}})(a.g||(a.g={}))})(x||(x={}));(function(a){a=a.Om||(a.Om={});a[a.forward=0]="forward";a[a.reverse=1]="reverse"})(x||(x={}));(function(a){var b=function(){function b(a,b){this.$a=a;this.VI=b;this.ZI=-1;this.Wl=!1}b.prototype.Re=function(){return!0};b.prototype.next=function(){if(++this.ZI==this.VI.D())return null;var b=this.VI.Ba(this.ZI);b.scale(this.$a.oc);var e=new a.Ja;this.$a.Yy(b,this.Wl,e);return e};b.prototype.Ia=function(){return 0};return b}(),c=function(){function b(b,
e,c){this.$a=b;this.ex=e;this.Mo=!1;this.So=c;this.Pw=[0];this.Tk=[0];this.gk=[0];this.Ct=[0];this.Wl=!1;this.fr=new a.Ja;this.Vk=[]}b.prototype.Re=function(){return!0};b.prototype.next=function(){if(this.Mo){this.Mo=!1;this.Cd.ba();var b=a.T.oe(this.fr);return b=a.Dg.nl(b,this.$a.pr,!0,!0,this.$a.mc)}null==this.Cd&&(this.Cd=this.ex.Fa(),this.Cd.Ya(),null!=this.So&&this.So.Bl(null,0));if(!this.Cd.Ea()){if(!this.Cd.Ya())return null;null!=this.So&&this.So.Bl(null,0)}b=null;this.Tk[0]=0;this.mB=this.Pw[0]=
0;this.Di=NaN;this.Mo=!1;for(var e=this.Vk.length=0,c=new a.b,k=new a.b,f=[0];this.Cd.Ea()&&8>this.mB;){var p=this.Cd.ba();c.L(p.ec());k.L(p.Bc());c.scale(this.$a.oc);k.scale(this.$a.oc);a.Ej.Bv(c,k)?c.x=k.x:a.Ej.zv(c,k)&&(k.x=c.x);this.Vk.length=0;a.Ej.GG(this.$a.Vb,this.$a.rc,this.$a.$e,c,k,this.$a.wB,this.$a.Tt,f,this.gk,this.Ct,this.Vk,this.Pw);null!=this.So&&(p=this.Vk.slice(0),this.So.EH(this.So.aa()-1,p,p.length-1));a.Ej.Av(c,k)?(this.fr.Oa(),this.$a.Yy(c,this.Wl,this.fr),this.Mo=!0):(this.fr.Oa(),
this.Mo=this.dz(f[0],this.fr));if(this.Mo){this.Cd.Li();if(this.Cd.pA()){this.Cd.Li();this.Cd.ba();break}this.Cd.AX();break}null==b&&(b=new a.Ja,b.Bl(null,0));this.eF(b);e++}this.Pw[0]=0;if(0<e){for(f=this.Cd.Db();0<e;)this.Cd.Li(),c.L(this.ex.Ba(this.Cd.Db())),k.L(this.ex.Ba(this.Cd.Ik())),c.scale(this.$a.oc),k.scale(this.$a.oc),this.Wl&&(a.Ej.Bv(c,k)?c.x=k.x:a.Ej.zv(c,k)&&(k.x=c.x)),this.Vk.length=0,a.Ej.GG(this.$a.Vb,this.$a.rc,this.$a.$e,k,c,this.$a.wB,this.$a.Tt,null,this.gk,this.Ct,this.Vk,
this.Pw),this.eF(b),e--;c.L(this.ex.Ba(this.Cd.Db()));c.scale(this.$a.oc);d.Fs(this.$a.Vb,this.$a.rc,this.$a.oc,this.$a.vb,c,this.Di+1.570796326794897,this.Di+4.71238898038469,this.$a.Qo,this.Wl,this.Tk,b,NaN,NaN);this.Cd.Tb(f);this.Cd.ba();e=a.na.ah(null,b,!0);return b=a.Dg.nl(b,e,!0,!0,this.$a.mc)}this.Mo=!1;this.Cd.ba();b=a.T.oe(this.fr);return b=a.Dg.nl(b,this.$a.pr,!0,!0,this.$a.mc)};b.prototype.eF=function(b){var e=this.Vk[0],c,g=this.gk[0]-1.570796326794897,k=this.Ct[0]+1.570796326794897,f;
if(!isNaN(this.Di)){this.Di>=this.gk[0]?(c=this.Di+1.570796326794897,g=c+3.141592653589793-(this.Di-this.gk[0])):(c=this.Di+1.570796326794897,g=c+3.141592653589793-(6.283185307179586-(this.gk[0]-this.Di)));f=this.Di>=this.gk[0]&&3.141592653589793>=this.Di-this.gk[0]?!1:this.Di<this.gk[0]&&3.141592653589793<=this.gk[0]-this.Di?!1:!0;var p=!1;if(Math.abs(g-c)<=.5*this.$a.Qo)if(f){var h=b.Ba(b.D()-2);h.scale(this.$a.oc);var l=new a.ea(0);a.mb.Gz(this.$a.Vb,this.$a.rc,e.x,e.y,h.x,h.y,l);for(h=l.j;h<=
c;)h+=6.283185307179586;for(;h>c;)h-=6.283185307179586;h<g&&(p=!0)}else p=!0;p?(b.dC(0,b.D()-1),this.Wl||(e=new a.b,e.L(b.Ba(b.D()-1)),e.scale(this.$a.oc),-3.141592653589793>e.x-this.Tk[0]?this.Tk[0]-=6.283185307179586:3.141592653589793<e.x-this.Tk[0]&&(this.Tk[0]+=6.283185307179586)),f||(g=.5*(g+c))):(f?(c=new a.b,c.L(e),c.scale(1/this.$a.oc),b.Zf(0,-1,c)):d.Fs(this.$a.Vb,this.$a.rc,this.$a.oc,this.$a.vb,this.Vk[0],c,g,this.$a.Qo,this.Wl,this.Tk,b,NaN,NaN),this.mB+=1)}d.Xy(this.$a.Vb,this.$a.rc,
this.$a.oc,this.$a.vb,this.$a.$e,this.Vk,g,k,this.Wl,this.Tk,b);this.Di=this.Ct[0]};b.prototype.dz=function(a,b){return this.$a.dz(this.Vk,a,this.gk[0],this.Ct[0],this.Wl,b)};b.prototype.Ia=function(){return 0};return b}(),d=function(){function e(){}e.buffer=function(b,c,d,k,f,p){if(null==b)throw a.g.F("Geometry::Geodesic_bufferer::buffer");if(b.u())return new a.Ja(b.description);var g=new e;g.mh=c;g.Qc=a.fb.lc(c);var n=a.fb.hw(g.Qc);g.mc=p;g.Vb=a.fb.Sv(g.Qc);g.rc=n*(2-n);g.oc=g.Qc.Vd().Ai;g.ta=g.mh.Bo();
g.pr=g.Qc.Bo();g.Tt=g.pr*g.oc;g.or=1.570796326794897/g.oc;g.E_=3.141592653589793/g.oc;g.Et=6.283185307179586/g.oc;g.F_=g.Et/6;g.rB=0;g.D_=1.5707963267948966*g.Vb/g.rB;4==d?(g.$e=2,g.Jw=!0):(g.$e=d,g.Jw=!1);g.Qa=k;g.vb=Math.abs(k);isNaN(f)||.001>f?g.tY():g.Po=f;d=b.G();a.T.Oc(d)?(d=new a.Ua(b.description),d.dc(b,!0),b=d,d=1607):197==d&&(d=new a.h,b.s(d),d.N()<=g.ta||d.fa()<=g.ta?(d=new a.Ua(b.description),d.jd(b,!1),b=d,d=1607):(d=new a.Ja(b.description),d.jd(b,!1),b=d,d=1736));g.uY();a.T.Jo(d)||g.vY();
if(g.vb<=.5*g.Po)return 1736!=d?new a.Ja(b.description):g.Jw?b:a.Ej.Ls(b,g.mh,g.$e,g.wB,-1,p);if(0>g.Qa&&1736!=d)return new a.Ja(b.description);g.Jw&&a.T.Ic(d)?(c=a.Ej.Ls(b,c,4,NaN,g.Po,p),b=a.fb.Xg(c,g.mh,g.Qc,p)):b=a.fb.Xg(b,g.mh,g.Qc,p);b=a.gi.Mj(b,g.Qc);if(b.u())return new a.Ja(b.description);!g.Jw&&a.T.Ic(d)&&(b=a.Ej.zJ(g.oc,b));b=e.nQ(b,g.Qc);switch(d){case 1736:p=g.YP(b);break;case 1607:p=g.ZP(b);break;case 550:p=g.WP(b);break;case 33:p=g.XP(b);break;default:throw a.g.X("corrupted_geometry");
}g=a.fb.Xg(p,g.Qc,g.mh,g.mc);g.om(b.description);return g};e.prototype.YP=function(b){var e=new a.Ja;b=new c(this,b,e);b=a.ei.local().V(b,this.Qc,this.mc).next();b=a.Vp.Nj(b,this.Qc,2);var g=new a.Hd;g.scale(1/this.oc,1/this.oc);e.Xc(g);e=a.Vp.Nj(e,this.Qc,2);return 0<=this.Qa?a.ei.local().V(e,b,this.Qc,this.mc):a.cq.local().V(e,b,this.Qc,this.mc)};e.prototype.ZP=function(b){b=new c(this,b,null);b=a.ei.local().V(b,this.Qc,this.mc).next();return b=a.Vp.Nj(b,this.Qc,2)};e.prototype.WP=function(e){e=
new b(this,e);e=a.ei.local().V(e,this.Qc,this.mc).next();return e=a.Vp.Nj(e,this.Qc,2)};e.prototype.XP=function(b){b=b.w();b.scale(this.oc);var e=new a.Ja;this.Yy(b,!1,e);return e=a.Vp.Nj(e,this.Qc,2)};e.prototype.dz=function(b,c,d,k,f,p){var g=b[0],n=b[b.length-1],y=g.y>n.y?g.y:n.y,B=a.C.q(this.Vb,this.rc,g.y<n.y?g.y:n.y),y=a.C.q(this.Vb,this.rc,y);if(.001<this.rB-(B+c+this.vb)&&.001<this.rB+(y-c-this.vb))return!1;c=d-1.570796326794897;d=k+1.570796326794897;var B=c-3.141592653589793,y=c+3.141592653589793,
h=d+3.141592653589793,F=[NaN],l=[NaN],m=[NaN],H=[NaN];k=!1;e.AD(this.Vb,this.rc,this.vb,g,c,B,n,d,F,l);e.AD(this.Vb,this.rc,this.vb,n,h,d,g,B,m,H);d<F[0]&&F[0]<h?k=!0:d<l[0]&&l[0]<h&&(k=!0);k||(B<m[0]&&m[0]<c?k=!0:B<H[0]&&H[0]<c&&(k=!0));if(!k&&f)return!1;for(var q=[],A=b.length-1;0<=A;A--)q.push(b[A]);p.Oa();p.Bl(null,0);A=[0];e.Xy(this.Vb,this.rc,this.oc,this.vb,this.$e,b,c,d,f,A,p);e.Fs(this.Vb,this.rc,this.oc,this.vb,n,d,h,this.Qo,f,A,p,F[0],l[0]);e.Xy(this.Vb,this.rc,this.oc,this.vb,this.$e,
q,h,y,f,A,p);e.Fs(this.Vb,this.rc,this.oc,this.vb,g,B,c,this.Qo,f,A,p,m[0],H[0]);b=!1;f||(b=this.PF(this.oc,p));return k||b};e.prototype.Yy=function(a,b,c){c.Oa();c.Bl(null,0);e.Fs(this.Vb,this.rc,this.oc,this.vb,a,-this.Qo,6.283185307179586,this.Qo,b,[0],c,NaN,NaN);b||this.PF(this.oc,c)};e.prototype.PF=function(a,b){var e=this.zQ(a,b);a=this.AQ(a,b);return e||a};e.prototype.zQ=function(b,e){var c=e.D(),g=!1,d=new a.h;e.s(d);if(!a.l.W(d.B*b,1.570796326794897)&&!a.l.W(d.A*b,-1.570796326794897))return!1;
for(var k=new a.b,c=c-1;0<=c;c--)e.w(c,k),k.y==d.B&&a.l.W(k.y*b,1.570796326794897)?(g=!0,this.IJ(k,c,e)):k.y==d.A&&a.l.W(k.y*b,-1.570796326794897)&&(g=!0,this.IJ(k,c,e));return g};e.prototype.AQ=function(a,b){var e=b.Ba(0),c=b.Ba(b.D()-1);return 3.141592653589793<Math.abs(e.x-c.x)*a?(this.OW(b),!0):this.yQ(b)};e.prototype.yQ=function(a){return 0>a.hf()?(this.NW(a),!0):!1};e.prototype.IJ=function(b,e,c){var g=c.D(),d=0<e?e-1:g-1,g=c.Ba(e<g-1?e+1:0),d=c.Ba(d);if(!a.l.W(g.y,b.y)&&!a.l.W(g.x,b.x)){var k=
new a.b;k.ka(g.x,b.y);c.rb(e,k)}a.l.W(d.y,b.y)||a.l.W(d.x,b.x)||(g=new a.b,g.ka(d.x,b.y),c.Zf(0,e,g))};e.prototype.OW=function(b){var e=new a.Ja,c=new a.Ja,g=new a.Hd,d=b.Ba(0),k=b.Ba(b.D()-1),f=new a.b;d.x>k.x?(k=this.or,g.Ag(-this.Et,0)):(k=-this.or,g.Ag(this.Et,0));e.add(b,!1);b.Oa();c.add(e,!1);c.Xc(g);d=new a.h;c.s(d);d.O((this.Et-d.N())/2,0);d.A=-this.or;d.B=this.or;for(var p=0;p<c.D();p++)c.w(p,f),e.Zf(0,-1,f);c.Xc(g);for(p=0;p<c.D();p++)c.w(p,f),e.Zf(0,-1,f);c=e.Ba(0);g=e.Ba(e.D()-1);f.ka(g.x,
k);e.Zf(0,-1,f);f.ka(.5*(g.x+c.x),k);e.Zf(0,-1,f);f.ka(c.x,k);e.Zf(0,-1,f);e=a.gi.ht(e,this.Qc,2,!0,d.o);e=a.gi.ht(e,this.Qc,2,!0,d.v);e=a.ne.clip(e,d,this.pr,NaN);b.add(e,!1)};e.prototype.NW=function(b){var e=new a.h;b.s(e);e.O((this.Et-e.N())/2,0);e.A=-this.or;e.B=this.or;b.Bl(null,0);var c=new a.b;c.ka(e.o,e.A);b.Zf(1,-1,c);c.ka(e.o,e.B);b.Zf(1,-1,c);c.ka(.5*(e.o+e.v),e.B);b.Zf(1,-1,c);c.ka(e.v,e.B);b.Zf(1,-1,c);c.ka(e.v,e.A);b.Zf(1,-1,c);c.ka(.5*(e.o+e.v),e.A);b.Zf(1,-1,c)};e.Xy=function(b,c,
d,k,f,p,h,l,m,q,A){var g=null;m||(g=new a.b,g.$c(),0<A.D()&&(g.L(A.Ba(A.D()-1)),g.scale(d)));var n=new a.ea(0),y=new a.ea(0),B=new a.ea(0),F=new a.b,H=new a.b,r=p[p.length-1];d=1/d;for(var M=0;M<p.length;M++){var t=p[M],u;0==M?u=h:M==p.length-1?u=l:(a.mb.Ld(b,c,r.x,r.y,t.x,t.y,null,null,n,f),u=n.j-1.570796326794897);a.mb.Xi(b,c,t.x,t.y,k,u,y,B);m?H.ka(y.j,B.j):(F.ka(y.j,B.j),e.MF(t.x,F.x,g.x,q),H.ka(q[0]+F.x,F.y),g.L(H));H.scale(d);A.Zf(0,-1,H)}};e.Fs=function(b,c,d,k,f,p,h,l,m,q,A,r,t){if(!(h-p<
l)){var g=new a.ea(0),n=new a.ea(0),y=new a.b,B=new a.b,F=null;m||(F=new a.b,F.$c(),0<A.D()&&(F.L(A.Ba(A.D()-1)),F.scale(d)));var H=a.J.truncate(Math.ceil(p/l)),M=H++*l;M==p&&(M=H++*l);for(d=1/d;M<h+l;){p<r&&r<M?(M=r,H--):p<t&&t<M&&(M=t,H--);if(M>=h)break;a.mb.Xi(b,c,f.x,f.y,k,M,g,n);m?B.ka(g.j,n.j):(y.ka(g.j,n.j),e.MF(f.x,y.x,F.x,q),B.ka(q[0]+y.x,y.y),F.L(B));B.scale(d);A.Zf(0,-1,B);p=M;M=H++*l}}};e.AD=function(b,e,c,d,k,f,p,h,l,m){var g=new a.b,n=new a.b,y=new a.ea(0),B=new a.ea(0);a.mb.Xi(b,e,
d.x,d.y,c,k,y,B);g.ka(y.j,B.j);a.mb.Xi(b,e,d.x,d.y,c,f,y,B);n.ka(y.j,B.j);c=new a.ea(0);a.mb.Gz(b,e,p.x,p.y,g.x,g.y,c);l[0]=c.j;a.mb.Gz(b,e,p.x,p.y,n.x,n.y,c);for(m[0]=c.j;l[0]<=m[0];)l[0]+=6.283185307179586;for(;l[0]>m[0];)l[0]-=6.283185307179586;for(;l[0]>=h;)l[0]-=6.283185307179586,m[0]-=6.283185307179586;for(;l[0]<h;)l[0]+=6.283185307179586,m[0]+=6.283185307179586};e.MF=function(a,b,e,c){if(isNaN(e)){for(;3.141592653589793<c[0]+b-a;)c[0]-=6.283185307179586;for(;3.141592653589793<a-(c[0]+b);)c[0]+=
6.283185307179586}else 3.141592653589793<c[0]+b-e?c[0]-=6.283185307179586:3.141592653589793<e-(c[0]+b)&&(c[0]+=6.283185307179586)};e.nQ=function(b,e){var c=b.G(),g;a.T.Ic(c)?g=b.aa():550==c?g=b.D():g=1;if(1==g)return b;var d=new a.ia(0);d.resize(g);for(var k=[],n=new a.h,f=0;f<g;f++){d.write(f,f);var p;a.T.Ic(c)?(b.jk(f,n),p=n.Wf()):p=b.Ba(f);p=a.tM.UY(e,p);k[f]=p}d.Gd(0,d.size,function(a,b){return k[a]<k[b]?-1:k[a]>k[b]?1:0});n=b.Ka();for(f=0;f<g;f++)p=d.read(f),a.T.Ic(c)?n.Ti(b,p,!0):n.Id(b,p,p+
1);return n};e.prototype.uY=function(){var b=Math.min(3.141592653589793*this.Vb-this.vb,this.vb),b=Math.min(b,.39269908169872414*this.Vb),e=new a.b;e.ka(0,10*this.oc);var c=45*this.oc,d=new a.ea(0),k=new a.ea(0),f=new a.ea(0),p=new a.ea(0),h=new a.ea(0),l=new a.ea(0),m=new a.ea(0),q=new a.ea(0),A=new a.b,r=new a.b,t=new a.b,u=new a.b;a.mb.Xi(this.Vb,this.rc,e.x,e.y,b,0,d,k);A.ka(d.j,k.j);a.mb.Xi(this.Vb,this.rc,e.x,e.y,b,c,f,p);r.ka(f.j,p.j);for(var d=new a.ea(0),k=new a.ea(0),v=new a.ea(0);;){a.mb.Xi(this.Vb,
this.rc,e.x,e.y,b,.5*(0+c),h,l);t.ka(h.j,l.j);a.mb.Ld(this.Vb,this.rc,A.x,A.y,r.x,r.y,d,k,null,2);a.mb.Oj(this.Vb,this.rc,A.x,A.y,.5*d.j,k.j,m,q,2);u.ka(m.j,q.j);a.mb.Ld(this.Vb,this.rc,t.x,t.y,u.x,u.y,v,null,null,2);if(v.j<=this.Po)break;c*=.9;a.mb.Xi(this.Vb,this.rc,e.x,e.y,b,c,f,p);r.ka(f.j,p.j)}this.Qo=6.283185307179586/Math.ceil(6.283185307179586/(c-0))};e.prototype.vY=function(){var b=Math.min(3.141592653589793*this.Vb-this.vb,this.vb),b=Math.min(b,.39269908169872414*this.Vb),e=new a.b,c=new a.b;
e.ka(0,10*this.oc);c.ka(10*this.oc,10*this.oc);var d=new a.ea(0),k=new a.ea(0),f=new a.ea(0);a.mb.Ld(this.Vb,this.rc,e.x,e.y,c.x,c.y,f,d,k,this.$e);var p=new a.ea(0),h=new a.ea(0),l=new a.ea(0),m=new a.ea(0),q=new a.b,A=new a.ea(0),r=new a.ea(0),t=new a.ea(0),u=new a.ea(0),v=new a.ea(0),w=new a.ea(0),x=new a.ea(0),z=new a.ea(0),L=new a.ea(0),C=new a.b,D=new a.b,E=new a.b,G=new a.b,I=1,d=d.j,k=k.j+1.570796326794897,f=f.j;a.mb.Xi(this.Vb,this.rc,e.x,e.y,b,d-1.570796326794897,r,t);C.ka(r.j,t.j);a.mb.Xi(this.Vb,
this.rc,c.x,c.y,b,k,u,v);D.ka(u.j,v.j);for(var r=new a.ea(0),t=new a.ea(0),k=new a.ea(0),J=new a.ea(0);;){a.mb.Oj(this.Vb,this.rc,e.x,e.y,.5*(0+I)*f,d,p,h,this.$e);q.ka(p.j,h.j);a.mb.Ld(this.Vb,this.rc,e.x,e.y,q.x,q.y,null,null,A,this.$e);a.mb.Xi(this.Vb,this.rc,q.x,q.y,b,A.j+1.570796326794897,w,x);E.ka(w.j,x.j);a.mb.Ld(this.Vb,this.rc,C.x,C.y,D.x,D.y,r,t,null,2);a.mb.Oj(this.Vb,this.rc,C.x,C.y,.5*r.j,t.j,z,L,2);G.ka(z.j,L.j);a.mb.Ld(this.Vb,this.rc,E.x,E.y,G.x,G.y,k,null,null,2);if(k.j<=this.Po)break;
I*=.9;a.mb.Oj(this.Vb,this.rc,e.x,e.y,I*f,d,l,m,this.$e);c.ka(l.j,m.j);a.mb.Ld(this.Vb,this.rc,e.x,e.y,c.x,c.y,null,null,J,this.$e);a.mb.Xi(this.Vb,this.rc,c.x,c.y,b,J.j+1.570796326794897,u,v);D.ka(u.j,v.j)}b=I*f;1E5<b&&(b=1E5);this.wB=b};e.prototype.tY=function(){var a;a=5E4<this.vb?100:1E4<this.vb?10:1;500>this.vb/a&&(a=this.vb/500);.01>a&&(a=.01);this.Po=a};return e}();a.sM=d})(x||(x={}));(function(a){var b=function(){function b(){}b.tc=function(b,e){var c=new a.b;c.L(e);b.push(c)};b.rk=function(a,
b){a.add(b.x);a.add(b.y)};b.ZC=function(a){a.yf(a.size-2)};b.oy=function(a,b){b.ka(a.get(a.size-2),a.get(a.size-1))};b.Ls=function(c,e,g,d,f,p){if(null==c)throw a.g.F();var k=c.G();if(c.u()||a.T.Jo(k))return c;var n=new b;n.mh=e;n.Qc=a.fb.lc(e);var y=a.fb.hw(n.Qc);n.mc=p;n.Vb=a.fb.Sv(n.Qc);n.rc=y*(2-y);n.oc=n.Qc.Vd().Ai;n.pr=n.Qc.Bo();n.Tt=n.pr*n.oc;n.hB=d;n.gB=f;n.$e=g;197==k?(g=new a.Ja(c.description),g.jd(c,!1)):a.T.Oc(k)?(g=new a.Ua(c.description),g.dc(c,!0)):g=c;if(4!=n.$e){e=0==n.mh.Eb(n.Qc)?
a.fb.Xg(g,n.mh,n.Qc,p):a.gi.Mj(g,n.Qc);if(e.u())return e;e=b.zJ(n.oc,e);e=n.Hz(e);e=a.Vp.Nj(e,n.Qc,n.$e);n=a.fb.Xg(e,n.Qc,n.mh,p)}else{2==a.Rd.Fb(e)?(c=a.fb.Lk(e),p=a.tk.local().V(g,c,e,p),p==c&&(p=new a.Ja,c.copyTo(p))):p=a.gi.Mj(g,n.Qc);e=p;if(e.u())return e;n=n.xY(e)}return n};b.zJ=function(c,e){var g=new a.h;e.ac(g);if(3.141592653589793>g.N()*c)return e;for(var d=!1,g=e.Fa(),k=new a.b,f=new a.b;g.Ya();)for(;g.Ea();){var p=g.ba();k.L(p.ec());f.L(p.Bc());k.scale(c);f.scale(c);if(3.141592653589793<
Math.abs(k.x-f.x)){var h=b.Av(k,f);if(!h){d=!0;break}if(6.283185307179586<Math.abs(k.x-f.x)){d=!0;break}}}if(!d)return e;var d=e.Ka(),l=1<e.description.Ga,m=new a.b,q=new a.b,A=new a.b,r=new a.b,t=new a.Wa;for(g.yj();g.Ya();)for(var u=NaN,v=[0];g.Ea();){p=g.ba();k.L(p.ec());f.L(p.Bc());k.scale(c);f.scale(c);isNaN(u)?(b.fe(k.x,NaN,v),q.L(k)):q.L(A);u=q.x;if(h=b.Av(k,f)){if(6.283185307179586<f.x-k.x)for(;6.283185307179586<f.x-k.x;)f.x-=6.283185307179586;if(-6.283185307179586>f.x-k.x)for(;-6.283185307179586>
f.x-k.x;)f.x+=6.283185307179586;b.fe(f.x,NaN,v);A.L(f)}else m.L(f),b.WM(m),b.fe(m.x,u,v),A.ka(v[0]+m.x,m.y);.5>Math.abs(A.x-f.x)&&A.L(f);l?(p.Fx(0,t),r.L(q),r.scale(1/c),t.rb(r),(h=g.jn())?d.Rf(t):d.lineTo(t),g.Io()&&!e.Qb(g.Ta)&&(p.Fx(1,t),r.L(A),r.scale(1/c),t.rb(r),d.lineTo(t))):((h=g.jn())&&d.sA(null,0),p=d.aa()-1,r.L(q),r.scale(1/c),d.Zf(p,-1,r),g.Io()&&!e.Qb(g.Ta)&&(r.L(A),r.scale(1/c),d.Zf(p,-1,r)))}return d};b.GG=function(c,e,g,d,f,p,h,l,m,q,A,r){var k=new a.b,n=new a.b,y=0<d.compare(f);b.rF(y,
d,f,k,n);b.wG(c,e,g,k,n,p,NaN,h,l,m,q,null,A,r);y&&b.qy(m,q,null,A)};b.prototype.Hz=function(c){var e=c.Ka(),g=c.Fa(),d=[],k=null,f=null,p=1<c.description.Ga;p&&(k=new a.Qd(0),f=new a.Cg);for(var h=[0],l=new a.b,m=new a.b,q=new a.b,A=new a.b;g.Ya();)for(h[0]=0;g.Ea();){var r=g.ba();l.L(r.ec());m.L(r.Bc());l.scale(this.oc);m.scale(this.oc);var t=0<l.compare(m);b.rF(t,l,m,q,A);d.length=0;null!=k&&k.yf(0);0<this.hB?b.wG(this.Vb,this.rc,this.$e,q,A,this.hB,this.gB,this.Tt,null,null,null,p?k:null,d,h):
b.SV(this.Vb,this.rc,this.$e,q,A,this.gB,this.Tt,p?k:null,d,h);t&&b.qy(null,null,p?k:null,d);d[0].L(r.ec());d[d.length-1].L(r.Bc());for(var u=1;u<d.length-1;u++)d[u].scale(1/this.oc);p?(t=b.TE(t,r,f),b.jE(g.jn(),g.Io()&&!c.Qb(g.Ta),r,t,k,d,e)):b.hE(g.jn(),g.Io()&&!c.Qb(g.Ta),d,e)}return e};b.prototype.xY=function(c){var e=c.Ka(),g=c.Fa(),d=[],k=null,f=new a.Cg,p=1<c.description.Ga;for(p&&(k=new a.Qd(0));g.Ya();)for(;g.Ea();){var h=g.ba(),l=h.ec(),m=h.Bc(),l=0<l.compare(m),m=b.TE(l,h,f);d.length=0;
null!=k&&k.yf(0);b.GL(this.Vb,this.rc,this.oc,m,this.mh,this.hB,this.gB,p?k:null,d);l&&b.qy(null,null,p?k:null,d);p?b.jE(g.jn(),g.Io()&&!c.Qb(g.Ta),h,m,k,d,e):b.hE(g.jn(),g.Io()&&!c.Qb(g.Ta),d,e)}return e};b.hE=function(a,b,c,d){a&&d.sA(null,0);a=d.aa()-1;var e=c.slice(0);d.EH(a,e,e.length-1);b&&d.Zf(a,-1,c[c.length-1])};b.jE=function(b,e,c,d,f,p,h){var g=new a.Wa;c.Dp(g);b?h.Rf(g):h.lineTo(g);if(2<p.length){b=d.Rb();for(var k=1;k<p.length-1;k++){var n=d.bI(f.get(k)*b);d.Fx(n,g);g.rb(p[k]);h.lineTo(g)}}e&&
(c.Bp(g),h.lineTo(g))};b.wG=function(c,e,g,d,f,p,h,l,m,q,A,r,t,u){var k=new a.ea(0),n=new a.ea(0),y=new a.ea(0);a.mb.Ld(c,e,d.x,d.y,f.x,f.y,y,k,n,g);var y=y.j,B=k=k.j,n=n.j;0>B&&(B+=6.283185307179586);0>n&&(n+=6.283185307179586);null!=m&&(m[0]=y);null!=q&&(q[0]=B);null!=A&&(A[0]=n);q=m=NaN;null!=r&&(q=a.C.Yg(c,e),A=a.C.q(c,e,d.y),m=(q-A)/y,q=(q+A)/y);A=b.Bv(d,f);var n=b.zv(d,f),B=A||n,F=b.uE(d,f,l),H=new a.ea(0),M=new a.ea(0),X=new a.b,v=new a.b,w=new a.b;b.fe(d.x,NaN,u);var Z=[u[0]];if(y<=p)b.tc(t,
d),b.fe(f.x,NaN,u),null!=r&&r.add(0),B?(A&&b.my(d,f,r,t),n&&b.iy(d,f,r,t)):F?b.ly(d,f,k,m,q,r,t):0<h&&(v.ka(d.x-Z[0],d.y),X.ka(f.x-u[0],f.y),b.GA(c,e,g,d,y,k,v,X,0,1,h,r,t,Z)),b.tc(t,f);else{p=1+a.J.truncate(Math.ceil(y/p));var x=y/(p-1),ca=new a.b,z=0;b.tc(t,d);ca.L(d);v.ka(d.x-u[0],d.y);null!=r&&r.add(0);for(var L=1;L<p;L++){var da;L<p-1?(a.mb.Oj(c,e,d.x,d.y,L*x,k,H,M,g),X.ka(H.j,M.j),b.fe(X.x,ca.x,u),w.ka(u[0]+X.x,X.y),da=L/(p-1)):(b.fe(f.x,NaN,u),X.ka(f.x-u[0],f.y),w.L(f),da=1);B?(1==L&&A&&b.my(d,
w,r,t),L==p-1&&n&&b.iy(ca,f,r,t)):F?b.sE(ca,w,l)&&(d.x<f.x?ca.x>w.x&&(u[0]+=6.283185307179586,w.ka(u[0]+X.x,X.y)):ca.x<w.x&&(u[0]-=6.283185307179586,w.ka(u[0]+X.x,X.y)),b.ly(ca,w,k,m,q,r,t)):0<h&&b.GA(c,e,g,d,y,k,v,X,z,da,h,r,t,Z);b.tc(t,w);null!=r&&r.add(da);ca.L(w);v.L(X);Z[0]=u[0];z=da}}};b.SV=function(c,e,g,d,f,p,h,l,m,q){var k=new a.ea(0),n=new a.ea(0),y=new a.ea(0);a.mb.Ld(c,e,d.x,d.y,f.x,f.y,y,k,n,g);var n=y.j,k=k.j,B=y=NaN;if(null!=l)var B=a.C.Yg(c,e),F=a.C.q(c,e,d.y),y=(B-F)/n,B=(B+F)/n;
var F=b.Bv(d,f),H=b.zv(d,f),A=F||H;h=b.uE(d,f,h);var r=b.Av(d,f),r=A||h||r;b.fe(d.x,NaN,q);var t=new a.b;b.tc(m,d);t.L(d);null!=l&&l.add(0);r?(A?(F&&b.my(d,f,l,m),H&&b.iy(d,f,l,m)):h&&b.ly(d,f,k,y,B,l,m),b.fe(f.x,NaN,q),b.tc(m,f)):n<=p?(b.fe(f.x,NaN,q),b.tc(m,f)):(y=new a.b,h=new a.b,y.L(d),h.L(f),y.x-=q[0],h.x-=q[0],-3.141592653589793>h.x?h.x+=6.283185307179586:3.141592653589793<h.x&&(h.x-=6.283185307179586),b.GA(c,e,g,d,n,k,y,h,0,1,p,l,m,q),b.tc(m,f),b.fe(f.x,NaN,q));null!=l&&l.add(1)};b.GA=function(c,
e,g,d,f,p,h,l,m,q,A,r,t,u){var k=new a.b,n=new a.b;k.ka(h.x+u[0],h.y);new a.ea(0);new a.ea(0);new a.ea(0);new a.ea(0);var y=new a.ea(0),B=new a.ea(0),F=new a.ea(0),H=new a.b,M=new a.b,X=new a.b,v=new a.b;H.L(h);M.L(l);h=new a.Qd(0);l=new a.Qd(0);b.rk(h,M);l.add(q);var w=new a.b,Z=new a.Hb,x=[];for(b.sG(4,x);0<h.size;){for(var z=!1,ca,L=NaN,da=0;3>da;da++)if(ca=x[da]*q+(1-x[da])*m,a.mb.Oj(c,e,d.x,d.y,ca*f,p,y,B,g),X.ka(y.j,B.j),0==da&&(L=ca,v.L(X)),b.yO(H,X,M,Z),Z.gc(Z.qe(X,!0),w),a.mb.Ld(c,e,X.x,
X.y,w.x,w.y,F,null,null,2),F.j>A){z=!0;break}z?(M.L(v),q=L,b.rk(h,M),l.add(q)):(b.ZC(h),l.Ek(l.size-1,1,l.size-1),0<h.size&&(b.fe(M.x,k.x,u),n.ka(u[0]+M.x,M.y),b.tc(t,n),k.L(n),null!=r&&r.add(q),H.L(M),m=q,b.oy(h,M),q=l.get(l.size-1)))}};b.GL=function(c,e,g,d,f,p,h,l,m){var k=new a.b,n=new a.b,y=new a.b,B=new a.b,F=new a.b,H=new a.b,q=new a.b,A=new a.b,r=new a.b,t=new a.b,M=new a.ea(0),u=new a.ea(0),v=new a.b,w=[[],[]],x=1==a.Rd.Fb(f);f=f.se(0);var z=d.ec(),L=d.Bc();x?(H.ka(z.x*g,z.y*g),q.ka(L.x*
g,L.y*g)):(w[0][0]=z.x,w[0][1]=z.y,w[1][0]=L.x,w[1][1]=L.y,a.fb.lu(),H.x=w[0][0]*g,H.y=w[0][1]*g,q.x=w[1][0]*g,q.y=w[1][1]*g);var C=0,D=0,E=1,G=d.Go();k.L(z);n.L(L);var L=new a.Qd(0),I=new a.Qd(0),J=new a.Qd(0);b.rk(L,n);b.rk(I,q);J.add(E);b.tc(m,k);null!=l&&l.add(D);var K=[],R;R=0<h?G?5:3:G?5:1;b.sG(R,K);for(var S=new a.ea(0),N=new a.ea(0),P=new a.ea(0),Q=new a.ea(0),O=new a.ea(0),U=new a.ea(0),V=new a.ea(0);0<I.size;){var T=!1,Y,W=NaN;a.mb.Ld(c,e,H.x,H.y,q.x,q.y,S,N,null,2);for(z=0;z<R;z++){if(0==
z){if(!G&&0>=h&&S.j<=p&&3.141592653589793>Math.abs(H.x-q.x))break;if(d.Dy(D,E)<=f)break}Y=K[z]*E+(1-K[z])*D;d.gc(Y,y);x?A.ka(y.x*g,y.y*g):(w[0][0]=y.x,w[0][1]=y.y,a.fb.lu(),A.x=w[0][0]*g,A.y=w[0][1]*g);if(0==z&&(W=Y,F.L(y),t.L(A),0<p&&(S.j>p||3.141592653589793<=Math.abs(H.x-q.x)))){T=!0;break}if(G&&0<p){if(a.mb.Ld(c,e,H.x,H.y,A.x,A.y,P,null,null,2),P.j>p||3.141592653589793<=Math.abs(H.x-A.x)){T=!0;break}}else if(0<h)if(G?(B.JU(k,n,K[z]),x?r.ka(B.x*g,B.y*g):(w[0][0]=B.x,w[0][1]=B.y,a.fb.lu(),r.x=w[0][0]*
g,r.y=w[0][1]*g)):(B.L(y),r.L(A)),a.mb.Ld(c,e,H.x,H.y,r.x,r.y,Q,null,null,2),Q.j<=S.j){a.mb.Oj(c,e,H.x,H.y,Q.j,N.j,M,u,2);v.ka(M.j,u.j);a.mb.Ld(c,e,v.x,v.y,A.x,A.y,O,null,null,2);if(O.j>h){T=!0;break}if(G){a.mb.Ld(c,e,v.x,v.y,r.x,r.y,U,null,null,2);if(U.j>h){T=!0;break}a.mb.Ld(c,e,r.x,r.y,A.x,A.y,V,null,null,2);if(V.j>h){T=!0;break}}}else{T=!0;break}}T?(n.L(F),q.L(t),E=W,b.rk(L,n),b.rk(I,q),J.add(E)):(b.ZC(L),b.ZC(I),J.Ek(J.size-1,1,J.size-1),b.tc(m,n),C+=S.j,null!=l&&l.add(C),0<I.size&&(k.L(n),H.L(q),
D=E,b.oy(L,n),b.oy(I,q),E=J.get(J.size-1)))}if(null!=l)for(c=1/C,z=0;z<l.size;z++)l.write(z,l.read(z)*c)};b.qy=function(a,b,c,d){d.reverse();null!=c&&c.Zd(0,c.size,1);c=null!=a?a[0]:NaN;d=null!=b?b[0]:NaN;null!=a&&(a[0]=d);null!=b&&(b[0]=c)};b.rF=function(a,b,c,d,f){a?(d.L(c),f.L(b)):(d.L(b),f.L(c))};b.TE=function(a,b,c){if(!a)return b;c.create(b.G());b.copyTo(c.get());c.get().reverse();return c.get()};b.fe=function(a,b,c){if(isNaN(b)){for(;3.141592653589793<c[0]-a;)c[0]-=6.283185307179586;for(;3.141592653589793<
a-c[0];)c[0]+=6.283185307179586}else 3.141592653589793<c[0]+a-b?c[0]-=6.283185307179586:3.141592653589793<b-(c[0]+a)&&(c[0]+=6.283185307179586)};b.yO=function(a,b,c,d){3.141592653589793>Math.abs(b.x-a.x)?(d.Mc(a),3.141592653589793<=c.x-a.x?d.vm(c.x-6.283185307179586,c.y):3.141592653589793<=a.x-c.x?d.vm(c.x+6.283185307179586,c.y):d.vm(c.x,c.y)):(d.Mc(c),3.141592653589793<=a.x-c.x?d.vm(a.x-6.283185307179586,a.y):3.141592653589793<=c.x-a.x?d.vm(a.x+6.283185307179586,a.y):d.vm(a.x,a.y))};b.sG=function(a,
b){for(var e=0;e<a;e++){var c=Math.ceil(e/2)/(a+1);0!=e%2&&(c=-c);b[e]=.5+c}};b.Bv=function(b,e){return a.l.W(b.y,1.570796326794897)&&!a.l.W(e.y,1.570796326794897)||a.l.W(b.y,-1.570796326794897)&&!a.l.W(e.y,-1.570796326794897)?!0:!1};b.zv=function(b,e){return a.l.W(e.y,1.570796326794897)&&!a.l.W(b.y,1.570796326794897)||a.l.W(e.y,-1.570796326794897)&&!a.l.W(b.y,-1.570796326794897)?!0:!1};b.uE=function(c,e,g){return!b.sE(c,e,g)||a.l.W(c.y,1.570796326794897)||a.l.W(c.y,-1.570796326794897)||a.l.W(e.y,
1.570796326794897)||a.l.W(e.y,-1.570796326794897)?!1:!0};b.sE=function(a,b,c){return Math.abs(Math.abs(a.x-b.x)-3.141592653589793)<=c?!0:!1};b.Av=function(b,e){return a.l.W(b.y,1.570796326794897)&&a.l.W(e.y,1.570796326794897)||a.l.W(b.y,-1.570796326794897)&&a.l.W(e.y,-1.570796326794897)?!0:!1};b.my=function(c,e,g,d){if(0<c.y){var k=new a.b;k.ka(e.x,1.570796326794897)}else k=new a.b,k.ka(e.x,-1.570796326794897);a.l.W(c.x,k.x)||a.l.W(e.y,k.y)||(b.tc(d,k),null!=g&&g.add(0))};b.iy=function(c,e,g,d){if(0<
e.y){var k=new a.b;k.ka(c.x,1.570796326794897)}else k=new a.b,k.ka(c.x,-1.570796326794897);a.l.W(e.x,k.x)||a.l.W(c.y,k.y)||(b.tc(d,k),null!=g&&g.add(1))};b.ly=function(c,e,g,d,f,p,h){a.l.xd(g)?(0<1.570796326794897-c.y&&(g=new a.b,g.ka(c.x,1.570796326794897),b.tc(h,g),null!=p&&p.add(d)),0<1.570796326794897-e.y&&(g=new a.b,g.ka(e.x,1.570796326794897),b.tc(h,g),null!=p&&p.add(d))):(0<1.570796326794897+c.y&&(g=new a.b,g.ka(c.x,-1.570796326794897),b.tc(h,g),null!=p&&p.add(f)),0<1.570796326794897+e.y&&
(g=new a.b,g.ka(e.x,-1.570796326794897),b.tc(h,g),null!=p&&p.add(f)))};b.WM=function(a){if(-3.141592653589793>a.x)for(;-3.141592653589793>a.x;)a.x+=6.283185307179586;if(3.141592653589793<a.x)for(;3.141592653589793<a.x;)a.x-=6.283185307179586};return b}();a.Ej=b})(x||(x={}));(function(a){var b=function(){function b(){}b.Nj=function(c,e,g){if(null==c||null==e||!a.fb.Jc(e))throw a.g.F();if(c.u())return c;var d=c,k=d.G();if(a.T.Ic(k)){d=a.gi.Mj(c,e);c=new a.h;d.s(c);for(var k=a.na.be(e,c,!1),f=a.fb.Bh(e),
p=Math.floor((c.o-f.o)/f.N())*f.N()+f.o;p<c.v;)p>c.o+k&&p<c.v-k&&(d=a.gi.ht(d,e,g,!0,p)),p+=f.N()}else{if(197==k)return c=new a.Ja(d.description),c.jd(d,!1),b.Nj(c,e,g);if(a.T.Oc(k))return c=new a.Ua(d.description),c.dc(d,!0),b.Nj(c,e,g)}return b.kV(d,e)};b.kV=function(c,e){if(null==c||null==e||!a.fb.Jc(e))throw a.g.F();if(c.u())return c;var g;g=c.G();197==g?(g=new a.Ja(c.description),g.jd(c,!1)):a.T.Oc(g)?(g=new a.Ua(c.description),g.dc(c,!0)):g=c;g=a.gi.Mj(g,e);return g.u()?g:1==a.Rd.Fb(e)?a.gi.Xm(g,
e,0,g!=c,0):b.eV(g,e,g!=c)};b.eV=function(b,e,c){if(!a.fb.Jc(e))throw a.g.F();if(b.u())return b;var g=a.fb.ee(e),d=0-180*g,g=360*g;2==a.Rd.Fb(e)&&(d=a.fb.Bh(e),g=d.v,d=d.o,g-=d);return a.gi.Aq(b,d,g,e,c,0,!0)};return b}();a.Vp=b})(x||(x={}));(function(a){var b=function(){function b(){}b.gV=function(a,b){var e=Math.abs(a%b);return isNaN(e)||e==a||e<=Math.abs(b)/2?e:0>a?-1*(e-b):0<a?1*(e-b):0*(e-b)};b.K=function(a){return 0>a?-a:a};b.Ab=function(a,e){return 0<=e?b.K(a):-b.K(a)};b.W=function(a,e){return a==
e||b.K(a-e)<=b.hD*(1+(b.K(a)+b.K(e))/2)};b.xd=function(a){return 0==a||b.K(a)<=b.hD};b.Fu=function(a){a=b.gV(a,b.nA);return b.K(a)<=b.Oi?a:0>a?a+b.nA:a-b.nA};b.LB=function(a,e){a.j=b.Fu(a.j);e.j=b.Fu(e.j);b.K(e.j)>b.ss&&(a.j=b.Fu(a.j+b.Oi),e.j=b.Ab(b.Oi,e.j)-e.j)};b.Yg=function(a,e){e=Math.sqrt(1-e);e=(1-e)/(1+e);var c=e*e;return a/(1+e)*(1+c*(.25+c*(.015625+1/256*c)))*b.ss};b.TS=function(c,e,g,d,f){var k,n,p,y,h,l,m,q=0,A=l=0,r=0,t=0,u=0;h=0;var v,w,x;m=0;var z,L,C;x=new a.ea;k=new a.ea;if(null!=
f)if(x.j=c,k.j=e,b.LB(x,k),c=x.j,e=k.j,x.j=g,k.j=d,b.LB(x,k),g=x.j,d=k.j,g=b.Fu(g-c),b.W(e,d)&&(b.xd(g)||b.W(b.K(e),b.ss)))null!=f&&(f.j=0);else{if(b.W(e,-d)){if(b.W(b.K(e),b.ss)){null!=f&&(f.j=2*b.Yg(6378137,.0066943799901413165));return}if(b.W(b.K(g),b.Oi)){null!=f&&(f.j=2*b.Yg(6378137,.0066943799901413165));return}}if(b.xd(.0066943799901413165))t=Math.cos(e),u=Math.cos(d),null!=f&&(q=Math.sin((d-e)/2),l=Math.sin(g/2),m=2*Math.asin(Math.sqrt(q*q+t*u*l*l)),f.j=6378137*m);else{x=1-Math.sqrt(.9933056200098587);
c=1-x;k=Math.atan(c*Math.tan(e));e=Math.sin(k);k=Math.cos(k);n=Math.atan(c*Math.tan(d));d=Math.sin(n);n=Math.cos(n);y=p=g;L=0;C=1;z=g;for(w=!0;1==w;)L+=1,1==C&&(h=Math.sin(z),l=Math.cos(z),q=n*h,m=k*d-e*n*l,q=Math.sqrt(q*q+m*m),l=e*d+k*n*l,m=Math.atan2(q,l),A=1E-15>b.K(q)?k*n*h/b.Ab(1E-15,q):k*n*h/q,r=1-A*A,t=1E-15>b.K(r)?l-e*d/b.Ab(1E-15,r)*2:l-e*d/r*2,u=t*t,h=((-3*r+4)*x+4)*r*x/16),v=(1-h)*x*(m+h*q*(t+l*h*(2*u-1))),1==C?(z=g+v*A,1E-14>b.K(z-y)?w=!1:b.K(z)>b.Oi?(C=2,z=b.Oi,0>g&&(z=-z),A=0,r=1,p=
y=2,m=b.Oi-b.K(Math.atan(e/k)+Math.atan(d/n)),q=Math.sin(m),l=Math.cos(m),h=((-3*r+4)*x+4)*r*x/16,1E-14>b.K(A-p)?w=!1:(t=1E-15>b.K(r)?l-e*d/b.Ab(1E-15,r)*2:l-e*d/r*2,u=t*t)):(0>(z-y)*(y-p)&&5<L&&(z=(2*z+3*y+p)/6),p=y,y=z)):(A=(z-g)/v,0>(A-y)*(y-p)&&5<L&&(A=(2*A+3*y+p)/6),p=y,y=A,r=1-A*A,h=A*q/(k*n),l=-Math.sqrt(b.K(1-h*h)),z=Math.atan2(h,l),q=n*h,m=k*d-e*n*l,q=Math.sqrt(q*q+m*m),l=e*d+k*n*l,m=Math.atan2(q,l),h=((-3*r+4)*x+4)*r*x/16,1E-14>b.K(A-p)?w=!1:(t=1E-15>b.K(r)?l-e*d/b.Ab(1E-15,r)*2:l-e*d/r*
2,u=t*t));null!=f&&(A=Math.sqrt(1+(1/(c*c)-1)*r),A=(A-1)/(A+1),r=A*(1-.375*A*A),f.j=(1+A*A/4)/(1-A)*c*6378137*(m-r*q*(t+r/4*(l*(-1+2*u)-r/6*t*(-3+4*q*q)*(-3+4*u)))))}}};b.Oi=3.141592653589793;b.ss=1.5707963267948966;b.nA=6.283185307179586;b.hD=3.552713678800501E-15;return b}();a.qM=b})(x||(x={}));(function(a){var b=function(){return function(a){this.ve=a;this.kl=this.ve.getCode();0>this.kl&&(this.kl=0)}}();a.SZ=b;var c=function(){function c(a){void 0===a&&(a=null);this.Kh=null;this.nn=!1;null!==a&&
(this.Kh=new b(a))}c.prototype.Cc=function(){return null!=this.Kh?this.Kh.kl:0};c.prototype.Vf=function(){var a=new c;this.copyTo(a);return a};c.prototype.copyTo=function(a){a.Kh=this.Kh;a.nn=this.nn};c.prototype.Wv=function(){var a=this.Vf();a.kt();return a};c.prototype.kt=function(){this.nn=!this.nn};c.prototype.cn=function(){return null!=this.Kh?this.Kh.ve:null};c.prototype.BK=function(e){if(0>=e)throw a.g.F();if(e!=this.Cc()){e=a.Tf.geogtran(e);if(null==e)throw a.g.F("Geogtran not found.");this.Kh=
new b(e)}};c.prototype.mH=function(){return null==this.Kh?null:this.Kh.ve.toString()};c.prototype.getName=function(){if(null==this.Kh||null==this.Kh.ve)return"";var a="";this.nn&&(a+="~");return a+=this.Kh.ve.getName()};c.prototype.pY=function(e){if(null==e)throw a.g.F();var c=null;try{c=a.Tf.fromString(a.Vc.PE_TYPE_GEOGTRAN,e)}catch(n){throw a.g.F();}this.Kh=new b(c)};c.prototype.Eb=function(a){return a==this?!0:a instanceof c&&(!(0>=this.Cc()||this.Cc()!=a.Cc())||this.cn().isEqual(a.cn()))?this.nn==
a.nn:!1};c.prototype.toString=function(){var a=toString();return 200<a.length?a.substring(0,197)+"... ("+a.length.toString()+" characters)":a};c.create=function(a,b){var e=new c;e.BK(a);b&&e.kt();return e};c.gG=function(a,b){var e=new c;e.pY(a);b&&e.kt();return e};return c}();a.io=c})(x||(x={}));(function(a){var b=function(){function a(){}a.pa=function(b,c,d,k){var e=new a;e.vn=b;e.wn=c;e.MI=d;e.NI=k;return e};a.Hs=function(a,b){return a.vn==b.vn?a.wn==b.wn?0:a.wn<b.wn?-1:1:a.vn<b.vn?-1:1};return a}(),
c=function(){function c(){this.Hw=!1;this.OI=[];this.aB=[];this.jI=this.Hw=this.iI=!1;this.kq()}c.zo=function(){null==c.FG&&(c.FG=new c);return c.FG};c.c_=function(){return c.zo().Hw};c.f_=function(){return c.zo().jI};c.z_=function(a,b){if(a==b)return null;var e=c.zo();if(e.iI){var g=c.FA(e.aB,a,b);return null!=g?g:null}g=c.FA(e.aB,a,b);return null!=g?g:c.FA(e.OI,a,b)};c.gO=function(b,c,d,k,f){var e=a.ny.create();if(0<b)try{var g=a.io.create(b,c);if(0==g.Cc())return null;e.add(g);if(0<d){var n=a.io.create(d,
k);if(0==n.Cc())return null;e.add(n)}f&&(e=e.Wv())}catch(X){e=null}return e};c.FA=function(a,g,d){if(g==d||0==a.length)return null;for(var e=b.pa(g,d,0,0),k=!1,n=!1,f=0,p=0,h=-1,l=0;l<a.length;l++)if(0===b.Hs(e,a[l])){h=l;break}if(0>h||a[h].vn!=e.vn||a[h].wn!=e.wn){e=b.pa(d,g,0,0);g=-1;for(l=0;l<a.length;l++)if(0===b.Hs(e,a[l])){g=l;break}0<=g&&a[g].vn==e.vn&&a[g].wn==e.wn&&(f=a[g].MI,p=a[g].NI,n=k=!0)}else f=a[h].MI,p=a[h].NI,k=!1,n=!0;if(!n)return null;0==f&&(f=p,p=0);e=a=!1;0>f&&(f=-f,a=!0);0>
p&&(p=-p,e=!0);return c.gO(f,a,p,e,k)};c.prototype.kq=function(){this.CE(this.OI)&&(this.Hw=!0);this.CE(this.aB)&&(this.jI=!0);this.iI=!this.Hw};c.prototype.CE=function(a){try{for(var e=[],e=e.sort(b.Hs),c=0;c<e.length;c++)a.push(e[c])}catch(y){}return!0};c.Q_=function(){return null};return c}();a.RZ=c})(x||(x={}));(function(a){var b=function(){function a(){}a.prototype.My=function(a){this.Hi=a};a.prototype.OE=function(a){this.Mb=a};a.prototype.PE=function(a){this.np=a};a.KF=function(a){return a.u()||
1607!=a.G()&&1736!=a.G()?!1:!0};a.IF=function(a){return a.u()||1607!=a.G()&&1736!=a.G()||20>a.D()?!1:!0};a.JF=function(a){return a.u()||1607!=a.G()&&1736!=a.G()||20>a.D()?!1:!0};return a}();a.vl=b})(x||(x={}));(function(a){var b=function(){function b(){}b.nX=function(b){var e=new a.Ja;e.$x(b.R.o,b.R.A);e.Xj(b.R.o,b.R.B);e.Xj(b.R.v,b.R.B);e.Xj(b.R.v,b.R.A);return e};b.Xg=function(b,e){return null===b?null:a.os.local().V(b,e,null)};b.hZ=function(b,e){var c=a.ei.local();b=new a.hd(b);return c.V(b,e,
null).next()};b.Vm=function(b,e,c){return a.cq.local().V(b,e,c,null)};b.Pp=function(b,e,c){return a.uy.local().V(b,e,c,null)};b.PY=function(b,e,c){var g=a.uy.local();b=new a.hd(b);e=new a.hd(e);c=g.V(b,e,c,null);for(g=[];null!=(e=c.next());)g.push(e);return g};b.Eb=function(b,e,c){return a.Gj.local().V(3,b,e,c,null)};b.RR=function(b,e,c){return a.Gj.local().V(4,b,e,c,null)};b.MU=function(b,e,c){var g=a.tk.local();b=new a.hd(b);e=new a.hd(e);c=g.V(b,e,c,null);for(g=[];null!=(e=c.next());)g.push(e);
return g};b.OR=function(b,e,c){var g=a.cq.local();b=new a.hd(b);e=new a.hd(e);c=g.V(b,e,c,null);for(g=[];null!=(e=c.next());)g.push(e);return g};b.Ma=function(b,e,c){return a.tk.local().V(b,e,c,null)};b.sZ=function(b,e,c){return a.Gj.local().V(2,b,e,c,null)};b.contains=function(b,e,c){return a.Gj.local().V(1,b,e,c,null)};b.zR=function(b,e,c){return a.Gj.local().V(16,b,e,c,null)};b.touches=function(b,e,c){return a.Gj.local().V(8,b,e,c,null)};b.pW=function(b,e,c){return a.Gj.local().V(32,b,e,c,null)};
b.OU=function(b,e,c){return a.Gj.local().V(1073741824,b,e,c,null)};b.ZB=function(b,e,c,d){return a.qN.local().V(b,e,c,d,null)};b.Cb=function(b,e,c,d){var g=null;if(null!=c){if(g=c.Vd(),null!=d&&g.Cc()!=d.Cc()&&g.td!=d.td)throw a.g.yl();}else if(null!=d)throw a.g.F();b=a.iN.local().V(b,e,null);null!==g&&null!==d&&(b=a.kc.li(b,g,d));return b};b.clip=function(b,e,c){return a.cN.local().V(b,a.h.pa(e.R.o,e.R.A,e.R.v,e.R.B),c,null)};b.Hl=function(b,e,c){if(null==b||null==e)return null;b=a.eN.local().V(!0,
b,e,c,null);for(e=[];null!=(c=b.next());)c.u()||e.push(c);return e.slice(0)};b.RP=function(c,e,g,d,f,p,h,l){if(!0===f)return b.ZM(c,e,g,d,p,h,l);f=g;if(null!=e){if(h=e.Vd(),null!=d&&h.Cc()!=d.Cc()){if(h.td!=d.td)throw a.g.yl();f=[];a.kc.eG(g,g.length,d,h,f)}}else if(null!=d)throw a.g.F();g=a.DD.local();if(p){c=new a.hd(c);e=g.V(c,e,f,p,null);for(c=[];null!=(p=e.next());)c.push(p);p=c.slice(0)}else for(p=[],d=0;d<c.length;d++)p[d]=g.V(c[d],e,f[d],null);return p};b.ZM=function(b,e,c,d,f,p,h){if(null===
e)throw a.g.F();if(null===d||void 0===d)d=4326!==e.Cc()?e.Vd():a.kc.pe(9001);if(0!==d.td)throw a.g.F();a.kc.eG(c,c.length,d,a.kc.pe(9001),c);d=a.JD.local();if(f){b=new a.hd(b);e=d.V(b,e,p,c,h,!1,f,null);for(c=[];null!=(p=e.next());)c.push(p);f=c.slice(0)}else{f=[];for(var g=0;g<b.length;g++)f[g]=d.V(b[g],e,p,c[g],h,!1,null)}return f};b.buffer=function(b,e,c,d,f,p,h){var g=c;if(!1===f){if(null!=e){if(f=e.Vd(),null!=d&&f.Cc()!=d.Cc()){if(f.td!=d.td)throw a.g.yl();g=a.kc.li(c,d,f)}}else if(null!=d)throw a.g.F();
b=a.DD.local().V(b,e,g,null)}else{if(null===e)throw a.g.F();if(null===d||void 0===d)d=4326!==e.Cc()?e.Vd():a.kc.pe(9001);if(0!==d.td)throw a.g.F();g=a.kc.li(c,d,a.kc.pe(9001));b=a.JD.local().V(b,e,p,g,h,!1,null)}return b};b.nW=function(b,e,c,d,f,p,h){if(null!=e){var g=e.Vd();if(null!=h&&g.Cc()!=h.Cc()){if(g.td!=h.td)throw a.g.yl();c=a.kc.li(c,h,g)}}else if(null!=h)throw a.g.F();b=new a.hd(b);e=a.MD.local().V(b,e,c,d,f,p,null);for(c=[];null!=(d=e.next());)c.push(d);return c.slice(0)};b.offset=function(b,
e,c,d,f,p,h){if(null!=e){var g=e.Vd();if(null!=h&&g.Cc()!=h.Cc()){if(g.td!=h.td)throw a.g.yl();c=a.kc.li(c,h,g)}}else if(null!=h)throw a.g.F();return a.MD.local().V(b,e,c,d,f,p,null)};b.iR=function(b){return a.FD.local().V(b,null)};b.jR=function(b,e){var c=a.FD.local();b=new a.hd(b);c=c.V(b,e,null);for(b=[];null!=(e=c.next());)b.push(e);return b};b.$z=function(b,e,c){return a.sy.local().$z(b,e,c)};b.aA=function(b,e){return a.sy.local().aA(b,e)};b.bA=function(b,e,c,d){return a.sy.local().bA(b,e,c,
d)};b.DC=function(b,e){return a.Km.local().V(b,e,!1,null)};b.ZU=function(b,e){return a.Km.local().Wq(b,e,null)};b.HS=function(b,e,c,d,f){var g=a.HD.local();if(null!=e){if(e=e.Vd(),null!=f&&e.Cc()!=f.Cc()){if(e.td!=f.td)throw a.g.yl();c=a.kc.li(c,f,e)}}else if(null!=f)throw a.g.F();return g.V(b,c,d,null)};b.Ls=function(b,e,c,d){var g=a.Jm.local();if(null!=e){if(e=e.Vd(),null!=d&&e.Cc()!=d.Cc()){if(e.td!=d.td)throw a.g.yl();c=a.kc.li(c,d,e)}}else if(null!=d)throw a.g.F();return g.V(b,c,null)};b.Fz=
function(b,e,c,d,f){void 0===f&&(f=0);var g=a.kN.local();if(4==f)throw a.g.df();if(0!==f)throw a.g.df();if(null!==d){if(0!==d.td)throw a.g.F("Unit must be a linear unit type");c=a.kc.li(c,d,a.kc.pe(9001))}return g.V(b,c,e,f,null)};b.NS=function(c,e,g,d){if(null===c)return 0;if(4==d)throw a.g.df();if(0!==d)throw a.g.df();if(197==c.G())c=b.nX(c);else if(1736!=c.G())return 0;d=a.fb.lc(e);c=a.fb.Xg(c,e,d,null);c=a.rM.OS([c])[0];if(null!==g){if(2!==g.td)throw a.g.F("Unit must be a area unit type");c=a.kc.li(c,
a.kc.pe(109404),g)}return c};b.RS=function(b,e,c,d){b=a.mN.local().V(b,e,d,null);if(null!==c){if(0!==c.td)throw a.g.F("Unit must be a linear unit type");b=a.kc.li(b,a.kc.pe(9001),c)}return b};b.xW=function(b,e,c){if(null===b)return 0;var g=null;if(null!=e){g=e.Vd();if(0==g.td&&(g=a.kc.lH(g),null==g&&null!==c))throw a.g.F();if(null!=c&&g.Cc()!=c.Cc()&&g.td!=c.td)throw a.g.yl();}else if(null!=c)throw a.g.F();return 1736==b.G()||197==b.G()?(b=b.hf(),null!==c?a.kc.li(b,g,c):b):0};b.yW=function(b,e,c){if(null===
b||b.u()||1>b.tb())return 0;var g=null;if(null!=e){if(g=e.Vd(),null!=c&&g.Cc()!=c.Cc()&&g.td!=c.td)throw a.g.yl();}else if(null!=c)throw a.g.F();1736==b.G()||197==b.G()?e=b.Gg():a.T.Oc(b.G())?(e=new a.Ua(b.description),e.dc(b,!0)):e=b;b=0;e=e.Fa();for(var d=new a.b,k=new a.b;e.Ya();)for(;e.Ea();){var f=e.ba();f.Oq(d);f.Ps(k);b+=a.b.Cb(d,k)}null!==g&&null!==c&&(b=a.kc.li(b,g,c));return b};b.$Z=function(b,e){return a.Rd.QS(b,e)};b.dG=function(a){return void 0!==a.points?b.lW(a,void 0===a.hasZ?!1:a.hasZ,
void 0===a.hasM?!1:a.hasM):void 0!==a.rings?b.wH(a.rings,void 0===a.hasZ?!1:a.hasZ,void 0===a.hasM?!1:a.hasM,"P"):void 0!==a.paths?b.wH(a.paths,void 0===a.hasZ?!1:a.hasZ,void 0===a.hasM?!1:a.hasM,"L"):void 0!==a.x?b.vW(a):void 0!==a.xmin?b.dW(a):null};b.vW=function(b){if(null==b.x||"NaN"==b.x)return new a.Wa;var e=new a.Wa(b.x,b.y);void 0!==b.z&&null!==b.z&&e.sY(b.z);void 0!==b.m&&null!==b.m&&e.cY(b.m);return e};b.dW=function(b){if(null==b.xmin||"NaN"==b.xmin)return new a.ci;var e=new a.ci(b.xmin,
b.ymin,b.xmax,b.ymax);void 0!==b.zmin&&null!==b.zmin&&e.setInterval(1,0,b.zmin,b.zmax);void 0!==b.mmin&&null!==b.mmin&&e.setInterval(2,0,b.mmin,b.mmax);return e};b.lW=function(b,e,c){var g=0,d=new a.Ed,k=3*b.points.length;0!=k%2&&k++;2>k&&(k=2);var f=a.J.truncate(3*b.points.length/2);4>f?f=4:16>f&&(f=16);for(var k=a.Uc.Um(k,0),p=a.Uc.Um(f),f=a.Uc.Um(f),h=0;h<b.points.length;h++)k.write(2*h,b.points[h][0]),k.write(2*h+1,b.points[h][1]),p.write(h,e||c?b.points[h][2]:NaN),f.write(h,c&&e?b.points[h][3]:
NaN),g++;0!=g&&(d.resize(g),d.Yn(0,k));e&&(d.Td(1),d.Yn(1,p));c&&(d.Td(2),d.Yn(2,0==e?p:f));d.Dc(16777215);return d};b.wH=function(b,e,c,d){var g,k=0,n=2;"P"==d?(g=new a.Ja,k=1,n=3):g=new a.Ua;for(var f=a.Uc.wh(0),p=a.Uc.vq(0),h=0,l=0,m=[],q=[],r=0;r<b.length;r++){var A=b[r].length;m[r]=!1;if("P"===d&&b[r][0][0]===b[r][b[r].length-1][0]&&b[r][0][1]===b[r][b[r].length-1][1]){var t=0==c?!0:b[r][0][3]===b[r][b[r].length-1][3]||void 0===b[r][0][3]&&void 0===b[r][b[r].length-1][3];(0==e||b[r][0][2]===
b[r][b[r].length-1][2]||void 0===b[r][0][2]&&void 0===b[r][b[r].length-1][2])&&t&&(m[r]=!0,--A)}A>=n?(q[r]=!1,l+=1,f.add(h),p.add(k),h+=A):q[r]=!0}d=3*h;0!=d%2&&d++;2>d&&(d=2);r=a.J.truncate(3*h/2);4>r?r=4:16>r&&(r=16);d=a.Uc.Um(d,0);k=a.Uc.Um(r);n=a.Uc.Um(r);for(r=A=0;r<b.length;r++)if(!1===q[r])for(t=0;t<b[r].length;t++){var u=!1;t===b[r].length-1&&!0===m[r]&&(u=!0);u||(d.write(2*A,b[r][t][0]),d.write(2*A+1,b[r][t][1]),k.write(A,e||c?b[r][t][2]:NaN),n.write(A,c&&e?b[r][t][3]:NaN),A++)}0!=h&&(b=
g,f.resize(l),p.resize(l),0<h&&(f.add(h),p.add(0)),b.Yn(0,d),b.GK(p),b.HK(f));e&&(g.Td(1),g.Yn(1,k));c&&(g.Td(2),g.Yn(2,0==e?k:n));g.Dc(16777215);return g};return b}();a.cc=b})(x||(x={}));(function(a){var b=function(){function a(){}a.Hm=function(a){var b=0,c,d=a.length,k=a[0],f;for(c=0;c<d-1;c++)f=a[c+1],b+=(f[0]-k[0])*(f[1]+k[1]),k=f;return 0<=b};a.rotate=function(b,e,c){e=e*Math.PI/180;var g=Math.cos(e),d=Math.sin(e);if(void 0!==b.paths){e={paths:[]};for(var k=0;k<b.paths.length;k++){for(var f=
b.paths[k],p=[],h=0;h<f.length;h++){var l=f[h].slice(0);p.push(l);var m=g*(f[h][0]-c.x)-d*(f[h][1]-c.y)+c.x,q=d*(f[h][0]-c.x)+g*(f[h][1]-c.y)+c.y;l[0]=m;l[1]=q}e.paths.push(p)}return e}if(void 0!==b.rings){e={rings:[]};for(k=0;k<b.rings.length;k++){for(var f=b.rings[k],p=[],r=a.Hm(f),h=0;h<f.length;h++)l=f[h].slice(0),p.push(l),m=g*(f[h][0]-c.x)-d*(f[h][1]-c.y)+c.x,q=d*(f[h][0]-c.x)+g*(f[h][1]-c.y)+c.y,l[0]=m,l[1]=q;a.Hm(p)!==r&&p.reverse();e.rings.push(p)}return e}if(void 0!==b.x)return e={x:g*(b.x-
c.x)-d*(b.y-c.y)+c.x,y:d*(b.x-c.x)+g*(b.y-c.y)+c.y},void 0!==b.z&&(e.z=b.z),void 0!==b.m&&(e.m=b.m),e;if(void 0!==b.points){e={points:[]};b=b.points;for(h=0;h<b.length;h++)k=b[h].slice(0),k[0]=g*(b[h][0]-c.x)-d*(b[h][1]-c.y)+c.x,k[1]=d*(b[h][0]-c.x)+g*(b[h][1]-c.y)+c.y,e.points.push(k);return e}return null};a.zG=function(b,e){var c,d;if(void 0!==b.paths){c={paths:[]};for(var k=0;k<b.paths.length;k++){for(var f=b.paths[k],p=[],h=0;h<f.length;h++){var l=f[h].slice(0);p.push(l);d=e.x-f[h][0];l[0]=f[h][0]+
2*d}c.paths.push(p)}return c}if(void 0!==b.rings){c={rings:[]};for(k=0;k<b.rings.length;k++){for(var f=b.rings[k],m=a.Hm(f),p=[],h=0;h<f.length;h++)l=f[h].slice(0),p.push(l),d=e.x-f[h][0],l[0]=f[h][0]+2*d;a.Hm(p)!==m&&p.reverse();c.rings.push(p)}return c}if(void 0!==b.x)return d=e.x-b.x,c={x:b.x+2*d,y:b.y},void 0!==b.z&&(c.z=b.z),void 0!==b.m&&(c.m=b.m),c;if(void 0!==b.points){c={points:[]};k=b.points;for(h=0;h<k.length;h++)f=k[h].slice(0),d=e.x-f[0],f[0]+=2*d,c.points.push(f);return c}return void 0!==
b.xmin?(c={o:b.xmin,A:b.ymin,v:b.xmax,B:b.ymax},void 0!==b.zmin&&(c.zmin=b.zmin,c.zmax=b.zmax),void 0!==b.mmin&&(c.mmin=b.mmin,c.mmax=b.mmax),d=e.x-b.xmin,c.xmax=b.xmin+2*d,d=e.x-b.xmax,c.xmin=b.xmax+2*d,c):null};a.AG=function(b,e){var c,d;if(void 0!==b.paths){c={paths:[]};for(var k=0;k<b.paths.length;k++){for(var f=b.paths[k],p=[],h=0;h<f.length;h++){var l=f[h].slice(0);p.push(l);d=e.y-f[h][1];l[1]=f[h][1]+2*d}c.paths.push(p)}return c}if(void 0!==b.rings){c={rings:[]};for(k=0;k<b.rings.length;k++){for(var f=
b.rings[k],m=a.Hm(f),p=[],h=0;h<f.length;h++)l=f[h].slice(0),p.push(l),d=e.y-f[h][1],l[1]=f[h][1]+2*d;a.Hm(p)!==m&&p.reverse();c.rings.push(p)}return c}if(void 0!==b.x)return d=e.y-b.y,c={y:b.y+2*d,x:b.x},void 0!==b.z&&(c.z=b.z),void 0!==b.m&&(c.m=b.m),c;if(void 0!==b.points){c={points:[]};k=b.points;for(h=0;h<k.length;h++)f=k[h].slice(0),d=e.y-f[1],f[1]+=2*d,c.points.push(f);return c}return void 0!==b.xmin?(c={o:b.xmin,A:b.ymin,v:b.xmax,B:b.ymax},void 0!==b.zmin&&(c.zmin=b.zmin,c.zmax=b.zmax),void 0!==
b.mmin&&(c.mmin=b.mmin,c.mmax=b.mmax),d=e.y-b.ymin,c.ymax=b.ymin+2*d,d=e.y-b.ymax,c.ymin=b.ymax+2*d,c):null};return a}();a.Wp=b})(x||(x={}));(function(a){var b=function(){function b(){}b.bh=function(b,e){null==e&&(e=a.ze.Ig());switch(b){case 33:return new a.Wa(e);case 322:return new a.Hb(e);case 197:return new a.ci(e);case 550:return new a.Ed(e);case 1607:return new a.Ua(e);case 1736:return new a.Ja(e);default:throw a.g.X("invalid argument.");}};return b}();a.vM=b})(x||(x={}));(function(a){var b=
function(){function b(b,e){this.tf=a.ia.zd(b,-1);this.va=new a.Lu;this.bm=e}b.prototype.yX=function(a){this.va.pu(Math.min(this.tf.size,a));this.va.Vn(a)};b.prototype.addElement=function(b,e){if(void 0===e)return this.dP(b);e=a.J.truncate(e%this.tf.size);var c=this.tf.get(e);-1==c&&(c=this.va.mi(),this.tf.set(e,c));return this.va.addElement(c,b)};b.prototype.dP=function(b){var e=this.bm.Wz(b),e=a.J.truncate(e%this.tf.size),c=this.tf.get(e);-1==c&&(c=this.va.mi(),this.tf.set(e,c));return this.va.addElement(c,
b)};b.prototype.kd=function(b,e){if(void 0===e)this.HR(b);else{e=a.J.truncate(e%this.tf.size);var c=this.tf.get(e);if(-1==c)throw a.g.F();for(var d=this.va.xc(c),k=-1;-1!=d;){var f=this.va.nb(d);this.va.ja(d)==b?(this.va.kd(c,k,d),-1==this.va.xc(c)&&(this.va.zh(c),this.tf.set(e,-1))):k=d;d=f}}};b.prototype.HR=function(b){var e=this.bm.Wz(b),e=a.J.truncate(e%this.tf.size),c=this.tf.get(e);if(-1==c)throw a.g.F();for(var d=this.va.xc(c),k=-1;-1!=d;){var f=this.va.nb(d);this.va.ja(d)==b?(this.va.kd(c,
k,d),-1==this.va.xc(c)&&(this.va.zh(c),this.tf.set(e,-1))):k=d;d=f}};b.prototype.iT=function(b){b=a.J.truncate(b%this.tf.size);b=this.tf.get(b);return-1==b?-1:this.va.xc(b)};b.prototype.yT=function(a){return this.va.nb(a)};b.prototype.Kd=function(b){var e=this.bm.Wz(this.ja(b)),e=a.J.truncate(e%this.tf.size),c=this.tf.get(e);if(-1==c)throw a.g.F();for(var d=this.va.xc(c),k=-1;-1!=d;){if(d==b){this.va.kd(c,k,d);-1==this.va.xc(c)&&(this.va.zh(c),this.tf.set(e,-1));return}k=d;d=this.va.nb(d)}throw a.g.F();
};b.prototype.ja=function(a){return this.va.ja(a)};b.prototype.clear=function(){this.tf=a.ia.zd(this.tf.size,-1);this.va.clear()};b.prototype.size=function(){return this.va.eH()};return b}();a.FM=b})(x||(x={}));(function(a){var b=function(){function b(){this.kj=new a.ad(3);this.va=new a.ad(6);this.tV=!1;this.Ge=-1}b.prototype.Kl=function(a){this.kj.kd(a)};b.prototype.Bx=function(){return this.kj.Pe()};b.prototype.Pv=function(a){this.va.kd(a)};b.prototype.GB=function(){return this.va.Pe()};b.prototype.vC=
function(a,b){this.kj.P(a,1,b)};b.prototype.Qx=function(a,b){this.kj.P(a,2,b)};b.prototype.bY=function(a,b){this.kj.P(a,3,b)};b.prototype.tC=function(a,b){this.va.P(a,4,b)};b.prototype.eY=function(a,b){this.va.P(a,3,b)};b.prototype.KK=function(a,b){this.va.P(a,2,b)};b.prototype.mi=function(a){var b=this.GB();this.va.P(b,3,this.Ge);this.va.P(b,4,0);this.va.P(b,5,a);-1!=this.Ge&&this.KK(this.Ge,b);return this.Ge=b};b.prototype.zh=function(a){this.RF(a);var b=this.va.S(a,2),c=this.va.S(a,3);-1!=b?this.eY(b,
c):this.Ge=c;-1!=c&&this.KK(c,b);this.Pv(a);return c};b.prototype.pu=function(a){this.va.Qe(a)};b.prototype.$G=function(a){return this.va.S(a,5)};b.prototype.aY=function(a,b){this.va.P(a,5,b)};b.prototype.addElement=function(a,b){return this.pU(a,b)};b.prototype.pU=function(a,b){var e=this.Bx();this.Qx(e,-1);-1==this.va.S(a,0)&&this.va.P(a,0,e);var c=this.va.S(a,1);this.vC(e,c);-1!=c&&this.Qx(c,e);this.va.P(a,1,e);this.setData(e,b);this.tC(a,this.at(a)+1);this.tV&&this.bY(e,a);return e};b.prototype.kd=
function(a,b){var e=this.Ve(b),c=this.nb(b);-1!=e?this.Qx(e,c):this.va.P(a,0,c);-1!=c?this.vC(c,e):this.va.P(a,1,e);this.Kl(b);this.tC(a,this.at(a)-1);return c};b.prototype.Vn=function(a){this.kj.Qe(a)};b.prototype.getData=function(a){return this.kj.S(a,0)};b.prototype.setData=function(a,b){this.kj.P(a,0,b)};b.prototype.nb=function(a){return this.kj.S(a,2)};b.prototype.Ve=function(a){return this.kj.S(a,1)};b.prototype.xc=function(a){return this.va.S(a,0)};b.prototype.Fc=function(a){return this.va.S(a,
1)};b.prototype.clear=function(){for(var a=this.Ge;-1!=a;)a=this.zh(a)};b.prototype.RF=function(a){for(var b=this.Fc(a);-1!=b;){var c=b,b=this.Ve(c);this.Kl(c)}this.va.P(a,0,-1);this.va.P(a,1,-1);this.tC(a,0)};b.prototype.u=function(){return 0==this.kj.size};b.prototype.eH=function(){return this.kj.size};b.prototype.at=function(a){return this.va.S(a,4)};b.prototype.cA=function(a){return this.va.S(a,3)};return b}();a.Xp=b})(x||(x={}));(function(a){var b=function(){function b(b){void 0===b?(this.Qg=
new a.ad(2),this.va=new a.ad(4),this.Ge=-1,this.Cw=!0):(this.Qg=new a.ad(2),this.va=new a.ad(b?4:2),this.Ge=-1,this.Cw=b)}b.prototype.Kl=function(a){this.Qg.kd(a)};b.prototype.Bx=function(){return this.Qg.Pe()};b.prototype.Pv=function(a){this.va.kd(a)};b.prototype.GB=function(){return this.va.Pe()};b.prototype.mi=function(){var a=this.GB();this.Cw&&(this.va.P(a,3,this.Ge),-1!=this.Ge&&this.va.P(this.Ge,2,a),this.Ge=a);return a};b.prototype.zh=function(a){for(var b=this.xc(a);-1!=b;){var c=b,b=this.nb(b);
this.Kl(c)}this.Cw&&(b=this.va.S(a,2),c=this.va.S(a,3),-1!=b?this.va.P(b,3,c):this.Ge=c,-1!=c&&this.va.P(c,2,b));this.Pv(a)};b.prototype.pu=function(a){this.va.Qe(a)};b.prototype.addElement=function(a,b){var e=this.va.S(a,1),c=this.Bx();-1!=e?this.Qg.P(e,1,c):this.va.P(a,0,c);this.va.P(a,1,c);this.Qg.P(c,0,b);return c};b.prototype.Vn=function(a){this.Qg.Qe(a)};b.prototype.kd=function(a,b,c){-1!=b?(this.Qg.P(b,1,this.Qg.S(c,1)),this.va.S(a,1)==c&&this.va.P(a,1,b)):(this.va.P(a,0,this.Qg.S(c,1)),this.va.S(a,
1)==c&&this.va.P(a,1,-1));this.Kl(c)};b.prototype.mz=function(a,b){var e=this.va.S(a,1),c=this.va.S(b,0);-1!=c&&(-1!=e?this.Qg.P(e,1,c):this.va.P(a,0,c),this.va.P(a,1,this.va.S(b,1)));this.Cw&&(e=this.va.S(b,2),c=this.va.S(b,3),-1!=e?this.va.P(e,3,c):this.Ge=c,-1!=c&&this.va.P(c,2,e));this.Pv(b)};b.prototype.ja=function(a){return this.Qg.S(a,0)};b.prototype.kk=function(a,b){this.Qg.P(a,0,b)};b.prototype.nb=function(a){return this.Qg.S(a,1)};b.prototype.xc=function(a){return this.va.S(a,0)};b.prototype.yo=
function(a){return this.ja(this.xc(a))};b.prototype.clear=function(){this.Qg.Vi(!0);this.va.Vi(!0);this.Ge=-1};b.prototype.u=function(a){return void 0===a?0==this.Qg.size:-1==this.va.S(a,0)};b.prototype.eH=function(){return this.Qg.size};b.prototype.cA=function(a){return this.va.S(a,3)};return b}();a.Lu=b})(x||(x={}));(function(a){var b=function(){function b(){}b.$D=function(c,e,d,n,f,p,h){var g=new a.b;g.L(c);c=new a.b;c.L(e);f.Ny(g);f.Ny(c);e=f.Wu(g);var k=f.Wu(c);0==k&&(k=f.ZG());if(g.x!=c.x&&
(g.y!=c.y||g.y!=f.A&&g.y!=f.B)||k>e!=p){e=f.AE(g);var k=f.AE(c),y,B=p?1:3;do e=e+B&3,y=f.Gx(e),0!=h&&(n=b.$D(g,y,d,n,f,p,h)),d[n++].ka(y.x,y.y),g=y;while((e&3)!=k);0!=h&&(n=b.$D(g,c,d,n,f,p,h))}else if(f=new a.b,f.ka(c.x-g.x,c.y-g.y),0!=h&&(h=a.J.truncate(f.SO()/h),0<h))for(f.scale(1/(h+1)),p=0;p<h;p++)g.add(f),d[n++].ka(g.x,g.y);return n};b.be=function(a,b,c){b=b.no();a=null!=a&&void 0!==a.se?a.se(0):0;c&&(b*=4,a*=1.1);return Math.max(a,b)};b.Cs=function(a){return 2*Math.sqrt(2)*a};b.sP=function(a){return Math.sqrt(2)*
a};b.ah=function(c,e,d){var g=new a.h;e.s(g);return b.be(c,g,d)};b.GF=function(a,b,c){b=b.xf(1,0).no();a=null!=a?a.se(1):0;c&&(b*=4,a*=1.1);return Math.max(a,b)};b.a_=function(b,e){var c=new a.h;b.ac(c);c.Nb(e);return c};b.Zv=function(b,e){var c=new a.h;b.ac(c);b=new a.h;e.ac(b);c.Nb(b);return c};b.j_=function(b,e){var c=b.nT(e),d=b.wa(e),k=b.Gc(e),f=b.Ba(c);c==d?(k=b.Ba(k-1),c=b.Ba(d+1)):c==k-1?(k=b.Ba(c-1),c=b.Ba(d)):(k=b.Ba(c-1),c=b.Ba(c+1));f=a.b.zp(k,f,c);return 0==f?0<b.Sm(e):-1==f};b.bQ=function(b){var e=
new a.h;b.ac(e);if(e.u())return null;var c=new a.gq(e,8),d=-1,k=new a.h,f=!1;do for(var p=0,h=b.aa();p<h;p++)if(b.jk(p,k),d=c.lw(p,k,d),-1==d){if(f)throw a.g.X("internal error");b.uo(e,!1);f=!0;c.reset(e,8);break}else f=!1;while(f);return c};b.BF=function(b){var e=new a.h;b.ac(e);for(var c=new a.gq(e,8),d=-1,k=b.Fa(),f=new a.h,p=!1;k.Ya();)for(;k.Ea();){var h=k.ba(),l=k.Db();h.s(f);d=c.lw(l,f,d);if(-1==d){if(p)throw a.g.za();b.uo(e,!1);p=!0;c.reset(e,8);k.yj();break}}return c};b.Lj=function(b,e){var c=
new a.h;b.ac(c);for(var d=new a.gq(c,8),k=-1,f=new a.h,p=b.Fa(),h=!1;p.Ya();)for(;p.Ea();){var l=p.ba(),m=p.Db();l.s(f);if(f.Yb(e)&&(k=d.lw(m,f,k),-1==k)){if(h)throw a.g.X("internal error.");b.uo(c,!1);h=!0;d.reset(c,8);p.yj();break}}return d};b.S_=function(b){var e=new a.h;b.ac(e);for(var c=new a.gq(e,8),d=new a.b,k=new a.h,f=!1,p=0;p<b.D();p++)if(b.w(p,d),k.I(d),-1==c.eh(p,k)){if(f)throw a.g.za();b.uo(e,!1);f=!0;c.reset(e,8);p=-1}return c};b.CF=function(b,e){for(var c=new a.gq(e,8),d=new a.b,k=
!1,f=new a.h,p=0;p<b.D();p++)if(b.w(p,d),e.contains(d)&&(f.I(d),-1==c.eh(p,f))){if(k)throw a.g.za();k=!0;p=new a.h;b.uo(p,!1);c.reset(p,8);p=-1}return c};b.dT=function(b,e,c){var d=new a.h,g=new a.h;b.ac(d);e.ac(g);d.O(c,c);g.O(c,c);var k=new a.h;k.I(d);k.Ma(g);b=b.Fa();e=e.Fa();var f=new a.gD;f.zC(c);var p=!1;for(f.bL();b.Ya();)for(;b.Ea();)b.ba().s(d),d.Yb(k)&&(p=!0,c=new a.h,c.I(d),f.$E(b.Db(),c));f.uG();if(!p)return null;d=!1;for(f.aL();e.Ya();)for(;e.Ea();)e.ba().s(g),g.Yb(k)&&(d=!0,c=new a.h,
c.I(g),f.WE(e.Db(),c));f.tG();return d?f:null};b.eT=function(b,e,c,d,f){var g=b.G(),k=e.G(),n=new a.h,p=new a.h;b.ac(n);e.ac(p);n.O(c,c);p.O(c,c);var y=new a.h;y.I(n);y.Ma(p);var h=new a.gD;h.zC(c);var l=!1;h.bL();var m=0;for(c=b.aa();m<c;m++)if(!d||1736!=g||b.rw(m))b.jk(m,n),n.Yb(y)&&(l=!0,h.$E(m,n));h.uG();if(!l)return null;b=!1;h.aL();d=0;for(c=e.aa();d<c;d++)if(!f||1736!=k||e.rw(d))e.jk(d,p),p.Yb(y)&&(b=!0,h.WE(d,p));h.tG();return b?h:null};b.o_=function(a,b){return 0<a.Kk(b)};b.R_=function(b,
e){var c=new a.h;b.iX(e,c);var c=new a.gq(c,8),d=-1,k=new a.h;b=b.Fa();b.fC(e);if(b.Ya())for(;b.Ea();){e=b.ba();var f=b.Db();e.ac(k);d=c.lw(f,k,d);if(-1==d)throw a.g.X("internal error");}return c};b.Fv=function(b,e,c){if(b!=e)for(var d=0;d<c;d++)null==b[d]?b[d]=a.b.El(e[d]):b[d].L(e[d])};b.oz=function(a,b,c,d){var e=0;for(d+=0;e<d;c++,e++)null==a[e]&&(a[e]=[0,0]),a[e][0]=b[c].x,a[e][1]=b[c].y};b.nz=function(b,e,c,d){var g=e,k=0;for(e=d+e;g<e;k++,g++)null==b[g]?b[g]=a.b.pa(c[k][0],c[k][1]):b[g].ka(c[k][0],
c[k][1])};b.kR=function(b,e,c){if(b!=e)for(var d=0;d<c;d++)null==b[d]?b[d]=new a.Wa(e[d]):e[d].copyTo(b[d])};b.FP=function(a,b,c,d){var e=d.ca;d=d.ha;for(var g=0;g<b;g+=c){var k=a.read(g);k<e?a.write(g,e):k>d&&a.write(g,d)}};b.vP=function(a,b,c,d){var e=d.ca;d=d.ha;for(var g=0;g<b;g+=c){var k=a.read(g);k<e?a.write(g,e):k>d&&a.write(g,d)}};b.UK=function(c,e,d){if(c.hasAttribute(d)){var g=c.G();if(a.T.gh(g)){var k=a.ma.si(d),g=a.ma.Xa(d),f=c.D();if(1==k){c=c.Pa(d);b.FP(c,f*g,g,e);return}if(2==k){c=
c.Pa(d);b.vP(c,f*g,g,e);return}throw a.g.X("snap_coordinate not implemented");}if(197==g)f=c.xf(d,0),g=!1,f.ca<e.ca&&(g=!0,f.ca=e.ca),f.ha>e.ha&&(g=!0,f.ha=e.ha),g&&c.setInterval(d,0,f);else if(33==g)f=c.Yc(d,0),g=!1,f<e.ca&&(g=!0,f=e.ca),f>e.ha&&(g=!0,f=e.ha),g&&c.setAttribute(d,0,f);else if(a.T.Oc(g))f=c.dt(d,0),g=!1,f<e.ca&&(g=!0,f=e.ca),f>e.ha&&(g=!0,f=e.ha),g&&c.Tx(d,0,f),f=c.Os(d,0),f<e.ca&&(g=!0,f=e.ca),f>e.ha&&(g=!0,f=e.ha),g&&c.Lx(d,0,f);else throw a.g.X("snap_coordinate not implemented");
}};b.jo=function(a,b,c,d,f){var e=0;null!=b&&(e=b.se(a),f&&!d||null==b||(e+=1.01*b.gA(a)));d&&(c*=4,e*=1.01);return Math.max(e,c)};b.T_=function(c,e,d,f){e=a.h.DO(e.Be(),e.nf(),d.Be(),d.nf());return b.jo(0,c,e,f,!1)};b.Zy=function(a,e,c){e=e.no();return b.jo(0,a,e,c,!1)};b.U_=function(a,e,c){e=e.no();return b.jo(1,a,e,c,!1)};b.hQ=function(c,e){var d=new a.h;e.s(d);return b.Zy(c,d,!0)};b.$y=function(a,e){e=e.no();return b.jo(0,a,e,!1,!0)};b.V_=function(a,e,c){e=e.no();return b.jo(1,a,e,c,!0)};b.vv=
function(c,e){var d=new a.h;e.s(d);return b.$y(c,d)};b.NH=function(b,e,c,d){d*=d;var g=new a.b;g.yc(b,e);b=new a.b;b.yc(c,e);e=g.qk();c=b.qk();if(e<=d&&c<=d)return!0;var k=a.Ub.Yx(g.Ui(b));return k<=d*e||k<=d*c?0<=g.oi(b):!1};b.VK=function(b,e,c,d){for(var g=0;g<e;g++){var k=b[g].y,f=a.J.pk(k,c,d);f!=k&&(b[g].y=f)}};return b}();a.na=b})(x||(x={}));(function(a){var b=function(){function a(a){this.ab=a}a.prototype.compare=function(a,b,e){a=a.ja(e);e=this.ab.Ok(b);var c=this.ab.Ok(a);return e<c?-1:e==
c?g.Vq(b)&&g.tw(a)?-1:g.Vq(a)&&g.tw(b)?1:0:1};return a}(),c=function(){function a(a){this.ab=a}a.prototype.hs=function(a,b,e){this.ab.BY(e,a,b)};a.prototype.Qq=function(a){return this.ab.Ok(a)};return a}(),d;(function(a){a[a.initialize=0]="initialize";a[a.pIn=1]="pIn";a[a.pL=2]="pL";a[a.pR=3]="pR";a[a.pT=4]="pT";a[a.right=5]="right";a[a.left=6]="left";a[a.all=7]="all"})(d||(d={}));var e=function(){function b(){this.ab=null;this.pj=new a.zc;this.oh=new a.ia(0);this.Og=[0,0]}b.prototype.Ni=function(a,
b){this.pj.ca=a.ca-b;this.pj.ha=a.ha+b;this.oh.resize(0);this.Ee=0;this.Og[0]=0};b.prototype.eC=function(b,e,c){if(b>e)throw a.g.F();this.pj.ca=b-c;this.pj.ha=e+c;this.oh.resize(0);this.Ee=0;this.Og[0]=0};b.prototype.Wn=function(a,b){this.pj.ca=a-b;this.pj.ha=a+b;this.oh.resize(0);this.Ee=0;this.Og[0]=0};b.prototype.next=function(){if(!this.ab.ar)throw a.g.Da();if(0>this.Ee)return-1;for(var b=!0;b;)switch(this.Og[this.Ee]){case 1:b=this.qW();break;case 2:b=this.rW();break;case 3:b=this.sW();break;
case 4:b=this.tW();break;case 5:b=this.DX();break;case 6:b=this.mV();break;case 7:b=this.wP();break;case 0:b=this.rA();break;default:throw a.g.za();}return-1!=this.jh?this.Gq()>>1:-1};b.CZ=function(a,e,c){var d=new b;d.ab=a;d.oh.yb(20);d.Ni(e,c);return d};b.DZ=function(a,e,c){var d=new b;d.ab=a;d.oh.yb(20);d.Wn(e,c);return d};b.pa=function(a){var e=new b;e.ab=a;e.oh.yb(20);e.Ee=-1;return e};b.prototype.rA=function(){this.jh=this.HI=this.lj=this.Sc=-1;if(null!=this.ab.Je&&0<this.ab.Je.size)return this.Og[0]=
1,this.lj=this.ab.Mf,!0;this.Ee=-1;return!1};b.prototype.qW=function(){this.Sc=this.lj;if(-1==this.Sc)return this.jh=this.Ee=-1,!1;var a=this.ab.Hq(this.Sc);if(this.pj.ha<a)return a=this.ab.Nk(this.Sc),this.lj=this.ab.Qj(this.Sc),-1!=a&&(this.Ei=this.ab.Ol(a),this.Og[++this.Ee]=6),!0;if(a<this.pj.ca)return a=this.ab.Nk(this.Sc),this.lj=this.ab.Mk(this.Sc),-1!=a&&(this.Ei=this.ab.Zs(a),this.Og[++this.Ee]=5),!0;this.Og[this.Ee]=2;this.HI=this.Sc;a=this.ab.Nk(this.Sc);this.lj=this.ab.Qj(this.Sc);-1!=
a&&(this.Ei=this.ab.Ol(a),this.Og[++this.Ee]=7);return!0};b.prototype.rW=function(){this.Sc=this.lj;if(-1==this.Sc)return this.Og[this.Ee]=3,this.lj=this.ab.Mk(this.HI),!0;if(this.ab.Hq(this.Sc)<this.pj.ca){var a=this.ab.Nk(this.Sc);this.lj=this.ab.Mk(this.Sc);-1!=a&&(this.Ei=this.ab.Zs(a),this.Og[++this.Ee]=5);return!0}a=this.ab.Nk(this.Sc);this.lj=this.ab.Qj(this.Sc);-1!=a&&(this.Ei=this.ab.Ol(a),this.Og[++this.Ee]=7);a=this.ab.Mk(this.Sc);-1!=a&&this.oh.add(a);return!0};b.prototype.sW=function(){this.Sc=
this.lj;if(-1==this.Sc)return this.Og[this.Ee]=4,!0;if(this.pj.ha<this.ab.Hq(this.Sc)){var a=this.ab.Nk(this.Sc);this.lj=this.ab.Qj(this.Sc);-1!=a&&(this.Ei=this.ab.Ol(a),this.Og[++this.Ee]=6);return!0}a=this.ab.Nk(this.Sc);this.lj=this.ab.Mk(this.Sc);-1!=a&&(this.Ei=this.ab.Ol(a),this.Og[++this.Ee]=7);a=this.ab.Qj(this.Sc);-1!=a&&this.oh.add(a);return!0};b.prototype.tW=function(){if(0==this.oh.size)return this.jh=this.Ee=-1,!1;this.Sc=this.oh.get(this.oh.size-1);this.oh.resize(this.oh.size-1);var a=
this.ab.Nk(this.Sc);-1!=a&&(this.Ei=this.ab.Ol(a),this.Og[++this.Ee]=7);-1!=this.ab.Qj(this.Sc)&&this.oh.add(this.ab.Qj(this.Sc));-1!=this.ab.Mk(this.Sc)&&this.oh.add(this.ab.Mk(this.Sc));return!0};b.prototype.mV=function(){this.jh=this.Ei;if(-1!=this.jh&&g.Vq(this.Gq())&&this.ab.Ok(this.Gq())<=this.pj.ha)return this.Ei=this.dH(),!1;this.Ee--;return!0};b.prototype.DX=function(){this.jh=this.Ei;if(-1!=this.jh&&g.tw(this.Gq())&&this.ab.Ok(this.Gq())>=this.pj.ca)return this.Ei=this.KT(),!1;this.Ee--;
return!0};b.prototype.wP=function(){this.jh=this.Ei;if(-1!=this.jh&&g.Vq(this.Gq()))return this.Ei=this.dH(),!1;this.Ee--;return!0};b.prototype.dH=function(){return this.ab.pg?this.ab.vg.nb(this.jh):this.ab.sj.nb(this.jh)};b.prototype.KT=function(){return this.ab.pg?this.ab.vg.Ve(this.jh):this.ab.sj.Ve(this.jh)};b.prototype.Gq=function(){return this.ab.pg?this.ab.vg.ja(this.jh):this.ab.sj.getData(this.jh)};return b}();a.WZ=e;var g=function(){function d(a){this.on=this.zi=this.vg=this.sj=this.xn=this.ak=
this.Je=this.bk=null;this.pg=a;this.ar=this.Ew=!1}d.prototype.cs=function(){this.pl(!0)};d.prototype.zs=function(b,e){if(!this.Ew)throw a.g.Da();this.bk.push(new a.zc(b,e))};d.prototype.yq=function(){if(!this.Ew)throw a.g.X("invalid call");this.Ew=!1;this.ar=!0;this.pg||(this.rU(),this.Mw=this.bk.length)};d.prototype.eh=function(b){if(!this.pg||!this.ar)throw a.g.F("invalid call");if(-1==this.Mf){var e=this.bk.length;if(this.SA){var c=new a.ia(0);c.yb(2*e);this.VJ(c);this.zi.yb(2*e);this.zi.resize(0);
this.UJ(c);this.xn.resize(e,-1);this.xn.Zh(-1,0,e);this.SA=!1}else this.xn.Zh(-1,0,e);this.Mf=this.Hv()}e=this.DH(b<<1,this.Mf);c=this.vg.addElement((b<<1)+1,this.iA(e));this.MK(e,c);this.xn.set(b,e);this.Mw++};d.prototype.remove=function(b){if(!this.pg||!this.ar)throw a.g.X("invalid call");var e=this.xn.get(b);if(-1==e)throw a.g.F("the interval does not exist in the interval tree");this.xn.set(b,-1);this.Mw--;var c=this.iA(e),d;d=this.vg.TT(c);this.vg.Kd(this.rT(e),c);this.vg.Kd(this.NT(e),c);b=
this.vg.size(c);0==b&&(this.vg.JR(c),this.PK(d,-1));this.ak.kd(e);for(var c=this.fH(d),g=this.Qj(d),k=this.Mk(d),e=0;!(0<b||d==this.Mf||-1!=g&&-1!=k);)d==this.Qj(c)?-1!=g?(this.ql(c,g),this.mk(g,c),this.ql(d,-1)):-1!=k?(this.ql(c,k),this.mk(k,c),this.sl(d,-1)):this.ql(c,-1):-1!=g?(this.sl(c,g),this.mk(g,c),this.ql(d,-1)):-1!=k?(this.sl(c,k),this.mk(k,c),this.sl(d,-1)):this.sl(c,-1),this.mk(d,-1),e++,d=c,c=this.Nk(d),b=-1!=c?this.vg.size(c):0,g=this.Qj(d),k=this.Mk(d),c=this.fH(d)};d.prototype.reset=
function(){if(!this.pg||!this.ar)throw a.g.F("invalid call");this.pl(!1)};d.prototype.size=function(){return this.Mw};d.prototype.mf=function(){return e.pa(this)};d.prototype.VJ=function(a){for(var b=this.bk.length,e=0;e<2*b;e++)a.add(e);this.CY(a,2*b)};d.prototype.UJ=function(a){for(var b=NaN,e=0;e<a.size;e++){var c=a.get(e),d=this.Ok(c);d!=b&&(this.zi.add(c),b=d)}};d.prototype.rU=function(){var b=this.bk.length,e=new a.ia(0);e.yb(2*b);this.VJ(e);this.zi.yb(2*b);this.zi.resize(0);this.UJ(e);this.ak.Qe(b);
this.sj.Vn(2*b);var c=a.Uc.wh(b);c.Zh(-1,0,b);this.Mf=this.Hv();for(b=0;b<e.size;b++){var d=e.get(b),g=c.get(d>>1);-1!=g?this.MK(g,this.sj.addElement(this.iA(g),d)):(g=this.DH(d,this.Mf),c.set(d>>1,g))}};d.prototype.DH=function(b,e){var c=e,d=e,g,k=-1,f=0,n=this.zi.size-1,p=0,y=b>>1,h=NaN,B=NaN;g=!0;for(var l=this.xT(y),y=this.uT(y);g;){f<n?(p=f+a.J.truncate((n-f)/2),-1==this.Qz(c)&&this.vK(c,this.zi.get(p),this.zi.get(p+1))):-1==this.Qz(c)&&this.vK(c,this.zi.get(f),this.zi.get(f));var m=this.Hq(c);
if(y<m)-1!=e&&(e==c?(d=c,h=m,e=this.Qj(c),-1!=e?B=this.Hq(e):B=NaN):B>m&&(m<h?this.ql(d,c):this.sl(d,c),this.sl(c,e),this.pg&&(this.mk(c,d),this.mk(e,c)),d=c,h=m,e=-1,B=NaN)),n=this.sT(c),-1==n&&(n=this.Hv(),this.ZX(c,n)),c=n,n=p;else if(l>m)-1!=e&&(e==c?(d=c,h=m,e=this.Mk(c),-1!=e?B=this.Hq(e):B=NaN):B<m&&(m<h?this.ql(d,c):this.sl(d,c),this.ql(c,e),this.pg&&(this.mk(c,d),this.mk(e,c)),d=c,h=m,e=-1,B=NaN)),f=this.OT(c),-1==f&&(f=this.Hv(),this.jY(c,f)),c=f,f=p+1;else{g=this.Nk(c);-1==g&&(g=this.xR(c),
this.PK(c,g));var q=this.eP(g,b),k=this.vR();this.mY(k,g);this.YX(k,q);c!=e&&(m<h?this.ql(d,c):this.sl(d,c),this.pg&&this.mk(c,d),-1!=e&&(B<m?this.ql(c,e):this.sl(c,e),this.pg&&this.mk(e,c)));g=!1}}return k};d.prototype.Hv=function(){return this.Je.Pe()};d.prototype.xR=function(a){return this.pg?this.vg.Ks(a):this.sj.mi(a)};d.prototype.vR=function(){return this.ak.Pe()};d.prototype.pl=function(e){e?(this.Ew=this.SA=!0,this.ar=!1,null==this.zi?this.zi=a.Uc.wh(0):this.zi.resize(0),null==this.bk?this.bk=
[]:this.bk.length=0):this.SA=!1;this.pg?null==this.xn?(this.xn=a.Uc.wh(0),this.vg=new a.uk,this.vg.Ep(new b(this))):this.vg.clear():null==this.sj?this.sj=new a.Xp:this.sj.clear();null==this.Je?(this.ak=new a.ad(3),this.Je=new a.ad(this.pg?8:7)):(this.ak.Vi(!1),this.Je.Vi(!1));this.Mf=-1;this.Mw=0};d.prototype.vK=function(a,b,e){this.TX(a,b);this.UX(a,e)};d.prototype.Hq=function(a){var b=this.Qz(a);if(-1==b)return NaN;b=this.Ok(b);a=this.Ok(this.ZS(a));return b==a?b:.5*(b+a)};d.prototype.TX=function(a,
b){this.Je.P(a,0,b)};d.prototype.UX=function(a,b){this.Je.P(a,1,b)};d.prototype.ZX=function(a,b){this.Je.P(a,3,b)};d.prototype.jY=function(a,b){this.Je.P(a,4,b)};d.prototype.PK=function(a,b){this.Je.P(a,2,b)};d.prototype.ql=function(a,b){this.Je.P(a,5,b)};d.prototype.sl=function(a,b){this.Je.P(a,6,b)};d.prototype.mk=function(a,b){this.Je.P(a,7,b)};d.prototype.mY=function(a,b){this.ak.P(a,0,b)};d.prototype.eP=function(a,b){return this.pg?this.vg.addElement(b,a):this.sj.addElement(a,b)};d.prototype.YX=
function(a,b){this.ak.P(a,1,b)};d.prototype.MK=function(a,b){this.ak.P(a,2,b)};d.prototype.Ol=function(a){return this.pg?this.vg.xc(a):this.sj.xc(a)};d.prototype.Zs=function(a){return this.pg?this.vg.Fc(a):this.sj.Fc(a)};d.Vq=function(a){return 0==(a&1)};d.tw=function(a){return 1==(a&1)};d.prototype.Qz=function(a){return this.Je.S(a,0)};d.prototype.ZS=function(a){return this.Je.S(a,1)};d.prototype.Nk=function(a){return this.Je.S(a,2)};d.prototype.sT=function(a){return this.Je.S(a,3)};d.prototype.OT=
function(a){return this.Je.S(a,4)};d.prototype.Qj=function(a){return this.Je.S(a,5)};d.prototype.Mk=function(a){return this.Je.S(a,6)};d.prototype.fH=function(a){return this.Je.S(a,7)};d.prototype.iA=function(a){return this.ak.S(a,0)};d.prototype.rT=function(a){return this.ak.S(a,1)};d.prototype.NT=function(a){return this.ak.S(a,2)};d.prototype.xT=function(a){return this.bk[a].ca};d.prototype.uT=function(a){return this.bk[a].ha};d.prototype.CY=function(b,e){null==this.on&&(this.on=new a.Hu);var d=
new c(this);this.on.sort(b,0,e,d)};d.prototype.BY=function(a,b,e){var c=this;a.Gd(b,e,function(a,b){var e=c.Ok(a),g=c.Ok(b);return e<g||e==g&&d.Vq(a)&&d.tw(b)?-1:1})};d.prototype.Ok=function(a){var b=this.bk[a>>1];return d.Vq(a)?b.ca:b.ha};return d}();a.ns=g})(x||(x={}));(function(a){var b=function(){function b(b){if(null==b)throw a.g.X("Invalid arguement");this.Ke=b;var e=b.fT();e.cU()?b.je.UH()?this.Zo=a.di.PannableFold:this.Zo=a.di.Clip:this.Zo=a.di.DontClip;e.dU()?b.He.UH()?this.Dn=a.di.PannableFold:
this.Dn=a.di.Clip:this.Dn=a.di.DontClip;this.pn=e.yv;this.yI=e.uz;b=this.Ke.EI;this.mI=b.et(2147483648);this.Gw=b.et(1073741824)}b.Xg=function(a,b,c){return b.xr.Xg(a,c)};b.gs=function(a,b,c,d){return a.xr.gs(b,c,d)};b.Du=function(a,b,c,d){c=0>c?b.length:c;a=a.xr.gs(b,c,d);if(a==c)return a;for(var e=b=0;e<c;e++){var g=d[e];g.isNaN()||(b<e&&d[b].L(g),b++)}for(;b<c;b++)d[b].$c();return a};b.MC=function(a,b,c,d){return a.xr.MC(b,c,d)};b.iL=function(a,b,c,d){c=0>c?b.length:c;a=a.xr.MC(b,c,d);if(a==c)return a;
for(var e=b=0;e<c;e++){var g=d[e];isNaN(g.x)||(b<e&&d[b].I(g.x,g.y,g.z),b++)}for(;b<c;b++)d[b].dv();return a};b.transform=function(c,e,d,f,p){if(c.Ho())return a.na.kR(f,e,d),d;for(var g=[],k=0,n=0;n<d;){for(var y=Math.min(g.length,d-n),h=n,l=0;h<y;h++,l++)null==g[l]?g[l]=e[h].w():e[h].w(g[l]);var m;m=p?b.Du(c,g,y,g):b.gs(c,g,y,g);for(l=h=0;h<m;h++,l++)null==f[n]&&(f[n]=new a.Wa(e[n])),f[n].rb(g[l]);n+=y;k+=m}return k};b.jL=function(b,e,c){if(0==c)return[];var d=new a.Ed;d.oP(e,2*c);e=this.Xg(d,b,
null);b=e.Pa(0);e=2*e.D();c=a.J.gf(e);b.ol(0,e,c,0,!0);return c};b.prototype.gs=function(b,e,c){if(this.Ke.Ho())return b!=c&&a.na.Fv(c,b,e),e;var d=this.Ke.je,g=this.Ke.He,k=d.Fb(),f=g.Fb();if(0==k&&k===f){var p=d.Yi(),g=g.Yi(),g=p/g,p=new a.Hd;p.Op(g,g);p.$Y(b,e,c);return e}p=a.J.qv(Math.min(e,64));if(3==k){var h;h=d.ij;d=h.Fk();k=d.Fb();c!=b&&a.na.Fv(c,b,e);a.Ib.Dl(h,c,e,!0);h.Du(a.Om.forward,c,e);a.Ib.Cl(h,c,e,!0)}if(3==k||3===f)throw a.g.X("image: transform_in_place_");if(2==k)this.Zo==a.di.Clip?
(c!=b&&a.na.Fv(c,b,e),b=d.Lk(),a.Ib.KU(b,d,c,e)):(c!=b&&a.na.Fv(c,b,e),d.Jc()&&(k=d.se(0),h=d.re(),a.Ib.zY(c,e,h,k),a.Ib.BG(c,e,d,0))),a.Ib.xN(d,c,e,p);else for(k=d.se(0),h=d.re(),d=0;d<e;d++)a.Ib.AY(b[d],h,k,c[d]);a.Ib.vN(this.Ke,c,e,p);b=0;(f=2==f)?b=g.pi():isNaN(this.pn)||(b=this.pn);f&&this.Dn!=a.di.Clip||a.Ib.BG(c,e,g.lc(),b);f&&(a.Ib.LH(c,e,g,this.Dn),a.Ib.wN(g,c,e,p));b=e;for(d=0;d<e;++d)c[d].isNaN()&&b--;return b};b.prototype.MC=function(b,e,c){e=0>e?b.length:e;if(this.Ke.Ho()){for(var d=
0;d<e;++d)null==c[d]&&(c[d]=new a.pd),c[d].I(b[d].x,b[d].y,b[d].z);return e}var g=this.Ke.je,d=this.Ke.He,k=g.Fb(),f=d.Fb();if(0==k&&k==f)return g=g.Yi(),d=d.Yi(),d=g/d,g=new a.fO,g.Op(d,d,d),g.transform(b,e,c),e;k=new a.Ed;k.Td(1);k.Td(3);k.nP(b);b=k.Pa(3);d=0;for(g=e;d<g;d++)b.write(d,d);k=this.Xg(k,null);for(d=0;d<e;++d)null==c[d]?c[d]=a.pd.pa(NaN,NaN,NaN):c[d].dv();if(null==k)return 0;b=k.Pa(3);var f=k.Pa(0),p=k.Pa(1);k.gX(c,e);d=0;for(g=k.D();d<g;d++)e=b.read(d),f.pX(2*d,c[e]),c[e].z=p.read(d);
return k.D()};b.prototype.Xg=function(b,e){if(this.Ke.Ho()||b.u())return b;if(33==b.G())return this.PJ(b);var c=this.Ke.je,d=this.Ke.He,k=c.Fb(),f=d.Fb();if(0==k&&k==f)return c=c.Yi(),d=d.Yi(),c/=d,d=new a.Hd,d.Op(c,c),c=a.T.oe(b),c.Xc(d),c;switch(b.G()){case 1607:case 1736:d=this.NJ(b,e);break;case 550:d=this.XW(b,e);break;case 197:d=this.WW(b,e);break;default:throw a.g.X("");}return d};b.prototype.PJ=function(b){var e=b.w(),c=[];c[0]=e;this.gs(c,1,c);b=new a.Wa(b);b.rb(c[0]);return b};b.prototype.NJ=
function(b,e){if(b.hn())throw a.g.X("curves not supported");var c=b.G();if(1736==c)return this.YW(b,e);if(1607==c)return this.ZW(b,e);throw a.g.X("projectMultiPath");};b.prototype.YW=function(c,e){var d=this.Ke.je,k=this.Ke.He,f=d.Fb(),p=k.Fb(),h=a.J.qv(Math.min(c.D(),64));c=a.Ja.oe(c);if(3==f){var l=d.ij,d=l.Fk(),f=d.Fb();c=l.Dl(c,!0);this.qq(l,a.Om.forward,c);c=l.Cl(c,!0)}l=null;3==p&&(l=k.ij,k=l.Fk(),p=k.Fb());var m=2==f,q=2==p,r=q?k.lc():k,t=!q&&!this.Gw,p=!1,A=c;if(m){if(A=a.Ib.MJ(A,d,this.Zo,
e),A.u())return A}else{c=new a.h;A.ac(c);f=d.re();if(c.A<f.A||c.B>f.B){var u=a.h.pa(c.o-1,f.A,c.v+1,f.B),A=a.uh.rq(A,u,d,NaN,0,e);if(A.u())return A}c.N()>2*f.N()&&(A=a.Ib.Aq(A,-2*f.N(),2*f.N(),d,!0,0,!0,e))}c=this.yI;(f=!isNaN(c))&&(A=a.Jm.local().V(A,c,e));var u=q?k.Sj():null,v=NaN;m&&(v=d.pi());var w=null!=k.Ws();if(this.mI)m&&(a.Ib.qs(d,v,A,h),f&&(m=d.Ch(),v=d.lc().Ch(),c*=v/m)),a.Ib.ps(this.Ke,A,t,h),f&&(m=d.lc().Ch(),v=k.lc().Ch(),c*=v/m),d=A;else{var x=new a.Ua(A.description);x.VE(A);m&&(a.Ib.qs(d,
v,x,h),f&&(m=d.Ch(),v=d.lc().Ch(),c*=v/m));a.Ib.ps(this.Ke,x,t,h);f&&(m=d.lc().bn(),v=k.lc().bn(),c*=v/m);t=NaN;q?(u=k.Sj(),t=k.pi()):isNaN(this.pn)||(t=this.pn);m=b.te(d)|b.te(k);v=10*r.se(0);this.Gw&&(m=3,v=0);d=a.Ib.LS(A,d,x,r,t,e,m,v)}w&&(d=a.Ib.kF(d,k,e));q&&(p||(q=r.re().N(),d.xf(0,0).N()>=q-r.se(0)&&(r=u.getNorthPoleLocation(),q=u.getSouthPoleLocation(),A=u.getNorthPoleGeometry(),u=u.getSouthPoleGeometry(),t=0,A==a.Bg.PE_POLE_POINT&&r!=a.Bg.PE_POLE_OUTSIDE_BOUNDARY&&(t=1),u==a.Bg.PE_POLE_POINT&&
q!=a.Bg.PE_POLE_OUTSIDE_BOUNDARY&&(t|=2),0!==t&&(p=!0))),d=a.Ib.uA(d,k,this.Dn,e),f&&(d=a.Jm.local().V(d,c,e)),a.Ib.vy(k,d,h));if(d.u())return d;p&&(d=a.Km.local().V(d,k,!1,e));null!=l&&(d=l.Cl(d,!1),this.qq(l,a.Om.reverse,d),d=l.Dl(d,!1));return d};b.te=function(b){if(2!=b.Fb())return 0;var e=0,c=b.Sj();b=c.getNorthPoleLocation();var d=c.getSouthPoleLocation(),k=c.getNorthPoleGeometry(),c=c.getSouthPoleGeometry();k==a.Bg.PE_POLE_POINT&&b!=a.Bg.PE_POLE_OUTSIDE_BOUNDARY&&(e=1);c==a.Bg.PE_POLE_POINT&&
d!=a.Bg.PE_POLE_OUTSIDE_BOUNDARY&&(e|=2);return e};b.prototype.ZW=function(c,e){var d=this.Ke.je,k=this.Ke.He,f=d.Fb(),p=k.Fb(),h=a.J.qv(Math.min(c.D(),64));c=a.Ua.oe(c);if(3==f){var l=d.ij,d=l.Fk(),f=d.Fb();c=l.Dl(c,!0);this.qq(l,a.Om.forward,c);c=l.Cl(c,!0)}l=null;3==p&&(l=k.ij,k=l.Fk(),p=k.Fb());var m=2==f,f=(p=2==p)?k.lc():k,q=!p&&!this.Gw;if(m){if(c=a.Ib.MJ(c,d,this.Zo,e),c.u())return c}else{var r=new a.h;c.ac(r);var t=d.re();if(r.A<t.A||r.B>t.B)if(r=a.h.pa(r.o-1,t.A,r.v+1,t.B),c=a.uh.rq(c,r,
d,NaN,0,e),c.u())return c}var A=NaN;m&&(A=d.pi());var r=null!=k.Ws(),t=this.yI,u=!isNaN(t);u&&(c=a.Jm.local().V(c,t,e));if(this.mI)m&&a.Ib.qs(d,A,c,h),u&&(m=d.Ch(),A=d.lc().Ch(),t*=A/m),a.Ib.ps(this.Ke,c,q,h),u&&(m=d.lc().Ch(),A=k.lc().Ch(),t*=A/m),d=c;else{var v=new a.Ua(c.description);v.VE(c);m&&(a.Ib.qs(d,A,v,h),u&&(m=d.Ch(),A=d.lc().Ch(),t*=A/m));a.Ib.ps(this.Ke,v,q,h);u&&(m=d.lc().Ch(),A=k.lc().Ch(),t*=A/m);q=NaN;p?q=k.pi():isNaN(this.pn)||(q=this.pn);m=b.te(d)|b.te(k);A=10*f.se(0);this.Gw&&
(m=3,A=0);d=a.Ib.MS(c,d,v,f,q,e,m,A)}r&&(d=a.Ib.kF(d,k,e));p&&(d=a.Ib.uA(d,k,this.Dn,e),u&&(d=a.Jm.local().V(d,t,e)),a.Ib.vy(k,d,h));if(d.u())return d;null!=l&&(d=l.Cl(d,!1),this.qq(l,a.Om.reverse,d),d=l.Dl(d,!1));return d};b.prototype.WW=function(b,e){var c=(b.fa()+b.N())/400;if(0!=c){var d=a.Jm.local().V(b,c,e),d=this.NJ(d,e),c=b.Ka();d.Qn(c)}else c=new a.Wa(b.Bq()),d=this.PJ(c),c=b.Ka(),d.u()?c.Oa():(b.copyTo(c),d=d.w(),c.I(d.x,d.y,d.x,d.y));return c};b.prototype.XW=function(b,e){b=a.T.oe(b);var c=
this.Ke.je,d=this.Ke.He,k=c.Fb(),f=d.Fb(),p=a.J.qv(Math.min(b.D(),64));if(3==k){var h=c.ij,c=h.Fk(),k=c.Fb();b=h.Cl(b,!0);this.qq(h,a.Om.forward,b);b=h.Dl(b,!0)}if(2==k){this.Zo==a.di.Clip?b=a.tk.local().V(b,c.Lk(),c,e):c.Jc()&&(k=new a.h,b.ac(k),c.re().contains(k)||(this.Zo==a.di.PannableFold&&(b=a.Ib.Mj(b,c)),a.Ib.xu(b,c.re(),c.se(0),!0),b=a.Ib.Xm(b,c,0,!0,0,e)));if(b.u())return b;a.Ib.qs(c,0,b,p)}else a.Ib.xu(b,c.re(),c.se(0),!0);a.Ib.ps(this.Ke,b,!1,p);c=0;k=!1;h=null;3==f&&(k=!0,h=d.ij,d=h.Fk(),
f=d.Fb());(f=2==f)?c=d.pi():isNaN(this.pn)||(c=this.pn);f&&this.Dn!=a.di.Clip||(b=a.Ib.Xm(b,d.lc(),c,!1,0,e));if(f&&(b=a.Ib.uA(b,d,this.Dn,e),a.Ib.vy(d,b,p),b.u()))return b;k&&(b=h.Cl(b,!0),this.qq(h,a.Om.reverse,b),b=h.Dl(b,!0));return b};b.prototype.qq=function(b,e,c){var d=c.D();if(0!=d){for(var g=c.Pa(0),k=a.J.gf(200,0),f=[],p=0;p<d;){var h=Math.min(100,d-p);g.ol(2*p,2*h,k,2,!0);for(var l=0;l<h;++l)f[l]=a.b.pa(k[2*p],k[2*p+1]);b.Du(e,f,h);p+=h}c.Dc(1993)}};b.rk=function(b,e,c){if(null==b||null==
e||!e.Jc())throw a.g.X("Invalid Arguement");if(b.u())return b;var d;d=b.G();197==d?(d=new a.Ja(b.description),d.jd(b,!1)):a.T.Oc(d)?(d=new a.Ua(b.description),d.dc(b,!0)):d=b;d=a.Ib.Mj(d,e);return d.u()?d:a.Ib.Xm(d,e,0,d!=b,0,c)};b.Nj=function(c,e,d,f){if(null==c||null==e||!e.Jc())throw a.g.X("Invalid Arguement");if(c.u())return c;var g=c.G();if(a.T.Ic(g)){c=a.Ib.Mj(c,e);g=new a.h;c.s(g);for(var k=a.na.Zy(e,g,!1),n=e.Bh(),p=Math.floor((g.o-n.o)/n.N())*n.N()+n.o;p<g.v;)p>g.o+k&&p<g.v-k&&(c=a.Ib.qU(c,
e,d,p)),p+=n.N()}else{if(197==g)return g=new a.Ja(c.description),g.jd(c,!1),b.Nj(g,e,d,f);if(a.T.Oc(g))return g=new a.Ua(c.description),g.dc(c,!0),b.Nj(g,e,d,f)}return b.rk(c,e,f)};b.Yp=function(c,e,d,f){var g=e.Fb(),k=new a.fE;e.jX(k);if(0==g)return b.Dj(c,k,e,d);f==a.Up.foldAndClipWithHorizon&&e.Jc()&&(c=b.rk(c,e,d));c=b.Dj(c,k,e,d);if(f==a.Up.clipToDomainOnly||c.u())return c;if(1==g)return f==a.Up.clipWithHorizon?(f=new a.h,c.ac(f),g=e.re(),k=.01*g.N(),f.A=g.A,f.B=g.B,f.o-=k,f.v+=k,a.uh.rq(c,f,
e,NaN,0,d)):c;if(2==g)return g=e.Lk(),f==a.Up.clipWithHorizon||f==a.Up.foldAndClipWithHorizon?(e=a.tk.local().V(c,g,e,d),e==g?a.T.oe(e):e):c;if(3==g)return c;throw a.g.X("missing implementation");};b.Dj=function(b,e,c,d){var g=e.XT(),k=b.hasAttribute(1),f=b.hasAttribute(2),n=new a.zc;n.Oa();var p=new a.zc;p.Oa();k&&(n=e.YT());f&&(p=e.tT());e=a.uh.rq(b,g,c,NaN,0,d);k&&(k=e.xf(1,0),n.contains(k)||(b==e&&(e=a.T.oe(e)),a.na.UK(e,n,1)));f&&(k=e.xf(2,0),p.contains(k)||(b==e&&(e=a.T.oe(e)),a.na.UK(e,p,2)));
return e};return b}();a.ko=b})(x||(x={}));(function(a){var b=function(b){function c(e,c,d,f){b.call(this);void 0===e?this.description=a.ze.Ig():void 0===d?this.description=e:(this.description=a.ze.Ig(),this.xC(e,c),this.vm(d,f))}I(c,b);c.prototype.G=function(){return 322};c.prototype.Rb=function(){var a=this.ua-this.sa,b=this.ra-this.oa;return Math.sqrt(a*a+b*b)};c.prototype.fh=function(a){var b=this.ua-this.sa,e=this.ra-this.oa;return Math.sqrt(b*b+e*e)<=a};c.prototype.Go=function(){return!1};c.prototype.Eg=
function(){var b=new a.b;b.yc(this.Bc(),this.ec());return b};c.gR=function(a,b){return new c(a.x,a.y,b.x,b.y)};c.prototype.Qn=function(b){b.Oa();b.Fg(this.description);var e=new a.h;this.s(e);b.Gp(e);for(var e=1,c=this.description.Ga;e<c;e++)for(var d=this.description.qd(e),f=a.ma.Xa(d);e<f;e++){var k=this.xf(d,0);b.setInterval(d,0,k)}};c.prototype.s=function(a){a.I(this.ua,this.ra,this.sa,this.oa);a.normalize()};c.prototype.Cp=function(a){a.Oa();a.Nb(this.ua,this.ra,this.ae(0,1,0));a.Nb(this.sa,
this.oa,this.ae(1,1,0))};c.prototype.Xc=function(b){if(b instanceof a.Hd){this.Ac();var e=new a.b;e.x=this.ua;e.y=this.ra;b.$h(e,e);this.ua=e.x;this.ra=e.y;e.x=this.sa;e.y=this.oa;b.$h(e,e);this.sa=e.x;this.oa=e.y}else this.Ac(),e=new a.pd,e.x=this.ua,e.y=this.ra,e.z=this.ae(0,1,0),e=b.Rp(e),this.ua=e.x,this.ra=e.y,this.oo(0,1,0,e.z),e.x=this.sa,e.y=this.oa,e.z=this.ae(1,1,0),e=b.Rp(e),this.sa=e.x,this.oa=e.y,this.oo(1,1,0,e.z)};c.prototype.Ka=function(){return new c(this.description)};c.prototype.Cy=
function(a,b){return(this.sa-a-(this.ua-a))*(this.oa-b+(this.ra-b))*.5};c.prototype.cy=function(a){return a*this.Rb()};c.prototype.bI=function(a){return a/this.Rb()};c.prototype.PG=function(b){return a.Ub.Xq(this.ua,this.sa,b)};c.prototype.YS=function(b){return a.Ub.Xq(this.ra,this.oa,b)};c.prototype.Hl=function(b,c){var e=new a.Cg;this.yh(b,c,e);return e.get()};c.prototype.yh=function(b,c,d){if(null==d)throw a.g.F();d.Js();d=d.get();d.Fg(this.description);var e=new a.b;this.gc(b,e);d.xC(e.x,e.y);
this.gc(c,e);d.vm(e.x,e.y);for(var e=1,g=this.description.Ga;e<g;e++)for(var f=this.description.Sd(e),k=a.ma.Xa(f),n=0;n<k;n++){var p=this.Yc(b,f,n);d.Tx(f,n,p);p=this.Yc(c,f,n);d.Lx(f,n,p)}};c.prototype.Yc=function(b,c,d){if(0==c)return 0==d?this.gc(b).x:this.gc(b).y;switch(a.ma.Xz(c)){case 0:return.5>b?this.dt(c,d):this.Os(c,d);case 1:var e=this.dt(c,d);c=this.Os(c,d);return a.Ub.Xq(e,c,b);case 2:throw a.g.X("not implemented");}throw a.g.za();};c.prototype.qe=function(a,b){var e=this.sa-this.ua,
c=this.oa-this.ra,d=e*e+c*c;if(0==d)return.5;e=((a.x-this.ua)*e+(a.y-this.ra)*c)/d;b||(0>e?e=0:1<e&&(e=1));return e};c.prototype.Tq=function(a,b,c,d){if(a){a=this.oa-this.ra;if(0==a)return b==this.oa?-1:0;b=(b-this.ra)/a;if(0>b||1<b)return 0;null!=c&&(c[0]=this.PG(b))}else{a=this.sa-this.ua;if(0==a)return b==this.sa?-1:0;b=(b-this.ua)/a;if(0>b||1<b)return 0;null!=c&&(c[0]=this.YS(b))}null!=d&&(d[0]=b);return 1};c.prototype.pf=function(a,b){var e=this.oa-this.ra;if(0==e)return a==this.oa?b:NaN;e=(a-
this.ra)/e;a=this.PG(e);1==e&&(a=this.sa);return a};c.prototype.av=function(a,b,c){return 0<=this.lq(a.x,a.y,b,c)};c.prototype.Si=function(a,b,c){return 0<=this.lq(a,b,c,!0)};c.prototype.mt=function(a,b){return this.av(a,b,!1)};c.prototype.BJ=function(){if(this.oa<this.ra||this.oa==this.ra&&this.sa<this.ua){var a=this.ua;this.ua=this.sa;this.sa=a;a=this.ra;this.ra=this.oa;this.oa=a;for(var a=0,b=this.description.Er-2;a<b;a++){var c=this.la[a];this.la[a]=this.la[a+b];this.la[a+b]=c}}};c.prototype.ev=
function(b,c){b=a.b.pa(b,c);b.sub(this.ec());c=new a.b;c.yc(this.Bc(),this.ec());var e=c.Ui(b);b=8.881784197001252E-16*(Math.abs(c.x*b.y)+Math.abs(c.y*b.x));return e>b?-1:e<-b?1:0};c.prototype.lq=function(b,c,d,f){var e=this.ua,g=this.ra,k=b-e,n=c-g,k=Math.sqrt(k*k+n*n);if(k<=Math.max(d,6.661338147750939E-16*k))return f&&0==k?NaN:0;k=b-this.sa;n=c-this.oa;k=Math.sqrt(k*k+n*n);if(k<=Math.max(d,6.661338147750939E-16*k))return f&&0==k?NaN:1;k=this.sa-this.ua;n=this.oa-this.ra;f=Math.sqrt(k*k+n*n);if(0<
f){var p=1/f,k=k*p,n=n*p,y=b-e,h=c-g,l=y*k+h*n,m=1.7763568394002505E-15*(Math.abs(y*k)+Math.abs(h*n)),q=k,k=-n,n=q,m=Math.max(d,m);if(l<-m||l>f+m)return NaN;if(Math.abs(y*k+h*n)<=Math.max(d,1.7763568394002505E-15*(Math.abs(y*k)+Math.abs(h*n)))&&(k=a.J.pk(l*p,0,1),.5>=k?(n=this.ua+(this.sa-this.ua)*k,f=this.ra+(this.oa-this.ra)*k):(n=this.sa-(this.sa-this.ua)*(1-k),f=this.oa-(this.oa-this.ra)*(1-k)),a.b.xz(n,f,b,c)<=d)){if(.5>k){if(a.b.xz(n,f,e,g)<=d)return 0}else if(a.b.xz(n,f,this.sa,this.oa)<=d)return 1;
return k}}return NaN};c.prototype.Eb=function(a){return null==a?!1:a==this?!0:a.constructor!==this.constructor?!1:this.NO(a)};c.prototype.JE=function(b,c,d){var e=d?this.ua:this.sa;d=d?this.ra:this.oa;var g=new a.b;g.x=b.sa-e;g.y=b.oa-d;return c.oi(g)>6.661338147750939E-16*c.zE(g)?(g.x=b.ua-e,g.y=b.ra-d,c.oi(g)<=6.661338147750939E-16*c.zE(g)):!0};c.prototype.IE=function(b){var c=new a.b;c.x=this.sa-this.ua;c.y=this.oa-this.ra;if(!this.JE(b,c,!1))return!1;c.Lr();return this.JE(b,c,!0)?!0:!1};c.We=
function(a,b){var c=a.ev(b.ua,b.ra),e=a.ev(b.sa,b.oa);if(0>c&&0>e||0<c&&0<e)return!1;c=b.ev(a.ua,a.ra);e=b.ev(a.sa,a.oa);if(0>c&&0>e||0<c&&0<e)return!1;c=a.Rb();e=b.Rb();return c>e?a.IE(b):b.IE(a)};c.te=function(b,c,d){var e=a.b.pa(NaN,NaN),g=b.sa-b.ua,f=b.oa-b.ra,k=c.sa-c.ua,n=c.oa-c.ra,p=k*f-g*n;if(0==p)return e;var h=8.881784197001252E-16*(Math.abs(k*f)+Math.abs(g*n)),l=c.ua-b.ua,m=c.ra-b.ra,q=k*m-l*n,r=q/p,t=Math.abs(p),k=(8.881784197001252E-16*(Math.abs(k*m)+Math.abs(l*n))*t+h*Math.abs(q))/(p*
p)+2.220446049250313E-16*Math.abs(r);if(r<-k||r>1+k)return e;n=g*m-l*f;k=n/p;g=(8.881784197001252E-16*(Math.abs(g*m)+Math.abs(l*f))*t+h*Math.abs(n))/(p*p)+2.220446049250313E-16*Math.abs(k);if(k<-g||k>1+g)return e;r=a.J.pk(r,0,1);g=a.J.pk(k,0,1);f=b.gc(r);p=c.gc(g);h=new a.b;h.yc(f,p);if(h.length()>d&&(h.add(f,p),h.scale(.5),r=b.qe(h,!1),g=c.qe(h,!1),b=b.gc(r),c=c.gc(g),b.sub(c),b.length()>d))return e;e.ka(r,g);return e};c.RO=function(a,b,d,f){var e=0;if(a.ua==b.ua&&a.ra==b.ra||a.ua==b.sa&&a.ra==b.oa)if(e++,
!f)return 1;if(a.sa==b.ua&&a.oa==b.ra||a.sa==b.sa&&a.oa==b.oa){e++;if(2==e)return 2;if(!f)return 1}return b.Si(a.ua,a.ra,d)||b.Si(a.sa,a.oa,d)||a.Si(b.ua,b.ra,d)||a.Si(b.sa,b.oa,d)?1:f&&0!=e?0:0==c.We(a,b)?0:1};c.Gy=function(b,d,f,k,p,h){var e=0,g=b.lq(d.ua,d.ra,h,!1),n=b.lq(d.sa,d.oa,h,!1),y=d.lq(b.ua,b.ra,h,!1),B=d.lq(b.sa,b.oa,h,!1);isNaN(g)||(null!=k&&(k[e]=g),null!=p&&(p[e]=0),null!=f&&(f[e]=a.b.pa(d.ua,d.ra)),e++);isNaN(n)||(null!=k&&(k[e]=n),null!=p&&(p[e]=1),null!=f&&(f[e]=a.b.pa(d.sa,d.oa)),
e++);2==e||isNaN(y)||0==g&&0==y||0==n&&1==y||(null!=k&&(k[e]=0),null!=p&&(p[e]=y),null!=f&&(f[e]=a.b.pa(b.ua,b.ra)),e++);2==e||isNaN(B)||1==g&&0==B||1==n&&1==B||(null!=k&&(k[e]=1),null!=p&&(p[e]=B),null!=f&&(f[e]=a.b.pa(d.sa,d.oa)),e++);if(0<e)return 2==e&&null!=k&&k[0]>k[1]&&(b=k[0],k[0]=k[1],k[1]=b,null!=p&&(k=p[0],p[0]=p[1],p[1]=k),null!=f&&(p=a.b.pa(f[0].x,f[0].y),f[0]=f[1],f[1]=p)),e;e=c.te(b,d,h);if(isNaN(e.x))return 0;null!=f&&(f[0]=b.gc(e.x));null!=k&&(k[0]=e.x);null!=p&&(p[0]=e.y);return 1};
c.prototype.qH=function(){return 0};c.prototype.iq=function(){};c.prototype.toString=function(){return"Line: ["+this.ua.toString()+", "+this.ra.toString()+", "+this.sa.toString()+", "+this.oa.toString()+"]"};return c}(a.dE);a.Hb=b})(x||(x={}));(function(a){var b=function(){function a(){this.am=[];this.Ca=-1}a.prototype.Ia=function(){return this.Ca};a.prototype.next=function(){if(null!=this.am&&0!=this.am.length){this.Ca++;var a=this.am[0];1>=this.am.length?this.am=[]:this.am=this.am.slice(1);return a}return this.am=
null};a.prototype.TY=function(a){this.am.push(a)};a.prototype.Re=function(){return!0};return a}();a.RM=b})(x||(x={}));(function(a){(function(a){a[a.enumFillRuleOddEven=0]="enumFillRuleOddEven";a[a.enumFillRuleWinding=1]="enumFillRuleWinding"})(a.JN||(a.JN={}));var b=function(b){function c(c,d){b.call(this);this.$f=!1;this.ur=null;this.gr=this.hr=0;this.bj=null;this.hh=!1;this.Xd=this.tj=this.cf=this.jb=this.kb=null;this.mr=this.Ta=this.ir=0;if(void 0===d)this.$f=c,this.hh=!1,this.qa=this.gr=this.hr=
this.ir=0,this.description=a.ze.Ig();else{if(null==d)throw a.g.F();this.$f=c;this.hh=!1;this.qa=this.gr=this.hr=this.ir=0;this.description=d}this.bj=null;this.Ta=0}I(c,b);c.prototype.hn=function(){return 0<this.ir};c.prototype.Fy=function(){this.Ac();null==this.ur?this.ur=new a.Wa(this.description):this.ur.Fg(this.description)};c.prototype.$x=function(b,c){var e=new a.b;e.x=b;e.y=c;this.zu(e)};c.prototype.zu=function(a){this.Fy();this.ur.rb(a);this.hh=!0};c.prototype.Rf=function(b){if(b.u())throw a.g.F();
this.om(b.description);this.Fy();b.copyTo(this.ur);this.hh=!0};c.prototype.By=function(){var b=1;this.hh&&(this.Fy(),null==this.kb?(this.kb=a.Uc.wh(2),this.kb.write(0,0),this.jb=a.Uc.vq(2,0)):(this.kb.resize(this.kb.size+1,0),this.jb.resize(this.jb.size+1,0)),this.$f&&this.jb.write(this.jb.size-2,1),b++);var c=this.qa;this.kb.write(this.kb.size-1,this.qa+b);this.zl(c+b);this.jb.write(this.kb.size-1,0);this.hh&&(this.vu(c,this.ur),this.hh=!1)};c.prototype.Xj=function(a,b){this.By();this.rb(this.qa-
1,a,b)};c.prototype.aj=function(a){this.By();this.rb(this.qa-1,a)};c.prototype.lineTo=function(a){this.By();this.vu(this.qa-1,a)};c.prototype.oW=function(b){this.Ac();if(this.$f)throw a.g.za();var c=this.aa();if(b>c)throw a.g.za();if(this.Qb(b)){if(null==this.jb)throw a.g.za();var e=this.qa,d=this.wa(b),f=this.Gc(b);this.zl(this.qa+1);this.wc();for(var k=0,p=this.description.Ga;k<p;k++)if(null!=this.ya[k]){var h=a.ma.Xa(this.description.Sd(k));this.ya[k].Qk(h*f,this.ya[k],h*d,h,!0,1,h*e)}for(;c>b;c--)e=
this.kb.read(c),this.kb.write(c,e+1);this.jb.fz(b,1)}};c.prototype.sq=function(){var a;this.Cu();void 0===a&&(this.hh=!1,a=this.aa()-1);var b=this.jb.read(a);this.jb.write(a,b|1);null!=this.cf&&(a=this.Gc(a)-1,this.cf.write(a,1),this.tj.write(a,-1))};c.Dj=function(a){return c.te[a]};c.prototype.Qb=function(a){return 0!=(this.jb.read(a)&1)};c.prototype.Eo=function(a){if(this.Qb(a))return!0;var b=this.wa(a);a=this.Gc(a)-1;if(b>a)return!1;b=this.Ba(b);a=this.Ba(a);return b.ub(a)};c.prototype.ft=function(a){return 0!=
(this.jb.read(a)&2)};c.prototype.dc=function(b,c){this.om(b.description);if(322==b.G()){var e=new a.Wa;if(c||this.u())b.Dp(e),this.Rf(e);b.Bp(e);this.lineTo(e)}else throw a.g.za();};c.prototype.oq=function(a){var b=0==this.qa;this.$x(a.o,a.A);this.Xj(a.o,a.B);this.Xj(a.v,a.B);this.Xj(a.v,a.A);this.sq();this.hh=!1;b&&this.lg(256,!1)};c.prototype.jd=function(b,c){if(!b.u()){for(var e=0==this.qa,d=new a.Wa(this.description),g=0;4>g;g++)b.ig(c?4-g-1:g,d),0==g?this.Rf(d):this.lineTo(d);this.sq();this.hh=
!1;e&&!c&&this.lg(256,!1)}};c.prototype.add=function(a,b){for(var c=0;c<a.aa();c++)this.Ti(a,c,!b)};c.prototype.Ti=function(a,b,c){this.Yf(-1,a,b,c)};c.prototype.Bl=function(a,b){this.sA(a,b)};c.prototype.Bs=function(b,c,d,f,k){k||0!=this.aa()||(k=!0);0>c&&(c=b.aa()-1);if(c>=b.aa()||0>d||0>f||f>b.ew(c))throw a.g.X("index out of bounds");if(0!=f){var e=b.Qb(c)&&d+f==b.ew(c);if(!e||1!=f){this.hh=!1;this.om(b.description);d=b.wa(c)+d+1;k&&(f++,d--);e&&f--;e=this.qa;this.zl(this.qa+f);this.wc();if(k){if(0==
f)return;this.kb.add(this.qa);k=b.jb.read(c);k&=-5;this.$f&&(k|=1);this.jb.write(this.jb.size-1,k);this.jb.add(0)}else this.kb.write(this.jb.size-1,this.qa);k=0;for(var g=this.description.Ga;k<g;k++){var n=this.description.qd(k),p=a.ma.Xa(n),y=b.description.mg(n);0>y||null==b.ya[y]?this.ya[k].Vj(p*e,a.ma.de(n),f*p,p*e):this.ya[k].Qk(p*e,b.ya[y],p*d,f*p,!0,p,p*e)}if(this.hn())throw a.g.za();if(b.ft(c))throw a.g.za();this.Dc(1993)}}};c.prototype.eK=function(){for(var a=0,b=this.aa();a<b;a++)this.CX(a)};
c.prototype.CX=function(b){this.wc();if(b>=this.aa())throw a.g.F();var c=this.wa(b),e=this.La(b);b=this.Qb(b)?1:0;for(var d=0,f=this.description.Ga;d<f;d++)if(null!=this.ya[d]){var k=a.ma.Xa(this.description.Sd(d));this.ya[d].Zd(k*(c+b),k*(e-b),k)}this.Dc(1993)};c.prototype.Rr=function(b){this.wc();var c=this.aa();0>b&&(b=c-1);if(b>=c)throw a.g.F();for(var e=this.wa(b),d=this.La(b),f=0,k=this.description.Ga;f<k;f++)if(null!=this.ya[f]){var p=a.ma.Xa(this.description.Sd(f));this.ya[f].Ek(p*e,p*d,p*
this.qa)}for(e=b+1;e<=c;e++)f=this.kb.read(e),this.kb.write(e-1,f-d);if(null==this.jb)for(e=b+1;e<=c;e++)b=this.jb.read(e),this.jb.write(e-1,b);this.kb.resize(c);this.jb.resize(c);this.qa-=d;this.lh-=d;this.Dc(1993)};c.prototype.Yf=function(b,c,d,f){if(c==this)throw a.g.F();if(d>=c.aa())throw a.g.F();var e=this.aa();if(b>e)throw a.g.F();0>b&&(b=e);0>d&&(d=c.aa()-1);this.hh=!1;this.om(c.description);c.wc();var g=c.wa(d),k=c.La(d),n=this.qa,p=c.Qb(d)&&!f?1:0;this.zl(this.qa+k);this.wc();for(var y=b<
e?this.wa(b):n,h=0,l=this.description.Ga;h<l;h++){var m=this.description.Sd(h),q=c.description.mg(m),r=a.ma.Xa(m);0<=q&&null!=c.ya[q]?(0!=p&&this.ya[h].Qk(y*r,c.ya[q],r*g,r,!0,r,r*n),this.ya[h].Qk((y+p)*r,c.ya[q],r*(g+p),r*(k-p),f,r,r*(n+p))):this.ya[h].Vj(y*r,a.ma.de(m),r*k,r*n)}this.kb.add(n+k);for(f=e;f>=b+1;f--)g=this.kb.read(f-1),this.kb.write(f,g+k);c.ft(d);this.jb.add(0);for(f=e-1;f>=b+1;f--)e=this.jb.read(f),e&=-5,this.jb.write(f+1,e);e=c.DT().read(d);e&=-5;this.$f&&(e|=1);this.jb.write(b,
e)};c.prototype.sA=function(b,c){var e=-1,d=this.aa();if(e>d)throw a.g.F();0>e&&(e=d);this.hh=!1;var g=this.qa;this.zl(this.qa+c);this.wc();var f=e<d?this.wa(e):g;null!=b?this.ya[0].Sq(2*f,b,0,c,!0,2*g):(b=a.ma.de(0),this.ya[0].Vj(2*f,b,2*c,2*g));for(var k=1,p=this.description.Ga;k<p;k++){b=this.description.qd(k);var h=a.ma.Xa(b);b=a.ma.de(b);this.ya[k].Vj(f*h,b,h*c,h*g)}this.kb.add(this.qa);for(g=d;g>=e+1;g--)f=this.kb.read(g-1),this.kb.write(g,f+c);this.jb.add(0);for(g=d-1;g>=e+1;g--)d=this.jb.read(g),
d&=-5,this.jb.write(g+1,d);this.$f&&this.jb.write(e,1)};c.prototype.EH=function(b,c,d){var e=-1;0>b&&(b=this.aa());if(b>this.aa()||e>this.La(b)||d>c.length)throw a.g.X("index out of bounds");if(0!=d){b==this.aa()&&(this.kb.add(this.qa),this.$f?this.jb.add(1):this.jb.add(0));0>e&&(e=this.La(b));this.wc();var g=this.qa;this.zl(this.qa+d);this.wc();for(var f=0,k=this.description.Ga;f<k;f++){var n=this.description.Sd(f),p=a.ma.Xa(n);this.ya[f].ho(p*(this.wa(b)+e+d),(g-this.wa(b)-e)*p,this.ya[f],p*(this.wa(b)+
e),!0,p);0==f?this.ya[f].ks(p*(this.wa(b)+e),d,c,0,!0):this.ya[f].Zh(a.ma.de(n),(this.wa(b)+e)*p,d*p)}this.hn()&&(this.cf.ho(this.wa(b)+e+d,g-this.wa(b)-e,this.cf,this.wa(b)+e,!0,1),this.tj.ho(this.wa(b)+e+d,g-this.wa(b)-e,this.tj,this.wa(b)+e,!0,1),this.cf.Zh(1,this.wa(b)+e,d),this.tj.Zh(-1,this.wa(b)+e,d));b+=1;for(c=this.aa();b<=c;b++)this.kb.write(b,this.kb.read(b)+d)}};c.prototype.Zf=function(b,c,d){var e=this.aa();0>b&&(b=this.aa());if(b>=e||c>this.La(b))throw a.g.X("index out of bounds");b==
this.aa()&&(this.kb.add(this.qa),this.$f?this.jb.add(1):this.jb.add(0));0>c&&(c=this.La(b));var g=this.qa;this.zl(this.qa+1);this.wc();var f=this.wa(b);this.ya[0].eh(2*(f+c),d,2*g);d=1;for(var k=this.description.Ga;d<k;d++){var n=this.description.Sd(d),p=a.ma.Xa(n);this.ya[d].Vj(p*(f+c),a.ma.de(n),p,p*g)}for(b+=1;b<=e;b++)this.kb.write(b,this.kb.read(b)+1)};c.prototype.dC=function(b,c){var e=this.aa();0>b&&(b=e-1);if(b>=e||c>=this.La(b))throw a.g.X("index out of bounds");this.wc();var d=this.wa(b);
0>c&&(c=this.La(b)-1);d+=c;c=0;for(var g=this.description.Ga;c<g;c++)if(null!=this.ya[c]){var f=a.ma.Xa(this.description.Sd(c));this.ya[c].Ek(f*d,f,f*this.qa)}for(;e>=b+1;e--)d=this.kb.read(e),this.kb.write(e,d-1);this.qa--;this.lh--;this.Dc(1993)};c.prototype.FF=function(b,c,d,f){b=this.wa(b)+c;d=this.wa(d)+f;if(d<b||0>b||d>this.D()-1)throw a.g.F();f=this.Fa();c=0;f.Tb(b);do{for(;f.Ea();){b=f.ba();if(f.Db()==d)break;b=b.Rb();c+=b}if(f.Db()==d)break}while(f.Ya());return c};c.prototype.gQ=function(b,
c,d){c=this.wa(b)+c;d=this.wa(b)+d;if(0>c||d>this.D()-1)throw a.g.F();var e=this.Fa();if(c>d){if(!this.Qb(b))throw a.g.F("cannot iterate across an open path");e.kC()}var g=b=0;e.Tb(c);do g+=b,b=e.ba().Rb();while(e.Db()!=d);return g};c.prototype.Gg=function(){return a.Pi.Rm(this,null)};c.prototype.GU=function(b,c,d,f){for(var e=b;e<d-1;e++)if(this.Qb(e))throw a.g.F("cannot interpolate across closed paths");e=this.description.Ga;if(1!=e){var g=this.FF(b,c,d,f);if(0!=g)for(var k=1;k<e;k++){var n=this.description.qd(k);
if(2!=a.ma.Xz(n))for(var p=a.ma.Xa(n),h=0;h<p;h++)this.IU(n,b,c,d,f,g,h)}}};c.prototype.FU=function(b,c,d){var e=this.description.Ga;if(1!=e){var g=this.gQ(b,c,d);if(0!=g)for(var f=1;f<e;f++){var k=this.description.qd(f);if(2!=a.ma.Xz(k))for(var n=a.ma.Xa(k),p=0;p<n;p++)this.HU(k,b,c,d,g,p)}}};c.prototype.IU=function(b,c,d,f,k,p,h){var e=this.Fa();c=this.wa(c)+d;f=this.wa(f)+k;k=this.Yc(b,c,h);d=this.Yc(b,f,h);var g=k,n=0;e.Tb(c);do if(e.Ea()){e.ba();if(e.Db()==f)break;this.setAttribute(b,e.Db(),
h,g);e.Li();do{c=e.ba();if(e.Ik()==f)return;c=c.Rb();n+=c;g=a.Ub.Xq(k,d,n/p);e.Fo()||this.setAttribute(b,e.Ik(),h,g)}while(e.Ea())}while(e.Ya())};c.prototype.HU=function(b,c,d,f,k,p){var e=this.Fa(),g=this.wa(c)+d;c=this.wa(c)+f;if(c!=g){f=this.Yc(b,g,p);d=this.Yc(b,c,p);var n=0;e.Tb(g);e.kC();g=f;do{var h=e.ba();this.setAttribute(b,e.Db(),p,g);g=h.Rb();n+=g;g=a.Ub.Xq(f,d,n/k)}while(e.Ik()!=c)}};c.prototype.Oa=function(){this.ir=0;this.hh=!1;this.Xd=this.cf=this.tj=this.jb=this.kb=null;this.NE()};
c.prototype.Xc=function(b){b instanceof a.Hd?this.lF(b,-1):this.zP(b)};c.prototype.lF=function(b,c){if(!this.u()&&!b.Ho()){this.wc();var e=this.ya[0],d=new a.b,g=new a.b,f,k,p;for(0>c?(f=this.hn(),k=0,p=this.qa):(f=this.ft(c),k=this.wa(c),p=this.Gc(c));k<p;k++){d.x=e.read(2*k);d.y=e.read(2*k+1);if(f&&(c=this.tj.read(k),0<=c))switch(this.cf.read(k)&7){case 2:g.x=this.Xd.read(c);g.y=this.Xd.read(c+1);b.$h(g,g);this.Xd.write(c,g.x);this.Xd.write(c+1,g.y);g.x=this.Xd.read(c+3);g.y=this.Xd.read(c+4);b.$h(g,
g);this.Xd.write(c+3,g.x);this.Xd.write(c+4,g.y);break;case 4:throw a.g.za();}b.$h(d,d);e.write(2*k,d.x);e.write(2*k+1,d.y)}this.Dc(1993)}};c.prototype.zP=function(b){if(!this.u()){this.Td(1);this.wc();for(var c=this.ya[0],e=this.ya[1],d=new a.pd,f=new a.pd,k=this.hn(),p=0;p<this.qa;p++){d.x=c.read(2*p);d.y=c.read(2*p+1);d.z=e.read(p);if(k){var h=this.tj.read(p);if(0<=h)switch(this.cf.read(p)&7){case 2:f.x=this.Xd.read(h);f.y=this.Xd.read(h+1);f.z=this.Xd.read(h+2);f=b.Rp(f);this.Xd.write(h,f.x);
this.Xd.write(h+1,f.y);this.Xd.write(h+1,f.z);f.x=this.Xd.read(h+3);f.y=this.Xd.read(h+4);f.z=this.Xd.read(h+5);f=b.Rp(f);this.Xd.write(h+3,f.x);this.Xd.write(h+4,f.y);this.Xd.write(h+5,f.z);break;case 4:throw a.g.za();}}d=b.Rp(d);c.write(2*p,d.x);c.write(2*p+1,d.y);e.write(p,d.z)}this.Dc(1993)}};c.prototype.Py=function(){null==this.kb&&(this.kb=a.Uc.wh(1,0),this.jb=a.Uc.vq(1,0));null!=this.cf&&(this.cf.resize(this.lh,1),this.tj.resize(this.lh,-1))};c.prototype.iq=function(b){b.hh=!1;b.ir=this.ir;
b.mr=this.mr;null!=this.kb?b.kb=a.ia.Ak(this.kb):b.kb=null;null!=this.jb?b.jb=a.Fm.Ak(this.jb):b.jb=null;null!=this.tj?b.tj=a.ia.Ak(this.tj):b.tj=null;null!=this.cf?b.cf=a.Fm.Ak(this.cf):b.cf=null;null!=this.Xd?b.Xd=a.Qd.Ak(this.Xd):b.Xd=null;b.hr=this.hr;b.gr=this.gr;this.xk(1024)?b.bj=null:b.bj=this.bj};c.prototype.Rb=function(){if(!this.xk(512))return this.hr;for(var b=this.Fa(),c=new a.ry(0);b.Ya();)for(;b.Ea();)c.add(b.ba().Rb());this.hr=c.en();this.lg(512,!1);return c.en()};c.prototype.Eb=function(a){if(a==
this)return!0;if(!(a instanceof c&&b.prototype.Eb.call(this,a)))return!1;var e=this.aa();return e!=a.aa()||null!=this.kb&&!this.kb.Eb(a.kb,0,e+1)||this.mr!=a.mr||null!=this.jb&&!this.jb.Eb(a.jb,0,e)?!1:b.prototype.Eb.call(this,a)};c.prototype.Fa=function(){return new a.ZN(this)};c.prototype.Oy=function(a){b.prototype.Oy.call(this,a);if(this.hn())for(a=this.Fa();a.Ya();)for(;a.Ea();)break};c.prototype.uo=function(a,c){b.prototype.uo.call(this,a,c);if(this.hn())for(a=this.Fa();a.Ya();)for(;a.Ea();)break};
c.prototype.Iy=function(){null==this.kb||0==this.kb.size?this.qa=0:this.qa=this.kb.read(this.kb.size-1)};c.prototype.hf=function(){if(!this.$f)return 0;this.gv();return this.gr};c.prototype.rw=function(a){if(!this.$f)return!1;if(!this.xk(8))return 0!=(this.jb.read(a)&4);this.gv();return 0<this.bj.read(a)};c.prototype.Sm=function(a){if(!this.$f)return 0;this.gv();return this.bj.read(a)};c.prototype.gv=function(){if(this.xk(1024)){var b=this.aa();null==this.bj?this.bj=new a.Qd(b):this.bj.size!=b&&this.bj.resize(b);
for(var b=new a.ry(0),c=new a.ry(0),d=new a.b,f=0,k=this.Fa();k.Ya();){c.reset();for(this.w(this.wa(k.Ta),d);k.Ea();)c.add(k.ba().Cy(d.x,d.y));b.add(c.en());var p=f++;this.bj.write(p,c.en())}this.gr=b.en();this.lg(1024,!1)}};c.prototype.zT=function(){if(this.$f){this.Al();for(var a=0,b=this.aa(),c=0;c<b;c++)0!=(this.jb.read(c)&4)&&a++}};c.prototype.Al=function(){if(this.xk(8)){this.gv();var b=this.aa();if(null==this.jb||this.jb.size<b)this.jb=a.Uc.vq(b+1);for(var c=1,d=0;d<b;d++){var f=this.bj.read(d);
0==d&&(c=0<f?1:-1);0<f*c?this.jb.jC(d,4):this.jb.fz(d,4)}this.lg(8,!1)}};c.prototype.cw=function(b){var c=this.Ta,e=this.aa();if(0<=c&&c<e){if(b<this.Gc(c)){if(b>=this.wa(c))return c;c--}else c++;if(0<=c&&c<e&&b>=this.wa(c)&&b<this.Gc(c))return this.Ta=c}if(5>e){for(c=0;c<e;c++)if(b<this.Gc(c))return this.Ta=c;throw a.g.X("corrupted geometry");}c=0;for(--e;e>c;){var d=c+(e-c>>1),f=this.wa(d);if(b<f)e=d-1;else if(c=this.Gc(d),b>=c)c=d+1;else return this.Ta=d}return this.Ta=c};c.prototype.nT=function(b){var c=
this.Pa(0);this.ET();var e=this.Gc(b),d=this.wa(b);b=-1;var f=new a.b,k=new a.b;f.y=-Infinity;f.x=-Infinity;for(d+=0;d<e;d++)c.fc(2*d,k),-1==f.compare(k)&&(b=d,f.L(k));return b};c.prototype.jA=function(){var a=this.D();if(!this.$f)for(var a=a-this.aa(),b=0,c=this.aa();b<c;b++)this.Qb(b)&&a++;return a};c.prototype.ew=function(a){var b=this.La(a);this.Qb(a)||b--;return b};c.prototype.Ka=function(){return new c(this.$f,this.description)};c.prototype.tb=function(){return this.$f?2:1};c.prototype.G=function(){return this.$f?
1736:1607};c.prototype.ET=function(){this.Cu()};c.prototype.HK=function(a){this.kb=a;this.Dc(16777215)};c.prototype.PT=function(){this.Cu();return this.cf};c.prototype.DT=function(){this.Cu();return this.jb};c.prototype.GK=function(a){this.jb=a;this.Dc(16777215)};c.prototype.aa=function(){return null!=this.kb?this.kb.size-1:0};c.prototype.Gc=function(a){return this.kb.read(a+1)};c.prototype.La=function(a){return this.kb.read(a+1)-this.kb.read(a)};c.prototype.wa=function(a){return this.kb.read(a)};
c.prototype.Xu=function(b,c){null==this.ob&&(this.ob=new a.vl);c=a.xy.lX(c);var e=this.ob.Hi;if(null!=e)if(e.il<b||c>e.LT())this.ob.My(null);else return!0;e=a.xy.create(this,b,c);this.ob.My(e);return!0};c.prototype.jc=function(){var a=b.prototype.jc.call(this);if(!this.Hc()){var c=this.aa();null!=this.kb&&this.kb.zk(a,0,c+1);null!=this.jb&&this.jb.zk(a,0,c)}return a};c.prototype.jH=function(a){return null!=this.cf?this.cf.read(a):1};c.prototype.ic=function(b,c,d){var e=this.cw(b);if(b==this.Gc(e)-
1&&!this.Qb(e))throw a.g.X("index out of bounds");this.wc();var g=this.cf,f=1;null!=g&&(f=g.read(b)&7);switch(f){case 1:c.Js();break;case 2:throw a.g.za();case 4:throw a.g.za();default:throw a.g.za();}c=c.get();d?c.Fg(a.ze.Ig()):c.Fg(this.description);e=b==this.Gc(e)-1&&this.Qb(e)?this.wa(e):b+1;g=new a.b;this.w(b,g);c.Mc(g);this.w(e,g);c.Zc(g);if(!d)for(d=1,g=this.description.Ga;d<g;d++)for(var f=this.description.Sd(d),k=a.ma.Xa(f),n=0;n<k;n++){var p=this.Yc(f,b,n);c.Tx(f,n,p);p=this.Yc(f,e,n);c.Lx(f,
n,p)}};c.prototype.jk=function(b,c){if(b>=this.aa())throw a.g.F();if(this.u())c.Oa();else{if(this.ft(b))throw a.g.X("not implemented");var e=this.Pa(0),d=new a.b,g=new a.h;g.Oa();var f=this.wa(b);for(b=this.Gc(b);f<b;f++)e.fc(2*f,d),g.Nb(d);c.I(g)}};c.prototype.iX=function(b,c){if(b>=this.aa())throw a.g.F();if(this.u())c.Oa();else{if(this.ft(b))throw a.g.X("not implemented");var e=this.Pa(0),d=new a.b,g=new a.h;g.Oa();var f=this.wa(b);for(b=this.Gc(b);f<b;f++)e.fc(2*f,d),g.Nb(d);c.I(g)}};c.prototype.Hj=
function(b){null==this.ob&&(this.ob=new a.vl);if(0==b||16>this.D())return!1;b=a.na.BF(this);this.ob.OE(b);return!0};c.prototype.CO=function(){null==this.ob&&(this.ob=new a.vl);if(null!=this.ob.np)return!0;this.ob.PE(null);var b=a.na.bQ(this);this.ob.PE(b);return!0};c.prototype.Hp=function(a){this.mr=a};c.prototype.xo=function(){return this.mr};c.prototype.VE=function(b){if(this==b)throw a.g.X("MultiPathImpl.add");for(var c=this.aa(),e=0;e<b.aa();e++)this.Ti(b,e,!0),this.oW(c),c++};c.prototype.oQ=
function(b){var c=this.cw(b),e=this.wa(c);if(e!=b){c=this.Gc(c);if(b>=c||b<e)throw a.g.X("change_ring_start_point");for(var d=0,f=this.description.Ga;d<f;d++){var k=this.description.qd(d),k=a.ma.Xa(k);this.ya[d].rotate(e*k,b*k,c*k)}}};c.te=[0,0,6,0,8,0];return c}(a.Mu);a.wl=b})(x||(x={}));(function(a){var b=function(b){function c(c){b.call(this);if(void 0!==c){if(null==c)throw a.g.F();this.description=c}else this.description=a.ze.Ig();this.qa=0}I(c,b);c.prototype.Ka=function(){return new c(this.description)};
c.prototype.add=function(a){this.resize(this.qa+1);this.Yh(this.qa-1,a)};c.prototype.lv=function(b,c){this.resize(this.qa+1);var e=new a.b;e.ka(b,c);this.rb(this.qa-1,e)};c.prototype.Id=function(b,c,d){d=0>d?b.D():d;if(0>c||c>b.D()||d<c)throw a.g.F();if(c!=d){this.om(b.description);d-=c;var e=this.qa;this.resize(this.qa+d);this.wc();for(var g=0,f=b.description.Ga;g<f;g++){var k=b.description.Sd(g),n=a.ma.Xa(k),p=this.Pa(k),k=b.Pa(k);p.Qk(e*n,k,c*n,d*n,!0,1,e*n)}}};c.prototype.ZE=function(b,c){var e=
b.length;c=0>c?e:c;if(0>e||0>c)throw a.g.F();if(0!=c){e=c-0;c=this.qa;this.resize(this.qa+e);for(var d=0;d<e;d++)this.rb(c+d,b[0+d])}};c.prototype.dC=function(b){if(0>b||b>=this.D())throw a.g.X("index out of bounds");this.wc();for(var c=0,e=this.description.Ga;c<e;c++)if(null!=this.ya[c]){var d=a.ma.Xa(this.description.Sd(c));this.ya[c].Ek(d*b,d,d*this.qa)}this.qa--;this.lh--;this.Dc(1993)};c.prototype.resize=function(a){this.zl(a)};c.prototype.iq=function(){};c.prototype.Oa=function(){b.prototype.NE.call(this)};
c.prototype.Xc=function(b){if(b instanceof a.Hd){if(!this.u()){this.wc();for(var c=this.ya[0],e=new a.b,d=0;d<this.qa;d++)e.x=c.read(2*d),e.y=c.read(2*d+1),b.$h(e,e),c.write(2*d,e.x),c.write(2*d+1,e.y);this.Dc(1993)}}else if(!this.u()){this.wc();this.Td(1);this.wc();for(var c=this.ya[0],e=this.ya[1],f=new a.pd,d=0;d<this.qa;d++){f.x=c.read(2*d);f.y=c.read(2*d+1);f.z=e.read(d);var k=b.Rp(f);c.write(2*d,k.x);c.write(2*d+1,k.y);e.write(d,k.z)}this.Dc(1993)}};c.prototype.tb=function(){return 0};c.prototype.G=
function(){return 550};c.prototype.hf=function(){return 0};c.prototype.Rb=function(){return 0};c.prototype.Eb=function(a){return a==this?!0:a instanceof c?b.prototype.Eb.call(this,a):!1};c.prototype.nP=function(b){var c=b.length,e=c;if(0>c||0>c||0>e)throw a.g.F();this.Td(1);if(0!=e){c=e-0;e=this.qa;this.aK(this.qa+c);for(var d=this.Pa(0),f=0;f<c;f++){var k=b[0+f].y;d.write(2*(e+f),b[0+f].x);d.write(2*(e+f)+1,k)}d=this.Pa(1);for(f=0;f<c;f++)d.write(e+f,b[0+f].z);this.Dc(1993)}};c.prototype.oP=function(b,
c){var e=b.length;c=0>c?e:c;if(0>e||0>c)throw a.g.F();if(0!=c){e=c-0;if(0!=(e&1))throw a.g.F();c=this.qa;this.aK(this.qa+e/2);this.ya[0].js(2*c,e,b,0,!0)}};c.prototype.aK=function(b){var c=this.qa;this.zl(b);if(this.qa>c){b=1;for(var e=this.description.Ga;b<e;b++){var d=this.description.qd(b),f=a.ma.Xa(d);this.ya[b].Vj(f*c,a.ma.de(d),f*(this.qa-c),f*c)}}};c.prototype.fX=function(b,c){var e=this.qa,e=Math.min(e,c+1E3);if(0>c||c>=this.qa||e<c||1E3!=b.length)throw a.g.F();var d=this.Pa(0),g=e-c,f=[];
d.ol(2*c,2*g,f,0,!0);for(d=0;d<g;d++)b[d]=a.b.pa(f[2*d],f[2*d+1]);return e};c.prototype.gX=function(b,c){var e=this.qa,e=Math.min(e,0+c);if(0>=this.qa||0>e||b.length!=c)throw a.g.F();c=this.Pa(0);var d=null,g=a.ma.de(1),f=this.hasAttribute(1);f&&(d=this.Pa(1));var e=e-0,k=[],p=[];c.ol(0,2*e,k,0,!0);d.ol(0,e,p,0,!0);for(c=0;c<e;c++)b[c]=new a.pd(k[2*c],k[2*c+1],f?p[c]:g)};c.prototype.Iy=function(){};c.prototype.Py=function(){};c.prototype.Xu=function(){return!1};c.prototype.Hj=function(){return!1};
c.prototype.Gg=function(){return null};return c}(a.Mu);a.Ed=b})(x||(x={}));(function(a){(function(a){a[a.NotDetermined=0]="NotDetermined";a[a.Structure=1]="Structure";a[a.DegenerateSegments=2]="DegenerateSegments";a[a.Clustering=3]="Clustering";a[a.Cracking=4]="Cracking";a[a.CrossOver=5]="CrossOver";a[a.RingOrientation=6]="RingOrientation";a[a.RingOrder=7]="RingOrder";a[a.OGCPolylineSelfTangency=8]="OGCPolylineSelfTangency";a[a.OGCPolygonSelfTangency=9]="OGCPolygonSelfTangency";a[a.OGCDisconnectedInterior=
10]="OGCDisconnectedInterior"})(a.YM||(a.YM={}));var b=function(){function a(a,b,c){void 0===a?(this.Ii=0,this.mm=this.lm=-1):(this.Ii=a,this.lm=b,this.mm=c)}a.prototype.ms=function(a){this.Ii=a.Ii;this.lm=a.lm;this.mm=a.mm};return a}();a.$d=b})(x||(x={}));(function(a){var b=function(){function b(){}b.YZ=function(b){if(!1===b)throw a.g.KL();};b.SK=function(a){return isNaN(a)?NaN:0===a?a:0<a?1:-1};b.qv=function(a){var c;void 0===c&&(c=0);for(var d=[],f=0;f<a;f++)d[f]=b.gf(2,c);return d};b.gf=function(a,
b){void 0===b&&(b=0);for(var c=[],e=0;e<a;e++)c[e]=b;return c};b.Nv=function(a,b){var c,e;void 0===c&&(c=0);for(void 0===e&&(e=a.length-1);c<=e;c++)a[c]=b};b.pk=function(a,b,c){return a<b?b:a>c?c:a};b.t_=function(){return 4};b.dh=function(a,b){var c=5381;void 0!==b?c=(b<<5)+b+(a&255):c=(c<<5)+c+(a&255);c=(c<<5)+c+(a>>8&255);c=(c<<5)+c+(a>>16&255);return(c<<5)+c+(a>>24&255)&2147483647};b.Zi=function(){throw Error("Not Implemented");};b.p_=function(){return-Infinity};b.r_=function(){return Infinity};
b.h_=function(){return 2147483647};b.UZ=function(){return 2.220446049250313E-16};b.VZ=function(){return 1.7976931348623157E308};b.IB=function(a){return b.eZ(a)+12345&2147483647};b.gI=function(a){var c=32,d=a%b.qA|0,f=a/b.qA|0;if(0===(c&=63))return a;32>c?(a=d>>>c|f<<32-c,c=f>>c):(a=f>>c-32,c=0<=f?0:-1);return c*b.qA+(a>>>0)};b.eZ=function(a){a|=0;return(1103495168*a|0)+(20077*a|0)|0};b.truncate=function(a){return 0>a?-1*Math.floor(Math.abs(a)):Math.floor(a)};b.hV=Math.pow(2,53)-1;b.XZ=-b.hV;b.jD=
65536;b.K_=16777216;b.qA=b.jD*b.jD;return b}();a.J=b})(x||(x={}));(function(a){(function(a){a[a.Project=0]="Project";a[a.Union=1]="Union";a[a.Difference=2]="Difference";a[a.Proximity2D=3]="Proximity2D";a[a.Relate=4]="Relate";a[a.Equals=5]="Equals";a[a.Disjoint=6]="Disjoint";a[a.Intersects=7]="Intersects";a[a.Within=8]="Within";a[a.Contains=9]="Contains";a[a.Crosses=10]="Crosses";a[a.Touches=11]="Touches";a[a.Overlaps=12]="Overlaps";a[a.Buffer=13]="Buffer";a[a.Distance=14]="Distance";a[a.Intersection=
15]="Intersection";a[a.Clip=16]="Clip";a[a.Cut=17]="Cut";a[a.DensifyByLength=18]="DensifyByLength";a[a.DensifyByAngle=19]="DensifyByAngle";a[a.LabelPoint=20]="LabelPoint";a[a.GeodesicBuffer=21]="GeodesicBuffer";a[a.GeodeticDensifyByLength=22]="GeodeticDensifyByLength";a[a.ShapePreservingDensify=23]="ShapePreservingDensify";a[a.GeodeticLength=24]="GeodeticLength";a[a.GeodeticArea=25]="GeodeticArea";a[a.Simplify=26]="Simplify";a[a.SimplifyOGC=27]="SimplifyOGC";a[a.Offset=28]="Offset";a[a.Generalize=
29]="Generalize";a[a.SymmetricDifference=30]="SymmetricDifference";a[a.ConvexHull=31]="ConvexHull";a[a.Boundary=32]="Boundary";a[a.SimpleRelation=33]="SimpleRelation"})(a.tN||(a.tN={}));var b=function(){function b(){}b.prototype.G=function(){return null};b.prototype.qo=function(){return!1};b.prototype.wv=function(){return!1};b.NZ=function(b){a.T.gh(b.G())&&(b=b.ob,null!=b&&(b.My(null),b.OE(null)))};return b}();a.ef=b})(x||(x={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}
I(c,b);c.prototype.G=function(){return 13};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.V=function(b,c,d,f,k){return b instanceof a.T?(k=new a.hd(b),this.V(k,c,[d],!1,f).next()):!0===f?(d=new a.ED(b,c,d,!1,k),a.ei.local().V(d,c,k)):new a.ED(b,c,d,!1,k)};c.$=null;return c}(a.ef);a.DD=b})(x||(x={}));(function(a){var b=function(){function b(b,c,d,f,p){this.Ca=-1;this.ie=b;this.JA=c;this.yt=d;this.uV=new a.h;this.uV.Oa();this.To=-1;this.mc=p}b.prototype.next=function(){for(var a;null!=
(a=this.ie.next());)return this.Ca=this.ie.Ia(),this.To+1<this.yt.length&&this.To++,this.buffer(a,this.yt[this.To]);return null};b.prototype.Ia=function(){return this.Ca};b.prototype.buffer=function(b,c){return a.QL.buffer(b,c,this.JA,NaN,96,this.mc)};b.prototype.Re=function(){return!0};return b}();a.ED=b})(x||(x={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}I(c,b);c.prototype.G=function(){return 16};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.V=function(b,
c,d,f){return b instanceof a.T?(b=new a.hd(b),this.V(b,c,d,f).next()):new a.dN(b,c,d,f)};c.$=null;return c}(a.ef);a.cN=b})(x||(x={}));(function(a){var b=function(){function b(b,c,d){this.Ca=-1;if(null==b)throw a.g.F();this.R=c;this.Zk=b;this.ta=a.na.be(d,c,!1)}b.prototype.next=function(){var b;return null!=(b=this.Zk.next())?(this.Ca=this.Zk.Ia(),a.ne.clip(b,this.R,this.ta,0)):null};b.prototype.Ia=function(){return this.Ca};b.prototype.Re=function(){return!0};return b}();a.dN=b})(x||(x={}));(function(a){var b=
function(b){function c(){b.apply(this,arguments)}I(c,b);c.prototype.G=function(){return 31};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.V=function(b,c,d){return b instanceof a.T?a.GD.EF(b):new a.GD(c,b,d)};c.$=null;return c}(a.ef);a.FD=b})(x||(x={}));(function(a){var b=function(){function b(b,c,d){this.bB=new a.Ju;this.Ca=-1;if(null==c)throw a.g.F();this.oI=b;this.Pc=!1;this.Zk=c;this.mc=d}b.prototype.next=function(){if(this.oI){if(!this.Pc){var a=this.fQ(this.Zk);this.Pc=!0;
return a}return null}if(!this.Pc){a=this.Zk.next();if(null!=a)return this.Ca=this.Zk.Ia(),b.EF(a);this.Pc=!0}return null};b.prototype.Ia=function(){return this.Ca};b.prototype.fQ=function(a){for(var b;null!=(b=a.next());)this.bB.Jb(b);return this.bB.VS()};b.prototype.Re=function(){if(this.Pc)return!0;if(!this.oI)throw a.g.X("Invalid call for non merging convex hull.");var b=this.Zk.next();if(null!=b)return this.bB.Jb(b),!0;throw a.g.X("Expects a non-null geometry.");};b.EF=function(c){if(b.Wg(c))return c;
var e=c.G();if(a.wl.Oc(e))return e=new a.Ua(c.description),e.dc(c,!0),e;if(550==e&&2==c.D()){var d=new a.Wa,e=new a.Ua(c.description);c.Ae(0,d);e.Rf(d);c.Ae(1,d);e.lineTo(d);return e}return a.Ju.VQ(c)};b.Wg=function(b){if(b.u())return!0;var c=b.G();return 33==c||197==c?!0:a.wl.Oc(c)?!1:550==c?1==b.D()?!0:!1:1607==c?1==b.aa()&&2>=b.D()?!0:!1:1!=b.aa()?!1:2>=b.D()?!0:a.Ju.VH(b,0)};return b}();a.GD=b})(x||(x={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}I(c,b);c.prototype.G=
function(){return 17};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.V=function(b,c,d,f,k){return new a.fN(b,c,d,f,k)};c.$=null;return c}(a.ef);a.eN=b})(x||(x={}));(function(a){var b=function(){function b(b,c,d,f,p){this.qg=null;if(null==c||null==d)throw a.g.X("invalid argument");this.rV=b;this.WA=c;this.xI=d;b=a.na.Zv(c,d);this.ta=a.na.be(f,b,!0);this.wI=-1;this.ke=p}b.prototype.Ia=function(){return 0};b.prototype.next=function(){this.IS();return++this.wI<this.qg.length?this.qg[this.wI]:
null};b.prototype.IS=function(){if(null==this.qg)switch(this.qg=[],this.WA.G()){case 1607:this.KS();break;case 1736:this.JS()}};b.prototype.KS=function(){var b=new a.Ua,c=new a.Ua,d=new a.Ua;this.qg.push(b);this.qg.push(c);var f=[];a.XL.VL(this.rV,this.WA,this.xI,this.ta,f,this.ke);for(var p=0;p<f.length;p++){var h=f[p];0==h.nx?b.add(h.Y,!1):1==h.nx||2==h.nx?c.add(h.Y,!1):3==h.nx?this.qg.push(h.Y):d.add(h.Y,!1)}d.u()||b.u()&&c.u()&&!(3<=this.qg.length)||this.qg.push(d);b.u()&&c.u()&&3>this.qg.length&&
(this.qg.length=0)};b.prototype.JS=function(){var b=new a.ia(0),c=new a.fd,d=c.iG(),f=c.Jb(this.WA),p=c.Jb(this.xI),h=new a.Dg;try{h.Xr(c,this.ta,this.ke);h.Hl(d,f,p,b);var l=c.Se(f),m=new a.Ja,q=new a.Ja;this.qg.length=0;this.qg.push(m);this.qg.push(q);for(f=0;f<b.size;f++){var r,t=new a.fd,A=t.Jb(l),u=t.Jb(c.Se(b.get(f)));h.Wr(t,this.ke);var v=h.nw(A,u);r=t.Se(v);if(!r.u()){var w=c.VG(b.get(f),d);2==w?m.add(r,!1):1==w?q.add(r,!1):this.qg.push(r);var x=new a.fd,A=x.Jb(l),u=x.Jb(c.Se(b.get(f)));h.Wr(x,
this.ke);l=x.Se(h.Vm(A,u))}}!l.u()&&0<b.size&&this.qg.push(l);m.u()&&q.u()&&(this.qg.length=0)}finally{h.qh()}};b.prototype.Re=function(){return!0};return b}();a.fN=b})(x||(x={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}I(c,b);c.prototype.G=function(){return 18};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.V=function(b,c,d){if(b instanceof a.T)return b=new a.hd(b),this.V(b,c,d).next();if(0>=c)throw a.g.F();return new a.gN(b,c,d)};c.$=null;return c}(a.ef);
a.Jm=b})(x||(x={}));(function(a){var b=function(){function b(a,b){this.Ca=-1;this.ie=a;this.Kt=b}b.prototype.Ia=function(){return this.Ca};b.prototype.next=function(){var a;return null!=(a=this.ie.next())?(this.Ca=this.ie.Ia(),this.KR(a)):null};b.prototype.KR=function(b){if(b.u()||1>b.tb())return b;var c=b.G();if(1736==c||1607==c)return this.wz(b);if(a.T.Oc(c))return this.MR(b);if(197==c)return this.LR(b);throw a.g.za();};b.prototype.MR=function(b){if(b.Rb()<=this.Kt)return b;var c=new a.Ua(b.description);
c.dc(b,!0);return this.wz(c)};b.prototype.LR=function(b){var c=new a.Ja(b.description);c.jd(b,!1);var d=new a.h;b.s(d);b=d.fa();return d.N()<=this.Kt&&b<=this.Kt?c:this.wz(c)};b.prototype.wz=function(b){for(var c=b.Ka(),d=b.Fa();d.Ya();)for(var f=!0;d.Ea();){var k=d.ba();if(322!=k.G())throw a.g.X("not implemented");var p=d.Fo(),h=k.Rb();if(h>this.Kt){var l=Math.ceil(h/this.Kt),h=new a.Wa(b.description);f&&(k.Dp(h),c.Rf(h));for(var m=f=1/l,q=0,l=l-1;q<l;q++)k.Fx(m,h),c.lineTo(h),m+=f;p?c.sq():(k.Bp(h),
c.lineTo(h))}else p?c.sq():c.dc(k,f);f=!1}return c};b.prototype.Re=function(){return!0};return b}();a.gN=b})(x||(x={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}I(c,b);c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.G=function(){return 2};c.prototype.V=function(b,c,d,f){return b instanceof a.T?(b=new a.hd(b),c=new a.hd(c),this.V(b,c,d,f).next()):new a.hN(b,c,d,f)};c.Vm=function(b,d,f,k){if(b.u()||d.u())return b;var e=b.tb(),g=d.tb();if(e>g)return b;var n=
b.G(),p=d.G(),h=new a.h,y=new a.h,l=new a.h;b.s(h);d.s(y);l.I(h);l.Nb(y);var l=a.na.be(f,l,!0),m=l*Math.sqrt(2)*1.00001,q=new a.h;q.I(h);q.O(m,m);if(!q.Yb(y))return b;if(1==e&&2==g)return c.TL(b,d,p,f,k);if(33==n)switch(a.wl.Oc(p)?(f=new a.Ua(d.description),f.dc(d,!0)):f=d,p){case 1736:return c.hO(b,f,l);case 1607:return c.lO(b,f,l);case 550:return c.WN(b,f,l);case 197:return c.QN(b,f,l);case 33:return c.dO(b,f,l);default:throw a.g.F();}else if(550==n)switch(p){case 1736:return c.DM(b,d,l);case 197:return c.nM(b,
d,l);case 33:return c.yM(b,d,l)}return a.Dg.Vm(b,d,f,k)};c.hO=function(b,c,d){return 0==a.gd.WH(c,b,d)?b:b.Ka()};c.lO=function(b,c,d){var e=b.w();c=c.Fa();for(var g=d*Math.sqrt(2)*1.00001,f=g*g,k=new a.h;c.Ya();)for(;c.Ea();){var n=c.ba();n.s(k);k.O(g,g);if(k.contains(e)){if(n.mt(e,d))return b.Ka();var p=n.ec();if(a.b.sc(e,p)<=f)return b.Ka();p=n.Bc();if(a.b.sc(e,p)<=f)return b.Ka()}}return b};c.WN=function(b,c,d){var e=c.Pa(0);c=c.D();var g=b.w(),f=new a.b;d=d*Math.sqrt(2)*1.00001;d*=d;for(var k=
0;k<c;k++)if(e.fc(2*k,f),a.b.sc(f,g)<=d)return b.Ka();return b};c.QN=function(b,c,d){var e=new a.h;c.s(e);e.O(d,d);c=b.w();return e.contains(c)?b.Ka():b};c.dO=function(b,c,d){d=d*Math.sqrt(2)*1.00001;d*=d;var e=b.w();c=c.w();return a.b.sc(e,c)<=d?b.Ka():b};c.DM=function(b,c,d){var e=new a.h;c.s(e);e.O(d,d);for(var g=b.D(),f=!1,k=[],n=0;n<g;n++)k[n]=!1;for(var p=new a.b,n=0;n<g;n++)b.w(n,p),e.contains(p)&&0!=a.gd.ge(c,p,d)&&(f=!0,k[n]=!0);if(!f)return b;c=b.Ka();for(n=0;n<g;n++)k[n]||c.Id(b,n,n+1);
return c};c.nM=function(b,c,d){var e=new a.h;c.s(e);e.O(d,d);c=b.D();var g=!1;d=[];for(var f=0;f<c;f++)d[f]=!1;for(var k=new a.b,f=0;f<c;f++)b.w(f,k),e.contains(k)&&(g=!0,d[f]=!0);if(!g)return b;e=b.Ka();for(f=0;f<c;f++)d[f]||e.Id(b,f,f+1);return e};c.yM=function(b,c,d){var e=b.Pa(0),g=b.D(),f=c.w(),k=new a.b,n=!1;c=[];for(var p=0;p<g;p++)c[p]=!1;p=d*Math.sqrt(2)*1.00001;d=p*p;for(p=0;p<g;p++)e.fc(2*p,k),a.b.sc(k,f)<=d&&(n=!0,c[p]=!0);if(!n)return b;e=b.Ka();for(p=0;p<g;p++)c[p]||e.Id(b,p,p+1);return e};
c.TL=function(b,c,d,f,k){var e=new a.ci;b.Qn(e);var g=new a.h;c.s(g);e.Nb(g);e.O(.1*e.N(),.1*e.fa());g=new a.Ja;g.jd(e,!1);1736==d?g.add(c,!0):g.jd(c,!0);return a.tk.local().V(b,g,f,k)};c.$=null;return c}(a.ef);a.cq=b})(x||(x={}));(function(a){var b=function(){function b(a,b,c,d){this.ot=null==b;this.Ca=-1;this.ie=a;this.JA=c;this.xV=b.next();this.mc=d}b.prototype.next=function(){if(this.ot)return null;var b;return null!=(b=this.ie.next())?(this.Ca=this.ie.Ia(),a.cq.Vm(b,this.xV,this.JA,this.mc)):
null};b.prototype.Ia=function(){return this.Ca};b.prototype.Re=function(){return!0};return b}();a.hN=b})(x||(x={}));(function(a){var b=function(){function b(b){this.ke=b;this.Zj=new a.h;this.Zj.Oa();this.Jh=new a.h;this.Jh.Oa()}b.prototype.Bu=function(){var a;a=this.Zj.o;this.Zj.o=this.Jh.o;this.Jh.o=a;a=this.Zj.v;this.Zj.v=this.Jh.v;this.Jh.v=a;a=this.Zj.A;this.Zj.A=this.Jh.A;this.Jh.A=a;a=this.Zj.B;this.Zj.B=this.Jh.B;this.Jh.B=a};b.prototype.$R=function(b,c){var e=!this.Zj.Yb(this.Jh);if(a.T.Ic(b.G())&&
a.T.Ic(c.G())){if(b.D()>c.D())return this.uF(b,c,e);this.Bu();e=this.uF(c,b,e);this.Bu();return e}if(550==b.G()&&a.T.Ic(c.G()))return e=this.vF(c,b,e),this.Bu(),e;if(550==c.G()&&a.T.Ic(b.G()))return this.vF(b,c,e);if(550==b.G()&&550==c.G()){if(b.D()>c.D())return this.wF(b,c);this.Bu();e=this.wF(c,b);this.Bu();return e}return 0};b.prototype.uF=function(b,c,d){var e=b.Fa(),g=c.Fa(),f=new a.h,k=new a.h,n=1.7976931348623157E308;if(!d&&this.rZ(b,c,e,g))return 0;for(;e.Ya();)for(;e.Ea();)if(b=e.ba(),b.s(f),
!(f.Zx(this.Jh)>n)){for(;g.Ya();)for(;g.Ea();)if(c=g.ba(),c.s(k),f.Zx(k)<n&&(c=b.Cb(c,d),c*=c,c<n)){if(0==c)return 0;n=c}g.yj()}return Math.sqrt(n)};b.prototype.vF=function(b,c,d){var e=b.Fa(),g=new a.h,f=1.7976931348623157E308,k=new a.b,n,p=c.D();for(d=!d&&1736==b.G();e.Ya();)for(;e.Ea();){var h=e.ba();h.s(g);if(!(1<p&&g.Zx(this.Jh)>f)){for(var l=0;l<p;l++){c.w(l,k);if(d&&0!=a.gd.ge(b,k,0))return 0;n=h.qe(k,!1);k.sub(h.gc(n));n=k.qk();if(n<f){if(0==n)return 0;f=n}}d=!1}}return Math.sqrt(f)};b.prototype.wF=
function(b,c){for(var e=1.7976931348623157E308,d=new a.b,g=new a.b,f,k=b.D(),p=c.D(),h=0;h<k;h++)if(b.w(h,d),!(1<p&&this.Jh.ZK(d)>e))for(var l=0;l<p;l++)if(c.w(l,g),f=a.b.sc(d,g),f<e){if(0==f)return 0;e=f}return Math.sqrt(e)};b.prototype.rZ=function(b,c,d,f){if(1736==b.G()){for(;f.Ya();)if(f.Ea()){var e=f.ba();if(0!=a.gd.ge(b,e.Bc(),0))return!0}f.yj()}if(1736==c.G()){for(;d.Ya();)if(d.Ea()&&(b=d.ba(),0!=a.gd.ge(c,b.Bc(),0)))return!0;d.yj()}return!1};b.prototype.Rm=function(a,b){if(a.u()||b.u())return NaN;
a.s(this.Zj);b.s(this.Jh);return this.$R(a,b)};return b}(),c=function(c){function e(){c.apply(this,arguments)}I(e,c);e.prototype.V=function(c,e,d){if(null==c||null==e)throw a.g.F();if(c.u()||e.u())return NaN;var g,f;g=c.G();f=e.G();if(33==g){if(33==f)return a.b.Cb(c.w(),e.w());if(197==f)return d=new a.h,e.s(d),d.Cb(c.w());g=new a.Ed;g.add(c);c=g}else if(197==g){if(197==f)return f=new a.h,c.s(f),d=new a.h,e.s(d),d.Cb(f);g=new a.Ja;g.jd(c,!1);c=g}33==f?(f=new a.Ed,f.add(e),e=f):197==f&&(f=new a.Ja,
f.jd(e,!1),e=f);return(new b(d)).Rm(c,e)};e.local=function(){null===e.$&&(e.$=new e);return e.$};e.prototype.G=function(){return 14};e.$=null;return e}(a.ef);a.iN=c})(x||(x={}));(function(a){var b=function(){function b(a,b,c,d){this.LI=a;this.TI=b;this.ke=d;this.lI=c}b.prototype.next=function(){var a=this.LI.next();return null==a?null:this.lD(a)};b.prototype.Ia=function(){return this.LI.Ia()};b.prototype.lD=function(b){var c=b.G();if(a.T.Jo(c))return b;if(197==c)return c=new a.Ja(b.description),c.jd(b,
!1),this.lD(c);if(b.u())return b;if(null==b)throw a.g.za();for(var c=b.Ka(),d=new a.Hb,f=0,k=b.aa();f<k;f++)this.pM(b,f,c,d);return c};b.prototype.pM=function(b,c,d,f){if(!(2>b.La(c))){var e=b.wa(c),g=b.Gc(c)-1,k=b.Pa(0),n=b.Qb(c),p=new a.ia(0);p.yb(b.La(c)+1);var h=new a.ia(0);h.yb(b.La(c)+1);p.add(n?e:g);p.add(e);for(e=new a.b;1<p.size;){var l=p.Fc();p.Pf();var m=p.Fc();b.w(l,e);f.Mc(e);b.w(m,e);f.Zc(e);m=this.lM(f,e,k,l,m,g);0<=m?(p.add(m),p.add(l)):h.add(l)}n||h.add(p.get(0));if(h.size==p.size)d.Ti(b,
c,!0);else if(2<=h.size&&(!this.lI||2!=h.size||!(n||a.b.Cb(b.Ba(h.get(0)),b.Ba(h.get(1)))<=this.TI))){c=new a.Wa;f=0;for(g=h.size;f<g;f++)b.Ae(h.get(f),c),0==f?d.Rf(c):d.lineTo(c);n&&(this.lI||2!=h.size||d.lineTo(c),d.sq())}}};b.prototype.lM=function(a,b,c,d,f,p){var e=f-1;f<=d&&(e=p);p=f=-1;for(d+=1;d<=e;d++){c.fc(2*d,b);var g=b.x,k=b.y;a.gc(a.qe(b,!1),b);b.x-=g;b.y-=k;g=b.length();g>this.TI&&g>p&&(f=d,p=g)}return f};b.prototype.Re=function(){return!0};return b}();a.jN=b})(x||(x={}));(function(a){var b=
function(b){function c(){b.apply(this,arguments)}I(c,b);c.prototype.G=function(){return 29};c.prototype.V=function(b,c,d,f){return b instanceof a.T?(b=new a.hd(b),this.V(b,c,d,f).next()):new a.jN(b,c,d,f)};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.$=null;return c}(a.ef);a.HD=b})(x||(x={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}I(c,b);c.prototype.G=function(){return 21};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.V=function(b,c,d,
f,k,p,h,l){return b instanceof a.T?(l=new a.hd(b),this.V(l,c,d,[f],k,p,!1,h).next()):!0===h?(d=new a.KD(b,c,d,f,k,!1,!1,l),a.ei.local().V(d,c,l)):new a.KD(b,c,d,f,k,!1,!1,l)};c.$=null;return c}(a.ef);a.JD=b})(x||(x={}));(function(a){var b=function(){function b(b,c,d,f,p,h,l,m){if(h)throw a.g.df();if(null==c)throw a.g.F();this.Ca=-1;this.Ht=b;this.Rg=c;this.$e=d;this.yt=f;this.Po=p;this.To=-1;this.mc=m;this.vV=new a.h;this.vV.Oa()}b.prototype.next=function(){for(var a;null!=(a=this.Ht.next());)return this.Ca=
this.Ht.Ia(),this.To+1<this.yt.length&&this.To++,this.SS(a,this.yt[this.To]);return null};b.prototype.Ia=function(){return this.Ca};b.prototype.SS=function(b,c){return a.sM.buffer(b,this.Rg,this.$e,c,this.Po,this.mc)};b.prototype.Re=function(){return!0};return b}();a.KD=b})(x||(x={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}I(c,b);c.prototype.G=function(){return 24};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.V=function(b,c,d,f){if(null==c)throw a.g.F();
if(b.u()||1>b.tb())return 0;if(4==d)throw a.g.df();var e=a.fb.lc(c),g=a.fb.hw(e),k=a.fb.Sv(e),g=g*(2-g),n=e.Vd().Ai,p=b.G(),h;1736==p||197==p?h=b.Gg():a.T.Oc(p)?(h=new a.Ua(b.description),h.dc(b,!0)):h=b;if(0==e.Eb(c)){if(a.fb.Jc(c)){h=a.gi.Mj(h,c);1607==p&&h==b&&(h=a.T.oe(b));b=new a.zc;a.fb.Bh(c).Sn(b);for(var p=0,y=h.D();p<y;p++){var l=h.Ba(p);l.x=a.gi.Nn(l.x,b);h.rb(p,l)}}b=h.Ka();h=a.gi.OJ(c,e,h,b,f)?b:a.fb.Xg(h,c,e,f)}return this.bS(h,d,k,g,n)};c.prototype.bS=function(b,c,d,f,k){var e=new a.ea(0),
g=0;for(b=b.Fa();b.Ya();)for(;b.Ea();){var n=b.ba(),p=n.ec(),n=n.Bc();p.scale(k);n.scale(k);a.mb.Ld(d,f,p.x,p.y,n.x,n.y,e,null,null,c);g+=e.j}return g};c.$=null;return c}(a.ef);a.mN=b})(x||(x={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}I(c,b);c.prototype.G=function(){return 18};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.V=function(b,c,d,f,k){return b instanceof a.T?(b=new a.hd(b),this.V(b,c,d,f,k).next()):new a.lN(b,d,f,c,-1,-1,k)};c.$=null;return c}(a.ef);
a.kN=b})(x||(x={}));(function(a){var b=function(){function b(b,c,d,f,p,h){if(0<h)throw a.g.df();if(4!=d&&0<p)throw a.g.df();if(null==c)throw a.g.F();this.Ca=-1;this.Ht=b;this.Rg=c;this.$e=d;this.CV=f;this.BV=p}b.prototype.next=function(){for(var a;null!=(a=this.Ht.next());)return this.Ca=this.Ht.Ia(),this.Hz(a);return null};b.prototype.Ia=function(){return this.Ca};b.prototype.Hz=function(b){return a.Ej.Ls(b,this.Rg,this.$e,this.CV,this.BV,this.mc)};b.prototype.Re=function(){return!0};return b}();
a.lN=b})(x||(x={}));(function(a){(function(a){a[a.Unknown=0]="Unknown";a[a.Contains=1]="Contains";a[a.Within=2]="Within";a[a.Equals=3]="Equals";a[a.Disjoint=4]="Disjoint";a[a.Touches=8]="Touches";a[a.Crosses=16]="Crosses";a[a.Overlaps=32]="Overlaps";a[a.NoThisRelation=64]="NoThisRelation";a[a.Intersects=1073741824]="Intersects";a[a.IntersectsOrDisjoint=1073741828]="IntersectsOrDisjoint"})(a.BM||(a.BM={}));var b=function(){function b(){}b.s_=function(c,e,d,f){if(e.u()||c.u())return 4;var g=c.G(),k=
e.G(),n;a.T.Oc(g)&&(c=n=new a.Ua(c.description),n.dc(c,!0));a.T.Oc(k)&&(e=n=new a.Ua(e.description),n.dc(e,!0));switch(g){case 33:switch(k){case 33:return b.FN(c,e,d);case 197:return b.te(b.CD(e,c,d));case 550:return b.te(b.aE(e,c,d));case 1607:return b.te(b.aD(e,c,d,f));case 1736:return b.te(b.oE(e,c,d))}throw a.g.za();case 197:switch(k){case 33:return b.CD(c,e,d);case 197:return b.JM(c,e,d);case 550:return b.te(b.TD(e,c,d,f));case 1607:return b.te(b.tE(e,c));case 1736:return b.te(b.kE(e,c))}throw a.g.za();
case 550:switch(k){case 33:return b.aE(c,e,d);case 197:return b.TD(c,e,d,f);case 550:return b.ZD(c,e,d,f);case 1607:return b.te(b.vE(e,c));case 1736:return b.te(b.mE(e,c))}throw a.g.za();case 1607:switch(k){case 33:return b.aD(c,e,d,f);case 197:return b.tE(c,e);case 550:return b.vE(c,e);case 1607:return b.mO(c,e);case 1736:return b.te(b.rE(e,c))}throw a.g.za();case 1736:switch(k){case 33:return b.oE(c,e,d);case 197:return b.kE(c,e);case 550:return b.mE(c,e);case 1607:return b.rE(c,e);case 1736:return b.XN(c,
e)}throw a.g.za();default:throw a.g.za();}};b.FN=function(a,c,d){a=a.w();c=c.w();return b.iE(a,c,d)};b.iE=function(a,b,c){a.sub(b);return a.qk()<=c*c?3:4};b.CD=function(c,e,d){var g=new a.h;c.s(g);c=e.w();return b.QM(g,c,d)};b.QM=function(a,b,c){a.O(-c,-c);if(a.contains(b))return 1;a.O(c,c);return a.contains(b)?8:4};b.UM=function(a,b,c){return b.contains(c)?1:a.contains(c)?8:4};b.JM=function(c,e,d){var g=new a.h;c.s(g);c=new a.h;e.s(c);return b.NM(g,c,d)};b.NM=function(a,b,c){var e=0;a.contains(b)&&
(e|=1);b.contains(a)&&(e|=2);if(0!=e)return e;a.O(-c,-c);b.O(-c,-c);if(a.Yb(b))return e=a,e.O(c,c),e=e.contains(b)?1:0,b.O(c,c),e|=b.contains(a)?2:0,0!=e?e:32;e=a;e.O(c,c);b.O(c,c);return e.Yb(b)?8:4};b.aE=function(a,c,d){c=c.w();return b.cE(a,c,d)};b.cE=function(a,c,d){for(var e=0,g=a.D();e<g;e++){var f;f=a.Ba(e);f=b.iE(f,c,d);if(4!=f)return 0!=(f&2)&&1!=g?1:f}return 4};b.TD=function(c,e,d,f){var g=new a.h;e.s(g);return b.aN(c,g,d,f)};b.aN=function(a,c,d,f){c.O(-d,-d);c.O(d,d);for(var e=d=0,g=a.D();e<
g;e++){var k;k=a.Ba(e);k=b.te(b.UM(c,c,k));if(4!=k&&(d|=k,4==f))return 1073741824}return 0==d?4:2==d?d:32};b.ZD=function(a,c,d,f){for(var e=0,g=0,k=c.D();g<k;g++){var n;n=c.Ba(g);n=b.cE(a,n,d);if(4!=n&&(e++,4==f))return 1073741824}return 0<e?e==c.D()?3==f?(n=b.ZD(c,a,d,1),1==n?3:0):1:32:0};b.aD=function(a,c,d,f){c=c.w();return b.iO(a,c,d,f)};b.XM=function(a,b){var c=null;a=a.ob;null!=a&&(c=a.Hi);if(null!=c){c=c.rm(b.x,b.y);if(0==c)return 4;if(1==c)return 1}else return-1;return 0};b.iO=function(c,
e,d,f){if(0==(f&1073741839))return 64;var g=b.XM(c,e);if(0<g)return g;d*=d;for(g=c.Fa();g.Ya();){var k=g.Ta;if(!c.Qb(k)){var n=c.La(k),k=c.wa(k);if(0==n)continue;if(a.b.sc(c.Ba(k),e)<=d||1<n&&a.b.sc(c.Ba(k+n-1),e)<=d)return 8}if(8!=f)for(;g.Ea();)if(n=g.ba(),n=n.gc(n.qe(e,!1)),a.b.sc(n,e)<=d)return 0!=(f&1073741828)?1073741824:1}return 0!=(f&1073741828)?4:64};b.tE=function(c,e){var d=new a.h;e.s(d);return b.eO(c,d)};b.eO=function(a,c){a=b.eq(a,c);return 0<a?a:0};b.eq=function(a,b){a=a.ob;if(null!=
a)a=a.Hi;else return-1;if(null!=a){a=a.Rn(b);if(0==a)return 4;if(1==a)return 1}else return-1;return 0};b.vE=function(c,e){var d=new a.h;e.s(d);d=b.eq(c,d);return 0<d?d:0};b.uv=function(c,e){var d=new a.h;e.s(d);d=b.eq(c,d);return 0<d?d:-1==d&&(d=new a.h,c.s(d),d=b.eq(e,d),0<d)?b.te(d):0};b.mO=function(a,c){a=b.uv(a,c);return 0<a?a:0};b.oE=function(a,c,d){c=c.w();return b.RN(a,c,d)};b.RN=function(b,c,d){b=a.gd.ge(b,c,d);if(0==b)return 4;if(1==b)return 1;if(2==b)return 8;throw a.g.za();};b.kE=function(c,
e){var d=new a.h;e.s(d);return b.ON(c,d)};b.ON=function(a,c){a=b.eq(a,c);return 0<a?a:0};b.mE=function(a,c){a=b.uv(a,c);return 0<a?a:0};b.rE=function(a,c){a=b.uv(a,c);return 0<a?a:0};b.XN=function(a,c){a=b.uv(a,c);return 0<a?a:0};b.kX=function(b,c){var e=b.G(),d=c.G(),f;if(a.T.gh(e)&&(f=b.ob,null!=f&&(f=f.Hi,null!=f))){if(33==d){var k=c.w();f=f.rm(k.x,k.y)}else k=new a.h,c.s(k),f=f.Rn(k);if(1==f)return 1;if(0==f)return 4}if(a.T.gh(d)&&(f=c.ob,null!=f&&(f=f.Hi,null!=f))){33==e?(e=b.w(),f=f.rm(e.x,
e.y)):(e=new a.h,b.s(e),f=f.Rn(e));if(1==f)return 2;if(0==f)return 4}return 0};b.te=function(a){0!=(a&1)&&(a=a&-2|2);0!=(a&2)&&(a=a&-3|1);return a};return b}();a.nN=b})(x||(x={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}I(c,b);c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.G=function(){return 15};c.prototype.V=function(b,c,d,f,k){return b instanceof a.T?(b=new a.hd(b),c=new a.hd(c),this.V(b,c,d,f,k).next()):void 0===k?new a.LD(b,c,d,f,-1):new a.LD(b,
c,d,f,k)};c.prototype.qo=function(b,c,d){if(!this.wv(b))return!1;c=a.na.ah(c,b,!1);var e=b.Hj(d);return e=e||b.Xu(c,d)};c.prototype.wv=function(b){return a.xy.bz(b)};c.$=null;return c}(a.ef);a.tk=b})(x||(x={}));(function(a){var b=function(){function b(b,c,d,f,p){this.ot=null==c;this.Ca=-1;this.ie=b;this.Rg=d;this.sf=c.next();this.$j=this.sf.G();this.mc=f;this.ej=p;if(-1!=this.ej&&(0>=this.ej||7<this.ej))throw a.g.F("bad dimension mask");}b.prototype.next=function(){if(this.ot)return null;var a;if(null!=
this.ox){a=this.ox.next();if(null!=a)return a;this.ox=null}for(;null!=(a=this.ie.next());){this.Ca=this.ie.Ia();if(-1==this.ej)return a=this.Ma(a);this.ox=this.LU(a);return a=this.ox.next()}return null};b.prototype.Ia=function(){return this.Ca};b.prototype.Ma=function(b){var c=this.oL(b);if(null!=c)return c;var c=a.na.Zv(this.sf,b),d=a.na.be(this.Rg,c,!0),c=new a.h;this.sf.s(c);var f=new a.h;b.s(f);c.O(2*d,2*d);c.Ma(f);c.O(100*d,100*d);d=a.ne.clip(this.sf,c,0,0);b=a.ne.clip(b,c,0,0);return a.Dg.nw(b,
d,this.Rg,this.mc)};b.prototype.JJ=function(b,c,d){var e=0;if(0!=(c&1))null==d[0]&&(d[0]=new a.Ed(b)),e++;else for(var g=0;g<d.length-1;g++)d[g]=d[g+1];if(0!=(c&2))null==d[e]&&(d[e]=new a.Ua(b)),e++;else for(g=e;g<d.length-1;g++)d[g]=d[g+1];if(0!=(c&4))null==d[e]&&(d[e]=new a.Ja(b)),e++;else for(g=e;g<d.length-1;g++)d[g]=d[g+1];if(3!=e){b=[];for(g=0;g<e;g++)b[g]=d[g];return new a.hd(b)}return new a.hd(d)};b.prototype.LU=function(b){var c=this.oL(b);if(null!=c){var d=[null,null,null];d[c.tb()]=c;return this.JJ(b.description,
this.ej,d)}c=a.na.Zv(this.sf,b);d=a.na.be(this.Rg,c,!0);c=new a.h;this.sf.s(c);c.O(2*d,2*d);var f=new a.h;b.s(f);c.Ma(f);c.O(100*d,100*d);d=a.ne.clip(this.sf,c,0,0);c=a.ne.clip(b,c,0,0);d=a.Dg.wA(c,d,this.Rg,this.mc);return this.JJ(b.description,this.ej,d)};b.prototype.oL=function(c){var e=a.na.Zv(c,this.sf),d=a.na.be(this.Rg,e,!0),e=c.G(),f=c.u(),k=this.sf.u(),k=f||k;if(!k){k=new a.h;c.s(k);var p=new a.h;this.sf.s(p);p.O(2*d,2*d);k=!k.Yb(p)}if(!k)if(p=a.nN.kX(this.sf,c),4==p)k=!0;else{if(0!=(p&2))return this.sf;
if(0!=(p&1))return c}if(k)return d=a.T.lf(e),k=a.T.lf(this.$j),d<k?b.$(c,f):d>k?this.dK():0==d?550==e&&33==this.$j?this.dK():b.$(c,f):b.$(c,f);if((-1==this.ej||4==this.ej)&&197==e&&197==this.$j)return d=this.sf,e=new a.h,c.s(e),f=new a.h,d.s(f),e.Ma(f),d=new a.ci,c.copyTo(d),d.Gp(e),d;if(197==e&&0==a.T.lf(this.$j)||197==this.$j&&0==a.T.lf(e))return f=197==e?c:this.sf,c=197==e?this.sf:c,e=new a.h,f.s(e),a.ne.clip(c,e,d,0);if(0==a.T.lf(e)&&0<a.T.lf(this.$j)||0<a.T.lf(e)&&0==a.T.lf(this.$j)){d=a.na.ah(this.Rg,
c,!1);if(550==e||33==e)return a.Dg.MH(c,this.sf,d);if(550==this.$j||33==this.$j)return a.Dg.MH(this.sf,c,d);throw a.g.za();}return-1!=this.ej&&2!=this.ej||1607!=e||1736!=this.$j?-1!=this.ej&&2!=this.ej||1736!=e||1607!=this.$j?null:this.lL(this.sf,c):this.lL(c,this.sf)};b.prototype.lL=function(b,c){var e=b,d=c,f=a.na.ah(this.Rg,c,!1),k=new a.h;d.s(k);var p=new a.h;e.s(p);p.O(2*f,2*f);k.Ma(p);k.O(10*f,10*f);var e=b=a.ne.clip(b,k,0,0),p=new a.ia(0),h=-1,l=d.ob;if(null!=l){var m=l.Hi;if(null!=m){h=0;
p.yb(e.D()+e.aa());for(var q=new a.h,r=e.Fa();r.Ya();)for(;r.Ea();){r.ba().s(q);var t=m.Rn(q);1==t?p.add(1):0==t?p.add(0):(p.add(-1),h++)}}}5<c.D()&&(d=c=a.ne.clip(c,k,0,0),l=d.ob);0>h&&(h=e.jA());k=e.D()+d.D();if(h*d.D()>Math.log(k)*k*4)return null;k=null;h=d.Fa();null!=l&&null!=l.Mb&&(k=l.Mb);null==k&&20<d.D()&&(k=a.na.BF(d));d=b.Ka();l=null;m=e.Fa();q=[0,0,0,0,0,0,0,0,0];r=new a.Qd(0);t=new a.Cg;b=-1;for(var u=0,A=0,v=0<p.size,w=-1;m.Ya();){var w=m.Ta,x=0;b=-1;for(u=0;m.Ea();){var z=v?a.J.truncate(p.get(A)):
-1;A++;var C=m.ba();if(0>z){if(null!=k)for(null==l?l=k.qT(C,f):l.Wn(C,f),z=l.next();-1!=z;z=l.next()){h.Tb(k.ja(z));for(var z=h.ba(),L=C.Ma(z,null,q,null,f),z=0;z<L;z++)r.add(q[z])}else for(h.yj();h.Ya();)for(;h.Ea();)for(z=h.ba(),L=C.Ma(z,null,q,null,f),z=0;z<L;z++)r.add(q[z]);if(0<r.size){r.Gd(0,r.size,function(a,b){return a-b});var D=0;r.add(1);for(var L=-1,z=0,E=r.size;z<E;z++){var G=r.get(z);if(G!=D){var I=!1;0!=D||1!=G?(C.yh(D,G,t),D=t.get()):(D=C,I=!0);if(2<=x){d.Bs(e,w,b,u,3==x);if(1!=this.fF(c,
D.ec(),f)&&1!=this.gF(c,D,f))return null;d.dc(D,!1);x=1;u=0}else switch(L=this.gF(c,D,f),L){case 1:I?2>x?(b=m.Db()-e.wa(w),u=1,x=0==x?3:2):u++:(d.dc(D,0==x),x=1);break;case 0:x=0;b=-1;u=0;break;default:return null}D=G}}}else{z=this.fF(c,C.ec(),f);if(0>z)return null;1==z?(2>x&&(b=m.Db()-e.wa(w),x=0==x?3:2),u++):(b=-1,u=0)}r.clear(!1)}else 0!=z&&1==z&&(0==x?(x=3,b=m.Db()-e.wa(w)):1==x?(x=2,b=m.Db()-e.wa(w)):u++)}2<=x&&(d.Bs(e,w,b,u,3==x),b=-1)}return d};b.prototype.fF=function(b,c,d){return a.ff.kn(b,
c,d)};b.prototype.gF=function(b,c,d){var e=c.ec();c=c.Bc();var g=a.ff.kn(b,e,d),f=a.ff.kn(b,c,d);if(1==g&&0==f||0==g&&1==f)return-1;if(0==g||0==f)return 0;if(1==g||1==f)return 1;g=new a.b;g.add(e,c);g.scale(.5);b=a.ff.kn(b,g,d);return 0==b?0:1==b?1:-1};b.$=function(a,b){return b?a:a.Ka()};b.prototype.dK=function(){null==this.KI&&(this.KI=this.sf.Ka());return this.KI};b.prototype.Re=function(){return!0};return b}();a.LD=b})(x||(x={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}
I(c,b);c.prototype.G=function(){return 28};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.V=function(b,c,d,f,k,p,h){return b instanceof a.T?(b=new a.hd(b),this.V(b,c,d,f,k,p,h).next()):new a.oN(b,c,d,f,k,p,h)};c.$=null;return c}(a.ef);a.MD=b})(x||(x={}));(function(a){var b=function(){function b(a,b,c,d,f,p,h){this.Ca=-1;this.ie=a;this.fk=b;this.Qa=c;this.jj=d;this.jB=f;this.GI=p;this.ke=h}b.prototype.next=function(){var a=this.ie.next();return null!=a?(this.Ca=this.ie.Ia(),this.bN(a)):
null};b.prototype.Ia=function(){return this.Ca};b.prototype.bN=function(b){var c;c=0>=this.GI?a.na.ah(this.fk,b,!1):this.GI;return a.UL.V(b,this.Qa,this.jj,this.jB,c,this.ke)};b.prototype.Re=function(){return!0};return b}();a.oN=b})(x||(x={}));(function(a){(function(a){a[a.clipToDomainOnly=1]="clipToDomainOnly";a[a.clipWithHorizon=2]="clipWithHorizon";a[a.foldAndClipWithHorizon=3]="foldAndClipWithHorizon"})(a.Up||(a.Up={}));var b=function(b){function c(){b.apply(this,arguments)}I(c,b);c.prototype.G=
function(){return 0};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.V=function(b,c,d){return b instanceof a.T?(b=new a.hd(b),this.V(b,c,d).next()):new a.pN(b,c,d)};c.prototype.transform=function(b,c,d,f){return a.ko.transform(b,c,d,f,!0)};c.prototype.jL=function(b,c,d){return a.ko.jL(b,c,d)};c.prototype.Du=function(b,c,d,f){return a.ko.Du(b,c,d,f)};c.prototype.XY=function(b,c,d,f){return a.ko.gs(b,c,d,f)};c.prototype.iL=function(b,c,d,f){return a.ko.iL(b,c,d,f)};c.$=null;return c}(a.ef);
a.os=b})(x||(x={}));(function(a){var b=function(){function b(a,b,c){this.Ca=-1;this.ie=a;this.LV=b;this.ke=c}b.prototype.next=function(){var b=this.ie.next();return null!=b?(this.Ca=this.ie.Ia(),a.ko.Xg(b,this.LV,this.ke)):null};b.prototype.Ia=function(){return this.Ca};b.prototype.Re=function(){return!0};return b}();a.pN=b})(x||(x={}));(function(a){var b=function(){function b(){}b.prototype.reset=function(){this.Lh=this.Yk=-1;this.qt=this.$q=!1};b.prototype.tS=function(a,b,c){for(a.Tb(b,c);a.Ea();){var e=
a.ba(),e=e.Rb();if(0!=e)return a.Db()}for(a.Tb(b,c);a.pA();)if(e=a.Li(),e=e.Rb(),0!=e)return a.Db();return-1};b.prototype.uS=function(a,b){for(a.Tb(b,-1);a.pA();)if(0!=a.Li().Rb())return a.Db();return-1};b.prototype.sS=function(a,b){a.Tb(b,-1);for(a.ba();a.Ea();)if(0!=a.ba().Rb())return a.Db();return-1};b.prototype.rS=function(b,c,d,f){this.Yk=this.tS(c,d,f);if(-1!=this.Yk){c.Tb(this.Yk,-1);var e=c.ba(),g=e.gc(e.qe(b,!1));d=a.b.sc(g,b);f=new a.b;f.L(g);f.sub(e.ec());g=new a.b;g.L(b);g.sub(e.ec());
this.$q=0>f.Ui(g);this.Lh=this.sS(c,this.Yk);if(-1!=this.Lh){c.Tb(this.Lh,-1);var e=c.ba(),k=e.qe(b,!1),k=e.gc(k),n=a.b.sc(k,b);n>d?this.Lh=-1:(f.L(k),f.sub(e.ec()),g.L(b),g.sub(e.ec()),this.qt=0>f.Ui(g))}-1==this.Lh&&(this.Lh=this.uS(c,this.Yk),-1!=this.Lh&&(c.Tb(this.Lh,-1),e=c.ba(),k=e.qe(b,!1),k=e.gc(k),n=a.b.sc(k,b),n>d?this.Lh=-1:(f.L(k),f.sub(e.ec()),g.L(b),g.sub(e.ec()),this.qt=0>f.Ui(g),b=this.Yk,this.Yk=this.Lh,this.Lh=b,b=this.$q,this.$q=this.qt,this.qt=b)))}};b.prototype.eQ=function(a,
b,c,d,f){c=c.Fa();this.rS(a,c,d,f);if(-1!=this.Yk&&-1==this.Lh)return this.$q;if(-1!=this.Yk&&-1!=this.Lh){if(this.$q==this.qt)return this.$q;c.Tb(this.Yk,-1);a=c.ba().Eg(1);c.Tb(this.Lh,-1);b=c.ba().Eg(0);return 0<=a.Ui(b)?!0:!1}return b};return b}(),c=function(c){function e(){c.apply(this,arguments)}I(e,c);e.local=function(){null===e.$&&(e.$=new e);return e.$};e.prototype.G=function(){return 3};e.prototype.$z=function(b,c,e,d){void 0===d&&(d=!1);if(b.u())return new a.Mm;c=c.w();var g=b,f=b.G();
197==f&&(g=new a.Ja,g.jd(b,!1),f=1736);switch(f){case 33:return this.FJ(g,c);case 550:return this.rJ(g,c);case 1607:case 1736:return this.$V(g,c,e,d);default:throw a.g.X("not implemented");}};e.prototype.aA=function(b,c){if(b.u())return new a.Mm;c=c.w();var e=b,d=b.G();197==d&&(e=new a.Ja,e.jd(b,!1),d=1736);switch(d){case 33:return this.FJ(e,c);case 550:case 1607:case 1736:return this.rJ(e,c);default:throw a.g.X("not implemented");}};e.prototype.bA=function(b,c,e,d){if(0>d)throw a.g.F();if(b.u())return[];
c=c.w();var g=b,f=b.G();197==f&&(g=new a.Ja,g.jd(b,!1),f=1736);switch(f){case 33:return this.FW(g,c,e,d);case 550:case 1607:case 1736:return this.cW(g,c,e,d);default:throw a.g.X("not implemented");}};e.prototype.$V=function(c,e,d,f){if(1736==c.G()&&d&&(d=new a.h,c.s(d),d=a.na.be(null,d,!1),0!=(f?a.gd.ge(c,e,0):a.gd.ge(c,e,d)))){var g=new a.Mm(e,0,0);f&&g.NK(!0);return g}for(var k=c.Fa(),g=new a.b,n=d=-1,p=1.7976931348623157E308,h=0;k.Ya();)for(;k.Ea();){var y=k.ba(),y=y.gc(y.qe(e,!1)),l=a.b.sc(y,
e);l<p?(h=1,g=y,d=k.Db(),n=k.Ta,p=l):l==p&&h++}g=new a.Mm(g,d,Math.sqrt(p));f&&(k.Tb(d,n),y=k.ba(),f=0>a.b.zp(e,y.ec(),y.Bc()),1<h&&(h=new b,h.reset(),f=h.eQ(e,f,c,d,n)),g.NK(f));return g};e.prototype.FJ=function(b,c){b=b.w();c=a.b.Cb(b,c);return new a.Mm(b,0,c)};e.prototype.rJ=function(b,c){var e=b.Pa(0);b=b.D();for(var d=0,g=0,f=0,k=1.7976931348623157E308,n=0;n<b;n++){var p=new a.b;e.fc(2*n,p);var h=a.b.sc(p,c);h<k&&(g=p.x,f=p.y,d=n,k=h)}e=new a.Mm;e.Ly(g,f,d,Math.sqrt(k));return e};e.prototype.FW=
function(b,c,e,d){if(0==d)return e=[];e*=e;b=b.w();c=a.b.sc(b,c);c<=e?(e=[],d=new a.Mm,d.Ly(b.x,b.y,0,Math.sqrt(c)),e[0]=d):e=[];return e};e.prototype.cW=function(b,c,e,d){if(0==d)return d=[];var g=b.Pa(0),f=b.D();b=[];var k=0;e*=e;for(var n=0;n<f;n++){var p=g.read(2*n),h=g.read(2*n+1),y=c.x-p,l=c.y-h,y=y*y+l*l;y<=e&&(l=new a.Mm,l.Ly(p,h,n,Math.sqrt(y)),k++,b.push(l))}c=b.length;b.sort(function(a,b){return a.Qa<b.Qa?-1:a.Qa==b.Qa?0:1});if(d>=c)return b.slice(0);b.length=d;return b.slice(0)};e.$=null;
return e}(a.ef);a.sy=c})(x||(x={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}I(c,b);c.prototype.G=function(){return 4};c.prototype.V=function(b,c,d,f,k){return a.Nm.ZB(b,c,d,f,k)};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.wv=function(b){return a.Gu.cz(b)};c.prototype.qo=function(b,c,d){return a.Gu.UE(b,c,d)};c.$=null;return c}(a.ef);a.qN=b})(x||(x={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}I(c,b);c.prototype.G=function(){return 33};
c.prototype.V=function(b,c,d,f,k){return 1073741824===b?!a.Fd.$B(c,d,f,4,k):a.Fd.$B(c,d,f,b,k)};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.wv=function(b){return a.Gu.cz(b)};c.prototype.qo=function(b,c,d){return a.Gu.UE(b,c,d)};c.$=null;return c}(a.ef);a.Gj=b})(x||(x={}));(function(a){var b=function(){function b(b,c,d,f){this.ke=f;this.sV=d;this.Ca=-1;if(null==b)throw a.g.F();this.Zk=b;this.fk=c}b.prototype.next=function(){var a;return null!=(a=this.Zk.next())?(this.Ca=this.Zk.Ia(),
this.DC(a)):null};b.prototype.Ia=function(){return this.Ca};b.prototype.DC=function(b){if(null==b)throw a.g.F();return a.ty.TK(b,this.fk,this.sV,this.ke)};b.prototype.Re=function(){return!0};return b}();a.rN=b})(x||(x={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}I(c,b);c.prototype.G=function(){return 26};c.prototype.V=function(b,c,d,f){return b instanceof a.T?(b=new a.hd(b),this.V(b,c,d,f).next()):new a.rN(b,c,d,f)};c.prototype.Wq=function(b,c,d,f,k){return 0<(void 0!==
f?a.ty.Wq(b,c,d,f,k):a.ty.Wq(b,c,!1,null,d))};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.$=null;return c}(a.ef);a.Km=b})(x||(x={}));(function(a){var b=function(){function a(){this.nr=0}a.prototype.iY=function(a){this.nr&=-2;this.nr|=a?1:0};a.prototype.fn=function(){return 0!=(this.nr&1)};a.prototype.hH=function(){return this.fn()?0:1};return a}();a.KZ=b;var c=function(){return function(){}}(),d=function(){return function(a,b,c,e){this.x=a;this.y=b;this.$i=c;this.ln=e}}(),e=function(){function a(a){this.bf=
a}a.prototype.compare=function(a,b,c){a=a.ja(c);b=this.bf.Nf.read(2*b);a=this.bf.Nf.read(2*a);b-=a;return 0>b?-1:0<b?1:0};return a}(),g=function(){function a(a){this.bf=a}a.prototype.compare=function(a,b,c){b=this.bf.ib[b];a=this.bf.ib[a.ja(c)];var e=b.fn(),d=a.fn();c=b.Le.pf(this.bf.wp,0);var g=a.Le.pf(this.bf.wp,0);c==g&&(c=Math.min(e?b.Le.ra:b.Le.oa,d?a.Le.ra:a.Le.oa),e=.5*(c-this.bf.wp)+this.bf.wp,e==this.bf.wp&&(e=c),c=b.Le.pf(e,0),g=a.Le.pf(e,0));return c<g?-1:c>g?1:0};return a}(),f=function(){function b(b,
c){this.QJ=new a.b;this.parent=b;this.ZT=c}b.prototype.hs=function(a,b,c){var e=this.parent,d=this.ZT;c.Gd(a,b,function(a,b){return e.ki(a,b,d)})};b.prototype.Qq=function(a){a=this.parent.Gi.get(a);this.parent.Nf.fc(2*(a>>1),this.QJ);return this.QJ.y+(0!=(a&1)?this.parent.hk:-this.parent.hk)};return b}(),p=function(){function k(b,c,e,d,g){this.zI=b.description;this.Y=b;this.mh=c;this.hk=a.na.ah(this.mh,b,!1);this.pp=a.na.ah(this.mh,b,!0);this.eB=e;this.qV=this.zI.Ga;this.ib=[];this.cp=[];this.Hh=
new a.Xp;this.hb=new a.uk;this.we=new a.$d;this.kI=this.Ul=g}k.prototype.BA=function(){this.kI=!0;return(!a.T.Ic(this.Y.G())||this.OF()&&this.NF(!1))&&this.qQ()?a.T.Ic(this.Y.G())?this.tQ()?1607==this.Y.G()?this.vQ()?2:0:this.wQ()?this.xQ():0:0:2:0};k.prototype.JC=function(b,c){var e=this.Nf.read(2*b);b=this.Nf.read(2*b+1);var d=this.Nf.read(2*c);c=this.Nf.read(2*c+1);var g=!a.Iu.pw(e,b,d,c,this.hk*this.hk);return g?g:0==this.Y.tb()?!1:e==d&&b==c};k.prototype.OF=function(){for(var b=this.Y,c=b.$f?
3:2,e=0,d=b.aa();e<d;e++)if(b.La(e)<c)return this.we=new a.$d(1,e,0),!1;return!0};k.prototype.NF=function(b){for(var c=this.Y,e=c.Fa(),d=c.hasAttribute(1),c=d?a.na.GF(this.mh,c,!1):0;e.Ya();)for(;e.Ea();){var g=e.ba();if(!(g.Rb()>this.hk)){if(b&&d){var f=g.dt(1,0),g=g.dt(1,0);if(Math.abs(g-f)>c)continue}this.we=new a.$d(2,e.Db(),-1);return!1}}return!0};k.prototype.qQ=function(){var b=this.Y,c=null;a.T.Ic(this.Y.G())&&(c=this.Y);var d=(this.kI||this.Ul)&&null!=c,g=b.D();this.Nf=b.Pa(0);this.Gi=new a.ia(0);
this.Gi.yb(2*g);this.Fi=new a.ia(0);this.Fi.yb(2*g);d&&(null==this.im&&(this.im=new a.ia(0)),this.im.yb(g));for(var k=b=0;k<g;k++)if(this.Gi.add(2*k),this.Gi.add(2*k+1),this.Fi.add(2*k),this.Fi.add(2*k+1),d){for(;k>=c.Gc(b);)b++;this.im.add(b)}(new a.Hu).sort(this.Fi,0,2*g,new f(this,d));this.hb.clear();this.hb.Ep(new e(this));this.hb.Qe(g);c=0;for(g*=2;c<g;c++)if(d=this.Fi.get(c),b=this.Gi.get(d),d=b>>1,0==(b&1)){b=this.hb.addElement(d,-1);k=this.hb.Ve(b);if(-1!=k&&!this.JC(this.hb.ja(k),d))return this.we=
new a.$d(3,d,this.hb.ja(k)),!1;var n=this.hb.nb(b);if(-1!=n&&!this.JC(this.hb.ja(n),d))return this.we=new a.$d(3,d,this.hb.ja(n)),!1}else if(b=this.hb.search(d,-1),k=this.hb.Ve(b),n=this.hb.nb(b),this.hb.Kd(b,-1),-1!=k&&-1!=n&&!this.JC(this.hb.ja(k),this.hb.ja(n)))return this.we=new a.$d(3,this.hb.ja(k),this.hb.ja(n)),!1;return!0};k.prototype.tQ=function(){return 10>this.Y.D()?this.rQ():this.sQ()};k.prototype.sQ=function(){var b=new a.fd;b.Jb(this.Y);var c=new a.$d;return a.Ku.tJ(!1,b,this.hk,c,this.ke)?
(c.lm=b.Za(c.lm),c.mm=b.Za(c.mm),this.we.ms(c),!1):!0};k.prototype.rQ=function(){for(var b=this.Y,c=b.Fa(),b=b.Fa();c.Ya();)for(;c.Ea();){var e=c.ba();if(!c.Io()||!c.UU()){b.zX(c);do for(;b.Ea();){var d=b.ba(),d=e.ys(d,this.hk,!0);if(0!=d)return this.we=new a.$d(2==d?5:4,c.Db(),b.Db()),!1}while(b.Ya())}}return!0};k.prototype.wQ=function(){var b=this.Y;this.ib.length=0;this.cp.length=0;this.ug=b.Fa();this.ug.kC();var c=new a.ia(0);c.yb(10);for(var e=NaN,d=0,g=0,b=2*b.D();g<b;g++){var f=this.Fi.get(g),
f=this.Gi.get(f);if(0==(f&1)){var f=f>>1,k=this.Nf.read(2*f),n=this.Nf.read(2*f+1);if(0!=c.size&&(k!=e||n!=d)){if(!this.KJ(c))return!1;null!=c&&c.clear(!1)}c.add(f);e=k;d=n}}return this.KJ(c)?!0:!1};k.prototype.vQ=function(){for(var b=this.Y,e=Array(b.aa()),d=0,g=b.aa();d<g;d++)e[d]=b.Eo(d);var g=new c,f,k,n,p=new a.b,d=this.Fi.get(0),d=this.Gi.get(d),h=d>>1;this.Nf.fc(2*h,p);d=this.im.get(h);f=e[d];k=b.wa(d);n=b.Gc(d)-1;g.Il=h==k||h==n;g.Uy=this.Ul?!f&&g.Il:g.Il;g.$i=d;g.x=p.x;g.y=p.y;g.ln=h;for(var y=
new c,l=1,m=this.Fi.size;l<m;l++)if(d=this.Fi.get(l),d=this.Gi.get(d),0==(d&1)){h=d>>1;this.Nf.fc(2*h,p);d=this.im.get(h);d!=g.$i&&(f=e[d],k=b.wa(d),n=b.Gc(d)-1);var B,q=h==k||h==n;B=this.Ul?!f&&g.Il:g.Il;y.x=p.x;y.y=p.y;y.$i=d;y.ln=h;y.Uy=B;y.Il=q;if(y.x==g.x&&y.y==g.y)if(this.Ul){if(!y.Uy||!g.Uy)if(y.$i!=g.$i||!y.Il&&!g.Il)return this.we=new a.$d(8,y.ln,g.ln),!1}else if(!y.Il||!g.Il)return this.we=new a.$d(5,y.ln,g.ln),!1;d=g;g=y;y=d}return!0};k.prototype.QF=function(){for(var b=this.Y,c=[],e=-1,
g=!1,f=0,k=b.aa();f<k;f++)b.rw(f)&&(g=!1,e++,f<k-1&&(b.rw(f+1)||(g=!0))),c[f]=g?e:-1;var g=new a.b,f=this.Fi.get(0),f=this.Gi.get(f),n=f>>1;this.Nf.fc(2*n,g);for(var f=this.im.get(n),e=new d(g.x,g.y,f,n,c[f]),b=[],p=1,k=this.Fi.size;p<k;p++)if(f=this.Fi.get(p),f=this.Gi.get(f),0==(f&1)){n=f>>1;this.Nf.fc(2*n,g);f=this.im.get(n);f=new d(g.x,g.y,f,n,c[f]);if(f.x==e.x&&f.y==e.y){if(f.$i==e.$i)return this.we=new a.$d(9,f.ln,e.ln),!1;0<=c[f.$i]&&c[f.$i]==c[e.$i]&&(0!=b.length&&b[b.length-1]==e||b.push(e),
b.push(f))}e=f}if(0==b.length)return!0;f=new a.Xp(!0);a.J.Nv(c,-1);g=-1;p=new a.b;p.$c();e=0;for(k=b.length;e<k;e++){n=b[e];if(n.x!=p.x||n.y!=p.y)g=f.mi(0),p.x=n.x,p.y=n.y;var h=c[n.$i];-1==h&&(h=f.mi(2),c[n.$i]=h);f.addElement(h,g);f.addElement(g,h)}k=new a.ia(0);k.yb(10);for(e=f.Ge;-1!=e;e=f.cA(e))if(b=f.$G(e),0==(b&1)&&0!=(b&2)){b=-1;k.add(e);for(k.add(-1);0<k.size;){g=k.Fc();k.Pf();p=k.Fc();k.Pf();n=f.$G(p);if(0!=(n&1)){b=0==(n&2)?g:p;break}f.aY(p,n|1);for(n=f.xc(p);-1!=n;n=f.nb(n))h=f.getData(n),
h!=g&&(k.add(h),k.add(p))}if(-1!=b){f=-1;e=0;for(k=c.length;e<k;e++)if(c[e]==b){f=e;break}this.we=new a.$d(10,f,-1);return!1}}return!0};k.prototype.xQ=function(){var b=this.Y;if(0>=b.hf())return this.we=new a.$d(6,1==b.aa()?1:-1,-1),0;if(1==b.aa())return this.Ul&&!this.QF()?0:2;this.hp=a.ia.zd(b.aa(),0);this.qB=a.ia.zd(b.aa(),-1);for(var c=-1,e=0,d=0,f=b.aa();d<f;d++){var k=b.Sm(d);this.hp.write(d,0>k?0:256);if(0<k)c=d,e=k;else{if(0==k)return this.we=new a.$d(6,d,-1),0;if(0>c||e<Math.abs(k))if(this.we=
new a.$d(7,d,-1),this.Ul)return 0;this.qB.write(d,c)}}this.Wt=b.aa();this.Bn=new a.ia(0);this.Bn.yb(10);f=b.D();this.wp=NaN;b=new a.ia(0);b.yb(10);this.Jr=a.ia.zd(f,-1);this.ux=a.ia.zd(f,-1);null!=this.Yj?this.Yj.clear(!1):this.Yj=new a.ia(0);this.Yj.yb(10);this.hb.clear();this.hb.Ep(new g(this));c=0;for(f*=2;0<this.Wt&&c<f;c++)if(e=this.Fi.get(c),e=this.Gi.get(e),0==(e&1)){e>>=1;d=this.Nf.read(2*e+1);if(d!=this.wp&&0!=b.size){if(!this.ju(b))return 0;null!=b&&b.clear(!1)}b.add(e);this.wp=d}return 0<
this.Wt&&!this.ju(b)?0:this.Ul?0==this.we.Ii&&this.QF()?2:0:0==this.we.Ii?2:1};k.prototype.KJ=function(b){if(1==b.size)return!0;for(var c=0,e=b.size;c<e;c++){var d=b.get(c);this.ug.Tb(d);var g=this.ug.Li();this.ib.push(this.Gv(g,d,this.ug.Ta,!0));this.ug.ba();g=this.ug.ba();this.ib.push(this.Gv(g,d,this.ug.Ta,!1))}var f=this;this.ib.sort(function(a,b){return f.VR(a,b)});d=this.Hh.Ge;-1==d&&(d=this.Hh.mi(0));this.Hh.Vn(this.ib.length);c=0;for(e=this.ib.length;c<e;c++)this.Hh.addElement(d,c);for(var c=
!0,k=e=-1;c;){c=!1;g=this.Hh.xc(d);if(-1==g)break;for(var n=this.Hh.nb(g);-1!=n;){e=this.Hh.getData(g);k=this.Hh.getData(n);e=this.ib[e].up;k=this.ib[k].up;if(e==k)if(c=!0,this.Hh.kd(d,g),g=this.Hh.Ve(n),n=this.Hh.kd(d,n),-1==n||-1==g)break;else continue;g=n;n=this.Hh.nb(g)}}c=this.Hh.at(d);this.Hh.RF(d);if(0<c)return this.we=new a.$d(5,e,k),!1;c=0;for(e=b.size;c<e;c++)this.WB(this.ib[c]);this.ib.length=0;return!0};k.prototype.ju=function(b){for(var c=0,e=b.size;c<e;c++){var d=b.get(c),g=this.Jr.read(d);
if(-1!=g){var f=this.hb.ja(g);this.Yj.add(f);this.hb.Kd(g,-1);this.WB(this.ib[f]);this.ib[f]=null;this.Jr.write(d,-1)}g=this.ux.read(d);-1!=g&&(f=this.hb.ja(g),this.Yj.add(f),this.hb.Kd(g,-1),this.WB(this.ib[f]),this.ib[f]=null,this.ux.write(d,-1))}c=0;for(e=b.size;c<e;c++){d=b.get(c);this.ug.Tb(d);g=this.ug.Li();if(g.ra>g.oa){var k=this.ug.Db(),n=this.Gv(g,d,this.ug.Ta,!0);0<this.Yj.size?(f=this.Yj.Fc(),this.Yj.Pf(),this.ib[f]=n):(f=this.ib.length,this.ib.push(n));g=this.hb.addElement(f,-1);-1==
this.Jr.read(k)?this.Jr.write(k,g):this.ux.write(k,g);0==(this.hp.read(this.ug.Ta)&3)&&this.Bn.add(g)}this.ug.ba();g=this.ug.ba();g.ra<g.oa&&(k=this.ug.Ik(),n=this.Gv(g,d,this.ug.Ta,!1),0<this.Yj.size?(f=this.Yj.Fc(),this.Yj.Pf(),this.ib[f]=n):(f=this.ib.length,this.ib.push(n)),g=this.hb.addElement(f,-1),-1==this.Jr.read(k)?this.Jr.write(k,g):this.ux.write(k,g),0==(this.hp.read(this.ug.Ta)&3)&&this.Bn.add(g))}c=0;for(e=this.Bn.size;c<e&&0<this.Wt;c++)if(g=this.Bn.get(c),0==(this.hp.read(this.ib[this.hb.ja(g)].pB)&
3)){b=-1;for(var d=this.hb.Ve(g),p=g,n=null,f=-1,h=0;-1!=d;){f=this.hb.ja(d);n=this.ib[f];f=n.pB;h=this.hp.read(f);if(0!=(h&3))break;p=d;d=this.hb.Ve(d)}-1==d?(k=1,d=p):(b=1==(h&3)?f:this.qB.read(f),k=0!=n.hH()?0:1,d=this.hb.nb(d));do{f=this.hb.ja(d);n=this.ib[f];f=n.pB;p=this.hp.read(f);if(0==(p&3)){if(k!=n.hH())return this.we=new a.$d(6,f,-1),!1;h=0==k||n.fn()?2:1;p=p&252|h;this.hp.write(f,h);if(2==h&&0==this.we.Ii&&this.qB.read(f)!=b&&(this.we=new a.$d(7,f,-1),this.Ul))return!1;this.Wt--;if(0==
this.Wt)return!0}1==(p&3)&&(b=f);p=d;d=this.hb.nb(d);k=0!=k?0:1}while(p!=g)}null!=this.Bn?this.Bn.clear(!1):this.Bn=new a.ia(0);return!0};k.prototype.Gv=function(b,c,e,d){if(322==b.G())b=this.sR(b);else throw a.g.za();b.up=c;b.pB=e;b.nr=0;b.iY(d);return b};k.prototype.sR=function(c){var e;0<this.cp.length?(e=this.cp[this.cp.length-1],--this.cp.length,c.copyTo(e.Le)):(e=new b,e.Le=a.dE.oe(c));return e};k.prototype.WB=function(a){322==a.Le.G()&&this.cp.push(a)};k.prototype.aW=function(){for(var b=this.Y.D(),
c=new a.ia(0),e=0;e<b;e++)c.add(e);var d=this;c.Gd(0,b,function(a,b){return d.Cv(a,b)});for(e=1;e<b;e++)if(0==this.Cv(c.get(e-1),c.get(e)))return this.we=new a.$d(3,c.get(e-1),c.get(e)),0;return 2};k.prototype.KW=function(){return this.OF()?this.NF(!0)?2:0:0};k.prototype.IW=function(){return this.BA()};k.prototype.bW=function(){for(var b=this.Y.D(),c=new a.ia(0),e=0;e<b;e++)c.add(e);var d=this;c.Gd(0,b,function(a,b){return d.TQ(a,b)});var g=Array(b);a.J.Nv(g,!1);g[c.get(0)]=!0;for(e=1;e<b;e++){var f=
c.get(e-1),k=c.get(e);0==this.Cv(f,k)?g[k]=!1:g[k]=!0}for(var c=this.Y.Ka(),f=this.Y,k=0,n=1,e=0;e<b;e++)g[e]?n=e+1:(k<n&&c.Id(f,k,n),k=e+1);k<n&&c.Id(f,k,n);c.Zg(2,this.pp);return c};k.prototype.LW=function(){var b=this.Y,c=b.Fa(),e=b.Fa(),d=this.Y.Ka(),g=this.Y,f=b.hasAttribute(1),k=f?a.na.GF(this.mh,b,!0):0,n=new a.ia(0),p=new a.ia(0);n.yb(a.J.truncate(b.D()/2+1));for(p.yb(a.J.truncate(b.D()/2+1));c.Ya();)if(e.Ya(),!(2>b.La(c.Ta))){e.BX();for(var h,y,l=!0;c.Ea();){var m=c.ba(),B=e.Li();if(c.Db()>
e.Db())break;l&&(n.add(c.Db()),p.add(e.Ik()),l=!1);y=n.Fc();var q=c.Ik();if(1<q-y){var r=new a.b;r.yc(b.Ba(y),b.Ba(q));h=r.length()}else h=m.Rb();y=p.Fc();q=e.Db();1<q-y?(r=new a.b,r.yc(b.Ba(y),b.Ba(q)),y=r.length()):y=B.Rb();h>this.pp?n.add(c.Ik()):f&&(h=b.Yc(1,n.Fc(),0),m=m.Os(1,0),Math.abs(m-h)>k&&n.add(c.Ik()));y>this.pp?p.add(e.Db()):f&&(h=b.Yc(1,p.Fc(),0),m=B.Os(1,0),Math.abs(m-h)>k&&p.add(e.Db()))}n.Fc()<p.Fc()?n.size>p.size?n.Pf():p.Pf():(n.Fc()!=p.Fc()&&p.Pf(),p.Pf());if(2<=p.size+n.size){l=
new a.Wa;B=0;for(m=n.size;B<m;B++)g.Ae(n.get(B),l),0==B?d.Rf(l):d.lineTo(l);for(B=p.size-1;0<B;B--)g.Ae(p.get(B),l),d.lineTo(l);g.Qb(c.Ta)?d.sq():0<p.size&&(g.Ae(p.get(0),l),d.lineTo(l))}null!=n&&n.clear(!1);null!=p&&p.clear(!1)}d.Zg(2,this.pp);return d};k.prototype.JW=function(){return this.yY()};k.prototype.yY=function(){if(1736==this.Y.G()&&1==this.Y.xo())return a.Dg.nl(this.Y,this.pp,!0,!1,this.ke);this.gj=new a.fd;this.gj.Jb(this.Y);0!=this.gj.vd&&(1!=this.eB&&a.sk.V(this.gj,this.pp,this.ke,
!0),1736==this.Y.G()&&a.lo.V(this.gj,this.gj.rd,this.eB,!1,this.ke));this.Y=this.gj.Se(this.gj.rd);1736==this.Y.G()&&(this.Y.Al(),this.Y.Hp(0));this.Y.Zg(2,this.pp);return this.Y};k.tc=function(b,c,e){if(b.u())return 1;var d=b.G();if(33==d)return 1;if(197==d)return e=new a.h,b.s(e),e.fh(a.na.ah(c,b,!1))?0:1;if(a.T.Oc(d))throw a.g.za();if(!a.T.gh(d))throw a.g.za();var d=a.na.ah(c,b,!1),g=b.Kk(d);e=e?-1:g;if(-1!=e)return e;1==e&&(d=0);e=(new k(b,c,e,0,!1)).BA();b.Zg(e,d);return e};k.Wq=function(b,c,
e,d,g){null!=d&&(d.Ii=0,d.lm=-1,d.mm=-1);if(b.u())return 1;var f=b.G();if(33==f)return 1;var n=a.na.ah(c,b,!1);if(197==f)return c=new a.h,b.s(c),c.fh(n)?(null!=d&&(d.Ii=2,d.lm=-1,d.mm=-1),0):1;if(a.T.Oc(f))return n=new a.Ua(b.description),n.dc(b,!0),k.Wq(n,c,e,d,g);g=b.Kk(n);e=e?-1:g;if(-1!=e)return e;c=new k(b,c,e,0,!1);if(550==f)e=c.aW();else if(1607==f)e=c.KW();else if(1736==f)e=c.IW();else throw a.g.za();b.Zg(e,n);null!=d&&0==e&&d.ms(c.we);return e};k.Bb=function(b,c,e,d,g){null!=d&&(d.Ii=0,d.lm=
-1,d.mm=-1);if(b.u())return 1;var f=b.G();if(33==f)return 1;var n=a.na.ah(c,b,!1);if(197==f)return c=new a.h,b.s(c),c.fh(n)?(null!=d&&(d.Ii=2,d.lm=-1,d.mm=-1),0):1;if(a.T.Oc(f))return f=new a.Ua(b.description),f.dc(b,!0),k.Wq(f,c,e,d,g);b=new k(b,c,-1,0,!0);if(550==f||1607==f||1736==f)c=b.BA();else throw a.g.za();null!=d&&d.ms(b.we);return c};k.TK=function(b,c,e,d){if(b.u())return b;var g=b.G();if(33==g)return b;var f=a.na.ah(c,b,!1);if(197==g)return c=new a.h,b.s(c),c.fh(f)?b.Ka():b;if(a.T.Oc(g))return g=
new a.Ua(b.description),g.dc(b,!0),k.TK(g,c,e,d);d=b.Kk(f);e=e?-1:d;if(2==e)return b;b=new k(b,c,e,0,!1);if(550==g)b=b.bW();else if(1607==g)b=b.LW();else if(1736==g)b=b.JW();else throw a.g.za();return b};k.EC=function(b,c,e,d){if(b.u())return b;var g=b.G();if(33==g)return b;var f=a.na.ah(c,b,!1);if(197==g)return c=new a.h,b.s(c),c.fh(f)?b.Ka():b;if(a.T.Oc(g))return f=new a.Ua(b.description),f.dc(b,!0),k.EC(f,c,e,d);if(!a.T.gh(g))throw a.g.X("OGC simplify is not implemented for this geometry type "+
g);return a.Dg.EC(b,f,!1,d)};k.prototype.ki=function(b,c,e){if(b==c)return 0;b=this.Gi.get(b);var d=this.Gi.get(c);c=b>>1;var g=d>>1,f=new a.b,k=new a.b;this.Nf.fc(2*c,f);f.y+=0!=(b&1)?this.hk:-this.hk;this.Nf.fc(2*g,k);k.y+=0!=(d&1)?this.hk:-this.hk;b=f.compare(k);return 0==b&&e?(e=this.im.get(c)-this.im.get(g),0>e?-1:0<e?1:0):b};k.prototype.Cv=function(b,c){if(b==c)return 0;var e=this.Y,d=e.Ba(b),g=e.Ba(c);if(d.x<g.x)return-1;if(d.x>g.x)return 1;if(d.y<g.y)return-1;if(d.y>g.y)return 1;for(d=1;d<
this.qV;d++)for(var g=this.zI.qd(d),f=a.ma.Xa(g),k=0;k<f;k++){var n=e.Yc(g,b,k),p=e.Yc(g,c,k);if(n<p)return-1;if(n>p)return 1}return 0};k.prototype.TQ=function(a,b){var c=this.Cv(a,b);return 0==c?a<b?-1:1:c};k.prototype.VR=function(a,b){if(a===b)return 0;var c=a.Le.Eg(a.fn()?1:0);a.fn()&&c.Lr();a=b.Le.Eg(b.fn()?1:0);b.fn()&&a.Lr();b=c.$u();var e=a.$u();return e==b?(b=c.Ui(a),Math.abs(b)<=8.881784197001252E-16*(Math.abs(a.x*c.y)+Math.abs(a.y*c.x))&&(b--,b++),0>b?1:0<b?-1:0):b<e?-1:1};return k}();a.ty=
p})(x||(x={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}I(c,b);c.prototype.G=function(){return 30};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.V=function(b,c,d,f){return b instanceof a.T?(b=new a.hd(b),c=new a.hd(c),this.V(b,c,d,f).next()):new a.sN(b,c,d,f)};c.Pp=function(b,d,f,k){var e=b.tb(),g=d.tb();if(b.u()&&d.u())return e>g?b:d;if(b.u())return d;if(d.u())return b;var n=new a.h,p=new a.h,h=new a.h;b.s(n);d.s(p);h.I(n);h.Nb(p);n=a.na.be(f,h,!0);
p=b.G();h=d.G();return 33==p&&33==h?c.oO(b,d,n):p!=h?0<e||0<g?e>g?b:d:550==p?c.XJ(b,d,n):c.XJ(d,b,n):a.Dg.Pp(b,d,f,k)};c.oO=function(b,c,d){d=d*Math.sqrt(2)*1.00001;d*=d;var e=b.w(),g=c.w(),f=new a.Ed(b.description);a.b.sc(e,g)>d&&(f.add(b),f.add(c));return f};c.XJ=function(b,c,d){var e=b.Pa(0),g=b.D(),f=c.w(),k=b.Ka();d=d*Math.sqrt(2)*1.00001;var n=new a.h;b.s(n);n.O(d,d);if(n.contains(f)){d*=d;for(var n=!1,p=[],h=0;h<g;h++)p[h]=!1;for(h=0;h<g;h++){var l=e.read(2*h),m=e.read(2*h+1),l=l-f.x,m=m-f.y;
l*l+m*m<=d&&(n=!0,p[h]=!0)}if(n)for(h=0;h<g;h++)p[h]||k.Id(b,h,h+1);else k.Id(b,0,g),k.add(c)}else k.Id(b,0,g),k.add(c);return k};c.$=null;return c}(a.ef);a.uy=b})(x||(x={}));(function(a){var b=function(){function b(a,b,c,d){this.ot=null==b;this.Ca=-1;this.ie=a;this.Rg=c;this.MV=b.next();this.mc=d}b.prototype.next=function(){if(this.ot)return null;var b;return null!=(b=this.ie.next())?(this.Ca=this.ie.Ia(),a.uy.Pp(b,this.MV,this.Rg,this.mc)):null};b.prototype.Ia=function(){return this.Ca};b.prototype.Re=
function(){return!0};return b}();a.sN=b})(x||(x={}));(function(a){var b=function(){function a(){}a.prototype.kw=function(){this.Iz=null;this.gy=-1;this.rL=!1};return a}(),c=function(){function a(){this.Es=0;this.Pj=[]}a.prototype.qP=function(a){this.Es+=a.gy;this.Pj.push(a)};a.prototype.MW=function(){this.Es-=this.Pj[this.Pj.length-1].gy;--this.Pj.length};a.prototype.Ty=function(){return this.Pj[this.Pj.length-1]};a.prototype.Eb=function(a){return a===this};return a}(),d=function(){function e(a,b,
c){this.Ca=-1;this.Pc=!1;this.QI=[!1,!1,!1,!1];this.jr=[0,0,0,0];this.TA=!1;this.al=-1;this.Yq=0;this.Ro=-1;this.rp=[];this.ie=a;this.Rg=b;this.mc=c}e.tc=function(a){var b=[],c=0;for(a=Object.keys(a);c<a.length;c++)b.push(Number(a[c]));b.sort(function(a,b){return a-b});return b};e.prototype.sH=function(b){var c=this.rp[b],d=e.tc(c)[0],g=c[d],f=g.Ty().Iz,g=g.Ty().rL;delete c[d];g&&(f=a.Km.local().V(f,this.Rg,!1,this.mc),0==b&&33==f.G()&&(b=new a.Ed(f.description),f.u()||b.add(f),f=b));return f};e.prototype.next=
function(){if(this.Pc&&this.Ro==this.al)return null;for(;!this.cL(););if(-1==this.al)return null;if(this.TA){for(this.Ro++;;){if(this.Ro>this.al||0>this.Ro)throw a.g.za();if(this.QI[this.Ro])break}this.Ca++;return this.sH(this.Ro)}this.Ca=0;this.Ro=this.al;return this.sH(this.al)};e.prototype.Ia=function(){return this.Ca};e.prototype.cL=function(){if(this.Pc)return!0;var b=null;null!=this.ie&&(b=this.ie.next(),null==b&&(this.Pc=!0,this.ie=null));if(null!=b){var c=b.tb();this.QI[c]=!0;c>=this.al&&
!this.TA&&(this.dF(c,!1,b),c>this.al&&!this.TA&&this.xX(c))}if(0<this.Yq)for(c=0;c<=this.al;c++)for(;1<this.jr[c];)if(b=this.JQ(c),0!=b.length)b=a.Dg.SR(b,this.Rg,this.mc),this.dF(c,!0,b);else break;return this.Pc};e.prototype.JQ=function(a){for(var b=[],c=[],d=this.rp[a],g=e.tc(d),f=0;f<g.length;f++){var k=g[f],p=d[k];if(this.Pc||1E4<p.Es&&1<p.Pj.length){this.jr[a]-=p.Pj.length;for(this.Yq-=p.Pj.length;0<p.Pj.length;)b.push(p.Ty().Iz),p.MW();c.push(k)}}for(f=0;f<c.length;f++)delete d[c[f]];return b};
e.prototype.xX=function(a){for(var b=0;b<a;b++)this.rp[b]=[],this.Yq-=this.jr[b],this.jr[b]=0};e.prototype.dF=function(a,d,f){var g=new b;g.kw();g.Iz=f;f=e.Mg(f);g.gy=f;f=e.We(f);if(a+1>this.rp.length)for(var k=0,n=Math.max(2,a+1);k<n;k++)this.rp.push([]);k=this.rp[a][f];void 0===k&&(k=new c,this.rp[a][f]=k);g.rL=d;k.qP(g);this.jr[a]++;this.Yq++;this.al=Math.max(this.al,a)};e.We=function(b){return 0<b?a.J.truncate(Math.log(b)/Math.log(4)+.5):0};e.Mg=function(b){var c=b.G();if(a.T.gh(c))return b.D();
if(33==c)return 1;if(197==c)return 4;if(a.T.Oc(c))return 2;throw a.g.za();};e.prototype.Re=function(){return this.cL()};return e}();a.uN=d})(x||(x={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}I(c,b);c.prototype.G=function(){return 1};c.prototype.V=function(b,c,d,f){return void 0===f?new a.uN(b,c,d):this.aS(b,c,d,f)};c.prototype.aS=function(b,c,d,f){b=new a.hd([b,c]);return this.V(b,d,f).next()};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.$=null;return c}(a.ef);
a.ei=b})(x||(x={}));(function(a){var b;(function(a){a[a.nextPath=0]="nextPath";a[a.nextSegment=1]="nextSegment";a[a.iterate=2]="iterate"})(b||(b={}));b=function(){function b(b,c,d,f){this.Ot=new a.h;this.FV=b;this.GV=c;this.br=f;this.ip=-1;this.Vl=!1;var e=b.ob;null!=e&&(e=f?e.np:e.Mb,null!=e&&(this.Pc=!1,this.ta=d,this.Mb=e,this.lx=this.Mb.mf(),this.cr=this.Vl=!0,this.Zb=0,f?this.ip=c.aa():this.Cd=c.Fa()));this.Vl||(e=c.ob,null!=e&&(e=f?e.np:e.Mb,null!=e&&(this.Pc=!1,this.ta=d,this.Mb=e,this.lx=
this.Mb.mf(),this.Vl=!0,this.cr=!1,this.Zb=0,f?this.ip=b.aa():this.Cd=b.Fa())));this.Vl||(this.Ci=f?a.na.eT(b,c,d,1<=b.Kk(0),1<=c.Kk(0)):a.na.dT(b,c,d))}b.prototype.next=function(){if(this.Vl){if(this.Pc)return!1;for(var b=!0;b;)switch(this.Zb){case 0:b=this.iW();break;case 1:b=this.jW();break;case 2:b=this.DA();break;default:throw a.g.X("internal error");}return this.Pc?!1:!0}return null==this.Ci?!1:this.Ci.next()};b.prototype.Ql=function(){return this.Vl?this.cr?this.Mb.ja(this.Bt):this.br?this.ip:
this.Cd.Db():this.Ci.Ql(this.Ci.sg)};b.prototype.Ml=function(){return this.Vl?this.cr?this.br?this.ip:this.Cd.Db():this.Mb.ja(this.Bt):this.Ci.Ml(this.Ci.bg)};b.prototype.fA=function(){if(!this.br)throw a.g.X("internal error");return this.Vl?this.cr?this.Mb.RG(this.Bt):this.Ot:this.Ci.fA(this.Ci.sg)};b.prototype.Jz=function(){if(!this.br)throw a.g.X("internal error");return this.Vl?this.cr?this.Ot:this.Mb.RG(this.Bt):this.Ci.Jz(this.Ci.bg)};b.prototype.iW=function(){if(!this.br){if(!this.Cd.Ya())return this.Pc=
!0,!1;this.Zb=1;return!0}if(-1==--this.ip)return this.Pc=!0,!1;this.cr?this.GV.jk(this.ip,this.Ot):this.FV.jk(this.ip,this.Ot);this.lx.Ni(this.Ot,this.ta);this.Zb=2;return!0};b.prototype.jW=function(){if(!this.Cd.Ea())return this.Zb=0,!0;var a=this.Cd.ba();this.lx.Wn(a,this.ta);this.Zb=2;return!0};b.prototype.DA=function(){this.Bt=this.lx.next();return-1==this.Bt?(this.Zb=this.br?0:1,!0):!1};return b}();a.Lm=b})(x||(x={}));(function(a){a=a.CN||(a.CN={});a[a.enumClosed=1]="enumClosed";a[a.enumHasNonlinearSegments=
2]="enumHasNonlinearSegments";a[a.enumOGCStartPolygon=4]="enumOGCStartPolygon";a[a.enumCalcMask=4]="enumCalcMask"})(x||(x={}));(function(a){var b=function(){function b(){}b.Cb=function(c,e,d,f,h,p,l,m,q){var g=[0,0,0],k=[0,0,0],n=[0,0,0],y=[0,0,0,0],B=new a.ea(0),r=new a.ea(0),F=new a.ea(0);if(null!=l||null!=m||null!=q)if(a.l.Qi(e))a.vh.Cb(c,d,f,h,p,l,m,q);else{h=a.C.da(h);d=a.C.da(d);var t=a.C.da(h-d);if(a.l.W(f,p)&&(a.l.W(d,h)||a.l.W(a.l.K(f),1.570796326794897)))null!=l&&(l.j=0),null!=m&&(m.j=0),
null!=q&&(q.j=0);else{if(a.l.W(f,-p)){if(a.l.W(a.l.K(f),1.570796326794897)){null!=l&&(l.j=2*a.C.Yg(c,e));null!=m&&(m.j=0<f?a.C.da(3.141592653589793-a.C.da(h)):a.C.da(h));null!=q&&(q.j=0<f?a.C.da(h):a.C.da(3.141592653589793-a.C.da(h)));return}a.l.W(a.l.K(t),3.141592653589793)&&(null!=l&&(l.j=2*a.C.Yg(c,e)),null!=m&&(m.j=0),null!=q&&(q.j=0))}else{if(a.l.W(a.l.K(f),1.570796326794897)||a.l.W(a.l.K(p),1.570796326794897)){a.xl.Cb(c,e,d,f,h,p,l,m,q);return}if(a.l.W(d,h)||a.l.W(a.l.K(t),3.141592653589793)){a.xl.Cb(c,
e,d,f,h,p,l,m,q);return}if(a.l.xd(f)){a.xl.Cb(c,e,d,f,h,p,l,m,q);return}}var u=Math.sqrt(1-e);h=a.C.da(h-d);d=0;a.C.Ck(1,e,f,d,0,B,r,F);g[0]=B.j;g[1]=r.j;g[2]=F.j;a.C.Ck(1,e,p,h,0,B,r,F);k[0]=B.j;k[1]=r.j;k[2]=F.j;n[0]=0;n[1]=0;n[2]=-1*e*a.C.n(1,e,f)*Math.sin(f);0>h?a.C.Or(n,k,g,y,0):a.C.Or(n,g,k,y,0);for(var r=[0,0,0],F=[0,0,0],H=[0,0,0],g=[0,0,0],B=[0,0,0],A=Math.acos(y[2]/1),v=1-e,M=Math.tan(A),w=1+M*M/v,x=2*n[2]*M/v,M=Math.sqrt(x*x-4*w*(n[2]*n[2]/v-1)),w=2*w,v=(-x+M)/w,x=(-x-M)/w,M=Math.tan(A),
w=M*v+n[2],A=(v+x)/2,n=(w+(M*x+n[2]))/2,M=a.C.Sp(v-A,w-n),v=n/u*1.570796326794897,x=0;100>x;x++){w=a.C.Cm(e,v);w=w*w/Math.cos(v)*(Math.sin(v)-n*w/(1*(1-e)));if(a.l.xd(w))break;v-=w}var n=a.C.n(1,e,v)*Math.cos(v),n=Math.sqrt((n-A)*(n+A)),M=1-M/n,M=M*(2-M),w=a.C.eo(r),A=a.C.eo(F),v=a.C.eo(H),z=a.C.Eu(H,r),x=a.C.Eu(H,F);a.C.fy(H,r,g);a.C.fy(H,F,B);r=Math.acos(z/(v*w));F=Math.acos(x/(v*A));F*=a.l.Ab(1,a.C.Eu(g,B));if(1.570796326794897<=a.l.K(r)&&1.570796326794897<=a.l.K(F)||3.141592653589793<a.l.K(r-
F))r=(3.141592653589793-a.l.K(r))*a.l.Ab(1,r),F=(3.141592653589793-a.l.K(F))*a.l.Ab(1,F);g=a.C.ik(M,F);B=a.C.q(n,M,a.C.ik(M,r));g=a.C.q(n,M,g);g=a.l.K(g-B)*c;r=new a.ea(0);F=new a.ea(0);H=y[1]/1;H*=-a.l.Ab(1,t);B=Math.acos(H)*a.l.Ab(1,t);b.Uf(c,e,d,f,g,B,r,F);a.l.W(h,r.j)&&a.l.W(p,F.j)||(M=a.C.Sp(a.C.da(h-r.j),p-F.j),b.Uf(c,e,d,f,g,a.C.da(B+3.141592653589793),r,F),w=a.C.Sp(a.C.da(h-r.j),p-F.j),w<M&&(B=a.C.da(B+3.141592653589793)));r=[0,0,0,0];F=[0,0,0,0];n=[0,0,0];M=[0,0,0];c=[0,0,0];d=[0,0,0];f=
[0,0,0];H=[0,0,0];n[0]=0;n[1]=0;n[2]=u;M[0]=0;M[1]=0;M[2]=0;a.C.Or(M,n,k,r,0);a.l.xd(p)?(c[0]=k[0],c[1]=k[1],c[2]=1,d[0]=1*Math.cos(h)-1*Math.sin(h),d[1]=1*Math.sin(h)+1*Math.cos(h)):(e=a.C.n(1,e,p)*Math.cos(p),c[0]=0,c[1]=0,k[2]+=Math.tan(1.570796326794897-a.l.K(p))*e*a.l.Ab(1,p),d[0]=e*Math.cos(h)-e*Math.sin(h),d[1]=e*Math.sin(h)+e*Math.cos(h));d[2]=k[2];a.C.Or(k,d,c,F,1);a.C.fy(F,r,f);a.C.fy(F,y,H);H=a.C.Eu(f,H)/(a.C.eo(f)*a.C.eo(H));H*=a.l.Ab(1,t);h=Math.acos(H)*-a.l.Ab(1,t);0<B&&0<h?h=a.C.da(h+
3.141592653589793):0>B&&0>h&&(h=a.C.da(h+3.141592653589793));null!=l&&(l.j=g);null!=m&&(m.j=B);null!=q&&(q.j=h)}}};b.Uf=function(b,c,d,f,h,p,l,m){var e=[0,0,0],g=[0,0,0],k=[0,0,0],n=[0,0,0],y=[0,0,0],B=[0,0,0],q=[0,0,0],r=[0,0,0,0],F=new a.ea(0),t=new a.ea(0),u=new a.ea(0),H=new a.ea(0),A=new a.ea(0),v=new a.ea(0);if(null!=l&&null!=m)if(a.l.Qi(c))a.vh.Uf(b,d,f,h,p,l,m);else if(a.l.xd(h))null!=l&&(l.j=d),null!=m&&(m.j=f);else if(p=a.C.da(p),0>h&&(h=a.l.K(h),p=a.C.da(p+3.141592653589793)),d=a.C.da(d),
f=a.C.da(f),1.570796326794897<a.l.K(f)&&(d=a.C.da(d+3.141592653589793),f=a.l.Ab(3.141592653589793,f)-f),a.l.W(a.l.K(f),1.570796326794897)||a.l.xd(f)||a.l.xd(p)||a.l.W(a.l.K(p),3.141592653589793))a.xl.Uf(b,c,d,f,h,p,l,m);else{var w=Math.sqrt(1-c);b=h/b;a.C.Ck(1,c,f,0,0,H,A,v);e[0]=H.j;e[1]=A.j;e[2]=A.j;q[0]=0;q[1]=0;q[2]=-1*c*a.C.n(1,c,f)*Math.sin(f);H=a.C.n(1,c,f);A=a.C.da(1.570796326794897-p);v=Math.sin(A);h=Math.cos(f);f=Math.sin(f);y[0]=H*h-f*v;y[1]=Math.cos(A);y[2]=(1-c)*H*f+h*v;0>p?a.C.Or(q,
y,e,r,0):a.C.Or(q,e,y,r,0);e=Math.acos(r[2]/1);r=Math.atan2(-r[1],-r[0]);f=1-c;y=Math.tan(e);A=1+y*y/f;H=2*q[2]*y/f;y=Math.sqrt(H*H-4*A*(q[2]*q[2]/f-1));A*=2;f=(-H+y)/A;H=(-H-y)/A;y=Math.tan(e);A=y*f+q[2];e=(f+H)/2;q=(A+(y*H+q[2]))/2;y=a.C.Sp(f-e,A-q);w=q/w*1.570796326794897;for(f=0;100>f;f++){H=a.C.Cm(c,w);H=H*H/Math.cos(w)*(Math.sin(w)-q*H/(1*(1-c)));if(a.l.xd(H))break;w-=H}w=a.C.n(1,c,w)*Math.cos(w);w=Math.sqrt((w-e)*(w+e));q=1-y/w;q*=2-q;B=Math.acos(a.C.Eu(B,g)/(a.C.eo(B)*a.C.eo(g)));B*=a.l.Ab(1,
g[0]);p=(a.C.q(w,q,a.C.ik(q,B))+b*a.l.Ab(1,p))/a.C.Yg(w,q);p=a.C.da(1.570796326794897*p);p=a.C.xp(q,p);a.C.n(w,q,p);y=a.C.da(r+d);d=Math.cos(y);p=Math.sin(y);k[0]=n[0]*d+n[1]*-p;k[1]=n[0]*p+n[1]*d;k[2]=n[2];a.C.kQ(c,k[0],k[1],k[2],u,t,F);null!=l&&(l.j=t.j);null!=m&&(m.j=u.j)}};return b}();a.WD=b})(x||(x={}));(function(a){var b=function(){function b(b){this.ab=null;this.mu=new a.b;this.nu=new a.b;this.a=b}b.prototype.compare=function(a,b,c){this.a.Nc(b,this.mu);this.a.Nc(a.ja(c),this.nu);return this.mu.compare(this.nu)};
return b}(),c=function(){function b(b){this.cg=new a.b;this.el=new a.b;this.a=b}b.prototype.Yh=function(a){this.cg.L(a)};b.prototype.compare=function(a,b){this.a.Nc(a.ja(b),this.el);return this.cg.compare(this.el)};return b}(),d=function(a){function b(b){a.call(this,b.a,b.ta,!1);this.bb=b}I(b,a);b.prototype.compare=function(a,b,c){if(this.Ng)return-1;var e=this.bb.he.yo(this.bb.ri(b));a=a.ja(c);var d=this.bb.he.yo(this.bb.ri(a));this.rn=c;return this.YF(b,e,a,d)};return b}(a.gE),e=function(a){function b(b){a.call(this,
b.a,b.ta);this.bb=b}I(b,a);b.prototype.compare=function(a,b){if(this.Ng)return-1;a=this.bb.he.yo(this.bb.ri(a.ja(b)));this.rn=b;return this.ZF(b,a)};return b}(a.bO),g=function(){function g(){this.Tc=this.Hf=this.Xo=this.he=this.Gh=this.Nd=this.ib=this.a=null;this.ih=!1;this.Th=this.An=this.Fe=this.gl=this.Ih=this.bl=this.gg=this.xe=null;this.Vh=this.zr=this.BB=this.ta=0;this.Kw=this.Lo=!1;this.mp=new a.b;this.oj=new a.b;this.ib=new a.ad(8);this.Nd=new a.ad(5);this.Gh=new a.Lu;this.he=new a.Lu;this.ih=
!1;this.Th=new a.b;this.Th.ka(0,0);this.ta=0;this.Vh=-1;this.Lo=!1;this.a=null;this.Hf=new a.uk;this.Tc=new a.uk;this.Ih=new a.ia(0);this.gl=new a.eE;this.gg=new a.ia(0);this.bl=new a.ia(0);this.Xo=new a.Wa}g.prototype.JY=function(b,c){var e=new a.Hd;e.yC();b.Xc(e);this.Yr(b);this.Lo=!1;this.ta=c;this.BB=c*c;c=this.HC();b.Xc(e);c||(this.mS(),c||this.HC());-1!=this.Vh&&(this.a.le(this.Vh),this.Vh=-1);this.a=null;return this.Lo};g.prototype.NY=function(a,b){this.Yr(a);this.Lo=!1;this.ta=b;this.BB=b*
b;this.ih=!1;this.HC();this.ih||(this.ih=1==a.zq(b,!0,!1));-1!=this.Vh&&(this.a.le(this.Vh),this.Vh=-1);this.a=null};g.prototype.Jg=function(a,b){return this.ib.S(a,0+b)};g.prototype.mC=function(a,b,c){this.ib.P(a,0+b,c)};g.prototype.ri=function(a){return this.ib.S(a,2)};g.prototype.VX=function(a,b){this.ib.P(a,2,b)};g.prototype.cH=function(a,b){return this.ib.S(a,3+b)};g.prototype.Jq=function(a){return this.ib.S(a,7)};g.prototype.um=function(a,b){this.ib.P(a,7,b)};g.prototype.Kq=function(a,b){return this.ib.S(a,
3+this.Iq(a,b))};g.prototype.Zr=function(a,b,c){this.ib.P(a,3+this.Iq(a,b),c)};g.prototype.HT=function(a,b){return this.ib.S(a,5+this.Iq(a,b))};g.prototype.as=function(a,b,c){this.ib.P(a,5+this.Iq(a,b),c)};g.prototype.Ns=function(a){return this.Nd.S(a,0)};g.prototype.SX=function(a,b){this.Nd.P(a,0,b)};g.prototype.Nz=function(a){return this.Nd.S(a,4)};g.prototype.Vr=function(a,b){this.Nd.P(a,4,b)};g.prototype.Nl=function(a){return this.Nd.S(a,1)};g.prototype.ao=function(a,b){this.Nd.P(a,1,b)};g.prototype.Mz=
function(a){return this.Nd.S(a,3)};g.prototype.tu=function(a,b){this.Nd.P(a,3,b)};g.prototype.Mn=function(a){var b=this.Nd.Pe(),c=this.Gh.mi();this.SX(b,c);-1!=a?(this.Gh.addElement(c,a),this.a.Va(a,this.Vh,b),this.Vr(b,this.a.Za(a))):this.Vr(b,-1);return b};g.prototype.ER=function(a){this.Nd.kd(a)};g.prototype.bF=function(a,b){this.Gh.addElement(this.Ns(a),b);this.a.Va(b,this.Vh,a)};g.prototype.cu=function(a){var b=this.ib.Pe(),c=this.he.mi();this.VX(b,c);-1!=a&&this.he.addElement(c,a);return b};
g.prototype.cF=function(a,b){this.he.addElement(this.ri(a),b)};g.prototype.Jv=function(a){this.ib.kd(a);a=this.Ih.Ov(a);0<=a&&this.Ih.HJ(a)};g.prototype.Jj=function(b,c){if(-1==this.Jg(b,0))this.mC(b,0,c);else if(-1==this.Jg(b,1))this.mC(b,1,c);else throw a.g.za();this.Ry(b,c)};g.prototype.Ry=function(a,b){var c=this.Nl(b);if(-1!=c){var e=this.Kq(c,b);this.as(e,b,a);this.Zr(a,b,e);this.Zr(c,b,a);this.as(a,b,c)}else this.as(a,b,a),this.Zr(a,b,a),this.ao(b,a)};g.prototype.Iq=function(a,b){return this.Jg(a,
0)==b?0:1};g.prototype.Ln=function(a,b){var c=this.Mz(b);-1!=c&&(this.Hf.Kd(c,-1),this.tu(b,-1));var e,c=this.Nl(b);if(-1!=c){var d=e=c,g;do{g=!1;var f=this.Iq(e,b),k=this.cH(e,f);if(this.Jg(e,f+1&1)==a){this.Kv(e);this.he.zh(this.ri(e));this.Jv(e);if(e==k){c=-1;break}c==e&&(c=this.Nl(b),d=k,g=!0)}e=k}while(e!=d||g);if(-1!=c){do f=this.Iq(e,b),k=this.cH(e,f),this.mC(e,f,a),e=k;while(e!=d);e=this.Nl(a);-1!=e?(d=this.Kq(e,a),g=this.Kq(c,a),d==e?(this.ao(a,c),this.Ry(e,a),this.ao(a,e)):g==c&&this.Ry(c,
a),this.Zr(c,a,d),this.as(d,a,c),this.Zr(e,a,g),this.as(g,a,e)):this.ao(a,c)}}c=this.Ns(a);e=this.Ns(b);for(d=this.Gh.xc(e);-1!=d;d=this.Gh.nb(d))this.a.Va(this.Gh.ja(d),this.Vh,a);this.Gh.mz(c,e);this.ER(b)};g.prototype.UV=function(a,b){var c=this.Jg(a,0),e=this.Jg(a,1),d=this.Jg(b,0),g=this.Jg(b,1);this.he.mz(this.ri(a),this.ri(b));b==this.Nl(c)&&this.ao(c,a);b==this.Nl(e)&&this.ao(e,a);this.Kv(b);this.Jv(b);c==d&&e==g||e==d&&c==g||(this.wo(c,this.mp),this.wo(d,this.oj),this.mp.ub(this.oj)?(c!=
d&&this.Ln(c,d),e!=g&&this.Ln(e,g)):(e!=d&&this.Ln(e,d),c!=g&&this.Ln(c,g)))};g.prototype.Kv=function(a){var b=this.Jg(a,1);this.mG(a,this.Jg(a,0));this.mG(a,b)};g.prototype.mG=function(a,b){var c=this.Kq(a,b),e=this.HT(a,b),d=this.Nl(b);c!=a?(this.Zr(e,b,c),this.as(c,b,e),d==a&&this.ao(b,c)):this.ao(b,-1)};g.prototype.jF=function(a,b,c){var e=this.he.xc(a),d=this.he.ja(e);a=this.jf(d);var g=this.jf(this.a.U(d));this.a.bs(d,b,c,!0);for(e=this.he.nb(e);-1!=e;e=this.he.nb(e)){var d=this.he.ja(e),f=
this.jf(d)==a;this.a.bs(d,b,c,f)}e=b.Mq(c,0).ec();b=b.Mq(c,b.Rl(c)-1).Bc();this.sL(a,e);this.sL(g,b)};g.prototype.fG=function(a,b,c){var e=this.ri(a),d=this.Jg(a,0),g=this.Jg(a,1),f=this.cu(-1);this.Ih.add(f);this.um(f,-3);this.gg.add(f);this.Jj(f,d);a=1;for(b=b.Rl(c);a<b;a++)c=this.Mn(-1),this.bl.add(c),this.gg.add(c),this.Jj(f,c),f=this.cu(-1),this.Ih.add(f),this.um(f,-3),this.gg.add(f),this.Jj(f,c);this.Jj(f,g);for(e=this.he.xc(e);-1!=e;e=this.he.nb(e))if(g=this.he.ja(e),this.jf(g)==d){a=0;do 0<
a&&(f=this.gg.get(a-1),this.bF(f,g),-1==this.Nz(f)&&this.Vr(f,this.a.Za(g))),f=this.gg.get(a),a+=2,this.cF(f,g),g=this.a.U(g);while(a<this.gg.size)}else{a=this.gg.size-1;do a<this.gg.size-2&&(f=this.gg.get(a+1),this.bF(f,g),0>this.Nz(f)&&this.Vr(f,this.a.Za(g))),f=this.gg.get(a),a-=2,this.cF(f,g),g=this.a.U(g);while(0<=a)}this.gg.clear(!1)};g.prototype.jf=function(a){return this.a.Sa(a,this.Vh)};g.prototype.LJ=function(b,c,e){var d=this.Jg(c,0),g=new a.b;this.wo(d,g);var f=new a.b,k=this.Jg(c,1);
this.wo(k,f);var n=e.Rl(b),h=e.Mq(b,0),p=new a.b;h.Oq(p);if(!g.ub(p)){if(!this.ih){var l=g.compare(this.Th),p=p.compare(this.Th);0>l*p&&(this.ih=!0)}this.HG(d,this.gg);this.bl.add(d)}!this.ih&&1<n&&(l=g.compare(f),h=h.Bc(),g.compare(h)!=l||h.compare(f)!=l?this.ih=!0:0>h.compare(this.Th)&&(this.ih=!0));h=e.Mq(b,n-1);b=h.Bc();f.ub(b)||(this.ih||(l=f.compare(this.Th),p=b.compare(this.Th),0>l*p&&(this.ih=!0)),this.HG(k,this.gg),this.bl.add(k));this.gg.add(c);f=0;for(k=this.gg.size;f<k;f++)b=this.gg.get(f),
e=this.Jq(b),a.ad.CA(e)&&(this.Tc.Kd(e,-1),this.um(b,-1)),b!=c&&-3!=this.Jq(b)&&(this.Ih.add(b),this.um(b,-3));this.gg.clear(!1)};g.prototype.pQ=function(a,b){this.xe.compare(this.Tc,this.Tc.ja(a),b);this.xe.Ng&&(this.xe.Gs(),this.yG(a,b))};g.prototype.yG=function(b,c){this.Lo=!0;b=this.Tc.ja(b);c=this.Tc.ja(c);var e,d;d=this.he.yo(this.ri(b));var g=this.he.yo(this.ri(c));e=this.a.ic(d);null==e&&(null==this.Fe&&(this.Fe=new a.Hb),this.a.od(d,this.Fe),e=this.Fe);d=this.a.ic(g);null==d&&(null==this.An&&
(this.An=new a.Hb),this.a.od(g,this.An),d=this.An);this.gl.Ap(e);this.gl.Ap(d);this.gl.Ma(this.ta,!0)&&(this.ih=!0);this.YK(b,c,-1,this.gl);this.gl.clear()};g.prototype.yS=function(b,c){this.Lo=!0;c=this.Tc.ja(c);var e,d=this.he.yo(this.ri(c));e=this.a.ic(d);null==e&&(null==this.Fe&&(this.Fe=new a.Hb),this.a.od(d,this.Fe),e=this.Fe);d=this.NG(b);this.gl.Ap(e);this.a.wj(d,this.Xo);this.gl.tA(this.ta,this.Xo,!0);this.YK(c,-1,b,this.gl);this.gl.clear()};g.prototype.tU=function(){if(0!=this.Ih.size)for(;0!=
this.Ih.size;){if(this.Ih.size>Math.max(100,this.a.vd)){this.Ih.clear(!1);this.ih=!0;break}var a=this.Ih.Fc();this.Ih.Pf();this.um(a,-1);-1!=this.QU(a)&&this.sU(a);this.Ko=!1}};g.prototype.sU=function(a){var b;this.Ko?(b=this.Tc.jv(this.$I,this.WI,a,!0),this.Ko=!1):b=this.Tc.aF(a);-1==b?this.UV(this.Tc.ja(this.Tc.QG()),a):(this.um(a,b),this.xe.Ng&&(this.xe.Gs(),this.yG(this.xe.rn,b)))};g.prototype.QU=function(b){var c=this.Jg(b,0);b=this.Jg(b,1);this.wo(c,this.mp);this.wo(b,this.oj);if(a.b.sc(this.mp,
this.oj)<=this.BB)return this.ih=!0,-1;var e=this.mp.compare(this.Th),d=this.oj.compare(this.Th);return 0>=e&&0<d?b:0>=d&&0<e?c:-1};g.prototype.kS=function(){var b=new a.ia(0);b.yb(this.a.vd);for(var c=this.a.Qr(),e=c.next();-1!=e;e=c.next())-1!=this.a.Sa(e,this.Vh)&&b.add(e);this.a.Xx(b,b.size);this.lS(b)};g.prototype.lS=function(c){this.Hf.clear();this.Hf.Qe(c.size);this.Hf.Ep(new b(this.a));var e=new a.b;e.$c();for(var d=-1,g=new a.b,f=0,k=c.size;f<k;f++){var n=c.get(f);this.a.Nc(n,g);g.ub(e)?
(n=this.a.Sa(n,this.Vh),this.Ln(d,n)):(d=this.jf(n),this.a.Nc(n,e),n=this.Hf.ro(n),this.tu(d,n))}};g.prototype.mS=function(){var b=new a.ia(0);b.yb(this.a.vd);for(var c=this.Hf.xc(-1);-1!=c;c=this.Hf.nb(c))b.add(this.Hf.ja(c));this.Hf.clear();this.a.Xx(b,b.size);for(var c=0,e=b.size;c<e;c++){var d=b.get(c),g=this.jf(d),d=this.Hf.ro(d);this.tu(g,d)}};g.prototype.HG=function(b,c){var e=this.Nl(b);if(-1!=e){var d=e;do a.ad.CA(this.Jq(d))&&c.add(d),d=this.Kq(d,b);while(d!=e)}};g.prototype.sL=function(a,
b){for(a=this.Gh.xc(this.Ns(a));-1!=a;a=this.Gh.nb(a))this.a.Qf(this.Gh.ja(a),b)};g.prototype.YK=function(a,b,c,e){this.Kv(a);-1!=b&&this.Kv(b);this.LJ(0,a,e);-1!=b&&this.LJ(1,b,e);-1!=c&&(e.cg.w(this.mp),this.wo(c,this.oj),this.oj.ub(this.mp)||this.bl.add(c));c=0;for(var d=this.bl.size;c<d;c++){var g=this.bl.get(c),f=this.Mz(g);-1!=f&&(this.Hf.Kd(f,-1),this.tu(g,-1))}c=this.ri(a);d=-1!=b?this.ri(b):-1;this.jF(c,e,0);-1!=b&&this.jF(d,e,1);this.fG(a,e,0);-1!=b&&this.fG(b,e,1);this.he.zh(c);this.Jv(a);
-1!=b&&(this.he.zh(d),this.Jv(b));c=0;for(d=this.bl.size;c<d;c++)g=this.bl.get(c),g==this.zr&&(this.Kw=!0),f=this.Mz(g),-1==f&&(f=this.Hf.aF(this.NG(g)),-1==f?(a=this.jf(this.Hf.ja(this.Hf.QG())),this.Ln(a,g)):this.tu(g,f));this.bl.clear(!1)};g.prototype.wo=function(a,b){this.a.pH(this.Nz(a),b)};g.prototype.NG=function(a){return this.Gh.yo(this.Ns(a))};g.prototype.HC=function(){this.Kw=!1;this.zr=-1;null==this.xe&&(this.Tc.Dw=!1,this.xe=new d(this),this.Tc.Oo=this.xe);var b=new a.ia(0),g=null,f=null,
k=0;this.WI=this.$I=-1;this.Ko=!1;for(var n=this.Hf.xc(-1);-1!=n;){k++;this.Ko=!1;var h=this.Hf.ja(n);this.zr=this.jf(h);this.a.Nc(h,this.Th);this.xe.QK(this.Th.y,this.Th.x);var p,l=this.Nl(this.zr);p=-1==l;if(!p){h=l;do{var m=this.Jq(h);-1==m?(this.Ih.add(h),this.um(h,-3)):-3!=m&&b.add(m);h=this.Kq(h,this.zr)}while(h!=l)}if(0<b.size){this.Ko=1==b.size&&1==this.Ih.size;p=0;for(l=b.size;p<l;p++)h=this.Tc.ja(b.get(p)),this.um(h,-2);var q=-2,r=-2;p=0;for(l=b.size;p<l;p++){m=b.get(p);if(-2==q){var t=
this.Tc.Ve(m);-1!=t?(h=this.Tc.ja(t),h=this.Jq(h),-2!=h&&(q=t)):q=-1}-2==r&&(m=this.Tc.nb(m),-1!=m?(h=this.Tc.ja(m),h=this.Jq(h),-2!=h&&(r=m)):r=-1);if(-2!=q&&-2!=r)break}p=0;for(l=b.size;p<l;p++)m=b.get(p),h=this.Tc.ja(m),this.Tc.Kd(m,-1),this.um(h,-1);b.clear(!1);this.$I=-1!=q?q:-1;this.WI=-1!=r?r:-1;-1!=q&&-1!=r?this.Ko||this.pQ(q,r):-1==q&&-1==r&&(this.Ko=!1)}else p&&(null==g&&(g=new e(this)),g.Yh(this.Th),this.Tc.lK(g),g.Ng&&(g.Gs(),this.yS(this.zr,g.rn)));this.tU();this.Kw?(this.Kw=!1,null==
f&&(f=new c(this.a)),f.Yh(this.Th),n=this.Hf.lK(f)):n=this.Hf.nb(n)}return this.Lo};g.prototype.Yr=function(b){this.a=b;this.Vh=this.a.Ud();this.ib.Qe(b.vd+32);this.Nd.Qe(b.vd);this.Gh.pu(b.vd);this.Gh.Vn(b.vd);this.he.pu(b.vd+32);this.he.Vn(b.vd+32);for(b=this.a.rd;-1!=b;b=this.a.Ue(b))if(a.T.Ic(this.a.hc(b)))for(n=this.a.Pb(b);-1!=n;n=this.a.Sb(n)){var c=this.a.La(n),e=this.a.cb(n),d=this.Mn(e),g=this.cu(e);this.Jj(g,d);h=this.a.U(e);e=0;for(c-=2;e<c;e++){var f=this.a.U(h),k=this.Mn(h);this.Jj(g,
k);g=this.cu(h);this.Jj(g,k);h=f}this.a.Qb(n)?(k=this.Mn(h),this.Jj(g,k),g=this.cu(h),this.Jj(g,k),this.Jj(g,d)):(k=this.Mn(h),this.Jj(g,k))}else for(var n=this.a.Pb(b);-1!=n;n=this.a.Sb(n))for(var h=this.a.cb(n),d=0,c=this.a.La(n);d<c;d++)this.Mn(h),h=this.a.U(h);this.kS()};return g}();a.XD=g})(x||(x={}));(function(a){var b=function(b){function c(e,d,f){b.call(this);if(void 0!==e)if(void 0!==f){this.description=a.ze.Ig();var g=new a.pd;g.I(e,d,f);this.CC(g)}else if(void 0!==d)this.description=a.ze.Ig(),
this.rb(e,d);else if(e instanceof a.ma)this.description=e;else if(e instanceof a.b)this.description=a.ze.Ig(),this.rb(e);else if(e instanceof c)this.description=e.description,this.rb(e.Be(),e.nf()),null!==e.la&&(this.la=e.la.slice(0));else throw a.g.F();else this.description=a.ze.Ig()}I(c,b);c.prototype.w=function(b){if(void 0!==b){if(this.Hc())throw a.g.X("This operation should not be performed on an empty geometry.");b.ka(this.la[0],this.la[1])}else{if(this.Hc())throw a.g.X("This operation should not be performed on an empty geometry.");
b=new a.b;b.ka(this.la[0],this.la[1]);return b}};c.prototype.rb=function(a,b){"number"===typeof a?(this.Ac(),null==this.la&&this.nq(),this.la[0]=a,this.la[1]=b):(this.Ac(),this.rb(a.x,a.y))};c.prototype.mA=function(){if(this.Hc())throw a.g.X("This operation should not be performed on an empty geometry.");var b=new a.pd;b.x=this.la[0];b.y=this.la[1];this.description.uH()?b.z=this.la[2]:b.z=a.ma.de(1);return b};c.prototype.CC=function(b){this.Ac();var c=this.hasAttribute(1);c||a.ma.PH(1,b.z)||(this.Td(1),
c=!0);null==this.la&&this.nq();this.la[0]=b.x;this.la[1]=b.y;c&&(this.la[2]=b.z)};c.prototype.Be=function(){if(this.Hc())throw a.g.X("This operation should not be performed on an empty geometry.");return this.la[0]};c.prototype.BC=function(a){this.setAttribute(0,0,a)};c.prototype.nf=function(){if(this.Hc())throw a.g.X("This operation should not be performed on an empty geometry.");return this.la[1]};c.prototype.RK=function(a){this.setAttribute(0,1,a)};c.prototype.rH=function(){return this.Yc(1,0)};
c.prototype.sY=function(a){this.setAttribute(1,0,a)};c.prototype.aH=function(){return this.Yc(2,0)};c.prototype.cY=function(a){this.setAttribute(2,0,a)};c.prototype.Cc=function(){return this.KG(3,0)};c.prototype.BK=function(a){this.setAttribute(3,0,a)};c.prototype.Yc=function(b,c){var e=this.description.mg(b);return 0<=e?this.la[this.description.wk(e)+c]:a.ma.de(b)};c.prototype.KG=function(b,c){var e=this.description.mg(b);return 0<=e?this.la[this.description.wk(e)+c]:a.ma.de(b)};c.prototype.setAttribute=
function(a,b,c){this.Ac();var e=this.description.mg(a);0>e&&(this.Td(a),e=this.description.mg(a));null==this.la&&this.nq();this.la[this.description.wk(e)+b]=c};c.prototype.G=function(){return 33};c.prototype.tb=function(){return 0};c.prototype.Oa=function(){this.Ac();null!=this.la&&(this.la[0]=NaN,this.la[1]=NaN)};c.prototype.mo=function(b){if(null!=this.la){for(var c=a.ze.vx(b,this.description),e=[],d=0,f=0,k=b.Ga;f<k;f++){var h=b.qd(f),p=a.ma.Xa(h);if(-1==c[f])for(var l=a.ma.de(h),h=0;h<p;h++)e[d]=
l,d++;else for(l=this.description.wk(c[f]),h=0;h<p;h++)e[d]=this.la[l],d++,l++}this.la=e}this.description=b};c.prototype.nq=function(){this.bK(this.description.af.length);c.Bb(this.description.af,this.la,this.description.af.length);this.la[0]=NaN;this.la[1]=NaN};c.prototype.Xc=function(b){if(b instanceof a.Hd){if(!this.Hc()){var c=this.w();b.$h(c,c);this.rb(c)}}else this.Hc()||(this.Td(1),c=this.mA(),this.CC(b.Rp(c)))};c.prototype.copyTo=function(b){if(33!=b.G())throw a.g.F();b.Ac();null==this.la?
(b.Oa(),b.la=null,b.Fg(this.description)):(b.Fg(this.description),b.bK(this.description.af.length),c.Bb(this.la,b.la,this.description.af.length))};c.prototype.Ka=function(){return new c(this.description)};c.prototype.u=function(){return this.Hc()};c.prototype.Hc=function(){return null==this.la||isNaN(this.la[0])||isNaN(this.la[1])};c.prototype.Qn=function(a){a.Oa();this.description!=a.description&&a.Fg(this.description);a.Nb(this)};c.prototype.s=function(a){this.Hc()?a.Oa():(a.o=this.la[0],a.A=this.la[1],
a.v=this.la[0],a.B=this.la[1])};c.prototype.Cp=function(a){if(this.Hc())a.Oa();else{var b=this.mA();a.o=b.x;a.A=b.y;a.Bf=b.z;a.v=b.x;a.B=b.y;a.$g=b.z}};c.prototype.xf=function(b,c){var e=new a.zc;if(this.Hc())return e.Oa(),e;b=this.Yc(b,c);e.ca=b;e.ha=b;return e};c.prototype.bK=function(b){if(null==this.la)this.la=a.J.gf(b);else if(this.la.length<b){for(var c=this.la.slice(0),e=this.la.length;e<b;e++)c[e]=0;this.la=c}};c.Bb=function(a,b,c){if(0<c)for(c=0;c<a.length;c++)b[c]=a[c]};c.prototype.Eb=function(a){if(a==
this)return!0;if(!(a instanceof c)||this.description!=a.description)return!1;if(this.Hc())return a.Hc()?!0:!1;for(var b=0,e=this.description.af.length;b<e;b++)if(this.la[b]!=a.la[b])return!1;return!0};c.prototype.jc=function(){var b=this.description.jc();if(!this.Hc())for(var c=0,d=this.description.af.length;c<d;c++)var f=this.la[c],f=a.J.truncate(f^f>>>32),b=a.J.dh(f,b);return b};c.prototype.Gg=function(){return null};return c}(a.T);a.Wa=b})(x||(x={}));(function(a){var b=function(){function a(a,
b,c){void 0!==a&&(this.x=a,this.y=b,this.z=c)}a.pa=function(b,c,d){var e=new a;e.x=b;e.y=c;e.z=d;return e};a.prototype.I=function(a,b,c){this.x=a;this.y=b;this.z=c};a.prototype.Vx=function(){this.z=this.y=this.x=0};a.prototype.normalize=function(){var a=this.length();0==a&&(this.x/=a,this.y/=a,this.z/=a)};a.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)};a.prototype.sub=function(b){return new a(this.x-b.x,this.y-b.y,this.z-b.z)};a.prototype.Vg=function(b){return new a(this.x*
b,this.y*b,this.z*b)};a.prototype.dv=function(){this.x=NaN};a.prototype.Hy=function(){return isNaN(this.x)};a.prototype.oi=function(a){return this.x*a.x+this.y*a.y+this.z*a.z};return a}();a.pd=b})(x||(x={}));(function(a){var b=function(){function b(a,b,c){this.tx=this.dx=null;this.tg=b;this.EV=b.y-c;this.DV=b.y+c;this.Ir=0;this.NA=a;this.ta=c;this.QV=c*c;this.OA=0!=c;this.yw=!1}b.prototype.result=function(){return 0!=this.Ir?1:0};b.prototype.YO=function(b){b=b.gc(b.qe(this.tg,!1));return a.b.sc(b,
this.tg)<=this.QV?!0:!1};b.prototype.pG=function(a){if(!this.OA&&(this.NA&&this.tg.ub(a.ec())||this.tg.ub(a.Bc())))this.yw=!0;else if(a.ra==this.tg.y&&a.ra==a.oa){if(this.NA&&!this.OA){var b=Math.max(a.ua,a.sa);this.tg.x>Math.min(a.ua,a.sa)&&this.tg.x<b&&(this.yw=!0)}}else{var c=!1,b=Math.max(a.ua,a.sa);this.tg.x>b?c=!0:this.tg.x>=Math.min(a.ua,a.sa)&&(c=0<a.Tq(!0,this.tg.y,this.tx,null)&&this.tx[0]<=this.tg.x);if(c){if(this.tg.y==a.ec().y){if(this.tg.y<a.Bc().y)return}else if(this.tg.y==a.Bc().y&&
this.tg.y<a.ec().y)return;this.Ir=this.NA?this.Ir^1:this.Ir+(a.ec().y>a.Bc().y?1:-1)}}};b.prototype.ku=function(a){var b=a.xf(0,1);if(b.ca>this.DV||b.ha<this.EV)return!1;if(this.OA&&this.YO(a))return!0;if(b.ca>this.tg.y||b.ha<this.tg.y)return!1;null==this.dx&&(this.dx=[null,null,null,null,null]);null==this.tx&&(this.tx=[0,0,0]);b=a.qH(this.dx);if(0<b)for(a=0;a<b;a++){var c=this.dx[a].get();this.pG(c);if(this.yw)return!0}else if(this.pG(a),this.yw)return!0;return!1};b.$=function(a,c,d){c=new b(0==
a.xo(),c,d);for(a=a.Fa();a.Ya();)for(;a.Ea();)if(d=a.ba(),c.ku(d))return-1;return c.result()};b.bd=function(c,e,d,f){var g=new a.h;c.ac(g);g.O(f,f);var k=new b(0==c.xo(),d,f);c=c.Fa();var n=new a.h;n.I(g);n.v=d.x+f;n.A=d.y-f;n.B=d.y+f;d=e.Yz(n,f);for(f=d.next();-1!=f;f=d.next())if(c.Tb(e.ja(f)),c.Ea()&&(f=c.ba(),k.ku(f)))return-1;return k.result()};b.kn=function(c,e,d){if(c.u())return 0;var g=new a.h;c.ac(g);g.O(d,d);if(!g.contains(e))return 0;g=c.ob;if(null!=g){var f=g.Hi;if(null!=f){f=f.rm(e.x,
e.y);if(1==f)return 1;if(0==f)return 0}g=g.Mb;if(null!=g)return b.bd(c,g,e,d)}return b.$(c,e,d)};b.XU=function(c,e,d,f){if(c.u())return 0;var g=new a.h;c.ac(g);g.O(f,f);if(!g.contains(e,d))return 0;g=c.ob;if(null!=g&&(g=g.Hi,null!=g)){g=g.rm(e,d);if(1==g)return 1;if(0==g)return 0}return b.$(c,a.b.pa(e,d),f)};b.WU=function(a,c,d){return c.u()?0:b.kn(a,c.w(),d)};b.zA=function(c,e,d,f,h){var g=new a.h;c.ac(g);g.O(f,f);if(!g.contains(d))return 0;var k=new b(!0,d,f);if(null!=h){var n=new a.h;n.I(g);n.v=
d.x+f;n.A=d.y-f;n.B=d.y+f;c=c.Fa();f=h.Yz(n,f);for(n=f.next();-1!=n;n=f.next())if(c.Tb(h.ja(n),e),c.Ea()&&c.Ta==e&&(n=c.ba(),k.ku(n)))return-1}else if(c=c.Fa(),c.fC(e),c.Ya())for(;c.Ea();)if(n=c.ba(),k.ku(n))return-1;return k.result()};b.yA=function(c,e,d){var g=new a.h;c.ac(g);g.O(d,d);if(!g.contains(e))return 0;e=new b(!1,e,d);for(d=c.Fa();d.Ya();)if(!(0>c.Sm(d.Ta))){for(e.Ir=0;d.Ea();)if(g=d.ba(),e.ku(g))return-1;if(0!=e.Ir)return 1}return e.result()};b.Oi=function(c,e,d,f,h){var g=c.Fa();g.fC(e);
if(!g.Ya()||!g.Ea())throw a.g.X("corrupted geometry");for(e=2;2==e&&g.Ea();)e=g.ba().gc(.5),e=b.zA(c,d,e,f,h);if(2==e)throw a.g.X("internal error");return 1==e?!0:!1};b.qm=function(a,b){a=a.D();return 16>a?!1:2*a+Math.log(a)/Math.log(2)*1*b<1*a*b};return b}();a.ff=b})(x||(x={}));(function(a){var b=function(a){function b(b){a.call(this,!0,b)}I(b,a);b.prototype.Ka=function(){return new b(this.description)};b.prototype.tb=function(){return 2};b.prototype.G=function(){return 1736};b.prototype.KH=function(a,
b,c){this.FU(a,b,c)};b.prototype.hT=function(){this.zT()};return b}(a.wl);a.Ja=b})(x||(x={}));(function(a){(function(a){a[a.PiPOutside=0]="PiPOutside";a[a.PiPInside=1]="PiPInside";a[a.PiPBoundary=2]="PiPBoundary"})(a.IN||(a.IN={}));var b=function(){function b(){}b.WH=function(b,c,d){b=a.ff.WU(b,c,d);return 0==b?0:1==b?1:2};b.ge=function(b,c,d){b=a.ff.kn(b,c,d);return 0==b?0:1==b?1:2};b.dX=function(b,c,d,f){b=a.ff.XU(b,c,d,f);return 0==b?0:1==b?1:2};b.m_=function(b,c,d,f){return 0==a.ff.zA(b,c,d,f,
null)?0:1};b.yA=function(b,c,d){return 0==a.ff.yA(b,c,d)?0:1};b.NR=function(c,e,d,f,h){if(e.length<d||h.length<d)throw a.g.F();for(var g=0;g<d;g++)h[g]=b.ge(c,e[g],f)};b.YR=function(c,e,d,f,h){if(e.length/2<d||h.length<d)throw a.g.F();for(var g=0;g<d;g++)h[g]=b.dX(c,e[2*g],e[2*g+1],f)};b.fL=function(c,e,d,f,h){if(1736==c.G())b.NR(c,e,d,f,h);else if(197==c.G()){var g=new a.h;c.s(g);b.OM(g,e,d,f,h)}else throw a.g.X("invalid_call");};b.v_=function(c,e,d,f,h){if(1736==c.G())b.YR(c,e,d,f,h);else if(197==
c.G()){var g=new a.h;c.s(g);b.SM(g,e,d,f,h)}else throw a.g.Da();};b.OM=function(b,c,d,f,h){if(c.length<d||h.length<d)throw a.g.F();if(b.u())for(f=0;f<d;f++)h[f]=0;else for(b.O(.5*-f,.5*-f),b.O(.5*f,.5*f),f=0;f<d;f++)b.contains(c[f])?h[f]=1:b.contains(c[f])?h[f]=2:h[f]=0};b.SM=function(b,c,d,f,h){if(c.length/2<d||h.length<d)throw a.g.F();if(b.u())for(f=0;f<d;f++)h[f]=0;else for(b.O(.5*-f,.5*-f),b.O(.5*f,.5*f),f=0;f<d;f++)b.contains(c[2*f],c[2*f+1])?h[f]=1:b.contains(c[2*f],c[2*f+1])?h[f]=2:h[f]=0};
b.$T=function(a,b,c,d,f){for(var e=0;e<c;e++)f[e]=a.mt(b[e],d)?2:0};b.jS=function(a,b,c,d,f){var e=a.ob,g=null;null!=e&&(g=e.Hi);for(var e=c,k=0;k<c;k++)if(f[k]=1,null!=g){var n=b[k];0==g.rm(n.x,n.y)&&(f[k]=0,e--)}if(0!=e)for(a=a.Fa();a.Ya()&&0!=e;)for(;a.Ea()&&0!=e;)for(g=a.ba(),k=0;k<c&&0!=e;k++)1==f[k]&&g.mt(b[k],d)&&(f[k]=2,e--);for(k=0;k<c;k++)1==f[k]&&(f[k]=0)};b.gL=function(c,e,d,f,h){var g=c.G();if(1607==g)b.jS(c,e,d,f,h);else if(a.T.Oc(g))b.$T(c,e,d,f,h);else throw a.g.X("Invalid call.");
};return b}();a.gd=b})(x||(x={}));(function(a){var b=function(a){function b(b,c){2==arguments.length?(a.call(this,!1,b.description),this.Rf(b),this.lineTo(c)):a.call(this,!1,b)}I(b,a);b.prototype.Ka=function(){return new b(this.description)};b.prototype.tb=function(){return 1};b.prototype.G=function(){return 1607};b.prototype.KH=function(a,b,c,d){this.GU(a,b,c,d)};return b}(a.wl);a.Ua=b})(x||(x={}));(function(a){var b=function(){function a(){}a.$_=function(){};return a}();a.d_=b})(x||(x={}));(function(a){(function(a){a[a.clipWithInputHorizon=
1]="clipWithInputHorizon";a[a.clipWithOutputHorizon=2]="clipWithOutputHorizon"})(a.fM||(a.fM={}));var b=function(){function a(){this.Jl=3;this.uz=this.yv=NaN}a.prototype.cU=function(){return this.et(1)};a.prototype.dU=function(){return this.et(2)};a.prototype.et=function(a){return 0!=(this.Jl&a)};a.prototype.Vf=function(){var b=new a;b.yv=this.yv;b.uz=this.uz;b.Jl=this.Jl;return b};return a}();a.OZ=b;(function(a){a[a.Dont_Geonomalize_Polygon=2147483648]="Dont_Geonomalize_Polygon";a[a.Dont_Adjust_At_Poles=
1073741824]="Dont_Adjust_At_Poles"})(a.gM||(a.gM={}));var c=function(){function a(){this.Jl=0}a.prototype.et=function(a){return 0!=(this.Jl&a)};a.oe=function(b){var c=new a;c.Jl=b.Jl;return c};a.prototype.FO=function(a){this.Jl=a.Jl};return a}();a.PZ=c;var d=function(){function b(b,c,e){this.je=b;this.He=c;this.rg=new a.h;this.rg.I(e);this.zV=b.jc()+c.jc()+this.rg.jc().toString()}b.prototype.jc=function(){return this.zV};b.prototype.Eb=function(a){return this==a||this.je.Eb(a.je)&&this.He.Eb(a.He)&&
this.rg.Eb(a.rg)};return b}();a.e_=d;d=function(){function e(){this.He=this.je=null;this.DI=new b;this.EI=new c;this.xr=this.ve=null;this.sr=this.Tl=!0}e.Is=function(a,b,c,d){var g;void 0===d&&(d=null);void 0===g&&(g=null);var f=new e;f.kq(a,b,c,d,g);return f};e.prototype.kq=function(b,c,e,d,f){if(null==b||null==c)throw a.g.X("invalidArgument");this.je=b;this.He=c;this.sr=this.Tl=!1;null!=d&&(this.DI=d.Vf());null!=f&&this.EI.FO(f);f=!1;1==c.Fb()&&null!=d&&(d=d.yv,isNaN(d)||0==d||(f=!0));if(b==c)this.Tl=
!f,this.sr=!0;else{d=b.Fb();var g=c.Fb();if(0==d||0==g){if(null!=e)throw a.g.F();null!=b.Vd()&&null!=c.Vd()&&(this.Tl=b.Vd().Eb(c.Vd()))}else 3==d||3==g?this.Tl=b.Eb(c):this.je.iU(this.He)?this.Tl=!f:this.Tl=!1,this.ve=e,null!=this.ve&&this.ve.Mp(),this.sr=(null==this.ve||0==this.ve.count())&&this.je.lc().Eb(this.He.lc())}this.wL()};e.prototype.Wv=function(){var a=new e;a.je=this.He;a.He=this.je;null!=this.ve&&(a.ve=this.ve.Wv());a.Tl=this.Tl;a.sr=this.sr;a.wL();return a};e.prototype.Ho=function(){return this.Tl};
e.prototype.fT=function(){return this.DI.Vf()};e.prototype.Eb=function(a){return a==this?!0:a instanceof e&&this.je.Eb(a.je)&&this.He.Eb(a.He)?this.ve==a.ve?!0:null!=this.ve&&null!=a.ve&&this.ve.Eb(a.ve)?!0:!1:!1};e.prototype.wL=function(){this.xr=new a.ko(this)};e.u_={};return e}();a.rs=d})(x||(x={}));(function(a){var b=function(){function b(){}b.uq=function(a){return a*b.pO};b.Wx=function(a,c){return b.VN(c-a)};b.cO=function(b){if(-360<=b&&720>b)return 0>b?b+=360:360<=b&&(b-=360),b;b=a.Ub.hM(b);
0>b&&(b+=360);return b};b.VN=function(a){a=b.cO(a);180<a&&(a-=360);return a};b.QZ=.0174532925199433;b.pO=57.29577951308232;return b}();a.ls=b;var c=function(){function c(){}c.Mj=function(b,c){var e=new a.h;b.s(e);var d=a.fb.Bh(c),g=new a.h;g.I(d);g.o=e.o;g.v=e.v;g.O(.01*g.fa(),0);d=a.na.be(c,e,!1);return g.contains(e)?b:a.ne.clip(b,g,d,0)};c.ht=function(b,d,f,k,h){if(!a.fb.Jc(d))throw a.g.F();var e=a.na.ah(d,b,!1),g=a.fb.Bh(d),n=a.fb.lc(d),p=n.Vd().Ai,l=a.fb.hw(n),n=a.fb.Sv(n),l=l*(2-l),m=new a.zc;
g.Sn(m);var y=[[0,0],[0,0]];2==a.Rd.Fb(d)?k?(y[0][0]=c.Nn(h,m),y[0][1]=g.Cq(),a.fb.lu(),g=y[0][0]*p):(y[0][0]=g.Gk(),y[0][1]=h,a.fb.lu(),g=y[0][1]*p):g=h*p;if(!k&&0!=g)throw a.g.F();var B=new a.ea,q=new a.fd;b=q.Jb(b);for(var r=[0],t=new a.b,u=new a.b,A=new a.b,v=new a.b,w=new a.b,x=new a.b,z=q.Pb(b);-1!=z;z=q.Sb(z)){var C=q.cb(z);q.w(C,A);for(var L=!1,D=C=q.U(C);-1!=D;D=q.U(D)){if(D==C){if(L)break;L=!0}q.w(D,v);if(k&&e<h-A.x&&v.x-h>e||e<h-v.x&&A.x-h>e||!k&&e<-A.y&&v.y>e||e<-v.y&&A.y>e){do if(!(Math.abs(A.x-
v.x)>=.5*m.N())){2==a.Rd.Fb(d)?(y[0][0]=c.Nn(A.x,m),y[0][1]=A.y,y[1][0]=c.Nn(v.x,m),y[1][1]=v.y,a.fb.VW(),w.x=y[0][0]*p,w.y=y[0][1]*p,x.x=y[1][0]*p,x.y=y[1][1]*p):(w.x=A.x*p,w.y=A.y*p,x.x=v.x*p,x.y=v.y*p);x.x=6.283185307179586*(v.x-A.x)/m.N()+w.x;if(k){if(u.x=g,u.y=c.FB(n,l,w,x,g,f),isNaN(u.y))break}else{u.x=c.DB(n,l,w,x,f);if(isNaN(u.x))break;u.y=0}a.mb.Ld(n,l,w.x,w.y,x.x,x.y,B,null,null,f);var E=B.j;a.mb.Ld(n,l,w.x,w.y,u.x,u.y,B,null,null,f);var G=B.j;2==a.Rd.Fb(d)?(y[0][0]=u.x/p,y[0][1]=u.y/p,
a.fb.US(),k?(t.y=y[0][1],t.x=h):(t.x=c.Zp(y[0][0],A.x,v.x,m),t.y=h)):k?(t.x=h,t.y=u.y/p):(t.x=c.Zp(u.x/p,A.x,v.x,m),t.y=h);r[0]=0<E?a.J.pk(G/E,0,1):.5;0!=r[0]&&1!=r[0]&&(E=q.Ra(D),q.zm(E,r,1),q.rb(q.U(E),t.x,t.y))}while(0)}A.L(v)}}return q.Se(b)};c.Xm=function(b,d,f,k,h){if(b.u())return b;var e=a.fb.ee(d);return c.Aq(b,f-180*e,360*e,d,k,h,!0)};c.FB=function(b,d,f,k,h,p){if(3.141592653589793<=Math.abs(f.x-k.x)||!c.Cj(f.x,k.x,h))return NaN;var e;f.x>k.x?e=k:(e=f,f=k);k=new a.ea(0);var g=new a.ea(0),
n=new a.ea(0);a.mb.Ld(b,d,e.x,e.y,f.x,f.y,g,k,null,p);var l=g.j,m=0,y=1,B=new a.b;for(B.L(e);l*(y-m)>1E-12*b;){var q=.5*(m+y);a.mb.Oj(b,d,e.x,e.y,l*q,k.j,g,n,p);B.x=g.j;B.y=n.j;if(B.x==h)break;if(c.Cj(e.x,B.x,h))y=q;else if(c.Cj(f.x,B.x,h))m=q;else return NaN}return B.y};c.Cj=function(a,c,d){a=b.uq(a);c=b.Wx(a,b.uq(c));d=b.Wx(a,b.uq(d));return 0==d||0<c&&0<d&&d<=c||0>c&&0>d&&d>=c?!0:!1};c.Nn=function(a,b){var c=b.ha-b.ca;return b.wu(a-Math.floor((a-b.ca)/c)*c)};c.Zp=function(b,c,d,f){var e=new a.zc;
e.I(c,d);d=f.N();b=Math.floor((b-c)/d)*d+b;for(e=e.Wf();Math.abs(b-e)>Math.abs(b+d-e);)b+=d;return b};c.DB=function(b,c,d,f,k){var e;d.y>f.y?e=f:(e=d,d=f);f=new a.zc;f.I(e.y,d.y);if(!f.contains(0)||3.141592653589793<=Math.abs(e.x-d.x))return NaN;if(e.x==d.x)return e.x;var g=new a.ea(0),n=new a.ea(0),h=new a.ea(0);a.mb.Ld(b,c,e.x,e.y,d.x,d.y,n,g,null,k);var p=n.j,l=0,m=1,y=new a.b;for(y.L(e);p*(m-l)>1E-12*b;){var B=.5*(l+m);a.mb.Oj(b,c,e.x,e.y,p*B,g.j,n,h,k);y.x=n.j;y.y=h.j;f.I(e.y,y.y);if(0==y.y)break;
if(f.contains(0))m=B;else if(f.I(d.y,y.y),f.contains(0))l=B;else return NaN}return y.x};c.Aq=function(b,c,d,f,k,h,p){var e=new a.h;b.s(e);if(e.u())return b;var g=new a.zc;e.Sn(g);var n=new a.zc;n.I(c,c+d);if(n.contains(g)&&n.ha!=g.ha)return b;var l=new a.h;l.I(e);var m=b.G();if(33==m){l=k?b:b.Vf();e=l.Be();if(e<n.ca||e>=n.ha||p&&e==n.ha)e+=Math.ceil((n.ca-e)/d)*d,e=n.wu(e),l.BC(e);return l}if(550==m){l=k?b:b.Vf();f=l.Pa(0);m=2*l.D();b=!1;for(k=0;k<m;k+=2)if(e=f.read(k),e<n.ca||e>=n.ha||p&&e==n.ha)b=
!0,e+=Math.ceil((n.ca-e)/d)*d,e=n.wu(e),f.write(k,e);b&&l.Dc(1993);return l}if(n.contains(g))return b;if(197==m)return d=k?b:b.Vf(),e.Ma(l),d.Gp(e),d;var y=.1*Math.max(e.fa(),e.N());l.O(0,y);p=b;n=f.se(0);b=a.ei.local();k=new a.Hd;for(var q=0;;){var B=Math.floor((g.ca-c)/d),r=Math.ceil((g.ha-c)/d);if(3<r-B){B=Math.floor(.5*(r+B));l.o=e.o-y;l.v=c+d*B;var t=a.ne.clip(p,l,n,h);l.o=l.v;l.v=e.v+y;var F=a.ne.clip(p,l,n,h);k.Ag((B-r)*d,0);F.Xc(k);1736==m?p=b.V(t,F,f,null):(p=t,p.add(F,!1));p.s(e);e.Sn(g);
q++}else break}l.o=c;l.v=c+d;c=new a.h;c.I(l);c.O(n,0);c=Math.floor((e.o-l.o)/d)*d;0!=c?(l.move(c,0),k.Ag(-c,0)):k.qC();c=1607==m?new a.Ua(p.description):new a.Ja(p.description);h=new a.h;for(g=new a.h;e.v>l.o;){y=a.ne.clip(p,l,n,0);y.s(g);if(1607==m?!y.u()&&(g.N()>n||g.fa()>n):!y.u()&&(1736!=m||g.N()>n))y.Xc(k),y.s(g),c.s(h),h.O(n,n),h.Yb(g)&&1736==m?c=b.V(c,y,f,null):c.add(y,!1);l.move(d,0);k.shift(-d,0)}return c};c.OJ=function(b,c,d,f,k){var e=new a.Ed(d.description);e.Id(d,0,-1);k=a.fb.Xg(e,b,
c,k);e=d.D();f.Oa();if(!a.fb.Jc(b)||e!=k.D())return!1;var g=new a.h;d.s(g);var n=new a.h;k.s(n);g=g.N();n=n.N();if(0!=g&&0!=n){if(n/=g,b=a.fb.Bh(c).N()/a.fb.Bh(b).N(),1E-10<Math.abs(n/b-1))return!1}else if(0!=g||0!=n)return!1;f.add(d,!1);for(d=0;d<e;d++)b=k.Ba(d),f.rb(d,b);return!0};c.vA=function(){throw a.g.df();};return c}();a.gi=c})(x||(x={}));(function(a){(function(a){a[a.Clip=0]="Clip";a[a.DontClip=1]="DontClip";a[a.PannableFold=2]="PannableFold"})(a.di||(a.di={}));var b=a.di;(function(a){a[a.Geodesic=
0]="Geodesic";a[a.Loxodrome=1]="Loxodrome";a[a.GreatElliptic=2]="GreatElliptic";a[a.NormalSection=3]="NormalSection";a[a.ShapePreserving=4]="ShapePreserving"})(a.mD||(a.mD={}));var c=a.mD,d=function(){function e(){}e.iw=function(b,c,e){if(e||0<c){b=b.toString(a.Vc.PE_STR_NAME_CANON|a.Vc.PE_STR_AUTH_NONE);c=[];for(e=0;e<b.length;e++)c[e]="a"<=b[e]&&"z">=b[e]?c[e]=b[e].toUpperCase():b[e];return c.join()}return b.toString(a.Vc.PE_STR_AUTH_TOP)};e.qs=function(b,c,e,d){var g=d.length,f=e.D();if(0!=f){var k=
e.Pa(0),n=Math.min(f,g),h=0,p=b.Kg();isNaN(c)&&(c=0);var l=b.Jc();b=l?b.lc().re().N():0;for(var m=179*b/360;0<f;){k.Hx(h<<1,n,d,0,!0);a.fi.projToGeogCenter(p,n,d,c);if(l)for(var y=0;y<n;y++){var q=d[y][0]-c,B=a.Ub.sign(q),r=k.read(2*(h+y));0>B*a.Ub.sign(r)&&Math.abs(q)>m&&(d[y][0]+=-B*b)}k.hy(h<<1,n,d,0,!0);h+=n;f-=n;n=Math.min(f,g)}e.Dc(1993)}};e.J_=function(b,c,e,d){var g=b.Kg();isNaN(c)&&(c=0);var f=e.Be();d[0][0]=f;d[0][1]=e.nf();a.fi.projToGeogCenter(g,1,d,c);b.Jc()&&(c=a.Ub.sign(d[0][0]-c),
0>c*a.Ub.sign(f)&&(b=b.lc().re().N(),Math.abs(d[0][0])>179*b/360&&(d[0][0]-=c*b)));e.rb(d[0][0],d[0][1])};e.xN=function(b,c,e,d){var g=0,f=b.Kg();isNaN(g)&&(g=0);var k=b.Jc(),n=b.ee();b=360*n;for(var n=179*n,h=d.length,p=0;p<e;){for(var l=p;l<e&&c[l].isNaN();++l)p++;var m=Math.min(h,e-p);if(0<m){for(var l=1,y=p+1;l<m;++l,++y)if(c[y].isNaN()){m=l;break}a.na.oz(d,c,p,m);a.fi.projToGeogCenter(f,m,d,g);if(k)for(l=0,y=p;l<m;++l,++y){var q=c[y].x,B=d[l][0]-g,r=a.Ub.sign(B);0>r*a.Ub.sign(q)&&Math.abs(B)>
n&&(d[l][0]-=r*b)}a.na.nz(c,p,d,m);p+=m}}};e.vy=function(b,c,e){var d=e.length,g=c.D();if(!(1>g)){var f=c.Pa(0),k=Math.min(g,d),n=0,h=b.Kg(),p=b.Jc(),l=p?b.re().N():0,m=179*l/360,y=0;for(p&&(y=b.pi());0<g;){f.Hx(n<<1,k,e,0,!0);a.fi.geogToProj(h,k,e);if(p)for(b=0;b<k;b++){var q=e[b][0],r=a.Ub.sign(q),t=f.read(2*(n+b))-y;0>r*a.Ub.sign(t)&&Math.abs(q)>m&&(e[b][0]+=-r*l)}f.hy(n<<1,k,e,0,!0);n+=k;g-=k;k=Math.min(g,d)}c.Dc(1993)}};e.B_=function(b,c,e){if(!c.u()){var d=b.Kg();e[0][0]=c.Be();e[0][1]=c.nf();
a.fi.geogToProj(d,1,e);if(b.Jc()){var d=a.Ub.sign(e[0][0]),g=b.pi();0>d*a.Ub.sign(c.Be()-g)&&(b=b.re().N(),Math.abs(e[0][0])>179*b/360&&(e[0][0]-=d*b))}c.rb(e[0][0],e[0][1])}};e.wN=function(b,c,e,d){if(0!=e){var g=b.Kg(),f=b.Jc(),k=f?b.re().N():0,n=179*k/360,h=0;f&&(h=b.pi());for(b=0;b<e;){for(var p=b;p<e&&c[p].isNaN();++p)b++;var l=Math.min(d.length,e-b);if(0<l){for(var p=1,m=b+1;p<l;++p,++m)if(c[m].isNaN()){l=p;break}a.na.oz(d,c,b,l);a.fi.geogToProj(g,l,d);if(f)for(p=0,m=b;p<l;p++){var y=d[p][0],
q=a.Ub.sign(y);0>q*a.Ub.sign(c[m].x-h)&&Math.abs(y)>n&&(d[p][0]-=q*k)}a.na.nz(c,b,d,l);b+=l}}}};e.ps=function(b,c,e,d){var g=c.D();if(0!=g){var f=c.Pa(0),k=b.je,n=b.He,h=k.lc().Yi(),p=n.lc().Yi(),l=k.ee(),m=n.ee();b=b.ve;if(null==b||0==b.count()){e=h/p;d=(k.dn()-n.dn())*m;p=-90*l;b=90*l;h=!1;m=1;for(k=2*g;m<k;)l=f.get(m),n=a.J.pk(l,p,b),n!=l&&(f.set(m,n),h=!0),m+=2;if(0!=d||1!=e)for(h=!0,p=new a.b,m=0;m<g;m++)f.fc(2*m,p),p.x*=e,p.x+=d,p.y*=e,f.fo(2*m,p);h&&c.Dc(1993)}else{var k=d.length,n=Math.min(g,
k),y=a.J.gf(n),q=null,B=0,r=NaN,t=NaN,u=360*m,A=m/l;e&&(t=90*m,r=89.9*l,q=a.J.gf(n));for(var v=!0,w=0;0!=g;){l=!1;f.Hx(B<<1,n,d,0,!0);for(m=0;m<n;m++)y[m]=d[m][0];if(e)for(m=0;m<n;m++){var x=Math.abs(d[m][1])-r;0<x&&(l=d[m][1],d[m][1]=a.Ub.Fl(r,l),q[m]=a.Ub.Fl(x,l),l=!0)}m=d[0][0];b.transform(d,n,h,p);v&&(w=d[0][0]-A*m,v=!1);for(m=0;m<n;m++)x=d[m][0]-y[m]*A-w,200<Math.abs(x)&&(d[m][0]=0<x?d[m][0]-u:d[m][0]+u);if(l){for(m=0;m<n;m++)0!=q[m]&&(d[m][1]+=A*q[m],d[m][1]>t?d[m][1]=t:d[m][1]<-t&&(d[m][1]=
-t));for(l=0;l<n;l++)q[l]=0}f.hy(B<<1,n,d,0,!0);B+=n;g-=n;n=Math.min(g,k)}c.Dc(1993)}}};e.A_=function(b,c,e,d){if(c.u())return!1;var g=b.je,f=b.He,k=b.ve,n=g.lc().Yi(),h=f.lc().Yi();d[0][0]=c.Be();d[0][1]=c.nf();if(null!=k&&0<k.count()){b=!0;var p=!1,l=NaN,m=0,y=1;e&&(e=g.ee(),l=f.ee(),y=l/e,l*=90,g=89.9*e,f=Math.abs(d[0][1])-g,0<f&&(p=d[0][1],d[0][1]=a.Ub.Fl(g,p),m=a.Ub.Fl(f,p),p=!0));k.transform(d,1,n,h);p&&0!=m&&(d[0][1]+=y*m,d[0][1]>l?d[0][1]=l:d[0][1]<-l&&(d[0][1]=-l));c.rb(d[0][0],d[0][1])}else{e=
g.ee();b=a.J.pk(d[0][1],-90*e,90*e)!=d[0][1];l=f.ee();k=(g.dn()-f.dn())*l;n/=h;if(1!=n||0!=k)b=!0,d[0][0]*=n,d[0][0]+=k,d[0][1]*=n;b&&c.rb(d[0][0],d[0][1])}return b};e.vN=function(b,c,e,d){var g;if(b.sr)d=90*b.je.ee(),a.na.VK(c,e,-d,d);else{var f=b.ve,k=b.je,n=b.He;b=k.Xs();var h=n.Xs(),p=k.ee(),l=90*p,m=n.ee();if(null==f||0==f.count()){if(d=b/h,f=(k.dn()-n.dn())*m,a.na.VK(c,e,-l,l),0!=f||1!=d)for(m=0;m<e;m++)c[m].x*=d,c[m].x+=f,c[m].y*=d}else for(var k=Math.min(e,d.length),l=a.J.gf(k),n=360*m,p=
m/p,y=!0,q=0,B=0;0!=e;){for(m=0;m<k;m++)l[m]=c[m+B].x;m=c[0].x;a.na.oz(d,c,B,k);f.transform(d,k,b,h);a.na.nz(c,B,d,k);y&&(q=c[0].x-p*m,y=!1);for(m=0;m<k;m++)g=c[B+m].x-l[m]*p-q,200<Math.abs(g)&&(c[B+m].x=0<g?c[B+m].x-n:c[B+m].x+n);B+=k;e-=k;k=Math.min(e,d.length)}}};e.ZZ=function(a,b,c,d){return e.Xm(a,b,isNaN(c)?0:c,!0,d,null)};e.Vu=function(a,b){a=a.Bh();isNaN(b)||a.xv(b,0);return a};e.LS=function(b,c,d,f,k,h,p,l){for(var g=e.Vu(f,k),n=g.N(),m=n/360,y=e.lE*m,q=b.Pa(0),B=c.Jc(),r=B?n/c.re().N():
0,t=!1,F=new a.Ja(d.description),u=0,A=d.aa();u<A;++u){var H=B,v=new a.Ua(d.description);v.Ti(d,u,!0);if(0!=p){var w=e.bE(!0,v,g.B-l,g.B,p);(t=t||w)&&(H=!1)}var x=-1;H&&(x=b.wa(u));var M=v.Pa(0),z=v.D(),C=0,L=M.read(0),D=0,w=3*f.se(0),X=!1,E=new a.b;E.$c();var G=new a.b;G.$c();for(var I=!1,J=1;J<z;++J){var K=a.b.pa(M.Of(2*J),M.Of(2*J+1)),R=K.x,S=R+C,N=S-L;K.x=S;if(Math.abs(N)>y){if(H){var P=x+(J+1<z?J:0),Q=q.read(2*(x+J-1)),P=(q.read(2*P)-Q)*r;Math.abs(N-P)>1*m&&(H=!1)}H||(C-=a.Ub.Fl(n,S-L),S=R+C,
++D,I=0!=C,K.x=S)}else X||a.na.NH(G,E,K,w)&&(X=!0);I&&M.write(2*J,S);L=S;G.L(E);E.L(K)}0<D&&v.Dc(1993);H=v.Ba(0);z=v.Ba(z-1);v=a.b.Cb(H,z)<w?e.UR(v,f,k,h,X):e.hS(b,u,v,f,k);F.add(v,!1)}k=f.se(0);d=g.N()/180;e.xu(F,g,.1*k,!1);k=a.uh.clip(F,g,k,d,h);F=F!=k;b=b.hf();l=k.hf();p=0;0<l&&0>b?p=1:0>=l&&0<b&&(0==l?(l=NaN,2==c.Fb()?l=c.Lk().hf():1==c.Fb()&&(l=c.re().IG()),b>.99*l&&(p=-1)):p=-1);0!=p&&(c=new a.Ja(k.description),c.oq(g),c=a.Jm.local().V(c,d,h),c.add(k,!1),F=!0,k=c);F&&(k=a.Km.local().V(k,f,!1,
h));return k};e.hS=function(b,c,d,f,k){var g=d.D(),n=d.Ba(0),h=d.Ba(g-1);f=e.Vu(f,k);k=f.N();var n=a.Ub.sign(h.x-n.x),p=new a.h;d.ac(p);var l=f.Gk(),m,h=l-k,l=l+k;if(0<=n){for(var y=Math.ceil((h-p.o)/k),y=y*k;h>p.o+y;)y+=k;for(;h<p.v+y;)y-=k;m=y;720<p.N()&&(l=h+360*Math.ceil(p.N()/360))}else{y=Math.ceil((l-p.v)/k);for(y*=k;l<p.v+y;)y-=k;for(;l>p.o+y;)y+=k;m=y;720<p.N()&&(h=l-360*Math.ceil(p.N()/360))}var y=n*k,q=a.h.pa(p.o,p.A,p.v,p.B);q.move(m,0);var B=new a.Hd;B.Ag(m,0);d.Xc(B);p=new a.Ua(d.description);
p.add(d,!1);m=d.Ba(g-1);k=0;for(var r=p.Ba(0).x,t=0;0<n?q.v<l:q.o>h;)1024<=t&&(t=0),q.move(y,0),B.Wb=y,d.Xc(B),r+=y,f.o<=r&&f.v>=r&&(k=p.D()-1),d.rb(0,m),m=d.Ba(g-1),p.Bs(d,0,0,g-1,!1);d=new a.Ja(p.description);g=0<b.Sm(c);d.add(p,!1);b=p.Ba(0);h=p.Ba(p.D()-1);c=d.aa()-1;(0>n?g:!g)?(n=a.b.pa(h.x,f.B),d.aj(n),n=a.b.pa(f.Gk(),f.B),d.aj(n),f=a.b.pa(b.x,f.B)):(n=a.b.pa(h.x,f.A),d.aj(n),n=a.b.pa(f.Gk(),f.A),d.aj(n),f=a.b.pa(b.x,f.A));d.aj(f);d.KH(0,c,0);d.oQ(k);return d};e.UR=function(b,c,d,f,k){var g=
new a.Ja(b.description);g.add(b,!1);g.dC(0,g.D()-1);var n=new a.h;g.ac(n);d=e.Vu(c,d);for(var h=d.N(),p=Math.ceil((d.o-n.o)/h),p=p*h;d.o>n.o+p;)p+=h;for(;d.o<n.v+p;)p-=h;p+=h;if(0!=p){n.move(p,0);var l=new a.Hd;l.Ag(p,0);g.Xc(l)}if(d.o<=n.o&&d.v>n.v)return k&&(k=g.hf(),g=a.Km.local().V(g,c,!0,f),c=g.hf(),(c=a.Ub.sign(k)!=a.Ub.sign(c))&&g.eK()),g;b=new a.Ja(b.description);b.add(g,!1);for(k=k||n.N()>h-c.se(0);n.o<d.v;)n.move(h,0),l=new a.Hd,l.Ag(h,0),g.Xc(l),b.add(g,!1);k&&(k=b.hf(),b.Hp(1),b=a.Km.local().V(b,
c,!0,f),c=b.hf(),(c=a.Ub.sign(k)!=a.Ub.sign(c))&&b.eK());return b};e.bE=function(b,c,e,d,f){for(var g=c.Pa(0),k=c.D(),n=!1,h=0;h<k;h++){var p=a.b.pa(g.Of(2*h),g.Of(2*h+1));if(0!=(f&1)&&p.y>=e){n=!0;break}if(0!=(f&2)&&p.y<=-e){n=!0;break}}if(!n)return!1;g=!1;b&&(g=c.Eo(0));b=new a.fd;var k=b.Jb(c),n=b.Pb(k),l=-1,m=!0,y=new a.b;y.$c();for(var h=new a.Wa,q=-1,B=b.cb(n);-1!=B;B=b.U(B)){var p=b.Ba(B),r=0!=(f&1)&&90<=p.y?1:0,r=r|(0!=(f&2)&&p.y<=-e?2:0);if(0<l&&l!=r){if(y.x!=p.x){y.x=p.x;b.wj(b.Ra(B),h);
var t=b.Wj(n,B,h);b.Qf(t,y)}if(g)for(q=-1!=q?b.U(q):b.cb(n),t=b.Ra(B);q!=t;)q=b.ud(q,!1);q=-1}0<r&&(p.y=a.Ub.Fl(d,p.y),b.Qf(B,p),m||l==r||(p.x!=y.x?(b.wj(B,h),t=b.Wj(n,B,h),b.rb(t,y.x,p.y),q=t):q=B));l=r;y=p;m=!1}if(g){if(-1!=q)for(q=b.U(q);-1!=q;)q=b.ud(q,!1);e=b.cb(n);b.Uq(e,b.Rj(n))||(b.wj(e,h),b.Wj(n,-1,h))}b.Se(k).copyTo(c);return!0};e.zZ=function(a,b){var c=0,e=a.La(b);b+=1;for(var d=a.aa();b<d&&!(0<a.Sm(b));++b)c++;return 64<e&&3<=c};e.uA=function(c,d,f,k){var g=c;if(g.u()||f==b.DontClip)return g;
var n=g.G();if(33==n)return k=g,g=[k.w()],e.LH(g,1,d,f),g[0].isNaN()?k.Oa():k.rb(g[0]),c;c=d.lc();var h=c.ee(),p=90*h,l=180*h,m=360*h,y=d.pi(),q=.5*h,B=new a.h;g.s(B);var r=d.Vs(),t=d.ES(),u=197==r.G();d=new a.h;r.s(d);f==b.PannableFold&&(f=c.re().N(),d.o=y-.5*f,d.v=d.o+f);if(B.A<-p||B.B>p){(new a.h).I(B.o-h,-p,B.v+h,p);g=a.uh.rq(g,d,c,NaN,0,k);if(g.u())return g;g.s(B)}if(t&&(d.B<B.A||d.A>B.B))return g.Ka();B.N()>m&&(g=e.Aq(g,y-l,m,c,!0,0,!0,k),g.s(B));p=e.DN(B.o,B.v,d.o,d.v,m);0!=p&&B.move(p,0);
if(B.v>d.v||B.o<d.o){if(B.v>d.v)for(;B.o>=d.v;)B.move(-m,0),p-=m;for(;B.o<d.v-m;)B.move(m,0),p+=m}f=a.na.vv(c,r);0!=p&&(h=new a.Hd,h.Ag(p,0),g.Xc(h));if(t){if(u&&d.contains(B))return g;t=[null,null];for(p=0;2>p;p++){u?h=a.T.Ic(n)?a.uh.clip(g,d,f,q,k):a.uh.clip(g,d,f,0,k):(h=a.tk.local().V(g,r,c,k),h==r&&(h=a.T.oe(h)));if(d.o<=B.o&&d.v>=B.v||d.o>=B.o&&d.v<=B.v)return h;t[p]=h;0==p&&(B.move(-m,0),h=new a.Hd,h.Ag(-m,0),g.Xc(h))}if(550==n)t[0].Id(t[1],0,-1);else if(a.T.Ic(n))t[0].add(t[1],!1);else if(33==
n)t[0].u()&&(t[0]=t[1]);else throw a.g.X("intersect_with_GCS_horizon: unexpected geometry type");return t[0]}if(d.B<B.A||d.A>B.B)return g;for(n=0;!g.u()&&B.v>d.o;)0!=n&&(h=new a.Hd,h.Ag(n,0),g.Xc(h)),a.Gj.local().V(4,g,r,c,k)||(g=a.cq.local().V(g,r,c,k),r==g&&(g=a.T.oe(g))),0!=n&&(q=new a.Hd,q.Ag(-n,0),g.Xc(q)),n-=m,B.move(-m,0);return g};e.LH=function(c,d,f,k){if(0!=d&&k!=b.DontClip)if(k==b.PannableFold){k=f.BT();for(var g=d,n=0;n<d;n++)if(c[n].y>k.B||c[n].y<k.A)c[n].$c(),g--;0!=g&&e.Uu(c,d,k.o,
k.N())}else{k=f.ee();var h=90*k,p=180*k;k*=360;g=d;for(n=0;n<d;n++)if(c[n].y>h||c[n].y<-h)c[n].$c(),g--;if(0!=g){g=new a.h;g.Mx(c,d);var h=f.Vs(),l=f.Uv(),n=197==h.G(),m=new a.h;h.s(m);if(!l||!(m.B<g.A||m.A>g.B))if(l)if(e.Uu(c,d,m.Gk()-p,k),g=d,n)for(n=0;n<d;n++)m.contains(c[n])||(c[n].$c(),g--);else for(f=a.na.vv(f.lc(),h),n=0;n<d;n++)(p=0!=a.gd.ge(h,c[n],f))||(c[n].$c(),g--);else for(e.Uu(c,d,-p,k),g=d,f=a.na.vv(f.lc(),h),n=0;n<d;n++)if(p=c[n],p.isNaN()&&g--,l=e.qE(p.x,m.o,m.v,k),p.x+=l,p=0!=a.gd.ge(h,
p,f))c[n].$c(),g--}}};e.b_=function(b,c,e){if(0<=c&&!b.Qb(c))return 0;var d=0;if(1==e.Fb())return c=90*e.ee(),c-=2*c/Math.PI*a.Vc.PE_HORIZON_DELTA,e=new a.h,b.s(e),e.B>=c&&(d=1),e.A<=-c&&(d|=2),d;var g=e.Sj();if(null==g)return 0;var f=null;0<=c&&(f=b);for(var k=0;2>k;k++)if((0<k?g.getSouthPoleLocation():g.getNorthPoleLocation())!=a.Bg.PE_POLE_OUTSIDE_BOUNDARY){var n=e.eA(0<k);n.isNaN()||(n=0>c?a.ff.yA(b,n,0):a.ff.zA(f,c,n,0,null),d|=n<<k)}return d};e.Aq=function(b,c,e,d,f,k,h,p){var g=b.G(),n=c+e;
if(33===g){d=f?b:b.Vf();var l=d.Be();if(l<c||l>=n||h&&l==n)l+=Math.ceil((c-l)/e)*e,l=a.J.pk(l,c,n),d.BC(l);return d}if(b.u())return b;l=new a.h;b.s(l);if(l.u())return b;var m=new a.zc;l.Sn(m);var y=new a.zc;y.I(c,n);if(y.contains(m))return b;n=new a.h;n.I(l);if(550===g){d=f?b:b.Vf();p=d.Pa(0);g=2*d.D();n=!1;for(c=0;c<g;c+=2)if(l=p.read(c),l<y.ca||l>=y.ha||h&&l==y.ha)n=!0,l+=Math.ceil((y.ca-l)/e)*e,l=y.wu(l),p.write(c,l);n&&d.Dc(1993);return d}if(197==g)return e=f?b:b.Vf(),l.Ma(n),e.Gp(l),e;var q=
.1*Math.max(l.fa(),l.N());n.O(0,q);h=b;y=d.se(0);b=a.ei.local();for(f=new a.Hd;;){var B=Math.floor((m.ca-c)/e),r=Math.ceil((m.ha-c)/e);if(3<r-B){B=Math.floor(.5*(r+B));n.o=l.o-q;n.v=c+e*B;var t=a.uh.clip(h,n,y,k,p);n.o=n.v;n.v=l.v+q;var F=a.uh.clip(h,n,y,k,p);f.Ag((B-r)*e,0);F.Xc(f);1736==g?h=b.V(t,F,d,null):(h=t,h.add(F,!1));h.s(l);l.Sn(m)}else break}n.o=c;n.v=c+e;c=new a.h;c.I(n);c.O(y,0);c=Math.floor((l.o-n.o)/e)*e;0!=c?(n.move(c,0),f.Ag(-c,0)):f.qC();c=1607==g?new a.Ua(h.description):new a.Ja(h.description);
k=new a.h;for(m=new a.h;l.v>n.o;){q=a.uh.clip(h,n,y,0,p);q.s(m);if(1607==g?!q.u()&&(m.N()>y||m.fa()>y):!q.u()&&(1736!=g||m.N()>y))q.Xc(f),q.s(m),c.s(k),k.O(y,y),k.Yb(m)&&1736==g?c=b.V(c,q,d,null):c.add(q,!1);n.move(e,0);f.shift(-e,0)}return c};e.Uu=function(b,c,e,d){for(var g=e+d,f=0;f<c;f++){var k=b[f].x;e<=k&&k<g||!(k<e||k>g||k==g)||(k+=Math.ceil((e-k)/d)*d,k=a.J.pk(k,e,g),b[f].x=k)}};e.Xm=function(b,c,d,f,k,h){if(!c.Jc())throw a.g.X("fold_into_360_degree_range");if(b.u())return b;var g;if(2==c.Fb())d=
c.bw(),g=c.aw()-d;else{var n=c.ee();g=360*n;d-=180*n}return e.Aq(b,d,g,c,f,k,!0,h)};e.BG=function(a,b,c,d){if(2==c.Fb())d=c.bw(),c=c.aw()-d;else{var g=c.ee();c=360*g;d-=180*g}e.Uu(a,b,d,c)};e.Mj=function(b,c){var e=c.re();if(33==b.G()){var d=b.nf();return e.A<=d&&d<=e.B?b:b.Ka()}d=new a.h;b.s(d);var g=new a.h;g.I(e);g.o=d.o;g.v=d.v;g.O(.01*g.fa(),0);e=a.na.$y(c,d);return g.contains(d)?b:a.uh.clip(b,g,e,0,null)};e.Im=function(a,b,c){return a>b.v&&a-b.v<c?b.v:a<b.o&&b.o-a<c?b.o:a};e.AY=function(a,b,
c,d){d.x=e.Im(a.x,b,c);d.y=a.y};e.zY=function(a,b,c,d){for(var g=0;g<b;g++)a[g].y<c.A||a[g].y>c.B?a[g].$c():a[g].x=e.Im(a[g].x,c,d)};e.xu=function(b,c,d,f){if(!b.u()){var g=b.G();if(!f||1736!=g)if(a.T.gh(g)){f=b.Pa(0);for(var g=0,k=b.D();g<k;g++){var n=f.read(2*g),h=e.Im(n,c,d);h!=n&&f.write(2*g,h)}b.Dc(1993)}else if(197==g)f=new a.h,b.s(f),f.o=e.Im(f.o,c,d),f.v=e.Im(f.v,c,d),b.Gp(f);else if(33==g)b.BC(e.Im(b.Be(),c,d));else throw a.g.X("internal error");}};e.qU=function(b,c,d,f){var g=new a.fd,k=
g.Jb(b);b=a.na.vv(c,b);e.ht(g,k,c,b,d,!0,f);return g.Se(k)};e.ht=function(b,d,f,k,h,p,l){if(!f.Jc())throw a.g.F("invalid call");var g=f.re(),n=f.lc(),m=n.Kg().getDatum().getSpheroid(),n=n.Vd().Ai,y=m.getFlattening(),m=m.getAxis(),y=y*(2-y),q=new a.zc;g.Sn(q);var r=null,B=[[0,0],[0,0]];2==f.Fb()?(r=f.Kg(),p?(B[0][0]=e.Nn(l,q),B[0][1]=g.Cq(),a.fi.projToGeog(r,1,B),g=B[0][0]*n):(B[0][0]=g.Gk(),B[0][1]=l,a.fi.projToGeog(r,1,B),g=B[0][1]*n)):g=l*n;if(!p&&0!=g&&h!=c.GreatElliptic)throw a.g.X("invalid argument");
var t=new a.ea,F=[0],u=new a.b,A=new a.b,v=new a.b,H=[null,null],w=new a.b,x=new a.b,M=new a.b,z=new a.b;for(d=b.Pb(d);-1!=d;d=b.Sb(d)){var C=b.cb(d);b.w(C,w);for(var L=!1,D=C=b.U(C);-1!=D;D=b.U(D)){if(D==C){if(L)break;L=!0}b.w(D,x);if(p&&(k<l-w.x&&x.x-l>k||k<l-x.x&&w.x-l>k)||!p&&(0!=l||k<-w.y&&x.y>k||k<-x.y&&w.y>k)){do if(!(Math.abs(w.x-x.x)>=.5*q.N())){2==f.Fb()?(B[0][0]=e.Nn(w.x,q),B[0][1]=w.y,B[1][0]=e.Nn(x.x,q),B[1][1]=x.y,a.fi.projToGeogCenter(r,2,B,0),M.x=B[0][0]*n,M.y=B[0][1]*n,z.y=B[1][1]*
n):(M.x=w.x*n,M.y=w.y*n,z.y=x.y*n);z.x=2*(x.x-w.x)*Math.PI/q.N()+M.x;var E;if(p){A.x=g;A.y=e.FB(m,y,M,z,g,h);if(isNaN(A.y))break;H[0]=A;E=1}else if(h==c.GreatElliptic){var G=[0,0];E=a.yy.vA(m,y,M,z,g,G);if(0==E)break;A.x=G[0];A.y=g;H[0]=A;2==E&&(v.x=G[1],v.y=g,H[1]=v)}else{A.x=e.DB(m,y,M,z,h);if(isNaN(A.x))break;A.y=0;H[0]=A;E=1}for(var I=-1,G=0;G<E;G++){a.mb.Ld(m,y,M.x,M.y,z.x,z.y,t,null,null,h);var J=t.j;a.mb.Ld(m,y,M.x,M.y,H[G].x,H[G].y,t,null,null,h);var K=t.j;2==f.Fb()?(B[0][0]=H[G].x/n,B[0][1]=
H[G].y/n,a.fi.geogToProj(r,1,B),p?(u.y=B[0][1],u.x=l):(u.x=e.Zp(B[0][0],w.x,x.x,q),u.y=l)):p?(u.x=l,u.y=H[G].y/n):(u.x=e.Zp(H[G].x/n,w.x,x.x,q),u.y=l);F[0]=0<J?a.J.pk(K/J,0,1):.5;if(0==F[0]||1==F[0])break;I>F[0]||(I=b.Ra(D),b.zm(I,F,1),b.rb(b.U(I),u.x,u.y),I=F[0])}}while(0)}w.L(x)}}};e.Nn=function(a,b){var c=b.ha-b.ca;return b.wu(a-Math.floor((a-b.ca)/c)*c)};e.Zp=function(b,c,e,d){var g=new a.zc;g.I(c,e);e=d.N();b=Math.floor((b-c)/e)*e+b;for(g=g.Wf();Math.abs(b-g)>Math.abs(b+e-g);)b+=e;return b};
e.Cj=function(b,c,e){b=a.ls.uq(b);c=a.ls.Wx(b,a.ls.uq(c));e=a.ls.Wx(b,a.ls.uq(e));return 0==e||0<c&&0<e&&e<=c||0>c&&0>e&&e>=c?!0:!1};e.FB=function(b,d,f,k,h,p){if(p==c.GreatElliptic)return a.yy.NU(d,f,k,h);if(Math.abs(f.x-k.x)>=Math.PI||!e.Cj(f.x,k.x,h))return NaN;var g;f.x>k.x?g=k:(g=f,f=k);k=new a.ea;var n=new a.ea,l=new a.ea;a.mb.Ld(b,d,g.x,g.y,f.x,f.y,n,k,null,p);var m=n.j,y=0,q=1,r=new a.b;for(r.L(g);m*(q-y)>1E-12*b;){var B=.5*(y+q);a.mb.Oj(b,d,g.x,g.y,m*B,k.j,n,l,p);r.x=n.j;r.y=l.j;if(r.x==
h)break;if(e.Cj(g.x,r.x,h))q=B;else if(e.Cj(f.x,r.x,h))y=B;else return NaN}return r.y};e.DB=function(b,e,d,f,k){if(k==c.GreatElliptic)return k=[0,0],a.yy.vA(b,e,d,f,0,k),k[0];var g;d.y>f.y?g=f:(g=d,d=f);f=new a.zc;f.I(g.y,d.y);if(!f.contains(0)||Math.abs(g.x-d.x)>=Math.PI)return NaN;if(g.x==d.x)return g.x;var n=new a.ea,h=new a.ea,p=new a.ea;a.mb.Ld(b,e,g.x,g.y,d.x,d.y,h,n,null,k);var l=h.j,m=0,y=1,q=new a.b;for(q.L(g);l*(y-m)>1E-12*b;){var r=.5*(m+y);a.mb.Oj(b,e,g.x,g.y,l*r,n.j,h,p,k);q.x=h.j;q.y=
p.j;f.I(g.y,q.y);if(0==q.y)break;if(f.contains(0))y=r;else if(f.I(d.y,q.y),f.contains(0))m=r;else return NaN}return q.x};e.x_=function(b,c,e,d,f,k){if(c==f&&e!=k)throw a.g.F();if(0>=d)return 0;if(b.Ho()){k*=2;var g=2*e;b=2*d;for(e=0;e<b;e++)f[k+e]=c[g+e];return d}if(2>=d){k=[new a.b,new a.b];for(g=0;g<d;g++)k[g].ka(c[2*g],c[2*g+1]);c=a.os.local().XY(b,k,d,k);for(g=0;g<d;g++)f[2*g]=k[g].x,f[2*g+1]=k[g].y;return c}var n=b.je,g=b.He,h=n.Fb(),p=g.Fb();if(0==h&&h==p)return b=n.Yi(),g=g.Yi(),g=b/g,b=new a.Hd,
b.Op(g,g),b.YY(c,e,f,k,d),d;h=new a.Ed;h.Td(3);h.resize(d);for(var p=h.Pa(0),l=h.Pa(3),g=0,m=2*e,y=2*k;g<d;g++,y+=2){e=c[m++];var n=c[m++],q=y;if(isNaN(e)||isNaN(n))n=e=0,q=-1;l.write(g,q);p.write(2*g,e);p.write(2*g+1,n)}h.Dc(1993);c=a.os.local().V(h,b,null);g=0;for(k*=2;g<d;g++,k+=2)f[k]=NaN,f[k+1]=NaN;if(c.u())return 0;k=c.Pa(3);b=c.Pa(0);g=h=0;for(d=c.D();g<d;g++)c=k.read(g),-1!=c&&(e=b.read(2*g),n=b.read(2*g+1),f[c]=e,f[c+1]=n,h++);return h};e.OJ=function(b,c,e,d){if(!b.je.Jc())return!1;var g=
new a.Ed(c.description);g.Id(c,0,-1);d=a.os.local().V(g,b,d);g=c.D();e.Oa();if(g!=d.D())return!1;var f=new a.h;c.s(f);var k=new a.h;d.s(k);f=f.N();k=k.N();if(0!=f&&0!=k){if(k/=f,b=b.He.Bh().N()/b.je.Bh().N(),1E-10<Math.abs(k/b-1))return!1}else if(0!=f||0!=k)return!1;e.add(c,!1);c=new a.b;for(b=0;b<g;b++)d.w(b,c),e.rb(b,c);return!0};e.rP=function(a,b){a%=360*b;a>=180*b&&(a-=360*b);return a};e.MJ=function(c,d,f,k){if(f==b.Clip){var g=d.Lk();197==g.G()?(f=new a.h,g.s(f),g=a.na.$y(d,f),c=a.uh.clip(c,
f,g,5E4*d.bn(),k)):a.Gj.local().V(1,g,c,d,k)||(c=a.tk.local().V(c,g,d,k),c==g&&(c=a.wl.oe(c)))}else d.Jc()&&(k=new a.h,c.ac(k),d.re().contains(k)||(e.xu(c,d.re(),d.se(0),!0),f==b.PannableFold&&(c=e.Mj(c,d)),c=e.Xm(c,d,0,!0,1E5*d.bn(),null)));return c};e.kF=function(b,c,e){var d=c.Ws();if(null==d)return b;c=c.lc();var g=c.re().N(),f=new a.h;b.ac(f);var k=new a.zc;f.Sn(k);for(var f=d.Fa(),d=null,n=new a.Hd;f.Ya();)for(;f.Ea();){var h=f.ba(),p=h.xf(0,0),l=new a.zc;l.I(p.ca,p.ha);for(p=0;l.ha>k.ca;)l.move(-g),
--p;for(;l.ca<=k.ha;){if(l.Yb(k)){null==d&&(d=new a.Ua);var m=a.Hb.gR(h.ec(),h.Bc());0!=p&&(n.Ag(p*g,0),m.Xc(n));d.dc(m,!0)}l.move(g);++p}}return null!=d?(c=a.na.hQ(c,d),c=a.na.Cs(c),a.Ku.lR(b,d,c,e)):b};e.DN=function(a,b,c,d,f){return a>=c&&b<=d?0:e.qE(.5*(b+a),c,d,f)};e.qE=function(b,c,e,d){return a.Ub.round((.5*(e+c)-b)/d)*d};e.MS=function(b,c,d,f,k,h,p,l){var g=e.Vu(f,k),n=g.N(),m=n/360,y=e.lE*m,q=b.Pa(0),r=c.Jc(),B=r?n/c.re().N():0,t;c=b.Ka();for(var u=0,F=d.aa();u<F;++u){var A=r,v=new a.Ua(d.description);
v.Ti(d,u,!0);t=d.Qb(u);0!=p&&(t=e.bE(t,v,g.B-l,g.B,p))&&(A=!1);var w=-1;t=v.D();var x=!1;A&&(w=b.wa(u),x=b.Qb(u));var H=v.Pa(0),z=0,M=H.read(0),C=0,L=3*f.se(0),D=!1,E=new a.b;E.$c();var X=new a.b;X.$c();for(var G=!1,I=1;I<t;++I){var J=a.b.pa(H.Of(2*I),H.Of(2*I+1)),K=J.x,R=K+z,S=R-M;J.x=R;if(Math.abs(S)>y){if(A){var N=w+I-1,P=w;if(!x||I+1<t)P+=I;N=q.read(2*N);P=(q.read(2*P)-N)*B;Math.abs(S-P)>1*m&&(r=!1)}A||(z-=a.Ub.Fl(n,R-M),R=K+z,++C,G=0!=z,J.x=R)}else D||a.na.NH(E,X,J,L)&&(D=!0);G&&H.write(2*I,
R);M=R;E.L(X);X.L(J)}0!=C&&v.Dc(1993);A=v.Ba(0);t=v.Ba(t-1);a.b.Cb(A,t);v=e.FS(v,f,isNaN(k)?0:k,h);c.add(v,!1)}b=f.se(0);d=g.N()/180;e.xu(c,g,.1*b,!1);return a.uh.clip(c,g,b,d,h)};e.FS=function(a,b,c,d){return e.Xm(a,b,c,!0,0,d)};e.KU=function(b,c,e,d){var g=b.G();if(1736==g)for(c=null!=c?c.se(0):0,g=0;g<d;g++)1!=a.gd.ge(b,e[g],c)&&e[g].$c();else if(197==g)for(g=0;g<d;g++)b.hR(e[g])||e[g].$c();else throw a.g.F();};e.Dl=function(b,c,e,d){if(32>e)for(var g=new a.Wa,f=0;f<e;f++)g.rb(c[f]),b.Dl(g,d).w(c[f]);
else{var k=new a.Ed;k.Td(3);k.ZE(c,e);g=k.Pa(3);for(f=0;f<e;f++)g.write(f,f);f=b.Dl(k,d);b=f.Pa(0);g=f.Pa(3);d=a.b.pa(NaN,NaN);for(k=0;k<e;k++)c[k]=d;e=f.D();for(f=0;f<e;f++)d=g.read(f),b.fc(2*f,c[d])}};e.Cl=function(b,c,e,d){if(32>e)for(var g=new a.Wa,f=0;f<e;f++)g.rb(c[f]),b.Cl(g,d).w(c[f]);else{var k=new a.Ed;k.Td(3);k.ZE(c,e);g=k.Pa(3);for(f=0;f<e;f++)g.write(f,f);f=b.Cl(k,d);b=f.Pa(0);g=f.Pa(3);d=a.b.pa(NaN,NaN);for(k=0;k<e;k++)c[k]=d;e=f.D();for(f=0;f<e;f++)d=g.read(f),b.fc(2*f,c[d])}};e.Z_=
"ABCDEFGHIJKLMNOPQRSTUVWXYZ";e.lE=210;return e}();a.Ib=d})(x||(x={}));(function(a){(function(a){a[a.rightSide=1]="rightSide"})(a.LN||(a.LN={}));var b=function(){function b(b,c,d){this.xt=new a.b;void 0===b?this.up=-1:(this.xt.L(b),this.up=c,this.Qa=d,this.$w=0)}b.prototype.NK=function(a){this.$w=a?this.$w|1:this.$w&-2};b.prototype.u=function(){return 0>this.up};b.prototype.Oz=function(){if(this.u())throw a.g.X("invalid call");return new a.Wa(this.xt.x,this.xt.y)};b.prototype.Za=function(){if(this.u())throw a.g.X("invalid call");
return this.up};b.prototype.Rz=function(){if(this.u())throw a.g.X("invalid call");return this.Qa};b.prototype.AA=function(){return 0!=(this.$w&1)};b.prototype.Ly=function(a,b,c,d){this.xt.x=a;this.xt.y=b;this.up=c;this.Qa=d};return b}();a.Mm=b})(x||(x={}));(function(a){var b=function(){function b(){}b.prototype.Wn=function(b,c){this.Rh.resize(0);this.hj.length=0;this.Uk=-1;b.ac(this.fl);this.fl.O(c,c);this.fl.Yb(this.Mb.Ha)?((this.rt=a.T.Oc(b.G()))?(this.gJ=b.ec(),this.fJ=b.Bc(),this.ta=c):this.ta=
NaN,this.Rh.add(this.Mb.Mf),this.hj.push(this.Mb.Ha),this.Lt=this.Mb.Us(this.Mb.Mf)):this.Lt=-1};b.prototype.Ni=function(a,b){this.Rh.resize(0);this.hj.length=0;this.Uk=-1;this.fl.I(a);this.fl.O(b,b);this.ta=NaN;this.fl.Yb(this.Mb.Ha)?(this.Rh.add(this.Mb.Mf),this.hj.push(this.Mb.Ha),this.Lt=this.Mb.Us(this.Mb.Mf),this.rt=!1):this.Lt=-1};b.prototype.next=function(){if(0==this.Rh.size)return-1;this.Uk=this.Lt;var b=null,d=null,f,k=null,h=null;this.rt&&(b=new a.b,d=new a.b,k=new a.h);for(var p=!1;!p;){for(;-1!=
this.Uk;){f=this.Mb.Kz(this.Mb.Tv(this.Uk));if(f.Yb(this.fl))if(this.rt){if(b.L(this.gJ),d.L(this.fJ),k.I(f),k.O(this.ta,this.ta),0<k.gz(b,d)){p=!0;break}}else{p=!0;break}this.Uk=this.Mb.$v(this.Uk)}if(-1==this.Uk){f=this.Rh.Fc();var l=this.hj[this.hj.length-1];null==h&&(h=[],h[0]=new a.h,h[1]=new a.h,h[2]=new a.h,h[3]=new a.h);c.uK(l,h);this.Rh.Pf();--this.hj.length;for(l=0;4>l;l++){var m=this.Mb.Eq(f,l);if(-1!=m&&0<this.Mb.QT(m)&&h[l].Yb(this.fl))if(this.rt){if(b.L(this.gJ),d.L(this.fJ),k.I(h[l]),
k.O(this.ta,this.ta),0<k.gz(b,d)){var q=new a.h;q.I(h[l]);this.Rh.add(m);this.hj.push(q)}}else q=new a.h,q.I(h[l]),this.Rh.add(m),this.hj.push(q)}if(0==this.Rh.size)return-1;this.Uk=this.Mb.Us(this.Rh.get(this.Rh.size-1))}}this.Lt=this.Mb.$v(this.Uk);return this.Uk};b.fR=function(c,d,f){var e=new b;e.Mb=c;e.fl=new a.h;e.Rh=new a.ia(0);e.hj=[];e.Wn(d,f);return e};b.eR=function(c,d,f){var e=new b;e.Mb=c;e.fl=new a.h;e.Rh=new a.ia(0);e.hj=[];e.Ni(d,f);return e};b.dR=function(c){var e=new b;e.Mb=c;e.fl=
new a.h;e.Rh=new a.ia(0);e.hj=[];return e};return b}();a.g_=b;var c=function(){function c(b,c){this.Lf=new a.ad(11);this.yi=new a.ad(5);this.st=[];this.Ww=new a.ia(0);this.Ha=new a.h;this.pl(b,c)}c.prototype.reset=function(a,b){this.Lf.Vi(!1);this.yi.Vi(!1);this.st.length=0;this.Ww.clear(!1);this.pl(a,b)};c.prototype.eh=function(a,b){return this.mw(a,b,0,this.Ha,this.Mf,!1,-1)};c.prototype.lw=function(a,b,c){c=-1==c?this.Mf:this.gH(c);var e=this.fa(c),d=this.gT(c);return this.mw(a,b,e,d,c,!1,-1)};
c.prototype.ja=function(a){return this.bT(a)};c.prototype.RG=function(a){return this.Kz(this.Tv(a))};c.prototype.fa=function(a){return this.Vv(a)};c.prototype.gT=function(b){var c=new a.h;c.I(this.Ha);var e=this.Vv(b);b=this.bH(b);for(var d=0;d<2*e;d+=2){var f=a.J.truncate(3&b>>d);0==f?(c.o=.5*(c.o+c.v),c.A=.5*(c.A+c.B)):1==f?(c.v=.5*(c.o+c.v),c.A=.5*(c.A+c.B)):(2==f?c.v=.5*(c.o+c.v):c.o=.5*(c.o+c.v),c.B=.5*(c.A+c.B))}return c};c.prototype.QT=function(a){return this.lA(a)};c.prototype.qT=function(a,
c){return b.fR(this,a,c)};c.prototype.Yz=function(a,c){return b.eR(this,a,c)};c.prototype.mf=function(){return b.dR(this)};c.prototype.pl=function(b,c){if(0>c||32<2*c)throw a.g.F("invalid height");this.AV=c;this.Ha.I(b);this.Mf=this.Lf.Pe();this.Ux(this.Mf,0);this.Ox(this.Mf,0);this.EK(this.Mf,0);this.AK(this.Mf,0)};c.prototype.mw=function(b,d,f,k,h,p,l){if(!k.contains(d))return 0==f?-1:this.mw(b,d,0,this.Ha,this.Mf,p,l);if(!p)for(var e=h;-1!=e;e=this.CT(e))this.Ux(e,this.lA(e)+1);e=new a.h;e.I(k);
k=h;var g=[];g[0]=new a.h;g[1]=new a.h;g[2]=new a.h;for(g[3]=new a.h;f<this.AV&&this.jQ(k);f++){c.uK(e,g);for(var n=!1,m=0;4>m;m++)if(g[m].contains(d)){var n=!0,y=this.Eq(k,m);-1==y&&(y=this.rR(k,m));this.Ux(y,this.lA(y)+1);k=y;e.I(g[m]);break}if(!n)break}return this.oU(b,d,f,e,k,p,h,l)};c.prototype.oU=function(a,b,c,d,f,k,h,p){var e=this.XG(f);if(k){if(f==h)return p;this.QR(p);k=p}else k=this.tR(),this.oC(k,a),this.KX(this.Tv(k),b);this.hY(k,f);-1!=e?(this.Sx(k,e),this.Px(e,k)):this.wK(f,k);this.rC(f,
k);this.Ox(f,this.Yv(f)+1);this.iQ(f)&&this.CS(c,d,f);return k};c.prototype.QR=function(a){var b=this.gH(a),c=this.XG(b),e=this.IT(a),d=this.$v(a);this.Us(b)==a?(-1!=d?this.Sx(d,-1):this.rC(b,-1),this.wK(b,d)):c==a?(this.Px(e,-1),this.rC(b,e)):(this.Sx(d,e),this.Px(e,d));this.Sx(a,-1);this.Px(a,-1);this.Ox(b,this.Yv(b)-1)};c.uK=function(a,b){var c=.5*(a.o+a.v),e=.5*(a.A+a.B);b[0].I(c,e,a.v,a.B);b[1].I(a.o,e,c,a.B);b[2].I(a.o,a.A,c,e);b[3].I(c,a.A,a.v,e)};c.prototype.iQ=function(a){return 8==this.Yv(a)&&
!this.tH(a)};c.prototype.CS=function(a,b,c){var e,d,g=this.Us(c);do d=this.Tv(g),e=this.yi.S(g,0),d=this.Kz(d),this.mw(e,d,a,b,c,!0,g),g=e=this.$v(g);while(-1!=g)};c.prototype.jQ=function(a){return 8<=this.Yv(a)||this.tH(a)};c.prototype.tH=function(a){return-1!=this.Eq(a,0)||-1!=this.Eq(a,1)||-1!=this.Eq(a,2)||-1!=this.Eq(a,3)};c.prototype.rR=function(a,b){var c=this.Lf.Pe();this.OX(a,b,c);this.Ux(c,0);this.Ox(c,0);this.rl(c,a);this.AK(c,this.Vv(a)+1);this.EK(c,b<<2*this.Vv(a)|this.bH(a));return c};
c.prototype.tR=function(){var b=this.yi.Pe(),c;0<this.Ww.size?(c=this.Ww.Fc(),this.Ww.Pf()):(c=this.st.length,this.st.push(new a.h));this.LX(b,c);return b};c.prototype.Eq=function(a,b){return this.Lf.S(a,b)};c.prototype.OX=function(a,b,c){this.Lf.P(a,b,c)};c.prototype.Us=function(a){return this.Lf.S(a,4)};c.prototype.wK=function(a,b){this.Lf.P(a,4,b)};c.prototype.XG=function(a){return this.Lf.S(a,5)};c.prototype.rC=function(a,b){this.Lf.P(a,5,b)};c.prototype.bH=function(a){return this.Lf.S(a,6)};
c.prototype.EK=function(a,b){this.Lf.P(a,6,b)};c.prototype.Yv=function(a){return this.Lf.S(a,7)};c.prototype.lA=function(a){return this.Lf.S(a,8)};c.prototype.Ox=function(a,b){this.Lf.P(a,7,b)};c.prototype.Ux=function(a,b){this.Lf.P(a,8,b)};c.prototype.CT=function(a){return this.Lf.S(a,9)};c.prototype.rl=function(a,b){this.Lf.P(a,9,b)};c.prototype.Vv=function(a){return this.Lf.S(a,10)};c.prototype.AK=function(a,b){this.Lf.P(a,10,b)};c.prototype.bT=function(a){return this.yi.S(a,0)};c.prototype.oC=
function(a,b){this.yi.P(a,0,b)};c.prototype.IT=function(a){return this.yi.S(a,1)};c.prototype.$v=function(a){return this.yi.S(a,2)};c.prototype.Sx=function(a,b){this.yi.P(a,1,b)};c.prototype.Px=function(a,b){this.yi.P(a,2,b)};c.prototype.gH=function(a){return this.yi.S(a,3)};c.prototype.hY=function(a,b){this.yi.P(a,3,b)};c.prototype.Tv=function(a){return this.yi.S(a,4)};c.prototype.LX=function(a,b){this.yi.P(a,4,b)};c.prototype.Kz=function(a){return this.st[a]};c.prototype.KX=function(a,b){this.st[a].I(b)};
return c}();a.gq=c})(x||(x={}));(function(a){(function(a){a[a.Outside=0]="Outside";a[a.Inside=1]="Inside";a[a.Border=2]="Border"})(a.AM||(a.AM={}));var b=function(){function a(a,b){this.Dh=null;this.OV=b;this.Dh=a}a.prototype.Kx=function(a,b){this.uI!=b&&a.flush();this.uI=b};a.prototype.qG=function(a,b){for(var c=0;c<b;)for(var e=a[c++],d=a[c++],g=a[c++]*this.OV;e<d;e++)this.Dh[g+(e>>4)]|=this.uI<<2*(e&15)};return a}();a.i_=b;var c=function(){function c(a,b,c){this.Dh=null;this.zB=this.il=this.pJ=
this.nJ=this.At=this.CI=this.hg=this.Hn=0;this.qj=this.jl=this.$l=null;this.kw(a,b,c)}c.create=function(b,d,f){if(!c.bz(b))throw a.g.F();return c.fe(b,d,f)};c.Cj=function(b,d,f){if(!c.bz(b))throw a.g.F();return c.te(b,d,f)};c.lX=function(b){switch(b){case 0:b=1024;break;case 1:b=16384;break;case 2:b=262144;break;default:throw a.g.X("Internal Error");}return b};c.bz=function(a){return a.u()||1607!=a.G()&&1736!=a.G()?!1:!0};c.prototype.nS=function(b,c){c=c.Fa();for(var e=new a.b,d=new a.b;c.Ya();)for(;c.Ea();){var g=
c.ba();if(322!=g.G())throw a.g.X("Internal Error");b.$h(g.ec(),e);b.$h(g.Bc(),d);this.qj.Qy(e.x,e.y,d.x,d.y)}this.qj.YJ(a.zy.py)};c.prototype.oS=function(){throw a.g.X("Internal Error");};c.prototype.Bz=function(b,c){for(var e=1;4>e;e++)b.Qy(c[e-1].x,c[e-1].y,c[e].x,c[e].y);b.Qy(c[3].x,c[3].y,c[0].x,c[0].y);this.qj.YJ(a.zy.py)};c.prototype.dL=function(b,c,d){for(var e=[null,null,null,null],g=0;g<e.length;g++)e[g]=new a.b;c=c.Fa();d=this.jl.ZY(d)+1.5;for(var g=new a.b,f=new a.b,k=new a.b,n=new a.b,
h=new a.b,p=new a.h,l=new a.b;c.Ya();){var m=!1,q=!0;for(l.ka(0,0);c.Ea();){var r=c.ba();n.x=r.ua;n.y=r.ra;h.x=r.sa;h.y=r.oa;p.Oa();p.Nb(n.x,n.y);p.ll(h.x,h.y);if(this.$l.TH(p)){this.jl.$h(h,h);q?(this.jl.$h(n,n),l.L(n),q=!1):n.L(l);g.yc(h,n);var r=g.length(),t=.5>r;0==r?g.ka(1,0):(t||l.L(h),g.scale(d/r),f.ka(-g.y,g.x),k.ka(g.y,-g.x),n.sub(g),h.add(g),e[0].add(n,f),e[1].add(n,k),e[2].add(h,k),e[3].add(h,f),t?m=!0:this.Bz(b,e))}else m&&(this.Bz(b,e),m=!1),q=!0}m&&this.Bz(b,e)}};c.prototype.VC=function(b){return a.J.truncate(b*
this.CI+this.nJ)};c.prototype.WC=function(b){return a.J.truncate(b*this.At+this.pJ)};c.fe=function(a,b,d){return new c(a,b,d)};c.te=function(a,b,d){return new c(a,b,d)};c.prototype.kw=function(c,d,f){this.hg=Math.max(a.J.truncate(2*Math.sqrt(f)+.5),64);this.Hn=a.J.truncate((2*this.hg+31)/32);this.$l=new a.h;this.il=d;f=0;for(var e=this.hg,g=this.Hn;8<=e;)f+=e*g,e=a.J.truncate(e/2),g=a.J.truncate((2*e+31)/32);this.Dh=a.J.gf(f,0);this.qj=new a.zy;f=new b(this.Dh,this.Hn,this);this.qj.wY(this.hg,this.hg,
f);c.s(this.$l);this.$l.O(d,d);var e=new a.h,g=a.h.pa(1,1,this.hg-2,this.hg-2),k=d*g.N();d*=g.fa();e.I(this.$l.Wf(),Math.max(k,this.$l.N()),Math.max(d,this.$l.fa()));this.zB=this.il;this.jl=new a.Hd;this.jl.lU(e,g);new a.Hd;switch(c.G()){case 550:f.Kx(this.qj,2);this.oS();break;case 1607:f.Kx(this.qj,2);this.dL(this.qj,c,this.zB);break;case 1736:f.Kx(this.qj,1),this.nS(this.jl,c),f.Kx(this.qj,2),this.dL(this.qj,c,this.zB)}this.CI=this.jl.lb;this.At=this.jl.gb;this.nJ=this.jl.Wb;this.pJ=this.jl.bc;
this.aQ()};c.prototype.aQ=function(){this.qj.flush();for(var b=0,c=this.hg*this.Hn,d=this.hg,f=a.J.truncate(this.hg/2),k=this.Hn,h=a.J.truncate((2*f+31)/32);8<d;){for(d=0;d<f;d++)for(var p=2*d,l=2*d+1,m=0;m<f;m++){var q=2*m,r=2*m+1,t=q>>4,q=2*(q&15),u=r>>4,r=2*(r&15),A=this.Dh[b+k*p+t]>>q&3,A=A|this.Dh[b+k*p+u]>>r&3,A=A|this.Dh[b+k*l+t]>>q&3,A=A|this.Dh[b+k*l+u]>>r&3;this.Dh[c+h*d+(m>>4)]|=A<<2*(m&15)}d=f;k=h;b=c;f=a.J.truncate(d/2);h=a.J.truncate((2*f+31)/32);c=b+k*d}};c.prototype.rm=function(a,
b){if(!this.$l.contains(a,b))return 0;a=this.VC(a);b=this.WC(b);if(0>a||a>=this.hg||0>b||b>=this.hg)return 0;a=this.Dh[this.Hn*b+(a>>4)]>>2*(a&15)&3;return 0==a?0:1==a?1:2};c.prototype.Rn=function(b){if(!b.Ma(this.$l))return 0;var c=this.VC(b.o),d=this.VC(b.v),e=this.WC(b.A);b=this.WC(b.B);0>c&&(c=0);0>e&&(e=0);d>=this.hg&&(d=this.hg-1);b>=this.hg&&(b=this.hg-1);if(c>d||e>b)return 0;for(var f=Math.max(d-c,1)*Math.max(b-e,1),k=0,h=this.Hn,p=this.hg,l=0;;){if(32>f||16>p){for(f=e;f<=b;f++)for(var m=
c;m<=d;m++)if(l=this.Dh[k+h*f+(m>>4)]>>2*(m&15)&3,1<l)return 2;if(0==l)return 0;if(1==l)return 1}k+=h*p;p=a.J.truncate(p/2);h=a.J.truncate((2*p+31)/32);c=a.J.truncate(c/2);e=a.J.truncate(e/2);d=a.J.truncate(d/2);b=a.J.truncate(b/2);f=Math.max(d-c,1)*Math.max(b-e,1)}};c.prototype.LT=function(){return this.hg*this.Hn};return c}();a.xy=c})(x||(x={}));(function(a){(function(a){a[a.contains=1]="contains";a[a.within=2]="within";a[a.equals=3]="equals";a[a.disjoint=4]="disjoint";a[a.touches=8]="touches";
a[a.crosses=16]="crosses";a[a.overlaps=32]="overlaps";a[a.unknown=0]="unknown";a[a.intersects=1073741824]="intersects"})(a.SN||(a.SN={}));var b=function(){function a(){}a.pa=function(b,c,d,f,k,h,l,m){var e=new a;e.bx=b;e.zn=c;e.ek=d;e.rj=f;e.RI=k;e.G_=h;e.H_=l;e.I_=m;return e};return a}(),c=function(){function b(){}b.UE=function(c,d,f){if(!b.cz(c))return!1;var e=a.na.ah(d,c,!1);d=!1;a.vl.KF(c)&&(d=d||c.Xu(e,f));e=c.G();1736!=e&&1607!=e||!a.vl.IF(c)||0==f||(d=d||c.Hj(f));1736!=e&&1607!=e||!a.vl.JF(c)||
0==f||(d=d||c.CO());return d};b.cz=function(b){return a.vl.KF(b)||a.vl.IF(b)||a.vl.JF(b)};return b}();a.Gu=c;c=function(){function c(){this.Ph=[]}c.$B=function(b,d,f,k,h){var e=b.G(),g=d.G();if(197==e){if(197==g)return c.sO(b,d,f,k);if(33==g)return 2==k?k=1:1==k&&(k=2),c.lG(d,b,f,k)}else if(33==e){if(197==g)return c.lG(b,d,f,k);if(33==g)return c.vO(b,d,f,k)}if(b.u()||d.u())return 4==k?!0:!1;var n=new a.h;b.s(n);var l=new a.h;d.s(l);var m=new a.h;m.I(n);m.Nb(l);f=a.na.be(f,m,!1);if(c.Dk(n,l,f))return 4==
k?!0:!1;n=!1;a.wl.Oc(e)&&(e=new a.Ua(b.description),e.dc(b,!0),b=e,e=1607);a.wl.Oc(g)&&(g=new a.Ua(d.description),g.dc(d,!0),d=g,g=1607);if(197!=e&&197!=g){if(b.tb()<d.tb()||33==e&&550==g)2==k?k=1:1==k&&(k=2)}else 1736!=e&&197!=g&&(2==k?k=1:1==k&&(k=2));switch(e){case 1736:switch(g){case 1736:n=c.gu(b,d,f,k,h);break;case 1607:n=c.On(b,d,f,k,h);break;case 33:n=c.fu(b,d,f,k,h);break;case 550:n=c.eu(b,d,f,k,h);break;case 197:n=c.eD(b,d,f,k,h)}break;case 1607:switch(g){case 1736:n=c.On(d,b,f,k,h);break;
case 1607:n=c.NB(b,d,f,k,h);break;case 33:n=c.iu(b,d,f,k,h);break;case 550:n=c.hu(b,d,f,k,h);break;case 197:n=c.sD(b,d,f,k)}break;case 33:switch(g){case 1736:n=c.fu(d,b,f,k,h);break;case 1607:n=c.iu(d,b,f,k,h);break;case 550:n=c.au(d,b,f,k,h)}break;case 550:switch(g){case 1736:n=c.eu(d,b,f,k,h);break;case 1607:n=c.hu(d,b,f,k,h);break;case 550:n=c.EB(b,d,f,k,h);break;case 33:n=c.au(b,d,f,k,h);break;case 197:n=c.RJ(b,d,f,k)}break;case 197:switch(g){case 1736:n=c.eD(d,b,f,k,h);break;case 1607:n=c.sD(d,
b,f,k);break;case 550:n=c.RJ(d,b,f,k)}}return n};c.sO=function(b,d,f,k){if(b.u()||d.u())return 4==k?!0:!1;var e=new a.h,g=new a.h,n=new a.h;b.s(e);d.s(g);n.I(e);n.Nb(g);b=a.na.be(f,n,!1);switch(k){case 4:return c.Dk(e,g,b);case 2:return c.SE(g,e,b);case 1:return c.SE(e,g,b);case 3:return c.We(e,g,b);case 8:return c.DP(e,g,b);case 32:return c.aP(e,g,b);case 16:return c.EL(e,g,b)}return!1};c.lG=function(b,d,f,k){if(b.u()||d.u())return 4==k?!0:!1;b=b.w();var e=new a.h,g=new a.h;d.s(e);g.I(b);g.Nb(e);
d=a.na.be(f,g,!1);switch(k){case 4:return c.Dx(b,e,d);case 2:return c.YC(b,e,d);case 1:return c.EN(b,e,d);case 3:return c.qL(b,e,d);case 8:return c.XC(b,e,d)}return!1};c.vO=function(b,d,f,k){if(b.u()||d.u())return 4==k?!0:!1;b=b.w();d=d.w();var e=new a.h;e.I(b);e.Nb(d);f=a.na.be(f,e,!1);switch(k){case 4:return c.NN(b,d,f);case 2:return c.eL(d,b,f);case 1:return c.eL(b,d,f);case 3:return c.yL(b,d,f)}return!1};c.gu=function(a,b,d,f,k){switch(f){case 4:return c.iS(a,b,d);case 2:return c.Ex(b,a,d,k);
case 1:return c.Ex(a,b,d,k);case 3:return c.jU(a,b,d);case 8:return c.mW(a,b,d);case 32:return c.iV(a,b,d,k)}return!1};c.On=function(a,b,d,f,k){switch(f){case 4:return c.GS(a,b,d);case 1:return c.MB(a,b,d,k);case 8:return c.wW(a,b,d,k);case 16:return c.EP(a,b,d)}return!1};c.fu=function(a,b,d,f){switch(f){case 4:return c.XR(a,b,d);case 1:return c.xO(a,b,d);case 8:return c.eW(a,b,d)}return!1};c.eu=function(a,b,d,f){switch(f){case 4:return c.CR(a,b,d);case 1:return c.uO(a,b,d);case 8:return c.TV(a,b,
d);case 16:return c.uP(a,b,d)}return!1};c.eD=function(a,b,d,f,k){if(c.mQ(a,b,d))return 4==f?!0:!1;if(4==f)return!1;switch(f){case 2:return c.eX(a,b,d);case 1:return c.rO(a,b,d);case 3:return c.gU(a,b,d);case 8:return c.lV(a,b,d,k);case 32:return c.fV(a,b,d,k);case 16:return c.FL(a,b,d,k)}return!1};c.NB=function(a,b,d,f){switch(f){case 4:return c.yZ(a,b,d);case 2:return c.oD(b,a,d);case 1:return c.oD(a,b,d);case 3:return c.PL(a,b,d);case 8:return c.uD(a,b,d);case 32:return c.dM(a,b,d);case 16:return c.qD(a,
b,d)}return!1};c.iu=function(a,b,d,f){switch(f){case 4:return c.wZ(a,b,d);case 1:return c.SY(a,b,d);case 8:return c.zM(a,b,d)}return!1};c.hu=function(a,b,d,f){switch(f){case 4:return c.uZ(a,b,d);case 1:return c.HX(a,b,d);case 8:return c.oM(a,b,d);case 16:return c.nZ(a,b,d)}return!1};c.sD=function(a,b,d,f){if(c.qZ(a,b,d))return 4==f?!0:!1;if(4==f)return!1;switch(f){case 2:return c.EM(a,b,d);case 1:return c.oX(a,b,d);case 3:return c.JL(a,b,d);case 8:return c.kM(a,b,d);case 32:return c.$L(a,b,d);case 16:return c.fZ(a,
b,d)}return!1};c.EB=function(a,b,d,f){switch(f){case 4:return c.SL(a,b,d);case 2:return c.sJ(b,a,d);case 1:return c.sJ(a,b,d);case 3:return c.cM(a,b,d);case 32:return c.IM(a,b,d)}return!1};c.au=function(a,b,d,f){switch(f){case 4:return c.AJ(a,b,d);case 2:return c.TM(a,b,d);case 1:return c.pZ(a,b,d);case 3:return c.zx(a,b,d)}return!1};c.RJ=function(a,b,d,f){switch(f){case 4:return c.OL(a,b,d);case 2:return c.PM(a,b,d);case 1:return c.mZ(a,b,d);case 3:return c.ZL(a,b,d);case 8:return c.MM(a,b,d);case 16:return c.IL(a,
b,d)}return!1};c.jU=function(b,d,f){var e=new a.h,g=new a.h;b.s(e);d.s(g);if(!c.We(e,g,f))return!1;e=c.vc(b,d,!1);if(4==e||1==e||2==e)return!1;if(c.qJ(b,d,f))return!0;e=b.Rb();g=d.Rb();return Math.abs(e-g)>4*Math.max(b.D(),d.D())*f?!1:c.PB(b,d,f,!0)};c.iS=function(a,b,d){var e=c.vc(a,b,!0);return 4==e?!0:1==e||2==e||1073741824==e?!1:c.cD(a,b,d)};c.mW=function(a,b,d){var e=c.vc(a,b,!1);return 4==e||1==e||2==e?!1:c.iD(a,b,d,null)};c.iV=function(a,b,d,f){var e=c.vc(a,b,!1);return 4==e||1==e||2==e?!1:
c.dD(a,b,d,f)};c.Ex=function(b,d,f,k){var e=new a.h,g=new a.h;b.s(e);d.s(g);if(!c.Ec(e,g,f))return!1;e=c.vc(b,d,!1);return 4==e||2==e?!1:1==e?!0:c.CL(b,d,f,k)};c.GS=function(a,b,d){var e=c.vc(a,b,!0);return 4==e?!0:1==e||1073741824==e?!1:c.cD(a,b,d)};c.wW=function(a,b,d,f){var e=c.vc(a,b,!1);return 4==e||1==e?!1:c.kD(a,b,d,f)};c.EP=function(a,b,d){var e=c.vc(a,b,!1);return 4==e||1==e?!1:c.bD(a,b,d,null)};c.MB=function(b,d,f,k){var e=new a.h,g=new a.h;b.s(e);d.s(g);if(!c.Ec(e,g,f))return!1;e=c.vc(b,
d,!1);return 4==e?!1:1==e?!0:c.DL(b,d,f,k)};c.XR=function(b,c,d){return 0==a.gd.WH(b,c,d)?!0:!1};c.eW=function(a,b,d){b=b.w();return c.fD(a,b,d)};c.xO=function(a,b,d){b=b.w();return c.BL(a,b,d)};c.CR=function(b,d,f){var e=c.vc(b,d,!1);if(4==e)return!0;if(1==e)return!1;e=new a.h;b.s(e);e.O(f,f);for(var g=new a.b,k=0;k<d.D();k++)if(d.w(k,g),e.contains(g)){var n=a.gd.ge(b,g,f);if(1==n||2==n)return!1}return!0};c.TV=function(b,c,d){var e=this.vc(b,c,!1);if(4==e||1==e)return!1;e=new a.h;b.s(e);e.O(d,d);
var g,f=!1,k;k=b;for(var n=!1,h=0;h<c.D();h++){g=c.Ba(h);if(e.contains(g))if(g=a.gd.ge(k,g,d),2==g)f=!0;else if(1==g)return!1;n||(!a.ff.qm(b,c.D()-1)||null!=b.ob&&null!=b.ob.Mb?k=b:(k=new a.Ja,b.copyTo(k),k.Hj(1)),n=!0)}return f?!0:!1};c.uP=function(b,c,d){var e=this.vc(b,c,!1);if(4==e||1==e)return!1;var g=new a.h,e=new a.h,f=new a.h;b.s(g);c.s(f);e.I(g);e.O(d,d);var f=g=!1,k,n;n=b;for(var h=!1,l=0;l<c.D();l++){k=c.Ba(l);e.contains(k)?(k=a.gd.ge(n,k,d),0==k?f=!0:1==k&&(g=!0)):f=!0;if(g&&f)return!0;
h||(!a.ff.qm(b,c.D()-1)||null!=b.ob&&null!=b.ob.Mb?n=b:(n=new a.Ja,b.copyTo(n),n.Hj(1)),h=!0)}return!1};c.uO=function(b,c,d){var e=new a.h,g=new a.h;b.s(e);c.s(g);if(!this.Ec(e,g,d))return!1;g=this.vc(b,c,!1);if(4==g)return!1;if(1==g)return!0;var g=!1,f,k;k=b;for(var n=!1,h=0;h<c.D();h++){f=c.Ba(h);if(!e.contains(f))return!1;f=a.gd.ge(k,f,d);if(1==f)g=!0;else if(0==f)return!1;n||(!a.ff.qm(b,c.D()-1)||null!=b.ob&&null!=b.ob.Mb?k=b:(k=new a.Ja,b.copyTo(k),k.Hj(1)),n=!0)}return g};c.gU=function(b,d,
f){var e=new a.h,g=new a.h;b.s(e);d.s(g);if(!c.We(e,g,f))return!1;e=new a.Ja;e.jd(d,!1);return c.PB(b,e,f,!0)};c.mQ=function(b,d,f){var e=c.vc(b,d,!1);if(4==e)return!0;if(1==e||2==e)return!1;var g=new a.h,e=new a.h;b.s(g);d.s(e);if(c.Ec(e,g,f))return!1;g=new a.b;e.Tn(g);d=a.gd.ge(b,g,f);if(0!=d)return!1;e.TJ(g);d=a.gd.ge(b,g,f);if(0!=d)return!1;e.Un(g);d=a.gd.ge(b,g,f);if(0!=d)return!1;e.WJ(g);d=a.gd.ge(b,g,f);if(0!=d)return!1;d=b.Pa(0);g=new a.h;g.I(e);g.O(f,f);for(var k=0,n=b.D();k<n;k++){var h=
d.read(2*k),l=d.read(2*k+1);if(g.contains(h,l))return!1}return!c.XH(b,e,f)};c.lV=function(b,d,f,k){var e=c.vc(b,d,!1);if(4==e||1==e||2==e)return!1;var e=new a.h,g=new a.h;b.s(e);d.s(g);if(c.Ec(g,e,f))return!1;if(g.N()<=f&&g.fa()<=f)return d=d.Bq(),c.fD(b,d,f);if(g.N()<=f||g.fa()<=f)return e=new a.Ua,g=new a.Wa,d.ig(0,g),e.Rf(g),d.ig(2,g),e.lineTo(g),c.kD(b,e,f,k);e=new a.Ja;e.jd(d,!1);return c.iD(b,e,f,k)};c.fV=function(b,d,f,k){var e=c.vc(b,d,!1);if(4==e||1==e||2==e)return!1;var e=new a.h,g=new a.h;
b.s(e);d.s(g);if(c.Ec(g,e,f)||g.N()<=f||g.fa()<=f)return!1;e=new a.Ja;e.jd(d,!1);return c.dD(b,e,f,k)};c.eX=function(b,d,f){var e=new a.h,g=new a.h;b.s(e);d.s(g);return c.Ec(g,e,f)};c.rO=function(b,d,f){var e=new a.h,g=new a.h;b.s(e);d.s(g);if(!c.Ec(e,g,f))return!1;e=c.vc(b,d,!1);if(4==e||2==e)return!1;if(1==e)return!0;if(g.N()<=f&&g.fa()<=f)return d=d.Bq(),c.BL(b,d,f);if(g.N()<=f||g.fa()<=f)return g=new a.Ua,e=new a.Wa,d.ig(0,e),g.Rf(e),d.ig(2,e),g.lineTo(e),c.DL(b,g,f,null);g=new a.Ja;g.jd(d,!1);
return c.CL(b,g,f,null)};c.FL=function(b,d,f,k){var e=new a.h,g=new a.h;b.s(e);d.s(g);if(c.Ec(g,e,f)||g.fa()>f&&g.N()>f||g.fa()<=f&&g.N()<=f)return!1;e=new a.Ua;g=new a.Wa;d.ig(0,g);e.Rf(g);d.ig(2,g);e.lineTo(g);return c.bD(b,e,f,k)};c.PL=function(b,d,f){var e=new a.h,g=new a.h;b.s(e);d.s(g);return c.We(e,g,f)&&4!=c.vc(b,d,!1)?c.qJ(b,d,f)?!0:c.PB(b,d,f,!1):!1};c.yZ=function(b,c,d){return 4==this.vc(b,c,!1)?!0:(new a.Lm(b,c,d,!0)).next()?!this.fI(b,c,d):!1};c.uD=function(b,d,f){if(4==c.vc(b,d,!1))return!1;
var e=new a.Qd(0);if(0!=c.SB(b,d,f,e))return!1;for(var g=new a.Ed,k=0;k<e.size;k+=2){var n=e.read(k),h=e.read(k+1);g.lv(n,h)}b=b.Gg();d=d.Gg();b.Id(d,0,d.D());return c.yx(b,g,f)};c.qD=function(b,d,f){if(4==c.vc(b,d,!1))return!1;var e=new a.Qd(0);if(0!=c.SB(b,d,f,e))return!1;for(var g=new a.Ed,k=0;k<e.size;k+=2){var n=e.read(k),h=e.read(k+1);g.lv(n,h)}b=b.Gg();d=d.Gg();b.Id(d,0,d.D());return!c.yx(b,g,f)};c.dM=function(a,b,d){return 4==c.vc(a,b,!1)?!1:c.$H(a,b,d)};c.oD=function(b,d,f){var e=new a.h,
g=new a.h;b.s(e);d.s(g);return c.Ec(e,g,f)&&4!=c.vc(b,d,!1)?c.Wg(d,b,f,!1):!1};c.wZ=function(a,b,d){if(4==c.vc(a,b,!1))return!0;b=b.w();return!c.IA(a,b,d)};c.zM=function(a,b,d){if(4==c.vc(a,b,!1))return!1;b=b.w();return c.hC(a,b,d)};c.SY=function(a,b,d){if(4==c.vc(a,b,!1))return!1;b=b.w();return c.yH(a,b,d)};c.uZ=function(a,b,d){return 4==c.vc(a,b,!1)?!0:!c.ZH(a,b,d,!1)};c.oM=function(b,c,d){if(4==this.vc(b,c,!1))return!1;var e=b.Fa(),g=new a.h,f=new a.h,k=new a.h;b.s(g);c.s(f);g.O(d,d);f.O(d,d);
k.I(g);k.Ma(f);var n,h,g=null;n=b.ob;null!=n?(h=n.Mb,g=n.np,null==h&&(h=n=a.na.Lj(b,k))):h=n=a.na.Lj(b,k);var l=h.mf(),m=null;null!=g&&(m=g.mf());var p=new a.b,q=new a.b,r=!1,t=d*d,g=new a.Fm(c.D());for(n=0;n<c.D();n++)g.write(n,0);for(n=0;n<c.D();n++)if(c.w(n,p),k.contains(p))if(f.I(p.x,p.y,p.x,p.y),null==m||(m.Ni(f,d),-1!=m.next())){l.Ni(f,d);for(var u=l.next();-1!=u;u=l.next())if(e.Tb(h.ja(u)),u=e.ba(),u.gc(u.qe(p,!1),q),a.b.sc(p,q)<=t){g.write(n,1);r=!0;break}}if(!r)return!1;b=b.Gg();e=new a.Ed;
f=new a.b;for(n=0;n<c.D();n++)0!=g.read(n)&&(c.w(n,f),e.lv(f.x,f.y));return this.yx(b,e,d)};c.nZ=function(b,c,d){if(4==this.vc(b,c,!1))return!1;var e=b.Fa(),g=new a.h,f=new a.h,k=new a.h;b.s(g);c.s(f);g.O(d,d);f.O(d,d);k.I(g);k.Ma(f);var n,h,g=null;n=b.ob;null!=n?(h=n.Mb,g=n.np,null==h&&(h=n=a.na.Lj(b,k))):h=n=a.na.Lj(b,k);var l=h.mf(),m=null;null!=g&&(m=g.mf());var p=new a.b,q=new a.b,r=!1,t=!1,u=d*d,g=new a.Fm(c.D());for(n=0;n<c.D();n++)g.write(n,0);for(n=0;n<c.D();n++)if(c.w(n,p),k.contains(p))if(f.I(p.x,
p.y,p.x,p.y),null!=m&&(m.Ni(f,d),-1==m.next()))t=!0;else{l.Ni(f,d);for(var A=!1,v=l.next();-1!=v;v=l.next())if(e.Tb(h.ja(v)),v=e.ba(),v.gc(v.qe(p,!1),q),a.b.sc(p,q)<=u){g.write(n,1);A=r=!0;break}A||(t=!0)}else t=!0;if(!r||!t)return!1;b=b.Gg();e=new a.Ed;f=new a.b;for(n=0;n<c.D();n++)0!=g.read(n)&&(c.w(n,f),e.lv(f.x,f.y));return!this.yx(b,e,d)};c.HX=function(b,d,f){var e=new a.h,g=new a.h;b.s(e);d.s(g);if(!c.Ec(e,g,f)||4==c.vc(b,d,!1)||!c.ZH(b,d,f,!0))return!1;b=b.Gg();return!c.CJ(b,d,f)};c.JL=function(b,
d,f){var e=new a.h,g=new a.h;b.s(e);d.s(g);return g.fa()>f&&g.N()>f?!1:c.We(e,g,f)};c.qZ=function(b,d,f){var e=new a.h,g=new a.h;b.s(e);d.s(g);return c.Ec(g,e,f)?!1:!c.XH(b,g,f)};c.kM=function(b,d,f){var e=new a.h,g=new a.h;b.s(e);d.s(g);if(g.fa()<=f&&g.N()<=f)return g=d.Bq(),c.hC(b,g,f);if(g.fa()<=f||g.N()<=f)return g=new a.Ua,e=new a.Wa,d.ig(0,e),g.Rf(e),d.ig(2,e),g.lineTo(e),c.uD(b,g,f);b=b.Fa();d=new a.h;e=new a.h;d.I(g);e.I(g);d.O(-f,-f);e.O(f,f);for(var g=!1,k=new a.h,n=new a.h;b.Ya();)for(;b.Ea();){b.ba().s(k);
n.I(d);n.Ma(k);if(!n.u()&&(n.fa()>f||n.N()>f))return!1;n.I(e);n.Ma(k);n.u()||(g=!0)}return g};c.$L=function(b,d,f){var e=new a.h,g=new a.h;b.s(e);d.s(g);if(c.Ec(e,g,f)||c.Ec(g,e,f)||c.Ec(g,e,f)||g.fa()>f&&g.N()>f||g.fa()<=f&&g.N()<=f)return!1;e=new a.Ua;g=new a.Wa;d.ig(0,g);e.Rf(g);d.ig(2,g);e.lineTo(g);return c.$H(b,e,f)};c.EM=function(b,d,f){var e=new a.h,g=new a.h;b.s(e);d.s(g);if(!c.Ec(g,e,f)||g.fa()<=f&&g.N()<=f)return!1;if(g.fa()<=f||g.N()<=f)return c.Ec(g,e,f);b=b.Fa();d=new a.h;d.I(g);d.O(-f,
-f);for(var g=!1,e=new a.h,k=new a.h;b.Ya();)for(;b.Ea();)b.ba().s(e),d.Tm(e)?g=!0:(k.I(d),k.Ma(e),!k.u()&&(k.fa()>f||k.N()>f)&&(g=!0));return g};c.oX=function(b,d,f){var e=new a.h,g=new a.h;d.s(g);b.s(e);if(!c.Ec(e,g,f)||g.fa()>f&&g.N()>f)return!1;if(g.fa()<=f&&g.N()<=f)return d=d.Bq(),c.yH(b,d,f);e=new a.Ua;g=new a.Wa;d.ig(0,g);e.Rf(g);d.ig(2,g);e.lineTo(g);return c.Wg(e,b,f,!1)};c.fZ=function(b,d,f){var e=new a.h,g=new a.h;b.s(e);d.s(g);if(c.Ec(g,e,f)||g.fa()<=f&&g.N()<=f)return!1;if(g.fa()<=f||
g.N()<=f)return e=new a.Ua,g=new a.Wa,d.ig(0,g),e.Rf(g),d.ig(2,g),e.lineTo(g),c.qD(b,e,f);b=b.Fa();d=new a.h;e=new a.h;e.I(g);d.I(g);e.O(-f,-f);d.O(f,f);for(var k=g=!1,n=new a.h,h=new a.h;b.Ya();)for(;b.Ea();)if(b.ba().s(n),k||d.contains(n)||(k=!0),g||(h.I(e),h.Ma(n),!h.u()&&(h.fa()>f||h.N()>f)&&(g=!0)),g&&k)return!0;return!1};c.cM=function(b,d,f){var e=new a.h,g=new a.h;b.s(e);d.s(g);return c.We(e,g,f)?c.jM(b,d,f)?!0:c.RC(b,d,f,!1,!0,!1):!1};c.SL=function(a,b,d){return!c.CJ(a,b,d)};c.IM=function(a,
b,d){return c.RC(a,b,d,!1,!1,!0)};c.sJ=function(b,d,f){var e=new a.h,g=new a.h;b.s(e);d.s(g);return c.Ec(e,g,f)?c.RC(d,b,f,!0,!1,!1):!1};c.yx=function(b,c,d){d*=d;for(var e=new a.b,g=new a.b,f=0;f<c.D();f++){c.w(f,g);for(var k=!1,n=0;n<b.D();n++)if(b.w(n,e),a.b.sc(e,g)<=d){k=!0;break}if(!k)return!1}return!0};c.zx=function(b,d,f){var e=new a.h,g=new a.h;b.s(e);d.s(g);return c.We(e,g,f)};c.AJ=function(a,b,d){b=b.w();return c.$t(a,b,d)};c.TM=function(a,b,d){return c.zx(a,b,d)};c.pZ=function(a,b,d){return!c.AJ(a,
b,d)};c.ZL=function(b,d,f){var e=new a.h,g=new a.h;b.s(e);d.s(g);return g.fa()>f||g.N()>f?!1:c.We(e,g,f)};c.OL=function(b,d,f){var e=new a.h,g=new a.h;b.s(e);d.s(g);if(c.Ec(g,e,f))return!1;d=new a.h;d.I(g);d.O(f,f);f=new a.b;for(g=0;g<b.D();g++)if(b.w(g,f),d.contains(f))return!1;return!0};c.MM=function(b,c,d){var e=new a.h,g=new a.h,f=new a.h;c.s(e);if(e.fa()<=d&&e.N()<=d)return!1;if(e.fa()<=d||e.N()<=d){c=new a.b;var k=!1;g.I(e);f.I(e);g.O(d,d);e.fa()>d?f.O(0,-d):f.O(-d,0);for(var n=0;n<b.D();n++)if(b.w(n,
c),g.contains(c)){if(e.fa()>d){if(c.y>f.A&&c.y<f.B)return!1}else if(c.x>f.o&&c.x<f.v)return!1;k=!0}return k}g.I(e);f.I(e);g.O(d,d);f.O(-d,-d);c=new a.b;k=!1;for(n=0;n<b.D();n++)if(b.w(n,c),g.contains(c)){if(f.Tm(c))return!1;k=!0}return k};c.PM=function(b,d,f){var e=new a.h,g=new a.h;b.s(e);d.s(g);if(!c.Ec(g,e,f))return!1;if(g.fa()<=f&&g.N()<=f)return c.We(e,g,f);if(g.fa()<=f||g.N()<=f){d=!1;var e=new a.h,k=new a.h;e.I(g);k.I(g);g.fa()>f?e.O(0,-f):e.O(-f,0);k.O(f,f);for(var n=new a.b,h=0;h<b.D();h++){b.w(h,
n);if(!k.contains(n))return!1;g.fa()>f?n.y>e.A&&n.y<e.B&&(d=!0):n.x>e.o&&n.x<e.v&&(d=!0)}return d}d=!1;e=new a.h;k=new a.h;e.I(g);k.I(g);e.O(-f,-f);k.O(f,f);n=new a.b;for(h=0;h<b.D();h++){b.w(h,n);if(!k.contains(n))return!1;e.Tm(n)&&(d=!0)}return d};c.mZ=function(b,d,f){var e=new a.h,g=new a.h;b.s(e);d.s(g);if(!c.Ec(e,g,f)||g.fa()>f||g.N()>f)return!1;d=d.Bq();return!c.$t(b,d,f)};c.IL=function(b,d,f){var e=new a.h,g=new a.h;b.s(e);d.s(g);if(c.Ec(g,e,f)||g.fa()<=f&&g.N()<=f)return!1;if(g.fa()<=f||g.N()<=
f){d=new a.h;e=new a.h;d.I(g);g.fa()>f?d.O(0,-f):d.O(-f,0);e.I(g);e.O(f,f);for(var k=new a.b,n=!1,h=!1,l=0;l<b.D();l++)if(b.w(l,k),n||(g.fa()>f?k.y>d.A&&k.y<d.B&&(n=!0):k.x>d.o&&k.x<d.v&&(n=!0)),h||e.contains(k)||(h=!0),n&&h)return!0;return!1}d=new a.h;e=new a.h;d.I(g);d.O(-f,-f);e.I(g);e.O(f,f);k=new a.b;h=n=!1;for(l=0;l<b.D();l++)if(b.w(l,k),!n&&d.Tm(k)&&(n=!0),h||e.contains(k)||(h=!0),n&&h)return!0;return!1};c.yL=function(b,c,d){return a.b.sc(b,c)<=d*d?!0:!1};c.NN=function(b,c,d){return a.b.sc(b,
c)>d*d?!0:!1};c.eL=function(a,b,d){return c.yL(a,b,d)};c.qL=function(b,d,f){var e=new a.h;e.I(b);return c.We(e,d,f)};c.Dx=function(b,c,d){var e=new a.h;e.I(c);e.O(d,d);return!e.contains(b)};c.XC=function(b,c,d){if(c.fa()<=d&&c.N()<=d)return!1;var e=new a.h,g=new a.h;e.I(c);e.O(d,d);if(!e.contains(b))return!1;if(c.fa()<=d||c.N()<=d){g.I(c);c.fa()>d?g.O(0,-d):g.O(-d,0);if(c.fa()>d){if(b.y>g.A&&b.y<g.B)return!1}else if(b.x>g.o&&b.x<g.v)return!1;return!0}g.I(c);g.O(-d,-d);return g.Tm(b)?!1:!0};c.YC=function(b,
c,d){if(c.fa()<=d&&c.N()<=d)return!0;if(c.fa()<=d||c.N()<=d){var e=new a.h;e.I(c);c.fa()>d?e.O(0,-d):e.O(-d,0);var g=!1;c.fa()>d?b.y>e.A&&b.y<e.B&&(g=!0):b.x>e.o&&b.x<e.v&&(g=!0);return g}e=new a.h;e.I(c);e.O(-d,-d);return e.Tm(b)};c.EN=function(a,b,d){return c.qL(a,b,d)};c.We=function(a,b,d){return c.Ec(a,b,d)&&c.Ec(b,a,d)};c.Dk=function(b,c,d){var e=new a.h;e.I(c);e.O(d,d);return!b.Yb(e)};c.DP=function(b,d,f){if(b.fa()<=f&&b.N()<=f){var e=b.Wf();return c.XC(e,d,f)}if(d.fa()<=f&&d.N()<=f)return e=
d.Wf(),c.XC(e,b,f);b.fa()>f&&b.N()>f&&(d.fa()<=f||d.N()<=f)?e=d:(e=b,b=d);if(e.fa()<=f||e.N()<=f){if(b.fa()<=f||b.N()<=f){d=new a.Hb;var g=new a.Hb,k=[0,0],n=[0,0],h=new a.b;e.Tn(h);d.Mc(h);e.Un(h);d.Zc(h);b.Tn(h);g.Mc(h);b.Un(h);g.Zc(h);d.Ma(g,null,k,n,f);return 1!=d.Ma(g,null,null,null,f)?!1:0==k[0]||1==k[1]||0==n[0]||1==n[1]}d=new a.h;g=new a.h;d.I(b);d.O(-f,-f);g.I(d);g.Ma(e);return!g.u()&&(g.fa()>f||g.N()>f)?!1:!0}b.O(f,f);g=new a.h;g.I(e);g.Ma(b);return g.u()||!g.u()&&g.fa()>f&&g.N()>f?!1:!0};
c.aP=function(b,d,f){if(c.Ec(b,d,f)||c.Ec(d,b,f)||b.fa()<=f&&b.N()<=f||d.fa()<=f&&d.N()<=f)return!1;if(b.fa()<=f||b.N()<=f){if(d.fa()>f&&d.N()>f)return!1;var e=new a.Hb,g=new a.Hb,k=[0,0],h=[0,0],n=new a.b;b.Tn(n);e.Mc(n);b.Un(n);e.Zc(n);d.Tn(n);g.Mc(n);d.Un(n);g.Zc(n);e.Ma(g,null,k,h,f);return 2!=e.Ma(g,null,null,null,f)?!1:(0<k[0]||1>k[1])&&(0<h[0]||1>h[1])}if(d.fa()<=f||d.N()<=f)return!1;e=new a.h;e.I(b);e.Ma(d);return e.u()||e.fa()<=f||e.N()<=f?!1:!0};c.SE=function(b,d,f){if(!c.Ec(b,d,f))return!1;
if(b.fa()<=f&&b.N()<=f)return b=b.Wf(),c.YC(b,d,f);if(d.fa()<=f&&d.N()<=f)return d=d.Wf(),c.YC(d,b,f);if(b.fa()<=f||b.N()<=f)return c.Ec(b,d,f);if(d.fa()<=f||d.N()<=f){var e=new a.h;e.I(b);e.O(-f,-f);if(e.Tm(d))return!0;b=new a.h;b.I(e);b.Ma(d);return b.u()||b.fa()<=f&&b.N()<=f?!1:!0}return c.Ec(b,d,f)};c.EL=function(b,d,f){if(c.Ec(b,d,f)||c.Ec(d,b,f)||b.fa()<=f&&b.N()<=f||d.fa()<=f&&d.N()<=f||d.fa()>f&&d.N()>f&&b.fa()>f&&b.N()>f)return!1;var e;b.fa()>f&&b.N()>f?e=d:(e=b,b=d);if(b.fa()>f&&b.N()>f){d=
new a.h;var g=new a.h;g.I(b);g.O(-f,-f);d.I(g);d.Ma(e);return d.u()||d.fa()<=f&&d.N()<=f?!1:!0}d=new a.Hb;var g=new a.Hb,k=[0,0],h=[0,0],n=new a.b;e.Tn(n);d.Mc(n);e.Un(n);d.Zc(n);b.Tn(n);g.Mc(n);b.Un(n);g.Zc(n);d.Ma(g,null,k,h,f);return 1!=d.Ma(g,null,null,null,f)?!1:0<k[0]&&1>k[1]&&0<h[0]&&1>h[1]};c.cD=function(b,c,d){var e,g,f=new a.h,k=new a.h,h=new a.Lm(b,c,d,!0);if(!h.next())return!0;if(this.fI(b,c,d))return!1;var n;n=b;var l;l=null;1736==c.G()&&(l=c);var p=!1,m=!1;do{e=h.Ql();g=h.Ml();g=c.Ba(c.wa(g));
f.I(h.fA());f.O(d,d);if(f.contains(g)&&(g=a.gd.ge(n,g,0),0!=g)||1736==c.G()&&(e=b.Ba(b.wa(e)),k.I(h.Jz()),k.O(d,d),k.contains(e)&&(g=a.gd.ge(l,e,0),0!=g)))return!1;p||(!a.ff.qm(b,c.aa()-1)||null!=b.ob&&null!=b.ob.Mb?n=b:(n=new a.Ja,b.copyTo(n),n.Hj(1)),p=!0);1736!=c.G()||m||(m=c,!a.ff.qm(m,b.aa()-1)||null!=c.ob&&null!=c.ob.Mb?l=c:(l=new a.Ja,m.copyTo(l),l.Hj(1)),m=!0)}while(h.next());return!0};c.Ec=function(b,c,d){var e=new a.h;e.I(b);e.O(d,d);return e.contains(c)};c.Yp=function(b,c,d){var e=new a.h;
e.I(c);e.O(d,d);c=new a.b;b.Tn(c);if(!e.contains(c))return!0;b.TJ(c);if(!e.contains(c))return!0;b.WJ(c);if(!e.contains(c))return!0;b.Un(c);return e.contains(c)?!1:!0};c.qJ=function(b,c,d){if(b.aa()!=c.aa()||b.D()!=c.D())return!1;var e=new a.b,g=new a.b,f=!0;d*=d;for(var k=0;k<b.aa();k++){if(b.Gc(k)!=c.Gc(k)){f=!1;break}for(var h=b.wa(k);h<c.Gc(k);h++)if(b.w(h,e),c.w(h,g),a.b.sc(e,g)>d){f=!1;break}if(!f)break}return f?!0:!1};c.jM=function(b,c,d){if(b.D()!=c.D())return!1;var e=new a.b,g=new a.b,f=!0;
d*=d;for(var k=0;k<b.D();k++)if(b.w(k,e),c.w(k,g),a.b.sc(e,g)>d){f=!1;break}return f?!0:!1};c.RC=function(b,c,d,f,k,h){var e=!1,g;b.D()>c.D()?(f&&(f=!1,e=!0),g=c):(g=b,b=c);c=null;if(k||h||e){c=new a.Fm(b.D());for(var n=0;n<b.D();n++)c.write(n,0)}var n=new a.h,l=new a.h,m=new a.h;g.s(n);b.s(l);n.O(d,d);l.O(d,d);m.I(n);m.Ma(l);for(var l=new a.b,p=new a.b,q=!0,r=a.na.CF(b,m),y=r.mf(),t=d*d,B=0;B<g.D();B++)if(g.w(B,l),m.contains(l)){var u=!1;n.I(l.x,l.y,l.x,l.y);y.Ni(n,d);for(var A=y.next();-1!=A&&!(A=
r.ja(A),b.w(A,p),a.b.sc(l,p)<=t&&((k||h||e)&&c.write(A,1),u=!0,f));A=y.next());if(!u&&(q=!1,k||f))return!1}else{if(k||f)return!1;q=!1}if(h&&q)return!1;if(f)return!0;for(n=0;n<b.D();n++)if(1==c.read(n)){if(h)return!0}else if(k||e)return!1;return h?!1:!0};c.CJ=function(b,c,d){var e;b.D()>c.D()?e=c:(e=b,b=c);c=new a.h;var g=new a.h,f=new a.h;e.s(c);b.s(g);c.O(d,d);g.O(d,d);f.I(c);f.Ma(g);for(var g=new a.b,k=new a.b,h=d*d,n=a.na.CF(b,f),l=n.mf(),m=0;m<e.D();m++)if(e.w(m,g),f.contains(g)){c.I(g.x,g.y,
g.x,g.y);l.Ni(c,d);for(var p=l.next();-1!=p;p=l.next())if(b.w(n.ja(p),k),a.b.sc(g,k)<=h)return!0}return!1};c.PB=function(a,b,d,f){return c.Wg(a,b,d,f)&&c.Wg(b,a,d,f)};c.Wg=function(d,g,f,k){function e(a,b){return q.XF(a,b)}var h=!0,n=[0,0],l=[0,0],m=0,p=new a.ia(0),q=new c,r,y=new a.h,t=new a.h,u=new a.h;d.s(y);g.s(t);y.O(f,f);t.O(f,f);u.I(y);u.Ma(t);d=d.Fa();var t=g.Fa(),A=null,v=A=null,w=g.ob;null!=w?(A=w.Mb,v=w.np,null==A&&(A=a.na.Lj(g,u))):A=a.na.Lj(g,u);g=A.mf();w=null;for(null!=v&&(w=v.mf());d.Ya();)for(;d.Ea();){var x=
!1,z=d.ba();z.s(y);if(!y.Yb(u))return!1;if(null!=w&&(w.Ni(y,f),-1==w.next()))return h=!1;v=z.Rb();g.Wn(z,f);for(r=g.next();-1!=r;r=g.next()){t.Tb(A.ja(r));r=t.ba();var C=z.Ma(r,null,n,l,f);if(2==C&&(!k||l[0]<=l[1])){var C=n[0],D=n[1],L=l[0],E=l[1];if(C*v<=f&&(1-D)*v<=f){x=!0;m=0;p.resize(0);q.Ph.length=0;for(var G=d.Db(),L=!0;L;){if(d.Ea()){z=d.ba();v=z.Rb();C=z.Ma(r,null,n,l,f);if(2==C&&(!k||l[0]<=l[1])&&(C=n[0],D=n[1],C*v<=f&&(1-D)*v<=f)){G=d.Db();continue}if(t.Ea()&&(r=t.ba(),C=z.Ma(r,null,n,l,
f),2==C&&(!k||l[0]<=l[1])&&(C=n[0],D=n[1],C*v<=f&&(1-D)*v<=f))){G=d.Db();continue}}L=!1}G!=d.Db()&&(d.Tb(G),d.ba());break}else G=d.Db(),r=b.pa(G,d.Ta,C,D,t.Db(),t.Ta,L,E),q.Ph.push(r),p.add(p.size)}}if(!x){if(m==q.Ph.length)return!1;1<p.size-m&&p.Gd(m,p.size,e);for(x=0;m<q.Ph.length;m++)if(r=q.Ph[p.get(m)],!(r.ek<x&&r.rj<x)){if(v*(r.ek-x)>f)return!1;x=r.rj;if(v*(1-x)<=f||1==x)break}if(v*(1-x)>f)return!1;m=0;p.resize(0);q.Ph.length=0}}return h};c.$H=function(b,d,f){if(1>c.SB(b,d,f,null))return!1;var e=
new a.h,g=new a.h;b.s(e);d.s(g);var k=c.Yp(e,g,f),e=c.Yp(g,e,f);return k&&e?!0:k&&!e?!c.Wg(d,b,f,!1):e&&!k?!c.Wg(b,d,f,!1):!c.Wg(b,d,f,!1)&&!c.Wg(d,b,f,!1)};c.SB=function(d,g,f,k){function e(a,b){return t.XF(a,b)}var h,n;d.jA()>g.jA()?(h=g,n=d):(h=d,n=g);d=h.Fa();g=n.Fa();var l=[0,0],m=[0,0],p=-1,q=0,r,y=new a.ia(0),t=new c,u,A=new a.h,v=new a.h,w=new a.h;h.s(A);n.s(v);A.O(f,f);v.O(f,f);w.I(A);w.Ma(v);h=null;null!=k&&(h=new a.b);r=v=v=null;var x=n.ob;null!=x?(v=x.Mb,r=x.np,null==v&&(v=a.na.Lj(n,w))):
v=a.na.Lj(n,w);n=v.mf();x=null;for(null!=r&&(x=r.mf());d.Ya();)for(r=0;d.Ea();){var z=d.ba();z.s(A);if(A.Yb(w)&&(null==x||(x.Ni(A,f),-1!=x.next()))){var C=z.Rb();n.Wn(z,f);for(var D=n.next();-1!=D;D=n.next()){var L=v.ja(D);g.Tb(L);u=g.ba();var E=u.Rb(),G=z.Ma(u,null,l,m,f);if(0<G){var D=l[0],p=m[0],I=2==G?l[1]:NaN,J=2==G?m[1]:NaN;if(2==G){if(C*(I-D)>f)return p=1;var K=C*(I-D);if(g.Ea()){u=g.ba();G=z.Ma(u,null,l,null,f);if(2==G){var G=l[0],R=l[1],G=C*(R-G);if(K+G>f)return p=1}g.Tb(L);g.ba()}if(!g.jn()){g.Li();
u=g.Li();G=z.Ma(u,null,l,null,f);if(2==G&&(G=l[0],R=l[1],G=C*(R-G),K+G>f))return p=1;g.Tb(L);g.ba()}if(d.Ea()){L=d.Db();z=d.ba();G=z.Ma(u,null,l,null,f);if(2==G&&(G=l[0],R=l[1],G=C*(R-G),K+G>f))return p=1;d.Tb(L);d.ba()}if(!d.jn()){L=d.Db();d.Li();z=d.Li();G=z.Ma(u,null,l,null,f);if(2==G&&(G=l[0],R=l[1],G=E*(R-G),K+G>f))return p=1;d.Tb(L);d.ba()}u=b.pa(d.Db(),d.Ta,D,I,g.Db(),g.Ta,p,J);t.Ph.push(u);y.add(y.size)}p=0;null!=k&&(z.gc(D,h),k.add(h.x),k.add(h.y))}}if(q<t.Ph.length){y.Gd(q,y.size,e);z=0;
for(D=t.Ph[y.get(q)].zn;q<t.Ph.length;q++)if(u=t.Ph[y.get(q)],!(u.ek<z&&u.rj<z))if(C*(u.ek-z)>f)r=C*(u.rj-u.ek),z=u.rj,D=u.zn;else{u.zn!=D?(r=C*(u.rj-u.ek),D=u.zn):r+=C*(u.rj-u.ek);if(r>f)return p=1;z=u.rj;if(1==z)break}C*(1-z)>f&&(r=0);q=0;y.resize(0);t.Ph.length=0}}}return p};c.fI=function(b,c,d){var e=b.Fa(),f=c.Fa();for(b=new a.Lm(b,c,d,!1);b.next();){c=b.Ql();var g=b.Ml();e.Tb(c);f.Tb(g);c=e.ba();if(0<f.ba().Ma(c,null,null,null,d))return!0}return!1};c.ZH=function(b,c,d,f){var e=b.Fa(),g=new a.h,
k=new a.h,h=new a.h;b.s(g);c.s(k);g.O(d,d);g.contains(k);k.O(d,d);h.I(g);h.Ma(k);g=b.ob;null!=g?(g=g.Mb,null==g&&(g=a.na.Lj(b,h))):g=a.na.Lj(b,h);b=g.mf();for(var n=new a.b,l=new a.b,p=d*d,m=0;m<c.D();m++)if(c.w(m,n),h.contains(n)){k.I(n.x,n.y,n.x,n.y);b.Ni(k,d);for(var q=!1,r=b.next();-1!=r;r=b.next())if(e.Tb(g.ja(r)),r=e.ba(),r.gc(r.qe(n,!1),l),a.b.sc(l,n)<=p){q=!0;break}if(f){if(!q)return!1}else if(q)return!0}return f?!0:!1};c.IA=function(b,c,d){var e=new a.b,f=d*d,g=b.Fa();b=b.ob;if(null!=b&&
(b=b.Mb,null!=b)){var k=new a.h;k.I(c);d=b.Yz(k,d);for(k=d.next();-1!=k;k=d.next())if(g.Tb(b.ja(k)),g.Ea()){var k=g.ba(),h=k.qe(c,!1);k.gc(h,e);if(a.b.sc(c,e)<=f)return!0}return!1}for(b=new a.h;g.Ya();)for(;g.Ea();)if(k=g.ba(),k.s(b),b.O(d,d),b.contains(c)&&(h=k.qe(c,!1),k.gc(h,e),a.b.sc(c,e)<=f))return!0;return!1};c.yH=function(a,b,d){return c.IA(a,b,d)&&!c.hC(a,b,d)};c.hC=function(a,b,d){a=a.Gg();return!c.$t(a,b,d)};c.XH=function(b,c,d){if(b.hn()){var e=new a.Hb(c.o,c.A,c.o,c.B),f=new a.Hb(c.o,
c.B,c.v,c.B),g=new a.Hb(c.v,c.B,c.v,c.A);c=new a.Hb(c.v,c.A,c.o,c.A);for(b=b.Fa();b.Ya();)for(;b.Ea();){var k=b.ba();if(k.Yb(e,d)||k.Yb(f,d)||k.Yb(g,d)||k.Yb(c,d))return!0}}else{e=new a.h;e.I(c);e.O(d,d);d=b.Pa(0);f=new a.b;g=new a.b;c=new a.b;for(var k=new a.b,h=0,n=b.aa();h<n;h++)for(var l=!0,p=b.wa(h),m=b.Gc(h);p<m;p++)if(l)d.fc(2*p,g),l=!1;else{d.fc(2*p,f);c.L(g);k.L(f);if(0!=e.gz(c,k))return!0;g.L(f)}}return!1};c.vc=function(b,d,f){var e=b.G(),g=d.G();if(a.T.gh(e)){var k=b.ob;if(null!=k&&(k=
k.Hi,null!=k))if(33==g){var h=d.w(),h=k.rm(h.x,h.y);if(1==h)return 1;if(0==h)return 4}else{h=new a.h;d.s(h);h=k.Rn(h);if(1==h)return 1;if(0==h)return 4;if(f&&a.T.gh(g)&&c.$C(d,k))return 1073741824}}if(a.T.gh(g)&&(k=d.ob,null!=k&&(k=k.Hi,null!=k)))if(33==e){b=b.w();h=k.rm(b.x,b.y);if(1==h)return 2;if(0==h)return 4}else{d=new a.h;b.s(d);h=k.Rn(d);if(1==h)return 2;if(0==h)return 4;if(f&&a.T.gh(e)&&c.$C(b,k))return 1073741824}return 0};c.$C=function(b,c){for(var d=b.D(),e=new a.b,f=0;f<d;f++)if(b.w(f,
e),1==c.rm(e.x,e.y))return!0;return!1};c.iD=function(b,c,d,f){for(var e=1<=b.Kk(0)&&1<=c.Kk(0),g=b.Fa(),k=c.Fa(),h=[0,0],n=[0,0],l=new a.Lm(b,c,d,!1),p=!1;l.next();){var m=l.Ql(),q=l.Ml();g.Tb(m);k.Tb(q);m=g.ba();q=k.ba().Ma(m,null,n,h,d);if(2==q){p=h[0];q=h[1];m=m.Rb();if(e&&(q-p)*m>d)return!1;p=!0}else if(0!=q){p=h[0];m=n[0];if(0<p&&1>p&&0<m&&1>m)return!1;p=!0}}if(!p)return!1;g=new a.h;k=new a.h;e=new a.h;b.s(g);c.s(k);g.O(1E3*d,1E3*d);k.O(1E3*d,1E3*d);e.I(g);e.Ma(k);return 10<b.D()&&(b=a.ne.clip(b,
e,d,0),b.u())||10<c.D()&&(c=a.ne.clip(c,e,d,0),c.u())?!1:a.Nm.gu(b,c,d,"F********",f)};c.dD=function(b,d,f,k){var e=1<=b.Kk(0)&&1<=d.Kk(0),g=new a.h,h=new a.h,n=new a.h;b.s(g);d.s(h);for(var l=!1,p=c.Yp(g,h,f),m=c.Yp(h,g,f),q=b.Fa(),r=d.Fa(),y=[0,0],t=[0,0],u=new a.Lm(b,d,f,!1);u.next();){var A=u.Ql(),v=u.Ml();q.Tb(A);r.Tb(v);v=q.ba();A=r.ba().Ma(v,null,t,y,f);if(2==A){var A=y[0],w=y[1],v=v.Rb();if(e&&(w-A)*v>f&&(l=!0,p&&m))return!0}else if(0!=A&&(A=y[0],v=t[0],0<A&&1>A&&0<v&&1>v))return!0}e=new a.h;
q=new a.h;e.I(g);e.O(1E3*f,1E3*f);q.I(h);q.O(1E3*f,1E3*f);n.I(e);n.Ma(q);g="";g=l?g+"**":g+"T*";if(p){if(10<d.D()&&(d=a.ne.clip(d,n,f,0),d.u()))return!1;g+="****"}else g+="T***";if(m){if(10<b.D()&&(b=a.ne.clip(b,n,f,0),b.u()))return!1;g+="***"}else g+="T**";return a.Nm.gu(b,d,f,g.toString(),k)};c.CL=function(b,d,f,k){var e=[!1],g=c.zL(b,d,f,e);if(e[0])return g;e=new a.h;d.s(e);e.O(1E3*f,1E3*f);return 10<b.D()&&(b=a.ne.clip(b,e,f,0),b.u())?!1:a.Nm.Ex(b,d,f,k)};c.zL=function(b,c,d,f){f[0]=!1;for(var e=
b.Fa(),g=c.Fa(),k=[0,0],h=[0,0],n=new a.Lm(b,c,d,!1),l=!1;n.next();){var p=n.Ql(),m=n.Ml();e.Tb(p,-1);g.Tb(m,-1);p=e.ba();p=g.ba().Ma(p,null,h,k,d);if(0!=p&&(l=!0,1==p&&(p=k[0],m=h[0],0<p&&1>p&&0<m&&1>m)))return f[0]=!0,!1}if(!l){f[0]=!0;k=new a.h;b.s(k);k.O(d,d);n=b;l=!1;h=new a.h;f=0;for(e=c.aa();f<e;f++)if(0<c.La(f)){c.jk(f,h);if(k.Yb(h)){if(g=c.Ba(c.wa(f)),g=a.ff.kn(n,g,0),0==g)return!1}else return!1;l||(!a.ff.qm(b,c.aa()-1)||null!=b.ob&&null!=b.ob.Mb?n=b:(g=new a.Ja,b.copyTo(g),g.Hj(1),n=g),
l=!0)}if(1==b.aa()||1607==c.G())return!0;k=new a.h;c.s(k);k.O(d,d);h=c;n=!1;d=new a.h;f=0;for(e=b.aa();f<e;f++)if(0<b.La(f)){b.jk(f,d);if(k.Yb(d)&&(g=b.Ba(b.wa(f)),g=a.ff.kn(h,g,0),1==g))return!1;n||(!a.ff.qm(c,b.aa()-1)||null!=c.ob&&null!=c.ob.Mb?h=c:(g=new a.Ja,c.copyTo(g),g.Hj(1),h=g),n=!0)}return!0}return!1};c.kD=function(b,c,d,f){for(var e=b.Fa(),g=c.Fa(),k=[0,0],h=[0,0],n=new a.Lm(b,c,d,!1),l=!1;n.next();){var p=n.Ql(),m=n.Ml();e.Tb(p);g.Tb(m);p=e.ba();p=g.ba().Ma(p,null,h,k,d);if(2==p)l=!0;
else if(0!=p){l=k[0];p=h[0];if(0<l&&1>l&&0<p&&1>p)return!1;l=!0}}if(!l)return!1;g=new a.h;k=new a.h;e=new a.h;b.s(g);c.s(k);g.O(1E3*d,1E3*d);k.O(1E3*d,1E3*d);e.I(g);e.Ma(k);return 10<b.D()&&(b=a.ne.clip(b,e,d,0),b.u())||10<c.D()&&(c=a.ne.clip(c,e,d,0),c.u())?!1:a.Nm.On(b,c,d,"F********",f)};c.bD=function(b,d,f,k){for(var e=b.Fa(),g=d.Fa(),h=[0,0],n=[0,0],l=new a.Lm(b,d,f,!1),p=!1;l.next();){var m=l.Ql(),q=l.Ml();e.Tb(m);g.Tb(q);m=e.ba();m=g.ba().Ma(m,null,n,h,f);if(2==m)p=!0;else if(0!=m){p=h[0];
m=n[0];if(0<p&&1>p&&0<m&&1>m)return!0;p=!0}}if(!p)return!1;g=new a.h;h=new a.h;n=new a.h;l=new a.h;e=new a.h;b.s(g);d.s(h);return c.Yp(h,g,f)?(n.I(g),n.O(1E3*f,1E3*f),l.I(h),l.O(1E3*f,1E3*f),e.I(n),e.Ma(l),10<b.D()&&(b=a.ne.clip(b,e,f,0),b.u())||10<d.D()&&(d=a.ne.clip(d,e,f,0),d.u())?!1:f=a.Nm.On(b,d,f,"T********",k)):f=a.Nm.On(b,d,f,"T*****T**",k)};c.DL=function(b,d,f,k){var e=[!1],g=c.zL(b,d,f,e);if(e[0])return g;e=new a.h;d.s(e);e.O(1E3*f,1E3*f);return 10<b.D()&&(b=a.ne.clip(b,e,f,0),b.u())?!1:
a.Nm.MB(b,d,f,k)};c.BL=function(b,c,d){return 1==a.gd.ge(b,c,d)?!0:!1};c.fD=function(b,c,d){return 2==a.gd.ge(b,c,d)?!0:!1};c.$t=function(b,c,d){var e=new a.b;d*=d;for(var f=0;f<b.D();f++)if(b.w(f,e),a.b.sc(e,c)<=d)return!1;return!0};c.prototype.XF=function(a,b){a=this.Ph[a];b=this.Ph[b];return a.zn<b.zn||a.zn==b.zn&&(a.bx<b.bx||a.bx==b.bx&&(a.ek<b.ek||a.ek==b.ek&&(a.rj<b.rj||a.rj==b.rj&&a.RI<b.RI)))?-1:1};return c}();a.Fd=c})(x||(x={}));(function(a){var b;(function(a){a[a.InteriorInterior=0]="InteriorInterior";
a[a.InteriorBoundary=1]="InteriorBoundary";a[a.InteriorExterior=2]="InteriorExterior";a[a.BoundaryInterior=3]="BoundaryInterior";a[a.BoundaryBoundary=4]="BoundaryBoundary";a[a.BoundaryExterior=5]="BoundaryExterior";a[a.ExteriorInterior=6]="ExteriorInterior";a[a.ExteriorBoundary=7]="ExteriorBoundary";a[a.ExteriorExterior=8]="ExteriorExterior"})(b||(b={}));var c;(function(a){a[a.AreaAreaPredicates=0]="AreaAreaPredicates";a[a.AreaLinePredicates=1]="AreaLinePredicates";a[a.LineLinePredicates=2]="LineLinePredicates";
a[a.AreaPointPredicates=3]="AreaPointPredicates";a[a.LinePointPredicates=4]="LinePointPredicates";a[a.PointPointPredicates=5]="PointPointPredicates"})(c||(c={}));b=function(){function b(){this.Ie=0;this.i=new a.Qu;this.H=[0,0,0,0,0,0,0,0,0];this.eb=[0,0,0,0,0,0,0,0,0];this.ga=[!1,!1,!1,!1,!1,!1,!1,!1,!1];this.Fn=this.jx=-1}b.ZB=function(b,c,d,f,k){if(9!=f.length)throw a.g.X("relation string length has to be 9 characters");for(var e=0;9>e;e++){var g=f.charAt(e);if("*"!=g&&"T"!=g&&"F"!=g&&"0"!=g&&"1"!=
g&&"2"!=g)throw a.g.X("relation string");}e=this.GT(f,b.tb(),c.tb());if(0!=e)return a.Fd.$B(b,c,d,e,k);e=new a.h;b.s(e);g=new a.h;c.s(g);var h=new a.h;h.I(e);h.Nb(g);d=a.na.be(d,h,!1);b=this.cG(b,d);c=this.cG(c,d);if(b.u()||c.u())return this.tX(b,c,f);e=c.G();g=!1;switch(b.G()){case 1736:switch(e){case 1736:g=this.gu(b,c,d,f,k);break;case 1607:g=this.On(b,c,d,f,k);break;case 33:g=this.fu(b,c,d,f,k);break;case 550:g=this.eu(b,c,d,f,k)}break;case 1607:switch(e){case 1736:g=this.On(c,b,d,this.Pq(f),
k);break;case 1607:g=this.NB(b,c,d,f,k);break;case 33:g=this.iu(b,c,d,f,k);break;case 550:g=this.hu(b,c,d,f,k)}break;case 33:switch(e){case 1736:g=this.fu(c,b,d,this.Pq(f),k);break;case 1607:g=this.iu(c,b,d,this.Pq(f),k);break;case 33:g=this.HW(b,c,d,f);break;case 550:g=this.au(c,b,d,this.Pq(f),k)}break;case 550:switch(e){case 1736:g=this.eu(c,b,d,this.Pq(f),k);break;case 1607:g=this.hu(c,b,d,this.Pq(f),k);break;case 550:g=this.EB(b,c,d,f,k);break;case 33:g=this.au(b,c,d,f,k)}break;default:g=!1}return g};
b.gu=function(c,d,f,k,h){var e=new b;e.xj();e.Bj(k);e.oK();var g=new a.h,n=new a.h;c.s(g);d.s(n);k=!1;a.Fd.Dk(g,n,f)&&(e.mv(c,d),k=!0);k||(g=a.Fd.vc(c,d,!1),4==g?(e.mv(c,d),k=!0):1==g?(e.Sy(d),k=!0):2==g&&(e.mF(c),k=!0));k||(k=new a.fd,c=k.Jb(c),d=k.Jb(d),e.Fp(k,f,h),e.tq(c,d),e.i.qh());return b.zg(e.H,e.dd)};b.Ex=function(c,d,f,k){var e=new b;e.xj();e.Bj("T*****F**");e.oK();var g=new a.h,h=new a.h;c.s(g);d.s(h);var n=!1;a.Fd.Dk(g,h,f)&&(e.mv(c,d),n=!0);n||(g=a.Fd.vc(c,d,!1),4==g?(e.mv(c,d),n=!0):
1==g?(e.Sy(d),n=!0):2==g&&(e.mF(c),n=!0));if(n)return g=this.zg(e.H,e.dd);n=new a.fd;c=n.Jb(c);g=n.Jb(d);a.sk.V(n,f,k,!1);f=n.Se(g).Gg();n.zq(0,!0,!0);a.lo.V(n,c,-1,!1,k);if(0==n.D(c))return!1;a.lo.V(n,g,-1,!1,k);e.Yr(n,k);d=0==n.D(g);if(!d&&(e.tq(c,g),e.i.qh(),g=this.zg(e.H,e.dd),!g))return g;c=n.Se(c);n=new a.fd;c=n.Jb(c);g=n.Jb(f);e.Yr(n,k);e.Ie=0;e.xj();e.Bj(d?"T*****F**":"******F**");e.iC();e.tq(c,g);e.i.qh();return g=this.zg(e.H,e.dd)};b.On=function(c,d,f,k,h){var e=new b;e.xj();e.Bj(k);e.iC();
var g=new a.h,n=new a.h;c.s(g);d.s(n);k=!1;a.Fd.Dk(g,n,f)&&(e.nv(c,d),k=!0);k||(g=a.Fd.vc(c,d,!1),4==g?(e.nv(c,d),k=!0):1==g&&(e.nF(d),k=!0));k||(k=new a.fd,c=k.Jb(c),d=k.Jb(d),e.Fp(k,f,h),e.Fh=e.i.wq(),b.pv(d,e.i,e.Fh),e.tq(c,d),e.i.xq(e.Fh),e.i.qh());return b.zg(e.H,e.dd)};b.MB=function(c,d,f,k){var e=new b;e.xj();e.Bj("T*****F**");e.iC();var g=new a.h,h=new a.h;c.s(g);d.s(h);var n=!1;a.Fd.Dk(g,h,f)&&(e.nv(c,d),n=!0);n||(g=a.Fd.vc(c,d,!1),4==g?(e.nv(c,d),n=!0):1==g&&(e.nF(d),n=!0));if(n)return f=
this.zg(e.H,e.dd);n=new a.fd;c=n.Jb(c);d=n.Jb(d);e.Fp(n,f,k);if(0==n.D(c))return!1;e.tq(c,d);e.i.qh();return f=this.zg(e.H,e.dd)};b.eu=function(c,d,f,k,h){var e=new b;e.xj();e.Bj(k);e.pK();var g=new a.h,n=new a.h;c.s(g);d.s(n);k=!1;a.Fd.Dk(g,n,f)&&(e.ov(c),k=!0);k||(g=a.Fd.vc(c,d,!1),4==g?(e.ov(c),k=!0):1==g&&(e.CP(),k=!0));k||(k=new a.fd,c=k.Jb(c),d=k.Jb(d),e.Fp(k,f,h),e.lz(c,d),e.i.qh());return b.zg(e.H,e.dd)};b.NB=function(c,d,f,k,h){var e=new b;e.xj();e.Bj(k);e.$X();k=new a.h;var g=new a.h;c.s(k);
d.s(g);var n=!1;a.Fd.Dk(k,g,f)&&(e.dI(c,d),n=!0);n||4!=a.Fd.vc(c,d,!1)||(e.dI(c,d),n=!0);n||(k=new a.fd,c=k.Jb(c),d=k.Jb(d),e.Fp(k,f,h),e.xi=e.i.wq(),e.Fh=e.i.wq(),b.pv(c,e.i,e.xi),b.pv(d,e.i,e.Fh),e.tq(c,d),e.i.xq(e.xi),e.i.xq(e.Fh),e.i.qh());return b.zg(e.H,e.dd)};b.hu=function(c,d,f,k,h){var e=new b;e.xj();e.Bj(k);e.DK();k=new a.h;var g=new a.h;c.s(k);d.s(g);var n=!1;a.Fd.Dk(k,g,f)&&(e.HA(c),n=!0);n||4!=a.Fd.vc(c,d,!1)||(e.HA(c),n=!0);n||(k=new a.fd,c=k.Jb(c),d=k.Jb(d),e.Fp(k,f,h),e.xi=e.i.wq(),
b.pv(c,e.i,e.xi),e.lz(c,d),e.i.xq(e.xi),e.i.qh());return b.zg(e.H,e.dd)};b.EB=function(c,d,f,k,h){var e=new b;e.xj();e.Bj(k);e.IK();k=new a.h;var g=new a.h;c.s(k);d.s(g);var n=!1;a.Fd.Dk(k,g,f)&&(e.GJ(),n=!0);n||(k=new a.fd,c=k.Jb(c),d=k.Jb(d),e.Fp(k,f,h),e.lz(c,d),e.i.qh());return b.zg(e.H,e.dd)};b.fu=function(c,d,f,k){var e=new b;e.xj();e.Bj(k);e.pK();var g=new a.h;c.s(g);d=d.w();var h=!1;a.Fd.Dx(d,g,f)&&(e.ov(c),h=!0);h||(f=a.gd.ge(c,d,f),1==f?(e.H[0]=0,e.H[2]=2,e.H[3]=-1,e.H[5]=1,e.H[6]=-1):2==
f?(e.H[6]=-1,0!=c.hf()?(e.H[0]=-1,e.H[3]=0,e.H[2]=2,e.H[5]=1):(e.H[0]=0,e.H[3]=-1,e.H[5]=-1,f=new a.h,c.s(f),e.H[2]=0==f.fa()&&0==f.N()?-1:1)):e.ov(c));return this.zg(e.H,k)};b.iu=function(c,d,f,k,h){var e=new b;e.xj();e.Bj(k);e.DK();var g=new a.h;c.s(g);k=d.w();var n=!1;a.Fd.Dx(k,g,f)&&(e.HA(c),n=!0);if(!n){var g=null,l=n=!1;if(e.ga[0]||e.ga[6])a.Fd.IA(c,k,f)?(e.ga[0]&&(g=a.Pi.Rm(c,h),l=!a.Fd.$t(g,k,f),n=!0,e.H[0]=l?-1:0),e.H[6]=-1):(e.H[0]=-1,e.H[6]=0);e.ga[3]&&(null!=g&&g.u()?e.H[3]=-1:(n||(null==
g&&(g=a.Pi.Rm(c,h)),l=!a.Fd.$t(g,k,f),n=!0),e.H[3]=l?0:-1));e.ga[5]&&(null!=g&&g.u()?e.H[5]=-1:n&&!l?e.H[5]=0:(null==g&&(g=a.Pi.Rm(c,h)),h=a.Fd.zx(g,d,f),e.H[5]=h?-1:0));e.ga[2]&&(0!=c.Rb()?e.H[2]=1:(h=new a.Ed(c.description),h.Id(c,0,c.D()),c=a.Fd.zx(h,d,f),e.H[2]=c?-1:0))}return this.zg(e.H,e.dd)};b.au=function(c,d,f,k){var e=new b;e.xj();e.Bj(k);e.IK();var g=new a.h;c.s(g);d=d.w();var h=!1;a.Fd.Dx(d,g,f)&&(e.GJ(),h=!0);if(!h){g=!1;h=!0;f*=f;for(var n=0;n<c.D();n++){var l=c.Ba(n);a.b.sc(l,d)<=f?
g=!0:h=!1;if(g&&!h)break}g?(e.H[0]=0,e.H[2]=h?-1:0,e.H[6]=-1):(e.H[0]=-1,e.H[2]=0,e.H[6]=0)}return b.zg(e.H,k)};b.HW=function(c,d,f,k){c=c.w();d=d.w();for(var e=[],g=0;9>g;g++)e[g]=-1;a.b.sc(c,d)<=f*f?e[0]=0:(e[2]=0,e[6]=0);e[8]=2;return b.zg(e,k)};b.zg=function(a,b){for(var c=0;9>c;c++)switch(b.charAt(c)){case "T":if(-1==a[c])return!1;break;case "F":if(-1!=a[c])return!1;break;case "0":if(0!=a[c])return!1;break;case "1":if(1!=a[c])return!1;break;case "2":if(2!=a[c])return!1}return!0};b.tX=function(b,
c,d){var e=[-1,-1,-1,-1,-1,-1,-1,-1,-1];if(b.u()&&c.u()){for(var f=0;9>f;f++)e[f]=-1;return this.zg(e,d)}f=!1;b.u()&&(b=c,f=!0);e[0]=-1;e[1]=-1;e[3]=-1;e[4]=-1;e[6]=-1;e[7]=-1;e[8]=2;c=b.G();a.T.Ic(c)?1736==c?0!=b.hf()?(e[2]=2,e[5]=1):(e[5]=-1,c=new a.h,b.s(c),e[2]=0==c.fa()&&0==c.N()?0:1):(c=0!=b.Rb(),e[2]=c?1:0,e[5]=a.Pi.Rq(b)?0:-1):(e[2]=0,e[5]=-1);f&&this.kL(e);return this.zg(e,d)};b.GT=function(a,c,d){return b.lQ(a)?3:b.tO(a)?4:b.hU(a,c,d)?8:b.kO(a,c,d)?16:b.PN(a)?1:b.$M(a,c,d)?32:0};b.lQ=function(a){return"T"==
a.charAt(0)&&"*"==a.charAt(1)&&"F"==a.charAt(2)&&"*"==a.charAt(3)&&"*"==a.charAt(4)&&"F"==a.charAt(5)&&"F"==a.charAt(6)&&"F"==a.charAt(7)&&"*"==a.charAt(8)?!0:!1};b.tO=function(a){return"F"==a.charAt(0)&&"F"==a.charAt(1)&&"*"==a.charAt(2)&&"F"==a.charAt(3)&&"F"==a.charAt(4)&&"*"==a.charAt(5)&&"*"==a.charAt(6)&&"*"==a.charAt(7)&&"*"==a.charAt(8)?!0:!1};b.hU=function(a,b,c){if(0==b&&0==c)return!1;if(2!=b||2!=c)if("F"==a.charAt(0)&&"*"==a.charAt(1)&&"*"==a.charAt(2)&&"T"==a.charAt(3)&&"*"==a.charAt(4)&&
"*"==a.charAt(5)&&"*"==a.charAt(6)&&"*"==a.charAt(7)&&"*"==a.charAt(8)||1==b&&1==c&&"F"==a.charAt(0)&&"T"==a.charAt(1)&&"*"==a.charAt(2)&&"*"==a.charAt(3)&&"*"==a.charAt(4)&&"*"==a.charAt(5)&&"*"==a.charAt(6)&&"*"==a.charAt(7)&&"*"==a.charAt(8))return!0;return 0!=c&&"F"==a.charAt(0)&&"*"==a.charAt(1)&&"*"==a.charAt(2)&&"*"==a.charAt(3)&&"T"==a.charAt(4)&&"*"==a.charAt(5)&&"*"==a.charAt(6)&&"*"==a.charAt(7)&&"*"==a.charAt(8)?!0:!1};b.kO=function(a,b,c){return b>c?"T"==a.charAt(0)&&"*"==a.charAt(1)&&
"*"==a.charAt(2)&&"*"==a.charAt(3)&&"*"==a.charAt(4)&&"*"==a.charAt(5)&&"T"==a.charAt(6)&&"*"==a.charAt(7)&&"*"==a.charAt(8)?!0:!1:1==b&&1==c&&"0"==a.charAt(0)&&"*"==a.charAt(1)&&"*"==a.charAt(2)&&"*"==a.charAt(3)&&"*"==a.charAt(4)&&"*"==a.charAt(5)&&"*"==a.charAt(6)&&"*"==a.charAt(7)&&"*"==a.charAt(8)?!0:!1};b.PN=function(a){return"T"==a.charAt(0)&&"*"==a.charAt(1)&&"*"==a.charAt(2)&&"*"==a.charAt(3)&&"*"==a.charAt(4)&&"*"==a.charAt(5)&&"F"==a.charAt(6)&&"F"==a.charAt(7)&&"*"==a.charAt(8)?!0:!1};
b.$M=function(a,b,c){if(b==c){if(1!=b)return"T"==a.charAt(0)&&"*"==a.charAt(1)&&"T"==a.charAt(2)&&"*"==a.charAt(3)&&"*"==a.charAt(4)&&"*"==a.charAt(5)&&"T"==a.charAt(6)&&"*"==a.charAt(7)&&"*"==a.charAt(8)?!0:!1;if("1"==a.charAt(0)&&"*"==a.charAt(1)&&"T"==a.charAt(2)&&"*"==a.charAt(3)&&"*"==a.charAt(4)&&"*"==a.charAt(5)&&"T"==a.charAt(6)&&"*"==a.charAt(7)&&"*"==a.charAt(8))return!0}return!1};b.pv=function(a,b,c){a=b.Ia(a);for(var d=b.rf;-1!=d;d=b.og(d))if(0!=(b.Md(d)&a)){var e=b.kf(d);if(-1==e)b.co(d,
c,0);else{var f=e,g=0;do 0!=(b.Ah(f)&a)&&g++,f=b.qc(b.Aa(f));while(f!=e);b.co(d,c,g)}}};b.Pq=function(a){var b;b=""+a.charAt(0);b+=a.charAt(3);b+=a.charAt(6);b+=a.charAt(1);b+=a.charAt(4);b+=a.charAt(7);b+=a.charAt(2);b+=a.charAt(5);return b+=a.charAt(8)};b.prototype.xj=function(){for(var a=0;9>a;a++)this.H[a]=-2,this.eb[a]=-2};b.kL=function(a){var b=a[1],c=a[2],d=a[5];a[1]=a[3];a[2]=a[6];a[5]=a[7];a[3]=b;a[6]=c;a[7]=d};b.prototype.Bj=function(a){this.dd=a;for(a=0;9>a;a++)"*"!=this.dd.charAt(a)?(this.ga[a]=
!0,this.Ie++):this.ga[a]=!1};b.prototype.LK=function(){for(var a=0;9>a;a++)this.ga[a]&&-2==this.H[a]&&(this.H[a]=-1,this.ga[a]=!1)};b.prototype.uc=function(a){if(-2==this.H[a])return!1;if(-1==this.H[a])return this.ga[a]=!1,this.Ie--,!0;if("T"!=this.dd.charAt(a)&&"F"!=this.dd.charAt(a)){if(this.H[a]<this.eb[a])return!1;this.ga[a]=!1;this.Ie--;return!0}this.ga[a]=!1;this.Ie--;return!0};b.prototype.oK=function(){this.jx=0;this.eb[0]=2;this.eb[1]=1;this.eb[2]=2;this.eb[3]=1;this.eb[4]=1;this.eb[5]=1;
this.eb[6]=2;this.eb[7]=1;this.eb[8]=2;this.ga[8]&&(this.H[8]=2,this.ga[8]=!1,this.Ie--)};b.prototype.iC=function(){this.jx=1;this.Fn=3;this.eb[0]=1;this.eb[1]=0;this.eb[2]=2;this.eb[3]=1;this.eb[4]=0;this.eb[5]=1;this.eb[6]=1;this.eb[7]=0;this.eb[8]=2;this.ga[8]&&(this.H[8]=2,this.ga[8]=!1,this.Ie--)};b.prototype.$X=function(){this.jx=2;this.Fn=4;this.eb[0]=1;this.eb[1]=0;this.eb[2]=1;this.eb[3]=0;this.eb[4]=0;this.eb[5]=0;this.eb[6]=1;this.eb[7]=0;this.eb[8]=2;this.ga[8]&&(this.H[8]=2,this.ga[8]=
!1,this.Ie--)};b.prototype.pK=function(){this.Fn=3;this.eb[0]=0;this.eb[1]=-1;this.eb[2]=2;this.eb[3]=0;this.eb[4]=-1;this.eb[5]=1;this.eb[6]=0;this.eb[7]=-1;this.eb[8]=2;this.ga[1]&&(this.H[1]=-1,this.ga[1]=!1,this.Ie--);this.ga[4]&&(this.H[4]=-1,this.ga[4]=!1,this.Ie--);this.ga[7]&&(this.H[7]=-1,this.ga[7]=!1,this.Ie--);this.ga[8]&&(this.H[8]=2,this.ga[8]=!1,this.Ie--)};b.prototype.DK=function(){this.Fn=4;this.eb[0]=0;this.eb[1]=-1;this.eb[2]=1;this.eb[3]=0;this.eb[4]=-1;this.eb[5]=0;this.eb[6]=
0;this.eb[7]=-1;this.eb[8]=2;this.ga[1]&&(this.H[1]=-1,this.ga[1]=!1,this.Ie--);this.ga[4]&&(this.H[4]=-1,this.ga[4]=!1,this.Ie--);this.ga[7]&&(this.H[7]=-1,this.ga[7]=!1,this.Ie--);this.ga[8]&&(this.H[8]=2,this.ga[8]=!1,this.Ie--)};b.prototype.IK=function(){this.Fn=5;this.eb[0]=0;this.eb[1]=-1;this.eb[2]=0;this.eb[3]=-1;this.eb[4]=-1;this.eb[5]=-1;this.eb[6]=0;this.eb[7]=-1;this.eb[8]=2;this.ga[1]&&(this.H[1]=-1,this.ga[1]=!1,this.Ie--);this.ga[3]&&(this.H[3]=-1,this.ga[3]=!1,this.Ie--);this.ga[4]&&
(this.H[4]=-1,this.ga[4]=!1,this.Ie--);this.ga[5]&&(this.H[5]=-1,this.ga[5]=!1,this.Ie--);this.ga[7]&&(this.H[7]=-1,this.ga[7]=!1,this.Ie--);this.ga[8]&&(this.H[8]=2,this.ga[8]=!1,this.Ie--)};b.prototype.AP=function(a,b,c){var d=!0;this.ga[0]&&(this.yU(a,b,c),d=d&&this.uc(0));this.ga[1]&&(this.FH(a,b,1),d=d&&this.uc(1));this.ga[2]&&(this.GH(a,b,c,2),d=d&&this.uc(2));this.ga[3]&&(this.FH(a,c,3),d=d&&this.uc(3));this.ga[4]&&(this.GP(a,b,c),d=d&&this.uc(4));this.ga[5]&&(this.sF(a,c,5),d=d&&this.uc(5));
this.ga[6]&&(this.GH(a,c,b,6),d=d&&this.uc(6));this.ga[7]&&(this.sF(a,b,7),d=d&&this.uc(7));return d};b.prototype.mv=function(a,b){this.H[0]=-1;this.H[1]=-1;this.H[3]=-1;this.H[4]=-1;this.Ds(a,this.ga[2]?2:-1,this.dd.charAt(2),this.ga[5]?5:-1,this.dd.charAt(5));this.Ds(b,this.ga[6]?6:-1,this.dd.charAt(6),this.ga[7]?7:-1,this.dd.charAt(7))};b.prototype.Ds=function(b,c,d,f,k){if(-1!=c||-1!=f)("T"!=d&&"F"!=d&&-1!=c||"T"!=k&&"F"!=k&&-1!=f?0!=b.hf():1)?(-1!=c&&(this.H[c]=2),-1!=f&&(this.H[f]=1)):(-1!=
f&&(this.H[f]=-1),-1!=c&&(d=new a.h,b.s(d),this.H[c]=0==d.fa()&&0==d.N()?0:1))};b.prototype.Sy=function(a){this.H[2]=2;this.H[3]=-1;this.H[4]=-1;this.H[5]=1;this.H[6]=-1;this.H[7]=-1;this.Ds(a,this.ga[0]?0:-1,this.dd.charAt(0),this.ga[1]?1:-1,this.dd.charAt(1))};b.prototype.mF=function(a){this.Sy(a);b.kL(this.H)};b.prototype.nv=function(b,c){this.H[0]=-1;this.H[1]=-1;this.H[3]=-1;this.H[4]=-1;if(this.ga[6]){var d=this.dd.charAt(6),d="T"!=d&&"F"!=d?0!=c.Rb():!0;this.H[6]=d?1:0}this.ga[7]&&(d=a.Pi.Rq(c),
this.H[7]=d?0:-1);this.Ds(b,this.ga[2]?2:-1,this.dd.charAt(2),this.ga[5]?5:-1,this.dd.charAt(5))};b.prototype.nF=function(b){if(this.ga[0]){var c=this.dd.charAt(0),c="T"!=c&&"F"!=c?0!=b.Rb():!0;this.H[0]=c?1:0}this.ga[1]&&(b=a.Pi.Rq(b),this.H[1]=b?0:-1);this.H[2]=2;this.H[3]=-1;this.H[4]=-1;this.H[5]=1;this.H[6]=-1;this.H[7]=-1};b.prototype.ov=function(a){this.H[0]=-1;this.H[3]=-1;this.H[6]=0;this.Ds(a,this.ga[2]?2:-1,this.dd.charAt(2),this.ga[5]?5:-1,this.dd.charAt(5))};b.prototype.CP=function(){this.H[0]=
0;this.H[2]=2;this.H[3]=-1;this.H[5]=1;this.H[6]=-1};b.prototype.dI=function(b,c){this.H[0]=-1;this.H[1]=-1;this.H[3]=-1;this.H[4]=-1;if(this.ga[2]){var d=this.dd.charAt(2),d="T"!=d&&"F"!=d?0!=b.Rb():!0;this.H[2]=d?1:0}this.ga[5]&&(d=a.Pi.Rq(b),this.H[5]=d?0:-1);this.ga[6]&&(d=this.dd.charAt(6),d="T"!=d&&"F"!=d?0!=c.Rb():!0,this.H[6]=d?1:0);this.ga[7]&&(d=a.Pi.Rq(c),this.H[7]=d?0:-1)};b.prototype.HA=function(b){this.H[0]=-1;this.H[3]=-1;if(this.ga[2]){var c=this.dd.charAt(2),c="T"!=c&&"F"!=c?0!=b.Rb():
!0;this.H[2]=c?1:0}this.ga[5]&&(b=a.Pi.Rq(b),this.H[5]=b?0:-1);this.H[6]=0};b.prototype.GJ=function(){this.H[0]=-1;this.H[2]=0;this.H[6]=0};b.prototype.BP=function(a,b,c){var d=!0;this.ga[0]&&(this.zU(a,b),d=d&&this.uc(0));this.ga[1]&&(this.vU(a,b,c,this.Fh),d=d&&this.uc(1));this.ga[2]&&(this.wU(a,b),d=d&&this.uc(2));this.ga[3]&&(this.KP(a,b,c,this.Fh),d=d&&this.uc(3));this.ga[4]&&(this.HP(a,b,c,this.Fh),d=d&&this.uc(4));this.ga[5]&&(this.IP(a,b,c),d=d&&this.uc(5));this.ga[6]&&(this.eS(a,b),d=d&&
this.uc(6));this.ga[7]&&(this.dS(a,b,c,this.Fh),d=d&&this.uc(7));return d};b.prototype.oV=function(a,b,c){var d=!0;this.ga[0]&&(this.CU(a,b,c,this.xi,this.Fh),d=d&&this.uc(0));this.ga[1]&&(this.HH(a,b,c,this.xi,this.Fh,1),d=d&&this.uc(1));this.ga[2]&&(this.IH(a,b,c,2),d=d&&this.uc(2));this.ga[3]&&(this.HH(a,c,b,this.Fh,this.xi,3),d=d&&this.uc(3));this.ga[4]&&(this.MP(a,b,c,this.xi,this.Fh),d=d&&this.uc(4));this.ga[5]&&(this.tF(a,c,this.xi,5),d=d&&this.uc(5));this.ga[6]&&(this.IH(a,c,b,6),d=d&&this.uc(6));
this.ga[7]&&(this.tF(a,b,this.Fh,7),d=d&&this.uc(7));return d};b.prototype.oF=function(a,b,c){var d=!0;this.ga[0]&&(this.AU(a,b),d=d&&this.uc(0));this.ga[2]&&(this.xU(a,b),d=d&&this.uc(2));this.ga[3]&&(this.LP(a,b,c),d=d&&this.uc(3));this.ga[5]&&(this.JP(a,b),d=d&&this.uc(5));this.ga[6]&&(this.fS(a,b),d=d&&this.uc(6));return d};b.prototype.eI=function(a,b,c){var d=!0;this.ga[0]&&(this.DU(a,b,c,this.xi),d=d&&this.uc(0));this.ga[2]&&(this.BU(a,c),d=d&&this.uc(2));this.ga[3]&&(this.OP(a,b,c,this.xi),
d=d&&this.uc(3));this.ga[5]&&(this.NP(a,b,c,this.xi),d=d&&this.uc(5));this.ga[6]&&(this.gS(a,b,c),d=d&&this.uc(6));return d};b.prototype.GW=function(a,b,c){var d=!0;this.ga[0]&&(this.EU(a,b,c),d=d&&this.uc(0));this.ga[2]&&(this.JH(a,b,c,2),d=d&&this.uc(2));this.ga[6]&&(this.JH(a,c,b,6),d=d&&this.uc(6));return d};b.prototype.yU=function(a,b,c){2!=this.H[0]&&(a=this.i.Ff(a),0!=(a&b)&&0!=(a&c)&&(this.H[0]=2))};b.prototype.FH=function(a,b,c){if(1!=this.H[c]){var d=this.i.Ff(this.i.Aa(a));0!=(this.i.Ff(a)&
b)&&0!=(d&b)&&(this.H[c]=1)}};b.prototype.GH=function(a,b,c,d){2!=this.H[d]&&(a=this.i.Ff(a),0!=(a&b)&&0==(a&c)&&(this.H[d]=2))};b.prototype.GP=function(a,b,c){if(1!=this.H[4]){var d=this.i.Ah(a);0!=(d&b)&&0!=(d&c)?this.H[4]=1:0!=this.H[4]&&1!=this.i.Kb(this.i.Te(this.i.Aa(a)),this.vj)&&(a=this.i.Md(this.i.Xf(a)),0!=(a&b)&&0!=(a&c)&&(this.H[4]=0))}};b.prototype.sF=function(a,b,c){if(1!=this.H[c]){var d=this.i.Ff(this.i.Aa(a));0==(this.i.Ff(a)&b)&&0==(d&b)&&(this.H[c]=1)}};b.prototype.zU=function(a,
b){if(1!=this.H[0]){var c=this.i.Ff(this.i.Aa(a));0!=(this.i.Ff(a)&b)&&0!=(c&b)&&(this.H[0]=1)}};b.prototype.vU=function(a,b,c,d){if(0!=this.H[1]&&1!=this.i.Kb(this.i.Te(this.i.Aa(a)),this.vj)){var e=this.i.Xf(a),f=this.i.Md(e);0==(f&b)&&0!=(this.i.Ff(a)&b)&&(a=this.i.Hg(e,d),0!=(f&c)&&0!=a%2&&(this.H[1]=0))}};b.prototype.wU=function(a,b){2!=this.H[2]&&0!=(this.i.Ah(a)&b)&&(this.H[2]=2)};b.prototype.KP=function(a,b,c,d){if(1!=this.H[3]){var e=this.i.Ah(a);0!=(e&b)&&0!=(e&c)?this.H[3]=1:0!=this.H[3]&&
1!=this.i.Kb(this.i.Te(this.i.Aa(a)),this.vj)&&(e=this.i.Xf(a),a=this.i.Md(e),0!=(a&b)&&(b=this.i.Hg(e,d),0!=(a&c)&&0==b%2&&(this.H[3]=0)))}};b.prototype.HP=function(a,b,c,d){if(0!=this.H[4]&&1!=this.i.Kb(this.i.Te(this.i.Aa(a)),this.vj)){var e=this.i.Xf(a);a=this.i.Md(e);0!=(a&b)&&(b=this.i.Hg(e,d),0!=(a&c)&&0!=b%2&&(this.H[4]=0))}};b.prototype.IP=function(a,b,c){1!=this.H[5]&&(a=this.i.Ah(a),0!=(a&b)&&0==(a&c)&&(this.H[5]=1))};b.prototype.eS=function(a,b){if(1!=this.H[6]){var c=this.i.Ff(this.i.Aa(a));
0==(this.i.Ff(a)&b)&&0==(c&b)&&(this.H[6]=1)}};b.prototype.dS=function(a,b,c,d){if(0!=this.H[7]&&1!=this.i.Kb(this.i.Te(this.i.Aa(a)),this.vj)){var e=this.i.Xf(a),f=this.i.Md(e);0==(f&b)&&0==(this.i.Ff(a)&b)&&(a=this.i.Hg(e,d),0!=(f&c)&&0!=a%2&&(this.H[7]=0))}};b.prototype.CU=function(a,b,c,d,f){if(1!=this.H[0]){var e=this.i.Ah(a);0!=(e&b)&&0!=(e&c)?this.H[0]=1:0!=this.H[0]&&1!=this.i.Kb(this.i.Te(this.i.Aa(a)),this.vj)&&(a=this.i.Xf(a),e=this.i.Md(a),0!=(e&b)&&0!=(e&c)&&(b=this.i.Hg(a,d),f=this.i.Hg(a,
f),0==b%2&&0==f%2&&(this.H[0]=0)))}};b.prototype.HH=function(a,b,c,d,f,k){if(0!=this.H[k]&&1!=this.i.Kb(this.i.Te(this.i.Aa(a)),this.vj)){a=this.i.Xf(a);var e=this.i.Md(a);0!=(e&b)&&0!=(e&c)&&(b=this.i.Hg(a,d),f=this.i.Hg(a,f),0==b%2&&0!=f%2&&(this.H[k]=0))}};b.prototype.IH=function(a,b,c,d){1!=this.H[d]&&(a=this.i.Ah(a),0!=(a&b)&&0==(a&c)&&(this.H[d]=1))};b.prototype.MP=function(a,b,c,d,f){if(0!=this.H[4]&&1!=this.i.Kb(this.i.Te(this.i.Aa(a)),this.vj)){a=this.i.Xf(a);var e=this.i.Md(a);0!=(e&b)&&
0!=(e&c)&&(b=this.i.Hg(a,d),f=this.i.Hg(a,f),0!=b%2&&0!=f%2&&(this.H[4]=0))}};b.prototype.tF=function(a,b,c,d){0!=this.H[d]&&1!=this.i.Kb(this.i.Te(this.i.Aa(a)),this.vj)&&(a=this.i.Xf(a),0==(this.i.Md(a)&b)&&0!=this.i.Hg(a,c)%2&&(this.H[d]=0))};b.prototype.AU=function(a,b){0!=this.H[0]&&0==(this.i.Md(a)&b)&&0!=(this.i.Hk(this.i.Lz(a))&b)&&(this.H[0]=0)};b.prototype.xU=function(a,b){2!=this.H[2]&&0!=(this.i.Md(a)&b)&&(this.H[2]=2)};b.prototype.LP=function(a,b,c){0!=this.H[3]&&(a=this.i.Md(a),0!=(a&
b)&&0!=(a&c)&&(this.H[3]=0))};b.prototype.JP=function(a,b){1!=this.H[5]&&0!=(this.i.Md(a)&b)&&(this.H[5]=1)};b.prototype.fS=function(a,b){0!=this.H[6]&&0==(this.i.Md(a)&b)&&0==(this.i.Hk(this.i.Lz(a))&b)&&(this.H[6]=0)};b.prototype.DU=function(a,b,c,d){if(0!=this.H[0]){var e=this.i.Md(a);0!=(e&b)&&0!=(e&c)&&0==this.i.Hg(a,d)%2&&(this.H[0]=0)}};b.prototype.BU=function(a,b){1!=this.H[2]&&(-1!=this.i.kf(a)?this.H[2]=1:0!=this.H[2]&&0==(this.i.Md(a)&b)&&(this.H[2]=0))};b.prototype.OP=function(a,b,c,d){if(0!=
this.H[3]){var e=this.i.Md(a);0!=(e&b)&&0!=(e&c)&&0!=this.i.Hg(a,d)%2&&(this.H[3]=0)}};b.prototype.NP=function(a,b,c,d){if(0!=this.H[5]){var e=this.i.Md(a);0!=(e&b)&&0==(e&c)&&0!=this.i.Hg(a,d)%2&&(this.H[5]=0)}};b.prototype.gS=function(a,b,c){0!=this.H[6]&&(a=this.i.Md(a),0==(a&b)&&0!=(a&c)&&(this.H[6]=0))};b.prototype.EU=function(a,b,c){0!=this.H[0]&&(a=this.i.Md(a),0!=(a&b)&&0!=(a&c)&&(this.H[0]=0))};b.prototype.JH=function(a,b,c,d){0!=this.H[d]&&(a=this.i.Md(a),0!=(a&b)&&0==(a&c)&&(this.H[d]=
0))};b.prototype.tq=function(b,c){var d=!1;b=this.i.Ia(b);c=this.i.Ia(c);this.vj=this.i.xh();for(var e=this.i.rf;-1!=e;e=this.i.og(e)){var f=this.i.kf(e);if(-1==f){if(-1!=this.Fn)switch(this.Fn){case 3:d=this.oF(e,b,c);break;case 4:d=this.eI(e,b,c);break;default:throw a.g.X("internal error");}}else{var g=f;do{var k=g;if(1!=this.i.Kb(k,this.vj)){do{switch(this.jx){case 0:d=this.AP(k,b,c);break;case 1:d=this.BP(k,b,c);break;case 2:d=this.oV(k,b,c);break;default:throw a.g.X("internal error");}if(d)break;
this.i.Ob(k,this.vj,1);k=this.i.qc(k)}while(k!=g&&!d)}if(d)break;g=this.i.qc(this.i.Aa(k))}while(g!=f);if(d)break}}d||this.LK();this.i.ni(this.vj)};b.prototype.lz=function(b,c){var d=!1;b=this.i.Ia(b);c=this.i.Ia(c);for(var e=this.i.rf;-1!=e;e=this.i.og(e)){switch(this.Fn){case 3:d=this.oF(e,b,c);break;case 4:d=this.eI(e,b,c);break;case 5:d=this.GW(e,b,c);break;default:throw a.g.za();}if(d)break}d||this.LK()};b.prototype.Yr=function(a,b){this.i.Wr(a,b)};b.prototype.Fp=function(a,b,c){this.WR(a,b,
c);this.Yr(a,c)};b.prototype.WR=function(b,c,d){a.sk.V(b,c,d,!1);b.zq(0,!0,!0);for(c=b.rd;-1!=c;c=b.Ue(c))1736==b.hc(c)&&a.lo.V(b,c,-1,!1,d)};b.cG=function(b,c){var d=b.G();if(a.T.Oc(d))return d=new a.Ua(b.description),d.dc(b,!0),d;if(197==d){d=new a.h;b.s(d);if(d.fa()<=c&&d.N()<=c)return d=new a.Wa(b.description),b.Wf(d),d;if(d.fa()<=c||d.N()<=c)return d=new a.Ua(b.description),c=new a.Wa,b.ig(0,c),d.Rf(c),b.ig(2,c),d.lineTo(c),d;d=new a.Ja(b.description);d.jd(b,!1);return d}return b};return b}();
a.Nm=b})(x||(x={}));(function(a){var b=function(){function b(b){this.sn=new a.ia(0);this.Rw=new a.ia(0);this.mu=new a.b;this.nu=new a.b;this.a=b;this.Dt=-1}b.prototype.ic=function(a){return this.a.ic(this.kA(a))};b.prototype.ow=function(a){var b=this.Sz(a);a=this.SG(a);if(this.a.Ra(b)==a){var c=b,b=a;a=c}this.a.Nc(b,this.mu);this.a.Nc(a,this.nu);return this.mu.y<this.nu.y};b.prototype.kA=function(a){var b=this.Sz(a);a=this.SG(a);return this.a.U(b)==a?b:a};b.prototype.Sz=function(a){return this.sn.get(a)};
b.prototype.SG=function(a){return this.Rw.get(a)};b.prototype.CG=function(a){this.sn.set(a,this.Dt);this.Dt=a};b.prototype.wJ=function(b){if(-1!=this.Dt){var c=this.Dt;this.Dt=this.sn.get(c);this.sn.set(c,b);this.Rw.set(c,this.a.U(b));return c}null==this.sn&&(this.sn=new a.ia(0),this.Rw=new a.ia(0));c=this.sn.size;this.sn.add(b);this.Rw.add(this.a.U(b));return c};b.prototype.dA=function(a){return this.a.ld(this.Sz(a))};return b}();a.LZ=b;var c=function(){function b(b){this.bf=b;this.Fe=new a.Hb;this.An=
new a.Hb;this.SI=0;this.op=null;this.fB=-1}b.prototype.compare=function(a,b,c){c=a.ja(c);var d=this.bf.ib,e;this.fB==b?e=this.SI:(this.op=d.ic(b),null==this.op?(a=d.a,a.od(d.kA(b),this.Fe),this.op=this.Fe,e=this.Fe.pf(this.bf.Wh,0)):e=this.op.pf(this.bf.Wh,0),this.SI=e,this.fB=b);a=d.ic(c);var f;null==a?(a=d.a,a.od(d.kA(c),this.An),a=this.An,f=this.An.pf(this.bf.Wh,0)):f=a.pf(this.bf.Wh,0);e==f&&(b=d.ow(b),c=d.ow(c),c=Math.min(b?this.op.oa:this.op.ra,c?a.oa:a.ra),b=.5*(c+this.bf.Wh),b==this.bf.Wh&&
(b=c),e=this.op.pf(b,0),f=a.pf(b,0));return e<f?-1:e>f?1:0};b.prototype.reset=function(){this.fB=-1};return b}(),d=function(){function d(){this.Kn=this.jm=null;this.hb=new a.uk;this.hb.PR();this.xe=new c(this);this.hb.Ep(this.xe)}d.prototype.zS=function(){var b=!1;this.Vw&&(b=this.AS());if(1==this.a.aa(this.Y)){var c=this.a.Pb(this.Y),b=this.a.hA(c);this.a.pC(c,!0);return 0>b?(b=this.a.cb(c),this.a.fK(b),this.a.sh(c,this.a.Ra(b)),!0):!1}this.hm=this.a.rz();this.kp=this.a.rz();for(c=this.a.Pb(this.Y);-1!=
c;c=this.a.Sb(c))this.a.$r(c,this.hm,0),this.a.$r(c,this.kp,-1);c=new a.ia(0);this.Wh=NaN;var d=new a.b;this.Xt=this.a.aa(this.Y);this.fp=this.a.Ud();this.Mt=this.a.Ud();for(var e=this.jm.xc(this.jm.Ge);-1!=e;e=this.jm.nb(e)){var f=this.jm.getData(e);this.a.Nc(f,d);d.y!=this.Wh&&0!=c.size&&(b=this.ju(c)||b,this.xe.reset(),c.clear(!1));c.add(f);this.Wh=d.y;if(0==this.Xt)break}0<this.Xt&&(b=this.ju(c)||b,c.clear(!1));this.a.le(this.fp);this.a.le(this.Mt);for(c=this.a.Pb(this.Y);-1!=c;)if(3==this.a.Tj(c,
this.hm)){this.a.pC(c,!0);d=c;for(c=this.a.Tj(c,this.kp);-1!=c;)e=this.a.Tj(c,this.kp),this.a.YV(this.Y,this.a.Sb(d),c),d=c,c=e;c=this.a.Sb(d)}else this.a.pC(c,!1),c=this.a.Sb(c);this.a.cC(this.hm);this.a.cC(this.kp);return b};d.prototype.ju=function(a){return this.TW(a)};d.prototype.TW=function(c){var d=!1;null==this.ib&&(this.ib=new b(this.a));null==this.Kn?(this.Kn=new a.ia(0),this.Kn.yb(16)):this.Kn.clear(!1);this.SW(c);for(var e=0,f=c.size;e<f;e++){var g=c.get(e);-1!=g&&this.CH(g,-1)}for(e=0;e<
this.Kn.size&&0<this.Xt;e++)if(c=this.Kn.get(e),g=this.ib.dA(this.hb.ja(c)),f=-1,0==this.a.Tj(g,this.hm)){for(var g=this.hb.Ve(c),k=c,h;-1!=g;){var l=this.hb.ja(g),m=this.ib.dA(l),p=this.a.Tj(m,this.hm);if(0!=p){f=m;break}k=g;g=this.hb.Ve(g)}-1==g?(h=!0,g=k):(l=this.hb.ja(g),h=this.ib.ow(l),g=this.hb.nb(g),h=!h);do{l=this.hb.ja(g);m=this.ib.dA(l);p=this.a.Tj(m,this.hm);if(0==p&&(h!=this.ib.ow(l)&&(d=this.a.cb(m),this.a.fK(d),this.a.sh(m,this.a.Ra(d)),d=!0),this.a.$r(m,this.hm,h?3:2),h||(k=this.a.Tj(f,
this.kp),this.a.$r(f,this.kp,m),this.a.$r(m,this.kp,k)),this.Xt--,0==this.Xt))return d;f=m;k=g;g=this.hb.nb(g);h=!h}while(k!=c)}return d};d.prototype.SW=function(a){for(var b=0,c=a.size;b<c;b++){var d=a.get(b),e=this.a.Sa(d,this.fp),f=this.a.Sa(d,this.Mt);if(-1!=e){var g=this.hb.ja(e);this.ib.CG(g);this.a.Va(d,this.fp,-1)}-1!=f&&(g=this.hb.ja(f),this.ib.CG(g),this.a.Va(d,this.Mt,-1));g=-1;-1!=e&&-1!=f?(this.hb.Kd(e,-1),this.hb.Kd(f,-1),a.set(b,-1)):g=-1!=e?e:f;-1!=g&&(this.CH(d,g)||this.hb.Kd(g,-1),
a.set(b,-1))}};d.prototype.CH=function(b,c){var d=new a.b,e=new a.b;this.a.Nc(b,d);var f=this.a.U(b);this.a.Nc(f,e);var g=!1;if(d.y<e.y){var g=!0,k=this.ib.wJ(b),h;-1==c?h=this.hb.addElement(k,-1):(h=c,this.hb.kk(h,k));k=this.a.Sa(f,this.fp);-1==k?this.a.Va(f,this.fp,h):this.a.Va(f,this.Mt,h);f=this.a.ld(b);0==this.a.Tj(f,this.hm)&&this.Kn.add(h)}f=this.a.Ra(b);this.a.Nc(f,e);d.y<e.y&&(g=!0,k=this.ib.wJ(f),-1==c?h=this.hb.addElement(k,-1):(h=c,this.hb.kk(h,k)),k=this.a.Sa(f,this.fp),-1==k?this.a.Va(f,
this.fp,h):this.a.Va(f,this.Mt,h),f=this.a.ld(b),0==this.a.Tj(f,this.hm)&&this.Kn.add(h));return g};d.V=function(a,b,c,e){var f=new d;f.a=a;f.Y=b;f.jm=c;f.Vw=e;return f.zS()};d.prototype.AS=function(){var b=new a.ia(0),c=new a.ia(0),d=-1,e=-1,f=new a.b;f.$c();for(var k=-1,h=-1,l=-1,m=new a.b,p=this.jm.xc(this.jm.Ge);-1!=p;p=this.jm.nb(p)){var q=this.jm.getData(p);this.a.Nc(q,m);var r=this.a.ld(q);f.ub(m)&&h==r?(-1==e&&(d=this.a.rz(),e=this.a.Ud()),-1==l&&(l=c.size,this.a.Va(k,e,l),c.add(1),-1==this.a.Tj(r,
d)&&(this.a.$r(r,d,k),b.add(r))),this.a.Va(q,e,l),c.CK(c.Fc()+1)):(l=-1,f.L(m));k=q;h=r}if(0==b.size)return!1;f=new a.ia(0);k=new a.ia(0);h=0;for(l=b.size;h<l;h++){var r=b.get(h),t=this.a.Tj(r,d),q=this.a.Sa(t,e);f.clear(!1);k.clear(!1);f.add(t);k.add(q);for(q=this.a.U(t);q!=t;q=this.a.U(q)){var u=q,m=this.a.Sa(u,e);if(-1!=m)if(0==k.size)k.add(m),f.add(u);else if(k.Fc()==m){var p=f.Fc(),A=this.a.U(p),t=this.a.U(u);this.a.Kc(p,t);this.a.Lc(t,p);this.a.Kc(u,A);this.a.Lc(A,u);u=[!1];A=this.a.BH(this.Y,
A,this.a.cb(r),u);this.a.Va(q,e,-1);u[0]&&this.a.jg(r,t);q=this.a.La(r);t=this.a.La(A);q-=t;this.a.nk(r,q);c.set(m,c.get(m)-1);1==c.get(m)&&(c.set(m,0),k.Pf(),f.Pf());q=t=p}else f.add(q),k.add(m)}}this.a.cC(d);this.a.le(e);return!0};return d}();a.TN=d})(x||(x={}));(function(a){var b=function(){function b(){}b.prototype.Cg=function(){this.vB=this.wb=null};b.prototype.get=function(){return this.vB};b.prototype.set=function(b){this.vB=b;if(null!=b)throw 322==b.G()&&(this.wb=b),a.g.za();};b.prototype.create=
function(b){if(322==b)this.Js();else throw a.g.X("Not Implemented");};b.prototype.Js=function(){null==this.wb&&(this.wb=new a.Hb);this.vB=this.wb};return b}();a.Cg=b})(x||(x={}));(function(a){a=a.YN||(a.YN={});a[a.enumLineSeg=1]="enumLineSeg";a[a.enumBezierSeg=2]="enumBezierSeg";a[a.enumArcSeg=4]="enumArcSeg";a[a.enumNonlinearSegmentMask=6]="enumNonlinearSegmentMask";a[a.enumSegmentMask=7]="enumSegmentMask";a[a.enumDensified=8]="enumDensified"})(x||(x={}));(function(a){var b=function(){return function(a){this.zj=
a;this.TC=this.UC=1;this.UB=this.TB=this.VB=0}}(),c=function(){function c(){this.vr=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.cl=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.cg=new a.Wa;this.ta=this.sx=0;this.$o=[];this.Ut=[];this.mx=[];this.yr=[];this.sB=[]}c.prototype.XB=function(a){if(null!=a){for(var b=0,c=a.length;b<c;b++)this.rX(a[b]);a.length=0}};c.prototype.rX=function(a){a.zj=null;this.yr.push(a)};c.prototype.Ax=function(a){if(0===this.yr.length)var c=new b(a);else c=this.yr[this.yr.length-1],c.zj=a,
--this.yr.length;return c};c.prototype.MT=function(a,b){return 0==a?this.Ut[b]:this.mx[b]};c.prototype.HB=function(){this.sx>=this.sB.length&&this.sB.push(new a.Cg);var b=this.sB[this.sx];this.sx++;return b};c.prototype.clear=function(){this.XB(this.$o);this.XB(this.Ut);this.XB(this.mx);this.sx=0};c.prototype.Ap=function(a){this.$o.push(this.Ax(a))};c.prototype.Rl=function(a){return 0==a?this.Ut.length:this.mx.length};c.prototype.Mq=function(a,b){return this.MT(a,b).zj};c.prototype.Ma=function(b,
c){if(2!=this.$o.length)throw a.g.za();this.ta=b;var d=a.Ub.Yx(.01*b),e=!1,f=this.$o[0],g=this.$o[1];if(c||0!=(f.zj.ys(g.zj,b,!0)&5)){if(322==f.zj.G()&&(c=f.zj,322==g.zj.G())){var k=g.zj,h=a.Hb.Gy(c,k,null,this.vr,this.cl,b);if(0==h)throw a.Hb.Gy(c,k,null,this.vr,this.cl,b),a.g.za();b=Array(9);a.J.Nv(b,null);for(var l=0;l<h;l++){var m=this.vr[l],p=this.cl[l],q=f.UB,r=1;0==m?(q=f.VB,r=f.UC):1==m&&(q=f.TB,r=f.TC);var t=g.UB,u=1;0==p?(t=g.VB,u=g.UC):1==p&&(t=g.TB,u=g.TC);var A=new a.b;q==t?(q=new a.b,
c.gc(m,q),m=new a.b,k.gc(p,m),p=r+u,u/=p,a.Ub.cI(q,m,u,A),a.b.sc(A,q)+a.b.sc(A,m)>d&&(e=!0)):q>t?(c.gc(m,A),m=new a.b,k.gc(p,m),a.b.sc(A,m)>d&&(e=!0)):(k.gc(p,A),q=new a.b,c.gc(m,q),a.b.sc(A,q)>d&&(e=!0));b[l]=A}f=0;g=-1;for(l=0;l<=h;l++)u=l<h?this.vr[l]:1,u!=f&&(d=this.HB(),c.yh(f,u,d),-1!=g&&d.get().Mc(b[g]),l!=h&&d.get().Zc(b[l]),f=u,this.Ut.push(this.Ax(d.get()))),g=l;c=[0,0,0,0,0,0,0,0,0];for(l=0;l<h;l++)c[l]=l;1<h&&this.cl[0]>this.cl[1]&&(u=this.cl[0],this.cl[0]=this.cl[1],this.cl[1]=u,l=c[0],
c[0]=c[1],c[1]=l);f=0;g=-1;for(l=0;l<=h;l++)u=l<h?this.cl[l]:1,u!=f&&(d=this.HB(),k.yh(f,u,d),-1!=g&&(f=c[g],d.get().Mc(b[f])),l!=h&&(f=c[l],d.get().Zc(b[f])),f=u,this.mx.push(this.Ax(d.get()))),g=l;return e}throw a.g.za();}return!1};c.prototype.tA=function(b,c,d){c.copyTo(this.cg);if(1!=this.$o.length)throw a.g.za();this.ta=b;var e=this.$o[0];if(d||e.zj.av(c.w(),b,!0))if(322==e.zj.G()){b=e.zj;var f=b.qe(c.w(),!1);this.vr[0]=f;var g=e.UB;d=1;0==f?(g=e.VB,d=e.UC):1==f&&(g=e.TB,d=e.TC);e=new a.b;0==
g?(g=new a.b,b.gc(f,g),c=c.w(),a.Ub.cI(g,c,1/(d+1),e)):0<g?(e=new a.b,b.gc(f,e)):e=c.w();d=0;f=-1;for(g=0;1>=g;g++){c=1>g?this.vr[g]:1;if(c!=d){var k=this.HB();b.yh(d,c,k);-1!=f&&k.get().Mc(e);1!=g&&k.get().Zc(e);d=c;this.Ut.push(this.Ax(k.get()))}f=g}this.cg.rb(e)}else throw a.g.za();};return c}();a.eE=c})(x||(x={}));(function(a){var b=function(){function b(b){this.zt=this.Sk=this.wb=null;this.gm=this.vf=this.cd=this.Ze=this.Oh=this.Ta=0;this.bb=null;this.Sl=this.mn=!1;this.Ze=-1;this.Oh=this.cd=
0;this.Ta=-1;this.bb=b;this.vf=this.ws(this.Oh);this.mn=!1;this.Sk=null;this.gm=-1;this.Sl=!1;this.zt=new a.b}b.$p=function(c,d){if(0>d||d>=c.D())throw a.g.wd();var e=new b(c),f=c.cw(d);e.cd=d-c.wa(f);e.Oh=f+1;e.Ta=f;e.vf=e.ws(e.Ta);e.gm=e.bb.wa(e.Ta);e.Sl=e.bb.Qb(e.Ta);return e};b.Zp=function(c,d,f){if(0>d||d>=c.aa()||0>f)throw a.g.wd();var e=c.Qb(d)?0:1;if(f>=c.La(d)-e)throw a.g.wd();c=new b(c);c.Ze=-1;c.cd=f;c.Ta=d;c.Oh=c.cd+1;c.vf=c.ws(c.Oh);c.gm=c.bb.wa(c.Ta);c.Sl=c.bb.Qb(c.Ta);return c};b.prototype.zX=
function(b){if(this.bb!=b.bb)throw a.g.Da();this.Ze=b.Ze;this.cd=b.cd;this.Ta=b.Ta;this.Oh=b.Oh;this.vf=b.vf;this.mn=b.mn;this.gm=b.gm;this.Sk=null;this.Sl=b.Sl};b.prototype.ba=function(){this.Ze!=this.cd&&this.RE();if(this.mn)this.cd=(this.cd+1)%this.vf;else{if(this.cd==this.vf)throw a.g.wd();this.cd++}return this.Sk};b.prototype.Li=function(){if(this.mn)this.cd=(this.vf+this.cd-1)%this.vf;else{if(0==this.cd)throw a.g.wd();this.cd--}this.cd!=this.Ze&&this.RE();return this.Sk};b.prototype.AX=function(){this.Ze=
-1;this.cd=0};b.prototype.BX=function(){this.cd=this.vf;this.Ze=-1};b.prototype.Tb=function(a,b){void 0===b&&(b=-1);if(0<=this.Ta&&this.Ta<this.bb.aa()){var c=this.PO();if(a>=c&&a<this.bb.Gc(this.Ta)){this.Ze=-1;this.cd=a-c;return}}c=0<=b&&b<this.bb.aa()&&a>=this.bb.wa(b)&&a<this.bb.Gc(b)?b:this.bb.cw(a);this.Oh=c+1;this.Ta=c;this.Ze=-1;this.cd=a-this.bb.wa(c);this.vf=this.ws(c);this.gm=this.bb.wa(this.Ta);this.Sl=this.bb.Qb(this.Ta)};b.prototype.Ya=function(){this.Ta=this.Oh;if(this.Ta>=this.bb.aa())return!1;
this.Ze=-1;this.cd=0;this.vf=this.ws(this.Ta);this.gm=this.bb.wa(this.Ta);this.Sl=this.bb.Qb(this.Ta);this.Oh++;return!0};b.prototype.yj=function(){this.vf=this.cd=this.Ze=-1;this.Oh=0;this.Ta=-1;this.Sl=!1;this.gm=-1};b.prototype.fC=function(b){if(0>b)throw a.g.wd();this.Oh=b;this.gm=this.vf=this.cd=this.Ze=this.Ta=-1;this.Sl=!1};b.prototype.ws=function(a){if(this.bb.Hc())return 0;var b=1;this.bb.Qb(a)&&(b=0);return this.bb.La(a)-b};b.prototype.Fo=function(){return this.Ze==this.vf-1&&this.bb.Qb(this.Ta)};
b.prototype.kC=function(){this.mn=!0};b.prototype.Db=function(){return this.bb.kb.f[this.Ta]+this.Ze};b.prototype.PO=function(){return this.bb.wa(this.Ta)};b.prototype.Ik=function(){return this.Fo()?this.bb.wa(this.Ta):this.Db()+1};b.prototype.jn=function(){return 0==this.Ze};b.prototype.Io=function(){return this.Ze==this.vf-1};b.prototype.Ea=function(){return this.cd<this.vf};b.prototype.pA=function(){return 0<this.cd};b.prototype.Vf=function(){var a=new b(this.bb);a.Ze=this.Ze;a.cd=this.cd;a.vf=
this.vf;a.Ta=this.Ta;a.Oh=this.Oh;a.bb=this.bb;a.mn=this.mn;return a};b.prototype.RE=function(){if(0>this.cd||this.cd>=this.vf)throw a.g.wd();this.Ze=this.cd;var b=this.Db();this.bb.wc();var c=this.bb.cf,d=1;null!=c&&(d=c.read(b)&7);c=this.bb.description;switch(d){case 1:null==this.wb&&(this.wb=new a.Hb);this.Sk=this.wb;break;case 2:throw a.g.X("internal error");case 4:throw a.g.za();default:throw a.g.za();}this.Sk.Fg(c);d=this.Ik();this.bb.Nc(b,this.zt);this.Sk.Mc(this.zt);this.bb.Nc(d,this.zt);
this.Sk.Zc(this.zt);for(var f=1,h=c.Ga;f<h;f++)for(var l=c.qd(f),m=a.ma.Xa(l),p=0;p<m;p++){var q=this.bb.Yc(l,b,p);this.Sk.Tx(l,p,q);q=this.bb.Yc(l,d,p);this.Sk.Lx(l,p,q)}};b.prototype.UU=function(){return this.Ta==this.bb.aa()-1};b.prototype.Go=function(){var a=this.bb.PT();return null!=a?1!=(a.read(this.Ze)&7):!1};return b}();a.ZN=b})(x||(x={}));(function(a){var b=function(){function b(b){b instanceof a.T?(this.JI=b,this.Ca=-1,this.dj=1):(this.wV=b.slice(0),this.Ca=-1,this.dj=b.length)}b.prototype.Ia=
function(){return this.Ca};b.prototype.next=function(){return this.Ca<this.dj-1?(this.Ca++,null!=this.JI?this.JI:this.wV[this.Ca]):null};b.prototype.Re=function(){return!0};return b}();a.hd=b})(x||(x={}));(function(a){var b=function(){return function(){this.next=null}}(),c=function(){function c(){this.Mr=this.wx=this.xx=this.Pk=this.ai=0;this.vG=!1;this.XK=0;this.Xn=this.kg=this.Em=this.hi=null;this.tm=0;this.az=null;this.Pk=this.ai=-1}c.prototype.wY=function(b,c,d){this.ai=b;this.Pk=c;this.hi=this.Em=
null;this.Mr=0;this.az=d;null==this.Xn&&(this.Xn=a.J.gf(384,0));this.$K()};c.prototype.N=function(){return this.ai};c.prototype.fa=function(){return this.Pk};c.prototype.flush=function(){0<this.tm&&(this.az.qG(this.Xn,this.tm),this.tm=0)};c.prototype.$K=function(){if(0<this.Mr){for(var a=0;a<this.Pk;a++){for(var b=this.Em[a];null!=b;){var c=b,b=b.next;c.next=null}this.Em[a]=null}this.hi=null}this.xx=this.Pk;this.wx=-1;this.Mr=0};c.prototype.YJ=function(a){this.vG=a==c.py;for(a=this.xx;a<=this.wx;a++)this.tP(),
this.kP(a),this.ZR();this.$K()};c.prototype.Qy=function(c,d,f,k){if(d!=k){var e=1;d>k&&(e=c,c=f,f=e,e=d,d=k,k=e,e=-1);if(!(0>k||d>=this.Pk)){0>c&&0>f?f=c=-1:c>=this.ai&&f>=this.ai&&(f=c=this.ai);var g=(f-c)/(k-d);k>this.Pk&&(k=this.Pk,f=g*(k-d)+c);0>d&&(c=g*(0-d)+c,d=0);var h=Math.max(this.ai+1,8388607);-8388607>c?(d=(0-c)/g+d,c=0):c>h&&(d=(this.ai-c)/g+d,c=this.ai);-8388607>f?k=(0-c)/g+d:f>h&&(k=(this.ai-c)/g+d);d=a.J.truncate(d);k=a.J.truncate(k);d!=k&&(f=new b,f.x=a.J.truncate(4294967296*c),f.y=
d,f.B=k,f.TR=a.J.truncate(4294967296*g),f.dir=e,null==this.Em&&(this.Em=a.J.gf(this.Pk,null)),f.next=this.Em[f.y],this.Em[f.y]=f,f.y<this.xx&&(this.xx=f.y),f.B>this.wx&&(this.wx=f.B),this.Mr++)}}};c.prototype.tP=function(){if(null!=this.hi){for(var a=!1,b=null,c=this.hi;null!=c;)if(c.y++,c.y==c.B){var d=c,c=c.next;null!=b?b.next=c:this.hi=c;d.next=null}else c.x+=c.TR,null!=b&&b.x>c.x&&(a=!0),b=c,c=c.next;a&&(this.hi=this.WK(this.hi))}};c.prototype.kP=function(a){if(!(a>=this.Pk)){var b=this.Em[a];
if(null!=b){this.Em[a]=null;b=this.WK(b);this.Mr-=this.XK;a=this.hi;for(var c=!0,d=b,e=null;null!=a&&null!=d;)a.x>d.x?(c&&(this.hi=d),c=d.next,d.next=a,null!=e&&(e.next=d),e=d,d=c):(c=a.next,a.next=d,null!=e&&(e.next=a),e=a,a=c),c=!1;null==this.hi&&(this.hi=b)}}};c.xG=function(a,b){return 0>a?0:a>b?b:a};c.prototype.ZR=function(){if(null!=this.hi)for(var b=0,d=this.hi,f=a.J.truncate(a.J.gI(d.x)),k=d.next;null!=k;k=k.next)if(b=this.vG?b^1:b+k.dir,k.x>d.x){var h=a.J.truncate(a.J.gI(k.x));0!=b&&(d=c.xG(f,
this.ai),f=c.xG(h,this.ai),f>d&&d<this.ai&&(this.Xn[this.tm++]=d,this.Xn[this.tm++]=f,this.Xn[this.tm++]=k.y,this.tm==this.Xn.length&&(this.az.qG(this.Xn,this.tm),this.tm=0)));d=k;f=h}};c.prototype.WK=function(b){for(var d=0,e=b;null!=e;e=e.next)d++;this.XK=d;if(1==d)return b;null==this.kg?this.kg=a.J.gf(Math.max(d,16),null):this.kg.length<d&&(this.kg=a.J.gf(Math.max(d,2*this.kg.length),null));for(var f=0,e=b;null!=e;e=e.next)this.kg[f++]=e;2==d?this.kg[0].x>this.kg[1].x&&(b=this.kg[0],this.kg[0]=
this.kg[1],this.kg[1]=b):c.VM(this.kg,d,function(a,b){return a==b?0:a.x<b.x?-1:a.x>b.x?1:0});b=this.kg[0];this.kg[0]=null;e=b;for(f=1;f<d;f++)e.next=this.kg[f],e=this.kg[f],this.kg[f]=null;e.next=null;return b};c.VM=function(a,b,c){if(b==a.length)a.sort(c);else{var d=a.slice(0,0),e=a.slice(b);b=a.slice(0,b).sort(c);a.length=0;a.push.apply(a,d.concat(b).concat(e))}};c.py=0;c.L_=1;return c}();a.zy=c})(x||(x={}));(function(a){var b=function(){function b(){}b.prototype.Ri=function(a,b){var c=this.a.Sa(a,
this.Gr);this.fm==c&&(this.fm=this.Me.nb(this.fm));this.Vo==c&&(this.Vo=this.Me.nb(this.Vo));this.Me.kd(this.xB,c);this.yk(a);if(b&&(c=this.a.ld(a),-1!=c&&this.a.cb(c)==a)){b=this.a.U(a);if(b!=a){var d=this.a.ld(b);if(d==c){this.a.jg(c,b);return}b=this.a.Ra(a);if(b!=a&&(d=this.a.ld(b),d==c)){this.a.jg(c,b);return}}this.a.jg(c,-1);this.a.sh(c,-1)}};b.prototype.HE=function(){for(var b=!1,c=0,d=new a.b;;){c++;null==this.vi?(this.vi=new a.ia(0),this.vt=new a.ia(0),this.Xe=new a.ia(0)):(this.vi.clear(!1),
this.vt.clear(!1),this.Xe.clear(!1));for(var f=this.Vo,h=0,l=!0;f!=this.fm;){var m=this.Me.getData(f),p=new a.b;this.a.Nc(m,p);l&&(this.a.Nc(m,d),l=!1);var p=this.a.Ra(m),q=this.a.U(m);-559038737!=this.a.Sa(p,this.Ug)&&(this.vi.add(p),this.a.Va(p,this.Ug,-559038737),this.vt.add(m),this.Xe.add(h++));-559038737!=this.a.Sa(q,this.Ug)&&(this.vi.add(q),this.a.Va(q,this.Ug,-559038737),this.vt.add(m),this.Xe.add(h++));f=this.Me.nb(f)}if(2>this.vi.size)break;var r=this;this.Xe.Gd(0,this.Xe.size,function(a,
b){return r.HO(a,b)});f=0;for(h=this.Xe.size;f<h;f++)l=this.Xe.get(f),l=this.vi.get(l),this.a.Va(l,this.Ug,f),p=new a.b,this.a.Nc(l,p);p=this.TO(d);f=0;for(h=this.Xe.size;f<h;f++)l=this.Xe.get(f),-1!=l&&(l=this.vi.get(l),this.a.Va(l,this.Ug,-1));if(p)b=!0;else break}return b};b.prototype.TO=function(a){for(var b=!1,c=!0;c;){var c=!1,d=0;-1==this.Xe.get(d)&&(d=this.Pm(d));for(var f=this.Pm(d),k=0,h=this.Xe.size;k<h&&-1!=d&&-1!=f&&d!=f;k++){var l=this.Xe.get(d),f=this.Xe.get(f),l=this.vi.get(l),f=this.vi.get(f),
m=this.a.U(l);this.a.qw(m,a)||(m=this.a.Ra(l));var p=this.a.U(f);this.a.qw(p,a)||(p=this.a.Ra(f));var q=this.Zu(m,l),r=this.Zu(p,f),t=q?this.a.Ra(m):this.a.U(m),u=r?this.a.Ra(p):this.a.U(p),A=!1;this.mq(m)?A=!0:this.mq(p)?A=!0:this.mq(l)?A=!0:this.mq(f)?A=!0:this.mq(t)?A=!0:this.mq(u)&&(A=!0);!A&&this.a.Uq(l,f)&&(A=!0,this.KE(q,r,m,l,p,f));!A&&this.a.Uq(t,u)&&(A=!0,this.KE(!q,!r,m,t,p,u));A&&(b=!0);c=c||A;d=this.Pm(d);f=this.Pm(d)}}if(!b)for(d=0,-1==this.Xe.get(d)&&(d=this.Pm(d)),f=this.Pm(d),k=0,
h=this.Xe.size;k<h&&-1!=d&&-1!=f&&d!=f;k++)l=this.Xe.get(d),f=this.Xe.get(f),l=this.vi.get(l),f=this.vi.get(f),m=this.a.U(l),this.a.qw(m,a)||(m=this.a.Ra(l)),p=this.a.U(f),this.a.qw(p,a)||(p=this.a.Ra(f)),q=this.Zu(m,l),r=this.Zu(p,f),t=q?this.a.Ra(m):this.a.U(m),u=r?this.a.Ra(p):this.a.U(p),this.LO(q,r,l,m,t,f,p,u)&&(b=!0),d=this.Pm(d),f=this.Pm(d);return b};b.prototype.WO=function(){1736==this.a.hc(this.Y)&&1==this.a.xo(this.Y)&&(new a.Dg).zW(this.Vw,this.a,this.Y,this.ke);var b=!1,c=!0;this.Ug=
this.Gr=-1;var d=this.a.D(this.Y),f=new a.ia(0);f.yb(d);for(var h=this.a.Pb(this.Y);-1!=h;h=this.a.Sb(h))for(var l=this.a.cb(h),m=0,p=this.a.La(h);m<p;m++)f.add(l),l=this.a.U(l);var q=this.a.Dd.f,r=this.a.Dd.ed;this.a.xb.wc();var t=this.a.xb.ya[0].f;f.Gd(0,d,function(a,b){var c=q[r*a],d=q[r*b],e=t[2*c],c=t[2*c+1],f=t[2*d],d=t[2*d+1],e=c<d?-1:c>d?1:e<f?-1:e>f?1:0;0==e&&(e=q[r*a+3],d=q[r*b+3],e=e<d?-1:e==d?0:1);return e});this.Gr=this.a.Ud();this.Me=new a.Xp;this.xB=this.Me.mi(0);this.Me.Vn(d);for(h=
0;h<d;h++)l=f.get(h),m=this.Me.addElement(this.xB,l),this.a.Va(l,this.Gr,m);this.Ug=this.a.Ud();this.fm=-1;for(this.xE()&&(b=!0);c;){c=!1;d=0;f=!1;do{f=!1;this.Vo=-1;for(var p=0,h=new a.b,m=new a.b,u=this.Me.xc(this.xB);-1!=u;)l=this.Me.getData(u),-1!=this.Vo?(this.a.Nc(l,m),h.ub(m))?p++:(h.L(m),this.fm=u,0<p&&(l=this.HE())&&(f=!0,-1!=this.fm&&(l=this.Me.getData(this.fm),this.a.Nc(l,h))),this.Vo=u=this.fm,p=0):(this.Vo=u,this.a.Nc(this.Me.getData(u),h),p=0),-1!=u&&(u=this.Me.nb(u));this.fm=-1;0<p&&
(l=this.HE())&&(f=!0);if(10<d++)throw a.g.za();f&&this.OO();this.xE()&&(f=!0);c=c||f&&!1;b=b||f}while(f)}this.a.le(this.Gr);this.a.le(this.Ug);return b=a.TN.V(this.a,this.Y,this.Me,this.Vw)||b};b.prototype.Zu=function(a,b){return this.a.U(b)==a?!1:!0};b.prototype.LO=function(a,b,c,d,f,h,l,m){if(d==l)return this.yk(c),this.yk(h),!1;var e=this.a.Sa(c,this.Ug),g=this.a.Sa(f,this.Ug),k=this.a.Sa(h,this.Ug),n=this.a.Sa(m,this.Ug);c=[0,0,0,0,0,0,0,0];var p=[0,0,0,0];c[0]=0;p[0]=e;c[1]=0;p[1]=g;c[2]=1;p[2]=
k;c[3]=1;p[3]=n;for(e=1;4>e;e++){g=p[e];k=c[e];for(n=e-1;0<=n&&p[n]>g;)p[n+1]=p[n],c[n+1]=c[n],n--;p[n+1]=g;c[n+1]=k}p=0;0!=c[0]&&(p|=1);0!=c[1]&&(p|=2);0!=c[2]&&(p|=4);0!=c[3]&&(p|=8);if(5!=p&&10!=p)return!1;a==b?a?(this.a.Kc(m,d),this.a.Lc(d,m),this.a.Kc(f,l),this.a.Lc(l,f)):(this.a.Lc(m,d),this.a.Kc(d,m),this.a.Lc(f,l),this.a.Kc(l,f)):a?(this.a.Lc(d,h),this.a.Kc(h,d),this.a.Lc(l,f),this.a.Kc(f,l)):(this.a.Kc(d,h),this.a.Lc(h,d),this.a.Kc(l,f),this.a.Lc(f,l));return!0};b.prototype.KE=function(a,
b,c,d,f,h){this.C_?this.VO():this.UO(a,b,c,d,f,h)};b.prototype.VO=function(){throw a.g.X("not implemented.");};b.prototype.UO=function(a,b,c,d,f,h){if(a!=b)a?(this.a.Kc(c,f),this.a.Lc(f,c),this.a.Kc(h,d),this.a.Lc(d,h),this.po(f,c),this.Ri(f,!0),this.a.Mi(f,!0),this.yk(c),this.po(h,d),this.Ri(h,!0),this.a.Mi(h,!1)):(this.a.Kc(f,c),this.a.Lc(c,f),this.a.Kc(d,h),this.a.Lc(h,d),this.po(f,c),this.Ri(f,!0),this.a.Mi(f,!1),this.yk(c),this.po(h,d),this.Ri(h,!0),this.a.Mi(h,!0)),this.yk(d);else{var e=a?c:
d,g=b?f:h;a=a?d:c;b=b?h:f;f=!1;this.a.Kc(e,g);this.a.Kc(g,e);this.a.Lc(a,b);this.a.Lc(b,a);for(h=b;h!=g;)c=this.a.Ra(h),d=this.a.U(h),this.a.Lc(h,d),this.a.Kc(h,c),f=f||h==e,h=d;f||(c=this.a.Ra(g),d=this.a.U(g),this.a.Lc(g,d),this.a.Kc(g,c));this.po(g,e);this.Ri(g,!0);this.a.Mi(g,!1);this.yk(e);this.po(b,a);this.Ri(b,!0);this.a.Mi(b,!1);this.yk(a)}};b.prototype.xE=function(){for(var a=!1,b=this.a.Pb(this.Y);-1!=b;){for(var c=this.a.cb(b),d=0,f=this.a.La(b);d<f&&1<f;){var h=this.a.Ra(c),l=this.a.U(c);
this.a.Uq(h,l)?(a=!0,this.Ri(c,!1),this.a.ud(c,!0),this.Ri(l,!1),this.a.ud(l,!0),c=h,d=0,f=this.a.La(b)):(c=l,d++)}if(2>this.a.La(b)){a=this.a.cb(b);d=0;for(f=this.a.La(b);d<f;d++)this.Ri(a,!1),a=this.a.U(a);b=this.a.Rr(b);a=!0}else b=this.a.Sb(b)}return a};b.prototype.mq=function(a){for(var b=!1;;){var c=this.a.U(a),d=this.a.Ra(a);if(c==a)return this.Ri(a,!0),this.a.Mi(a,!1),!0;if(!this.a.Uq(c,d))break;b=!0;this.yk(d);this.yk(c);this.Ri(a,!0);this.a.Mi(a,!1);this.po(c,d);this.Ri(c,!0);this.a.Mi(c,
!0);if(c==d)break;a=d}return b};b.prototype.OO=function(){for(var a=0,b=this.Me.xc(this.Me.Ge);-1!=b;b=this.Me.nb(b)){var c=this.Me.getData(b);this.a.Aj(c,-1)}for(var d=0,f=this.a.Pb(this.Y);-1!=f;)if(b=this.a.cb(f),-1==b||-1!=this.a.ld(b))c=f,f=this.a.Sb(f),this.a.Sr(c);else{this.a.Aj(b,f);for(var h=1,c=this.a.U(b);c!=b;c=this.a.U(c))this.a.Aj(c,f),h++;this.a.Np(f,!1);this.a.nk(f,h);this.a.sh(f,this.a.Ra(b));d+=h;a++;f=this.a.Sb(f)}for(b=this.Me.xc(this.Me.Ge);-1!=b;b=this.Me.nb(b))c=this.Me.getData(b),
-1==this.a.ld(c)&&(f=this.a.BH(this.Y,c,c,null),d+=this.a.La(f),a++);this.a.wm(this.Y,a);this.a.lk(this.Y,d);a=0;for(d=this.a.rd;-1!=d;d=this.a.Ue(d))a+=this.a.D(d);this.a.AC(a)};b.prototype.Pm=function(a){for(var b=0,c=this.Xe.size-1;b<c;b++)if(a=(a+1)%this.Xe.size,-1!=this.Xe.get(a))return a;return-1};b.prototype.po=function(a,b){var c=this.a.Sa(b,this.Gr),d=this.a.Sa(b,this.Ug);this.a.KC(a,b);this.a.Va(b,this.Gr,c);this.a.Va(b,this.Ug,d)};b.prototype.yk=function(a){var b=this.a.Sa(a,this.Ug);-1!=
b&&(this.Xe.set(b,-1),this.a.Va(a,this.Ug,-1))};b.V=function(a,c,d,f,h){var e=new b;e.a=a;e.Y=c;e.eB=d;e.Vw=f;e.ke=h;return e.WO()};b.prototype.HO=function(b,c){var d=this.vi.get(b),e=new a.b;this.a.Nc(d,e);var d=new a.b,f=this.vi.get(c);this.a.Nc(f,d);if(e.ub(d))return 0;b=this.vt.get(b);f=new a.b;this.a.Nc(b,f);c=this.vt.get(c);b=new a.b;this.a.Nc(c,b);c=new a.b;c.yc(e,f);e=new a.b;e.yc(d,b);return a.b.vs(c,e)};return b}();a.lo=b})(x||(x={}));(function(a){(function(a){a[a.Local=0]="Local";a[a.Geographic=
1]="Geographic";a[a.Projected=2]="Projected";a[a.Image=3]="Image";a[a.Unknown=4]="Unknown"})(a.$N||(a.$N={}));(function(a){a[a.Integer32=0]="Integer32";a[a.Integer64=1]="Integer64";a[a.FloatingPoint=2]="FloatingPoint"})(a.KN||(a.KN={}));var b=function(){function b(){this.jq="";this.bv=null;this.yg=0;this.lJ=this.tp=-1;this.Uh=null}b.prototype.Cc=function(){return this.yg};b.prototype.Rs=function(){return 0};b.prototype.Ss=function(){return 0};b.prototype.Ts=function(){return 0};b.prototype.Qs=function(){return 0};
b.prototype.Uz=function(){return 5.7295779513082306E10};b.prototype.Vz=function(){return 1E3};b.prototype.Tz=function(){return 1E3};b.prototype.bt=function(){return 1};b.prototype.se=function(){var b=.001;0!=this.yg?b=a.us.vS(this.yg):null!=this.Uh&&(b=a.pE.wS(this.Uh));return b};b.prototype.mH=function(){return this.Uh};b.prototype.Vd=function(){if(0!=this.yg)return a.kc.pe(a.us.Cz(this.yg));if(null!=this.Uh)return a.pE.xS(this.Uh)};b.Fb=function(b){if(0!=b.yg){if(!0===a.us.TU(b.yg))return 1;if(!0===
a.us.VU(b.yg))return 2}return 4};b.prototype.$s=function(){var b=this.Cc();if(-1!=this.tp)return this.tp;this.tp=a.us.AL(b);return-1!=this.tp?this.tp:b};b.create=function(c){if(0>=c)throw a.g.F("Invalid or unsupported wkid: "+c);var d=new b;d.yg=c;return d};b.qR=function(c){if(null==c||0==c.length)throw a.g.F("Cannot create SpatialReference from null or empty text.");var d=new b;d.Uh=c;return d};b.prototype.Eb=function(a){return this==a?!0:null==a||this.constructor!=a.constructor||this.yg!=a.yg||
0==this.yg&&this.Uh!==a.Uh?!1:!0};b.QS=function(b,c){var d=Math.PI/180,e=new a.ea;a.qM.TS(b.w().x*d,b.w().y*d,c.w().x*d,c.w().y*d,e);return e.j};b.prototype.toString=function(){return"[ tol: "+this.Bo()+"; wkid: "+this.Cc()+"; wkt: "+this.mH()+"]"};b.prototype.jc=function(){if(""!==this.jq)return this.jq;var a=this.toString();if(Array.prototype.reduce)return this.jq="S"+a.split("").reduce(function(a,b){a=(a<<5)-a+b.charCodeAt(0);return a&a},0);var b=0;if(0===a.length)return"";for(var c=0;c<a.length;c++)b=
(b<<5)-b+a.charCodeAt(c),b&=b;return this.jq="S"+b};b.prototype.Bo=function(){return this.se(0)};b.prototype.Ao=function(){return null!==this.bv?this.bv:this.bv=a.Ou.wR(this)};b.q_=!0;b.sv=2147483645;b.tv=9007199254740990;return b}();a.Rd=b})(x||(x={}));(function(a){var b=function(b){function c(){b.apply(this,arguments);this.ij=null;this.lp=new a.fE;this.Xw=this.Fr=null}I(c,b);c.wR=function(b){var d=new c;d.yg=b.yg;d.tp=b.tp;d.lJ=b.lJ;d.Uh=b.Uh;if(""!==d.Uh&&null!==d.Uh){b=c.QY(d.Uh);var e=c.mX(d.Uh);
d.lp.Ey(b,e,a.ts.Integer64);d.Ky(b);d.yg=b.$s()}else b=c.EX(d.yg),d.Ky(b),d.lp.Ey(b,null,a.ts.Integer64);return d};c.prototype.se=function(a){return this.lp.Bo(a)};c.mX=function(b){if(0>=b.length)throw a.g.F();var d=null;try{d=a.RD.fromString(b)}catch(n){d=null}return null==d?null:c.tD(d,!0)};c.prototype.Ky=function(a){this.Od=a;this.Fr=this.Od.Vd()};c.prototype.Jc=function(){return 0==this.Fb()||3==this.Fb()?!1:this.Od.Jc()};c.prototype.UH=function(){return 0==this.Fb()?!1:3==this.Fb()?this.ij.Fk().Jc():
this.Od.Jc()};c.prototype.Kg=function(){return null!=this.Od?this.Od.uf:null};c.prototype.bn=function(){return this.Od.bn()};c.prototype.ee=function(){return this.Od.ee()};c.prototype.Ch=function(){return null!=this.Od?this.Od.fx:NaN};c.prototype.dn=function(){return this.Od.dn()};c.prototype.Ws=function(){return this.Od.Ws()};c.prototype.Sj=function(){return this.Od.Sj()};c.prototype.iU=function(b){return a.UD.zz(this.Od,b.Od)};c.prototype.Lk=function(){return this.Od.Lk()};c.prototype.Vs=function(){return this.Od.Vs()};
c.prototype.pi=function(){return 3==this.Fb()?this.ij.Fk().pi():this.Od.pi()};c.prototype.Bh=function(){if(!this.Jc())throw a.g.F("!isPannable()");var b=new a.h;this.Od.Bh(b);return b};c.prototype.re=function(){if(!this.Jc())throw a.g.F("!isPannable()");return this.Od.gp};c.prototype.BT=function(){if(!this.Jc())throw a.g.F("!isPannable()");var b=new a.h;this.Od.AT(b);return b};c.prototype.bw=function(){if(!this.Jc())throw a.g.F("!isPannable()");return this.Od.bw()};c.prototype.aw=function(){if(!this.Jc())throw a.g.F("!isPannable()");
return this.Od.aw()};c.prototype.Xs=function(){return null!=this.ij?this.ij.Fk().Xs():this.Od.Xs()};c.prototype.ES=function(){return this.Od.Uv()};c.prototype.jX=function(a){a.assign(this.lp)};c.prototype.Yi=function(){return this.Fr.getUnitFactor()};c.prototype.gA=function(a){return this.lp.gA(a)};c.prototype.lc=function(){var b=this.Fb();if(1==b)return this;if(3==b)return this.ij.Fk().lc();if(0==b)throw a.g.X("invalid call");if(4===b)throw a.g.X("invalid call");if(null!==this.Xw)return this.Xw;
b=this.Kg().getGeogcs();if(null==b)throw a.g.za();return this.Xw=c.jG(b,this.lp.bt())};c.jG=function(b,d){if(null==b)throw a.g.F("null pointer.");var e=new c;b=c.Pu(b,!0);e.lp.Ey(b,null,d);e.Ky(b);e.yg=b.$s();return e};c.prototype.Fb=function(){var b=this.Kg();if(null!=b)switch(b.getType()){case a.Vc.PE_TYPE_GEOGCS:return 1;case a.Vc.PE_TYPE_PROJCS:return 2}return 4};c.prototype.eA=function(b){var c=new a.b;this.Od.eA(b,c);return c};c.prototype.Uv=function(){return this.Od.Uv()};c.Pu=function(b,d){var e=
b.getCode();if(0>=e&&(e=a.Tf.getCode(b),0<e)){var f=a.Tf.coordsys(e);if(null==f)throw a.g.F("Text to wkid mapping had failed: "+e);return c.Pu(f,d)}if(d&&0<e&&(f=c.Mv[e]))return f;f=a.Ib.iw(b,e,!1);if(d=c.zH[f])return d;d=0>=e?b:a.Tf.coordsys(e);d=new a.UD(d);c.zH[f]=d;0<e&&(c.Mv[e]=d);return d};c.EX=function(b){if(0>=b)throw a.g.F("Invalid or unsupported wkid: "+b);var d=c.Mv[b];if(null!=d)return d;d=a.Tf.coordsys(b);if(null==d)throw a.g.F("Invalid or unsupported wkid: "+b);d=c.Pu(d,!1);d.$s()!=
b&&(c.Mv[b]=d);return d};c.QY=function(b){if(null==b||void 0===b||0==b.length)throw a.g.F("Cannot create SpatialReference from null or empty text.");var d=null;try{d=a.Tf.fromString(a.Vc.PE_TYPE_COORDSYS,b)}catch(n){throw a.g.F("Cannot create SpatialReference from text. "+n.message);}if(null===d)throw a.g.F("Cannot create SpatialReference from text. ");return c.Pu(d,!0)};c.tD=function(b,d){var e=b.getCode();if(0>=e&&(e=a.Tf.getCode(b),0<e)){e=a.Tf.vertcs(e);if(null===e)throw a.g.F();return c.tD(e,
d)}if(d&&0<e&&(d=c.xH[e]))return d;b=a.Ib.iw(b,e,!1);if(d=c.YH[b])return d;var f;0>=e||(f=a.Tf.vertcs(e));if(null===f)throw a.g.F();d=new a.GN(f);c.YH[b]=d;0<e&&(c.xH[e]=d);return d};c.jK=function(b,c){var d;if(null===c||c.u())return null;var e=new a.h,f;null!==c&&1!=b.Fb()?(d=b.lc(),f=d.Kg(),d=a.rs.Is(b,d,null,null),d=a.os.local().V(c,d,null),d.s(e)):(f=b.Kg(),c.s(e));d=f.getPrimem().getLongitude();f=f.getUnit().getUnitFactor();return new a.PD(e.o,e.A,e.v,e.B,d,f)};c.FE=function(a){var b={name:"",
steps:[],_pt:null,_entry:null},c=0;for(a=a.getEntries();c<a.length;c++){var d=a[c],e={y_:!1,X_:"",W_:-1,geogtran:null};0===d.getDirection()?e.isInverse=!1:e.isInverse=!0;var f=d.getGeogtran().getCode();-1<f?e.wkid=f:e.wkt=d.getGeogtran().toString();b.steps.push(e)}return b};c.RT=function(b,d,f,k){void 0===f&&(f=null);f=c.jK(k,f);b=a.fq.getGTlist(b.Kg(),d.Kg(),2,a.fq.PE_GTLIST_OPTS_COMMON,f,1);d=null;b&&0<b.length&&(d=this.FE(b[0]),a.wy.destroy(b));null!==f&&f.destroy();return d};c.ST=function(b,d,
f,k){var e;void 0===f&&(f=null);void 0===k&&(k=null);void 0===e&&(e=30);f=c.jK(k,f);b=a.fq.getGTlist(b.Kg(),d.Kg(),2,a.fq.PE_GTLIST_OPTS_COMMON,f,e);d=[];if(b&&0<b.length){for(e=0;e<b.length;e++)d.push(this.FE(b[e]));a.wy.destroy(b)}null!==f&&f.destroy();return d};c.Mv={};c.zH={};c.xH={};c.YH={};return c}(a.Rd);a.Ou=b})(x||(x={}));(function(a){(function(a){a[a.Integer32=0]="Integer32";a[a.Integer64=1]="Integer64";a[a.FloatingPoint=2]="FloatingPoint"})(a.ts||(a.ts={}));var b=a.ts,c=function(){function c(){this.kq()}
c.prototype.assign=function(a){this.Xl=a.Xl;this.Yl=a.Yl;this.uj=a.uj;this.Tw=a.Tw;this.Jn=a.Jn;this.Sw=a.Sw;this.rx=a.rx;this.il=a.il;this.Cr=a.Cr;this.Br=a.Br;this.En=a.En};c.prototype.Rs=function(){return this.Xl};c.prototype.Ss=function(){return this.Yl};c.prototype.Ts=function(){return this.Tw};c.prototype.Qs=function(){return this.Sw};c.prototype.Uz=function(){return this.uj};c.prototype.Vz=function(){return this.Jn};c.prototype.Tz=function(){return this.rx};c.prototype.bt=function(){return this.En};
c.prototype.kq=function(){this.Yl=this.Xl=0;this.uj=1;this.Tw=0;this.Jn=1;this.Sw=0;this.rx=1;this.Br=this.Cr=this.il=2.220446049250313E-14;this.En=b.FloatingPoint};c.prototype.Ey=function(c,d,f){this.kq();this.En=f;if(f!=b.FloatingPoint){var e=new a.h;c.$S(e);this.Xl=e.o;this.Yl=e.A}else this.Yl=this.Xl=-1.7976931348623157E308;e=c.uf.getType();e==a.Vc.PE_TYPE_GEOGCS?(e=(f==b.Integer64?1E-9:1/18E5)*c.ee(),this.uj=1/e):e==a.Vc.PE_TYPE_PROJCS&&(e=(f==b.Integer64?1E-4:.001)*c.bn(),this.uj=1/e);null!=
d?(e=(f==b.Integer32?.001:1E-4)*d.XI,this.Jn=1/e):this.Jn=1E4;this.rx=1E4;this.XO();this.il=c.fx;this.Cr=null!=d?.001*d.XI:.001;this.Br=2.220446049250313E-14};c.prototype.XO=function(){if(this.En!=b.FloatingPoint){var c=this.En==b.Integer64?a.Rd.tv:a.Rd.sv,d=c/this.uj,f=this.Xl+d,k=a.J.truncate((f-this.Xl)*this.uj);k>c&&(this.uj=c/(f-this.Xl));d=this.Yl+d;k=a.J.truncate((d-this.Yl)*this.uj);k>c&&(this.uj=c/(d-this.Yl))}};c.prototype.zC=function(a,b){switch(a){case 0:this.il=b;case 1:this.Cr=b;case 2:this.Br=
b}};c.prototype.Bo=function(a){switch(a){case 0:return this.il;case 1:return this.Cr;case 2:return this.Br}return 0};c.prototype.XT=function(){var c=new a.h;switch(this.bt()){case b.Integer32:var d=a.Rd.sv/this.Uz();c.I(this.Rs(),this.Ss(),this.Rs()+d,this.Ss()+d);break;case b.Integer64:d=a.Rd.tv/this.Uz();c.I(this.Rs(),this.Ss(),this.Rs()+d,this.Ss()+d);break;case b.FloatingPoint:c.I(-1.7976931348623157E308,-1*1.7976931348623157E308,1.7976931348623157E308,1.7976931348623157E308);break;default:throw a.g.X("internal error");
}return c};c.prototype.YT=function(){var c=new a.zc;switch(this.bt()){case b.Integer32:var d=a.Rd.sv/this.Vz();c.I(this.Ts(),this.Ts()+d);break;case b.Integer64:d=a.Rd.tv/this.Vz();c.I(this.Ts(),this.Ts()+d);break;case b.FloatingPoint:c.I(-1*1.7976931348623157E308,1.7976931348623157E308);break;default:throw a.g.X("internal error");}return c};c.prototype.tT=function(){var c=new a.zc;switch(this.bt()){case b.Integer32:var d=a.Rd.sv/this.Tz();c.I(this.Qs(),this.Qs()+d);break;case b.Integer64:d=a.Rd.tv/
this.Tz();c.I(this.Qs(),this.Qs()+d);break;case b.FloatingPoint:c.I(-1*1.7976931348623157E308,1.7976931348623157E308);break;default:throw a.g.X("internal error");}return c};c.prototype.gA=function(a){if(this.En==b.FloatingPoint)return 0;switch(a){case 0:return 1/this.uj;case 1:return 1/this.Jn;case 2:return 1/this.Jn;default:return 0}};c.prototype.toString=function(){var a;a="SRPD [m_toleranceXY: "+this.il.toString();a=a+";m_falseX: "+this.Xl.toString();a=a+";m_falseY: "+this.Yl.toString();a=a+";m_unitsXY: "+
this.uj.toString();a=a+";m_falseZ: "+this.Tw.toString();a=a+";m_unitsZ: "+this.Jn.toString();a=a+";m_falseM: "+this.Sw.toString();a=a+";m_toleranceZ: "+this.Cr.toString();a=a+";m_toleranceM: "+this.Br.toString();a=a+";m_precision: "+this.En.toString();return a+"] "};return c}();a.fE=c})(x||(x={}));(function(a){function b(a,b){89.99999<b?b=89.99999:-89.99999>b&&(b=-89.99999);b*=.017453292519943;return[111319.49079327169*a,3189068.5*Math.log((1+Math.sin(b))/(1-Math.sin(b)))]}function c(a,b,c){a=a/6378137*
57.29577951308232;return c?[a,57.29577951308232*(1.5707963267948966-2*Math.atan(Math.exp(-1*b/6378137)))]:[a-360*Math.floor((a+180)/360),57.29577951308232*(1.5707963267948966-2*Math.atan(Math.exp(-1*b/6378137)))]}function d(b,c){var d=b.Vf();if(33===b.G()){var e=c(d.Be(),d.nf());d.rb(e[0],e[1])}else if(197===b.G())e=c(b.R.o,b.R.A,!0),b=c(b.R.v,b.R.B,!0),d.I(e[0],e[1],b[0],b[1]);else for(e=new a.b,b=0;b<d.D();b++){d.w(b,e);var f=c(e.x,e.y,!0);e.ka(f[0],f[1]);d.rb(b,e)}return d}function e(a){return d(a,
c)}function f(a){return d(a,b)}var h=Math.PI/180,l=function(){function b(){}b.Ru=function(b){var c=Math.sqrt(.006694379990197414),d=Math.sin(b.y*h);return a.b.pa(6378137*b.x*h,3167719.6636462314*(d/(1-.006694379990197414*d*d)-1/(2*c)*Math.log((1-c*d)/(1+c*d))))};b.EA=function(b,c,d,e){var f=1/298.257223563,g=Math.sin(d);d=Math.cos(d);var k=(1-f)*Math.tan(b);b=1/Math.sqrt(1+k*k);for(var l=k*b,n=Math.atan2(k,d),k=b*g,m=k*k,p=1-m,q=2.7233160610754688E11*p/4.040829998466145E13,r=1+q/16384*(4096+q*(-768+
q*(320-175*q))),t=q/1024*(256+q*(-128+q*(74-47*q))),q=e/(6356752.31424518*r),u=2*Math.PI,y,v,A,w;1E-12<Math.abs(q-u);)A=Math.cos(2*n+q),y=Math.sin(q),v=Math.cos(q),w=t*y*(A+t/4*(v*(-1+2*A*A)-t/6*A*(-3+4*y*y)*(-3+4*A*A))),u=q,q=e/(6356752.31424518*r)+w;e=l*y-b*v*d;p=f/16*p*(4+f*(4-3*p));return a.b.pa((c+(Math.atan2(y*g,b*v-l*y*d)-(1-p)*f*k*(q+p*y*(A+p*v*(-1+2*A*A)))))/h,Math.atan2(l*v+b*y*d,(1-f)*Math.sqrt(m+e*e))/h)};b.CM=function(a,b,c,d){var e=1/298.257223563,f=d-b,g=Math.atan((1-e)*Math.tan(a)),
k=Math.atan((1-e)*Math.tan(c)),h=Math.sin(g),g=Math.cos(g),l=Math.sin(k),k=Math.cos(k),n=f,m,p=1E3,q,r,t,u,y,v,A;do{t=Math.sin(n);u=Math.cos(n);r=Math.sqrt(k*t*k*t+(g*l-h*k*u)*(g*l-h*k*u));if(0===r)return 0;u=h*l+g*k*u;y=Math.atan2(r,u);v=g*k*t/r;q=1-v*v;t=u-2*h*l/q;isNaN(t)&&(t=0);A=e/16*q*(4+e*(4-3*q));m=n;n=f+(1-A)*e*v*(y+A*r*(t+A*u*(-1+2*t*t)))}while(1E-12<Math.abs(n-m)&&0<--p);if(0===p)return h=d-b,{azimuth:Math.atan2(Math.sin(h)*Math.cos(c),Math.cos(a)*Math.sin(c)-Math.sin(a)*Math.cos(c)*Math.cos(h)),
geodesicDistance:6371008.771415059*Math.acos(Math.sin(a)*Math.sin(c)+Math.cos(a)*Math.cos(c)*Math.cos(d-b))};a=2.7233160610754688E11*q/4.040829998466145E13;b=a/1024*(256+a*(-128+a*(74-47*a)));return{azimuth:Math.atan2(k*Math.sin(n),g*l-h*k*Math.cos(n)),PS:6356752.31424518*(1+a/16384*(4096+a*(-768+a*(320-175*a))))*(y-b*r*(t+b/4*(u*(-1+2*t*t)-b/6*t*(-3+4*r*r)*(-3+4*t*t)))),P_:Math.atan2(g*Math.sin(n),g*l*Math.cos(n)-h*k)}};b.BR=function(b){var c=b.hasAttribute(1),d=b.hasAttribute(2),e=[],f=b.aa(),g=
null,k=null;c&&(g=b.Pa(1));d&&(k=b.Pa(2));for(var h=new a.b,l=0;l<f;l++){for(var n=b.wa(l),m=b.La(l),p=0,q=0,r=NaN,t=NaN,u=NaN,y=NaN,v=b.Qb(l),A=[],w=n;w<n+m;w++){b.w(w,h);var y=u=NaN,x=[h.x,h.y];c&&(u=g.get(w),x.push(u));d&&(f=k.get(w),x.push(y));w==n&&v&&(p=h.x,q=h.y,r=u,t=y);A.push(x)}!v||p==h.x&&q==h.y&&(!c||isNaN(r)&&isNaN(u)||r==u)&&(!d||isNaN(t)&&isNaN(y)||t==y)||A.push(A[0].slice(0));e.push(A)}return e};b.Fz=function(a,c){a=b.BR(a);637.100877141506>c&&(c=637.100877141506);for(var d=[],e,f=
0;f<a.length;f++){var g=a[f];d.push(e=[]);e.push([g[0][0],g[0][1]]);var k,l,n,m,p,q;k=g[0][0]*h;l=g[0][1]*h;for(p=0;p<g.length-1;p++)if(n=g[p+1][0]*h,m=g[p+1][1]*h,k!==n||l!==m){m=b.CM(l,k,m,n);n=m.azimuth;m=m.PS;var r=m/c;if(1<r){for(q=1;q<=r-1;q++){var t=b.EA(l,k,n,q*c);e.push([t.x,t.y])}q=b.EA(l,k,n,(m+Math.floor(r-1)*c)/2);e.push([q.x,q.y])}l=b.EA(l,k,n,m);e.push([l.x,l.y]);k=l.x*h;l=l.y*h}}return{gK:d}};b.OS=function(c){for(var d=[],e=0;e<c.length;e++){var f=c[e],f=b.Fz(f,1E4);d.push(f)}c=[];
for(var g=0;g<d.length;g++){for(var f=d[g],k=0,e=0;e<f.gK.length;e++){var h=f.gK[e],l=b.Ru(a.b.pa(h[0][0],h[0][1])),n=b.Ru(a.b.pa(h[h.length-1][0],h[h.length-1][1])),m=n.x*l.y-l.x*n.y,p;for(p=0;p<h.length-1;p++)l=b.Ru(a.b.pa(h[p+1][0],h[p+1][1])),n=b.Ru(a.b.pa(h[p][0],h[p][1])),m+=n.x*l.y-l.x*n.y;k+=m}k/=1;c.push(k/-2)}return c};return b}();a.rM=l;l=function(){function b(){}b.YB=function(a,c,d,e,f,g,k){b.vD[a.jc()]=c;0==isNaN(d)&&(b.xD[a.jc()]=d);0==isNaN(e)&&(b.YD[a.jc()]=e);0==isNaN(f)&&(b.pD[a.jc()]=
f);b.zD[a.jc()]=g;null!==k&&(b.BD[a.jc()]=k)};b.Ix=function(a,c,d){b.SD[a.jc()+"-"+c.jc()]=d};b.lc=function(c){c=b.vD[c.jc()];if(void 0==c)throw a.g.df();return c};b.ee=function(c){c=b.xD[c.jc()];if(void 0==c)throw a.g.df();return c};b.hw=function(c){c=b.YD[c.jc()];if(void 0==c)throw a.g.df();return c};b.Sv=function(c){c=b.pD[c.jc()];if(void 0==c)throw a.g.df();return c};b.Bh=function(c){c=b.BD[c.jc()];if(void 0==c)throw a.g.df();return a.h.pa(c[0],c[1],c[2],c[3])};b.Jc=function(c){c=b.zD[c.jc()];
if(void 0==c)throw a.g.df();return c};b.Xg=function(c,d,e){if(d.Eb(e))return c;var f=b.SD[d.jc()+"-"+e.jc()];if(void 0!==f)return f(c,d,e);throw a.g.df();};b.lu=function(){throw a.g.df();};b.US=function(){throw a.g.df();};b.VW=function(){throw a.g.df();};b.Lk=function(){throw a.g.df();};b.sX=function(){var b=a.Rd.create(102100),c=a.Rd.create(3857),d=a.Rd.create(4326);a.fb.YB(b,d,NaN,NaN,NaN,!1,null);a.fb.YB(d,d,1,.0033528106647474805,6378137,!0,[-180,-90,180,90]);a.fb.YB(c,d,NaN,NaN,NaN,!1,null);
a.fb.Ix(b,d,e);a.fb.Ix(d,b,f);a.fb.Ix(c,d,e);a.fb.Ix(d,c,f)};b.vD=[];b.xD=[];b.YD=[];b.pD=[];b.zD=[];b.BD=[];b.SD=[];return b}();a.fb=l})(x||(x={}));x.fb.sX();(function(a){var b=function(){function b(a){this.f=null;this.kh=-1;this.yd=this.size=this.Jf=0;this.ed=a}b.prototype.kd=function(a){a<this.Jf?(this.f[a*this.ed]=this.kh,this.kh=a):this.Jf--;this.size--};b.prototype.S=function(a,b){return this.f[a*this.ed+b]};b.prototype.P=function(a,b,c){this.f[a*this.ed+b]=c};b.prototype.Pe=function(){var b=
this.kh;if(-1==b){if(this.Jf==this.yd){b=0!=this.yd?a.J.truncate(3*(this.yd+1)/2):1;2147483647<b&&(b=2147483647);if(b==this.yd)throw a.g.wd();this.Co(b)}b=this.Jf;this.Jf++}else this.kh=this.f[b*this.ed];this.size++;for(var c=b*this.ed+this.ed,d=b*this.ed;d<c;d++)this.f[d]=-1;return b};b.prototype.ml=function(b){var c=this.kh;if(-1==c){if(this.Jf==this.yd){c=0!=this.yd?a.J.truncate(3*(this.yd+1)/2):1;2147483647<c&&(c=2147483647);if(c==this.yd)throw a.g.wd();this.Co(c)}c=this.Jf;this.Jf++}else this.kh=
this.f[c*this.ed];this.size++;for(var d=c*this.ed,f=this.ed,k=0;k<f;k++)this.f[d+k]=b[k];return c};b.prototype.Vi=function(a){this.kh=-1;this.size=this.Jf=0;a&&(this.f=null,this.yd=0)};b.prototype.Qe=function(a){a>this.yd&&this.Co(a)};b.prototype.ay=function(a,b,c){var d=this.f[this.ed*b+c];this.f[this.ed*b+c]=this.f[this.ed*a+c];this.f[this.ed*a+c]=d};b.Im=function(){return-2};b.jo=function(){return-3};b.CA=function(a){return 0<=a};b.prototype.Co=function(a){null==this.f&&(this.f=[]);this.yd=a};
return b}();a.ad=b;b=function(){function b(a){this.f=new Int32Array(0);this.kh=-1;this.yd=this.size=this.Jf=0;this.ed=a}b.prototype.kd=function(a){a<this.Jf?(this.f[a*this.ed]=this.kh,this.kh=a):this.Jf--;this.size--};b.prototype.S=function(a,b){return this.f[a*this.ed+b]};b.prototype.P=function(a,b,c){this.f[a*this.ed+b]=c};b.prototype.Pe=function(){var b=this.kh;if(-1==b){if(this.Jf==this.yd){b=0!=this.yd?a.J.truncate(3*(this.yd+1)/2):1;2147483647<b&&(b=2147483647);if(b==this.yd)throw a.g.wd();
this.Co(b)}b=this.Jf;this.Jf++}else this.kh=this.f[b*this.ed];this.size++;for(var c=b*this.ed;c<b*this.ed+this.ed;c++)this.f[c]=-1;return b};b.prototype.ml=function(b){var c=this.kh;if(-1==c){if(this.Jf==this.yd){c=0!=this.yd?a.J.truncate(3*(this.yd+1)/2):1;2147483647<c&&(c=2147483647);if(c==this.yd)throw a.g.wd();this.Co(c)}c=this.Jf;this.Jf++}else this.kh=this.f[c*this.ed];this.size++;for(var d=c*this.ed,f=0;f<b.length;f++)this.f[d+f]=b[f];return c};b.prototype.Vi=function(a){this.kh=-1;this.size=
this.Jf=0;a&&(this.f=null,this.yd=0)};b.prototype.Qe=function(a){a>this.yd&&this.Co(a)};b.prototype.ay=function(a,b,c){var d=this.f[this.ed*b+c];this.f[this.ed*b+c]=this.f[this.ed*a+c];this.f[this.ed*a+c]=d};b.Im=function(){return-2};b.jo=function(){return-3};b.CA=function(a){return 0<=a};b.prototype.Co=function(a){null==this.f&&(this.f=new Int32Array(0));var b=new Int32Array(this.ed*a);b.set(this.f,0);this.f=b;this.yd=a};return b}();a.aO=b;!0===a.Xh.Bm&&(a.ad=a.aO)})(x||(x={}));(function(a){var b;
(function(a){a[a.enumInputModeBuildGraph=0]="enumInputModeBuildGraph";a[a.enumInputModeSimplifyAlternate=4]="enumInputModeSimplifyAlternate";a[a.enumInputModeSimplifyWinding=5]="enumInputModeSimplifyWinding";a[a.enumInputModeIsSimplePolygon=7]="enumInputModeIsSimplePolygon"})(b||(b={}));var c=function(){function b(b){this.bf=b;this.Wh=NaN;this.qI=new a.Cg;this.rI=new a.Cg;this.it=new a.zc;this.jt=new a.zc}b.prototype.compare=function(a,b,c){a=a.ja(c);this.bf.RB(b,this.qI);this.bf.RB(a,this.rI);b=
this.qI.get();a=this.rI.get();this.it.I(b.ua,b.sa);this.jt.I(a.ua,a.sa);if(this.it.ha<this.jt.ca)return-1;if(this.it.ca>this.jt.ha)return 1;c=b.ra==b.oa;var d=a.ra==a.oa;if(c||d){if(c&&d)return 0;if(b.ra==a.ra&&b.ua==a.ua)return c?1:-1;if(b.oa==a.oa&&b.sa==a.sa)return c?-1:1}c=b.pf(this.Wh,this.it.ca);d=a.pf(this.Wh,this.jt.ca);c==d&&(c=Math.min(b.oa,a.oa),d=.5*(c+this.Wh),d==this.Wh&&(d=c),c=b.pf(d,this.it.ca),d=a.pf(d,this.jt.ca));return c<d?-1:c>d?1:0};b.prototype.RK=function(a){this.Wh=a};return b}(),
d=function(){function b(b){this.bb=b;this.jJ=new a.Cg;this.cg=new a.b;this.dB=new a.zc}b.prototype.fY=function(a){this.cg.L(a)};b.prototype.compare=function(a,b){this.bb.RB(a.ja(b),this.jJ);a=this.jJ.get();this.dB.I(a.ua,a.sa);if(this.cg.x<this.dB.ca)return-1;if(this.cg.x>this.dB.ha)return 1;a=a.pf(this.cg.y,this.cg.x);return this.cg.x<a?-1:this.cg.x>a?1:0};return b}();b=function(){function b(){this.tI=this.cj=this.fj=this.UA=this.No=this.Ye=this.Rc=this.Eh=this.De=null;this.sp=this.Tg=-1;this.sI=
!0;this.YA=!1;this.VA=NaN;this.mj=new a.$d;this.dQ=2147483647;this.cQ=a.J.truncate(-2147483648);this.xg=this.ye=this.km=this.rr=this.qn=this.qr=this.Jt=this.rf=-1;this.qa=0}b.prototype.ez=function(a){this.VA=a};b.prototype.Mn=function(){null==this.De&&(this.De=new a.ad(8));var b=this.De.Pe();this.De.P(b,1,0);return b};b.prototype.gW=function(){null==this.Rc&&(this.Rc=new a.ad(8));var b=this.Rc.Pe();this.Rc.P(b,2,0);this.Rc.P(b,3,0);var c=this.Rc.Pe();this.Rc.P(c,2,0);this.Rc.P(c,3,0);this.zK(b,c);
this.zK(c,b);return b};b.prototype.vJ=function(){null==this.Ye&&(this.Ye=new a.ad(8));var b=this.Ye.Pe();this.Ye.P(b,2,0);return b};b.prototype.RX=function(a,b){this.De.P(a,7,b)};b.prototype.bo=function(a,b){this.De.P(a,2,b)};b.prototype.QX=function(a,b){this.De.P(a,1,b)};b.prototype.gY=function(a,b){this.De.P(a,3,b)};b.prototype.dY=function(a,b){this.De.P(a,4,b)};b.prototype.Vr=function(a,b){this.De.P(a,5,b)};b.prototype.XS=function(a){return this.De.S(a,5)};b.prototype.PX=function(a,b){this.De.P(a,
6,b)};b.prototype.bP=function(a,b){this.PX(b,a)};b.prototype.yK=function(a,b){this.Rc.P(a,1,b)};b.prototype.zK=function(a,b){this.Rc.P(a,4,b)};b.prototype.ym=function(a,b){this.Rc.P(a,5,b)};b.prototype.xm=function(a,b){this.Rc.P(a,6,b)};b.prototype.WX=function(a,b){this.Rc.P(a,2,b)};b.prototype.Nx=function(a,b){this.Rc.P(a,3,b)};b.prototype.WG=function(a){return this.Rc.S(a,3)};b.prototype.uu=function(a,b){this.Rc.P(a,7,b)};b.prototype.xL=function(a,b){if(-1!=this.$m(a))for(b=b?-1:a,a=this.$m(a);-1!=
a;a=this.gt(a))this.a.Va(this.Uj(a),this.rr,b)};b.prototype.ey=function(a,b){-1!=a&&(this.xL(a,b),this.xL(this.Aa(a),b))};b.prototype.su=function(a,b){this.Ye.P(a,1,b)};b.prototype.rh=function(a,b){this.Ye.P(a,2,b)};b.prototype.Zn=function(a,b){this.Ye.P(a,3,b);this.NX(a,this.WS(b));this.MX(b,a)};b.prototype.MX=function(a,b){this.Ye.P(a,4,b)};b.prototype.NX=function(a,b){this.Ye.P(a,5,b)};b.prototype.tK=function(a,b){this.Ye.P(a,6,b)};b.prototype.rK=function(a,b){this.Ye.P(a,7,b)};b.prototype.qK=
function(a,b){this.No.write(a,b)};b.prototype.sK=function(a,b){this.UA.write(a,b)};b.prototype.iZ=function(b){var c=0,d=0,e=this.MG(b),f=new a.b,g=new a.b,k=new a.b;this.Ys(e,f);g.L(f);var h=e;do this.Zm(h,k),d+=a.b.Cb(g,k),this.Ef(this.Aa(h))!=b&&(c+=(k.x-f.x-(g.x-f.x))*(k.y-f.y+(g.y-f.y))*.5),g.L(k),h=this.qc(h);while(h!=e);this.No.write(b,c);this.UA.write(b,d)};b.prototype.DW=function(b){var e=new c(this),f=new a.uk;f.Qe(a.J.truncate(this.qa/2));f.Ep(e);for(var g=new a.ia(0),k=this.xh(),h=null,
l=0,m=new a.b,p=this.rf;-1!=p;p=this.og(p)){l++;var q=this.kf(p);if(-1!=q){g.yf(0);if(!this.bZ(f,k,g,q)){this.w(p,m);e.RK(m.y);var r=q;do{var t=this.Kb(r,k);-1!=t&&(f.Kd(t,-1),this.Ob(r,k,-2));r=this.qc(this.Aa(r))}while(q!=r);r=q;do t=this.Kb(r,k),-1==t&&(t=f.addElement(r,-1),g.add(t)),r=this.qc(this.Aa(r));while(q!=r)}for(q=g.size-1;0<=q;q--)t=g.get(q),r=f.ja(t),this.Ob(this.Aa(r),k,t),this.BW(f,t,b)}else-1==this.Lz(p)&&(null==h&&(h=new d(this)),this.w(p,m),h.fY(m),r=f.IX(h),q=this.km,-1!=r&&(t=
f.ja(r),this.Ef(t)==this.Ef(this.Aa(t))&&(t=this.YG(f,r)),-1!=t&&(q=this.Ef(t))),this.bP(q,p))}this.ni(k)};b.prototype.BW=function(a,b,c){var d=a.ja(b),e=this.Ef(d);if(-1==this.vo(e)){var f=this.YG(a,b),g=this.Aa(d),k=this.Ef(g);this.Dq(e);this.Dq(k);var h=this.vo(e),l=this.vo(k);-1==f&&-1==h&&(k==e?(this.Zn(k,this.km),h=l=this.km):(-1==l&&(this.Zn(k,this.km),l=this.km),this.Zn(e,k),h=k));if(-1!=f){var n=this.Ef(f);-1==l&&(0>=this.Dq(n)?(l=this.vo(n),this.Zn(k,l)):(this.Zn(k,n),l=n),k==e&&(h=l))}-1==
h&&this.cZ(e,k);0==c?this.aX(a,b,d,f,e,k):5==c?this.bX(a,b,d,g,e,k):4==c&&this.$W(d,f,e,k)}};b.prototype.aX=function(a,b,c,d,e,f){var g=this.Hk(e);if(-1!=d){var k=this.Hk(f),h=this.Hk(this.Ef(d));d=g&k&h;h^=h&this.Ah(c);h|=d;0!=h&&(this.rh(f,k|h),this.rh(e,h|g),g=g||h)}for(b=a.nb(b);-1!=b;b=a.nb(b)){d=a.ja(b);c=this.Ef(this.Aa(d));e=this.Hk(c);f=this.Ah(d);k=this.Ef(d);h=this.Hk(k);d=e&h&g;g^=g&f;g|=d;if(0==g)break;this.rh(c,e|g);this.rh(k,h|g)}};b.prototype.bX=function(b,c,d,e,f,k){if(f!=k){d=this.Kb(d,
this.xg);d+=this.Kb(e,this.xg);e=0;var g=new a.ia(0),h=new a.ia(0);h.add(0);for(var l=b.xc(-1);l!=c;l=b.nb(l)){var n=b.ja(l),m=this.Aa(n),p=this.Ef(n),q=this.Ef(m);if(p!=q){n=this.Kb(n,this.xg);n+=this.Kb(m,this.xg);e+=n;m=!1;0!=g.size&&g.Fc()==q&&(h.Pf(),g.Pf(),m=!0);if(-1==this.vo(q))throw a.g.za();m&&this.vo(q)==p||(h.add(e),g.add(p))}}e+=d;0!=g.size&&g.Fc()==k&&(h.Pf(),g.Pf());0!=e?0==h.Fc()&&(b=this.a.rd,b=this.Ia(b),this.rh(f,b)):0!=h.Fc()&&(b=this.a.rd,b=this.Ia(b),this.rh(f,b))}};b.prototype.$W=
function(a,b,c,d){var e=this.Ia(this.a.rd);if(-1==b)this.rh(d,this.sp),a=this.Kb(a,this.Tg),0!=(a&1)?this.rh(c,e):this.rh(c,this.sp);else{var f=this.Hk(d);0==f&&(f=this.Hk(this.Ef(b)),this.rh(d,f));a=this.Kb(a,this.Tg);0!=(a&1)?this.rh(c,f==e?this.sp:e):this.rh(c,f)}};b.prototype.bZ=function(a,b,c,d){var e=d,f=-1,g=-1,k=0;do{if(2==k)return!1;var h=this.Kb(e,b);if(-1!=h){if(-1!=f)return!1;f=h}else{if(-1!=g)return!1;g=e}k++;e=this.qc(this.Aa(e))}while(d!=e);if(-1==g||-1==f)return!1;this.Ob(a.ja(f),
b,-2);a.kk(f,g);c.add(f);return!0};b.prototype.cZ=function(a,b){var c=this.Dq(a);if(0!=c){var d=this.Dq(b);0<c&&0>d?this.Zn(a,b):0>c&&0<d?this.Zn(a,b):(c=this.vo(b),-1!=c&&this.Zn(a,c))}};b.prototype.uR=function(b,c){this.rr=this.a.Ud();for(var d=0,e=c.size;d<e;d++){var f=c.get(d),g=this.a.Sa(f,this.qn),k=this.a.ng(this.a.ld(f)),h=this.a.hc(k);if(a.T.Ic(h)){var l=this.a.U(f);if(-1!=l){var m=this.a.Sa(l,this.qn);if(g!=m){var n=this.gW(),p=this.Aa(n),q=this.Eh.Pe();this.Eh.P(q,0,f);this.Eh.P(q,1,-1);
this.uu(n,q);this.yK(n,g);q=this.kf(g);-1==q?(this.bo(g,n),this.ym(n,p),this.xm(p,n)):(g=this.Te(q),this.ym(q,p),this.xm(p,q),this.xm(g,n),this.ym(n,g));this.yK(p,m);g=this.kf(m);-1==g?(this.bo(m,p),this.xm(n,p),this.ym(p,n)):(m=this.Te(g),this.ym(g,n),this.xm(n,g),this.xm(m,p),this.ym(p,m));k=this.Ia(k);0==b?(this.Ob(p,this.ye,0),this.Ob(n,this.ye,1736==h?k:0)):5==b?(m=new a.b,this.a.w(f,m),f=new a.b,this.a.w(l,f),g=l=0,0>m.compare(f)?l=1:g=-1,this.Ob(p,this.ye,0),this.Ob(n,this.ye,0),this.Ob(n,
this.xg,l),this.Ob(p,this.xg,g)):7==b?(this.Ob(p,this.ye,this.sp),this.Ob(n,this.ye,1736==h?k:0)):4==b&&(this.Ob(p,this.ye,0),this.Ob(n,this.ye,0),this.Ob(n,this.Tg,1),this.Ob(p,this.Tg,1));h=1736==h?this.cQ:0;this.Nx(n,k|h);this.Nx(p,k|h)}}}}};b.prototype.VV=function(a,b){var c=this.$m(b);if(-1!=c){var d=this.$m(a);this.Eh.P(c,1,d);this.uu(a,c);this.uu(b,-1)}a=this.Aa(a);b=this.Aa(b);c=this.$m(b);-1!=c&&(d=this.$m(a),this.Eh.P(c,1,d),this.uu(a,c),this.uu(b,-1))};b.prototype.DY=function(b){function c(a,
b){return e.LQ(a,b)}var d=new a.ia(0);d.yb(10);for(var e=this,f=this.rf;-1!=f;f=this.og(f)){d.clear(!1);var g=this.kf(f);if(-1!=g){var k=g;do d.add(k),k=this.qc(this.Aa(k));while(k!=g);if(1<d.size){k=!0;if(2<d.size)d.Gd(0,d.size,c),d.add(d.get(0));else if(0<this.KQ(d.get(0),d.get(1))){var h=d.get(0);d.set(0,d.get(1));d.set(1,h)}else k=!1;for(var l=h=d.get(0),m=this.Xf(l),p=this.Aa(l),q=-1,r=1,t=d.size;r<t;r++){var u=d.get(r),v=this.Aa(u),A=this.Jk(v);if(A==m&&u!=l){if(0==b)q=this.WG(l)|this.WG(u),
this.Nx(l,q),this.Nx(p,q),this.Ob(l,this.ye,this.Kb(l,this.ye)|this.Kb(u,this.ye)),this.Ob(p,this.ye,this.Kb(p,this.ye)|this.Kb(v,this.ye));else if(-1!=this.xg)q=this.Kb(l,this.xg)+this.Kb(u,this.xg),v=this.Kb(p,this.xg)+this.Kb(v,this.xg),this.Ob(l,this.xg,q),this.Ob(p,this.xg,v);else{if(7==b){this.mj=new a.$d(5,f,-1);return}-1!=this.Tg&&(q=this.Kb(l,this.Tg)+this.Kb(u,this.Tg),v=this.Kb(p,this.Tg)+this.Kb(v,this.Tg),this.Ob(l,this.Tg,q),this.Ob(p,this.Tg,v))}this.VV(l,u);this.sz(u);q=l;d.set(r,
-1);u==h&&(d.set(0,-1),h=-1)}else this.ey(q,!1),q=-1,l=u,m=A,p=v}this.ey(q,!1);q=-1;if(k){h=-1;r=0;for(t=d.size;r<t;r++)if(u=d.get(r),-1!=u)if(-1==h)l=h=u,m=this.Xf(l),p=this.Aa(l);else if(u!=l&&(v=this.Aa(u),A=this.Jk(v),this.xm(p,u),this.ym(u,p),l=u,m=A,p=v,7==b&&(this.Kb(u,this.ye)|this.Kb(this.Te(u),this.ye))==(this.sp|1))){this.mj=new a.$d(5,f,-1);return}this.bo(f,h)}else{h=-1;r=0;for(t=d.size;r<t;r++)if(u=d.get(r),-1!=u){h=u;break}g!=h&&this.bo(f,h)}}}}};b.prototype.$P=function(){for(var b=
-1,c=this.xh(),d=this.rf;-1!=d;d=this.og(d)){var e=this.kf(d);if(-1!=e){var f=e;do{if(1!=this.Kb(f,c)){var k=this.vJ();this.su(k,f);this.rK(k,b);-1!=b&&this.tK(b,k);var b=k,h=0,l=f;do h|=this.Kb(l,this.ye),this.WX(l,k),this.Ob(l,c,1),l=this.qc(l);while(l!=f);this.rh(k,h)}f=this.qc(this.Aa(f))}while(f!=e)}}k=this.vJ();this.su(k,-1);this.rK(k,b);-1!=b&&this.tK(b,k);this.km=k;this.No=a.Qd.zd(this.Ye.size,NaN);this.UA=a.Qd.zd(this.Ye.size,NaN);this.qK(this.km,Infinity);this.sK(this.km,Infinity);this.ni(c)};
b.prototype.jT=function(a,b,c){b=-1!=b?b:this.kf(a);if(-1==b)return-1;for(a=b;;){if(1!=this.Kb(b,c))return b;b=this.qc(this.Aa(b));if(b==a)return-1}};b.prototype.wX=function(){for(var a=this.xh(),b=this.rf;-1!=b;b=this.og(b))for(var c=-1;;){var d=this.jT(b,c,a);if(-1==d)break;for(var c=this.qc(this.Aa(d)),e=d;;){var f=this.qc(e),k=this.Te(e),h=this.Aa(e);if(k==h){this.FR(e);if(c==e||c==h)c=-1;if(e==d||k==d){d=f;if(e==d||k==d)break;e=f;continue}}else this.Ob(e,a,1);e=f;if(e==d)break}}};b.prototype.nC=
function(b,c,d,e){this.qh();this.sI=e;this.a=b;this.qr=this.a.iG();b=new a.ia(0);b.yb(null!=d?this.a.D(d.get(0)):this.a.vd);var f=0,g=1,k=null!=d?d.get(0):this.a.rd;for(e=1;-1!=k;){this.a.xK(k,this.qr,g);for(var g=g<<1,h=this.a.Pb(k);-1!=h;h=this.a.Sb(h))for(var l=this.a.cb(h),m=0,n=this.a.La(h);m<n;m++)b.add(l),l=this.a.U(l);a.T.Jo(this.a.hc(k))||(f+=this.a.aa(k));null!=d?(k=e<d.size?d.get(e):-1,e++):k=this.a.Ue(k)}this.sp=g;this.qa=b.size;this.a.Xx(b,this.qa);null==this.Eh&&(this.Eh=new a.ad(2),
this.De=new a.ad(8),this.Rc=new a.ad(8),this.Ye=new a.ad(8));this.Eh.Qe(this.qa);this.De.Qe(this.qa+10);this.Rc.Qe(2*this.qa+32);this.Ye.Qe(Math.max(32,f));this.qn=this.a.Ud();d=new a.b;e=0;f=new a.b;d.$c();for(g=0;g<=this.qa;g++)if(g<this.qa?(l=b.get(g),this.a.w(l,f)):f.$c(),!d.ub(f)){if(e<g){l=this.Mn();for(n=m=-1;e<g;e++)n=b.get(e),this.a.Va(n,this.qn,l),k=this.Eh.Pe(),this.Eh.P(k,0,n),this.Eh.P(k,1,m),m=k,h=this.a.ld(n),k=this.a.ng(h),k=this.Ia(k),this.QX(l,this.Md(l)|k);this.RX(l,m);this.Vr(l,
this.a.Za(n));-1!=this.Jt&&this.dY(this.Jt,l);this.gY(l,this.Jt);this.Jt=l;-1==this.rf&&(this.rf=l)}e=g;d.L(f)}this.ye=this.xh();5==c&&(this.xg=this.xh());4==c&&(this.Tg=this.xh());this.uR(c,b);0==this.mj.Ii&&(this.DY(c),0==this.mj.Ii&&(isNaN(this.VA)||this.BQ()?(this.$P(),0==this.mj.Ii&&(this.ni(this.ye),this.ye=-1,this.sI&&this.DW(c))):this.YA=!0))};b.prototype.sz=function(a){var b=this.qc(a),c=this.Te(a),d=this.Aa(a),e=this.qc(d),f=this.Te(d);b!=d&&(this.xm(f,b),this.ym(b,f));c!=d&&(this.xm(c,
e),this.ym(e,c));c=this.Jk(a);this.kf(c)==a&&(e!=a?this.bo(c,e):this.bo(c,-1));e=this.Jk(d);this.kf(e)==d&&(b!=d?this.bo(e,b):this.bo(e,-1));this.Rc.kd(a);this.Rc.kd(d)};b.prototype.YG=function(a,b){for(;;)if(b=a.Ve(b),-1!=b){var c=a.ja(b);if(this.Ef(c)!=this.Ef(this.Aa(c)))return c}else return-1};b.prototype.Wr=function(a,b,c){void 0===c&&(c=!0);this.nC(a,0,null,c)};b.prototype.mK=function(b,c){var d=new a.ia(0);d.add(c);this.nC(b,4,d,1736==b.hc(c))};b.prototype.nK=function(b,c){var d=new a.ia(0);
d.add(c);this.nC(b,5,d,!0)};b.prototype.qh=function(){null!=this.a&&(-1!=this.qr&&(this.a.vX(this.qr),this.qr=-1),-1!=this.qn&&(this.a.le(this.qn),this.qn=-1),-1!=this.rr&&(this.a.le(this.rr),this.rr=-1),-1!=this.ye&&(this.ni(this.ye),this.ye=-1),-1!=this.xg&&(this.ni(this.xg),this.xg=-1),-1!=this.Tg&&(this.ni(this.Tg),this.Tg=-1),this.a=null,this.De.Vi(!0),this.Eh.Vi(!0),this.Jt=this.rf=-1,null!=this.Rc&&this.Rc.Vi(!0),null!=this.fj&&(this.fj.length=0),null!=this.cj&&(this.cj.length=0),null!=this.tI&&
(this.tI.length=0),null!=this.Ye&&this.Ye.Vi(!0),this.km=-1,this.No=null)};b.prototype.kf=function(a){return this.De.S(a,2)};b.prototype.w=function(a,b){this.a.pH(this.XS(a),b)};b.prototype.Md=function(a){return this.De.S(a,1)};b.prototype.og=function(a){return this.De.S(a,4)};b.prototype.Lz=function(a){return this.De.S(a,6)};b.prototype.Ym=function(a){return this.De.S(a,7)};b.prototype.gt=function(a){return this.Eh.S(a,1)};b.prototype.Uj=function(a){return this.Eh.S(a,0)};b.prototype.Hg=function(a,
b){b=this.cj[b];return b.size<=a?-1:b.read(a)};b.prototype.co=function(a,b,c){b=this.cj[b];b.size<=a&&b.resize(this.De.size,-1);b.write(a,c)};b.prototype.wq=function(){null==this.cj&&(this.cj=[]);for(var b=a.ia.zd(this.De.yd,-1),c=0,d=this.cj.length;c<d;c++)if(null==this.cj[c])return this.cj[c]=b,c;this.cj.push(b);return this.cj.length-1};b.prototype.xq=function(a){this.cj[a]=null};b.prototype.Jk=function(a){return this.Rc.S(a,1)};b.prototype.Xf=function(a){return this.Jk(this.Aa(a))};b.prototype.Aa=
function(a){return this.Rc.S(a,4)};b.prototype.Te=function(a){return this.Rc.S(a,5)};b.prototype.qc=function(a){return this.Rc.S(a,6)};b.prototype.Ef=function(a){return this.Rc.S(a,2)};b.prototype.Ff=function(a){return this.Hk(this.Rc.S(a,2))};b.prototype.$m=function(a){return this.Rc.S(a,7)};b.prototype.Ys=function(a,b){this.w(this.Jk(a),b)};b.prototype.Zm=function(a,b){this.w(this.Xf(a),b)};b.prototype.Ah=function(a){return this.Rc.S(a,3)&this.dQ};b.prototype.Kb=function(a,b){b=this.fj[b];return b.size<=
a?-1:b.read(a)};b.prototype.Ob=function(a,b,c){b=this.fj[b];b.size<=a&&b.resize(this.Rc.size,-1);b.write(a,c)};b.prototype.xh=function(){null==this.fj&&(this.fj=[]);for(var b=a.ia.zd(this.Rc.yd,-1),c=0,d=this.fj.length;c<d;c++)if(null==this.fj[c])return this.fj[c]=b,c;this.fj.push(b);return this.fj.length-1};b.prototype.ni=function(a){this.fj[a]=null};b.prototype.FR=function(a){var b=this.Ef(a),c=this.qc(a);c==this.Aa(a)&&(c=this.qc(c),c==a&&(c=-1));this.MG(b)==a&&this.su(b,c);c=this.No.read(b);isNaN(c)||
(this.qK(b,NaN),this.sK(b,NaN));this.ey(a,!0);this.sz(a)};b.prototype.GR=function(a){for(var b=0,c=a.size;b<c;b++){var d=a.get(b),e=this.Ef(this.Aa(d));this.su(this.Ef(d),-1);this.su(e,-1);this.ey(d,!0);this.sz(d)}};b.prototype.MG=function(a){return this.Ye.S(a,1)};b.prototype.Hk=function(a){return this.Ye.S(a,2)};b.prototype.vo=function(a){return this.Ye.S(a,3)};b.prototype.WS=function(a){return this.Ye.S(a,4)};b.prototype.Dq=function(a){var b=this.No.read(a);isNaN(b)&&(this.iZ(a),b=this.No.read(a));
return b};b.prototype.Ia=function(a){return this.a.VG(a,this.qr)};b.prototype.jf=function(a){return this.a.Sa(a,this.qn)};b.prototype.mT=function(a){return this.a.Sa(a,this.rr)};b.prototype.lT=function(a,b){var c=this.kf(a);if(-1==c)return-1;var d=c,e=-1,f=-1;do{if(this.Xf(d)==b)return d;if(-1==e){e=this.kf(b);if(-1==e)break;f=e}if(this.Xf(f)==a)return d=this.Aa(f);d=this.qc(this.Aa(d));f=this.qc(this.Aa(f))}while(d!=c&&f!=e);return-1};b.prototype.RB=function(b,c){c.Js();c=c.get();var d=new a.b;this.Ys(b,
d);c.Mc(d);this.Zm(b,d);c.Zc(d)};b.prototype.LQ=function(b,c){if(b==c)return 0;var d=new a.b;this.Zm(b,d);var e=new a.b;this.Zm(c,e);if(d.ub(e))return 0;c=new a.b;this.Ys(b,c);b=new a.b;b.yc(d,c);d=new a.b;d.yc(e,c);return a.b.vs(b,d)};b.prototype.KQ=function(b,c){if(b==c)return 0;var d=new a.b;this.Zm(b,d);var e=new a.b;this.Zm(c,e);if(d.ub(e))return 0;c=new a.b;this.Ys(b,c);b=new a.b;b.yc(d,c);d=new a.b;d.yc(e,c);return 0<=d.y&&0<b.y?a.b.vs(b,d):0};b.prototype.BQ=function(){for(var b=a.Ub.Yx(this.VA),
c=new a.b,d=new a.b,e=new a.b,f=new a.b,k=new a.b,h=this.rf;-1!=h;h=this.og(h)){var l=this.kf(h);if(-1!=l){var m=l;this.Ys(m,c);this.Zm(m,d);k.yc(d,c);var p=k.qk();do{var q=m,m=this.qc(this.Aa(m));if(m!=q){this.Zm(m,e);f.yc(e,c);var q=f.qk(),r=f.Ui(k);if(r*r/(q*p)*Math.min(q,p)<=b)return!1;k.L(f);p=q;d.L(e)}}while(m!=l)}}return!0};return b}();a.Qu=b})(x||(x={}));(function(a){var b=function(){function b(){this.i=null;this.AI=new a.b;this.BI=new a.b;this.Mh=null;this.pt=!1;this.Wo=-1}b.prototype.Gf=
function(a){return a<this.Mh.length?this.Mh[a]:!1};b.prototype.Hl=function(b,c,d,f){var e=a.T.lf(this.i.a.hc(d));if(2==a.T.lf(this.i.a.hc(c))&&1==e)this.AR(b,c,d,f);else throw a.g.za();};b.prototype.Wr=function(b,c){null==this.i&&(this.i=new a.Qu);this.i.Wr(b,c)};b.prototype.Xr=function(b,c,d){a.sk.V(b,c,d,!0);for(c=b.rd;-1!=c;c=b.Ue(c))1736==b.hc(c)&&a.lo.V(b,c,-1,this.pt,d);this.Wr(b,d)};b.prototype.TF=function(a,b,c,d,f){var e=this.i.a;if(1736==e.hc(a))for(a=e.Pb(a);-1!=a;a=e.Sb(a)){var g=e.cb(a);
this.i.jf(g);this.i.jf(e.U(g));var k=this.i.mT(g);if(-1!=k){var h=this.i.Kb(k,c);if(1!=h&&2!=h)if(this.Gf(this.i.Ff(k))){this.i.Ob(k,c,1);var h=e.Yf(b,-1),l=k,m=this.i.jf(g),n=1;do{var p=this.gn(g,f);e.Kj(h,p);-1!=d&&this.i.co(m,d,1);this.i.Ob(l,c,1);var l=this.i.qc(l),q;do p=1==n?e.U(g):e.Ra(g),q=-1!=p?this.i.jf(p):-1;while(q==m);var r=this.i.Jk(l);if(r!=q){do p=1==n?e.Ra(g):e.U(g),q=-1!=p?this.i.jf(p):-1;while(q==m);r!=q?(q=r,p=this.i.Uj(this.i.Ym(q))):n=-n}m=q;g=p}while(l!=k);e.$n(h,!0)}else this.i.Ob(k,
c,2)}}};b.prototype.oG=function(){for(var b=this.i.xh(),c=new a.ia(0),d=this.i.rf;-1!=d;d=this.i.og(d)){var f=this.i.kf(d),h=f;if(-1!=f){do{if(1!=this.i.Kb(h,b)){var l=this.i.Aa(h);this.i.Ob(l,b,1);this.i.Ob(h,b,1);this.Gf(this.i.Ff(h))&&this.Gf(this.i.Ff(l))&&c.add(h)}h=this.i.qc(this.i.Aa(h))}while(h!=f)}}this.i.ni(b);this.i.GR(c)};b.prototype.gn=function(a,b){return-1==b?a:this.WT(a,b)};b.prototype.WT=function(a,b){var c=this.i.a,d,e,f=this.i.Ym(this.i.jf(a));do{d=this.i.Uj(f);e=c.ng(c.ld(d));
if(e==b)return d;f=this.i.gt(f)}while(-1!=f);return a};b.prototype.es=function(b,c,d){this.oG();var e=this.i.a,f=e.bh(1736),g=this.i.xh();this.hL(b,c,f,d,g,-1);this.i.ni(g);a.lo.V(e,f,1,this.pt,null);return f};b.prototype.hL=function(a,b,c,d,f,h){this.TF(a,c,f,h,d);-1!=b&&this.TF(b,c,f,h,d);a=this.i.a;for(b=this.i.rf;-1!=b;b=this.i.og(b)){var e=this.i.kf(b);if(-1!=e){var g=e;do{var k=this.i.Kb(g,f);if(1!=k&&2!=k)if(this.Gf(this.i.Ff(g))){var k=a.Yf(c,-1),l=g;do{var m=this.i.$m(l);-1!=m?m=this.i.Uj(m):
(m=this.i.Uj(this.i.$m(this.i.Aa(l))),m=this.i.a.U(m));m=this.gn(m,d);a.Kj(k,m);this.i.Ob(l,f,1);-1!=h&&(m=this.i.jf(m),this.i.co(m,h,1));l=this.i.qc(l)}while(l!=g);a.$n(k,!0)}else this.i.Ob(g,f,2);g=this.i.qc(this.i.Aa(g))}while(g!=e)}}};b.prototype.VY=function(b,c,d){var e=this.i.a,f=e.bh(1736),g=e.bh(1607),k=e.bh(550);this.oG();var h=-1,l=this.i.xh(),m=this.i.wq();this.hL(b,c,f,d,l,m);for(b=this.i.rf;-1!=b;b=this.i.og(b))if(c=this.i.kf(b),-1!=c){var p=c;do{var q=this.i.Kb(p,l),r=this.i.Kb(this.i.Aa(p),
l),q=q|r;if(2==q)if(q=this.i.Ah(p),this.Gf(q)){var t=e.Yf(g,-1),u=p,q=this.Jx(b,e),q=this.gn(q,d);e.Kj(t,q);this.i.co(b,m,1);do{q=this.i.Xf(u);r=this.Jx(q,e);r=this.gn(r,d);e.Kj(t,r);this.i.Ob(u,l,1);this.i.Ob(this.i.Aa(u),l,1);this.i.co(q,m,1);u=this.i.qc(u);q=this.i.Kb(u,l);r=this.i.Kb(this.i.Aa(u),l);q|=r;if(2!=q)break;q=this.i.Ah(u);if(!this.Gf(q)){this.i.Ob(u,l,1);this.i.Ob(this.i.Aa(u),l,1);break}}while(u!=p)}else this.i.Ob(p,l,1),this.i.Ob(this.i.Aa(p),l,1);p=this.i.qc(this.i.Aa(p))}while(p!=
c)}for(b=this.i.rf;-1!=b;b=this.i.og(b))q=this.i.Hg(b,m),1!=q&&(q=this.i.Md(b),this.Gf(q)&&(-1==h&&(h=e.Yf(k,-1)),c=this.i.Ym(b),-1!=c&&(c=this.i.Uj(c),q=this.gn(c,d),e.Kj(h,q))));this.i.xq(m);this.i.ni(l);a.lo.V(e,f,1,this.pt,null);d=[];d[0]=k;d[1]=g;d[2]=f;return d};b.prototype.Jx=function(a,b){var c=-1;for(a=this.i.Ym(a);-1!=a;a=this.i.gt(a)){var d=this.i.Uj(a);-1==c&&(c=d);var e=this.i.Ia(b.ng(b.ld(d)));if(this.Gf(e)){c=d;break}}return c};b.prototype.OB=function(b,c){for(var d=this.i.Jk(c),e=
this.i.Xf(c),f=0,k=0,h=this.i.Ym(d);-1!=h;h=this.i.gt(h)){var l=this.i.Uj(h),m=b.ld(l),p=this.i.Ia(b.ng(m)),q=b.U(l),r=b.Ra(l),m=b.cb(m);m==l&&(this.Wo=c);-1!=q&&this.i.jf(q)==e?(f++,this.Gf(p)&&(m==q&&(this.Wo=this.i.qc(c)),k++)):-1!=r&&this.i.jf(r)==e&&(f--,this.Gf(p)&&(m==r&&(this.Wo=this.i.qc(c)),k--))}this.i.w(d,this.AI);this.i.w(e,this.BI);d=a.b.Cb(this.AI,this.BI);return(0!=k?k:f)*d};b.prototype.Fq=function(a){return this.i.Ah(a)|this.i.Ff(a)|this.i.Ff(this.i.Aa(a))};b.prototype.mL=function(a){for(var b=
this.i.Aa(this.i.Te(a)),c=-1;b!=a;){if(this.Gf(this.Fq(b))){if(-1!=c)return-1;c=b}b=this.i.Aa(this.i.Te(b))}return-1!=c?this.i.Aa(c):-1};b.prototype.nL=function(a){for(var b=this.i.Aa(this.i.qc(a)),c=-1;b!=a;){if(this.Gf(this.Fq(b))){if(-1!=c)return-1;c=b}b=this.i.Aa(this.i.qc(b))}return-1!=c?this.i.Aa(c):-1};b.prototype.cK=function(b,c,d,f,h){var e=this.i.a,g=b,k=this.i.Aa(g);this.i.Ob(g,d,1);this.i.Ob(k,d,1);var l=this.OB(e,g);this.Wo=-1;for(var m=g,n=-1,p=!1,q=1;;){var r=this.i.Te(g);if(r==k)break;
k=this.i.qc(k);if(this.i.Aa(r)!=k)if(g=this.mL(g),-1==g)break;else p=!0,k=this.i.Aa(g);else g=r;if(g==b){n=b;break}r=this.Fq(g);if(!this.Gf(r))break;this.i.Ob(g,d,1);this.i.Ob(k,d,1);m=g;l+=this.OB(e,g);q++}if(-1==n)for(g=b,k=this.i.Aa(g),n=g;;){b=this.i.qc(g);if(b==k)break;k=this.i.Te(k);if(this.i.Aa(b)!=k)if(g=this.nL(g),-1==g){p=!0;break}else k=this.i.Aa(g);else g=b;r=this.Fq(g);if(!this.Gf(r))break;this.i.Ob(g,d,1);this.i.Ob(k,d,1);n=g;l+=this.OB(e,g);q++}else if(-1!=this.Wo&&(m=this.Wo,n=this.i.Te(this.Wo),
this.i.Aa(n)!=this.i.qc(this.i.Aa(m))&&(n=this.mL(m),-1==n)))throw a.g.za();0<=l||(g=n,n=this.i.Aa(m),m=this.i.Aa(g));d=e.Yf(c,-1);g=m;m=this.i.Jk(m);p=this.i.Xf(n)==m&&p;l=this.Jx(m,e);l=this.gn(l,h);e.Kj(d,l);-1!=f&&this.i.co(m,f,1);m=0;for(q=p?a.J.truncate((q+1)/2):-1;;){b=this.i.Xf(g);l=this.Jx(b,e);l=this.gn(l,h);e.Kj(d,l);m++;-1!=f&&this.i.co(b,f,1);p&&m==q&&(d=e.Yf(c,-1),e.Kj(d,l));if(g==n)break;b=this.i.qc(g);if(this.i.Te(this.i.Aa(g))!=this.i.Aa(b)){if(g=this.nL(g),-1==g)throw a.g.za();}else g=
b}};b.prototype.fs=function(a){for(var b=this.i.a.bh(1607),c=this.i.xh(),d=this.i.rf;-1!=d;d=this.i.og(d)){var f=this.i.kf(d),k=f;do 1!=this.i.Kb(k,c)&&this.Gf(this.Fq(k))&&this.cK(k,b,c,-1,a),k=this.i.qc(this.i.Aa(k));while(k!=f)}this.i.ni(c);return b};b.prototype.WY=function(a){for(var b=this.i.a,c=b.bh(1607),d=b.bh(550),f=this.i.xh(),k=this.i.wq(),h=-1,l=this.i.rf;-1!=l;l=this.i.og(l)){var m=this.i.kf(l),p=m;do{var q=this.i.Kb(p,f);1!=q&&(q=this.Fq(p),this.Gf(q)&&this.cK(p,c,f,k,a));p=this.i.qc(this.i.Aa(p))}while(p!=
m)}for(l=this.i.rf;-1!=l;l=this.i.og(l))q=this.i.Hg(l,k),1!=q&&(q=this.i.Md(l),this.Gf(q)&&(-1==h&&(h=b.Yf(d,-1)),m=this.i.Ym(l),-1!=m&&(m=this.i.Uj(m),m=this.gn(m,a),b.Kj(h,m))));this.i.ni(f);this.i.xq(k);a=[];a[0]=d;a[1]=c;return a};b.prototype.Qp=function(){for(var a=this.i.a,b=a.bh(550),c=a.Yf(b,-1),d=this.i.rf;-1!=d;d=this.i.og(d))if(this.Gf(this.i.Md(d))){for(var f=-1,h=this.i.Ym(d);-1!=h;h=this.i.gt(h)){var l=this.i.Uj(h);-1==f&&(f=l);var m=this.i.Ia(a.ng(a.ld(l)));if(this.Gf(m)){f=l;break}}a.Kj(c,
f)}return b};b.prototype.Do=function(a){this.Mh=[];for(var b=0;b<a;b++)this.Mh[b]=!1};b.wD=function(b,c,d,f){var e=b.Ka(),g=Array(1E3);a.J.Nv(g,null);var k=a.J.gf(1E3,0),h=b.D(),l=!0,m=2==c.tb();if(1!=c.tb()&&2!=c.tb())throw a.g.za();for(var n=0;n<h;){var p=a.J.truncate(b.fX(g,n)-n);m?a.gd.fL(c,g,p,d,k):a.gd.gL(c,g,p,d,k);for(var q=0,r=0;r<p;r++){var t=0==k[r];f||(t=!t);t&&(l&&(l=!1,e.Id(b,0,n)),q!=r&&e.Id(b,n+q,n+r),q=r+1)}l||q==p||e.Id(b,n+q,n+p);n+=p}return l?b:e};b.MH=function(c,d,f){return c instanceof
a.Ed?b.wD(c,d,f,!0):d instanceof a.Wa?c.u()||d.u()?c.Ka():a.sk.yJ(f,c,d)?a.sk.GQ(c,d):c.Ka():b.yD(c,d,f,!0)};b.nw=function(c,d,f,h){var e=new a.h;c.s(e);var g=new a.h;d.s(g);var k=new a.h;k.I(e);k.Nb(g);f=a.na.be(f,k,!0);k=new a.h;k.I(g);g=a.na.Cs(f);k.O(g,g);if(!e.Yb(k)){if(c.tb()<=d.tb())return b.bd(b.Bb(c.Ka()),c,"\x26");if(c.tb()>d.tb())return b.bd(b.Bb(d.Ka()),c,"\x26")}g=new b;e=new a.fd;k=e.Jb(b.Bb(c));d=e.Jb(b.Bb(d));g.Xr(e,f,h);h=g.nw(k,d);c=b.bd(e.Se(h),c,"\x26");a.T.Ic(c.G())&&(c.Zg(2,
f),1736==c.G()&&c.Al());return c};b.yD=function(b,c,d,f){if(b.u())return b.Ka();if(c.u())return f?b.Ka():null;var e=[null],g=[0],k=2==c.tb();if(1!=c.tb()&&2!=c.tb())throw a.g.za();e[0]=b.w();k?a.gd.fL(c,e,1,d,g):a.gd.gL(c,e,1,d,g);c=0==g[0];f||(c=!c);return c?b.Ka():b};b.TZ=function(c,d,f){return c instanceof a.Ed?b.wD(c,d,f,!1):d instanceof a.Wa?c.u()?c.Ka():d.u()?c:a.sk.yJ(f,c,d)?c.Ka():c:b.yD(c,d,f,!1)};b.prototype.DJ=function(b,c,d,f,h){if(b.u())return b;var e=new a.fd;b=e.Jb(b);return this.nl(e,
b,c,d,f,h)};b.prototype.AW=function(b,c,d,f,h,l){if(h&&550!=b.hc(c)){var e=new a.XD;e.NY(b,d);e.ih?(a.sk.V(b,d,l,!0),h=!1):this.i.ez(d)}else a.sk.V(b,d,l,!0),h=!1;f&&550!=b.hc(c)?this.i.nK(b,c):this.i.mK(b,c);if(this.i.YA)return this.i.qh(),this.i=null,this.nl(b,c,d,f,!1,l);this.i.ez(NaN);l=this.i.Ia(c);this.Do(l+1);this.Mh[l]=!0;if(1736==b.hc(c)||f&&550!=b.hc(c))return b.Hp(c,0),c=this.es(c,-1,-1),b=b.Se(c),b.Hp(0),h?b.Zg(1,0):(b.Zg(2,d),b.Al()),b;if(1607==b.hc(c))return c=this.fs(-1),b=b.Se(c),
h||b.Zg(2,d),b;if(550==b.hc(c))return c=this.Qp(),b=b.Se(c),h||b.Zg(2,d),b;throw a.g.za();};b.prototype.nl=function(b,c,d,f,h,l){this.i=new a.Qu;try{return this.AW(b,c,d,f,h,l)}finally{this.i.qh()}};b.nl=function(a,c,d,f,h){return(new b).DJ(a,c,d,f,h)};b.prototype.zW=function(b,c,d){this.pt=b;this.i=new a.Qu;b=c.xo(d);var e=c.hc(d);1!=b||550==e?this.i.mK(c,d):this.i.nK(c,d);if(!this.i.YA)if(this.i.ez(NaN),e=this.i.Ia(d),this.Do(e+1),this.Mh[e]=!0,1736==c.hc(d)||1==b&&550!=c.hc(d))c.Hp(d,0),b=this.es(d,
-1,-1),c.FC(b,d),c.bC(b);else if(1607==c.hc(d))b=this.fs(-1),c.FC(b,d),c.bC(b);else if(550==c.hc(d))b=this.Qp(),c.FC(b,d),c.bC(b);else throw a.g.X("internal error");};b.EC=function(a,c,d,f){var e=new b;e.pt=!0;return e.DJ(a,c,!1,d,f)};b.prototype.Vm=function(b,c){var d=a.T.lf(this.i.a.hc(b)),e=a.T.lf(this.i.a.hc(c));if(d>e)return b;var f=this.i.Ia(b),k=this.i.Ia(c);this.Do((f|k)+1);this.Mh[this.i.Ia(b)]=!0;if(2==d&&2==e)return this.es(b,c,-1);if(1==d&&2==e||1==d&&1==e)return this.fs(-1);if(0==d)return this.Qp();
throw a.g.za();};b.prototype.nG=function(b,c){var d=a.T.lf(this.i.a.hc(b)),e=a.T.lf(this.i.a.hc(c));if(d>e)return b;if(d<e)return c;var f=this.i.Ia(b),k=this.i.Ia(c);this.Do((f|k)+1);this.Mh[this.i.Ia(b)]=!0;this.Mh[this.i.Ia(c)]=!0;this.Mh[this.i.Ia(b)|this.i.Ia(c)]=!0;if(2==d&&2==e)return this.es(b,c,-1);if(1==d&&1==e)return this.fs(-1);if(0==d&&0==e)return this.Qp();throw a.g.za();};b.prototype.nw=function(b,c){var d=a.T.lf(this.i.a.hc(b)),e=a.T.lf(this.i.a.hc(c)),f=this.i.Ia(b),k=this.i.Ia(c);
this.Do((f|k)+1);this.Mh[this.i.Ia(b)|this.i.Ia(c)]=!0;f=-1;1<this.i.a.Hr.Ga&&(f=b);if(2==d&&2==e)return this.es(b,c,f);if(1==d&&0<e||1==e&&0<d)return this.fs(f);if(0==d||0==e)return this.Qp();throw a.g.za();};b.prototype.wA=function(b,c){var d=a.T.lf(this.i.a.hc(b)),e=a.T.lf(this.i.a.hc(c)),f=this.i.Ia(b),k=this.i.Ia(c);this.Do((f|k)+1);this.Mh[this.i.Ia(b)|this.i.Ia(c)]=!0;f=-1;1<this.i.a.Hr.Ga&&(f=b);if(2==d&&2==e)return this.VY(b,c,f);if(1==d&&0<e||1==e&&0<d)return this.WY(f);if(0==d||0==e)return d=
[],d[0]=this.Qp(),d;throw a.g.za();};b.prototype.Pp=function(b,c){var d=a.T.lf(this.i.a.hc(b)),e=a.T.lf(this.i.a.hc(c)),f=this.i.Ia(b),k=this.i.Ia(c);this.Do((f|k)+1);this.Mh[this.i.Ia(b)]=!0;this.Mh[this.i.Ia(c)]=!0;if(2==d&&2==e)return this.es(b,c,-1);if(1==d&&1==e)return this.fs(-1);if(0==d&&0==e)return this.Qp();throw a.g.za();};b.Bb=function(b){var c=b.G();return 197==c?(c=new a.Ja(b.description),b.u()||c.jd(b,!1),c):33==c?(c=new a.Ed(b.description),b.u()||c.add(b),c):322==c?(c=new a.Ua(b.description),
b.u()||c.dc(b,!0),c):b};b.bd=function(b,c,d){var e=b.G();return 197==e?(c=new a.Ja(b.description),b.u()||c.jd(b,!1),c):33!=e||"|"!=d&&"^"!=d?322==e?(c=new a.Ua(b.description),b.u()||c.dc(b,!0),c):33==e&&"-"==d&&33==c.G()||550==e&&"\x26"==d&&33==c.G()?(c=new a.Wa(b.description),b.u()||b.Ae(0,c),c):b:(c=new a.Ed(b.description),b.u()||c.add(b),c)};b.Vm=function(c,d,f,h){if(c.u()||d.u()||c.tb()>d.tb())return b.bd(b.Bb(c),c,"-");var e=new a.h;c.s(e);var g=new a.h;d.s(g);if(!e.Yb(g))return b.bd(b.Bb(c),
c,"-");var k=new a.h;k.I(e);k.Nb(g);f=a.na.be(f,k,!0);g=new b;e=new a.fd;k=e.Jb(b.Bb(c));d=e.Jb(b.Bb(d));g.Xr(e,f,h);h=g.Vm(k,d);h=e.Se(h);c=b.bd(h,c,"-");a.T.Ic(c.G())&&(c.Zg(2,f),1736==c.G()&&c.Al());return c};b.nG=function(c,d,f,h){if(c.tb()>d.tb())return b.bd(b.Bb(c),c,"|");if(c.tb()<d.tb()||c.u())return b.bd(b.Bb(d),c,"|");if(d.u())return b.bd(b.Bb(c),c,"|");var e=new a.h;c.s(e);var g=new a.h;d.s(g);var k=new a.h;k.I(e);k.Nb(g);f=a.na.be(f,k,!0);if(!e.Yb(g.oT(f,f)))switch(c=b.Bb(c),d=b.Bb(d),
c.G()){case 550:return c=a.T.oe(c),c.Id(d,0,-1),c;case 1607:return c=a.T.oe(c),c.add(d,!1),c;case 1736:return c=a.T.oe(c),c.add(d,!1),c;default:throw a.g.za();}g=new b;e=new a.fd;k=e.Jb(b.Bb(c));d=e.Jb(b.Bb(d));g.Xr(e,f,h);d=g.nG(k,d);c=b.bd(e.Se(d),c,"|");a.T.Ic(c.G())&&(c.Zg(2,f),1736==c.G()&&c.Al());return c};b.SR=function(c,d,f){if(2>c.length)throw a.g.F("not enough geometries to dissolve");for(var e=0,g=0,k=c.length;g<k;g++)e=Math.max(c[g].tb(),e);var h=new a.h;h.Oa();for(var l=new a.fd,m=-1,
p=0,q=-1,g=0,k=c.length;g<k;g++)if(c[g].tb()==e)if(c[g].u())-1==q&&(q=g);else{q=g;-1==m?m=l.Jb(b.Bb(c[g])):l.xP(m,b.Bb(c[g]));var r=new a.h;c[g].ac(r);h.Nb(r);p++}if(2>p)return b.Bb(c[q]);c=2==e;d=a.na.be(0==e?d:null,h,!0);return(new b).nl(l,m,d,c,!0,f)};b.wA=function(c,d,f,h){var e=[null,null,null],g=new a.h;c.s(g);var k=new a.h;d.s(k);var l=new a.h;l.I(g);l.Nb(k);f=a.na.be(f,l,!0);l=new a.h;l.I(k);k=a.na.Cs(f);l.O(k,k);if(!g.Yb(l)){if(c.tb()<=d.tb())return c=b.bd(b.Bb(c.Ka()),c,"\x26"),e[c.tb()]=
c,e;if(c.tb()>d.tb())return c=b.bd(b.Bb(d.Ka()),c,"\x26"),e[c.tb()]=c,e}k=new b;g=new a.fd;l=g.Jb(b.Bb(c));d=g.Jb(b.Bb(d));k.Xr(g,f,h);h=k.wA(l,d);for(d=0;d<h.length;d++)k=b.bd(g.Se(h[d]),c,"\x26"),a.T.Ic(k.G())&&(k.Zg(2,f),1736==k.G()&&k.Al()),e[k.tb()]=k;return e};b.Pp=function(c,d,f,h){if(c.tb()>d.tb())return b.bd(b.Bb(c),c,"^");if(c.tb()<d.tb()||c.u())return b.bd(b.Bb(d),c,"^");if(d.u())return b.bd(b.Bb(c),c,"^");var e=new a.h;c.s(e);var g=new a.h;d.s(g);var k=new a.h;k.I(e);k.Nb(g);f=a.na.be(f,
k,!0);g=new b;e=new a.fd;k=e.Jb(b.Bb(c));d=e.Jb(b.Bb(d));g.Xr(e,f,h);h=g.Pp(k,d);c=b.bd(e.Se(h),c,"^");a.T.Ic(c.G())&&(c.Zg(2,f),1736==c.G()&&c.Al());return c};b.M_=function(b,c,d){c=c.G();d=d.G();return 550==b.G()&&(33==c||33==d)&&1>=b.D()?(d=new a.Wa(b.description),b.u()||b.Ae(0,d),d):b};b.prototype.BS=function(a,b){var c=this.i.a;a=c.Yf(a,-1);for(var d=b.size,e=0;e<d;e++){var f=b.get(e);c.Kj(a,f)}c.$n(a,!0)};b.prototype.XX=function(a,b){for(var c=this.i.a,d=c.rd;-1!=d;d=c.Ue(d))if(d==b)for(var e=
c.Pb(d);-1!=e;e=c.Sb(e)){var f=c.cb(e);if(-1!=f)for(var k=c.U(f);-1!=k;){var f=this.i.jf(f),h=this.i.jf(k),f=this.i.lT(f,h);-1!=f&&(h=this.i.Aa(f),this.i.Ob(f,a,1),this.i.Ob(h,a,2));f=k;k=c.U(f)}}};b.prototype.UW=function(b,c,d,f){d=this.i.Ia(d);f=this.i.Ia(f);var e=new a.ia(0);e.yb(256);for(var g=this.i.a,k=this.i.xh(),h=this.i.rf;-1!=h;h=this.i.og(h)){var l=this.i.kf(h);if(-1!=l){var m=l;do{if(1!=this.i.Kb(m,k)){var n=m,p=m,q=!1,r=0;do{this.i.Ob(n,k,1);if(!q){var t=this.i.Ah(n);0!=(t&f)&&0!=(this.i.Ff(n)&
d)&&(p=n,q=!0)}q&&(e.add(this.i.Uj(this.i.Ym(this.i.Jk(n)))),-1!=b&&(t=this.i.Ah(n),0!=(t&f)&&(t=this.i.Kb(n,b),r|=t)));n=this.i.qc(n)}while(n!=p);q&&0<this.i.Dq(this.i.Ef(p))&&(n=g.bh(1736),this.BS(n,e),-1!=c&&g.xK(n,c,r));e.clear(!1)}m=this.i.qc(this.i.Aa(m))}while(m!=l)}}this.i.ni(k)};b.prototype.AR=function(a,b,c,d){this.i.wX();var e=-1;-1!=a&&(e=this.i.xh(),this.XX(e,c));this.UW(e,a,b,c);var f=this.i.a;a=0;for(e=f.rd;-1!=e;e=f.Ue(e))e!=b&&e!=c&&(d.add(e),a++);d.Gd(0,a,function(a,b){a=f.hA(f.Pb(a));
b=f.hA(f.Pb(b));return a<b?-1:a==b?0:1})};b.prototype.qh=function(){null!=this.i&&(this.i.qh(),this.i=null)};return b}();a.Dg=b})(x||(x={}));(function(a){var b=function(){function b(a){void 0!==a?this.Op(a):this.qC()}b.prototype.Vx=function(){this.bc=this.Wb=this.zb=this.sb=this.gb=this.lb=0};b.prototype.Eb=function(a){return this==a?!0:a instanceof b?this.lb==a.lb&&this.sb==a.sb&&this.Wb==a.Wb&&this.zb==a.zb&&this.gb==a.gb&&this.bc==a.bc:!1};b.prototype.jc=function(){a.J.Zi();a.J.Zi();a.J.Zi();a.J.Zi();
a.J.Zi();return a.J.Zi()};b.prototype.$h=function(a,b){var c=this.zb*a.x+this.gb*a.y+this.bc;b.x=this.lb*a.x+this.sb*a.y+this.Wb;b.y=c};b.prototype.YY=function(a,b,c,d,f){var e=2*b;d*=2;for(b=2*(b+f);e<b;e+=2,d+=2){f=a[e];var g=a[e+1];c[d]=this.lb*f+this.sb*g+this.Wb;c[d+1]=this.zb*f+this.gb*g+this.bc}};b.prototype.$Y=function(b,c,d){for(var e=0;e<c;e++){var f=b[e].x,g=b[e].y,k=this.lb*f+this.sb*g+this.Wb,f=this.zb*f+this.gb*g+this.bc;null!=d[e]?d[e].ka(k,f):d[e]=a.b.pa(k,f)}};b.prototype.multiply=
function(a){b.multiply(this,a,this)};b.multiply=function(a,b,c){var d,e,f,g,k;d=a.lb*b.lb+a.zb*b.sb;e=a.sb*b.lb+a.gb*b.sb;f=a.Wb*b.lb+a.bc*b.sb+b.Wb;g=a.lb*b.zb+a.zb*b.gb;k=a.sb*b.zb+a.gb*b.gb;a=a.Wb*b.zb+a.bc*b.gb+b.bc;c.lb=d;c.sb=e;c.Wb=f;c.zb=g;c.gb=k;c.bc=a};b.prototype.Vf=function(){var a=new b;a.lb=this.lb;a.sb=this.sb;a.Wb=this.Wb;a.zb=this.zb;a.gb=this.gb;a.bc=this.bc;return a};b.prototype.LC=function(b){if(!b.u()){for(var c=[],d=0;4>d;d++)c[d]=new a.b;b.QB(c);this.aZ(c,c);b.Mx(c,4)}};b.prototype.aZ=
function(b,c){for(var d=0;d<b.length;d++){var e=new a.b,f=b[d];e.x=this.lb*f.x+this.sb*f.y+this.Wb;e.y=this.zb*f.x+this.gb*f.y+this.bc;c[d]=e}};b.prototype.lU=function(a,b){a.u()||b.u()||0==a.N()||0==a.fa()?this.Vx():(this.sb=this.zb=0,this.lb=b.N()/a.N(),this.gb=b.fa()/a.fa(),this.Wb=b.o-a.o*this.lb,this.bc=b.A-a.A*this.gb)};b.prototype.ZY=function(b){var c=new a.b,d=new a.b;c.ka(this.lb,this.zb);d.ka(this.sb,this.gb);c.sub(c);var f=.5*c.qk();c.ka(this.lb,this.zb);d.ka(this.sb,this.gb);c.add(d);
c=.5*c.qk();return b*(f>c?Math.sqrt(f):Math.sqrt(c))};b.prototype.qC=function(){this.lb=1;this.zb=this.Wb=this.sb=0;this.gb=1;this.bc=0};b.prototype.Ho=function(b){if(void 0!==b){var c=a.b.pa(0,1);this.$h(c,c);c.sub(a.b.pa(0,1));if(c.qk()>b*b)return!1;c.ka(0,0);this.$h(c,c);if(c.qk()>b*b)return!1;c.ka(1,0);this.$h(c,c);c.sub(a.b.pa(1,0));return c.qk()<=b*b}return 1==this.lb&&1==this.gb&&0==this.sb&&0==this.Wb&&0==this.zb&&0==this.bc};b.prototype.fh=function(a){return Math.abs(this.lb*this.gb-this.zb*
this.sb)<=2*a*(Math.abs(this.lb*this.gb)+Math.abs(this.zb*this.sb))};b.prototype.Ag=function(a,b){this.lb=1;this.sb=0;this.Wb=a;this.zb=0;this.gb=1;this.bc=b};b.prototype.Op=function(a,b){void 0!==b?(this.lb=a,this.zb=this.Wb=this.sb=0,this.gb=b,this.bc=0):this.Op(a,a)};b.prototype.yC=function(){this.lb=0;this.sb=1;this.Wb=0;this.zb=1;this.bc=this.gb=0};b.prototype.kY=function(a){this.lY(Math.cos(a),Math.sin(a))};b.prototype.lY=function(a,b){this.lb=a;this.sb=-b;this.Wb=0;this.zb=b;this.gb=a;this.bc=
0};b.prototype.shift=function(a,b){this.Wb+=a;this.bc+=b};b.prototype.scale=function(a,b){this.lb*=a;this.sb*=a;this.Wb*=a;this.zb*=b;this.gb*=b;this.bc*=b};b.prototype.rotate=function(a){var c=new b;c.kY(a);this.multiply(c)};b.prototype.inverse=function(a){if(void 0!==a){var b=this.lb*this.gb-this.sb*this.zb;0==b?a.Vx():(b=1/b,a.Wb=(this.sb*this.bc-this.Wb*this.gb)*b,a.bc=(this.Wb*this.zb-this.lb*this.bc)*b,a.lb=this.gb*b,a.sb=-this.sb*b,a.zb=-this.zb*b,a.gb=this.lb*b)}else this.inverse(this)};return b}();
a.Hd=b})(x||(x={}));(function(a){var b=function(){function b(){}b.prototype.Vx=function(){this.bi=this.bc=this.Wb=this.Df=this.Af=this.zf=this.Cf=this.gb=this.sb=this.Sf=this.zb=this.lb=0};b.prototype.Op=function(a,b,c){this.lb=a;this.sb=this.Sf=this.zb=0;this.gb=b;this.Af=this.zf=this.Cf=0;this.Df=c;this.bi=this.bc=this.Wb=0};b.prototype.LC=function(b){if(b.u())return b;for(var c=new a.pd[8],d=0;8>d;d++)c[d]=new a.pd;b.QB(c);this.transform(c,8,c);b.Mx(c);return b};b.prototype.transform=function(b,
c,d){for(var e=0;e<c;e++){var f=new a.pd,g=b[e];f.x=this.lb*g.x+this.sb*g.y+this.zf*g.z+this.Wb;f.y=this.zb*g.x+this.gb*g.y+this.Af*g.z+this.bc;f.z=this.Sf*g.x+this.Cf*g.y+this.Df*g.z+this.bi;d[e]=f}};b.prototype.Rp=function(b){var c=new a.pd;c.x=this.lb*b.x+this.sb*b.y+this.zf*b.z+this.Wb;c.y=this.zb*b.x+this.gb*b.y+this.Af*b.z+this.bc;c.z=this.Sf*b.x+this.Cf*b.y+this.Df*b.z+this.bi;return c};b.prototype.Vg=function(a){b.multiply(this,a,this)};b.multiply=function(a,b,c){var d,e,f,g,k,h,l,m,p,q,r;
d=a.lb*b.lb+a.zb*b.sb+a.Sf*b.zf;e=a.lb*b.zb+a.zb*b.gb+a.Sf*b.Af;f=a.lb*b.Sf+a.zb*b.Cf+a.Sf*b.Df;g=a.sb*b.lb+a.gb*b.sb+a.Cf*b.zf;k=a.sb*b.zb+a.gb*b.gb+a.Cf*b.Af;h=a.sb*b.Sf+a.gb*b.Cf+a.Cf*b.Df;l=a.zf*b.lb+a.Af*b.sb+a.Df*b.zf;m=a.zf*b.zb+a.Af*b.gb+a.Df*b.Af;p=a.zf*b.Sf+a.Af*b.Cf+a.Df*b.Df;q=a.Wb*b.lb+a.bc*b.sb+a.bi*b.zf+b.Wb;r=a.Wb*b.zb+a.bc*b.gb+a.bi*b.Af+b.bc;a=a.Wb*b.Sf+a.bc*b.Cf+a.bi*b.Df+b.bi;c.lb=d;c.zb=e;c.Sf=f;c.sb=g;c.gb=k;c.Cf=h;c.zf=l;c.Af=m;c.Df=p;c.Wb=q;c.bc=r;c.bi=a};b.inverse=function(b,
c){var d=b.lb*(b.gb*b.Df-b.Cf*b.Af)-b.zb*(b.sb*b.Df-b.Cf*b.zf)+b.Sf*(b.sb*b.Af-b.gb*b.zf);if(0!=d){var e,f,h,k,l,m,p,q,r,t;q=1/d;d=(b.gb*b.Df-b.Cf*b.Af)*q;h=-(b.sb*b.Df-b.Cf*b.zf)*q;m=(b.sb*b.Af-b.gb*b.zf)*q;e=-(b.zb*b.Df-b.Af*b.Sf)*q;k=(b.lb*b.Df-b.Sf*b.zf)*q;p=-(b.lb*b.Af-b.zb*b.zf)*q;f=(b.zb*b.Cf-b.Sf*b.gb)*q;l=-(b.lb*b.Cf-b.Sf*b.sb)*q;q*=b.lb*b.gb-b.zb*b.sb;r=-(b.Wb*d+b.bc*h+b.bi*m);t=-(b.Wb*e+b.bc*k+b.bi*p);b=-(b.Wb*f+b.bc*l+b.bi*q);c.lb=d;c.zb=e;c.Sf=f;c.sb=h;c.gb=k;c.Cf=l;c.zf=m;c.Af=p;c.Df=
q;c.Wb=r;c.bc=t;c.bi=b}else throw a.g.X("math singularity");};b.prototype.Vf=function(){var a=new b;a.lb=this.lb;a.zb=this.zb;a.Sf=this.Sf;a.sb=this.sb;a.gb=this.gb;a.Cf=this.Cf;a.zf=this.zf;a.Af=this.Af;a.Df=this.Df;a.Wb=this.Wb;a.bc=this.bc;a.bi=this.bi;return a};return b}();a.fO=b})(x||(x={}));(function(a){var b=function(b){function d(a){if(void 0!==a)b.call(this,a.jc(),a);else{b.call(this);this.wg=[];this.wg[0]=0;this.Ga=1;this.Sh=[];for(a=0;10>a;a++)this.Sh[a]=-1;this.Sh[this.wg[0]]=0}this.Zq=
!0}I(d,b);d.prototype.Td=function(a){this.hasAttribute(a)||(this.Sh[a]=0,this.DE())};d.prototype.removeAttribute=function(b){if(0==b)throw a.g.F("Position attribue cannot be removed");this.hasAttribute(b)&&(this.Sh[b]=-1,this.DE())};d.prototype.reset=function(){this.wg[0]=0;this.Ga=1;for(var a=0;a<this.Sh.length;a++)this.Sh[a]=-1;this.Sh[this.wg[0]]=0;this.Zq=!0};d.prototype.Pz=function(){return c.zo().add(this)};d.Ig=function(){return c.zo().UT()};d.eq=function(){return c.zo().VT()};d.prototype.KO=
function(){var b=this.jc();return new a.ma(b,this)};d.prototype.DE=function(){for(var a=this.Ga=0,b=0;10>a;a++)0<=this.Sh[a]&&(this.wg[b]=a,this.Sh[a]=b,b++,this.Ga++);this.Zq=!0};d.prototype.jc=function(){this.Zq&&(this.bm=this.zk(),this.Zq=!1);return this.bm};d.prototype.Eb=function(a){if(null==a)return!1;if(a==this)return!0;if(!(a instanceof d)||a.Ga!=this.Ga)return!1;for(var b=0;b<this.Ga;b++)if(this.wg[b]!=a.wg[b])return!1;return this.Zq!=a.Zq?!1:!0};d.prototype.SH=function(a){if(a.Ga!=this.Ga)return!1;
for(var b=0;b<this.Ga;b++)if(this.wg[b]!=a.wg[b])return!1;return!0};d.vx=function(a,b){for(var c=[],d=0;d<a.Ga;d++)c[d]=-1;for(var d=0,e=a.Ga;d<e;d++)c[d]=b.mg(a.qd(d));return c};d.vT=function(a,b){a=new d(a);a.Td(b);return a.Pz()};d.wT=function(a,b){for(var c=null,e=0;10>e;e++)!a.hasAttribute(e)&&b.hasAttribute(e)&&(null==c&&(c=new d(a)),c.Td(e));return null!=c?c.Pz():a};d.ss=function(a,b){a=new d(a);a.removeAttribute(b);return a.Pz()};return d}(a.ma);a.ze=b;var c=function(){function a(){this.map=
[];var a=new b;this.add(a);a=new b;a.Td(1);this.add(a)}a.zo=function(){return a.jV};a.prototype.UT=function(){return a.aq};a.prototype.VT=function(){return a.bq};a.prototype.add=function(b){var c=b.jc();if(null!=a.aq&&a.aq.jc()==c&&b.SH(a.aq))return a.aq;if(null!=a.bq&&a.bq.jc()==c&&b.SH(a.bq))return a.bq;var d=null;void 0!==this.map[c]&&(d=this.map[c]);null==d&&(d=b.KO(),1==d.Ga?a.aq=d:2==d.Ga&&1==d.qd(1)?a.bq=d:this.map[c]=d);return d};a.jV=new a;return a}()})(x||(x={}));var Q=0==t.version.indexOf("4."),
U;(function(a){a[a.Linear=0]="Linear";a[a.Angular=1]="Angular";a[a.Area=2]="Area";a[a.LinearOrAngular=3]="LinearOrAngular"})(U||(U={}));var V={feet:9002,kilometers:9036,meters:9001,miles:9035,"nautical-miles":9030,yards:9096},Y={acres:109402,ares:109463,hectares:109401,"square-feet":109405,"square-kilometers":109414,"square-meters":109404,"square-miles":109413,"square-yards":109442},T={degrees:9102,radians:9101};void 0===l.prototype.getCacheValue&&c.extend(l,{cache:null,getCacheValue:function(a){if(null===
this.cache||void 0===this.cache)this.cache={};return this.cache[a]},setCacheValue:function(a,b){if(null===this.cache||void 0===this.cache)this.cache={};this.cache[a]=b}});var aa=x.Rd.create(4326),W=x.Rd.create(102100);z=function(){function b(){}b.extendedSpatialReferenceInfo=function(a){if(null===a)return null;a=E(a);var b=a.Vd();return{tolerance:a.Bo(),unitType:null==b?-1:b.td,unitID:null==b?-1:b.Cc(),unitBaseFactor:null==b?0:b.Ai,unitSquareDerivative:null==b?0:x.kc.lH(b).Cc()}};b.clip=function(a,
b){if(null===a)return null;b=x.cc.clip(C(a),C(b),J(a));return w(b,a.spatialReference)};b.cut=function(a,b){b=C(b);b=x.cc.Hl(C(a),b,J(a));for(var c=[],d=0;d<b.length;d++)c.push(w(b[d],a.spatialReference));return c};b.contains=function(a,b){if(null===a||null===b)throw Error("Illegal Argument Exception");return x.cc.contains(C(a),C(b),J(a))};b.crosses=function(a,b){if(null===a||null===b)throw Error("Illegal Argument Exception");return x.cc.zR(C(a),C(b),J(a))};b.distance=function(a,b,c){if(null===a||
null===b)throw Error("Illegal Argument Exception");return x.cc.Cb(C(a),C(b),J(a),x.kc.pe(u(c,3)))};b.equals=function(a,b){return null===a&&null!==b||null===b&&null!==a?!1:x.cc.Eb(C(a),C(b),J(a))};b.intersects=function(a,b){if(null===a||null===b)throw Error("Illegal Argument Exception");return x.cc.OU(C(a),C(b),J(a))};b.touches=function(a,b){if(null===a||null===b)throw Error("Illegal Argument Exception");return x.cc.touches(C(a),C(b),J(a))};b.within=function(a,b){if(null===a||null===b)throw Error("Illegal Argument Exception");
return x.cc.sZ(C(a),C(b),J(a))};b.disjoint=function(a,b){if(null===a||null===b)throw Error("Illegal Argument Exception");return x.cc.RR(C(a),C(b),J(a))};b.overlaps=function(a,b){if(null===a||null===b)throw Error("Illegal Argument Exception");return x.cc.pW(C(a),C(b),J(a))};b.relate=function(a,b,c){if(null===a||null===b)throw Error("Illegal Argument Exception");return x.cc.ZB(C(a),C(b),J(a),c)};b.isSimple=function(a){if(null===a)throw Error("Illegal Argument Exception");return x.cc.ZU(C(a),J(a))};
b.simplify=function(a){if(null===a)throw Error("Illegal Argument Exception");var b=x.cc.DC(C(a),J(a));return w(b,a.spatialReference)};b.convexHull=function(a,c){void 0===c&&(c=!1);if(null===a)throw Error("Illegal Argument Exception");return!1===K(a)?(c=x.cc.iR(C(a),J(a)),w(c,a.spatialReference)):b.lZ(a,c)};b.lZ=function(a,b){for(var c=[],d=0;d<a.length;d++)c.push(C(a[d]));c=x.cc.jR(c,b);for(d=0;d<c.length;d++)c[d]=w(c[d],a[0].spatialReference);return c};b.difference=function(a,c){if(null===a||null===
c)throw Error("Illegal Argument Exception");return!1===K(a)?(c=x.cc.Vm(C(a),C(c),J(a)),w(c,a.spatialReference)):b.iM(a,c)};b.iM=function(a,b){for(var c=[],d=0;d<a.length;d++)c.push(C(a[d]));c=x.cc.OR(c,C(b),J(b));for(d=0;d<c.length;d++)c[d]=w(c[d],b.spatialReference);return c};b.symmetricDifference=function(a,c){if(null===a||null===c)throw Error("Illegal Argument Exception");return!1===K(a)?(c=x.cc.Pp(C(a),C(c),J(a)),w(c,a.spatialReference)):b.LM(a,c)};b.LM=function(a,b){for(var c=[],d=0;d<a.length;d++)c.push(C(a[d]));
c=x.cc.PY(c,C(b),J(b));for(d=0;d<c.length;d++)c[d]=w(c[d],b.spatialReference);return c};b.intersect=function(a,c){if(null===a||null===c)throw Error("Illegal Argument Exception");return!1===K(a)?(c=x.cc.Ma(C(a),C(c),J(a)),w(c,a.spatialReference)):b.xM(a,c)};b.xM=function(a,b){for(var c=[],d=0;d<a.length;d++)c.push(C(a[d]));c=x.cc.MU(c,C(b),J(b));for(d=0;d<c.length;d++)c[d]=w(c[d],b.spatialReference);return c};b.union=function(a,b){void 0===b&&(b=null);if(null===a)return null;!1===K(a)&&(a=[a],null!==
b&&a.push(b));if(0===a.length)return null;b=[];for(var c=0;c<a.length;c++)b.push(C(a[c]));return w(x.cc.hZ(b,J(a[0])),a[0].spatialReference)};b.offset=function(a,c,d,e,f,h){var g=0;if(null!=e&&void 0!=e)switch(e){case "round":g=0;break;case "bevel":g=1;break;case "miter":g=2;break;case "square":g=3}return!1===K(a)?(c=x.cc.offset(C(a),J(a),c,g,f,h,x.kc.pe(u(d,3))),w(c,a.spatialReference)):b.HM(a,c,d,g,f,h)};b.HM=function(a,b,c,d,f,h){if(null===a)return null;if(0===a.length)return[];for(var e=[],g=
0;g<a.length;g++)e.push(C(a[g]));b=x.cc.nW(e,J(a[0]),b,d,f,h,x.kc.pe(u(c,3)));for(g=0;g<b.length;g++)b[g]=w(b[g],a[0].spatialReference);return b};b.buffer=function(a,c,d,e){void 0===e&&(e=!1);if(!1===K(a))return c=x.cc.buffer(C(a),J(a),c,x.kc.pe(u(d,3)),!1,0,NaN),w(c,a.spatialReference);if("[object Array]"!==Object.prototype.toString.call(c)){for(var f=[],h=0;h<a.length;h++)f.push(c);c=f}if(c.length!=a.length){if(0==c.length)throw Error("Illegal Argument Exception");for(var f=[],k=0,h=0;h<a.length;h++)void 0===
c[h]?f.push(k):(f.push(c[h]),k=c[h]);c=f}return b.rD(a,c,d,!1,e,"geodesic",NaN)};b.geodesicBuffer=function(a,c,d,e,f,h){if(!1===K(a))return void 0===f&&(f=NaN),c=x.cc.buffer(C(a),J(a),c,x.kc.pe(u(d,0)),!0,D(e),f),w(c,a.spatialReference);if("[object Array]"!==Object.prototype.toString.call(c)){for(var g=[],k=0;k<a.length;k++)g.push(c);c=g}if(c.length!=a.length){if(0==c.length)throw Error("Illegal Argument Exception");for(var g=[],l=0,k=0;k<a.length;k++)void 0===c[k]?g.push(l):(g.push(c[k]),l=c[k]);
c=g}return b.rD(a,c,d,!0,e,f,h)};b.rD=function(a,b,c,d,f,h,l){if(null===a)return null;if(0===a.length)return[];void 0===l&&(l=NaN);for(var e=[],g=0;g<a.length;g++)e.push(C(a[g]));b=x.cc.RP(e,J(a[0]),b,x.kc.pe(u(c,0)),d,f,D(h),l);for(g=0;g<b.length;g++)b[g]=w(b[g],a[0].spatialReference);return b};b.nearestCoordinate=function(a,b,c){void 0===c&&(c=!0);b=x.cc.$z(C(a),C(b),c);return{coordinate:w(b.Oz(),a.spatialReference),distance:b.Rz(),isRightSide:b.AA(),vertexIndex:b.Za(),isEmpty:b.u()}};b.nearestVertex=
function(a,b){b=x.cc.aA(C(a),C(b));return{coordinate:w(b.Oz(),a.spatialReference),distance:b.Rz(),isRightSide:b.AA(),vertexIndex:b.Za(),isEmpty:b.u()}};b.nearestVertices=function(a,b,c,d){b=C(b);c=x.cc.bA(C(a),b,c,d);d=[];for(b=0;b<c.length;b++)!1===c[b].u()&&d.push({coordinate:w(c[b].Oz(),a.spatialReference),distance:c[b].Rz(),isRightSide:c[b].AA(),vertexIndex:c[b].Za(),isEmpty:c[b].u()});return d};b.generalize=function(a,b,c,d){b=x.cc.HS(C(a),J(a),b,c,x.kc.pe(u(d,3)));return w(b,a.spatialReference)};
b.densify=function(a,b,c){b=x.cc.Ls(C(a),J(a),b,x.kc.pe(u(c,3)));return w(b,a.spatialReference)};b.geodesicDensify=function(a,b,c,d){void 0===d&&(d=0);b=x.cc.Fz(C(a),J(a),b,x.kc.pe(u(c,3)),d);return w(b,a.spatialReference)};b.rotate=function(b,c,d){if(void 0===d||null===d)void 0!==b.x?d=b:void 0!==b.xmin?(!1===b instanceof l&&(b=Q?m(b):a(b)),d=Q?b.get("center"):b.getCenter()):(!1===b instanceof l&&(b=Q?m(b):a(b)),d=Q?b.get("extent").get("center"):b.getExtent().getCenter());c=Q?x.Wp.rotate(b.toJSON?
b.toJSON():b,c,d.toJSON?d.toJSON():d):x.Wp.rotate(b.toJson?b.toJson():b,c,d.toJson?d.toJson():d);Q?(c=m(c),c.set("spatialReference",b.spatialReference)):(c=a(c),c.setSpatialReference(b.spatialReference));return c};b.flipHorizontal=function(b,c){if(void 0===c||null===c)void 0!==b.x?c=b:void 0!==b.xmin?(!1===b instanceof l&&(b=Q?m(b):a(b)),c=Q?b.get("center"):b.getCenter()):(!1===b instanceof l&&(b=Q?m(b):a(b)),c=Q?b.get("extent").get("center"):b.getExtent().getCenter());c=Q?x.Wp.zG(b.toJSON?b.toJSON():
b,c.toJSON?c.toJSON():c):x.Wp.zG(b.toJson?b.toJson():b,c.toJson?c.toJson():c);Q?(c=m(c),c.set("spatialReference",b.spatialReference)):(c=a(c),c.setSpatialReference(b.spatialReference));return c};b.flipVertical=function(b,c){if(void 0===c||null===c)void 0!==b.x?c=b:void 0!==b.xmin?(!1===b instanceof l&&(b=Q?m(b):a(b)),c=Q?b.get("center"):b.getCenter()):(!1===b instanceof l&&(b=Q?m(b):a(b)),c=Q?b.get("extent").get("center"):b.getExtent().getCenter());c=Q?x.Wp.AG(b.toJSON?b.toJSON():b,c.toJSON?c.toJSON():
c):x.Wp.AG(b.toJson?b.toJson():b,c.toJson?c.toJson():c);Q?(c=m(c),c.set("spatialReference",b.spatialReference)):(c=a(c),c.setSpatialReference(b.spatialReference));return c};b.planarArea=function(a,b){if(null===a)throw Error("Illegal Argument Exception");return x.cc.xW(C(a),J(a),x.kc.pe(u(b,2)))};b.planarLength=function(a,b){if(null===a)throw Error("Illegal Argument Exception");return x.cc.yW(C(a),J(a),x.kc.pe(u(b,3)))};b.geodesicArea=function(a,b,c){if(null===a)throw Error("Illegal Argument Exception");
return x.cc.NS(C(a),J(a),x.kc.pe(u(b,2)),D(c))};b.geodesicLength=function(a,b,c){if(null===a)throw Error("Illegal Argument Exception");return x.cc.RS(C(a),J(a),x.kc.pe(u(b,0)),D(c))};b._enableProjection=function(a){b.GE=!0;x.BN.bind(a)};b.Mg=function(a){return E(a).Ao()};b._getTransformation=function(a,b,c){void 0===c&&(c=null);var d=null,f=null;if(c){if(!c.spatialReference)throw x.g.F("AOI missing Spatial Reference");d=C(c);f=E(c.spatialReference).Ao()}a=x.Ou.RT(E(a).Ao(),E(b).Ao(),d,f);return null!==
a?a:null};b._getTransformationBySuitability=function(a,b,c){void 0===c&&(c=null);var d=null,f=null;if(c){if(!c.spatialReference)throw x.g.F("AOI missing Spatial Reference");d=C(c);f=E(c.spatialReference).Ao()}return x.Ou.ST(E(a).Ao(),E(b).Ao(),d,f)};b.dZ=function(a,c,d){var e=null;if(d){var f=d.getGTListEntry();if(null!==f){for(var e=new x.ny(null),h=0,k=f.steps;h<k.length;h++){var f=k[h],l=new x.io(f.geogtran);f.isInverse&&l.kt();e.add(l)}e=x.rs.Is(b.Mg(a),b.Mg(c),e);d.assignCachedGe(a,c,e);return e}}if(null===
e&&d&&d.steps&&0<d.steps.length){e=new x.ny(null);h=0;for(k=d.steps;h<k.length;h++)f=k[h],-1!=f.wkid&&null!==f.wkid&&void 0!==f.wkid?e.add(x.io.create(f.wkid,f.isInverse)):e.add(x.io.gG(f.wkt,f.isInverse));e=x.rs.Is(b.Mg(a),b.Mg(c),e);d.assignCachedGe(a,c,e);return e}return x.rs.Is(b.Mg(a),b.Mg(c),e)};b._project=function(a,c,d,e,f){void 0===e&&(e=null);void 0===f&&(f=!1);if(!1===this.GE)throw Error("Projection Engine must be enabled using enableProjection");if(0===a.length)return[];if(e){var g=e.getCachedGeTransformation(c,
d);g||(g=b.dZ(c,d,e));c=[];var h=0}else g=x.rs.Is(b.Mg(c),b.Mg(d),null),c=[],h=0;for(;h<a.length;h++)e=a[h],c.push(b.nD(e,d,g,f));return c};b.nD=function(a,b,c,d){a=x.cc.Xg(C(a),c);return d?G(a):w(a,b)};b.GE=!1;return b}();void 0===l.prototype.getCacheValue&&c.extend(l,{cache:null,getCacheValue:function(a){if(null===this.cache||void 0===this.cache)this.cache={};return this.cache[a]},setCacheValue:function(a,b){if(null===this.cache||void 0===this.cache)this.cache={};this.cache[a]=b}});return z})},
"esri/views/draw/support/layerUtils":function(){define(["require","exports"],function(z,d){Object.defineProperty(d,"__esModule",{value:!0});d.addUniqueLayer=function(d,l){l&&d&&d.map&&(d=d.map,d.layers.find(function(d){return d===l})||d.add(l))}})},"esri/widgets/Sketch/support/OperationHandle":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/compilerUtils ../../../core/Evented ../../../core/accessorSupport/decorators".split(" "),
function(z,d,t,l,q,b,f){Object.defineProperty(d,"__esModule",{value:!0});z=function(b){function d(){var c=null!==b&&b.apply(this,arguments)||this;c.cancelled=!1;c.history={undo:[],redo:[]};c.type=null;return c}t(d,b);Object.defineProperty(d.prototype,"tool",{get:function(){if(!this.activeComponent)return null;switch(this.activeComponent.type){case "graphic-mover":case "move-3d":return"move";case "box":case "transform-3d":return"transform";case "reshape":case "reshape-3d":return"reshape";case "draw":break;
default:q.neverReached(this.activeComponent)}return null},enumerable:!0,configurable:!0});d.prototype.addToHistory=function(b){this.history.redo=[];this.history.undo.push(b)};d.prototype.resetHistory=function(){this.history.redo=[];this.history.undo=[]};d.prototype.canUndo=function(){return 0<this.history.undo.length};d.prototype.canRedo=function(){return 0<this.history.redo.length};d.prototype.complete=function(){this.reset();this.onEnd();this.emit("complete")};d.prototype.cancel=function(){this.cancelled=
!0;this.complete()};d.prototype.reset=function(){this.activeComponent.reset()};d.prototype.refreshComponent=function(){var b=this.activeComponent;b&&("box"!==b.type&&"reshape"!==b.type||b.refresh())};Object.defineProperty(d.prototype,"undo",{set:function(b){var a=this;this._set("undo",function(){a.canUndo()&&b()})},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"redo",{set:function(b){var a=this;this._set("redo",function(){a.canRedo()&&b()})},enumerable:!0,configurable:!0});l([f.property()],
d.prototype,"activeComponent",void 0);l([f.property()],d.prototype,"cancelled",void 0);l([f.property()],d.prototype,"history",void 0);l([f.property({dependsOn:["activeComponent"]})],d.prototype,"tool",null);l([f.property()],d.prototype,"type",void 0);l([f.property()],d.prototype,"canUndo",null);l([f.property()],d.prototype,"canRedo",null);l([f.property()],d.prototype,"onEnd",void 0);l([f.property()],d.prototype,"undo",null);l([f.property()],d.prototype,"redo",null);l([f.property()],d.prototype,"toggleTool",
void 0);l([f.property()],d.prototype,"setSnapToScene",void 0);l([f.property()],d.prototype,"addToSelection",void 0);l([f.property()],d.prototype,"removeFromSelection",void 0);return d=l([f.subclass("esri.widgets.Sketch.support.OperationHandle")],d)}(f.declared(b.EventedAccessor));d.OperationHandle=z})},"*now":function(z){z(['dojo/i18n!*preload*esri/widgets/nls/Editor*["ar","bs","ca","cs","da","de","de-ch","el","en-au","en-ca","en-gb","en-us","es","es-mx","et","fi","fr","fr-ch","he","hr","hu","id","it","it-ch","ja","ko","lt","lv","nl","nb","pl","pt","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","uk","vi","zh-cn","zh-hk","zh-tw","ROOT"]'])},
"*noref":1}});
define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/assignHelper @dojo/framework/shim/Map dojo/i18n!../nls/common dojo/i18n!./Editor/nls/Editor dojo/i18n!./FeatureTemplates/nls/FeatureTemplates ../intl ../core/events ../core/HandleOwner ../core/watchUtils ../core/accessorSupport/decorators ../layers/support/fieldUtils ./Attachments ./FeatureForm ./FeatureTemplates ./Spinner ./Widget ./Editor/EditorViewModel ./FeatureTemplates/ItemList ./support/widget".split(" "),function(z,
d,t,l,q,b,f,h,r,c,a,m,u,D,w,v,E,C,J,K,G,I,x){function N(a){a.focus()}return function(d){function m(a){var b=d.call(this,a)||this;b._candidateCommitted=!1;b._featureForm=new E;b._attachments=new v({visibleElements:{addSubmitButton:!1,cancelAddButton:!1,cancelUpdateButton:!1,deleteButton:!1,errorMessage:!1,progressBar:!1,updateButton:!1}});b._featureTemplates=new C;b._filterText="";b._prompt=null;b._spinner=new J;b.activeWorkflow=null;b.allowedWorkflows=null;b.iconClass="esri-icon-edit";b.label=h.widgetLabel;
b.layerInfos=null;b.supportingWidgetDefaults=null;b.view=null;b.viewModel=new G;b._handleHeaderClickOrKeyDown=function(a){a.currentTarget["data-prevent-back"]||b._handleBack.call(b,a)};b._setCandidateFeature=function(a,c){void 0===c&&(c=!1);if(!b._candidateCommitted){var d=b.viewModel.activeWorkflow;d.data.edits.feature=a;c&&(d.next(),b._candidateCommitted=!0)}};b._handleSave=b._handleSave.bind(b);b._handleBack=b._handleBack.bind(b);b._handleDone=b._handleDone.bind(b);b._handleDelete=b._handleDelete.bind(b);
b._handleAdd=b._handleAdd.bind(b);b._handleEdit=b._handleEdit.bind(b);b._handleAttachmentAdd=b._handleAttachmentAdd.bind(b);b._handleAttachmentUpdate=b._handleAttachmentUpdate.bind(b);b._handleAttachmentDelete=b._handleAttachmentDelete.bind(b);return b}t(m,d);m.prototype.postInitialize=function(){var a=this;this.own([u.init(this,"viewModel",function(b){a._featureForm.viewModel=b?b.featureFormViewModel:null;a._attachments.viewModel=b?b.attachmentsViewModel:null;a._featureTemplates.viewModel=b?b.featureTemplatesViewModel:
null;a._spinner.viewModel=b?b.spinnerViewModel:null}),u.init(this,"view",function(b,c){var d="editor-"+a.id+"-spinner";c&&c.ui.remove(a._spinner,d);b&&b.ui.add(a._spinner,{key:d,position:"manual"})}),u.on(this,"viewModel.sketchViewModel","create",function(){a.scheduleRender()}),u.on(this,"viewModel.activeWorkflow","cancel-request",function(b){var c=b.controller;a._prompt={title:h.cancelRequestTitle,message:h.cancelRequestWarningMessage,options:[{label:f.form.no,type:"neutral",action:function(){c.deny();
return a._prompt=null}},{label:f.form.yes,type:"negative",action:function(){c.allow();a._prompt=null}}]};a.scheduleRender()}),u.init(this,"supportingWidgetDefaults",function(b){b&&(a._featureForm.set(b.featureForm),a._attachments.set(b.attachments),a._featureTemplates.set(b.featureTemplates),a.viewModel.sketchViewModel.set(b.sketch))}),u.watch(this,"_attachments.error",function(b){b&&(a._prompt={title:h.errorWarningTitle,message:b.message,options:[{label:f.form.ok,type:"neutral",action:function(){a._prompt=
null}}]})}),u.watch(this,"viewModel.failures",function(b){if(b){b=b[0];var d=b.retry,f=b.cancel;a._prompt={title:h.errorWarningTitle,message:c.substitute(h.errorWarningMessageTemplate,{errorMessage:b.error.message}),options:[{label:h.retry,type:"positive",action:function(){d();a._prompt=null}},{label:h.ignore,type:"neutral",action:function(){f();return a._prompt=null}}]}}}),u.watch(this,"viewModel.state",function(b){"awaiting-update-feature-candidate"===b&&(a._candidateCommitted=!1)}),u.watch(this,
["_attachments.selectedFile","_attachments.submitting"],function(){return a.scheduleRender()}),u.whenNot(this,"viewModel.activeWorkflow",function(){return a._featureTemplates.filterText=""})])};m.prototype.destroy=function(){this._attachments.destroy();this._featureForm.destroy();this._featureTemplates.destroy()};m.prototype.startCreateWorkflowAtFeatureTypeSelection=function(){return this.viewModel.startCreateWorkflowAtFeatureTypeSelection()};m.prototype.startCreateWorkflowAtFeatureCreation=function(a){return this.viewModel.startCreateWorkflowAtFeatureCreation(a)};
m.prototype.startCreateWorkflowAtFeatureEdit=function(a){return this.viewModel.startCreateWorkflowAtFeatureEdit(a)};m.prototype.startUpdateWorkflowAtFeatureSelection=function(){return this.viewModel.startUpdateWorkflowAtFeatureSelection()};m.prototype.startUpdateWorkflowAtMultipleFeatureSelection=function(a){return this.viewModel.startUpdateWorkflowAtMultipleFeatureSelection(a)};m.prototype.startUpdateWorkflowAtFeatureEdit=function(a){return this.viewModel.startUpdateWorkflowAtFeatureEdit(a)};m.prototype.deleteFeatureFromWorkflow=
function(){return this.viewModel.deleteFeatureFromWorkflow()};m.prototype.cancelWorkflow=function(a){return this.viewModel.cancelWorkflow(a)};m.prototype.render=function(){var a=this._attachments,b=this.viewModel;if(!b)return x.tsx("div",{class:"esri-editor esri-widget"});var c=b.state,d=this._prompt?x.tsx("div",{class:"esri-editor__overlay",key:"overlay"},this.renderPrompt({message:this._prompt.message,title:this._prompt.title,options:this._prompt.options})):null;return x.tsx("div",{class:"esri-editor esri-widget"},
b.syncing||a.submitting?this.renderProgressBar():null,"disabled"===c?null:"ready"===c?this.renderLanding():"awaiting-feature-creation-info"===c?this.renderTemplates():"editing-new-feature"===c||"editing-existing-feature"===c?this.renderAttributeEditing():"awaiting-feature-to-update"===c?this.renderFeatureUpdating():"awaiting-update-feature-candidate"===c?this.renderFeatureList():"awaiting-feature-to-create"===c?this.renderFeatureCreation():"adding-attachment"===c?this.renderAttachmentAdding():"editing-attachment"===
c?this.renderAttachmentEditing():null,d)};m.prototype.renderTemplates=function(){return x.tsx("div",{class:"esri-editor__temp-wrapper",key:"wrapper"},this.renderHeader(h.selectTemplate,!0),x.tsx("div",{key:"content",class:"esri-editor__content"},this._featureTemplates.render()))};m.prototype.renderAttributeEditing=function(){var a=this.viewModel,b=a.activeWorkflow,a=a.featureFormViewModel,d=b.data.edits.feature,l="create"===b.type?f.add:f.update,m=[{label:l,type:"primary",disabled:"update"===b.type&&
!b.data.edits.modified||0<a.inputFields.length&&!a.valid,clickHandler:this._handleSave}],q=!1;"update"===b.type&&(b.data.editableItem.hasAttachments&&(q=!0),-1<b.data.editableItem.supports.indexOf("delete")&&m.push({label:f.delete,type:"tertiary",clickHandler:this._handleDelete}));b=this._getLabel(d);return x.tsx("div",{class:"esri-editor__temp-wrapper",key:"wrapper"},this.renderHeader(b,!0),x.tsx("div",{key:"content",class:this.classes("esri-editor__content","esri-editor__scroller")},x.tsx("div",
{class:"esri-editor__content-group"},0<a.inputFields.length?this._featureForm.render():this.renderMessage(c.substitute(h.clickToFinishTemplate,{button:l})),q?x.tsx("div",{key:"attachments"},x.tsx("div",null,h.attachments),this._attachments.render()):null)),this.renderControls(m))};m.prototype.renderAttachmentAdding=function(){var a=this._attachments,b=[{label:a.submitting?f.cancel:f.add,disabled:a.submitting||!a.selectedFile,type:"primary",clickHandler:this._handleAttachmentAdd}];return x.tsx("div",
{class:"esri-editor__temp-wrapper",key:"wrapper"},this.renderHeader(h.addAttachment,!0,a.submitting),x.tsx("div",{key:"content",class:this.classes("esri-editor__content","esri-editor__scroller")},a.render()),this.renderControls(b))};m.prototype.renderAttachmentEditing=function(){var a=this._attachments,b=[{label:f.update,disabled:a.submitting||!a.selectedFile,type:"primary",clickHandler:this._handleAttachmentUpdate},{label:f.delete,disabled:a.submitting,type:"tertiary",clickHandler:this._handleAttachmentDelete}];
return x.tsx("div",{class:"esri-editor__temp-wrapper",key:"wrapper"},this.renderHeader(h.editAttachment,!0,a.submitting),x.tsx("div",{key:"content",class:this.classes("esri-editor__content","esri-editor__scroller")},a.render()),this.renderControls(b))};m.prototype.renderFeatureUpdating=function(){return x.tsx("div",{class:"esri-editor__temp-wrapper",key:"wrapper"},this.renderHeader(h.selectFeature,!0),x.tsx("div",{key:"content",class:this.classes("esri-editor__content","esri-editor__scroller")},this.renderMessage(h.selectFeatureToEdit)))};
m.prototype.renderMessage=function(a){return x.tsx("div",{class:"esri-editor__message"},a)};m.prototype.renderFeatureCreation=function(){var a=this.viewModel,b=a.sketchViewModel,a=a.activeWorkflow.data.creationInfo.layer,b=b.canUndo()&&b.createGraphic?b.createGraphic:null,b=this._getSketchingTip(a.geometryType,b);return x.tsx("div",{class:"esri-editor__temp-wrapper",key:"wrapper"},this.renderHeader(h.placeFeature,!0),x.tsx("div",{key:"content",class:this.classes("esri-editor__content","esri-editor__scroller")},
this.renderMessage(b)))};m.prototype.renderControls=function(a){var b=this;return x.tsx("div",{class:"esri-editor__controls",key:"controls"},a.map(function(a,c){var d=a.disabled,d=void 0===d?!1:d,f=a.type,h=a.clickHandler;return b.renderButton({label:a.label,class:b.classes("esri-editor__control-button","esri-button","secondary"===f?"esri-button--secondary":"tertiary"===f?"esri-button--tertiary":null,d?"esri-button--disabled":null),disabled:d,clickHandler:h,key:c})}))};m.prototype.renderPrompt=function(b){var c=
this,d=b.title,f=b.message;b=b.options;b=void 0===b?[]:b;return x.tsx("div",{class:"esri-editor__warning-card",role:"alert"},x.tsx("div",{class:"esri-editor__warning-header"},x.tsx("span",{class:"esri-icon-notice-triangle","aria-hidden":"true"}),x.tsx("h4",{class:this.classes("esri-heading","esri-editor__warning-heading")},d)),x.tsx("div",{class:"esri-editor__warning-message"},f),x.tsx("div",{class:"esri-editor__warning-divider"}),b.map(function(b,d){var f=b.label,h=b.action;b=b.type;var l=0===d;
return x.tsx("div",{afterCreate:l?N:null,class:c.classes("esri-editor__warning-option",l?"esri-editor__warning-option--primary":null,"positive"===b?"esri-editor__warning-option--positive":"negative"===b?"esri-editor__warning-option--negative":null),key:d,onclick:h,onkeydown:function(b){var c=a.eventKey(b);if("Enter"===c||" "===c)b.preventDefault(),h.call(null)},tabIndex:0,role:"button"},f)}))};m.prototype.renderProgressBar=function(){return x.tsx("div",{class:this.classes("esri-editor__progress-bar"),
key:"progress-bar"})};m.prototype.renderButton=function(a){return x.tsx("button",{class:a.class,disabled:a.disabled,key:a.key,onclick:a.clickHandler},a.label)};m.prototype.renderHeader=function(a,b,c){void 0===b&&(b=!1);void 0===c&&(c=!1);return x.tsx("header",{class:"esri-editor__header",key:"header"},b?x.tsx("div",{"aria-label":f.back,class:this.classes("esri-editor__back-button","esri-interactive",c?"esri-button--disabled":null),key:"back-button","data-prevent-back":c,onclick:this._handleHeaderClickOrKeyDown,
onkeydown:this._handleHeaderClickOrKeyDown,role:"button",tabIndex:0,title:f.back},x.tsx("span",{"aria-hidden":"true",class:x.isRTL()?"esri-icon-right":"esri-icon-left"})):null,x.tsx("h4",{class:this.classes("esri-editor__title","esri-heading")},a))};m.prototype.renderLanding=function(){var a=this.viewModel,b=a.allowedWorkflows,c=a.canCreate,a=a.canUpdate,d=x.isRTL()?"esri-icon-left":"esri-icon-right";return x.tsx("div",{class:"esri-editor__temp-wrapper",key:"wrapper"},this.renderHeader(h.widgetLabel),
x.tsx("div",{key:"content",class:"esri-editor__content",role:"group"},x.tsx("div",{class:"esri-editor__mode-selection",key:"mode-selection"},-1<b.indexOf("update")?x.tsx("div",{"aria-disabled":a?"false":"true",class:this.classes("esri-editor__feature-list-item",a?null:"esri-editor__feature-list-item--disabled"),key:"update",onclick:this._handleEdit,onkeydown:this._handleEdit,role:"button",tabIndex:a?0:-1},x.tsx("span",{class:"esri-editor__feature-list-name"},h.editFeature),x.tsx("span",{"aria-hidden":"true",
class:this.classes("esri-editor__feature-list-icon",d)})):null,-1<b.indexOf("create")?x.tsx("div",{class:this.classes("esri-editor__feature-list-item",c?null:"esri-editor__feature-list-item--disabled"),key:"create",onclick:this._handleAdd,onkeydown:this._handleAdd,role:"button",tabIndex:c?0:-1},x.tsx("span",{class:"esri-editor__feature-list-name"},h.addFeature),x.tsx("span",{"aria-hidden":"true",class:this.classes("esri-editor__feature-list-icon",d)})):null)))};m.prototype.renderFeatureList=function(){var a=
this,d=this.viewModel,f=d.editableItems,l=d.activeWorkflow.data.candidates,d=c.substitute(h.multipleFeaturesTemplate,{total:l.length}),m=new b.default;l.map(function(b){return{label:a._getLabel(b),id:b.attributes[b.layer.objectIdField],data:b}}).filter(function(b){var c=b.label,d=b.data;b=a._filterText.toLowerCase();var f=d.layer.title;return-1<a.viewModel.editableItems.find(function(a){return a.layer===d.layer}).supports.indexOf("update")&&(!b||-1<c.toLowerCase().indexOf(b)||-1<f.toLowerCase().indexOf(b))}).forEach(function(a){var b=
a.data.layer;m.has(b)?m.get(b).items.push(a):m.set(b,{id:b.id,label:b.title,items:[a]})});f=f.filter(function(a){return m.has(a.layer)}).map(function(a){return m.get(a.layer)}).toArray();return x.tsx("div",{class:"esri-editor__temp-wrapper",key:"wrapper"},this.renderHeader(d,!0),x.tsx("div",{key:"content",class:this.classes("esri-editor__content","esri-editor__scroller")},I.ItemList({id:this.id,filterText:this._filterText,items:f,messages:{filterPlaceholder:r.filterPlaceholder,noItems:r.noItems,noMatches:r.noMatches},
onItemMouseEnter:function(b){return a._setCandidateFeature(b.data)},onItemMouseLeave:function(){return a._setCandidateFeature(null)},onItemSelect:function(b){return a._setCandidateFeature(b.data,!0)},onFilterChange:function(b){return a._filterText=b}})))};m.prototype._getSketchingTip=function(a,b){if("point"===a)return h.tips.clickToAddPoint;if("polygon"===a||"polyline"===a){if(!b)return h.tips.clickToStart;b=b.geometry["polygon"===a?"rings":"paths"][0];return"polygon"===a&&4>b?h.tips.clickToContinue:
h.tips.clickToContinueThenDoubleClickToEnd}return h.tips.clickToAddFeature};m.prototype._getLabel=function(a){var b=a.layer,d=b.objectIdField;a=a.attributes;return(b=w.getDisplayFieldName(b))&&""+a[b]||c.substitute(h.untitledFeatureTemplate,{id:a[d]})};m.prototype._handleDelete=function(){var a=this;this._prompt={title:h.deleteWarningTitle,message:h.deleteWarningMessage,options:[{label:h.keepFeature,type:"neutral",action:function(){return a._prompt=null}},{label:f.delete,type:"positive",action:function(){a.viewModel.deleteFeatureFromWorkflow();
a._prompt=null}}]}};m.prototype._handleSave=function(){this.viewModel.activeWorkflow.commit()};m.prototype._handleAttachmentAdd=function(){var a=this.viewModel.activeWorkflow;this._attachments.addAttachment().then(function(){return a.previous()})};m.prototype._handleAttachmentUpdate=function(){var a=this.viewModel.activeWorkflow;this._attachments.updateAttachment().then(function(){return a.previous()})};m.prototype._handleAttachmentDelete=function(){var a=this;this._prompt={title:h.deleteAttachmentWarningTitle,
message:h.deleteAttachmentWarningMessage,options:[{label:h.keepAttachment,type:"neutral",action:function(){return a._prompt=null}},{label:f.delete,type:"positive",action:function(){var b=a._attachments,c=a.viewModel.activeWorkflow;b.deleteAttachment(b.viewModel.activeAttachmentInfo).then(function(){c.previous();a._prompt=null})}}]}};m.prototype._handleAdd=function(){this.viewModel.canCreate&&this.viewModel.startCreateWorkflowAtFeatureTypeSelection()};m.prototype._handleEdit=function(){this.viewModel.canUpdate&&
this.viewModel.startUpdateWorkflowAtFeatureSelection()};m.prototype._handleDone=function(){this.viewModel.cancelWorkflow({force:!0})};m.prototype._handleBack=function(){var a=this,b=this.viewModel.activeWorkflow,c=b.stepId,d=b.data,f=b.type,l=function(){b.hasPreviousStep?b.previous():a.viewModel.cancelWorkflow({force:!0})};"editing-new-feature"===c||"editing-existing-feature"===c&&d.edits.modified?this._prompt={title:"create"===f?h.cancelAddTitle:h.cancelEditTitle,message:"create"===f?h.cancelAddWarningMessage:
h.cancelEditWarningMessage,options:[{label:"create"===f?h.continueAdding:h.continueEditing,type:"neutral",action:function(){return a._prompt=null}},{label:"create"===f?h.discardFeature:h.discardEdits,type:"negative",action:function(){l();a._prompt=null}}]}:l()};l([D.property()],m.prototype,"_attachments",void 0);l([D.aliasOf("viewModel.activeWorkflow")],m.prototype,"activeWorkflow",void 0);l([D.aliasOf("viewModel.allowedWorkflows")],m.prototype,"allowedWorkflows",void 0);l([D.property()],m.prototype,
"iconClass",void 0);l([D.property()],m.prototype,"label",void 0);l([D.aliasOf("viewModel.layerInfos")],m.prototype,"layerInfos",void 0);l([D.property()],m.prototype,"supportingWidgetDefaults",void 0);l([D.aliasOf("viewModel.view")],m.prototype,"view",void 0);l([D.property(),x.renderable("viewModel.canCreate viewModel.canUpdate viewModel.failures viewModel.state viewModel.syncing viewModel.activeWorkflow.data.edits.modified".split(" ")),x.vmEvent(["workflow-cancel","workflow-commit"])],m.prototype,
"viewModel",void 0);l([x.accessibleHandler()],m.prototype,"_handleDelete",null);l([x.accessibleHandler()],m.prototype,"_handleAttachmentAdd",null);l([x.accessibleHandler()],m.prototype,"_handleAttachmentUpdate",null);l([x.accessibleHandler()],m.prototype,"_handleAttachmentDelete",null);l([x.accessibleHandler()],m.prototype,"_handleAdd",null);l([x.accessibleHandler()],m.prototype,"_handleEdit",null);l([x.accessibleHandler()],m.prototype,"_handleDone",null);l([x.accessibleHandler()],m.prototype,"_handleBack",
null);return m=l([D.subclass("esri.widgets.Editor")],m)}(D.declared(m.HandleOwnerMixin(K)))});